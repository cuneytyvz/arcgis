// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt and http://www.arcgis.com/apps/webappbuilder/copyright.txt for details.
//>>built
require({cache:{"dojo/promise/all":function(){define(["../_base/array","../Deferred","../when"],function(k,e,p){var q=k.some;return function(n){var l,h;n instanceof Array?h=n:n&&"object"===typeof n&&(l=n);var f,d=[];if(l){h=[];for(var c in l)Object.hasOwnProperty.call(l,c)&&(d.push(c),h.push(l[c]));f={}}else h&&(f=[]);if(!h||!h.length)return(new e).resolve(f);var a=new e;a.promise.always(function(){f=d=null});var b=h.length;q(h,function(c,u){l||d.push(u);p(c,function(c){a.isFulfilled()||(f[d[u]]=
c,0===--b&&a.resolve(f))},a.reject);return a.isFulfilled()});return a.promise}})},"dojo/cookie":function(){define(["./_base/kernel","./regexp"],function(k,e){k.cookie=function(k,q,n){var l=document.cookie,h;if(1==arguments.length)h=(h=l.match(new RegExp("(?:^|; )"+e.escapeString(k)+"\x3d([^;]*)")))?decodeURIComponent(h[1]):void 0;else{n=n||{};l=n.expires;if("number"==typeof l){var f=new Date;f.setTime(f.getTime()+864E5*l);l=n.expires=f}l&&l.toUTCString&&(n.expires=l.toUTCString());q=encodeURIComponent(q);
var l=k+"\x3d"+q,d;for(d in n)l+="; "+d,f=n[d],!0!==f&&(l+="\x3d"+f);document.cookie=l}return h};k.cookie.isSupported=function(){"cookieEnabled"in navigator||(this("__djCookieTest__","CookiesAllowed"),navigator.cookieEnabled="CookiesAllowed"==this("__djCookieTest__"),navigator.cookieEnabled&&this("__djCookieTest__","",{expires:-1}));return navigator.cookieEnabled};return k.cookie})},"dojo/regexp":function(){define(["./_base/kernel","./_base/lang"],function(k,e){var p={};e.setObject("dojo.regexp",
p);p.escapeString=function(e,n){return e.replace(/([\.$?*|{}\(\)\[\]\\\/\+\-^])/g,function(l){return n&&-1!=n.indexOf(l)?l:"\\"+l})};p.buildGroupRE=function(e,n,l){if(!(e instanceof Array))return n(e);for(var h=[],f=0;f<e.length;f++)h.push(n(e[f]));return p.group(h.join("|"),l)};p.group=function(e,n){return"("+(n?"?:":"")+e+")"};return p})},"dojo/request/script":function(){define("module ./watch ./util ../_base/kernel ../_base/array ../_base/lang ../on ../dom ../dom-construct ../has ../_base/window".split(" "),
function(k,e,p,q,n,l,h,f,d,c,a){function b(a,b){a.canDelete&&t._remove(a.id,b.options.frameDoc,!0)}function g(a){A&&A.length&&(n.forEach(A,function(a){t._remove(a.id,a.frameDoc);a.frameDoc=null}),A=[]);return a.options.jsonp?!a.data:!0}function u(a){return!!this.scriptLoaded}function m(a){return(a=a.options.checkString)&&eval("typeof("+a+') !\x3d\x3d "undefined"')}function r(a,b){if(this.canDelete){var c=this.response.options;A.push({id:this.id,frameDoc:c.ioArgs?c.ioArgs.frameDoc:c.frameDoc});c.ioArgs&&
(c.ioArgs.frameDoc=null);c.frameDoc=null}b?this.reject(b):this.resolve(a)}function t(a,c,d){var f=p.parseArgs(a,p.deepCopy({},c));a=f.url;c=f.options;var n=p.deferred(f,b,g,c.jsonp?null:c.checkString?m:u,r);l.mixin(n,{id:v+y++,canDelete:!1});c.jsonp&&((new RegExp("[?\x26]"+c.jsonp+"\x3d")).test(a)||(a+=(~a.indexOf("?")?"\x26":"?")+c.jsonp+"\x3d"+(c.frameDoc?"parent.":"")+v+"_callbacks."+n.id),n.canDelete=!0,x[n.id]=function(a){f.data=a;n.handleResponse(f)});p.notify&&p.notify.emit("send",f,n.promise.cancel);
if(!c.canAttach||c.canAttach(n)){var k=t._attach(n.id,a,c.frameDoc,function(a){if(!(a instanceof Error)){var b=Error("Error loading "+(a.target?a.target.src:"script"));b.source=a;a=b}n.reject(a);t._remove(n.id,c.frameDoc,!0)});if(!c.jsonp&&!c.checkString)var q=h(k,w,function(a){if("load"===a.type||z.test(k.readyState))q.remove(),n.scriptLoaded=a})}e(n);return d?n:n.promise}c.add("script-readystatechange",function(a,b){return"undefined"!==typeof b.createElement("script").onreadystatechange&&("undefined"===
typeof a.opera||"[object Opera]"!==a.opera.toString())});var v=k.id.replace(/[\/\.\-]/g,"_"),y=0,w=c("script-readystatechange")?"readystatechange":"load",z=/complete|loaded/,x=q.global[v+"_callbacks"]={},A=[];t.get=t;t._attach=function(b,c,d,g){d=d||a.doc;var m=d.createElement("script");if(g)h.once(m,"error",g);m.type="text/javascript";try{m.src=c}catch(I){g&&g(m)}m.id=b;m.async=!0;m.charset="utf-8";return d.getElementsByTagName("head")[0].appendChild(m)};t._remove=function(a,b,c){d.destroy(f.byId(a,
b));x[a]&&(c?x[a]=function(){delete x[a]}:delete x[a])};t._callbacksProperty=v+"_callbacks";return t})},"jimu/utils":function(){define("dojo/_base/lang dojo/_base/array dojo/_base/html dojo/_base/sniff dojo/_base/config dojo/io-query dojo/query dojo/NodeList-traverse dojo/Deferred dojo/promise/all dojo/on dojo/json dojo/cookie dojo/number dojo/date/locale dojo/i18n!dojo/cldr/nls/number dojox/encoding/base64 esri/lang esri/arcgis/utils esri/dijit/PopupTemplate esri/SpatialReference esri/geometry/Extent esri/geometry/Multipoint esri/geometry/Polyline esri/geometry/Polygon esri/geometry/webMercatorUtils esri/tasks/GeometryService esri/tasks/ProjectParameters esri/tasks/FeatureSet esri/symbols/PictureMarkerSymbol esri/urlUtils esri/request esri/tasks/query esri/tasks/QueryTask esri/graphicsUtils jimu/portalUrlUtils ./shared/utils".split(" "),
function(k,e,p,q,n,l,h,f,d,c,a,b,g,u,m,r,t,v,y,w,z,x,A,C,B,E,D,F,I,M,L,J,P,K,U,O,S){function Y(a,b){a=a||"";var c=0,d=[{test:window.File&&window.FileReader&&window.FileList&&window.Blob||!G.file.isEnabledFlash(),failure:[a+"libs/polyfills/fileAPI/FileAPI.js"],callback:function(){c++;c===d.length&&b()}}];for(a=0;a<d.length;a++)testLoad(d[a])}function N(a){return 0===a?!0:!!a}function W(a,b){var c=a.match(/url\([^)]+\)/gi),d,g;if(null===c||""===b)return a;for(d=0;d<c.length;d++)if(g=c[d].match(/(url\(["|']?)(.*)((?:['|"]?)\))/i),
4<=g.length){var m=g[2];/^data:image\/.*;/.test(m)||(b.endWith("/")||(b+="/"),a=a.replace(g[1]+m+g[3],g[1]+b+m+g[3]))}return a}function ca(a,b){var c=Array.isArray(b),d=c&&[]||{};c?(a=a||[],d=d.concat(a),b.forEach(function(b,c){"undefined"===typeof a[c]?d[c]=b:"object"===typeof b?d[c]=ca(a[c],b):-1===a.indexOf(b)&&d.push(b)})):(a&&"object"===typeof a&&Object.keys(a).forEach(function(b){d[b]=a[b]}),Object.keys(b).forEach(function(c){d[c]="object"===typeof b[c]&&b[c]?a[c]?ca(a[c],b[c]):b[c]:b[c]}));
return d}function ha(a,b){var c=a.map(function(a){return a.id});e.forEach(b,function(b){0>c.indexOf(b)&&a.push({id:b,widgets:[]})},this);var d=[];a=e.filter(a,function(a){return 0>b.indexOf(a.id)?(d.push(a),!1):!0},this);if(0===a.length)return[];var g=a[a.length-1];e.forEach(d,function(a){g.widgets=g.widgets.concat(a.widgets)},this);return a=a.sort(function(a,c){return b.indexOf(a.id)-b.indexOf(c.id)})}function fa(a,b,c){function d(a,b){return k.isArray(a[b.key])?a[b.key][b.index]:a[b.key]}b=function(a){var b=
[];a.split("_").forEach(function(a){var c=!1,d;"--"===a.slice(a.length-2)&&(c=!0,a=a.slice(0,a.length-2));d=a.search(/\[[0-9]+\]/);-1===d&&(d=a.length);b.push({key:a.slice(0,d),index:Number(a.slice(d+1,-1)),deleteFlag:c})});return b}(b);for(var g=1;g<b.length-1;g++)if(a=d(a,b[g]),!a)return;if(b[b.length-1].deleteFlag)!0===c&&(k.isArray(a[b[b.length-1].key])?delete a[b[b.length-1].key][b[b.length-1].index]:delete a[b[b.length-1].key]);else if(k.isArray(a[b[b.length-1].key])){if(void 0===c)return a[b[b.length-
1].key][b[b.length-1].index];a[b[b.length-1].key][b[b.length-1].index]=c}else{if(void 0===c)return a[b[b.length-1].key];a[b[b.length-1].key]=c}}function Z(a,b,c){function d(c){c=G.template.getSearchRange(b,c,"]");var d=b.slice(c.firstPos,c.lastPos);return-1!==c.firstPos?(d=b.slice(c.firstPos+d.indexOf("[")+1,c.lastPos-1),c=b.slice(c.lastPos+1),(d=G.getConfigElementById(a,d))?{object:d,key:"section_"+c,state:"isSection"}:{state:"deleted"}):{state:"isNotSection"}}var g=a,m=b=b.replace(/\//g,"_"),t=
d("groups\\[.+\\]");if("deleted"!==t.state&&("isSection"===t.state&&(g=t.object,m=t.key),t=d("widgets\\[.+\\]"),"delete"!==t.state))return"isSection"===t.state&&(g=t.object,m=t.key),fa(g,m,c)}var G={},ia={geometryService:"http://utility.arcgisonline.com/arcgis/rest/services/Geometry/GeometryServer"};k.mixin(G,S);window.atob||(window.atob=function(a){a=t.decode(a);for(var b="",c=0,d=a.length;c<d;c++)b+=String.fromCharCode(a[c]);return b});window.btob||(window.btob=function(a){for(var b=[],c=0,d=a.length;c<
d;c++)b.push(String.charCodeAt(a[c]));return t.encode(b)});var sa="unload",wa=[];require.on("error",function(a){e.forEach(wa,function(b){a.info[0]&&-1<a.info[0].indexOf(b.resKey)&&b.def.reject(a);for(var c in a.info)-1<c.indexOf(b.resKey)&&b.def.reject(a)})});G.checkError=function(a,b){wa.push({resKey:a,def:b})};G.replacePlaceHolder=function(a,c){var d=b.stringify(a),g=d.match(/\$\{(\w)+\}/g);if(null===g)return a;for(a=0;a<g.length;a++){var m=g[a].match(/(\w)+/g)[0];c[m]&&(d=d.replace(g[a],c[m]))}return b.parse(d)};
G.changeUnit=function(a){var b=Math.abs(a),c;a=Math.floor(b);c=Math.floor(60*(b-a));b=(60*(60*(b-a)-c)).toFixed(2);return a+"\u00b0"+(10>c?"0"+c:c)+"'"+(10>b?"0"+b:b)+'"'};G.formatTime=function(a){var b=a/1E3;a=Math.floor(b/60);b=Number(b-60*a).toFixed(1);return(10>a?"0"+a:a)+":"+(10>b?"0"+b:b)};G.parseTime=function(a){var b=/(\d{2,})\:(\d{2})\.(\d{1})/;if(!b.test(a))return console.log("wrong time format."),-1;a=a.match(b);return 1E3*(60*parseInt(a[1],10)+parseInt(a[2],10)+parseInt(a[3],10)/10)};
G.preloadImg=function(a,b){var c=[],c="string"===typeof a?[a]:a;e.forEach(c,function(a){(new Image).src=b?b+a:a})};var ua=null;G.getImagesSize=function(b){var c=new d;if(!b||0!==b.indexOf("http"))return c.reject(),c;null===ua&&(ua=p.create("img",{id:"__test-image-size",style:{position:"absolute",left:"-9999px",top:"-9999px"}},document.body));var g=a(ua,"load",function(){clearTimeout(m);m=null;g.remove();var a=p.getContentBox(ua);1===a.w&&1===a.h||0===a.w||0===a.h?c.reject():c.resolve([a.w,a.h])},
{}),m=setTimeout(function(){clearTimeout(m);m=null;c.reject()},5E3);p.setAttr(ua,"src",b);return c};G.getPositionStyle=function(a){var b={};if(!a)return b;a=k.clone(a);if(window.isRTL){var c;"undefined"!==typeof a.left&&"undefined"!==typeof a.right?(c=a.left,a.left=a.right,a.right=c):"undefined"!==typeof a.left?(a.right=a.left,delete a.left):"undefined"!==typeof a.right&&(a.left=a.right,delete a.right);"undefined"!==typeof a.paddingLeft&&"undefined"!==typeof a.paddingRight?(c=a.paddingLeft,a.paddingLeft=
a.paddingRight,a.paddingRight=c):"undefined"!==typeof a.paddingLeft?(a.paddingRight=a.paddingLeft,delete a.paddingLeft):"undefined"!==typeof a.paddingRight&&(a.paddingLeft=a.paddingRight,delete a.paddingRight)}c="left top right bottom width height padding paddingLeft paddingRight paddingTop paddingBottom".split(" ");for(var d=0;d<c.length;d++){var g=c[d];"number"===typeof a[g]?b[g]=a[g]+"px":"undefined"!==typeof a[g]?b[g]=a[g]:"padding"===g.substr(0,7)?b[g]=0:b[g]="auto"}b.zIndex="undefined"===typeof a.zIndex?
"auto":a.zIndex;return b};G.isEqual=function(a,b){function c(a,b){var m;if(null===a&&null===b||"undefined"===typeof a&&"undefined"===typeof b)return!0;if(null===a&&null!==b||null===b&&null!==a||"undefined"===typeof a&&"undefined"!==typeof b||"undefined"===typeof b&&"undefined"!==typeof a)return!1;if(isNaN(a)&&isNaN(b)&&"number"===typeof a&&"number"===typeof b||a===b)return!0;if("function"===typeof a&&"function"===typeof b||a instanceof Date&&b instanceof Date||a instanceof RegExp&&b instanceof RegExp||
a instanceof String&&b instanceof String||a instanceof Number&&b instanceof Number)return a.toString()===b.toString();if(-1<d.indexOf(a)||-1<g.indexOf(b))return!1;if(null!==b){for(m in b)if(b.hasOwnProperty(m)!==a.hasOwnProperty(m)||typeof b[m]!==typeof a[m])return!1;for(m in a){if(b.hasOwnProperty(m)!==a.hasOwnProperty(m)||typeof b[m]!==typeof a[m])return!1;switch(typeof a[m]){case "object":case "function":d.push(a);g.push(b);if(!c(a[m],b[m]))return!1;d.pop();g.pop();break;default:if(isNaN(a[m])&&
isNaN(b[m])&&"number"===typeof a[m]&&"number"===typeof b[m])return!0;if(a[m]!==b[m])return!1}}}return!0}var d,g;d=[];g=[];return c(a,b)?!0:!1};G.file={loadFileAPI:function(){var a=new d;if("unload"===sa){var b=window.isBuilder?"stemapp/":"";window.FileAPI={debug:!1,flash:!0,staticPath:b+"libs/polyfills/fileAPI/",flashUrl:b+"libs/polyfills/fileAPI/FileAPI.flash.swf",flashImageUrl:b+"libs/polyfills/fileAPI/FileAPI.flash.image.swf"};Y(b,k.hitch(this,function(){sa="loaded";a.resolve()}));sa="loading"}else"loaded"===
sa&&a.resolve();return a},supportHTML5:function(){return window.File&&window.FileReader&&window.FileList&&window.Blob?!0:!1},supportFileAPI:function(){return q("safari")&&6>q("safari")?!1:window.FileAPI&&window.FileAPI.readAsDataURL?!0:!1},isEnabledFlash:function(){var a=null;if(document.all)try{a=new ActiveXObject("ShockwaveFlash.ShockwaveFlash")}catch(ja){a=null}else navigator.plugins&&0<navigator.plugins.length&&(a=navigator.plugins["Shockwave Flash"]);return!!a},containSeparator:function(a){return 0<=
a.indexOf("/")?!0:0<=a.indexOf("\\")?!0:!1},getNameFromPath:function(a){var b="",b=0<=a.indexOf("/")?"/":"\\";a=a.split(b);return 0<a.length?a[a.length-1]:null},getFolderFromPath:function(a){return a.substr(0,a.length-G.file.getNameFromPath(a).length)},readFile:function(a,b,c,d){if(this.supportHTML5()){var g=a.target.files[0];g&&(g.type.match(b)?g.size>=c?d({errCode:"exceed"}):(a=new FileReader,a.onload=function(a){d(null,g.name,a.target.result)},a.readAsDataURL(g)):d({errCode:"invalidType"}))}else if(this.supportFileAPI()){var m=
window.FileAPI.getFiles(a);m[0].type.match(b)?m[0].size>=c?d({errCode:"exceed"}):window.FileAPI.readAsDataURL(m[0],function(a){a&&a.result?d(null,m[0].name,a.result):d({errCode:"readError"})}):d({errCode:"invalidType"})}}};G.getUriInfo=function(a){var b,c={};b=a.indexOf("/");a.substring(0,b);b=a.substring(0,a.lastIndexOf("/")+1);c.folderUrl=require(G.getRequireConfig()).toUrl(b);c.amdFolder=b;c.url=c.folderUrl;if(/^http(s)?:\/\//.test(a)||/^\/\//.test(a))c.isRemote=!0;return c};G.widgetJson=function(){var a=
{addManifest2WidgetJson:function(a,b){k.mixin(a,b.properties);a.name=b.name;a.label||(a.label=b.label);a.manifest=b;a.isRemote=b.isRemote;a.isRemote&&(a.itemId=b.itemId);b.featureActions&&(a.featureActions=b.featureActions);a.icon||(a.icon=b.icon);a.thumbnail||(a.thumbnail=b.thumbnail);a.folderUrl=b.folderUrl;a.amdFolder=b.amdFolder},removeManifestFromWidgetJson:function(a){if(a.manifest){for(var b in a.manifest.properties)a[b]=void 0;a.name=void 0;a.label=void 0;a.featureActions=void 0;a.manifest=
void 0}},getUriFromItem:function(b){return b.url?a.getFolderUrlFromItem(b)+"Widget":null},getFolderUrlFromItem:function(a){if(!a.url)return null;a=/manifest\.json$/.test(a.url)?a.url.substring(0,a.url.length-13):/\/$/.test(a.url)?a.url:a.url+"/";"https:"===window.location.protocol&&(a=a.replace(/^http:\/\//,"https://"));return a}};return a}();G.getRequireConfig=function(){if(jimuConfig){var a=[];jimuConfig.widgetsPackage&&(a=a.concat(jimuConfig.widgetsPackage));jimuConfig.themesPackage&&(a=a.concat(jimuConfig.themesPackage));
jimuConfig.configsPackage&&(a=a.concat(jimuConfig.configsPackage));return{packages:a}}return{}};G.getTypeByGeometryType=function(a){var b="",c="esriGeometryLine esriGeometryCircularArc esriGeometryEllipticArc esriGeometryBezier3Curve esriGeometryPath esriGeometryPolyline".split(" "),d=["esriGeometryRing","esriGeometryPolygon","esriGeometryEnvelope"];0<=["esriGeometryPoint","esriGeometryMultipoint"].indexOf(a)?b="point":0<=c.indexOf(a)?b="polyline":0<=d.indexOf(a)&&(b="polygon");return b};G.getSymbolTypeByGeometryType=
function(a){var b=null;a=G.getTypeByGeometryType(a);"point"===a?b="marker":"polyline"===a?b="line":"polygon"===a&&(b="fill");return b};G.getServices=function(){return ia};G.getArcGISDefaultGeometryService=function(){return new D(ia.geometryService)};G.restoreToDefaultWebMapExtent=function(a,b,c){var g=new d;if(!a||"esri.Map"!==a.declaredClass)return setTimeout(function(){g.reject("Invalid map.")},0),g;b=b&&b.itemInfo;if(!b)return setTimeout(function(){g.reject("Invalid itemInfo")},0),g;b=b.item&&
b.item.extent;if(!b)return setTimeout(function(){g.reject("Invalid itemInfo.item.extent")}),g;var m=new z({wkid:4326}),m=new x(b[0][0],b[0][1],b[1][0],b[1][1],m);if(4326===parseInt(a.spatialReference.wkid,10))return a.setExtent(m);if(a.spatialReference.isWebMercator())return m=E.geographicToWebMercator(m),a.setExtent(m);b=new F;b.geometries=[m];b.outSR=a.spatialReference;m=esriConfig&&esriConfig.defaults&&esriConfig.defaults.geometryService;m&&"esri.tasks.GeometryService"===m.declaredClass||(c&&"string"===
typeof c&&k.trim(c)?(c=k.trim(c),m=new D(c)):m=G.getArcGISDefaultGeometryService());m.project(b).then(function(b){if(b=b&&b[0])return a.setExtent(b);g.reject("Invalid projected geometry.");return g},function(a){console.error(a);g.reject(a);return g});return g};G.getAncestorWindow=function(){for(var a=window;a&&a.parent&&a!==a.parent;)a=a.parent;return a};G.getAncestorDom=function(a,b,c){if(a&&1===a.nodeType&&b&&"function"===typeof b){var d=100,g=document.body;c&&("number"===typeof c?(c=parseInt(c,
10),0<c&&(d=c)):1===c.nodeType&&(g=c));for(c=0;a.parentNode&&c<d&&p.isDescendant(a.parentNode,g);){if(b(a.parentNode))return a.parentNode;a=a.parentNode;c++}}return null};G.bindClickAndDblclickEvents=function(b,c,d,g){var m=null;if(b&&1===b.nodeType&&c&&"function"===typeof c&&d&&"function"===typeof d){var t=200;g&&"number"===typeof g&&(g=parseInt(g,10),0<g&&(t=g));var r=0,m=a(b,"click",function(a){r++;1===r?setTimeout(function(){1===r&&(r=0,c(a))},t):2===r&&(r=0,d(a))})}return m};G.isScrollToBottom=
function(a){var b=p.getContentBox(a);return 1>a.scrollHeight-(a.scrollTop+b.h)};G.getAllItemTypes=function(){var a=[],a=a.concat(["Web Map","Web Scene","CityEngine Web Scene"]).concat("Feature Service;Map Service;Image Service;KML;WMS;Feature Collection;Feature Collection Template;Geodata Service;Globe Service".split(";")).concat(["Geometry Service","Geocoding Service","Network Analysis Service","Geoprocessing Service"]).concat(["Web Mapping Application","Mobile Application","Code Attachment","Operations Dashboard Add In",
"Operation View"]).concat("Symbol Set;Color Set;Shapefile;CSV;Service Definition;Document Link;Microsoft Word;Microsoft PowerPoint;Microsoft Excel;PDF;Image;Visio Document".split(";"));return a=a.concat("Map Document;Map Package;Tile Package;ArcPad Package;Explorer Map;Globe Document;Scene Document;Published Map;Map Template;Windows Mobile Package".split(";")).concat(["Layer","Layer Package","Explorer Layer"]).concat(["Geoprocessing Package","Geoprocessing Sample","Locator Package","Rule Package"]).concat("Workflow Manager Package;Desktop Application;Desktop Application Template;Code Sample;Desktop Add In;Explorer Add In".split(";"))};
G.getItemQueryStringByTypes=function(a){var b="",c=G.getAllItemTypes();if(a&&0<a.length&&0<a.length){var d="";e.forEach(a,function(b,c){d+=' type:"'+b+'" ';c!==a.length-1&&(d+=" OR ")});b=" ( "+d+" ) ";c=a.concat(c);c=e.filter(c,function(b){return e.every(a,function(a){return 0>a.toLowerCase().indexOf(b.toLowerCase())})});e.forEach(c,function(a){b+=' -type:"'+a+'" '})}return b};G.getItemQueryStringByTypeKeywords=function(a){var b="";a&&0<a.length&&(b=' typekeywords:"'+a.join(",")+'" ');return b};
G.isNotEmptyString=function(a,b){var c=a&&"string"===typeof a;return c?b?c&&k.trim(a):!0:!1};G.isValidNumber=function(a){return"number"===typeof a&&!isNaN(a)};G.isObject=function(a){return a&&"object"===typeof a};G.createWebMap=function(a,b,c,d){a=O.getStandardPortalUrl(a);a=O.getBaseItemUrl(a);y.arcgisUrl=a;return y.createMap(b,c,d)};G.getRandomString=function(){var a=Math.random().toString();return a=a.slice(2,a.length)};G._getDomainsByServerName=function(a){var b=a.split("."),c=b.length;return e.map(b,
k.hitch(this,function(a,d){a=b.slice(d,c);var g="",m=a.length-1;e.forEach(a,k.hitch(this,function(a,b){g+=a;b!==m&&(g+=".")}));return g}))};G.removeCookie=function(a,b){var c=this._getDomainsByServerName(window.location.hostname);e.forEach(c,k.hitch(this,function(c){g(a,null,{expires:-1,path:b});g(a,null,{expires:-1,path:b,domain:c});g(a,null,{expires:-1,path:b,domain:"."+c})}))};G.isLocaleChanged=function(a,b){return!a.startWith(b)};G.hashToObject=function(a){a=a.replace("#","");a=l.queryToObject(a);
for(var c in a)if(a.hasOwnProperty(c))try{a[c]=b.parse(a[c])}catch(va){}return a};G.reCreateObject=function(a){function b(a){var d=[];a.forEach(function(a){Array.isArray(a)?d.push(b(a)):"object"===typeof a?d.push(c(a)):d.push(a)});return d}function c(a){var d={},g;for(g in a)a.hasOwnProperty(g)&&(null===a[g]?d[g]=null:Array.isArray(a[g])?d[g]=b(a[g]):d[g]="object"===typeof a[g]?c(a[g]):a[g]);return d}return Array.isArray(a)?b(a):c(a)};G.setVerticalCenter=function(a){setTimeout(function(){var b=h(".jimu-vcenter-text",
a),c,d;e.forEach(b,function(a){c=p.getContentBox(a).h;p.setStyle(a,{lineHeight:c+"px"})},this);b=h(".jimu-vcenter",a);e.forEach(b,function(a){c=p.getContentBox(a).h;d=p.getContentBox(h(a).parent()[0]).h;p.setStyle(a,{marginTop:(d-c)/2+"px"})},this)},10)};G.merge=ca;G.loadStyleLink=function(b,c,g){var m=new d,t,r=require(G.getRequireConfig()).toUrl(c);if(require.cache["url:"+r]){t=require.cache["url:"+r];var v=r.split("/").pop(),r=r.substr(0,r.length-v.length);t=W(t,r);b=g?p.create("style",{id:b,type:"text/css"},
p.byId(g),"before"):p.create("style",{id:b,type:"text/css"},document.getElementsByTagName("head")[0]);b.styleSheet&&!b.sheet?b.styleSheet.cssText=t:b.appendChild(p.toDom(t));m.resolve("load");return m}t=g?p.create("link",{id:b,rel:"stylesheet",type:"text/css",href:r+"?wab_dv\x3d"+window.deployVersion},p.byId(g),"before"):p.create("link",{id:b,rel:"stylesheet",type:"text/css",href:r+"?wab_dv\x3d"+window.deployVersion},document.getElementsByTagName("head")[0]);a(t,"load",function(){m.resolve("load")});
var f=setInterval(function(){var a;if(e.some(document.styleSheets,function(b){if(b.href&&b.href.substr(b.href.indexOf(c),b.href.length)===c)return a=b,!0}))try{!m.isFulfilled()&&(a.cssRules&&a.cssRules.length||a.rules&&a.rules.length)&&m.resolve("load"),clearInterval(f)}catch(oa){}},50);return m};G.changeLocation=function(a){window.history.pushState&&window.history.pushState({path:a},"",a)};G.urlToObject=function(a){var b=null;-1===a.indexOf("#")?(b=L.urlToObject(a),b.hash=null):(a=a.split("#"),b=
L.urlToObject(a[0]),b.hash=a[1]?-1<a[1].indexOf("\x3d")?l.queryToObject(a[1]):a[1]:null);return b};G.manifest=function(){function a(a){a.panels.forEach(function(a){a.uri="panels/"+a.name+"/Panel.js"});a.styles.forEach(function(a){a.uri="styles/"+a.name+"/style.css"});a.layouts.forEach(function(a){a.uri="layouts/"+a.name+"/config.json";a.icon="layouts/"+a.name+"/icon.png";a.RTLIcon="layouts/"+a.name+"/icon_rtl.png"})}return{addManifestProperies:function(b){b.icon||(b.icon=b.folderUrl+"images/icon.png?wab_dv\x3d"+
window.deployVersion);b.thumbnail||(b.thumbnail=b.folderUrl+"images/thumbnail.png");"theme"===b.category?a(b):("undefined"!==typeof b["2D"]&&(b.support2D=b["2D"]),"undefined"!==typeof b["3D"]&&(b.support3D=b["3D"]),"undefined"===typeof b["2D"]&&"undefined"===typeof b["3D"]&&(b.support2D=!0),delete b["2D"],delete b["3D"],"undefined"===typeof b.properties&&(b.properties={}),S.processWidgetProperties(b))},processManifestLabel:function(a,b){var c=b.split("-")[0];a.label=a.i18nLabels&&(a.i18nLabels[b]||
a.i18nLabels[c]||a.i18nLabels.defaultLabel)||a.label||a.name;a.layouts&&e.forEach(a.layouts,function(c){var d="i18nLabels_layout_"+c.name;c.label=a[d]&&(a[d][b]||a[d].defaultLabel)||c.label||c.name});a.styles&&e.forEach(a.styles,function(c){var d="i18nLabels_style_"+c.name;c.label=a[d]&&(a[d][b]||a[d].defaultLabel)||c.label||c.name})},addI18NLabel:function(a){var b=new d;if(a.i18nLabels)return b.resolve(a),b;a.i18nLabels={};if(a.properties&&!1===a.properties.hasLocale)return b.resolve(a),b;var c;
c=a.isRemote?a.amdFolder+"nls/strings.js":a.amdFolder+"nls/strings";require(G.getRequireConfig(),["dojo/i18n!"+c],function(c){var d={};d[dojoConfig.locale]=c;S.addI18NLabelToManifest(a,null,d);b.resolve(a)});return b}}}();G.getUniqueValues=function(a,b,c,g,m){return function(){var b=new d;g?b.resolve(g):b=J({url:a,content:{f:"json"},handleAs:"json",callbackParamName:"callback"});return b}().then(function(d){return G._getUniqueValues(a,b,c,d).then(function(a){var c=[],c=G.getFieldInfoByFieldName(d.fields,
b),g=null,t=0<=["esriFieldTypeOID","esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble"].indexOf(c.type);c&&(t&&(a=e.map(a,function(a){a=parseFloat(a);isNaN(a)&&(a=null);return a})),c.domain&&c.domain.codedValues&&0<c.domain.codedValues.length?(g={},e.forEach(c.domain.codedValues,function(a){g[a.code]=a.name})):d.typeIdField===b&&(g={},e.forEach(d.types,function(a){g[a.id]=a.name})));return c=e.map(a,function(a){var b=null,b=null===a||void 0===a?"\x3cNull\x3e":
g&&g.hasOwnProperty(a)?g[a]:t?m?G.localizeNumberByFieldInfo(a,m):G.localizeNumber(a):a;return{value:a,label:b}})})})};G._getUniqueValues=function(a,b,c,g){var m=new d;a=a.replace(/\/*$/g,"");c||(c="1\x3d1");var m=/\/ImageServer$/gi.test(a),t=-1<a.indexOf("MapServer/dynamicLayer");m||t?m=G._getUniqueValuesByQueryTask(a,b,c):(m=G.getFieldInfoByFieldName(g.fields,b),m=0<G._getCodedValuesOrTypesCount(m,g)?G._getUniqueValuesByQueryTask(a,b,c):G._getUniqueValuesByGenerateRenderer(a,b,c));return m};G._getCodedValuesOrTypesCount=
function(a,b){if(a){if(a.domain&&"codedValue"===a.domain.type&&a.domain.codedValues)return a.domain.codedValues.length;if(b.typeIdField===a.name&&b.types)return b.types.length}return 0};G._getUniqueValuesByQueryTask=function(a,b,c){var d=new P;d.where=c;d.returnDistinctValues=!0;d.returnGeometry=!1;d.outFields=[b];return(new K(a)).execute(d).then(function(a){var c=[];a.features&&0<a.features.length&&e.forEach(a.features,function(a){a&&a.attributes&&c.push(a.attributes[b])});return c})};G._getUniqueValuesByGenerateRenderer=
function(a,c,g){var m=new d,t=a.split("?");a=1<t.length?t[0].replace(/\/*$/g,"")+"/generateRenderer?"+t[1]:a.replace(/\/*$/g,"")+"/generateRenderer";c=b.stringify({type:"uniqueValueDef",uniqueValueFields:[c]});J({url:a,content:{classificationDef:c,f:"json",where:g},handleAs:"json",callbackParamName:"callback"}).then(k.hitch(this,function(a){var b=[];(a=a&&a.uniqueValueInfos)&&0<a.length&&(b=e.map(a,k.hitch(this,function(a){return a.value})));m.resolve(b)}),k.hitch(this,function(a){m.reject(a)}));
return m};G.isCodedValuesSupportFilter=function(a,b){var c=parseFloat(a.currentVersion);return b<=parseFloat(a.maxRecordCount)&&10.1<c};G.combineRadioCheckBoxWithLabel=function(a,b){var c=!1;if(a&&1===a.nodeType&&"input"===a.tagName.toLowerCase()){var d=a.getAttribute("type")||"",d=d.toLowerCase();if("radio"===d||"checkbox"===d)c=!0}d=!1;b&&1===b.nodeType&&"label"===b.tagName.toLowerCase()&&(d=!0);c&&d&&(c=a.getAttribute("id"),c||(c="input_"+G.getRandomString(),a.setAttribute("id",c)),b.setAttribute("for",
c),p.setStyle(b,"cursor","pointer"))};G.groupRadios=function(b,c){var d=[],g="radiogroup_"+G.getRandomString();e.forEach(b,function(b){b.name=g;c&&(b=a(b,"change",c),d.push(b))});return d};G.convertExtentToPolygon=function(a){var b=a.xmin,c=a.xmax,d=a.ymin,g=a.ymax;return new B({rings:[[[b,g],[c,g],[c,d],[b,d],[b,g]]],spatialReference:a.toJson()})};G.combineGeometries=function(a){function b(a){var b={points:[],spatialReference:a[0].spatialReference.toJson()};e.forEach(a,function(a){"point"===a.type?
b.points=b.points.concat([[a.x,a.y]]):"multipoint"===a.type&&(b.points=b.points.concat(a.points))});return new A(b)}function c(a){var b={paths:[],spatialReference:a[0].spatialReference.toJson()};e.forEach(a,function(a){b.paths=b.paths.concat(a.paths)});return new C(b)}function d(a){var b={rings:[],spatialReference:a[0].spatialReference.toJson()};e.forEach(a,function(a){"polygon"===a.type?b.rings=b.rings.concat(a.rings):"extent"===a.type&&(a=G.convertExtentToPolygon(a),b.rings=b.rings.concat(a.rings))});
return new B(b)}var g=null;if(a&&0<a.length)if(1===a.length)g=a[0];else{for(var m=null,t=null,r=null,v=null,f=0;f<a.length;f++){m=a[f];switch(m.type){case "point":case "multipoint":v="point";break;case "polyline":v="polyline";break;case "polygon":case "extent":v="polygon";break;default:return null}if(0===f)r=v;else if(r!==v)return null;if(f!==a.length-1&&(t=a[f+1],!m.spatialReference.equals(t.spatialReference)))return null}"point"===v?g=b(a):"polyline"===v?g=c(a):"polygon"===v&&(g=d(a))}return g};
G.combineGeometriesByGraphics=function(a){var b=null;a&&0<a.length&&(a=e.map(a,function(a){return a.geometry}),b=G.combineGeometries(a));return b};G.isFeaturelayerUrlSupportQuery=function(a,b){var c=!1,d=/\/featureserver\//gi.test(a);a=/\/mapserver\//gi.test(a);b=(b||"").toLowerCase();d?c=0<=b.indexOf("query"):a&&(c=0<=b.indexOf("data"));return c};G.isImageServiceSupportQuery=function(a){return 0<=(a||"").toLowerCase().indexOf("catalog")};G.isStringEndWith=function(a,b){return a.lastIndexOf(b)+b.length===
a.length};G.localizeNumber=function(a,b){var c=(a.toString().split(".")[1]||"").length,d="",d=b&&isFinite(b.places)&&b.places,d=0<d||0<c?"#,###,###,##0.0"+Array.prototype.join.call({length:0<d?d+1:c},"0"):"#,###,###,##0",c={locale:n.locale,pattern:d};k.mixin(c,b||{});try{return u.format(a,c)}catch(na){return console.error(na),a.toLocaleString()}};G.parseNumber=function(a,b){var c={locale:n.locale};k.mixin(c,b||{});try{return u.parse(a,c)}catch(la){return console.error(la),a}};G.localizeDate=function(a,
b){var c={locale:n.locale,fullYear:!0};k.mixin(c,b||{});"ar"===n.locale&&"long"!==c.formatLength&&"full"!==c.formatLength&&(c.formatLength="long");try{return m.format(a,c)}catch(la){return console.error(la),"date"===c.selector?a.toLocaleDateString():"time"===c.selector?a.toLocaleTimeString():a.toLocaleString()}};G.localizeNumberByFieldInfo=function(a,b){var c=null,c=k.exists("format.places",b)&&b.format.places,c=G.localizeNumber(a,{places:c});return k.exists("format.digitSeparator",b)&&!b.format.digitSeparator?
c.toString().replace(new RegExp("\\"+r.group,"g"),""):c};G.localizeDateByFieldInfo=function(a,b){var c=null;try{var d={date:a instanceof Date?a.getTime():a},g=k.exists("format.dateFormat",b)?b.format.dateFormat:"longMonthDayYear",c=v.substitute(d,"${date}",{dateFormat:{properties:["date"],formatter:"DateFormat"+w.prototype._dateFormats[g]}})}catch(aa){console.error(aa),c=a}return c};G.fieldFormatter={getFormattedUrl:function(a){if(a&&"string"===typeof a){var b=a.indexOf("http:");-1===b&&(b=a.indexOf("https:"));
if(-1<b&&-1===a.indexOf("href\x3d")){var c=a.indexOf(" ",b);-1===c&&(c=a.length);var d=-1<a.indexOf("\r\n",b)?a.indexOf("\r\n",b):-1<a.indexOf("\n",b)?a.indexOf("\n",b):c,c=d<c?d:c,d=a.substring(b,c);a=a.substring(0,b)+'\x3cA href\x3d"'+d+'" target\x3d"_blank"\x3e'+d+"\x3c/A\x3e"+a.substring(c,a.length)}}return null===a?"":a},getFormattedNumber:function(a,b){if("number"===typeof a){var c=(a.toString().split(".")[1]||"").length;a=G.localizeNumberByFieldInfo(a,{format:{places:b&&"number"===typeof b.places?
parseInt(b.places,10):c,digitSeparator:b&&b.digitSeparator}});return'\x3cspan class\x3d"jimu-numeric-value"\x3e'+(a||"")+"\x3c/span\x3e"}return a},getFormattedDate:function(a,b){if("number"===typeof a||a instanceof Date)a=G.localizeDateByFieldInfo(a,{format:b});return a||""},getCodedValue:function(a,b){if(a&&a.codedValues){for(var c=0,d=a.codedValues.length;c<d;c++){var g=a.codedValues[c];if(v.isDefined(b)&&k.exists("code",g)&&b.toString()===g.code.toString())return g.name}return b}return b||null},
getTypeName:function(a,b){for(var c=b.length,d=0;d<c;d++)if(a===b[d].id)return b[d].name;return a}};G.addRelativePathInCss=W;G.url={isAbsolute:function(a){return a?a.startWith("http")||a.startWith("/"):!1},removeQueryParamFromUrl:function(a,b){a=L.urlToObject(a);a.query&&delete a.query[b];b=a.path;for(var c in a.query)b=b===a.path?b+"?"+c+"\x3d"+a.query[c]:b+"\x26"+c+"\x3d"+a.query[c];return b},addQueryParamToUrl:function(a,b,c){a=L.urlToObject(a);a.query||(a.query={});a.query[b]=c;b=a.path;for(var d in a.query)b=
b===a.path?b+"?"+d+"\x3d"+a.query[d]:b+"\x26"+d+"\x3d"+a.query[d];return b}};G.processUrlInWidgetConfig=function(a,b){if(a)return a.startWith("data:")||a.startWith("http")||a.startWith("/")?a:a.startWith("${appPath}")?a.replace("${appPath}",window.appInfo.appPath):b+a};G.processUrlInAppConfig=function(a){if(a)return a.startWith("data:")||a.startWith("http")||a.startWith("/")?a:window.appInfo.appPath+a};G.getLocationUrlWithoutHashAndQueryParams=function(){var a=window.location,b=a.protocol+"//"+a.host+
a.pathname,a=L.urlToObject(a.href);a.query&&a.query.apiurl&&(b=G.url.addQueryParamToUrl(b,"apiurl",a.query.apiurl));return b};G.getDefaultWebMapThumbnail=function(){return require.toUrl("jimu/images/webmap.png")};G.invertColor=function(a){a=a.substring(1);3===a.length&&(a=a.slice(0,1)+a.slice(0,1)+a.slice(1,1)+a.slice(1,1)+a.slice(2,1)+a.slice(2,1));a=parseInt(a,16);return 7829367<a?"#000000":"#ffffff"};G.mixinAppConfigPosition=function(a,b){var c=k.clone(a);if(!b)return c;b=k.clone(b);var d=c.widgetOnScreen,
g=b.widgetOnScreen;g&&g.widgets&&("[object Object]"===Object.prototype.toString.call(g.widgets)?e.forEach(d.widgets,function(a,b){b=a.uri?a.uri:"ph_"+b;g.widgets[b]&&g.widgets[b].position&&(g.widgets[b].position.relativeTo||(g.widgets[b].position.relativeTo="map"),a.position=g.widgets[b].position)},this):e.forEach(g.widgets,function(a,b){a.position&&!a.position.relativeTo&&(a.position.relativeTo="map");d.widgets[b]&&a.position&&(d.widgets[b].position=a.position)}));g&&g.groups&&("[object Object]"===
Object.prototype.toString.call(g.groups)?e.forEach(d.groups,function(a,b){b=a.label?a.label:"g_"+b;g.groups[b]&&g.groups[b].panel&&g.groups[b].panel.position&&(g.groups[b].panel.position.relativeTo||(g.groups[b].panel.position.relativeTo="map"),a.panel.position=g.groups[b].panel.position)},this):(a=a.layoutDefinition?a.layoutDefinition.manager:"jimu/layoutManagers/AbsolutePositionLayoutManager","jimu/layoutManagers/AbsolutePositionLayoutManager"===a?e.forEach(g.groups,function(a,b){a.panel&&a.panel.position&&
!a.panel.position.relativeTo&&(a.panel.position.relativeTo="map");d.groups[b]&&a.panel&&a.panel.position&&(d.groups[b].panel.position=a.panel.position)}):"jimu/layoutManagers/GridLayoutManager"===a&&(d.groups=ha(d.groups,g.groups.map(function(a){return a.id})))));b.map&&b.map.position&&(c.map?c.map.position=b.map.position:c.map={position:b.map.position});b.widgetPool&&b.widgetPool.panel&&(b.widgetPool.panel.position&&!b.widgetPool.panel.position.relativeTo&&(b.widgetPool.panel.position.relativeTo=
"map"),c.widgetPool.panel.position=b.widgetPool.panel.position);b.mobileLayout&&(c.mobileLayout=b.mobileLayout);return c};G.handleGridLayoutOnScreenGroupChange=ha;G.template={groupIdentification:"groups\\[.+\\]",widgetIdentification:"widgets\\[.+\\]",getSearchRange:function(a,b,c){var d=-1;b=a.search(new RegExp(b));0<=b&&(a=a.slice(b,a.length),a=a.indexOf(c),d=b+a+c.length);return{firstPos:b,lastPos:d}},setConfigValue:function(a,b,c){fa(a,b,c)},getConfigValue:function(a,b){return fa(a,b)},setConfigValueWithId:function(a,
b,c){Z(a,b,c)},getConfigValueWithId:function(a,b){return Z(a,b)},getKeyInfo:function(a){var b=this.getWidgetIdByKey(a);if(null!==b)return{type:"widget",id:b};a=this.getGroupIdByKey(a);return null!==a?{type:"group",id:a}:{type:"unknow",id:null}},getWidgetIdByKey:function(a){var b=G.template.getSearchRange(a,G.template.widgetIdentification,"]");if(-1===b.firstPos)a=null;else{var c=a.slice(b.firstPos,b.lastPos);a=a.slice(b.firstPos+c.indexOf("[")+1,b.lastPos-1)}return a},getGroupIdByKey:function(a){var b=
G.template.getSearchRange(a,G.template.groupIdentification,"]");if(-1===b.firstPos)a=null;else{var c=a.slice(b.firstPos,b.lastPos);a=a.slice(b.firstPos+c.indexOf("[")+1,b.lastPos-1)}return a},getConfigedWidgetsByTemplateConfig:function(a){var b=[],c=G.template.widgetIdentification+"_config",d;e.forEach(a.configurationSettings,function(a){e.forEach(a.fields,function(a){a.fieldName&&(d=G.template.getSearchRange(a.fieldName,c,"]"),0<=d.firstPos&&(a=G.template.getWidgetIdByKey(a.fieldName),-1===b.indexOf(a)&&
b.push(a)))},this)},this);return b},mergeTemplateAppConfigToAppConfig:function(a,b,c){function d(a){var b=[];e.forEach(a,function(a){a&&b.push(a)},this);return b}var g=a.widgetOnScreen,m=a.portalUrl;b.values.webmap&&(a.map.itemId=b.values.webmap);c&&(a.map.mapOptions&&G.deleteMapOptions(a.map.mapOptions),a.map.portalUrl=m,b.values.app_title||(b.values.app_title=c.title),b.values.app_subtitle||(b.values.app_subtitle=c.snippet));for(var t in b.values)"webmap"!==t&&G.template.setConfigValueWithId(a,
t,b.values[t]);a.widgetPool.widgets=d(a.widgetPool.widgets);g.widgets=d(g.widgets);if(a.widgetPool.groups)for(b=0;b<a.widgetPool.groups.length;b++)a.widgetPool.groups[b].widgets=d(a.widgetPool.groups[b].widgets);if(g.groups)for(b=0;b<g.groups.length;b++)g.groups[b].widgets=d(g.groups[b].widgets);return a}};G.deleteMapOptions=function(a){a&&(delete a.extent,delete a.lods,delete a.center,delete a.scale,delete a.zoom,delete a.maxScale,delete a.maxZoom,delete a.minScale,delete a.minZoom)};G.graphicsExtent=
function(a,b){var c=null;try{0<a.length&&(c=U.graphicsExtent(a))&&"number"===typeof b&&0<b&&(c=c.expand(b))}catch(la){console.error(la)}return c};G.sanitizeHTML=function(a){return html_sanitize(a,function(a){return a},function(a){return a})};G.stripHTML=function(a){return a?-1<a.indexOf("\x3c")&&-1<a.indexOf("\x3e")?a.replace(/<(?:.|\s)*?>/g,""):a:a};G.encodeHTML=function(a){return String(a).replace(/&/g,"\x26amp;").replace(/</g,"\x26lt;").replace(/>/g,"\x26gt;").replace(/"/g,"\x26quot;").replace(/'/g,
"\x26#39;")};G.removeSuffixSlashes=function(a){return a.replace(/\/*$/g,"")};G.getBestDisplayAttributes=function(a,b){var c={},d=null,g;for(g in a)d=G.getBestDisplayValue(g,a,b),c[g]=d;return c};G.getBestDisplayValue=function(a,b,c){var d="",g=null;k.isArrayLike(c)?g=G.getFieldInfoByFieldName(c,a):"object"===typeof c&&c.name===a&&(g=c);g&&(d=b[a],"esriFieldTypeDate"===g.type?d&&(a=new Date(parseInt(d,10)),d=G._tryLocaleDate(a)):"number"===typeof d&&(g.domain&&"codedValue"===g.domain.type?e.some(g.domain.codedValues,
function(a){if(a.code===d)return d=a.name,!0}):d=G._tryLocaleNumber(d)));if(null===d||void 0===d)d="";return d};G._getCodedValues=function(a){var b=null;(a=a.domain)&&"codedValue"===a.type&&a.codedValues&&0<a.codedValues.length&&(b=a.codedValues,b=e.map(b,k.hitch(this,function(a){return{value:a.code,label:a.name}})));return b};G._getSubTypes=function(a){var b=null;a.typeIdField&&a.types&&0<a.types.length&&(b=e.map(a.types,k.hitch(this,function(a){return{value:a.id,label:a.name}})));return b};G._getCodedValueOrSubtypes=
function(a,b,c){var d=G.getFieldInfoByFieldName(b),g=G._getCodedValues(d);g&&0!==g.length||!a.typeIdField||(d=G._getSubTypes(a),a.typeIdField.toUpperCase()===b.toUpperCase()?g=d:void 0!==c&&null!==c&&a.types&&0<a.types.length&&e.some(a.types,k.hitch(this,function(a){return a.name===c?("codedValue"===a.type&&(g=a.codedValues),!0):!1})));return g};G._getDisplayValueForCodedValueOrSubtype=function(a,b,c,d){var g={isCodedValueOrSubtype:!1,displayValue:c};(a=G._getCodedValueOrSubtypes(a,b,d))&&0<a.length&&
e.some(a,k.hitch(this,function(a){return a.value===c?(g={isCodedValueOrSubtype:!0,displayValue:a.label},!0):!1}));return g};G.getDisplayValueForCodedValueOrSubtype=function(a,b,c){var d=c[b],g,m=a.typeIdField;c.hasOwnProperty(m)&&(g=c[m]);return G._getDisplayValueForCodedValueOrSubtype(a,b,d,g)};G.getDefaultPortalFieldInfo=function(a){var b=a.name,b={fieldName:b,label:a.alias||b,tooltip:"",visible:!1,format:null,stringFieldOption:"textbox"};switch(a.type){case "esriFieldTypeSmallInteger":case "esriFieldTypeInteger":b.format=
{places:0,digitSeparator:!0};break;case "esriFieldTypeSingle":case "esriFieldTypeDouble":b.format={places:2,digitSeparator:!0};break;case "esriFieldTypeDate":b.format={dateFormat:"longMonthDayYear"}}return b};G._tryLocaleNumber=function(a){var b=G.localizeNumber(a);if(null===b||void 0===b)b=a;return b};G._tryLocaleDate=function(a){var b=G.localizeDate(a);b||(b=a.toLocaleDateString());return b};G.getFieldInfoByFieldName=function(a,b){var c=null;a&&0<a.length&&e.some(a,k.hitch(this,function(a){return a.name===
b?(c=a,!0):!1}));return c};G.containsNonLatinCharacter=function(a){for(var b=0;b<a.length;b++)if(255<a.charCodeAt(b))return!0;return!1};G.has=function(a){var b=q(a);if(b)return b;if("ie"===a.toLowerCase()){a=0;var c=/MSIE (\d+\.\d+);/.test(navigator.userAgent),d=!!navigator.userAgent.match(/Trident\/7.0/),g=navigator.userAgent.indexOf("rv:11.0");c&&(a=Number(RegExp.$1));-1!==navigator.appVersion.indexOf("MSIE 10")&&(a=10);d&&-1!==g&&(a=11);return 11===a&&11||b}if("edge"===a.toLowerCase())return navigator.userAgent.split("Edge/")[1]||
b};G.detectUserAgent=function(){var a={},b={},c=navigator.userAgent,d=navigator.platform,g=c.match(/Web[kK]it[\/]{0,1}([\d.]+)/),m=c.match(/(Android);?[\s\/]+([\d.]+)?/),t=!!c.match(/\(Macintosh\; Intel /),r=c.match(/(iPad).*OS\s([\d_]+)/),v=c.match(/(iPod)(.*OS\s([\d_]+))?/),f=!r&&c.match(/(iPhone\sOS)\s([\d_]+)/),u=c.match(/(webOS|hpwOS)[\s\/]([\d.]+)/),d=/Win\d{2}|Windows/.test(d),w=c.match(/Windows Phone ([\d.]+)/),h=u&&c.match(/TouchPad/),l=c.match(/Kindle\/([\d.]+)/),n=c.match(/Silk\/([\d._]+)/),
e=c.match(/(BlackBerry).*Version\/([\d.]+)/),y=c.match(/(BB10).*Version\/([\d.]+)/),z=c.match(/(RIM\sTablet\sOS)\s([\d.]+)/),k=c.match(/PlayBook/),x=c.match(/Chrome\/([\d.]+)/)||c.match(/CriOS\/([\d.]+)/),p=c.match(/Firefox\/([\d.]+)/),q=c.match(/\((?:Mobile|Tablet); rv:([\d.]+)\).*Firefox\/[\d.]+/),B=c.match(/MSIE\s([\d.]+)/)||c.match(/Trident\/[\d](?=[^\?]+).*rv:([0-9.].)/),C=!x&&c.match(/(iPhone|iPod|iPad).*AppleWebKit(?!.*Safari)/),A=C||c.match(/Version\/([\d.]+)([^S](Safari)|[^M]*(Mobile)[^S]*(Safari))/);
b.webkit=!!g;b.webkit&&(b.version=g[1]);m&&(a.android=!0,a.version=m[2]);f&&!v&&(a.ios=a.iphone=!0,a.version=f[2].replace(/_/g,"."));r&&(a.ios=a.ipad=!0,a.version=r[2].replace(/_/g,"."));v&&(a.ios=a.ipod=!0,a.version=v[3]?v[3].replace(/_/g,"."):null);w&&(a.wp=!0,a.version=w[1]);u&&(a.webos=!0,a.version=u[2]);h&&(a.touchpad=!0);e&&(a.blackberry=!0,a.version=e[2]);y&&(a.bb10=!0,a.version=y[2]);z&&(a.rimtabletos=!0,a.version=z[2]);k&&(b.playbook=!0);l&&(a.kindle=!0,a.version=l[1]);n&&(b.silk=!0,b.version=
n[1]);!n&&a.android&&c.match(/Kindle Fire/)&&(b.silk=!0);x&&(b.chrome=!0,b.version=x[1]);p&&(b.firefox=!0,b.version=p[1]);q&&(a.firefoxos=!0,a.version=q[1]);B&&(b.ie=!0,b.version=B[1]);A&&(t||a.ios||d)&&(b.safari=!0,a.ios||(b.version=A[1]));C&&(b.webview=!0);a.tablet=!!(r||k||m&&!c.match(/Mobile/)||p&&c.match(/Tablet/)||B&&!c.match(/Phone/)&&c.match(/Touch/));a.phone=!(a.tablet||a.ipod||!(m||f||u||e||y||x&&c.match(/Android/)||x&&c.match(/CriOS\/([\d.]+)/)||p&&c.match(/Mobile/)||B&&c.match(/Touch/)));
return{os:a,browser:b}};G.isMobileUa=function(){var a=G.detectUserAgent();return!0===a.os.phone||!0===a.os.tablet?!0:!1};G.inMobileSize=function(){var a=p.getMarginBox(document.body);if(a.w<=window.jimuConfig.breakPoints[0]||a.h<=window.jimuConfig.breakPoints[0])return p.addClass(window.jimuConfig.layoutId,"jimu-ismobile"),!0;p.removeClass(window.jimuConfig.layoutId,"jimu-ismobile");return!1};G.getObjectIdField=function(a){if(a.objectIdField)return a.objectIdField;a=a.fields;for(var b=0;b<a.length;b++){var c=
a[b];if("esriFieldTypeOID"===c.type)return c.name}return null};G.isNeedHttpsButNot=function(){var a=navigator.geolocation,b=window.hasOwnProperty("isSecureContext");return(b&&window.isSecureContext||!b&&"https:"===window.location.protocol)&&a?!1:!0};G.toFeatureSet=function(a){var b=new I;"[object Object]"===Object.prototype.toString.call(a)&&(a=[a]);b.features=a;if(0<a.length){var c;e.some(a,function(a){if(a.geometry)return c=a,!0});if(c){a=c.getLayer();var d={};a&&(b.displayFieldName=a.displayField,
e.forEach(a.fields,k.hitch(this,function(a){var b=a.name;d[b]=a.alias||b})),b.fieldAliases=d);b.geometryType=c.geometry.type;b.spatialReference=c.geometry.spatialReference}}return b};G.showValidationErrorTipForFormDijit=function(a){try{!a.validate()&&a.domNode&&a.focusNode&&(a.focusNode.focus(),setTimeout(k.hitch(this,function(){a.focusNode.blur()}),100))}catch(ja){console.error(ja)}};G.getFeatureLayerDefinition=function(a){var b=null,c=a.graphics;a.graphics=[];var d=a.toJson();a.graphics=c;d&&(b=
d.layerDefinition);return b};G.simulateClickEvent=function(a){if(q("safari")){var b=document.createEvent("MouseEvents");b.initEvent("click",!0,!0);a.dispatchEvent(b)}else a.click()};G.getFeatureSetByLayerAndFeatures=function(a,b){var c=new I;c.fields=k.clone(a.fields);c.features=b;c.geometryType=a.geometryType;c.fieldAliases={};e.forEach(c.fields,k.hitch(this,function(a){var b=a.name;c.fieldAliases[b]=a.alias||b}));return c};G.featureAction=function(){return{zoomTo:function(a,b,c){c||(c={});c.hasOwnProperty("extentFactor")||
(c.extentFactor=1.2);if(a&&b&&0<b.length){var d=e.every(b,function(a){return a&&a.spatialReference&&a.type});if(e.every(b,function(a){return a&&a.geometry&&a.geometry.spatialReference&&a.geometry.type})||d)d&&(b=e.map(b,function(a){return{geometry:a}})),b=b.filter(function(a){a=a.geometry;return"point"===a.type?"undefined"!==typeof a.x&&"undefined"!==typeof a.y:a.getExtent()}),1===b.length&&"point"===b[0].type?(c=15,c=-1<a.getMaxZoom()?a.getMaxZoom():.1,a.centerAndZoom(b[0].geometry,c)):(b=U.graphicsExtent(b),
a.setExtent(b.expand(c.extentFactor)))}},flash:function(a,b){function c(a,b){e.forEach(g,function(c,d){c.setSymbol(b?a:m[d]||t)})}function d(a){return function(){setTimeout(function(){c(r,!0);g[0]&&b&&b.redraw();setTimeout(function(){c(null,!1);g[0]&&b&&b.redraw();a()},200)},200)}}if(e.every(a||[],function(a){return a&&a.geometry})){var g=a;a=g[0];var m=e.map(g,function(a){return a.symbol}),t=a.symbol||k.getObject("renderer.symbol",!1,b),r=null;b&&"esriGeometryPoint"===b.geometryType?r=new M(require.toUrl("jimu")+
"/images/flash.gif",20,20):(r=k.clone(t))&&(r.outline?r.outline.setColor("#ffc500"):r.setColor("#ffc500"));a&&t&&r&&b&&("esriGeometryPoint"===b.geometryType?(c(r,!0),b.redraw(),setTimeout(function(){c(null,!1);b.redraw()},2E3)):d(d(d(function(){})))())}},panTo:function(a,b){e.every(b||[],function(a){return a&&a.geometry})&&(0<b.length?b=U.graphicsExtent(b).getCenter():(b=b[0].geometry,b="polyline"===b.type||"polygon"===b.type?b.getExtent().getCenter():"extent"===b.type?b.getCenter():"multipoint"===
b.type?1<b.points.length?b.getExtent().getCenter():b.getPoint(0):b),a.centerAt(b))},showPopup:function(a,b){e.every(b||[],function(a){return a&&a.geometry})&&(a=a.infoWindow,a.setFeatures(b),b=b[0],"point"===b.geometry.type?a.show(b.geometry,{closetFirst:!0}):a.show(b.geometry.getExtent().getCenter(),{closetFirst:!0}))}}}();G.isInConfigOrPreviewWindow=function(){var a=!1;try{a=!window.isBuilder&&window.parent&&window.parent!==window&&window.parent.isBuilder}catch(ja){console.log(ja),a=!1}return!!a};
G.getAppHref=function(){var a="";return a=G.isInConfigOrPreviewWindow()?window.parent.location.href:window.location.href};G.getAppIdFromUrl=function(){var a=!0,b=G.getAppHref();if(-1!==b.indexOf("id\x3d")||-1!==b.indexOf("appid\x3d")||-1!==b.indexOf("apps"))a=!1;if(!0===a)return b;a=this.urlToObject(window.location.href);if(a.query&&(a.query.id||a.query.appid))return a.query.id||a.query.appid;if(window.appInfo){if(window.appInfo.id)return window.appInfo.id;if(window.appInfo.appPath){if(a=window.appInfo.appPath.split("/"),
a.length&&2<a.length)return a[a.length-2]}else console.error("CAN NOT getAppIdFromUrl")}};G.getEditorContentHeight=function(a,b,c){var g=new d;this._content=a;this._dom=b;this._domParam=c;var m=setTimeout(k.hitch(this,function(){clearTimeout(m);m=null;var a=0,b=this._domParam.contentWidth;try{var c=document.createElement("div");c.setAttribute("id","fakeContent");p.setStyle(c,"background-size","contain");c.innerHTML=this._content;this._dom.appendChild(c);if(c){var d=h("img",c);d&&d.length&&d.style({maxWidth:b-
20+"px"});p.setStyle(c,"position","absolute");p.setStyle(c,"width",b+"px");p.setStyle(c,"left","-99999px");p.setStyle(c,"top","-99999px");p.setStyle(c,"visibility","hidden");var t=p.getContentBox(c);t.h&&(a=t.h,a+=this._domParam.contentMarginTop+this._domParam.footerHeight+8)}}catch(Da){console.error("can't getEditorContentHeight"+Da),a=200}g.resolve(a)}),1500);return g};G.getBase64Data=function(a){var b=new d;if(a&&a.startWith("data:image"))b.resolve(a);else try{J({url:a,handleAs:"arraybuffer"}).then(function(a){var c=
new FileReader;c.onloadend=function(){b.resolve(c.result)};c.onerror=function(){b.resolve(null)};c.readAsDataURL(new Blob([a],{type:"image/png"}))},function(){b.resolve(null)})}catch(va){console.warn(va),b.resolve(null)}return b};G.getEditorTextColor=function(a,b){return{name:"dijit.editor.plugins.EditorTextColor",custom:{recordUID:G.getColorRecordName(a),forceAttr:b}}};G.getEditorBackgroundColor=function(a){return{name:"dijit.editor.plugins.EditorBackgroundColor",custom:{recordUID:G.getColorRecordName(a)}}};
G.getColorRecordName=function(a){return"wab_cr_"+(a||"")};G.b64toBlob=function(a,b,c){b=b||"";c=c||512;a=window.atob(a.replace(/^data:image\/(png|jpg|jpeg|gif);base64,/,""));for(var d=[],g=0;g<a.length;g+=c){for(var m=a.slice(g,g+c),t=Array(m.length),r=0;r<m.length;r++)t[r]=m.charCodeAt(r);m=new Uint8Array(t);d.push(m)}return new Blob(d,{type:b})};G.subtractionArray=function(a,b){for(var c=a.length-1;0<=c;c--)for(var d=a[c],g=b.length-1;0<=g;g--)if(d===b[g]){a.splice(c,1);b.splice(g,1);break}return a};
G.resourcesUrlToBlob=function(a){return J({url:a,handleAs:"blob"})};G.processItemResourceOfAppConfig=function(a,b){function d(a){var b=a.obj,c=a.key,d={obj:b,key:c};"number"===typeof a.i?(d.i=a.i,d.value=b[c][a.i]):d.value=b[c];return d}function g(a){for(var b in a)if("object"===typeof a[b])if(Array.isArray(a[b]))for(var c=a,d=b,t=0;t<c[d].length;t++)"string"===typeof c[d][t]?m(c,d,t):"object"===typeof c[d][t]&&g(c[d][t]);else g(a[b]);else"string"===typeof a[b]&&m(a,b)}function m(a,c,g){"number"===
typeof g?b.test(a[c][g])&&(v=b.func(d({obj:a,key:c,i:g})),"function"===typeof v.then?r.push(v):t.push(v)):b.test(a[c])&&(v=b.func(d({obj:a,key:c})),"function"===typeof v.then?r.push(v):t.push(v))}var t=[],r=[],v;g(a);return 0<r.length?c(r).then(function(b){0<t.length&&(b=b.concat(t));return{appConfig:a,result:b}}):{appConfig:a,result:t}};G.isEsriDomain=function(a){return/^https?:\/\/(?:[\w\-\_]+\.)+(?:esri|arcgis)\.com/.test(a)};G.uniqueArray=function(a){for(var b=[],c=0;c<a.length;c++)-1===b.indexOf(a[c])&&
b.push(a[c]);return b};G.isNotEmptyObject=function(a,b){return b?G.isObject(a)&&0<Object.keys(a).length&&Array.isArray(a):G.isObject(a)&&0<Object.keys(a).length};G.getMinOfArray=function(a){return Number(Math.min.apply(Math,a))};G.getDataSchemaFromLayerDefinition=function(a){var b=a.fields.filter(function(a){return"esriFieldTypeOID"===a.type}),b=0<b.length?b[0]:null;return{geometryType:a.geometryType,fields:a.fields,displayField:a.displayField,objectIdField:b,typeIdField:a.typeIdField}};G.isVaildPointGeometry=
function(a){return a&&"point"===a.type&&N(a.x)&&N(a.y)};G.isVaildExtent=function(a){return a&&N(a.xmin)&&N(a.ymin)&&N(a.xmax)&&N(a.ymax)};return G})},"dojo/NodeList-traverse":function(){define(["./query","./_base/lang","./_base/array"],function(k,e,p){var q=k.NodeList;e.extend(q,{_buildArrayFromCallback:function(n){for(var l=[],h=0;h<this.length;h++){var f=n.call(this[h],this[h],l);f&&(l=l.concat(f))}return l},_getUniqueAsNodeList:function(n){for(var l=[],h=0,f;f=n[h];h++)1==f.nodeType&&-1==p.indexOf(l,
f)&&l.push(f);return this._wrap(l,null,this._NodeListCtor)},_getUniqueNodeListWithParent:function(n,l){n=this._getUniqueAsNodeList(n);n=l?k._filterResult(n,l):n;return n._stash(this)},_getRelatedUniqueNodes:function(n,l){return this._getUniqueNodeListWithParent(this._buildArrayFromCallback(l),n)},children:function(n){return this._getRelatedUniqueNodes(n,function(l,h){return e._toArray(l.childNodes)})},closest:function(n,l){return this._getRelatedUniqueNodes(null,function(h,f){do if(k._filterResult([h],
n,l).length)return h;while(h!=l&&(h=h.parentNode)&&1==h.nodeType);return null})},parent:function(n){return this._getRelatedUniqueNodes(n,function(l,h){return l.parentNode})},parents:function(n){return this._getRelatedUniqueNodes(n,function(l,h){for(h=[];l.parentNode;)l=l.parentNode,h.push(l);return h})},siblings:function(n){return this._getRelatedUniqueNodes(n,function(l,h){h=[];for(var f=l.parentNode&&l.parentNode.childNodes,d=0;d<f.length;d++)f[d]!=l&&h.push(f[d]);return h})},next:function(n){return this._getRelatedUniqueNodes(n,
function(l,h){for(l=l.nextSibling;l&&1!=l.nodeType;)l=l.nextSibling;return l})},nextAll:function(n){return this._getRelatedUniqueNodes(n,function(l,h){for(h=[];l=l.nextSibling;)1==l.nodeType&&h.push(l);return h})},prev:function(n){return this._getRelatedUniqueNodes(n,function(l,h){for(l=l.previousSibling;l&&1!=l.nodeType;)l=l.previousSibling;return l})},prevAll:function(n){return this._getRelatedUniqueNodes(n,function(l,h){for(h=[];l=l.previousSibling;)1==l.nodeType&&h.push(l);return h})},andSelf:function(){return this.concat(this._parent)},
first:function(){return this._wrap(this[0]&&[this[0]]||[],this)},last:function(){return this._wrap(this.length?[this[this.length-1]]:[],this)},even:function(){return this.filter(function(n,l){return 0!=l%2})},odd:function(){return this.filter(function(n,l){return 0==l%2})}});return q})},"dojo/number":function(){define(["./_base/lang","./i18n","./i18n!./cldr/nls/number","./string","./regexp"],function(k,e,p,q,n){var l={};k.setObject("dojo.number",l);l.format=function(f,d){d=k.mixin({},d||{});var c=
e.normalizeLocale(d.locale),c=e.getLocalization("dojo.cldr","number",c);d.customs=c;c=d.pattern||c[(d.type||"decimal")+"Format"];return isNaN(f)||Infinity==Math.abs(f)?null:l._applyPattern(f,c,d)};l._numberPatternRE=/[#0,]*[#0](?:\.0*#*)?/;l._applyPattern=function(f,d,c){c=c||{};var a=c.customs.group,b=c.customs.decimal;d=d.split(";");var g=d[0];d=d[0>f?1:0]||"-"+g;if(-1!=d.indexOf("%"))f*=100;else if(-1!=d.indexOf("\u2030"))f*=1E3;else if(-1!=d.indexOf("\u00a4"))a=c.customs.currencyGroup||a,b=c.customs.currencyDecimal||
b,d=d.replace(/([\s\xa0]*)(\u00a4{1,3})([\s\xa0]*)/,function(a,b,d,g){return(a=c[["symbol","currency","displayName"][d.length-1]]||c.currency||"")?b+a+g:""});else if(-1!=d.indexOf("E"))throw Error("exponential notation not supported");var u=l._numberPatternRE,g=g.match(u);if(!g)throw Error("unable to find a number expression in pattern: "+d);!1===c.fractional&&(c.places=0);return d.replace(u,l._formatAbsolute(f,g[0],{decimal:b,group:a,places:c.places,round:c.round}))};l.round=function(f,d,c){c=10/
(c||10);return(c*+f).toFixed(d)/c};if(0==(.9).toFixed()){var h=l.round;l.round=function(f,d,c){var a=Math.pow(10,-d||0),b=Math.abs(f);if(!f||b>=a)a=0;else if(b/=a,.5>b||.95<=b)a=0;return h(f,d,c)+(0<f?a:-a)}}l._formatAbsolute=function(f,d,c){c=c||{};!0===c.places&&(c.places=0);Infinity===c.places&&(c.places=6);d=d.split(".");var a="string"==typeof c.places&&c.places.indexOf(","),b=c.places;a?b=c.places.substring(a+1):0<=b||(b=(d[1]||[]).length);0>c.round||(f=l.round(f,b,c.round));f=String(Math.abs(f)).split(".");
var g=f[1]||"";d[1]||c.places?(a&&(c.places=c.places.substring(0,a)),a=void 0!==c.places?c.places:d[1]&&d[1].lastIndexOf("0")+1,a>g.length&&(f[1]=q.pad(g,a,"0",!0)),b<g.length&&(f[1]=g.substr(0,b))):f[1]&&f.pop();b=d[0].replace(",","");a=b.indexOf("0");-1!=a&&(a=b.length-a,a>f[0].length&&(f[0]=q.pad(f[0],a)),-1==b.indexOf("#")&&(f[0]=f[0].substr(f[0].length-a)));var b=d[0].lastIndexOf(","),u,m;-1!=b&&(u=d[0].length-b-1,d=d[0].substr(0,b),b=d.lastIndexOf(","),-1!=b&&(m=d.length-b-1));d=[];for(b=f[0];b;)a=
b.length-u,d.push(0<a?b.substr(a):b),b=0<a?b.slice(0,a):"",m&&(u=m,m=void 0);f[0]=d.reverse().join(c.group||",");return f.join(c.decimal||".")};l.regexp=function(f){return l._parseInfo(f).regexp};l._parseInfo=function(f){f=f||{};var d=e.normalizeLocale(f.locale),d=e.getLocalization("dojo.cldr","number",d),c=f.pattern||d[(f.type||"decimal")+"Format"],a=d.group,b=d.decimal,g=1;if(-1!=c.indexOf("%"))g/=100;else if(-1!=c.indexOf("\u2030"))g/=1E3;else{var u=-1!=c.indexOf("\u00a4");u&&(a=d.currencyGroup||
a,b=d.currencyDecimal||b)}d=c.split(";");1==d.length&&d.push("-"+d[0]);d=n.buildGroupRE(d,function(c){c="(?:"+n.escapeString(c,".")+")";return c.replace(l._numberPatternRE,function(c){var d={signed:!1,separator:f.strict?a:[a,""],fractional:f.fractional,decimal:b,exponent:!1};c=c.split(".");var m=f.places;1==c.length&&1!=g&&(c[1]="###");1==c.length||0===m?d.fractional=!1:(void 0===m&&(m=f.pattern?c[1].lastIndexOf("0")+1:Infinity),m&&void 0==f.fractional&&(d.fractional=!0),!f.places&&m<c[1].length&&
(m+=","+c[1].length),d.places=m);c=c[0].split(",");1<c.length&&(d.groupSize=c.pop().length,1<c.length&&(d.groupSize2=c.pop().length));return"("+l._realNumberRegexp(d)+")"})},!0);u&&(d=d.replace(/([\s\xa0]*)(\u00a4{1,3})([\s\xa0]*)/g,function(a,b,c,d){a=n.escapeString(f[["symbol","currency","displayName"][c.length-1]]||f.currency||"");if(!a)return"";b=b?"[\\s\\xa0]":"";d=d?"[\\s\\xa0]":"";return f.strict?b+a+d:(b&&(b+="*"),d&&(d+="*"),"(?:"+b+a+d+")?")}));return{regexp:d.replace(/[\xa0 ]/g,"[\\s\\xa0]"),
group:a,decimal:b,factor:g}};l.parse=function(f,d){d=l._parseInfo(d);f=(new RegExp("^"+d.regexp+"$")).exec(f);if(!f)return NaN;var c=f[1];if(!f[1]){if(!f[2])return NaN;c=f[2];d.factor*=-1}c=c.replace(new RegExp("["+d.group+"\\s\\xa0]","g"),"").replace(d.decimal,".");return c*d.factor};l._realNumberRegexp=function(f){f=f||{};"places"in f||(f.places=Infinity);"string"!=typeof f.decimal&&(f.decimal=".");"fractional"in f&&!/^0/.test(f.places)||(f.fractional=[!0,!1]);"exponent"in f||(f.exponent=[!0,!1]);
"eSigned"in f||(f.eSigned=[!0,!1]);var d=l._integerRegexp(f),c=n.buildGroupRE(f.fractional,function(a){var b="";a&&0!==f.places&&(b="\\"+f.decimal,b=Infinity==f.places?"(?:"+b+"\\d+)?":b+("\\d{"+f.places+"}"));return b},!0),a=n.buildGroupRE(f.exponent,function(a){return a?"([eE]"+l._integerRegexp({signed:f.eSigned})+")":""}),d=d+c;c&&(d="(?:(?:"+d+")|(?:"+c+"))");return d+a};l._integerRegexp=function(f){f=f||{};"signed"in f||(f.signed=[!0,!1]);"separator"in f?"groupSize"in f||(f.groupSize=3):f.separator=
"";var d=n.buildGroupRE(f.signed,function(a){return a?"[-+]":""},!0),c=n.buildGroupRE(f.separator,function(a){if(!a)return"(?:\\d+)";a=n.escapeString(a);" "==a?a="\\s":"\u00a0"==a&&(a="\\s\\xa0");var b=f.groupSize,c=f.groupSize2;return c?(a="(?:0|[1-9]\\d{0,"+(c-1)+"}(?:["+a+"]\\d{"+c+"})*["+a+"]\\d{"+b+"})",0<b-c?"(?:"+a+"|(?:0|[1-9]\\d{0,"+(b-1)+"}))":a):"(?:0|[1-9]\\d{0,"+(b-1)+"}(?:["+a+"]\\d{"+b+"})*)"},!0);return d+c};return l})},"dojo/i18n":function(){define("./_base/kernel require ./has ./_base/array ./_base/config ./_base/lang ./_base/xhr ./json module".split(" "),
function(k,e,p,q,n,l,h,f,d){p.add("dojo-preload-i18n-Api",1);h=k.i18n={};var c=/(^.*(^|\/)nls)(\/|$)([^\/]*)\/?([^\/]*)/,a=function(a,b,c,d){var g=[c+d];b=b.split("-");for(var m="",t=0;t<b.length;t++)if(m+=(m?"-":"")+b[t],!a||a[m])g.push(c+m+"/"+d),g.specificity=m;return g},b={},g=function(a,b,c){c=c?c.toLowerCase():k.locale;a=a.replace(/\./g,"/");b=b.replace(/\./g,"/");return/root/i.test(c)?a+"/nls/"+b:a+"/nls/"+c+"/"+b},u=k.getL10nName=function(a,b,c){return a=d.id+"!"+g(a,b,c)},m=function(c,d,
g,m,t,r){c([d],function(v){var f=l.clone(v.root||v.ROOT),u=a(!v._v1x&&v,t,g,m);c(u,function(){for(var a=1;a<u.length;a++)f=l.mixin(l.clone(f),arguments[a]);b[d+"/"+t]=f;f.$locale=u.specificity;r()})})},r=function(a){var b=n.extraLocale||[],b=l.isArray(b)?b:[b];b.push(a);return b},t=function(a,d,g){var t=c.exec(a),v=t[1]+"/",u=t[5]||t[4],h=v+u,n=(t=t[5]&&t[4])||k.locale||"",e=h+"/"+n,t=t?[n]:r(n),B=t.length,C=function(){--B||g(l.delegate(b[e]))},n=a.split("*"),A="preload"==n[1];if(p("dojo-preload-i18n-Api")){if(A&&
(b[a]||(b[a]=1,z(n[2],f.parse(n[3]),1,d)),g(1)),(n=A)||(y&&w.push([a,d,g]),n=y&&!b[e]),n)return}else if(A){g(1);return}q.forEach(t,function(a){var c=h+"/"+a;p("dojo-preload-i18n-Api")&&x(c);b[c]?C():m(d,h,v,u,a,C)})};p("dojo-preload-i18n-Api");var v=h.normalizeLocale=function(a){a=a?a.toLowerCase():k.locale;return"root"==a?"ROOT":a},y=0,w=[],z=h._preloadLocalizations=function(a,c,d,g){function m(a,b){g([a],b)}function r(a,b){for(a=a.split("-");a.length;){if(b(a.join("-")))return;a.pop()}b("ROOT")}
function f(){for(--y;!y&&w.length;)t.apply(null,w.shift())}function u(d){d=v(d);r(d,function(t){if(0<=q.indexOf(c,t)){var v=a.replace(/\./g,"/")+"_"+t;y++;m(v,function(a){for(var c in a){var m=a[c],v=c.match(/(.+)\/([^\/]+)$/),u;if(v&&(u=v[2],v=v[1]+"/",m._localized)){var w;if("ROOT"===t){var h=w=m._localized;delete m._localized;h.root=m;b[e.toAbsMid(c)]=h}else w=m._localized,b[e.toAbsMid(v+u+"/"+t)]=m;t!==d&&function(a,c,m,t){var v=[],u=[];r(d,function(b){t[b]&&(v.push(e.toAbsMid(a+b+"/"+c)),u.push(e.toAbsMid(a+
c+"/"+b)))});v.length?(y++,g(v,function(){for(var g=v.length-1;0<=g;g--)m=l.mixin(l.clone(m),arguments[g]),b[u[g]]=m;b[e.toAbsMid(a+c+"/"+d)]=l.clone(m);f()})):b[e.toAbsMid(a+c+"/"+d)]=m}(v,u,m,w)}}f()});return!0}return!1})}g=g||e;u();q.forEach(k.config.extraLocale,u)},x=function(){},x=function(a){for(var c,d=a.split("/"),g=k.global[d[0]],m=1;g&&m<d.length-1;g=g[d[m++]]);g&&((c=g[d[m]])||(c=g[d[m].replace(/-/g,"_")]),c&&(b[a]=c));return c};h.getLocalization=function(a,b,c){var d;a=g(a,b,c);t(a,e,
function(a){d=a});return d};return l.mixin(h,{dynamic:!0,normalize:function(a,b){return/^\./.test(a)?b(a):a},load:t,cache:b,getL10nName:u})})},"dojo/string":function(){define(["./_base/kernel","./_base/lang"],function(k,e){var p=/[&<>'"\/]/g,q={"\x26":"\x26amp;","\x3c":"\x26lt;","\x3e":"\x26gt;",'"':"\x26quot;","'":"\x26#x27;","/":"\x26#x2F;"},n={};e.setObject("dojo.string",n);n.escape=function(l){return l?l.replace(p,function(h){return q[h]}):""};n.rep=function(l,h){if(0>=h||!l)return"";for(var f=
[];;){h&1&&f.push(l);if(!(h>>=1))break;l+=l}return f.join("")};n.pad=function(l,h,f,d){f||(f="0");l=String(l);h=n.rep(f,Math.ceil((h-l.length)/f.length));return d?l+h:h+l};n.substitute=function(l,h,f,d){d=d||k.global;f=f?e.hitch(d,f):function(c){return c};return l.replace(/\$\{([^\s\:\}]*)(?:\:([^\s\:\}]+))?\}/g,function(c,a,b){if(""==a)return"$";c=e.getObject(a,!1,h);b&&(c=e.getObject(b,!1,d).call(d,c,a));b=f(c,a);if("undefined"===typeof b)throw Error('string.substitute could not find key "'+a+'" in template');
return b.toString()})};n.trim=String.prototype.trim?e.trim:function(l){l=l.replace(/^\s+/,"");for(var h=l.length-1;0<=h;h--)if(/\S/.test(l.charAt(h))){l=l.substring(0,h+1);break}return l};return n})},"dojo/date/locale":function(){define("../_base/lang ../_base/array ../date ../cldr/supplemental ../i18n ../regexp ../string ../i18n!../cldr/nls/gregorian module".split(" "),function(k,e,p,q,n,l,h,f,d){function c(a,b,c,d){return d.replace(/([a-z])\1*/ig,function(m){var t,r,v=m.charAt(0);m=m.length;var f=
["abbr","wide","narrow"];switch(v){case "G":t=b[4>m?"eraAbbr":"eraNames"][0>a.getFullYear()?0:1];break;case "y":t=a.getFullYear();switch(m){case 1:break;case 2:if(!c.fullYear){t=String(t);t=t.substr(t.length-2);break}default:r=!0}break;case "Q":case "q":t=Math.ceil((a.getMonth()+1)/3);r=!0;break;case "M":case "L":t=a.getMonth();3>m?(t+=1,r=!0):(v=["months","L"==v?"standAlone":"format",f[m-3]].join("-"),t=b[v][t]);break;case "w":t=g._getWeekOfYear(a,0);r=!0;break;case "d":t=a.getDate();r=!0;break;
case "D":t=g._getDayOfYear(a);r=!0;break;case "e":case "c":if(t=a.getDay(),2>m){t=(t-q.getFirstDayOfWeek(c.locale)+8)%7;break}case "E":t=a.getDay();3>m?(t+=1,r=!0):(v=["days","c"==v?"standAlone":"format",f[m-3]].join("-"),t=b[v][t]);break;case "a":v=12>a.getHours()?"am":"pm";t=c[v]||b["dayPeriods-format-wide-"+v];break;case "h":case "H":case "K":case "k":r=a.getHours();switch(v){case "h":t=r%12||12;break;case "H":t=r;break;case "K":t=r%12;break;case "k":t=r||24}r=!0;break;case "m":t=a.getMinutes();
r=!0;break;case "s":t=a.getSeconds();r=!0;break;case "S":t=Math.round(a.getMilliseconds()*Math.pow(10,m-3));r=!0;break;case "v":case "z":if(t=g._getZone(a,!0,c))break;m=4;case "Z":v=g._getZone(a,!1,c);v=[0>=v?"+":"-",h.pad(Math.floor(Math.abs(v)/60),2),h.pad(Math.abs(v)%60,2)];4==m&&(v.splice(0,0,"GMT"),v.splice(3,0,":"));t=v.join("");break;default:throw Error("dojo.date.locale.format: invalid pattern char: "+d);}r&&(t=h.pad(t,m));return t})}function a(a,b,c,d){var g=function(a){return a};b=b||g;
c=c||g;d=d||g;var m=a.match(/(''|[^'])+/g),t="'"==a.charAt(0);e.forEach(m,function(a,d){a?(m[d]=(t?c:b)(a.replace(/''/g,"'")),t=!t):m[d]=""});return d(m.join(""))}function b(a,b,c,d){d=l.escapeString(d);c.strict||(d=d.replace(" a"," ?a"));return d.replace(/([a-z])\1*/ig,function(d){var g;g=d.charAt(0);var m=d.length,t="",r="";c.strict?(1<m&&(t="0{"+(m-1)+"}"),2<m&&(r="0{"+(m-2)+"}")):(t="0?",r="0{0,2}");switch(g){case "y":g="\\d{2,4}";break;case "M":case "L":2<m?(g=b["months-"+("L"==g?"standAlone":
"format")+"-"+u[m-3]].slice(0).join("|"),c.strict||(g=g.replace(/\./g,""),g="(?:"+g+")\\.?")):g="1[0-2]|"+t+"[1-9]";break;case "D":g="[12][0-9][0-9]|3[0-5][0-9]|36[0-6]|"+t+"[1-9][0-9]|"+r+"[1-9]";break;case "d":g="3[01]|[12]\\d|"+t+"[1-9]";break;case "w":g="[1-4][0-9]|5[0-3]|"+t+"[1-9]";break;case "E":case "e":case "c":g=".+?";break;case "h":g="1[0-2]|"+t+"[1-9]";break;case "k":g="1[01]|"+t+"\\d";break;case "H":g="1\\d|2[0-3]|"+t+"\\d";break;case "K":g="1\\d|2[0-4]|"+t+"[1-9]";break;case "m":case "s":g=
"[0-5]\\d";break;case "S":g="\\d{"+m+"}";break;case "a":m=c.am||b["dayPeriods-format-wide-am"];t=c.pm||b["dayPeriods-format-wide-pm"];g=m+"|"+t;c.strict||(m!=m.toLowerCase()&&(g+="|"+m.toLowerCase()),t!=t.toLowerCase()&&(g+="|"+t.toLowerCase()),-1!=g.indexOf(".")&&(g+="|"+g.replace(/\./g,"")));g=g.replace(/\./g,"\\.");break;default:g=".*"}a&&a.push(d);return"("+g+")"}).replace(/[\xa0 ]/g,"[\\s\\xa0]")}var g={};k.setObject(d.id.replace(/\//g,"."),g);g._getZone=function(a,b,c){return b?p.getTimezoneName(a):
a.getTimezoneOffset()};g.format=function(b,d){d=d||{};var m=n.normalizeLocale(d.locale),t=d.formatLength||"short",m=g._getGregorianBundle(m),r=[];b=k.hitch(this,c,b,m,d);if("year"==d.selector)return a(m["dateFormatItem-yyyy"]||"yyyy",b);var v;"date"!=d.selector&&(v=d.timePattern||m["timeFormat-"+t])&&r.push(a(v,b));"time"!=d.selector&&(v=d.datePattern||m["dateFormat-"+t])&&r.push(a(v,b));return 1==r.length?r[0]:m["dateTimeFormat-"+t].replace(/\'/g,"").replace(/\{(\d+)\}/g,function(a,b){return r[b]})};
g.regexp=function(a){return g._parseInfo(a).regexp};g._parseInfo=function(c){c=c||{};var d=n.normalizeLocale(c.locale),d=g._getGregorianBundle(d),m=c.formatLength||"short",t=c.datePattern||d["dateFormat-"+m],r=c.timePattern||d["timeFormat-"+m],m="date"==c.selector?t:"time"==c.selector?r:d["dateTimeFormat-"+m].replace(/\{(\d+)\}/g,function(a,b){return[r,t][b]}),f=[];return{regexp:a(m,k.hitch(this,b,f,d,c)),tokens:f,bundle:d}};g.parse=function(a,b){var c=/[\u200E\u200F\u202A\u202E]/g,d=g._parseInfo(b),
m=d.tokens,t=d.bundle;a=(new RegExp("^"+d.regexp.replace(c,"")+"$",d.strict?"":"i")).exec(a&&a.replace(c,""));if(!a)return null;var r=["abbr","wide","narrow"],v=[1970,0,1,0,0,0,0],f="";a=e.every(a,function(a,c){if(!c)return!0;var d=m[c-1];c=d.length;d=d.charAt(0);switch(d){case "y":if(2!=c&&b.strict)v[0]=a;else if(100>a)a=Number(a),d=""+(new Date).getFullYear(),c=100*d.substring(0,2),d=Math.min(Number(d.substring(2,4))+20,99),v[0]=a<d?c+a:c-100+a;else{if(b.strict)return!1;v[0]=a}break;case "M":case "L":if(2<
c){if(c=t["months-"+("L"==d?"standAlone":"format")+"-"+r[c-3]].concat(),b.strict||(a=a.replace(".","").toLowerCase(),c=e.map(c,function(a){return a.replace(".","").toLowerCase()})),a=e.indexOf(c,a),-1==a)return!1}else a--;v[1]=a;break;case "E":case "e":case "c":c=t["days-"+("c"==d?"standAlone":"format")+"-"+r[c-3]].concat();b.strict||(a=a.toLowerCase(),c=e.map(c,function(a){return a.toLowerCase()}));a=e.indexOf(c,a);if(-1==a)return!1;break;case "D":v[1]=0;case "d":v[2]=a;break;case "a":c=b.am||t["dayPeriods-format-wide-am"];
d=b.pm||t["dayPeriods-format-wide-pm"];if(!b.strict){var g=/\./g;a=a.replace(g,"").toLowerCase();c=c.replace(g,"").toLowerCase();d=d.replace(g,"").toLowerCase()}if(b.strict&&a!=c&&a!=d)return!1;f=a==d?"p":a==c?"a":"";break;case "K":24==a&&(a=0);case "h":case "H":case "k":if(23<a)return!1;v[3]=a;break;case "m":v[4]=a;break;case "s":v[5]=a;break;case "S":v[6]=a}return!0});c=+v[3];"p"===f&&12>c?v[3]=c+12:"a"===f&&12==c&&(v[3]=0);c=new Date(v[0],v[1],v[2],v[3],v[4],v[5],v[6]);b.strict&&c.setFullYear(v[0]);
var u=m.join(""),d=-1!=u.indexOf("d"),u=-1!=u.indexOf("M");if(!a||u&&c.getMonth()>v[1]||d&&c.getDate()>v[2])return null;if(u&&c.getMonth()<v[1]||d&&c.getDate()<v[2])c=p.add(c,"hour",1);return c};var u=["abbr","wide","narrow"],m=[],r={};g.addCustomFormats=function(a,b){m.push({pkg:a,name:b});r={}};g._getGregorianBundle=function(a){if(r[a])return r[a];var b={};e.forEach(m,function(c){c=n.getLocalization(c.pkg,c.name,a);b=k.mixin(b,c)},this);return r[a]=b};g.addCustomFormats(d.id.replace(/\/date\/locale$/,
".cldr"),"gregorian");g.getNames=function(a,b,c,d){var m;d=g._getGregorianBundle(d);a=[a,c,b];"standAlone"==c&&(c=a.join("-"),m=d[c],1==m[0]&&(m=void 0));a[1]="format";return(m||d[a.join("-")]).concat()};g.isWeekend=function(a,b){b=q.getWeekend(b);a=(a||new Date).getDay();b.end<b.start&&(b.end+=7,a<b.start&&(a+=7));return a>=b.start&&a<=b.end};g._getDayOfYear=function(a){return p.difference(new Date(a.getFullYear(),0,1,a.getHours()),a)+1};g._getWeekOfYear=function(a,b){1==arguments.length&&(b=0);
var c=(new Date(a.getFullYear(),0,1)).getDay(),d=(c-b+7)%7,d=Math.floor((g._getDayOfYear(a)+d-1)/7);c==b&&d++;return d};return g})},"dojo/date":function(){define(["./has","./_base/lang"],function(k,e){var p={getDaysInMonth:function(e){var n=e.getMonth();return 1==n&&p.isLeapYear(e)?29:[31,28,31,30,31,30,31,31,30,31,30,31][n]},isLeapYear:function(e){e=e.getFullYear();return!(e%400)||!(e%4)&&!!(e%100)},getTimezoneName:function(e){var n=e.toString(),l="",h=n.indexOf("(");if(-1<h)l=n.substring(++h,n.indexOf(")"));
else if(h=/([A-Z\/]+) \d{4}$/,n=n.match(h))l=n[1];else if(n=e.toLocaleString(),h=/ ([A-Z\/]+)$/,n=n.match(h))l=n[1];return"AM"==l||"PM"==l?"":l},compare:function(e,n,l){e=new Date(+e);n=new Date(+(n||new Date));"date"==l?(e.setHours(0,0,0,0),n.setHours(0,0,0,0)):"time"==l&&(e.setFullYear(0,0,0),n.setFullYear(0,0,0));return e>n?1:e<n?-1:0},add:function(e,n,l){var h=new Date(+e),f=!1,d="Date";switch(n){case "day":break;case "weekday":var c;(n=l%5)?c=parseInt(l/5):(n=0<l?5:-5,c=0<l?(l-5)/5:(l+5)/5);
var a=e.getDay(),b=0;6==a&&0<l?b=1:0==a&&0>l&&(b=-1);a+=n;if(0==a||6==a)b=0<l?2:-2;l=7*c+n+b;break;case "year":d="FullYear";f=!0;break;case "week":l*=7;break;case "quarter":l*=3;case "month":f=!0;d="Month";break;default:d="UTC"+n.charAt(0).toUpperCase()+n.substring(1)+"s"}if(d)h["set"+d](h["get"+d]()+l);f&&h.getDate()<e.getDate()&&h.setDate(0);return h},difference:function(e,n,l){n=n||new Date;l=l||"day";var h=n.getFullYear()-e.getFullYear(),f=1;switch(l){case "quarter":e=e.getMonth();n=n.getMonth();
f=Math.floor(n/3)+1+4*h-(Math.floor(e/3)+1);break;case "weekday":h=Math.round(p.difference(e,n,"day"));l=parseInt(p.difference(e,n,"week"));if(0==h%7)h=5*l;else{var f=0,d=e.getDay(),c=n.getDay();l=parseInt(h/7);n=h%7;e=new Date(e);e.setDate(e.getDate()+7*l);e=e.getDay();if(0<h)switch(!0){case 6==d:f=-1;break;case 0==d:f=0;break;case 6==c:f=-1;break;case 0==c:f=-2;break;case 5<e+n:f=-2}else if(0>h)switch(!0){case 6==d:f=0;break;case 0==d:f=1;break;case 6==c:f=2;break;case 0==c:f=1;break;case 0>e+n:f=
2}h=h+f-2*l}f=h;break;case "year":f=h;break;case "month":f=n.getMonth()-e.getMonth()+12*h;break;case "week":f=parseInt(p.difference(e,n,"day")/7);break;case "day":f/=24;case "hour":f/=60;case "minute":f/=60;case "second":f/=1E3;case "millisecond":f*=n.getTime()-e.getTime()}return Math.round(f)}};e.mixin(e.getObject("dojo.date",!0),p);return p})},"dojo/cldr/supplemental":function(){define(["../_base/lang","../i18n"],function(k,e){var p={};k.setObject("dojo.cldr.supplemental",p);p.getFirstDayOfWeek=
function(e){e={bd:5,mv:5,ae:6,af:6,bh:6,dj:6,dz:6,eg:6,iq:6,ir:6,jo:6,kw:6,ly:6,ma:6,om:6,qa:6,sa:6,sd:6,sy:6,ye:6,ag:0,ar:0,as:0,au:0,br:0,bs:0,bt:0,bw:0,by:0,bz:0,ca:0,cn:0,co:0,dm:0,"do":0,et:0,gt:0,gu:0,hk:0,hn:0,id:0,ie:0,il:0,"in":0,jm:0,jp:0,ke:0,kh:0,kr:0,la:0,mh:0,mm:0,mo:0,mt:0,mx:0,mz:0,ni:0,np:0,nz:0,pa:0,pe:0,ph:0,pk:0,pr:0,py:0,sg:0,sv:0,th:0,tn:0,tt:0,tw:0,um:0,us:0,ve:0,vi:0,ws:0,za:0,zw:0}[p._region(e)];return void 0===e?1:e};p._region=function(k){k=e.normalizeLocale(k);k=k.split("-");
var n=k[1];n?4==n.length&&(n=k[2]):n={aa:"et",ab:"ge",af:"za",ak:"gh",am:"et",ar:"eg",as:"in",av:"ru",ay:"bo",az:"az",ba:"ru",be:"by",bg:"bg",bi:"vu",bm:"ml",bn:"bd",bo:"cn",br:"fr",bs:"ba",ca:"es",ce:"ru",ch:"gu",co:"fr",cr:"ca",cs:"cz",cv:"ru",cy:"gb",da:"dk",de:"de",dv:"mv",dz:"bt",ee:"gh",el:"gr",en:"us",es:"es",et:"ee",eu:"es",fa:"ir",ff:"sn",fi:"fi",fj:"fj",fo:"fo",fr:"fr",fy:"nl",ga:"ie",gd:"gb",gl:"es",gn:"py",gu:"in",gv:"gb",ha:"ng",he:"il",hi:"in",ho:"pg",hr:"hr",ht:"ht",hu:"hu",hy:"am",
ia:"fr",id:"id",ig:"ng",ii:"cn",ik:"us","in":"id",is:"is",it:"it",iu:"ca",iw:"il",ja:"jp",ji:"ua",jv:"id",jw:"id",ka:"ge",kg:"cd",ki:"ke",kj:"na",kk:"kz",kl:"gl",km:"kh",kn:"in",ko:"kr",ks:"in",ku:"tr",kv:"ru",kw:"gb",ky:"kg",la:"va",lb:"lu",lg:"ug",li:"nl",ln:"cd",lo:"la",lt:"lt",lu:"cd",lv:"lv",mg:"mg",mh:"mh",mi:"nz",mk:"mk",ml:"in",mn:"mn",mo:"ro",mr:"in",ms:"my",mt:"mt",my:"mm",na:"nr",nb:"no",nd:"zw",ne:"np",ng:"na",nl:"nl",nn:"no",no:"no",nr:"za",nv:"us",ny:"mw",oc:"fr",om:"et",or:"in",os:"ge",
pa:"in",pl:"pl",ps:"af",pt:"br",qu:"pe",rm:"ch",rn:"bi",ro:"ro",ru:"ru",rw:"rw",sa:"in",sd:"in",se:"no",sg:"cf",si:"lk",sk:"sk",sl:"si",sm:"ws",sn:"zw",so:"so",sq:"al",sr:"rs",ss:"za",st:"za",su:"id",sv:"se",sw:"tz",ta:"in",te:"in",tg:"tj",th:"th",ti:"et",tk:"tm",tl:"ph",tn:"za",to:"to",tr:"tr",ts:"za",tt:"ru",ty:"pf",ug:"cn",uk:"ua",ur:"pk",uz:"uz",ve:"za",vi:"vn",wa:"be",wo:"sn",xh:"za",yi:"il",yo:"ng",za:"cn",zh:"cn",zu:"za",ace:"id",ady:"ru",agq:"cm",alt:"ru",amo:"ng",asa:"tz",ast:"es",awa:"in",
bal:"pk",ban:"id",bas:"cm",bax:"cm",bbc:"id",bem:"zm",bez:"tz",bfq:"in",bft:"pk",bfy:"in",bhb:"in",bho:"in",bik:"ph",bin:"ng",bjj:"in",bku:"ph",bqv:"ci",bra:"in",brx:"in",bss:"cm",btv:"pk",bua:"ru",buc:"yt",bug:"id",bya:"id",byn:"er",cch:"ng",ccp:"in",ceb:"ph",cgg:"ug",chk:"fm",chm:"ru",chp:"ca",chr:"us",cja:"kh",cjm:"vn",ckb:"iq",crk:"ca",csb:"pl",dar:"ru",dav:"ke",den:"ca",dgr:"ca",dje:"ne",doi:"in",dsb:"de",dua:"cm",dyo:"sn",dyu:"bf",ebu:"ke",efi:"ng",ewo:"cm",fan:"gq",fil:"ph",fon:"bj",fur:"it",
gaa:"gh",gag:"md",gbm:"in",gcr:"gf",gez:"et",gil:"ki",gon:"in",gor:"id",grt:"in",gsw:"ch",guz:"ke",gwi:"ca",haw:"us",hil:"ph",hne:"in",hnn:"ph",hoc:"in",hoj:"in",ibb:"ng",ilo:"ph",inh:"ru",jgo:"cm",jmc:"tz",kaa:"uz",kab:"dz",kaj:"ng",kam:"ke",kbd:"ru",kcg:"ng",kde:"tz",kdt:"th",kea:"cv",ken:"cm",kfo:"ci",kfr:"in",kha:"in",khb:"cn",khq:"ml",kht:"in",kkj:"cm",kln:"ke",kmb:"ao",koi:"ru",kok:"in",kos:"fm",kpe:"lr",krc:"ru",kri:"sl",krl:"ru",kru:"in",ksb:"tz",ksf:"cm",ksh:"de",kum:"ru",lag:"tz",lah:"pk",
lbe:"ru",lcp:"cn",lep:"in",lez:"ru",lif:"np",lis:"cn",lki:"ir",lmn:"in",lol:"cd",lua:"cd",luo:"ke",luy:"ke",lwl:"th",mad:"id",mag:"in",mai:"in",mak:"id",man:"gn",mas:"ke",mdf:"ru",mdh:"ph",mdr:"id",men:"sl",mer:"ke",mfe:"mu",mgh:"mz",mgo:"cm",min:"id",mni:"in",mnk:"gm",mnw:"mm",mos:"bf",mua:"cm",mwr:"in",myv:"ru",nap:"it",naq:"na",nds:"de","new":"np",niu:"nu",nmg:"cm",nnh:"cm",nod:"th",nso:"za",nus:"sd",nym:"tz",nyn:"ug",pag:"ph",pam:"ph",pap:"bq",pau:"pw",pon:"fm",prd:"ir",raj:"in",rcf:"re",rej:"id",
rjs:"np",rkt:"in",rof:"tz",rwk:"tz",saf:"gh",sah:"ru",saq:"ke",sas:"id",sat:"in",saz:"in",sbp:"tz",scn:"it",sco:"gb",sdh:"ir",seh:"mz",ses:"ml",shi:"ma",shn:"mm",sid:"et",sma:"se",smj:"se",smn:"fi",sms:"fi",snk:"ml",srn:"sr",srr:"sn",ssy:"er",suk:"tz",sus:"gn",swb:"yt",swc:"cd",syl:"bd",syr:"sy",tbw:"ph",tcy:"in",tdd:"cn",tem:"sl",teo:"ug",tet:"tl",tig:"er",tiv:"ng",tkl:"tk",tmh:"ne",tpi:"pg",trv:"tw",tsg:"ph",tts:"th",tum:"mw",tvl:"tv",twq:"ne",tyv:"ru",tzm:"ma",udm:"ru",uli:"fm",umb:"ao",unr:"in",
unx:"in",vai:"lr",vun:"tz",wae:"ch",wal:"et",war:"ph",xog:"ug",xsr:"np",yao:"mz",yap:"fm",yav:"cm",zza:"tr"}[k[0]];return n};p.getWeekend=function(e){var n=p._region(e);e={"in":0,af:4,dz:4,ir:4,om:4,sa:4,ye:4,ae:5,bh:5,eg:5,il:5,iq:5,jo:5,kw:5,ly:5,ma:5,qa:5,sd:5,sy:5,tn:5}[n];n={af:5,dz:5,ir:5,om:5,sa:5,ye:5,ae:6,bh:5,eg:6,il:6,iq:6,jo:6,kw:6,ly:6,ma:6,qa:6,sd:6,sy:6,tn:6}[n];void 0===e&&(e=6);void 0===n&&(n=0);return{start:e,end:n}};return p})},"dojox/encoding/base64":function(){define(["dojo/_base/lang"],
function(k){k=k.getObject("dojox.encoding.base64",!0);k.encode=function(e){for(var k=[],q=e.length,n=q%3,q=q-n,l=0;l<q;){var h=e[l++]<<16|e[l++]<<8|e[l++];k.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(h>>>18&63));k.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(h>>>12&63));k.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(h>>>6&63));k.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(h&
63))}switch(n){case 2:h=e[l++]<<16|e[l++]<<8;k.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(h>>>18&63));k.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(h>>>12&63));k.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(h>>>6&63));k.push("\x3d");break;case 1:h=e[l++]<<16,k.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(h>>>18&63)),k.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(h>>>
12&63)),k.push("\x3d"),k.push("\x3d")}return k.join("")};k.decode=function(e){e=e.split("");for(var k=[],q=e.length;"\x3d"==e[--q];);for(var n=0;n<q;){var l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(e[n++])<<18;n<=q&&(l|="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(e[n++])<<12);n<=q&&(l|="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(e[n++])<<6);n<=q&&(l|="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(e[n++]));
k.push(l>>>16&255);k.push(l>>>8&255);k.push(l&255)}for(;0==k[k.length-1];)k.pop();return k};return k})},"esri/lang":function(){define("dojo/_base/array dojo/_base/json dojo/_base/kernel dojo/_base/lang dojo/date dojo/has dojo/number dojo/date/locale ./kernel".split(" "),function(k,e,p,q,n,l,h,f,d){function c(a){return void 0!==a&&null!==a}function a(a){return c(a)?a:""}function b(b,d,g){var m=g.match(/([^\(]+)(\([^\)]+\))?/i),t=q.trim(m[1]);g=d[b];var m=e.fromJson((m[2]?q.trim(m[2]):"()").replace(/^\(/,
"({").replace(/\)$/,"})")),r=m.utcOffset;if(-1===k.indexOf(u,t))t=q.getObject(t),q.isFunction(t)&&(g=t(g,b,d,m));else if("number"===typeof g||"string"===typeof g&&g&&!isNaN(Number(g)))switch(g=Number(g),t){case "NumberFormat":return h.format(g,m);case "DateString":b=new Date(g);if(m.local||m.systemLocale)return m.systemLocale?b.toLocaleDateString()+(m.hideTime?"":" "+b.toLocaleTimeString()):b.toDateString()+(m.hideTime?"":" "+b.toTimeString());b=b.toUTCString();m.hideTime&&(b=b.replace(/\s+\d\d\:\d\d\:\d\d\s+(utc|gmt)/i,
""));return b;case "DateFormat":return b=new Date(g),c(r)&&(b=n.add(b,"minute",b.getTimezoneOffset()-r)),f.format(b,m)}return a(g)}function g(a,b){var c;if(b)for(c in a)a.hasOwnProperty(c)&&(void 0===a[c]?delete a[c]:a[c]instanceof Object&&g(a[c],!0));else for(c in a)a.hasOwnProperty(c)&&void 0===a[c]&&delete a[c];return a}var u=["NumberFormat","DateString","DateFormat"],m=/<\/?[^>]+>/g;return{valueOf:function(a,b){for(var c in a)if(a[c]==b)return c;return null},stripTags:function(a){if(a){var b=
typeof a;if("string"===b)a=a.replace(m,"");else if("object"===b)for(var c in a)(b=a[c])&&"string"===typeof b&&(b=b.replace(m,"")),a[c]=b}return a},substitute:function(d,g,m){var t,r,v;c(m)&&(q.isObject(m)?(t=m.first,r=m.dateFormat,v=m.numberFormat):t=m);if(g&&"${*}"!==g)return q.replace(g,q.hitch({obj:d},function(c,d){c=d.split(":");return 1<c.length?(d=c[0],c.shift(),b(d,this.obj,c.join(":"))):r&&-1!==k.indexOf(r.properties||"",d)?b(d,this.obj,r.formatter||"DateString"):v&&-1!==k.indexOf(v.properties||
"",d)?b(d,this.obj,v.formatter||"NumberFormat"):a(this.obj[d])}),/\$\{([^\}]+)\}/g);g=[];for(var f in d)if(m=d[f],r&&-1!==k.indexOf(r.properties||"",f)?m=b(f,d,r.formatter||"DateString"):v&&-1!==k.indexOf(v.properties||"",f)&&(m=b(f,d,v.formatter||"NumberFormat")),g.push(f+" \x3d "+a(m)+"\x3cbr/\x3e"),t)break;return g.join("")},filter:function(a,b,c){b=[q.isString(a)?a.split(""):a,c||p.global,q.isString(b)?new Function("item","index","array",b):b];c={};var d;a=b[0];for(d in a)b[2].call(b[d],a[d],
d,a)&&(c[d]=a[d]);return c},startsWith:function(a,b,c){c=c||0;return a.indexOf(b,c)===c},endsWith:function(a,b,c){if("number"!==typeof c||!isFinite(c)||Math.floor(c)!==c||c>a.length)c=a.length;c-=b.length;a=a.indexOf(b,c);return-1!==a&&a===c},isDefined:c,fixJson:g}})},"esri/kernel":function(){define(["dojo/_base/kernel","dojo/_base/config","dojo/has"],function(k,e,p){k=function(){return this}();var q=k.location,n=q.pathname;p=q.protocol;q={version:"3.23",_appBaseUrl:p+"//"+q.host+n.substring(0,n.lastIndexOf(n.split("/")[n.split("/").length-
1]))};e.noGlobals||(k.esri=q);(q.dijit=q.dijit||{})._arcgisUrl=("http:"===p||"https:"===p?p:"http:")+"//www.arcgis.com/sharing/rest";return q})},"esri/arcgis/utils":function(){define("require dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/_base/Deferred dojo/_base/json dojo/_base/url dojo/on dojo/DeferredList dojo/dom-construct dojo/sniff dojox/gfx/_base ../kernel ../config ../Color ../lang ../request ../SpatialReference ../map ../urlUtils ../geometry/ScreenPoint ../geometry/Extent ../geometry/webMercatorUtils ../symbols/jsonUtils ../renderers/jsonUtils ../dijit/PopupTemplate ../dijit/Popup ../tasks/query ../tasks/GeometryService ../layers/ArcGISTiledMapServiceLayer ../layers/FeatureLayer dojo/i18n!../nls/jsapi".split(" "),
function(k,e,p,q,n,l,h,f,d,c,a,b,g,u,m,r,t,v,y,w,z,x,A,C,B,E,D,F,I,M,L,J){function P(a){return t({url:H.arcgisUrl+"/"+a.itemId+"/data",content:{f:"json"},callbackParamName:"callback"},{disableIdentityLookup:!0,_preLookup:!0})}function K(a,b){var c={f:"json"};b&&(c.token=b);return t({url:a,content:c,callbackParamName:"callback"},{disableIdentityLookup:!0})}function U(a){!a.layerDefinition||a.layerDefinition.drawingInfo&&a.layerDefinition.drawingInfo.labelingInfo||(a.showLabels=!1);a.itemProperties.layerDefinition&&
(a.layerDefinition?(a.layerDefinition.drawingInfo||(a.layerDefinition.drawingInfo=a.itemProperties.layerDefinition.drawingInfo),r.isDefined(a.layerDefinition.definitionExpression)||(a.layerDefinition.definitionExpression=a.itemProperties.layerDefinition.definitionExpression),r.isDefined(a.layerDefinition.minScale)||(a.layerDefinition.minScale=a.itemProperties.layerDefinition.minScale),r.isDefined(a.layerDefinition.maxScale)||(a.layerDefinition.maxScale=a.itemProperties.layerDefinition.maxScale)):
a.layerDefinition=a.itemProperties.layerDefinition);!a.itemProperties.popupInfo||a.popupInfo||a.disablePopup||(a.popupInfo=a.itemProperties.popupInfo);r.isDefined(a.itemProperties.showLabels)&&!r.isDefined(a.showLabels)&&(a.showLabels=a.itemProperties.showLabels);r.isDefined(a.itemProperties.showLegend)&&!r.isDefined(a.showLegend)&&(a.showLegend=a.itemProperties.showLegend);r.isDefined(a.itemProperties.refreshInterval)&&!r.isDefined(a.refreshInterval)&&(a.refreshInterval=a.itemProperties.refreshInterval)}
function O(a){U(a);a.itemProperties.layerDefinition&&a.layerDefinition&&(!r.isDefined(a.layerDefinition.maximumTrackPoints)&&r.isDefined(a.itemProperties.layerDefinition.maximumTrackPoints)&&(a.layerDefinition.maximumTrackPoints=a.itemProperties.layerDefinition.maximumTrackPoints),!a.layerDefinition.definitionGeometry&&a.itemProperties.layerDefinition.definitionGeometry&&(a.layerDefinition.definitionGeometry=a.itemProperties.layerDefinition.definitionGeometry));a.itemProperties.purgeOptions&&!a.purgeOptions&&
(a.purgeOptions=a.itemProperties.purgeOptions)}function S(a,b){var c=new n;b=a.itemData;var g=[],m=[];p.forEach(b.operationalLayers,function(a){if(a.itemId&&!a.type){var b=a.url.toLowerCase();-1<b.indexOf("/featureserver")||-1<b.indexOf("/mapserver/")?(m.push(a),g.push(P(a))):-1<b.indexOf("/mapserver")&&-1===b.indexOf("/mapserver/")&&(!a.layers||!r.isDefined(a.minScale)&&!r.isDefined(a.maxScale))?(m.push(a),g.push(P(a))):-1<b.indexOf("/imageserver")&&!r.isDefined(a.minScale)&&!r.isDefined(a.maxScale)?
(m.push(a),g.push(P(a))):-1<b.indexOf("/streamserver")&&(m.push(a),g.push(P(a)))}});b.baseMap&&b.baseMap.baseMapLayers&&p.forEach(b.baseMap.baseMapLayers,function(a){a.itemId&&"VectorTileLayer"!==a.layerType&&(m.push(a),g.push(P(a)))});if(0<g.length){var t={};(new d(g)).addCallback(function(b){p.forEach(m,function(a,c){if((c=b[c][1])&&!(c instanceof Error)&&(t[a.itemId]=c,!a.type)){var d=a.url.toLowerCase();(-1<d.indexOf("/featureserver")||-1<d.indexOf("/mapserver/"))&&c.layers?p.forEach(c.layers,
function(b){var c="/featureserver/"+b.id;(c=d.match(c+"$")==c)||(c="/mapserver/"+b.id,c=d.match(c+"$")==c);c&&(a.itemProperties=b,U(a))}):-1<d.indexOf("/streamserver")?(a.itemProperties=c,O(a)):-1<d.indexOf("/mapserver")?(c.layers&&!a.layers&&(a.layers=c.layers),r.isDefined(c.minScale)&&!r.isDefined(a.minScale)&&(a.minScale=c.minScale),r.isDefined(c.maxScale)&&!r.isDefined(a.maxScale)&&(a.maxScale=c.maxScale),r.isDefined(c.refreshInterval)&&!r.isDefined(a.refreshInterval)&&(a.refreshInterval=c.refreshInterval),
c.visibleLayers&&!a.visibleLayers&&(a.visibleLayers=c.visibleLayers)):-1<d.indexOf("/imageserver")&&(r.isDefined(c.minScale)&&!r.isDefined(a.minScale)&&(a.minScale=c.minScale),r.isDefined(c.maxScale)&&!r.isDefined(a.maxScale)&&(a.maxScale=c.maxScale),r.isDefined(c.refreshInterval)&&!r.isDefined(a.refreshInterval)&&(a.refreshInterval=c.refreshInterval),!c.popupInfo||a.popupInfo||a.disablePopup||(a.popupInfo=c.popupInfo),c.renderingRule&&!a.renderingRule&&(a.renderingRule=c.renderingRule,c.renderingRule.functionName&&
(a.renderingRule.rasterFunction=c.renderingRule.functionName)),c.bandIds&&!a.bandIds&&(a.bandIds=c.bandIds),c.mosaicRule&&!a.mosaicRule&&(a.mosaicRule=c.mosaicRule),c.format&&!a.format&&(a.format=c.format),r.isDefined(c.compressionQuality)&&!r.isDefined(a.compressionQuality)&&(a.compressionQuality=c.compressionQuality),!c.layerDefinition||!c.layerDefinition.definitionExpression||r.isDefined(a.layerDefinition)&&r.isDefined(a.layerDefinition.definitionExpression)||(a.layerDefinition=a.layerDefinition||
{},a.layerDefinition.definitionExpression=c.layerDefinition.definitionExpression))}});a.relatedItemsData=t;c.callback(a)})}else c.callback(a);return c}function Y(a,b){var c=new n,d=a.itemData,m=d.baseMap.baseMapLayers[0];if("BingMapsAerial"===m.type||"BingMapsRoad"===m.type||"BingMapsHybrid"===m.type)if(m.portalUrl&&g.id)delete b.bingMapsKey,g.id.checkSignInStatus(w.urlToObject(H.arcgisUrl).path).then(e.hitch(null,function(a,b,c,d,g){K(m.portalUrl,g.token).then(e.hitch(null,W,a,b,c,d),e.hitch(null,
ca,a,b,c,d))},a,b,d,c),e.hitch(null,function(a,b,c,d,g){K(m.portalUrl).then(e.hitch(null,W,a,b,c,d),e.hitch(null,ca,a,b,c,d))},a,b,d,c));else if(b.bingMapsKey){var t=new Ta({bingMapsKey:b.bingMapsKey,mapStyle:Ta.MAP_STYLE_AERIAL});q.connect(t,"onLoad",e.hitch(this,function(){c.callback([a,b])}));q.connect(t,"onError",function(g){delete b.bingMapsKey;a.itemData=ha(d);m=a.itemData.baseMap.baseMapLayers[0];m.errors=[];m.errors.push({message:"The owner of the application has not provided a valid Bing Key for the Bing Map it includes. Switching to Esri layers."});
c.callback([a,b])})}else a.itemData=ha(d),m=a.itemData.baseMap.baseMapLayers[0],m.errors=[],m.errors.push({message:"The owner of the application has not provided a Bing Key for the Bing Map it includes. Switching to Esri layers."}),c.callback([a,b]);else c.callback([a,b]);return c}function N(a){var b=new n,c,d;a=a.itemData;var g=a.baseMap&&a.baseMap.baseMapLayers;if(nb&&!nb.supported())for(a=0;a<g.length;a++){var m=g[a];if(!m.isReference){"VectorTileLayer"===m.layerType&&(c=m.itemId,d=a);break}}c?
qa(c,!1).addBoth(function(a){var c=/^https?:\/\/basemaps(dev)?\.arcgis\.com\/arcgis\/rest\/services\/World_Basemap\/VectorTileServer/i;a&&a.item&&c.test(a.item.url)&&(g[d]={id:"FB_"+m.id,layerType:"ArcGISTiledMapServiceLayer",opacity:"opacity"in m?m.opacity:1,visibility:"visibility"in m?m.visibility:!0,url:"https://services.arcgisonline.com/arcgis/rest/services/World_Street_Map/MapServer"});b.resolve()}):b.resolve();return b}function W(a,b,c,d,g){g.bingKey?(b.bingMapsKey=g.bingKey,g=new Ta({bingMapsKey:b.bingMapsKey,
mapStyle:Ta.MAP_STYLE_AERIAL}),q.connect(g,"onLoad",e.hitch(this,function(){d.callback([a,b])})),q.connect(g,"onError",function(g){delete b.bingMapsKey;a.itemData=ha(c);g=a.itemData.baseMap.baseMapLayers[0];g.errors=[];g.errors.push({message:"The owner of the map has not provided a valid Bing Key for the Bing Map it includes. Switching to Esri layers."});d.callback([a,b])})):ca(a,b,c,d)}function ca(a,b,c,d){delete b.bingMapsKey;a.itemData=ha(c);c=a.itemData.baseMap.baseMapLayers[0];c.errors=[];c.errors.push({message:"The owner of the map has not provided a Bing Key for the Bing Map it includes. Switching to Esri layers."});
d.callback([a,b])}function ha(a){a.baseMap="BingMapsAerial"===a.baseMap.baseMapLayers[0].type?{title:"Imagery",baseMapLayers:[{id:"World_Imagery_2017",visibility:!0,opacity:1,url:"https://services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer"}]}:"BingMapsRoad"===a.baseMap.baseMapLayers[0].type?{title:"Streets",baseMapLayers:[{id:"World_Street_Map_8421",opacity:1,visibility:!0,url:"https://services.arcgisonline.com/ArcGIS/rest/services/World_Street_Map/MapServer"}]}:{title:"Imagery with Labels",
baseMapLayers:[{id:"World_Imagery_6611",opacity:1,visibility:!0,url:"https://services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer"},{id:"World_Boundaries_and_Places_1145",isReference:!0,opacity:1,visibility:!0,url:"https://services.arcgisonline.com/ArcGIS/rest/services/Reference/World_Boundaries_and_Places/MapServer"}]};return a}function fa(a,b,c,d){var g=a.dynamicLayerInfos||a.layerInfos,m=b.layers;if(m&&g)if(d.usePopupManager){var t;p.forEach(g,function(a){var b=a.id;if(!a.subLayerIds)for(a=
0;a<m.length;a++){var d=m[a];if(d.id===b&&d.popupInfo){t||(t={});t[b]={infoTemplate:new c(d.popupInfo),layerUrl:d.layerUrl};break}}});t&&a.setInfoTemplates(t)}else{var v=[],f=[],u=[],w=[],h=[],l=[];p.forEach(g,function(b){var c=b.id;if(!b.subLayerIds&&-1!==p.indexOf(a.visibleLayers,c))for(b=0;b<m.length;b++){var d=m[b];if(d.id===c){f.push(c);v.push(d.popupInfo);u.push(d.layerUrl||"");d.layerDefinition&&d.layerDefinition.definitionExpression?w.push(d.layerDefinition.definitionExpression):w.push("");
h.push(r.isDefined(d.minScale)?d.minScale:null);l.push(r.isDefined(d.maxScale)?d.maxScale:null);break}}});v.length&&(a.__popups=v,a.__popupIds=f,a.__popupUrls=u,a.__popupWhereClauses=w,a.__popupMinScales=h,a.__popupMaxScales=l,a.__resourceInfo=b.resourceInfo)}}function Z(a){if(!a)return!1;var b=(new h(H.arcgisUrl)).authority;return-1!==a.indexOf(".arcgis.com/")||-1!==a.indexOf(b)}function G(a){return a?-1!==a.indexOf("/services.arcgisonline.com/")||-1!==a.indexOf("/server.arcgisonline.com/"):!1}function ia(a){"https:"===
location.protocol&&(Z(a)||G(a))&&(a=a.replace("http:","https:"));return a}function sa(a,b,c){var d=[],g;a.displayLevels||(d=p.map(a.resourceInfo.tileInfo.lods,function(a){return a.level}));a.exclusionAreas&&(g=e.clone(a.exclusionAreas),g=p.map(g,function(a){a.geometry=new x(a.geometry);return a}));d=new M(ia(a.url),{resourceInfo:a.resourceInfo,opacity:a.opacity,visible:a.visibility,displayLevels:a.displayLevels||d,id:a.id,minScale:a.minScale,maxScale:a.maxScale,refreshInterval:a.refreshInterval,exclusionAreas:g});
c.ignorePopups||fa(d,a,b,c);return d}function wa(a,b){if(!a||!b||0===b.length)return[];b=","+b+",";var c=[],d,g=",";for(d=0;d<a.length;d++)if(null!==a[d].subLayerIds){if(-1===b.indexOf(","+a[d].id+",")||-1<g.indexOf(","+a[d].id+","))g+=a[d].subLayerIds.toString()+","}else-1<b.indexOf(","+a[d].id+",")&&-1===g.indexOf(","+a[d].id+",")&&c.push(a[d].id);return c}function ua(a,b,c){var d=new Pa;d.format="png24";a.resourceInfo&&a.resourceInfo.supportedImageFormatTypes&&-1<a.resourceInfo.supportedImageFormatTypes.indexOf("PNG32")&&
(d.format="png32");var d=new ea(ia(a.url),{resourceInfo:a.resourceInfo,opacity:a.opacity,visible:a.visibility,id:a.id,imageParameters:d,minScale:a.minScale,maxScale:a.maxScale,refreshInterval:a.refreshInterval}),g=a.visibleLayers;if(!a.visibleLayers){var m="";p.forEach(d.layerInfos,function(a){a.defaultVisibility&&(m+=(0<m.length?",":"")+a.id)});g=m}if(a.layers&&0<a.layers.length){var t=[],r=[],v,f=[],u,w;p.forEach(a.layers,function(b){var c=b.layerDefinition;c&&c.definitionExpression&&(t[b.id]=c.definitionExpression);
if(c&&c.source){v=null;w=c.source;if("mapLayer"===w.type){var d=p.filter(a.resourceInfo.layers,function(a){return a.id===w.mapLayerId});d.length&&(v=e.mixin(d[0],b))}else v=e.mixin({},b);v&&(v.source=w,delete v.popupInfo,v=new Q(v),a.visibleLayers&&(d="string"==typeof a.visibleLayers?a.visibleLayers.split(","):a.visibleLayers,-1<p.indexOf(d,b.id)?v.defaultVisibility=!0:v.defaultVisibility=!1),r.push(v))}c&&null!=c.transparency&&(d=c.drawingInfo||{},null==d.transparency&&(d.transparency=c.transparency,
c.drawingInfo=d));c&&c.source&&c.drawingInfo&&(u=new sb(c.drawingInfo),f[b.id]=u)},this);0<t.length&&d.setLayerDefinitions(t);0<r.length?(d.setDynamicLayerInfos(r,!0),0<f.length&&d.setLayerDrawingOptions(f,!0)):(g=wa(d.layerInfos,g),d.setVisibleLayers(g))}else g=wa(d.layerInfos,g),d.setVisibleLayers(g);c.ignorePopups||fa(d,a,b,c);return d}function ma(a,b,c){var d=new Za;d.bandIds=a.bandIds;null!=a.format&&(d.format=a.format,null!=a.compressionQuality&&(d.compressionQuality=a.compressionQuality));
if(a.renderingRule&&a.renderingRule.rasterFunction){var g=new tb(a.renderingRule);d.renderingRule=g}a.mosaicRule&&(g=new pb(a.mosaicRule),d.mosaicRule=g);r.isDefined(a.noData)&&(d.noData=a.noData);r.isDefined(a.noDataInterpretation)&&(d.noDataInterpretation=a.noDataInterpretation);r.isDefined(a.interpolation)&&(d.interpolation=a.interpolation);g=a.layerType?"ArcGISImageServiceVectorLayer"===a.layerType:!1;r.isDefined(a.layerType)||(g=a.resourceInfo.hasMultidimensions&&("esriImageServiceDataTypeVector-UV"===
a.resourceInfo.serviceDataType||"esriImageServiceDataTypeVector-MagDir"===a.resourceInfo.serviceDataType));d={resourceInfo:a.resourceInfo,opacity:a.opacity,visible:a.visibility,id:a.id,imageServiceParameters:d,minScale:a.minScale,maxScale:a.maxScale,refreshInterval:a.refreshInterval};d=g?new pa(ia(a.url),d):new ga(ia(a.url),d);a.layerDefinition&&(a.layerDefinition.drawingInfo&&a.layerDefinition.drawingInfo.renderer&&(g=B.fromJson(a.layerDefinition.drawingInfo.renderer),d.setRenderer(g)),a.layerDefinition.definitionExpression&&
d.setDefinitionExpression(a.layerDefinition.definitionExpression,!0));!c.ignorePopups&&a.popupInfo&&d.setInfoTemplate(new b(a.popupInfo));return d}function ja(a,b,c){var d=[102113,102100,3857],g=c||new v(b[0].layerObject.fullExtent.spatialReference),m=new v(a.resourceInfo.fullExtent.spatialReference);return g.wkt==m.wkt&&(g.wkid==m.wkid||r.isDefined(g.latestWkid)&&g.latestWkid==m.wkid||r.isDefined(m.latestWkid)&&g.wkid==m.latestWkid||r.isDefined(g.latestWkid)&&g.latestWkid==m.latestWkid)||g.wkid&&
m.wkid&&p.some(d,function(a){return a===m.wkid})&&p.some(d,function(a){return a===g.wkid})?!0:!1}function va(a,b,c){if(!b[0].layerObject.tileInfo)return!1;a=a.resourceInfo.tileInfo;b=b[0].layerObject.tileInfo;c=c.width>c.height?c.width:c.height;for(var d=!1,g=!1,m=0;m<a.lods.length;m++){for(var t=a.lods[m].scale/a.dpi,r=0;r<b.lods.length;r++){var v=b.lods[r].scale/b.dpi;if(Math.abs(v-t)/v<1/c)if(d){g=!0;break}else d=!0}if(g)break}return g||d&&(1===a.lods.length||1===b.lods.length)?!0:!1}function la(a,
c,d,m,t,u){var h,n,z=d._clazz;if("OpenStreetMap"===a.type)h=new ub({id:a.id,opacity:a.opacity,visible:null!==a.visibility&&void 0!==a.visibility?a.visibility:!0});else if("WFS"===a.type)m={customParameters:a.wfsInfo.customParameters,geometryType:a.layerDefinition.geometryType,id:a.id,labelingInfo:a.layerDefinition.drawingInfo.labelingInfo,maxFeatures:a.wfsInfo.maxFeatures,mode:a.mode,name:a.wfsInfo.name,showLabels:!0,swapXY:a.wfsInfo.swapXY,title:a.title,url:a.url,version:a.wfsInfo.version,visible:a.visibility,
wkid:a.layerDefinition.spatialReference.wkid},h=new vb,h.fromJson(m,function(){r.isDefined(a.opacity)&&h.setOpacity(a.opacity);r.isDefined(a.visibility)&&h.setVisibility(a.visibility);(a.minScale||a.maxScale)&&h.setScaleRange(a.minScale,a.maxScale);h.renderer=B.fromJson(a.layerDefinition.drawingInfo.renderer);!d.ignorePopups&&a.popupInfo&&h.setInfoTemplate(new z(a.popupInfo));h.emit("fromJsonComplete")});else if("WMS"===a.type){var y=[],k=[];p.forEach(a.layers,function(a){k.push(new wb({name:a.name,
title:a.title,legendURL:a.legendURL,queryable:a.queryable,showPopup:a.showPopup}));y.push(a.name)},this);a.visibleLayers&&(y=a.visibleLayers);m=new x(a.extent[0][0],a.extent[0][1],a.extent[1][0],a.extent[1][1],new v({wkid:4326}));m={customLayerParameters:a.customLayerParameters,customParameters:a.customParameters,extent:m,layerInfos:k,version:a.version,maxWidth:a.maxWidth,maxHeight:a.maxHeight,featureInfoFormat:a.featureInfoFormat,getFeatureInfoURL:a.featureInfoUrl,getMapURL:a.mapUrl,spatialReferences:a.spatialReferences,
title:a.title,copyright:a.copyright,minScale:a.minScale||0,maxScale:a.maxScale||0,format:a.format};h=new qb(a.url,{id:a.id,visibleLayers:y,format:"png",transparent:a.firstLayer?!1:!0,opacity:a.opacity,visible:null!==a.visibility?a.visibility:!0,resourceInfo:m,refreshInterval:a.refreshInterval});h.spatialReference.wkid=m.spatialReferences[0]}else if("KML"===a.type){n=a.url;if(g.id){var A=g.id.findCredential(w.urlToObject(H.arcgisUrl).path);A&&(c=H.arcgisUrl.substring(H.arcgisUrl.indexOf("//")+2,H.arcgisUrl.indexOf("/",
H.arcgisUrl.indexOf("//")+3)),t=c.split("."),t=t[t.length-2]+"."+t[t.length-1],u=n.indexOf(t),-1<u&&(n="https://"+c+n.substring(u+t.length),n+="?token\x3d"+A.token))}h=new xb(n,{id:a.id,visible:null!==a.visibility?a.visibility:!0,outSR:m,refreshInterval:a.refreshInterval});q.connect(h,"onLoad",function(){(a.opacity||0===a.opacity)&&h.setOpacity(a.opacity);r.isDefined(a.minScale)&&r.isDefined(a.maxScale)&&h.setScaleRange(a.minScale,a.maxScale);a.visibleFolders&&p.forEach(h.folders,function(b){-1<p.indexOf(a.visibleFolders,
b.id)?h.setFolderVisibility(b,!0):h.setFolderVisibility(b,!1)},this)})}else if("WebTiledLayer"===a.type){if(h=new kb(a.templateUrl,{id:a.id,visible:null!==a.visibility?a.visibility:!0,opacity:a.opacity,copyright:a.copyright,fullExtent:a.fullExtent&&new x(a.fullExtent),initialExtent:a.fullExtent&&new x(a.fullExtent),subDomains:a.subDomains,tileInfo:a.tileInfo?new yb(a.tileInfo):null,refreshInterval:a.refreshInterval,wmtsInfo:a.wmtsInfo}),r.isDefined(a.minScale)||r.isDefined(a.maxScale))h.loaded?h.setScaleRange(a.minScale,
a.maxScale):q.connect(h,"onLoad",function(){h.setScaleRange(a.minScale,a.maxScale)})}else if("GeoRSS"===a.type)h=new zb(a.url,{id:a.id,opacity:a.opacity,outSpatialReference:m,refreshInterval:a.refreshInterval}),q.connect(h,"onLoad",function(){!1===a.visibility&&h.hide();r.isDefined(a.minScale)&&r.isDefined(a.maxScale)&&h.setScaleRange(a.minScale,a.maxScale);var b=h.getFeatureLayers();p.forEach(b,function(c){a.pointSymbol&&"esriGeometryPoint"===c.geometryType?(c.renderer.symbol=C.fromJson(a.pointSymbol),
1===b.length&&(h.pointSymbol=C.fromJson(a.pointSymbol))):a.lineSymbol&&"esriGeometryPolyline"===c.geometryType?(c.renderer.symbol=C.fromJson(a.lineSymbol),1===b.length&&(h.polylineSymbol=C.fromJson(a.lineSymbol))):a.polygonSymbol&&"esriGeometryPolygon"===c.geometryType&&(c.renderer.symbol=C.fromJson(a.polygonSymbol),1===b.length&&(h.polygonSymbol=C.fromJson(a.polygonSymbol)))})});else if("CSV"==a.type&&a.url)m={layerDefinition:a.layerDefinition,columnDelimiter:a.columnDelimiter,id:a.id?a.id:null,
visible:null!==a.visibility?a.visibility:!0,opacity:a.opacity,refreshInterval:a.refreshInterval},a.locationInfo&&(m.latitudeFieldName=a.locationInfo.latitudeFieldName,m.longitudeFieldName=a.locationInfo.longitudeFieldName),d.ignorePopups||(m.infoTemplate=new E(a.popupInfo?a.popupInfo:X.generateDefaultPopupInfo(a))),h=new ba(a.url,m);else if("VectorTileLayer"===a.layerType&&a.styleUrl)h=new nb(a.styleUrl,{id:a.id,minScale:a.minScale,maxScale:a.maxScale,opacity:a.opacity,visible:a.visibility});else if(a.layerDefinition&&
!a.url)m=l.fromJson(l.toJson(a)),delete m.id,delete m.opacity,delete m.visibility,h=new L(m,{id:a.id,opacity:a.opacity,visible:a.visibility,outFields:["*"],autoGeneralize:!0}),!d.ignorePopups&&m.popupInfo&&h.setInfoTemplate(new z(m.popupInfo)),Ba(h);else if("BingMapsAerial"===a.type||"BingMapsRoad"===a.type||"BingMapsHybrid"===a.type)d.bingMapsKey?(m=Ta.MAP_STYLE_AERIAL_WITH_LABELS,"BingMapsAerial"===a.type?m=Ta.MAP_STYLE_AERIAL:"BingMapsRoad"===a.type&&(m=Ta.MAP_STYLE_ROAD),h=new Ta({bingMapsKey:d.bingMapsKey,
mapStyle:m,opacity:a.opacity,id:a.id}),q.connect(h,"onError",e.hitch(this,function(a){a.errors=a.errors||[];a.errors.push({message:"This application does not have a valid Bing Key for the Bing layer that is included in this map. [type:"+a.type+"]"})},a))):(a.errors=a.errors||[],a.errors.push({message:"This application does not provide a Bing Key for the Bing layer that is included in this map. [type:"+a.type+"]"}));else if(a.resourceInfo&&a.resourceInfo.mapName)h=!0===a.resourceInfo.singleFusedMapCache&&
(a.baseMapLayer||ja(a,c,m)&&va(a,t,u))?sa(a,z,d):ua(a,z,d);else if(a.resourceInfo&&a.resourceInfo.pixelSizeX)h=!0===a.resourceInfo.singleFusedMapCache&&(a.baseMapLayer||ja(a,c,m)&&va(a,t,u))?sa(a,z,d):ma(a,z,d);else if(a.resourceInfo&&"Feature Layer"===a.resourceInfo.type){a.capabilities&&(a.resourceInfo.capabilities=a.capabilities);var D;!1===d.editable?D=!1:d.privileges&&-1===p.indexOf(d.privileges,"features:user:edit")&&g.id&&g.id.findCredential(a.url)&&(D=!1);h=new L(ia(a.url),{resourceInfo:a.resourceInfo,
opacity:a.opacity,visible:a.visibility,id:a.id,mode:a.mode===L.MODE_SELECTION?L.MODE_SELECTION:L.MODE_AUTO,editable:D,outFields:["*"],autoGeneralize:!0,refreshInterval:a.refreshInterval});!d.ignorePopups&&a.popupInfo&&h.setInfoTemplate(new z(a.popupInfo));a.layerDefinition&&(a.layerDefinition.drawingInfo&&a.layerDefinition.drawingInfo.renderer&&(m=B.fromJson(a.layerDefinition.drawingInfo.renderer),m.isMaxInclusive=!0,h.setRenderer(m)),a.layerDefinition.drawingInfo&&a.layerDefinition.drawingInfo.labelingInfo&&
(m=p.map(a.layerDefinition.drawingInfo.labelingInfo,function(a){return new $a(a)}),h.setLabelingInfo(m)),a.layerDefinition.definitionExpression&&h.setDefinitionExpression(a.layerDefinition.definitionExpression),r.isDefined(a.layerDefinition.minScale)&&h.setMinScale(a.layerDefinition.minScale),r.isDefined(a.layerDefinition.maxScale)&&h.setMaxScale(a.layerDefinition.maxScale));Ba(h)}else a.resourceInfo&&a.resourceInfo.streamUrls&&(m={resourceInfo:a.resourceInfo,opacity:a.opacity,visible:a.visibility,
id:a.id},a.layerDefinition&&(A=a.layerDefinition.drawingInfo,a.layerDefinition.definitionGeometry&&(n=n||{},n.geometry=a.layerDefinition.definitionGeometry),r.isDefined(a.layerDefinition.definitionExpression)&&(n=n||{},n.where=a.layerDefinition.definitionExpression),r.isDefined(a.layerDefinition.maximumTrackPoints)&&(m.maximumTrackPoints=a.layerDefinition.maximumTrackPoints)),n&&(m.filter=n),a.purgeOptions&&(m.purgeOptions=a.purgeOptions),h=new Ua(ia(a.url),m),A&&A.renderer&&(m=A.renderer,h.setRenderer(B.fromJson(m))),
!d.ignorePopups&&a.popupInfo&&h.setInfoTemplate(new z(a.popupInfo)),a.layerDefinition&&(r.isDefined(a.layerDefinition.minScale)&&h.setMinScale(a.layerDefinition.minScale),r.isDefined(a.layerDefinition.maxScale)&&h.setMaxScale(a.layerDefinition.maxScale)),f.once(h,"error",function(b){a.errors.push({message:"Error loading stream layer. Check websocket url"})}));h&&(h.arcgisProps={title:a.title},a.baseMapLayer&&(a.isReference?(h.attr("data-reference",!0),h._basemapGalleryLayerType="reference"):h._basemapGalleryLayerType=
"basemap"),h instanceof L&&a.layerDefinition&&a.layerDefinition.featureReduction&&"cluster"===a.layerDefinition.featureReduction.type&&(m=a.layerDefinition.featureReduction,m.clusterSize&&(m.clusterSize=b.pt2px(m.clusterSize)),m.clusterRadius&&(m.clusterRadius=b.pt2px(m.clusterRadius)),m.popupInfo&&(m.infoTemplate=new E(m.popupInfo),delete m.popupInfo),h.setFeatureReduction(m)));return h}function na(a,b,c,d,g){p.forEach(a,function(m){m.layerObject=la(m,a,b,c,d,g)});var m=p.filter(a,function(a){return!a.isReference}),
t=p.filter(a,function(a){return!!a.isReference});return a=m.concat(t)}function aa(a){var b=null;a=a[0];a.url&&!a.type?a.resourceInfo.spatialReference&&(b=new v,a.resourceInfo.spatialReference.wkid&&(b.wkid=a.resourceInfo.spatialReference.wkid),a.resourceInfo.spatialReference.wkt&&(b.wkt=a.resourceInfo.spatialReference.wkt)):a.type&&(-1<a.type.indexOf("BingMaps")||"OpenStreetMap"==a.type?b=new v({wkid:102100}):"WMS"==a.type&&(b=new v({wkid:a.spatialReferences[0]})));return b}function za(a,b,c,d,g,
m,t,r){p.forEach(b,function(b){b.url&&!b.type&&(b.resourceInfo=a[b.deferredsPos][1],delete b.deferredsPos)});m=m||aa(b);b=na(b,c,m,t,r);g.callback(b);return g}function Ba(a){!window.CanvasRenderingContext2D&&a.renderer&&"esri.renderer.HeatmapRenderer"===a.renderer.declaredClass&&a.setRenderer(B.fromJson({type:"simple",symbol:{color:[77,77,77,255],size:6,angle:0,xoffset:0,yoffset:0,type:"esriSMS",style:"esriSMSCircle",outline:{color:[255,255,255,255],width:.75,type:"esriSLS",style:"esriSLSSolid"}}}))}
function ta(a,b){var c=ia(a);return t({url:c,content:{f:"json"},callbackParamName:"callback",error:function(a,d){a.message=a.message?a.message+(" [url:"+c+"]"):"[url:"+c+"]";b.push(a);u.defaults.io.errorHandler(a,d)}})}function oa(a){var b=H.arcgisUrl+"/"+a.itemId+"/data";return t({url:b,content:{f:"json"},callbackParamName:"callback",error:function(c,d){c.message=c.message?c.message+(" [url:"+b+"]"):"[url:"+b+"]";a.errors=a.errors||[];a.errors.push(c);u.defaults.io.errorHandler(c,d)}})}function Da(a,
b,c){var d=new n;if(!(c.featureCollection&&c.featureCollection.layers||c.layers))return console.log("Invalid Feature Collection item data [item id: "+a.itemId+"]: ",c),a.errors=a.errors||[],a.errors.push({message:"Invalid Feature Collection item data. [item id: "+a.itemId+"]"}),d.errback(),d;c.layers&&(c.featureCollection={layers:c.layers},delete c.layers,r.isDefined(c.showLegend)&&(c.featureCollection.showLegend=c.showLegend,delete c.showLegend));Oa(a,c.featureCollection,b).then(function(b){c.featureCollection=
b;a.featureCollection&&a.featureCollection.layers?p.forEach(c.featureCollection.layers,function(b,c){c=a.featureCollection.layers[c];c.popupInfo||c.layerDefinition?c.layerDefinition?(r.isDefined(c.layerDefinition.minScale)&&r.isDefined(c.layerDefinition.maxScale)&&(c.layerDefinition.minScale!==b.layerDefinition.minScale||c.layerDefinition.maxScale!==b.layerDefinition.maxScale)&&(delete b.layerDefinition.minScale,delete b.layerDefinition.maxScale),c.layerDefinition.drawingInfo&&l.toJson(c.layerDefinition.drawingInfo)!==
l.toJson(b.layerDefinition.drawingInfo)&&delete b.layerDefinition.drawingInfo,c.layerDefinition.showLegend!==b.layerDefinition.showLegend&&delete b.layerDefinition.showLegend,c.layerDefinition=e.mixin(c.layerDefinition,b.layerDefinition)):c.layerDefinition=b.layerDefinition:(c.popupInfo=b.popupInfo,c.layerDefinition=b.layerDefinition);c.featureSet=b.featureSet;c.nextObjectId=b.nextObjectId}):(a.featureCollection=a.featureCollection||{},a.featureCollection=e.mixin(a.featureCollection,c.featureCollection));
d.callback(a)});return d}function Oa(a,b,c){var g=new n;k(["./csv"],function(m){var t=[];p.forEach(b.layers,function(a){a.featureSet&&a.featureSet.features&&a.featureSet.features.length&&a.featureSet.features[0].geometry&&a.featureSet.features[0].geometry.spatialReference&&(a.deferredsPos=t.length,t.push(m.projectFeatureCollection(a,c,a.featureSet.features[0].geometry.spatialReference)))});(new d(t)).addCallback(function(){p.forEach(b.layers,function(b){r.isDefined(b.deferredsPos)&&(t[b.deferredsPos].results&&
t[b.deferredsPos].results.length?b=t[b.deferredsPos].results[0]:(console.log("Errors projecting feature collection. ["+a.title+" - "+b.layerDefinition.name+"]"),b.errors=b.errors||[],b.errors.push({message:"Errors projecting feature collection. ["+a.title+" - "+b.layerDefinition.name+"]"})),delete b.deferredsPos)});g.callback(b)})});return g}function Ma(a,b,c,g,m){var t=new n,r=new n,v=[],u;p.forEach(a.operationalLayers,function(a){a.itemId&&"Feature Collection"==a.type&&v.push(oa(a).then(e.hitch(null,
Da,a,c)))});0===v.length?Fa(a,b,c,g,r,m):(u=new d(v),u.addCallback(function(d){Fa(a,b,c,g,r,m)}));r.then(function(a){v=[];p.forEach(a,function(a){var b;a=a.layerObject;a instanceof L&&!a.loaded&&!a.loadError?(b=new n,f.once(a,"load, error",function(){b.callback(a)}),v.push(b)):a&&"esri.layers.WFSLayer"===a.declaredClass&&!a.loadError&&(b=new n,f.once(a,"fromJsonComplete, error",function(c){b.callback(a)}),v.push(b))});if(v.length){var b=new n;u=new d(v);u.addCallback(function(){b.callback(a)});return b.promise}return a}).then(function(a){var b=
[];p.forEach(a,function(a){var c=a.layerObject;c instanceof L?c.loaded&&c.labelingInfo&&(a.showLabels||c._collection)&&b.push(c):c&&"esri.layers.WFSLayer"===c.declaredClass&&c.loaded&&c.labelingInfo&&b.push(c)});b.length?k(["../layers/LabelLayer"],function(c){var d=new c;p.forEach(b,function(a){d.addFeatureLayer(a)});a.push({layerObject:d});t.callback(a)}):t.callback(a)});return t}function Fa(a,b,c,g,m,t){var r=[],v=[],f=[];p.forEach(a.operationalLayers,function(a,b){if(a.featureCollection&&a.featureCollection.layers){var c=
a.featureCollection.layers.length;p.forEach(a.featureCollection.layers,function(d,g){var m=!0;a.visibleLayers&&-1==p.indexOf(a.visibleLayers,g)&&(m=!1);d.visibility=a.visibility&&m;d.opacity=a.opacity;d.id=(a.id||"operational"+b)+"_"+g;a.title&&(d.title=1!==c&&d.layerDefinition.name&&a.title!==d.layerDefinition.name?a.title+" - "+d.layerDefinition.name:a.title);f.push(d)},this)}else f.push(a)});p.forEach(a.baseMap.baseMapLayers,function(a,b){a.baseMapLayer=!0;a.id=a.id||"base"+b;r.push(a)});p.forEach(f,
function(a,b){a.id=a.id||"operational"+b;r.push(a)});p.forEach(r,function(a){a.url&&!a.type&&(a.deferredsPos=v.length,a.errors=a.errors||[],v.push(ta(a.url,a.errors)))});0===v.length?(c=c||aa(r),r=na(r,b,c,g,t),m.callback(r)):(new d(v)).addCallback(function(a){za(a,r,b,v,m,c,g,t)});return m}function Ca(a,b,c,d){var g=a.minScale,m=a.maxScale;if(10.1>=c.version&&b)for(a=b.length-1;0<=a;a--){if(b[a].id==d)if(0==g&&0<b[a].minScale?g=b[a].minScale:0<g&&0==b[a].minScale?g=c.minScale:0<g&&0<b[a].minScale&&
(g=Math.min(g,b[a].minScale)),m=Math.max(c.maxScale||0,b[a].maxScale||0),c.setScaleRange(g,m),-1<b[a].parentLayerId)d=b[a].parentLayerId;else break}else 10.1<c.version&&(p.forEach(a.layerInfos,function(a){a.id==d&&(0==g&&0<a.minScale?g=a.minScale:0<g&&0==a.minScale||0<g&&0<a.minScale&&(g=Math.min(g,a.minScale)),m=Math.max(m||0,a.maxScale||0))}),c.setScaleRange(g,m))}function Ja(a,b,c,d){var g=a.url,m=a.__popupIds,t=a.__popupUrls,v=a.__popupWhereClauses,f=a.__popupMinScales,u=a.__popupMaxScales,w=
a.__resourceInfo,h=[];p.forEach(a.__popups,function(d,l){if(d){var n,e=[];p.forEach(d.fieldInfos,function(a){"shape"!==a.fieldName.toLowerCase()&&e.push(a.fieldName)});if(a.dynamicLayerInfos&&0<a.dynamicLayerInfos.length){var z=p.filter(a.dynamicLayerInfos,function(a){return m[l]==a.id})[0].source;n=new L(g+"/dynamicLayer",{id:a.id+"_"+m[l],source:z,outFields:e,mode:L.MODE_SELECTION,infoTemplate:d&&new c(d),drawMode:!1,visible:a.visible,autoGeneralize:!0});var y=function(c,d){0<v[c].length&&d.setDefinitionExpression(v[c]);
if(r.isDefined(f[c])||r.isDefined(u[c]))if(r.isDefined(a.minScale)||r.isDefined(a.maxScale)){var g=a.minScale,t=a.maxScale;0==g&&0<f[c]?g=f[c]:0<g&&0==f[c]||0<g&&0<f[c]&&(g=Math.min(g,f[c]));t=Math.max(t||0,u[c]||0);d.setScaleRange(g,t)}else d.setScaleRange(f[c],u[c]);else Ca(a,b||w.layers,d,m[c])};n.loaded?y(l,n):q.connect(n,"onLoad",function(a){y(l,n)})}else{var k=null,x=g+"/"+m[l];if(t[l].length)x=t[l];else if(b)for(z=0;z<b.length;z++)if(b[z].id===m[l]){k=b[z];break}n=new L(ia(x),{id:a.id+"_"+
m[l],outFields:e,mode:L.MODE_SELECTION,infoTemplate:d&&new c(d),drawMode:!1,visible:a.visible,resourceInfo:k,autoGeneralize:!0});n.loaded?(0<v[l].length&&n.setDefinitionExpression(v[l]),Ca(a,b||w.layers,n,m[l])):q.connect(n,"onLoad",function(c){0<v[l].length&&n.setDefinitionExpression(v[l]);Ca(a,b||w.layers,c,m[l])})}h.push(n)}});0<h.length&&(q.connect(a,"onVisibilityChange",e.hitch(this,function(a,b){p.forEach(a,function(a){b?a.show():a.hide()})},h)),q.connect(d,"onLayerRemove",e.hitch(this,function(a,
b,c){a.id===c.id&&p.forEach(b,function(a){d.removeLayer(a)})},a,h)));delete a.__popups;delete a.__popupIds;delete a.__popupUrls;delete a.__popupWhereClauses;delete a.__popupMinScales;delete a.__popupMaxScales;delete a.__resourceInfo;return h}function Ka(a){return t({url:ia(a.url+"/layers"),content:{f:"json"},callbackParamName:"callback",error:function(){}})}function Va(a,b,c){var g=[];p.forEach(a,function(a){var b=a.__popups;b&&1<b.length&&10<=a.version&&(a.__deferredsPos=g.length,g.push(Ka(a)))});
var m=[];0<g.length?(new d(g)).addCallback(function(d){p.forEach(a,function(a){a.__popups&&0<a.__popups.length&&(a.__deferredsPos||0===a.__deferredsPos?(m=m.concat(Ja(a,d[a.__deferredsPos][1].layers,c,b)),delete a.__deferredsPos):m=m.concat(Ja(a,null,c,b)))});b.addLayers(m)}):(p.forEach(a,function(a){a.__popups&&0<a.__popups.length&&(m=m.concat(Ja(a,null,c,b)))}),b.addLayers(m))}function Na(a){p.forEach(a,function(a){var b=a.layer;b.toJson&&(a=b.toJson(),a.featureSet&&b.name&&-1<b.name.indexOf("Text")&&
p.forEach(a.featureSet.features,function(a,c){a.attributes.TEXT&&(c=b.graphics[c],c.symbol.setText(a.attributes.TEXT),a.symbol.horizontalAlignment&&(c.symbol.align=a.symbol.horizontalAlignment),c.setSymbol(c.symbol),c.setAttributes(a.attributes))},this))})}function Qa(a){var b=6;p.forEach(a,function(a){if(a=a.renderer)"esri.renderer.SimpleRenderer"===a.declaredClass?((a=a.symbol)&&a.xoffset&&(b=Math.max(b,Math.abs(a.xoffset))),a&&a.yoffset&&(b=Math.max(b,Math.abs(a.yoffset)))):"esri.renderer.UniqueValueRenderer"!==
a.declaredClass&&"esri.renderer.ClassBreaksRenderer"!==a.declaredClass||p.forEach(a.infos,function(a){(a=a.symbol)&&a.xoffset&&(b=Math.max(b,Math.abs(a.xoffset)));a&&a.yoffset&&(b=Math.max(b,Math.abs(a.yoffset)))})});return b}function T(a){var b=this,c=b.infoWindow,d=a.graphic;if(b.loaded){c.hide();c.clearFeatures();var g=[];p.forEach(b.graphicsLayerIds,function(a){(a=b.getLayer(a))&&a instanceof L&&a.loaded&&a.visible&&(a.clearSelection(),a.infoTemplate&&!a.suspended&&g.push(a))});p.forEach(b.layerIds,
function(a){(a=b.getLayer(a))&&-1!==a.declaredClass.indexOf("ArcGISImageServiceLayer")&&a.loaded&&a.visible&&a.infoTemplate&&g.push(a)});d=d&&d.getInfoTemplate()?d:null;if(g.length||d){var m=Qa(g),t=a.screenPoint,r=b.toMap(new z(t.x-m,t.y+m)),m=b.toMap(new z(t.x+m,t.y-m)),v=new x(r.x,r.y,m.x,m.y,b.spatialReference),f=new F;f.geometry=v;f.timeExtent=b.timeExtent;var u=!0,r=p.map(g,function(b){b=b&&b.isFeatureReductionActive&&b.isFeatureReductionActive()?b.getFeatureReductionLayer():b;var c;if(-1!==
b.declaredClass.indexOf("ArcGISImageServiceLayer"))f.geometry=a.mapPoint,u=!1,c=b.queryVisibleRasters(f,{rasterAttributeTableFieldPrefix:"Raster.",returnDomainValues:!0}),c.addCallback(function(){return b.getVisibleRasters()});else if("function"===typeof b.selectFeatures)c=b.selectFeatures(f),c.addCallback(function(){return b.getSelectedFeatures()});else{c=new n;var d=p.filter(b.graphics,function(a){return a&&a.visible&&v.intersects(a.geometry)});c.resolve(d)}return c});d&&(m=new n,m.callback([d]),
r.splice(0,0,m));if(!p.some(r,function(a){return-1===a.fired})){var w=d?1:0;p.forEach(g,function(a){w=-1!==a.declaredClass.indexOf("ArcGISImageServiceLayer")?w+a.getVisibleRasters().length:w+a.getSelectedFeatures().length});if(!w)return}c.setFeatures(r);c.show(a.mapPoint,{closestFirst:u})}}}function La(a,b){var d=b.mapOptions||{},g;d.infoWindow||(g=new D({visibleWhenEmpty:!1},c.create("div")),d.infoWindow=g);r.isDefined(d.showInfoWindowOnClick)||b.usePopupManager||(d.showInfoWindowOnClick=!1);a=new y(a,
d);q.connect(a,"onLayersAddResult",Na);return a}function xa(a,b,c,d,g,m){var t,r,v,f;d.map?(t=d.map,r=d.clickEventHandle,v=d.clickEventListener,f=d.errors):(t=La(d,g),g.ignorePopups||g.disableClickBehavior||g.usePopupManager||(r=q.connect(t,"onClick",T),v=T));t.addLayers(a);g.ignorePopups||g.usePopupManager||Va(a,t,g._clazz);var u=f||[];p.forEach(b,function(a){a.errors&&(u=u.concat(a.errors))},this);t.loaded?m.callback({map:t,itemInfo:c,errors:u,clickEventHandle:r,clickEventListener:v}):q.connect(t,
"onLoad",function(){m.callback({map:t,itemInfo:c,errors:u,clickEventHandle:r,clickEventListener:v})})}function da(a,b,c,d,g){var m=[];p.forEach(g,function(a){e.isArray(a.layerObject)?p.forEach(a.layerObject,function(a){m.push(a)}):m.push(a.layerObject)});if("BingMapsAerial"===g[0].type||"BingMapsRoad"===g[0].type||"BingMapsHybrid"===g[0].type)var t=setInterval(function(){if(g[0].layerObject&&g[0].layerObject.loaded)clearInterval(t),Wa(a,b,c,d,g,m);else if(g[0].errors){clearInterval(t);var r="";g[0].errors&&
g[0].errors.length&&(r=" ("+g[0].errors[0].message+")");d.errback(Error(J.arcgis.utils.baseLayerError+r))}},10);else if(!m[0]&&g[0].baseMapLayer){var r="";g[0].errors&&g[0].errors.length&&(r=" ("+g[0].errors[0].message+")");d.errback(Error(J.arcgis.utils.baseLayerError+r))}else Wa(a,b,c,d,g,m)}function Wa(a,b,c,d,g,t){try{var f=c.mapOptions||{};c.mapOptions=f;var w=a.item,h=a.itemData;!f.backgroundColor&&h.background&&h.background.color&&null!=h.background.color[0]&&(f.backgroundColor=m.toDojoColor(h.background.color));
t=p.filter(t,r.isDefined);if(w)if(w.extent&&w.extent.length)if(f.extent)xa(t,g,a,b,c,d);else{var l=new x(w.extent[0][0],w.extent[0][1],w.extent[1][0],w.extent[1][1],new v({wkid:4326})),n=t[0].spatialReference;4326===n.wkid?(f.extent=l,xa(t,g,a,b,c,d)):102100===n.wkid||102113===n.wkid||3857===n.wkid?(l.xmin=Math.max(l.xmin,-180),l.xmax=Math.min(l.xmax,180),l.ymin=Math.max(l.ymin,-89.99),l.ymax=Math.min(l.ymax,89.99),f.extent=A.geographicToWebMercator(l),xa(t,g,a,b,c,d)):c.geometryServiceURL||u.defaults.geometryService?
(c.geometryServiceURL?new I(c.geometryServiceURL):u.defaults.geometryService).project([l],n,function(m){m=m[0];f.extent=f.extent||m;xa(t,g,a,b,c,d)},function(){xa(t,g,a,b,c,d)}):d.errback(Error(J.arcgis.utils.geometryServiceError))}else xa(t,g,a,b,c,d);else xa(t,g,a,b,c,d)}catch(Ga){d.errback(Ga)}}function Sa(a){var b=[];p.forEach(a.operationalLayers,function(a){a.featureCollection?b.push({featureCollection:a.featureCollection,visibility:a.visibility,title:a.title}):a.layerObject&&b.push({layer:a.layerObject,
visibility:a.visibility,title:a.title})});return b}function ka(a){var b=[],c=a.baseMap.baseMapLayers;a.operationalLayers&&(c=c.concat(a.operationalLayers));p.forEach(c,function(a){var c={};if(a.featureCollection&&"CSV"!==a.type)!0===a.featureCollection.showLegend&&p.forEach(a.featureCollection.layers,function(d){if(!1!==d.showLegend){var g=d.layerObject.renderer;c={layer:d.layerObject,title:a.title,defaultSymbol:g&&g.defaultSymbol&&g.defaultLabel?!0:!1};1<a.featureCollection.layers.length&&(c.title+=
" - "+d.layerDefinition.name);b.push(c)}});else if(a.baseMapLayer&&!0===a.showLegend&&a.layerObject||!a.baseMapLayer&&!1!==a.showLegend&&a.layerObject&&!(a.layerObject instanceof L&&a.layerObject.mode===L.MODE_SELECTION)){var d=a.layerObject.renderer,g=a.layerObject.declaredClass,d=!d||d&&d.defaultSymbol&&d.defaultLabel?!0:!1;if(10.1>a.layerObject.version&&("esri.layers.ArcGISDynamicMapServiceLayer"===g||"esri.layers.ArcGISTiledMapServiceLayer"===g)||"esri.layers.ArcGISImageServiceLayer"===g)d=!0;
c={layer:a.layerObject,title:a.title,defaultSymbol:d};a.layers&&(g=p.map(p.filter(a.layers,function(a){return!1===a.showLegend}),function(a){return a.id}),g.length&&(c.hideLayers=g));b.push(c)}});return b}function gb(a,b){function c(a,b){p.forEach(a,function(a,c){switch(a){case "../layers/ArcGISDynamicMapServiceLayer":ea=b[c];break;case "../layers/ArcGISImageServiceLayer":ga=b[c];break;case "../layers/ArcGISImageServiceVectorLayer":pa=b[c];break;case "./csv":X=b[c];break;case "../layers/CSVLayer":ba=
b[c];break;case "../layers/DynamicLayerInfo":Q=b[c];break;case "../layers/GeoRSSLayer":zb=b[c];break;case "../layers/ImageParameters":Pa=b[c];break;case "../layers/ImageServiceParameters":Za=b[c];break;case "../layers/KMLLayer":xb=b[c];break;case "../layers/LabelClass":$a=b[c];break;case "../layers/LayerDrawingOptions":sb=b[c];break;case "../layers/MosaicRule":pb=b[c];break;case "../layers/OpenStreetMapLayer":ub=b[c];break;case "../layers/RasterFunction":tb=b[c];break;case "../layers/StreamLayer":Ua=
b[c];break;case "../layers/TileInfo":yb=b[c];break;case "../layers/VectorTileLayer":nb=b[c];break;case "../virtualearth/VETiledLayer":Ta=b[c];break;case "../layers/WebTiledLayer":kb=b[c];break;case "../layers/WFSLayer":vb=b[c];break;case "../layers/WMSLayer":qb=b[c];break;case "../layers/WMSLayerInfo":wb=b[c]}})}var d=new n;a=a.itemData;b=[];a.baseMap&&a.baseMap.baseMapLayers&&(b=b.concat(a.baseMap.baseMapLayers));a.operationalLayers&&(b=b.concat(a.operationalLayers));a=p.map(b,function(a){return a&&
a.layerType});var g=[],m=[];b=!1;for(var t=0;t<a.length;t++){switch(a[t]){case "ArcGISFeatureLayer":-1===p.indexOf(g,"../layers/LabelClass")&&g.push("../layers/LabelClass");break;case "ArcGISImageServiceLayer":case "ArcGISTiledImageServiceLayer":-1===p.indexOf(g,"../layers/ArcGISImageServiceLayer")&&(g.push("../layers/ArcGISImageServiceLayer"),m.push("../layers/ImageServiceParameters"),m.push("../layers/MosaicRule"),m.push("../layers/RasterFunction"));break;case "ArcGISImageServiceVectorLayer":-1===
p.indexOf(g,"../layers/ArcGISImageServiceVectorLayer")&&(g.push("../layers/ArcGISImageServiceVectorLayer"),m.push("../layers/ImageServiceParameters"),m.push("../layers/MosaicRule"),m.push("../layers/RasterFunction"));break;case "ArcGISMapServiceLayer":case "ArcGISTiledMapServiceLayer":-1===p.indexOf(g,"../layers/ArcGISDynamicMapServiceLayer")&&(g.push("../layers/ArcGISDynamicMapServiceLayer"),m.push("../layers/DynamicLayerInfo"),m.push("../layers/ImageParameters"),m.push("../layers/LayerDrawingOptions"));
break;case "ArcGISStreamLayer":-1===p.indexOf(g,"../layers/StreamLayer")&&g.push("../layers/StreamLayer");break;case "BingMapsAerial":case "BingMapsHybrid":case "BingMapsRoad":-1===p.indexOf(g,"../virtualearth/VETiledLayer")&&g.push("../virtualearth/VETiledLayer");break;case "CSV":-1===p.indexOf(g,"../layers/CSVLayer")&&(g.push("../layers/CSVLayer"),m.push("./csv"));break;case "GeoRSS":-1===p.indexOf(g,"../layers/GeoRSSLayer")&&g.push("../layers/GeoRSSLayer");break;case "KML":-1===p.indexOf(g,"../layers/KMLLayer")&&
g.push("../layers/KMLLayer");break;case "OpenStreetMap":-1===p.indexOf(g,"../layers/OpenStreetMapLayer")&&g.push("../layers/OpenStreetMapLayer");break;case "VectorTileLayer":-1===p.indexOf(g,"../layers/VectorTileLayer")&&g.push("../layers/VectorTileLayer");break;case "WebTiledLayer":-1===p.indexOf(g,"../layers/WebTiledLayer")&&(g.push("../layers/WebTiledLayer"),m.push("../layers/TileInfo"));break;case "WFS":-1===p.indexOf(g,"../layers/WFSLayer")&&g.push("../layers/WFSLayer");break;case "WMS":-1===
p.indexOf(g,"../layers/WMSLayer")&&(g.push("../layers/WMSLayer"),m.push("../layers/WMSLayerInfo"));break;default:b=!0}if(b)break}b&&(g=Gb,m=ab);g.length?k(g,function(){c(g,arguments);m.length?k(m,function(){c(m,arguments);d.resolve()}):d.resolve()}):d.resolve();return d}function R(a,b,c,d){var g=d.itemData;g.baseMap&&g.baseMap.baseMapLayers&&g.baseMap.baseMapLayers.length&&(g.baseMap.baseMapLayers[0].firstLayer=!0);var m=b.layerMixins,t=m&&m.length;if(t){var r=function(a){for(var b=0;b<t;b++){var c=
m[b];if(c.mixin)if(c.hasOwnProperty("id")){if(a.id===c.id){e.mixin(a,c.mixin);break}}else if(a.url===c.url){e.mixin(a,c.mixin);break}}};p.forEach(g.baseMap&&g.baseMap.baseMapLayers,r);p.forEach(g.operationalLayers,r)}gb(d,b).then(function(){return N(d,b)}).then(function(){return Y(d,b)}).then(function(b){var d=b[0],g=b[1];if(d.itemData.operationalLayers&&0!==d.itemData.operationalLayers.length){var m=new n,t=d.itemData.baseMap.baseMapLayers.slice(),r=p.filter(d.itemData.baseMap.baseMapLayers,function(a){return!a.isReference});
b={item:d.item,itemData:{baseMap:{baseMapLayers:r}}};d.itemData.baseMap.baseMapLayers=p.filter(d.itemData.baseMap.baseMapLayers,function(a){return a.isReference});S(b,g).addCallback(function(b){Ma(b.itemData,g).addCallback(e.hitch(null,da,b,a,g,m))});m.then(function(a){S(d,g).addCallback(function(b){Ma(b.itemData,g,a.map.spatialReference,r,a.map).addCallback(function(d){b.itemData.baseMap.baseMapLayers=t;da(b,a,g,c,d)})})},e.hitch(c,c.errback))}else S(d,g).addCallback(function(b){Ma(b.itemData,g).addCallback(e.hitch(null,
da,b,a,g,c))})})}function qa(a,b){"undefined"===typeof b&&(b=!0);H._arcgisUrl&&0<H._arcgisUrl.length&&(H.arcgisUrl=H._arcgisUrl);var c=H.arcgisUrl+"/"+a,d={},g=new n;t({url:c,content:{f:"json"},callbackParamName:"callback",load:function(a){d.item=a;b?t({url:c+"/data",content:{f:"json"},callbackParamName:"callback",load:function(a){d.itemData=a;g.callback(d)},error:function(a){g.errback(a)}}):g.callback(d)},error:function(a){g.errback(a)}});return g}var H,ea,ga,pa,X,ba,Q,zb,Pa,Za,xb,$a,sb,pb,ub,tb,
Ua,yb,nb,Ta,kb,vb,qb,wb,Gb="../layers/ArcGISDynamicMapServiceLayer ../layers/ArcGISImageServiceLayer ../layers/ArcGISImageServiceVectorLayer ../layers/CSVLayer ../layers/GeoRSSLayer ../layers/KMLLayer ../layers/LabelClass ../layers/OpenStreetMapLayer ../layers/StreamLayer ../layers/VectorTileLayer ../virtualearth/VETiledLayer ../layers/WebTiledLayer ../layers/WFSLayer ../layers/WMSLayer".split(" "),ab="./csv ../layers/DynamicLayerInfo ../layers/ImageParameters ../layers/ImageServiceParameters ../layers/LayerDrawingOptions ../layers/MosaicRule ../layers/RasterFunction ../layers/TileInfo ../layers/WMSLayerInfo".split(" ");
H={arcgisUrl:w.getProtocolForWebResource()+"//www.arcgis.com/sharing/rest/content/items",getItem:qa,createMap:function(a,b,c){var d=new n;c=c||{};var g=c.infoTemplateClass;c._clazz=g&&(e.isObject(g)?g:e.getObject(g))||E;e.isString(a)?qa(a).addCallback(e.hitch(null,R,b,c,d)).addErrback(e.hitch(d,d.errback)):R(b,c,d,a);return d},getLayerList:function(a){return a&&a.itemInfo&&a.itemInfo.itemData?Sa(a.itemInfo.itemData):[]},getLegendLayers:function(a){return a&&a.itemInfo&&a.itemInfo.itemData?ka(a.itemInfo.itemData):
[]},_arcgisUrl:null,_getItemProps:S,_getItemData:P,_getBingKey:K,_portalUrlResponse:W,_portalUrlFailure:ca,_processFSItemProperties:U,_processSSItemProperties:O,_getLayers:Ma,_preBuildLayerObjects:za,_buildLayerObjects:na,_preCreateMap:da,_getMapSR:aa,_createMap:xa,_addSelectionLayers:Va,_createSelectionFeatureLayers:Ja,_getServiceInfo:ta,_getFeatureCollectionItem:oa,_mergeFeatureCollectionItem:Da,_projectFeatureCollection:Oa,_getLayersInfo:Ka,_initLayer:la,_loadAsCached:sa,_loadAsDynamic:ua,_processPopups:fa,
_onLayersAddResult:Na,_sameSpatialReferenceAsBasemap:ja,_sameTilingSchemeAsBasemap:va,_showPopup:T,_calculateClickTolerance:Qa,_getVisibleFeatureLayers:wa,_updateLayerScaleInfo:Ca,_checkUrl:ia,_isHostedService:Z,_isAgolService:G,_getLegendLayers:ka};e.setObject("arcgis.utils",H,g);return H})},"dojo/_base/url":function(){define(["./kernel"],function(k){var e=/^(([^:/?#]+):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?$/,p=/^((([^\[:]+):)?([^@]+)@)?(\[([^\]]+)\]|([^\[:]*))(:([0-9]+))?$/,q=function(){for(var n=
arguments,l=[n[0]],h=1;h<n.length;h++)if(n[h]){var f=new q(n[h]+""),l=new q(l[0]+"");if(""==f.path&&!f.scheme&&!f.authority&&!f.query)null!=f.fragment&&(l.fragment=f.fragment),f=l;else if(!f.scheme&&(f.scheme=l.scheme,!f.authority&&(f.authority=l.authority,"/"!=f.path.charAt(0)))){for(var l=(l.path.substring(0,l.path.lastIndexOf("/")+1)+f.path).split("/"),d=0;d<l.length;d++)"."==l[d]?d==l.length-1?l[d]="":(l.splice(d,1),d--):0<d&&(1!=d||""!=l[0])&&".."==l[d]&&".."!=l[d-1]&&(d==l.length-1?(l.splice(d,
1),l[d-1]=""):(l.splice(d-1,2),d-=2));f.path=l.join("/")}l=[];f.scheme&&l.push(f.scheme,":");f.authority&&l.push("//",f.authority);l.push(f.path);f.query&&l.push("?",f.query);f.fragment&&l.push("#",f.fragment)}this.uri=l.join("");n=this.uri.match(e);this.scheme=n[2]||(n[1]?"":null);this.authority=n[4]||(n[3]?"":null);this.path=n[5];this.query=n[7]||(n[6]?"":null);this.fragment=n[9]||(n[8]?"":null);null!=this.authority&&(n=this.authority.match(p),this.user=n[3]||null,this.password=n[4]||null,this.host=
n[6]||n[7],this.port=n[9]||null)};q.prototype.toString=function(){return this.uri};return k._Url=q})},"dojo/DeferredList":function(){define(["./_base/kernel","./_base/Deferred","./_base/array"],function(k,e,p){k.DeferredList=function(k,n,l,h,f){var d=[];e.call(this);var c=this;0!==k.length||n||this.resolve([0,[]]);var a=0;p.forEach(k,function(b,g){function f(b,r){d[g]=[b,r];a++;a===k.length&&c.resolve(d)}b.then(function(a){n?c.resolve([g,a]):f(!0,a)},function(a){l?c.reject(a):f(!1,a);if(h)return null;
throw a;})})};k.DeferredList.prototype=new e;k.DeferredList.prototype.gatherResults=function(e){e=new k.DeferredList(e,!1,!0,!1);e.addCallback(function(n){var l=[];p.forEach(n,function(h){l.push(h[1])});return l});return e};return k.DeferredList})},"dojox/gfx/_base":function(){define("dojo/_base/kernel dojo/_base/lang dojo/_base/Color dojo/_base/sniff dojo/_base/window dojo/_base/array dojo/dom dojo/dom-construct dojo/dom-geometry".split(" "),function(k,e,p,q,n,l,h,f,d){var c=e.getObject("dojox.gfx",
!0),a=c._base={};c._hasClass=function(a,b){return(a=a.getAttribute("className"))&&0<=(" "+a+" ").indexOf(" "+b+" ")};c._addClass=function(a,b){var c=a.getAttribute("className")||"";(!c||0>(" "+c+" ").indexOf(" "+b+" "))&&a.setAttribute("className",c+(c?" ":"")+b)};c._removeClass=function(a,b){var c=a.getAttribute("className");c&&a.setAttribute("className",c.replace(new RegExp("(^|\\s+)"+b+"(\\s+|$)"),"$1$2"))};a._getFontMeasurements=function(){var a={"1em":0,"1ex":0,"100%":0,"12pt":0,"16px":0,"xx-small":0,
"x-small":0,small:0,medium:0,large:0,"x-large":0,"xx-large":0},b,c;q("ie")&&(c=n.doc.documentElement.style.fontSize||"",c||(n.doc.documentElement.style.fontSize="100%"));var d=f.create("div",{style:{position:"absolute",left:"0",top:"-100px",width:"30px",height:"1000em",borderWidth:"0",margin:"0",padding:"0",outline:"none",lineHeight:"1",overflow:"hidden"}},n.body());for(b in a)d.style.fontSize=b,a[b]=16*Math.round(12*d.offsetHeight/16)/12/1E3;q("ie")&&(n.doc.documentElement.style.fontSize=c);n.body().removeChild(d);
return a};var b=null;a._getCachedFontMeasurements=function(c){if(c||!b)b=a._getFontMeasurements();return b};var g=null,u={};a._getTextBox=function(a,b,c){var m,t,r=arguments.length,v;g||(g=f.create("div",{style:{position:"absolute",top:"-10000px",left:"0",visibility:"hidden"}},n.body()));m=g;m.className="";t=m.style;t.borderWidth="0";t.margin="0";t.padding="0";t.outline="0";if(1<r&&b)for(v in b)v in u||(t[v]=b[v]);2<r&&c&&(m.className=c);m.innerHTML=a;m.getBoundingClientRect?(t=m.getBoundingClientRect(),
t={l:t.left,t:t.top,w:t.width||t.right-t.left,h:t.height||t.bottom-t.top}):t=d.getMarginBox(m);m.innerHTML="";return t};a._computeTextLocation=function(a,b,c,d){var g={};switch(a.align){case "end":g.x=a.x-b;break;case "middle":g.x=a.x-b/2;break;default:g.x=a.x}g.y=a.y-c*(d?.75:1);return g};a._computeTextBoundingBox=function(b){if(!c._base._isRendered(b))return{x:0,y:0,width:0,height:0};var d;d=b.getShape();var g=b.getFont()||c.defaultFont;b=b.getTextWidth();g=c.normalizedLength(g.size);d=a._computeTextLocation(d,
b,g,!0);return{x:d.x,y:d.y,width:b,height:g}};a._isRendered=function(a){for(a=a.parent;a&&a.getParent;)a=a.parent;return null!==a};var m=0;a._getUniqueId=function(){var a;do a=k._scopeName+"xUnique"+ ++m;while(h.byId(a));return a};var r=q("pointer-events")?"touchAction":q("MSPointer")?"msTouchAction":null;a._fixMsTouchAction=r?function(a){a.rawNode.style[r]="none"}:function(){};e.mixin(c,{defaultPath:{type:"path",path:""},defaultPolyline:{type:"polyline",points:[]},defaultRect:{type:"rect",x:0,y:0,
width:100,height:100,r:0},defaultEllipse:{type:"ellipse",cx:0,cy:0,rx:200,ry:100},defaultCircle:{type:"circle",cx:0,cy:0,r:100},defaultLine:{type:"line",x1:0,y1:0,x2:100,y2:100},defaultImage:{type:"image",x:0,y:0,width:0,height:0,src:""},defaultText:{type:"text",x:0,y:0,text:"",align:"start",decoration:"none",rotated:!1,kerning:!0},defaultTextPath:{type:"textpath",text:"",align:"start",decoration:"none",rotated:!1,kerning:!0},defaultStroke:{type:"stroke",color:"black",style:"solid",width:1,cap:"butt",
join:4},defaultLinearGradient:{type:"linear",x1:0,y1:0,x2:100,y2:100,colors:[{offset:0,color:"black"},{offset:1,color:"white"}]},defaultRadialGradient:{type:"radial",cx:0,cy:0,r:100,colors:[{offset:0,color:"black"},{offset:1,color:"white"}]},defaultPattern:{type:"pattern",x:0,y:0,width:0,height:0,src:""},defaultFont:{type:"font",style:"normal",variant:"normal",weight:"normal",size:"10pt",family:"serif"},getDefault:function(){var a={};return function(b){var d=a[b];if(d)return new d;d=a[b]=new Function;
d.prototype=c["default"+b];return new d}}(),normalizeColor:function(a){return a instanceof p?a:new p(a)},normalizeParameters:function(a,b){var c;if(b){var d={};for(c in a)c in b&&!(c in d)&&(a[c]=b[c])}return a},makeParameters:function(a,b){var c=null;if(!b)return e.delegate(a);var d={};for(c in a)c in d||(d[c]=e.clone(c in b?b[c]:a[c]));return d},formatNumber:function(a,b){var c=a.toString();if(0<=c.indexOf("e"))c=a.toFixed(4);else{var d=c.indexOf(".");0<=d&&5<c.length-d&&(c=a.toFixed(4))}return 0>
a?c:b?" "+c:c},makeFontString:function(a){return a.style+" "+a.variant+" "+a.weight+" "+a.size+" "+a.family},splitFontString:function(a){var b=c.getDefault("Font");a=a.split(/\s+/);if(!(5>a.length)){b.style=a[0];b.variant=a[1];b.weight=a[2];var d=a[3].indexOf("/");b.size=0>d?a[3]:a[3].substring(0,d);var g=4;0>d&&("/"==a[4]?g=6:"/"==a[4].charAt(0)&&(g=5));g<a.length&&(b.family=a.slice(g).join(" "))}return b},cm_in_pt:72/2.54,mm_in_pt:7.2/2.54,px_in_pt:function(){return c._base._getCachedFontMeasurements()["12pt"]/
12},pt2px:function(a){return a*c.px_in_pt()},px2pt:function(a){return a/c.px_in_pt()},normalizedLength:function(a){if(0===a.length)return 0;if(2<a.length){var b=c.px_in_pt(),d=parseFloat(a);switch(a.slice(-2)){case "px":return d;case "pt":return d*b;case "in":return 72*d*b;case "pc":return 12*d*b;case "mm":return d*c.mm_in_pt*b;case "cm":return d*c.cm_in_pt*b}}return parseFloat(a)},pathVmlRegExp:/([A-Za-z]+)|(\d+(\.\d+)?)|(\.\d+)|(-\d+(\.\d+)?)|(-\.\d+)/g,pathSvgRegExp:/([A-DF-Za-df-z])|([-+]?\d*[.]?\d+(?:[eE][-+]?\d+)?)/g,
equalSources:function(a,b){return a&&b&&a===b},switchTo:function(a){var b="string"==typeof a?c[a]:a;b&&(l.forEach("Group Rect Ellipse Circle Line Polyline Image Text Path TextPath EsriPath Surface createSurface fixTarget".split(" "),function(a){c[a]=b[a]}),"string"==typeof a?c.renderer=a:l.some(["svg","vml","canvas","canvasWithEvents","silverlight"],function(a){return c.renderer=c[a]&&c[a].Surface===c.Surface?a:null}))}});return c})},"esri/config":function(){define(["dojo/_base/config","dojo/topic",
"dojo/has","./kernel"],function(k,e,p,q){p=function(){return this}();q={defaults:{screenDPI:96,geometryService:null,kmlService:null,map:{width:400,height:400,layerNamePrefix:"layer",graphicsLayerNamePrefix:"graphicsLayer",slider:{left:"30px",top:"30px",width:null,height:"200px"},sliderLabel:{tick:5,labels:null,style:"width:2em; font-family:Verdana; font-size:75%;"},sliderChangeImmediate:!0,zoomSymbol:{color:[0,0,0,64],outline:{color:[255,0,0,255],width:1.25,style:"esriSLSSolid"},style:"esriSFSSolid"},
zoomDuration:500,zoomRate:25,panDuration:350,panRate:25,logoLink:"http://www.esri.com"},autoSpatialIndexing:p.Worker&&!1,io:{errorHandler:function(n,l){e.publish("esri.Error",[n])},proxyUrl:null,alwaysUseProxy:!1,useCors:"with-credentials",corsEnabledServers:"server.arcgisonline.com services.arcgisonline.com www.arcgis.com js.arcgis.com jsdev.arcgis.com jsqa.arcgis.com tiles.arcgis.com tiles1.arcgis.com tiles2.arcgis.com tiles3.arcgis.com tiles4.arcgis.com basemaps.arcgis.com basemapsbeta.arcgis.com elevation3d.arcgis.com services.arcgis.com services1.arcgis.com services2.arcgis.com services3.arcgis.com services4.arcgis.com services5.arcgis.com services6.arcgis.com services7.arcgis.com services8.arcgis.com services9.arcgis.com cdn.arcgis.com cdn-a.arcgis.com cdn-b.arcgis.com static.arcgis.com utility.arcgis.com utility.arcgisonline.com geocode.arcgis.com geoenrich.arcgis.com qaext.arcgis.com staticqa.arcgis.com tilesqa.arcgis.com servicesqa.arcgis.com servicesqa1.arcgis.com servicesqa2.arcgis.com servicesqa3.arcgis.com geocodeqa.arcgis.com geoenrichqa.arcgis.com dev.arcgis.com devext.arcgis.com localvtiles.arcgis.com staticdev.arcgis.com tilesdevext.arcgis.com elevation3ddev.arcgis.com servicesdev.arcgis.com servicesdev1.arcgis.com servicesdev2.arcgis.com servicesdev3.arcgis.com geocodedev.arcgis.com geoenrichdev.arcgis.com basemapsdev.arcgis.com basemapsbetadev.arcgis.com".split(" "),
corsDetection:p.cordova?!1:!0,corsDetectionTimeout:15,corsStatus:{},webTierAuthServers:[],proxyRules:[],postLength:2E3,timeout:6E4,useWorkers:"on-request",maxRequestWorkers:5,httpsDomains:"arcgis.com arcgisonline.com esrikr.com premiumservices.blackbridge.com esripremium.accuweather.com gbm.digitalglobe.com firstlook.digitalglobe.com msi.digitalglobe.com".split(" ")},workers:{loaderConfig:{has:{},paths:{},map:{},packages:[]}}}};k.noGlobals||(p.esriConfig=q);return q})},"esri/Color":function(){define(["dojo/_base/declare",
"dojo/_base/Color","dojo/has","./kernel"],function(k,e,p,q){k=k([e],{declaredClass:"esri.Color"});k.toJsonColor=function(n){return n&&[n.r,n.g,n.b,1<n.a?n.a:Math.round(255*n.a)]};k.toDojoColor=function(n){return n&&new e([n[0],n[1],n[2],n[3]/255])};q="named blendColors fromRgb fromHex fromArray fromString".split(" ");for(p=0;p<q.length;p++)k[q[p]]=e[q[p]];return k})},"esri/request":function(){define("require dojo/_base/array dojo/_base/config dojo/_base/Deferred dojo/_base/lang dojo/_base/url dojo/_base/xhr ./core/request/script dojo/request/iframe dojo/dom-construct dojo/io-query ./kernel ./config ./sniff ./lang ./urlUtils ./deferredUtils".split(" "),
function(k,e,p,q,n,l,h,f,d,c,a,b,g,u,m,r,t){function v(a){a=new l(a);return(a.host+(a.port?":"+a.port:"")).toLowerCase()}function y(a){return this._xhr?this._xhr.getResponseHeader(a):null}function w(g,t,v,w){var l=!1,z=!1,y,k;m.isDefined(t)&&(n.isObject(t)?(l=!!t.useProxy,z=!!t.usePost,y=t.crossOrigin):l=!!t);g=n.mixin({},g);g._ssl&&(g.url=g.url.replace(/^http:/i,"https:"));10>u("ie")&&!M.test(g.url)&&(g.url=encodeURI(g.url));t=g.content;var x=g.url,B=v&&g.form,C=D;y=m.isDefined(y)?y:C.useCors;g.load=
function(a){var b;a&&(a.error?(b=n.mixin(Error(),a.error),b.log=!!p.isDebug):"error"===a.status&&(b=n.mixin(Error(),a),b.log=!!p.isDebug),b&&(g.failOk=!b.log,m.isDefined(b.httpCode)||(b.httpCode=b.code)));return b||a};g.error=function(a,b){b&&b.xhr&&b.xhr.abort();a instanceof Error||(a=n.mixin(Error(),a));a.log=!!p.isDebug;g.failOk=!a.log;C.errorHandler(a,b);return a};g._token&&(g.content=g.content||{},g.content.token=g._token);var A=0,F;t&&x&&(F=a.objectToQuery(t),A=F.length+x.length+1,u("esri-url-encodes-apostrophe")&&
(A=F.replace(/'/g,"%27").length+x.length+1));g.timeout=m.isDefined(g.timeout)?g.timeout:C.timeout;g.handleAs=g.handleAs||"json";try{var J,L,U=y&&r.canUseXhr(g.url)&&!/https?:\/\/[^\/]+\/[^\/]+\/admin\/?(\/.*)?$/i.test(g.url),P=r.hasSameOrigin(g.url,window.location.href)||U,K=z||v||A>C.postLength?!0:!1,ma=P||-1===g.handleAs.indexOf("json")||!g.callbackParamName||v?!1:!0,ja=r.getProxyRule(g.url)||C.alwaysUseProxy||l||(!ma||K)&&!P?!0:!1;v&&!u("esri-file-upload")&&!ja&&U&&(ja=!0);if(ja)if(J=r.getProxyUrl(x,
y),L=J.path,J._xo&&(U=!0),!K&&L.length+1+A>C.postLength&&(K=!0),g.url=L+"?"+x,K)g.content=n.mixin(J.query||{},t);else{var va=a.objectToQuery(n.mixin(J.query||{},t));va&&(g.url+="?"+va);g.content=null}if(!ma||K||ja){var la=g.headers;!U||la&&la.hasOwnProperty("X-Requested-With")||(la=g.headers=la||{},la["X-Requested-With"]=null);if(v){var na=g.callbackParamName||"callback.html",aa=g.callbackElementName||"textarea",za,Ba,ta,oa,Da=B.elements?B.elements.length:0,Oa;if(t=g.content)for(za in t.token&&-1<
x.toLowerCase().indexOf("/sharing/servers/")&&(x+=(-1===x.indexOf("?")?"?":"\x26")+"token\x3d"+t.token,g.url=ja?L+"?"+x:x,delete t.token),t)if(ta=t[za],m.isDefined(ta)){Ba=null;for(oa=0;oa<Da;oa++)if(Oa=B.elements[oa],Oa.name===za){Ba=Oa;break}Ba?Ba.value=ta:w?B.append(za,ta):B.appendChild(c.create("input",{type:"hidden",name:za,value:ta}))}if(u("esri-file-upload"))e.forEach(B.elements,function(a){a.name===na&&B.removeChild(a)}),g.contentType=!1,g.postData=w?B:new FormData(B),delete g.form;else{B.enctype=
"multipart/form-data";9>u("ie")&&(B.encoding="multipart/form-data");B.method="post";e.some(B.elements,function(a){return a.name===na})||B.appendChild(c.create("input",{type:"hidden",name:na,value:aa}));if(-1!==x.toLowerCase().indexOf("addattachment")||-1!==x.toLowerCase().indexOf("updateattachment"))x+=(-1===x.indexOf("?")?"?":"\x26")+na+"\x3d"+aa,g.url=ja?L+"?"+x:x;delete g.content}}if(U&&!g.hasOwnProperty("withCredentials")&&"with-credentials"===D.useCors){w=ja?L:x;var Ma=r.canUseXhr(w,!0),Fa=-1<
Ma?D.corsEnabledServers[Ma]:null;if(Fa&&Fa.hasOwnProperty("withCredentials"))Fa.withCredentials&&(g.withCredentials=!0);else if(b.id){var Ca=b.id.findServerInfo(w);Ca&&Ca.webTierAuth&&(g.withCredentials=!0)}}g=E?E(g):g;if(K){if(v&&!u("esri-file-upload")){k=new q(function(){Ja.cancel()});var Ja=d.post(g.url,g).then(function(a){k.resolve(a)}).otherwise(function(a){k.reject(a)});k.addCallback(function(a){return g.load(a)});k.addErrback(function(a){return g.error(a)});return k}!ja&&u("safari")&&(g.url+=
(-1===g.url.indexOf("?")?"?":"\x26")+"_ts\x3d"+(new Date).getTime()+I++);return h.post(g)}return h.get(g)}g=E?E(g):g;g.jsonp=g.callbackParamName;g.query=g.content;k=new q(function(){Ka.cancel()});var Ka=f.get(g.url,g).then(function(a){k.resolve(a)}).otherwise(function(a){k.reject(a)});k.addCallback(function(a){return g.load(a)});k.addErrback(function(a){return g.error(a)});return k}catch(Va){return k=new q,k.errback(g.error(Va)),k}}function z(a){var b=D.corsStatus,c=r.canUseXhr(a,!0);-1<c&&D.corsEnabledServers.splice(c,
1);var d=new q;d.reject({log:!!p.isDebug});b[v(a)]=d.promise;return c}function x(a){var b=D.corsStatus;try{var c=v(a);if(D.corsDetection&&D.useCors&&u("esri-cors")&&a&&-1!==a.toLowerCase().indexOf("/rest/services")&&!r.hasSameOrigin(a,window.location.href)&&!r.canUseXhr(a)){if(b[c]&&!b[c].isCanceled())return b[c];var d=new q(t._dfdCanceller);b[c]=d.promise;var g=h.get({url:a.substring(0,a.toLowerCase().indexOf("/rest/")+6)+"info",content:{f:"json"},failOk:!0,handleAs:"json",headers:{"X-Requested-With":null},
timeout:1E3*D.corsDetectionTimeout});d._pendingDfd=g;g.then(function(b){b?(r.canUseXhr(a)||D.corsEnabledServers.push(c),d.resolve()):d.reject()},function(a){d.reject(a)});return d.promise}}catch(S){console.log("esri._detectCors: an unknown error occurred while detecting CORS support")}return L}function A(a,c,d,g){function t(a){a._pendingDfd=w(d,g,I,C);if(!a._pendingDfd){a.ioArgs=a._pendingDfd&&a._pendingDfd.ioArgs;var c=Error("Deferred object is missing");c.log=!!p.isDebug;a.errback(c);a._pendingDfd=
null;return a}a._pendingDfd.addCallback(function(b){a.ioArgs=a._pendingDfd&&a._pendingDfd.ioArgs;g.returnFullResponse&&(b={data:b,_xhr:a.ioArgs&&a.ioArgs.xhr,getHeader:y});a.callback(b);a._pendingDfd=null}).addErrback(function(c){var t,r,v;c&&(t=c.code,r=c.subcode,v=(v=c.messageCode)&&v.toUpperCase());if(c&&403==t&&(4==r||c.message&&-1<c.message.toLowerCase().indexOf("ssl")&&-1===c.message.toLowerCase().indexOf("permission"))){if(!d._ssl){d._ssl=d._sslFromServer=!0;A(a,!0,d,g);return}}else if(c&&
415==c.status){if(z(d.url),!d._err415){d._err415=1;A(a,!0,d,g);return}}else if(b.id&&-1!==e.indexOf(b.id._errorCodes,t)&&!b.id._isPublic(d.url)&&!l&&(403!=t||-1===e.indexOf(F,v)&&(!m.isDefined(r)||2==r&&d._token))){a._pendingDfd=b.id.getCredential(d.url,{token:d._token,error:c});a._pendingDfd.addCallback(function(b){d._token=b.token;d._credential=b;d._ssl=d._sslFromServer||b.ssl;A(a,!0,d,g)}).addErrback(function(b){a.errback(b);a._pendingDfd=null});return}a.ioArgs=a._pendingDfd&&a._pendingDfd.ioArgs;
a.isFulfilled()||a.errback(c);a._pendingDfd=null})}var f=d.form,l=g.disableIdentityLookup,n=g._preLookup,x=!1;if(u("esri-workers")&&!1!==D.useWorkers)if(!0===g.useWorkers||!0===D.useWorkers)x=!0;else if(g.workerOptions){var q=g.workerOptions;if(q.callback||q.worker&&q.worker.worker instanceof Worker)x=!0}var C=f&&u("esri-file-upload")&&f instanceof FormData,I=f&&(f.elements?e.some(f.elements,function(a){return"file"===a.type}):C),E=-1!==d.url.toLowerCase().indexOf("token\x3d")||d.content&&d.content.token||
I&&e.some(f.elements,function(a){return"token"===a.name})?1:0;if(!c){a.addCallback(function(a){if((/\/sharing\/rest\/accounts\/self/i.test(d.url)||/\/sharing\/rest\/portals\/self/i.test(d.url))&&!E&&!d._token&&a.user&&a.user.username){D.webTierAuthServers.push(v(d.url));a=D.corsEnabledServers;var c=r.canUseXhr(d.url,!0),g={host:v(d.url),withCredentials:!0};if(-1===c)a.push(g);else{var m=a[c];"object"===typeof m?m.withCredentials=!0:a.splice(c,1,g)}}if(a=d._credential)if(c=(c=b.id.findServerInfo(a.server))&&
c.owningSystemUrl)c=c.replace(/\/?$/,"/sharing"),(a=b.id.findCredential(c,a.userId))&&-1===b.id._getIdenticalSvcIdx(c,a)&&a.resources.splice(0,0,c)});a.addBoth(function(a){delete d._credential;!a||u("ie")&&a.nodeType||(a._ssl=d._ssl)});var M=d.load,J=d.error;M&&a.addCallback(function(b){var c=a._pendingDfd,c=c&&c.ioArgs;return M.call(c&&c.args,b,c)});J&&a.addErrback(function(b){var c=a._pendingDfd,c=c&&c.ioArgs;return J.call(c&&c.args,b,c)})}!b.id||E||d._token||b.id._isPublic(d.url)||l&&!n||!(c=b.id.findCredential(d.url))||
(d._token=c.token,d._ssl=c.ssl);x?g.workerOptions&&g.workerOptions.worker?(B||(B=h),h=g.workerOptions.worker,t(a)):k(["./workers/RequestClient"],function(b){B||(B=h);if(g.workerOptions){var c=g.workerOptions;h=b.getClient(c.callback,c.cbFunction)}else h=b.getClient();t(a)}):(B&&(h=B,B=null),t(a));return a}function C(a,b){a.url=r.fixUrl(a.url);b=b||{};var c=new q(t._dfdCanceller),d=x(a.url);c._pendingDfd=d;d.always(function(d){d&&"cancel"===d.dojoType?c.reject(d):A(c,!1,a,b)});return c}var B=null,
E,D=g.defaults.io,F=["COM_0056","COM_0057"],I=0,M=/%[0-9A-F]{2}/i,L=function(){var a=new q;a.resolve();return a.promise}();C._makeRequest=w;C._processRequest=A;C._disableCors=z;C._detectCors=x;C.setRequestPreCallback=function(a){E=a};return C})},"esri/core/request/script":function(){define("require exports dojo/Deferred dojo/request/script dojo/text!./iframe.html ../sniff".split(" "),function(k,e,p,q,n,l){function h(){var a=document.createElement("iframe");a.name="esri_core_jsonp_iframe";a.style.display=
"none";a.setAttribute("sandbox","allow-scripts");if(!l("ff")&&"srcdoc"in a){var b=k.toUrl("dojo/dojo.js"),c=n.replace("../../../dojo/dojo.js",b),b=b.slice(0,-7),c=c.replace("../../../dojo/",b);a.srcdoc=c}else c=k.toUrl("./iframe.html"),"http:"===window.location.protocol&&0===c.indexOf("https:")&&(c=c.replace("https:","http:")),a.src=c;document.body.appendChild(a);return a}function f(){var a=new MessageChannel;a.port1.addEventListener("message",d);a.port1.start();return a}function d(b){var c=b.data;
if("ready"===c){for(var c=0,d=m;c<d.length;c++)b=d[c],a(b,g);m=null}else if(b=r[c.id])delete r[c.id],c.isError?b.dfd.reject(Error(c.message)):b.dfd.resolve(c.response)}function c(a,b){a.addEventListener("load",function(){a.contentWindow.postMessage("init","*",[b.port2])})}function a(a,b){r[a.message.id]=a;b.port1.postMessage(a.message)}Object.defineProperty(e,"__esModule",{value:!0});var b,g,u=0,m=[],r={};e.get=function(d,v){if(!l("esri-script-sandbox"))return q.get(d,v);var t=null;v&&(t={jsonp:v.jsonp,
preventCache:v.preventCache,query:v.query,timeout:v.timeout});v=new p(function(){if(m){var a=m.indexOf(w);-1<a&&m.splice(a,1)}else w.message.id in r&&delete r[w.message.id]});var w={dfd:v,message:{id:"id"+(++u+Math.random()),url:d,options:t}};b||(b=h(),g=f(),c(b,g));m?m.push(w):a(w,g);return v.promise}})},"dojo/text":function(){define(["./_base/kernel","require","./has","./request"],function(k,e,p,q){var n;n=function(c,a,b){q(c,{sync:!!a,headers:{"X-Requested-With":null}}).then(b)};var l={},h=function(c){if(c){c=
c.replace(/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,"");var a=c.match(/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im);a&&(c=a[1])}else c="";return c},f={},d={};k.cache=function(c,a,b){var d;"string"==typeof c?/\//.test(c)?(d=c,b=a):d=e.toUrl(c.replace(/\./g,"/")+(a?"/"+a:"")):(d=c+"",b=a);c=void 0!=b&&"string"!=typeof b?b.value:b;b=b&&b.sanitize;if("string"==typeof c)return l[d]=c,b?h(c):c;if(null===c)return delete l[d],null;d in l||n(d,!0,function(a){l[d]=a});return b?h(l[d]):l[d]};return{dynamic:!0,
normalize:function(c,a){c=c.split("!");var b=c[0];return(/^\./.test(b)?a(b):b)+(c[1]?"!"+c[1]:"")},load:function(c,a,b){c=c.split("!");var g=1<c.length,u=c[0],m=a.toUrl(c[0]);c="url:"+m;var r=f,t=function(a){b(g?h(a):a)};u in l?r=l[u]:a.cache&&c in a.cache?r=a.cache[c]:m in l&&(r=l[m]);if(r===f)if(d[m])d[m].push(t);else{var v=d[m]=[t];n(m,!a.async,function(a){l[u]=l[m]=a;for(var b=0;b<v.length;)v[b++](a);delete d[m]})}else t(r)}}})},"dojo/request":function(){define(["./request/default!"],function(k){return k})},
"dojo/request/default":function(){define(["exports","require","../has"],function(k,e,p){var q=p("config-requestProvider");q||(q="./xhr");k.getPlatformDefaultId=function(){return"./xhr"};k.load=function(n,l,h,f){e(["platform"==n?"./xhr":q],function(d){h(d)})}})},"esri/core/sniff":function(){define(["../sniff"],function(k){return k})},"esri/sniff":function(){define(["dojo/_base/sniff","./kernel"],function(k,e){var p=function(){return this}(),q=k("ff"),n=k("ie"),l=void 0===n&&7<=k("trident"),h=k("edge"),
f=k("webkit"),d=k("opera"),c=k("chrome"),a=k("safari"),b=navigator.userAgent,g;(g=b.match(/(iPhone|iPad|CPU)\s+OS\s+(\d+\_\d+)/i))&&k.add("esri-iphone",parseFloat(g[2].replace("_",".")));(g=b.match(/Android\s+(\d+\.\d+)/i))&&k.add("esri-android",parseFloat(g[1]));(g=b.match(/Fennec\/(\d+\.\d+)/i))&&k.add("esri-fennec",parseFloat(g[1]));0<=b.indexOf("BlackBerry")&&0<=b.indexOf("WebKit")&&k.add("esri-blackberry",1);k.add("esri-touch",k("esri-iphone")||k("esri-android")||k("esri-blackberry")||6<=k("esri-fennec")||
(q||f)&&document.createTouch?!0:!1);(g=b.match(/Android|webOS|iPhone|iPad|iPod|BlackBerry|Opera Mini|IEMobile/i))&&k.add("esri-mobile",g);k.add("esri-pointer",navigator.pointerEnabled||navigator.msPointerEnabled);e._getDOMAccessor=function(a){var b="";q?b="Moz":f?b="Webkit":n?b="ms":d&&(b="O");return b+a.charAt(0).toUpperCase()+a.substr(1)};k.add("esri-phonegap",!!p.cordova);k.add("esri-cors",k("esri-phonegap")||p.XMLHttpRequest&&"withCredentials"in new XMLHttpRequest);k.add("esri-file-upload",p.FormData&&
p.FileList?!0:!1);k.add("esri-workers",p.Worker?!0:!1);k.add("esri-script-sandbox",function(){return"MessageChannel"in p&&"HTMLIFrameElement"in p&&"sandbox"in HTMLIFrameElement.prototype});k.add("esri-transforms",l||h||9<=n||3.5<=q||4<=c||3.1<=a||10.5<=d||3.2<=k("esri-iphone")||2.1<=k("esri-android"));k.add("esri-transitions",l||h||10<=n||4<=q||4<=c||3.1<=a||10.5<=d||3.2<=k("esri-iphone")||2.1<=k("esri-android"));k.add("esri-transforms3d",l||h||10<=q||12<=c||4<=a||3.2<=k("esri-iphone")||3<=k("esri-android"));
k.add("esri-url-encodes-apostrophe",function(){if(p.document)return!1;var a=p.document.createElement("a");a.href="?'";return-1<a.href.indexOf("?%27")});3>k("esri-android")&&(k.add("esri-transforms",!1,!1,!0),k.add("esri-transitions",!1,!1,!0),k.add("esri-transforms3d",!1,!1,!0));k.add("esri-will-change",k("esri-transforms")&&(52<=c||11.1<=a));e._css=function(b){var g=k("esri-transforms3d");void 0!==b&&null!==b?g=b:g&&(c||a&&!k("esri-iphone"))&&(g=!1);var r=g?"translate3d(":"translate(",t=g?c?",-1px)":
",0px)":")",v=g?"scale3d(":"scale(",u=g?",1)":")",w=g?"rotate3d(0,0,1,":"rotate(",h=g?"matrix3d(":"matrix(",l=g?",0,0,":",",e=g?",0,0,0,0,1,0,":",",p=g?",0,1)":")";return{names:{transition:f&&"-webkit-transition"||q&&"MozTransition"||d&&"OTransition"||n&&"msTransition"||"transition",transform:f&&"-webkit-transform"||q&&"MozTransform"||d&&"OTransform"||n&&"msTransform"||"transform",transformName:f&&"-webkit-transform"||q&&"-moz-transform"||d&&"-o-transform"||n&&"-ms-transform"||"transform",origin:f&&
"-webkit-transform-origin"||q&&"MozTransformOrigin"||d&&"OTransformOrigin"||n&&"msTransformOrigin"||"transformOrigin",endEvent:f&&"webkitTransitionEnd"||q&&"transitionend"||d&&"oTransitionEnd"||n&&"MSTransitionEnd"||"transitionend"},translate:function(a,b){return r+a+"px,"+b+"px"+t},scale:function(a){return v+a+","+a+u},rotate:function(a){return w+a+"deg)"},matrix:function(a){return h+a.xx+","+a.xy+l+a.yx+","+a.yy+e+a.dx.toFixed(10)+(q?"px,":",")+a.dy.toFixed(10)+(q?"px":"")+p},getScaleFromMatrix:function(a){if(!a)return 1;
a=a.toLowerCase();var b=-1<a.indexOf("matrix3d")?"matrix3d(":"matrix(";return Number(a.substring(b.length,a.indexOf(",")))}}};return k})},"dojo/request/iframe":function(){define("module require ./watch ./util ./handlers ../_base/lang ../io-query ../query ../has ../dom ../dom-construct ../_base/window ../NodeList-dom".split(" "),function(k,e,p,q,n,l,h,f,d,c,a,b){function g(a){return!this.isFulfilled()}function u(a){return!!this._finished}function m(a,b){if(!b)try{var c=a.options,d=t.doc(t._frame),
g=c.handleAs;if("html"!==g){if("xml"===g)if("html"===d.documentElement.tagName.toLowerCase()){f("a",d.documentElement).orphan();var m=d.documentElement.innerText||d.documentElement.textContent,m=m.replace(/>\s+</g,"\x3e\x3c");a.text=l.trim(m)}else a.data=d;else a.text=d.getElementsByTagName("textarea")[0].value;n(a)}else a.data=d}catch(D){b=D}b?this.reject(b):this._finished?this.resolve(a):this.reject(Error("Invalid dojo/request/iframe request state"))}function r(a){this._callNext()}function t(a,
b,c){var d=q.parseArgs(a,q.deepCreate(w,b),!0);a=d.url;b=d.options;if("GET"!==b.method&&"POST"!==b.method)throw Error(b.method+" not supported by dojo/request/iframe");t._frame||(t._frame=t.create(t._iframeName,y+"();"));a=q.deferred(d,null,g,u,m,r);a._callNext=function(){this._calledNext||(this._calledNext=!0,t._currentDfd=null,t._fireNextRequest())};a._legacy=c;t._dfdQueue.push(a);t._fireNextRequest();p(a);return c?a:a.promise}var v=k.id.replace(/[\/\.\-]/g,"_"),y=v+"_onload";b.global[y]||(b.global[y]=
function(){var b=t._currentDfd;if(b){var d=c.byId(b.response.options.form)||b._tmpForm;if(d){for(var g=b._contentToClean,m=0;m<g.length;m++)for(var r=g[m],v=0;v<d.childNodes.length;v++){var f=d.childNodes[v];if(f.name===r){a.destroy(f);break}}b._originalAction&&d.setAttribute("action",b._originalAction);b._originalMethod&&(d.setAttribute("method",b._originalMethod),d.method=b._originalMethod);b._originalTarget&&(d.setAttribute("target",b._originalTarget),d.target=b._originalTarget)}b._tmpForm&&(a.destroy(b._tmpForm),
delete b._tmpForm);b._finished=!0}else t._fireNextRequest()});var w={method:"POST"};t.create=function(c,g,m){if(b.global[c])return b.global[c];if(b.global.frames[c])return b.global.frames[c];m||(d("config-useXDomain")&&!d("config-dojoBlankHtmlUrl")&&console.warn("dojo/request/iframe: When using cross-domain Dojo builds, please save dojo/resources/blank.html to your domain and set dojoConfig.dojoBlankHtmlUrl to the path on your domain to blank.html"),m=d("config-dojoBlankHtmlUrl")||e.toUrl("dojo/resources/blank.html"));
g=a.place('\x3ciframe id\x3d"'+c+'" name\x3d"'+c+'" src\x3d"'+m+'" onload\x3d"'+g+'" style\x3d"position: absolute; left: 1px; top: 1px; height: 1px; width: 1px; visibility: hidden"\x3e',b.body());return b.global[c]=g};t.doc=function(a){if(a.contentDocument)return a.contentDocument;var c=a.name;if(c){var d=b.doc.getElementsByTagName("iframe");if(a.document&&d[c].contentWindow&&d[c].contentWindow.document)return d[c].contentWindow.document;if(b.doc.frames[c]&&b.doc.frames[c].document)return b.doc.frames[c].document}return null};
t.setSrc=function(a,c,d){a=b.global.frames[a.name];a.contentWindow&&(a=a.contentWindow);try{d?a.location.replace(c):a.location=c}catch(C){console.log("dojo/request/iframe.setSrc: ",C)}};t._iframeName=v+"_IoIframe";t._notifyStart=function(){};t._dfdQueue=[];t._currentDfd=null;t._fireNextRequest=function(){var d;try{if(!t._currentDfd&&t._dfdQueue.length){do d=t._currentDfd=t._dfdQueue.shift();while(d&&(d.canceled||d.isCanceled&&d.isCanceled())&&t._dfdQueue.length);if(!d||d.canceled||d.isCanceled&&d.isCanceled())t._currentDfd=
null;else{var g=d.response,m=g.options,r=d._contentToClean=[],f=c.byId(m.form),u=q.notify,w=m.data||null,n;d._legacy||"POST"!==m.method||f?"GET"===m.method&&f&&-1<g.url.indexOf("?")&&(n=g.url.slice(g.url.indexOf("?")+1),w=l.mixin(h.queryToObject(n),w)):f=d._tmpForm=a.create("form",{name:v+"_form",style:{position:"absolute",top:"-1000px",left:"-1000px"}},b.body());if(f){if(!d._legacy){var e=f;do e=e.parentNode;while(e&&e!==b.doc.documentElement);e||(f.style.position="absolute",f.style.left="-1000px",
f.style.top="-1000px",b.body().appendChild(f));f.name||(f.name=v+"_form")}if(w){var e=function(b,c){a.create("input",{type:"hidden",name:b,value:c},f);r.push(b)},y;for(y in w){var k=w[y];if(l.isArray(k)&&1<k.length)for(n=0;n<k.length;n++)e(y,k[n]);else f[y]?f[y].value=k:e(y,k)}}var p=f.getAttributeNode("action"),P=f.getAttributeNode("method"),K=f.getAttributeNode("target");g.url&&(d._originalAction=p?p.value:null,p?p.value=g.url:f.setAttribute("action",g.url));d._legacy?P&&P.value||(P?P.value=m.method:
f.setAttribute("method",m.method)):(d._originalMethod=P?P.value:null,P?P.value=m.method:f.setAttribute("method",m.method));d._originalTarget=K?K.value:null;K?K.value=t._iframeName:f.setAttribute("target",t._iframeName);f.target=t._iframeName;u&&u.emit("send",g,d.promise.cancel);t._notifyStart(g);f.submit()}else m="",g.options.data&&(m=g.options.data,"string"!==typeof m&&(m=h.objectToQuery(m))),e=g.url+(-1<g.url.indexOf("?")?"\x26":"?")+m,u&&u.emit("send",g,d.promise.cancel),t._notifyStart(g),t.setSrc(t._frame,
e,!0)}}}catch(U){d.reject(U)}};q.addCommonMethods(t,["GET","POST"]);return t})},"esri/urlUtils":function(){define("dojo/_base/lang dojo/_base/array dojo/_base/url dojo/io-query ./kernel ./lang ./config ./sniff dojo/i18n!./nls/jsapi".split(" "),function(k,e,p,q,n,l,h,f,d){var c=function(){return this}(),a={},b=h.defaults.io,g=/^[a-z][a-z0-9\+\-\.]*:/i,u=/^\s*http:/i,m=/^\s*https:/i,r=/^https?:\/\/[^/]+\.arcgis.com\/sharing(\/|$)/i;a.isHTTP=function(a){var b=c.location.protocol;return null==a?"http:"===
b||"https:"===b:a?"https:"===b:"http:"===b};a.getProtocolForWebResource=function(b){return a.isHTTP()?c.location.protocol:b?"https:":"http:"};a.urlToObject=function(a){var b={},c=new p(a),d=a.indexOf("?");null===c.query?b={path:a,query:null}:(b.path=a.substring(0,d),b.query=q.queryToObject(c.query));c.fragment&&(b.hash=c.fragment,null===c.query&&(b.path=b.path.substring(0,b.path.length-(c.fragment.length+1))));return b};a.getProxyUrl=function(g,m){var t=k.isString(g)?0===k.trim(g).toLowerCase().indexOf("https:"):
g,r=b.proxyUrl,f,v=d.io.proxyNotSet;k.isString(g)&&(g=a.getProxyRule(g))&&(r=g.proxyUrl);if(!r)throw console.log(v),Error(v);t&&!1!==m&&0!==c.location.href.toLowerCase().indexOf("https:")&&(m=r,0!==m.toLowerCase().indexOf("http")&&(m=a.getAbsoluteUrl(m)),m=m.replace(/^http:/i,"https:"),a.canUseXhr(m)&&(r=m,f=1));r=a.urlToObject(r);r._xo=f;return r};a.addProxy=function(c){var d=a.getProxyRule(c),g;d?g=a.urlToObject(d.proxyUrl):b.alwaysUseProxy&&(g=a.getProxyUrl());g&&(d=a.urlToObject(c),c=g.path+"?"+
d.path,(g=q.objectToQuery(k.mixin(g.query||{},d.query)))&&(c+="?"+g));return c};a.addProxyRule=function(c){var d=c.urlPrefix=a.urlToObject(c.urlPrefix).path.replace(/([^\/])$/,"$1/").replace(/^https?:\/\//ig,"").toLowerCase(),g=b.proxyRules,m,t=g.length,r,f=t;for(m=0;m<t;m++)if(r=g[m].urlPrefix,0===d.indexOf(r)){if(d.length===r)return-1;f=m;break}else 0===r.indexOf(d)&&(f=m+1);g.splice(f,0,c);return f};a.getProxyRule=function(c){var d=b.proxyRules,g=d.length,m=a.urlToObject(c).path.replace(/([^\/])$/,
"$1/").replace(/^https?:\/\//ig,"").toLowerCase(),t;for(c=0;c<g;c++)if(0===m.indexOf(d[c].urlPrefix)){t=d[c];break}return t};a.hasSameOrigin=function(a,b,d){a=a.toLowerCase();b=b.toLowerCase();var g=c.location.href.toLowerCase();a=0===a.indexOf("http")?new p(a):g=new p(g);b=0===b.indexOf("http")?new p(b):k.isString(g)?new p(g):g;return(d||a.scheme===b.scheme)&&a.host===b.host&&a.port===b.port};a.canUseXhr=function(c,d){var g=f("esri-phonegap")?!0:!1,m=a.hasSameOrigin,r=b.corsEnabledServers,t,v=-1;
!g&&f("esri-cors")&&r&&r.length&&(g=e.some(r,function(a,b){if(a=a&&"object"===typeof a?a.host:a)if(t=0!==k.trim(a).toLowerCase().indexOf("http"),m(c,t?"http://"+a:a)||t&&m(c,"https://"+a))return v=b,!0;return!1}));return d?v:g};a.getAbsoluteUrl=function(b){var d=a.getProtocolForWebResource();return k.isString(b)&&!g.test(b)?0===b.indexOf("//")?d+b:0===b.indexOf("/")?d+"//"+c.location.host+b:n._appBaseUrl+b:b};a.fixUrl=function(b){b=k.trim(b);b=a.getAbsoluteUrl(b);b=a.downgradeToHTTP(b);b=a.upgradeToHTTPS(b);
return b=b.replace(/^(https?:\/\/)(arcgis\.com)/i,"$1www.$2")};a.normalize=function(b){return a.fixUrl(b)};a.downgradeToHTTP=function(b){return a.isHTTP(!1)&&m.test(b)&&a.hasSameOrigin(c.location.href,b,!0)&&!a.canUseXhr(b)?b.replace(m,"http:"):b};a.upgradeToHTTPS=function(b){var d=h.defaults.io.httpsDomains,g=a.isHTTP(!1),m=a.isHTTP(!0);if(!u.test(b))return b;b=k.trim(b);var t=b.indexOf("/",7),t=-1===t?b:b.slice(0,t),t=t.toLowerCase().slice(7);if(g&&t===c.location.host&&(!r.test(b)||!a.canUseXhr(b)))return b;
g=!1;if(m&&t===c.location.host)g=!0;else if(d)for(m=0;m<d.length;m++){var f=d[m];if(t===f||l.endsWith(t,"."+f)){g=!0;break}}g&&(b=b.replace(u,"https:"));return b};return a})},"esri/deferredUtils":function(){define(["dojo/_base/lang","dojo/has","./kernel"],function(k,e,p){return{_dfdCanceller:function(e){e.canceled=!0;var n=e._pendingDfd,l;e.isFulfilled()||!n||n.isFulfilled()||(n.cancel(),l=n.results&&n.results[1]);e._pendingDfd=null;return l},_fixDfd:function(e){var n=e.then;e.then=function(l,h,f){if(l){var d=
l;l=function(c){return c&&c._argsArray?d.apply(null,c):d(c)}}return n.call(this,l,h,f)};return e},_resDfd:function(e,n,l){var h=n.length;1===h?l?e.errback(n[0]):e.callback(n[0]):1<h?(n._argsArray=!0,e.callback(n)):e.callback()}}})},"esri/SpatialReference":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/has ./kernel ./lang".split(" "),function(k,e,p,q,n,l){q=[-2.0037508342788905E7,2.0037508342788905E7];n=[-2.0037508342787E7,2.0037508342787E7];return k(null,{declaredClass:"esri.SpatialReference",
constructor:function(h){h&&(p.isObject(h)?p.mixin(this,h):p.isString(h)?this.wkt=h:this.wkid=h)},wkid:null,wkt:null,_info:{102113:{wkTemplate:'PROJCS["WGS_1984_Web_Mercator",GEOGCS["GCS_WGS_1984_Major_Auxiliary_Sphere",DATUM["D_WGS_1984_Major_Auxiliary_Sphere",SPHEROID["WGS_1984_Major_Auxiliary_Sphere",6378137.0,0.0]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",${Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],UNIT["Meter",1.0]]',
valid:q,origin:n,dx:1E-5},102100:{wkTemplate:'PROJCS["WGS_1984_Web_Mercator_Auxiliary_Sphere",GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator_Auxiliary_Sphere"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",${Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],PARAMETER["Auxiliary_Sphere_Type",0.0],UNIT["Meter",1.0]]',valid:q,origin:n,
dx:1E-5},3785:{wkTemplate:'PROJCS["WGS_1984_Web_Mercator",GEOGCS["GCS_WGS_1984_Major_Auxiliary_Sphere",DATUM["D_WGS_1984_Major_Auxiliary_Sphere",SPHEROID["WGS_1984_Major_Auxiliary_Sphere",6378137.0,0.0]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",${Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],UNIT["Meter",1.0]]',valid:q,origin:n,dx:1E-5},3857:{wkTemplate:'PROJCS["WGS_1984_Web_Mercator_Auxiliary_Sphere",GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator_Auxiliary_Sphere"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",${Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],PARAMETER["Auxiliary_Sphere_Type",0.0],UNIT["Meter",1.0]]',
valid:q,origin:n,dx:1E-5},4326:{wkTemplate:'GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",${Central_Meridian}],UNIT["Degree",0.0174532925199433]]',altTemplate:'PROJCS["WGS_1984_Plate_Carree",GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Plate_Carree"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",${Central_Meridian}],UNIT["Degrees",111319.491]]',
valid:[-180,180],origin:[-180,180],dx:1E-5}},_isWebMercator:function(){return-1!==e.indexOf([102113,102100,3857,3785],this.wkid)},_isWrappable:function(){return-1!==e.indexOf([102113,102100,3857,3785,4326],this.wkid)},_getInfo:function(){return this.wkid?this._info[this.wkid]:null},_canProject:function(h){var f=!1;h&&(f=this.isWebMercator()&&4326===h.wkid||h.isWebMercator()&&4326===this.wkid);return f},isWebMercator:function(){return this._isWebMercator()},equals:function(h){var f=!1;h&&(this===h&&
(f=!0),this.wkid||h.wkid?f=this.wkid===h.wkid||this.isWebMercator()&&h.isWebMercator()||this.wkid===h.latestWkid||h.wkid===this.latestWkid:this.wkt&&h.wkt&&(f=this.wkt.toUpperCase()===h.wkt.toUpperCase()));return f},toJson:function(){var h=null,f=l.isDefined;f(this.wkid)?h={wkid:this.wkid}:f(this.wkt)&&(h={wkt:this.wkt});h&&f(this.latestWkid)&&(h.latestWkid=this.latestWkid);return h}})})},"esri/map":function(){define("require dojo/_base/kernel dojo/_base/declare dojo/_base/connect dojo/_base/lang dojo/_base/array dojo/_base/event dojo/on dojo/aspect dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/dom-geometry dojo/dom-style dijit/a11yclick dijit/registry ./kernel ./config ./sniff ./lang ./_coremap ./MapNavigationManager dojo/i18n!./nls/jsapi".split(" "),
function(k,e,p,q,n,l,h,f,d,c,a,b,g,u,m,r,t,v,y,w,z,x,A,C){var B={up:"panUp",right:"panRight",down:"panDown",left:"panLeft"},E={upperRight:"panUpperRight",lowerRight:"panLowerRight",lowerLeft:"panLowerLeft",upperLeft:"panUpperLeft"},D=q.connect,F=q.disconnect,I=g.create,M=m.set,L=n.hitch,J=u.getMarginBox,P=e.deprecated,K=n.mixin,U=0;return p(x,{declaredClass:"esri.Map",constructor:function(a,b){b=b||{};K(this,{_slider:null,_navDiv:null,_mapParams:K({attributionWidth:.45,slider:!0,nav:!1,logo:!0,sliderStyle:"small",
sliderPosition:"top-left",sliderOrientation:"vertical",autoResize:!0},b)});K(this,{isMapNavigation:null!=b.isMapNavigation?b.isMapNavigation:!0,isDoubleClickZoom:null!=b.isDoubleClickZoom?b.isDoubleClickZoom:!0,isClickRecenter:null!=b.isClickRecenter?b.isClickRecenter:!0,isPan:null!=b.isPan?b.isPan:!0,isRubberBandZoom:null!=b.isRubberBandZoom?b.isRubberBandZoom:!0,isPinchZoom:null!=b.isPinchZoom?b.isPinchZoom:!0,isKeyboardNavigation:null!=b.isKeyboardNavigation?b.isKeyboardNavigation:!0,isScrollWheel:null!=
b.isScrollWheel?b.isScrollWheel:!0,isShiftDoubleClickZoom:!1,isScrollWheelZoom:!1,isPanArrows:!1,isZoomSlider:!1});n.isFunction(v._css)&&(v._css=v._css(this._mapParams.force3DTransforms),this.force3DTransforms=this._mapParams.force3DTransforms);a=w("esri-transforms")&&w("esri-transitions");this.navigationMode=this._mapParams.navigationMode||a&&"css-transforms"||"classic";"css-transforms"!==this.navigationMode||a||(this.navigationMode="classic");this.fadeOnZoom=z.isDefined(this._mapParams.fadeOnZoom)?
this._mapParams.fadeOnZoom:"css-transforms"===this.navigationMode;"css-transforms"!==this.navigationMode&&(this.fadeOnZoom=!1);this.setMapCursor("default");this.smartNavigation=b&&b.smartNavigation;if(!(z.isDefined(this.smartNavigation)||!w("mac")||w("esri-touch")||w("esri-pointer")||3.5>=w("ff"))){var c=navigator.userAgent.match(/Mac\s+OS\s+X\s+([\d]+)(\.|\_)([\d]+)\D/i);c&&z.isDefined(c[1])&&z.isDefined(c[3])&&(a=parseInt(c[1],10),c=parseInt(c[3],10),this.smartNavigation=10<a||10===a&&6<=c)}this.showAttribution=
z.isDefined(this._mapParams.showAttribution)?this._mapParams.showAttribution:!0;this._onLoadHandler_connect=D(this,"onLoad",this,"_onLoadInitNavsHandler");var g=I("div",{"class":"esriControlsBR"+(this._mapParams.nav?" withPanArrows":"")},this.root);if(this.showAttribution)if(a=n.getObject("esri.dijit.Attribution",!1))this._initAttribution(a,g);else{var m=U++,t=this;this._rids&&this._rids.push(m);k(["./dijit/Attribution"],function(a){var b=t._rids?l.indexOf(t._rids,m):-1;-1!==b&&(t._rids.splice(b,
1),t._initAttribution(a,g))})}this._mapParams.logo&&(a={},6===w("ie")&&(a.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(enabled\x3d'true', sizingMethod\x3d'crop', src\x3d'"+k.toUrl("./images/map/logo-med.png")+"')"),this._ogol=I("div",{style:a,tabIndex:"0",title:"Esri"},g),this._setLogoSize(),this._onMapResizeLogo_connect=D(this,"onResize",this,"_setLogoSize"),this._ogol_connect=D(this._ogol,r,this,"_openLogoLink"));this.navigationManager=new A(this);b&&b.basemap&&(this._onLoadFix=!0,
this.setBasemap(b.basemap),this._onLoadFix=!1);if(this.autoResize=this._mapParams.autoResize)b=this._getEnclosingResizableWidget(this.container)||window,a=this.resize,this._rszSignal=f.pausable(b,"resize",a),this._oriSignal=f.pausable(window,"orientationchange",a),d.after(b,"resize",a,!0),this._startResizeTimer()},_startResizeTimer:function(){clearTimeout(this._persistentTimer);this._persistentTimer=setTimeout(this._timedResize,2*this.resizeDelay)},_getEnclosingResizableWidget:function(a){var b=t.getEnclosingWidget(a);
return b?b.resize?b:this._getEnclosingResizableWidget(a.parentNode):b},_setLogoSize:function(){this._ogol&&(25E4>this.root.clientWidth*this.root.clientHeight?(b.remove(this._ogol,"logo-med"),b.add(this._ogol,"logo-sm")):(b.remove(this._ogol,"logo-sm"),b.add(this._ogol,"logo-med")))},_initAttribution:function(a,c){c=I("span",{"class":"esriAttribution"},c,"first");M(c,"maxWidth",Math.floor(this.width*this._mapParams.attributionWidth)+"px");this._connects.push(D(c,r,function(){b.contains(this,"esriAttributionOpen")?
b.remove(this,"esriAttributionOpen"):this.scrollWidth>this.clientWidth&&b.add(this,"esriAttributionOpen")}));this.attribution=new a({map:this},c)},_cleanUp:function(){this.disableMapNavigation();this.navigationManager.destroy();var a=this._slider;a&&a.destroy&&!a._destroyed&&a.destroy();var a=this._navDiv,b=this.attribution;a&&g.destroy(a);b&&b.destroy();this._connects.push(this._slider_connect,this._ogol_connect,this._rszSignal,this._oriSignal);l.forEach(this._connects,F);clearInterval(this._persistentTimer);
this.attribution=this.navigationManager=this._rids=this._connects=this._slider_connect=this._ogol_connect=this._rszSignal=this._oriSignal=this._persistentTimer=null;this.inherited("_cleanUp",arguments)},_isPanningOrZooming:function(){return this.__panning||this.__zooming},_canZoom:function(a){var b=this.getLevel();return!this.__tileInfo||!(b===this.getMinZoom()&&0>a||b===this.getMaxZoom()&&0<a)},_onLoadInitNavsHandler:function(){this._evalMapNavigation();this._createNav();if("small"===this._mapParams.sliderStyle||
!this._createSlider)this._createSimpleSlider();else if(this._mapParams.slider){var a=-1!==this._getSliderClass(!0).indexOf("Horizontal"),a=[a?"dijit.form.HorizontalSlider":"dijit.form.VerticalSlider",a?"dijit.form.HorizontalRule":"dijit.form.VerticalRule",a?"dijit.form.HorizontalRuleLabels":"dijit.form.VerticalRuleLabels"];if(l.some(a,function(a){return!n.getObject(a,!1)})){var a=l.map(a,function(a){return a.replace(/\./g,"/")}),b=U++,c=this;this._rids&&this._rids.push(b);k(a,function(){var a=c._rids?
l.indexOf(c._rids,b):-1;-1!==a&&(c._rids.splice(a,1),c._createSlider.apply(c,arguments))})}else a=l.map(a,function(a){return n.getObject(a,!1)}),this._createSlider.apply(this,a)}F(this._onLoadHandler_connect)},_createNav:function(){if(this._mapParams.nav){var a,c,d,g=b.add,m=this.id;this._navDiv=I("div",{id:m+"_navdiv"},this.root);g(this._navDiv,"navDiv");var r=this.width/2,t=this.height/2,f;for(d in B)c=B[d],a=I("div",{id:m+"_pan_"+d},this._navDiv),g(a,"fixedPan "+c),"up"===d||"down"===d?(f=parseInt(J(a).w,
10)/2,M(a,{left:r-f+"px",zIndex:30})):(f=parseInt(J(a).h,10)/2,M(a,{top:t-f+"px",zIndex:30})),this._connects.push(D(a,"onclick",L(this,this[c])));this._onMapResizeNavHandler_connect=D(this,"onResize",this,"_onMapResizeNavHandler");for(d in E)c=E[d],a=I("div",{id:m+"_pan_"+d,style:{zIndex:30}},this._navDiv),g(a,"fixedPan "+c),this._connects.push(D(a,"onclick",L(this,this[c])));this.isPanArrows=!0}},_onMapResizeNavHandler:function(a,b,d){a=this.id;b/=2;d/=2;var g=c.byId,m,r,t;for(m in B)r=g(a+"_pan_"+
m),"up"===m||"down"===m?(t=parseInt(J(r).w,10)/2,M(r,"left",b-t+"px")):(t=parseInt(J(r).h,10)/2,M(r,"top",d-t+"px"))},_createSimpleSlider:function(){if(this._mapParams.slider){var a=this._slider=I("div",{id:this.id+"_zoom_slider","class":this._getSliderClass(),style:{zIndex:30}}),d=I("div",{"class":"esriSimpleSliderIncrementButton",tabIndex:"0",role:"button"},a),g=I("div",{"class":"esriSimpleSliderDecrementButton",tabIndex:"0",role:"button"},a);this._addZoomButtonTooltips(d,g);this._incButton=d;this._decButton=
g;this._simpleSliderZoomHandler(null,null,null,this.getLevel());var m=C.widgets.zoomSlider;this._addZoomButtonIcon(d,"+",m.zoomIn);this._addZoomButtonIcon(g,"\x26minus;",m.zoomOut);8>w("ie")&&b.add(g,"dj_ie67Fix");this._connects.push(D(d,r,this,this._simpleSliderChangeHandler));this._connects.push(D(g,r,this,this._simpleSliderChangeHandler));(-1<this.getMaxZoom()||-1<this.getMinZoom())&&this._connects.push(D(this,"onZoomEnd",this,this._simpleSliderZoomHandler));10>w("ie")&&c.setSelectable(a,!1);this.root.appendChild(a);
this.isZoomSlider=!0}},_simpleSliderChangeHandler:function(a){h.stop(a);a=-1!==a.currentTarget.className.indexOf("IncrementButton")?!0:!1;this._extentUtil({numLevels:a?1:-1})},_simpleSliderZoomHandler:function(a,c,d,g){var m;a=this._incButton;c=this._decButton;-1<g&&g===this.getMaxZoom()?m=a:-1<g&&g===this.getMinZoom()&&(m=c);m?(b.add(m,"esriSimpleSliderDisabledButton"),b.remove(m===a?c:a,"esriSimpleSliderDisabledButton")):(b.remove(a,"esriSimpleSliderDisabledButton"),b.remove(c,"esriSimpleSliderDisabledButton"))},
_getSliderClass:function(a){a=a?"Large":"Simple";var b=this._mapParams.sliderOrientation,c=this._mapParams.sliderPosition||"",b=b&&"horizontal"===b.toLowerCase()?"esri"+a+"SliderHorizontal":"esri"+a+"SliderVertical";if(c)switch(c.toLowerCase()){case "top-left":c="esri"+a+"SliderTL";break;case "top-right":c="esri"+a+"SliderTR";break;case "bottom-left":c="esri"+a+"SliderBL";break;case "bottom-right":c="esri"+a+"SliderBR"}return"esri"+a+"Slider "+b+" "+c},_addZoomButtonIcon:function(a,b,c){g.create("span",
{"aria-hidden":"true",role:"presentation",innerHTML:b},a);g.create("span",{"class":"esriIconFallbackText",innerHTML:c},a)},_addZoomButtonTooltips:function(b,c){var d=C.widgets.zoomSlider;a.set(b,"title",d.zoomIn);a.set(c,"title",d.zoomOut)},_createSlider:function(a,b,c){if(this._mapParams.slider){var d=I("div",{id:this.id+"_zoom_slider"},this.root),g=y.defaults.map,m=this._getSliderClass(!0),r=-1!==m.indexOf("Horizontal"),t=this.getNumLevels();if(0<t){var f,v,u=this._mapParams.sliderLabels,h=!!u,
n=!1!==u;if(n){var e=r?"bottomDecoration":"rightDecoration";if(!u)for(u=[],g=0;g<t;g++)u[g]="";l.forEach([{"class":"esriLargeSliderTicks",container:e,count:t,dijitClass:b},{"class":h&&"esriLargeSliderLabels",container:e,count:t,labels:u,dijitClass:c}],function(a){var c=I("div"),g=a.dijitClass;delete a.dijitClass;d.appendChild(c);g===b?f=new g(a,c):v=new g(a,c)})}a=this._slider=new a({id:d.id,"class":m,minimum:this.getMinZoom(),maximum:this.getMaxZoom(),discreteValues:t,value:this.getLevel(),clickSelect:!0,
intermediateChanges:!0,style:"z-index:30;"},d);a.startup();n&&(f.startup(),v.startup());this._slider_connect=D(a,"onChange",this,"_onSliderChangeHandler");this._connects.push(D(this,"onExtentChange",this,"_onExtentChangeSliderHandler"));this._connects.push(D(a._movable,"onFirstMove",this,"_onSliderMoveStartHandler"))}else{a=this._slider=new a({id:d.id,"class":m,minimum:0,maximum:2,discreteValues:3,value:1,clickSelect:!0,intermediateChanges:g.sliderChangeImmediate,style:"height:50px; z-index:30;"},
d);c=a.domNode.firstChild.childNodes;for(g=1;3>=g;g++)M(c[g],"visibility","hidden");a.startup();this._slider_connect=D(a,"onChange",this,"_onDynSliderChangeHandler");this._connects.push(D(this,"onExtentChange",this,"_onExtentChangeDynSliderHandler"))}g=a.incrementButton;c=a.decrementButton;r?this._addZoomButtonTooltips(g,c):this._addZoomButtonTooltips(c,g);g.style.outline="none";c.style.outline="none";a.sliderHandle.style.outline="none";a._onKeyPress=function(){};if(r=a._movable){var z=r.onMouseDown;
r.onMouseDown=function(a){9>w("ie")&&1!==a.button||z.apply(this,arguments)}}this.isZoomSlider=!0}},_onSliderMoveStartHandler:function(){F(this._slider_connect);F(this._slidermovestop_connect);this._slider_connect=D(this._slider,"onChange",this,"_onSliderChangeDragHandler");this._slidermovestop_connect=D(this._slider._movable,"onMoveStop",this,"_onSliderMoveEndHandler")},_onSliderChangeDragHandler:function(a){this._extentUtil({targetLevel:a})},_onSliderMoveEndHandler:function(){F(this._slider_connect);
F(this._slidermovestop_connect)},_onSliderChangeHandler:function(a){this.setLevel(a)},_updateSliderValue:function(a,b){F(this._slider_connect);var c=this._slider,d=c._onChangeActive;c._onChangeActive=!1;c.set("value",a);c._onChangeActive=d;this._slider_connect=D(c,"onChange",this,b)},_onExtentChangeSliderHandler:function(a,b,c,d){F(this._slidermovestop_connect);this._updateSliderValue(d.level,"_onSliderChangeHandler")},_onDynSliderChangeHandler:function(a){this._extentUtil({numLevels:0<a?1:-1})},
_onExtentChangeDynSliderHandler:function(){this._updateSliderValue(1,"_onDynSliderChangeHandler")},_openLogoLink:function(a){window.open(y.defaults.map.logoLink,"_blank");h.stop(a)},enableMapNavigation:function(){this.isMapNavigation||(this.isMapNavigation=!0,this._evalMapNavigation())},disableMapNavigation:function(){this.isMapNavigation&&(this.isMapNavigation=!1,this._evalMapNavigation())},_evalMapNavigation:function(){this.isMapNavigation?this.navigationManager.enableNavigation():this.navigationManager.disableNavigation()},
_evalNavigationFeature:function(a){if(this.isMapNavigation&&this["is"+a])this.navigationManager["enable"+a]();else this.navigationManager["disable"+a]()},enableDoubleClickZoom:function(){this.isDoubleClickZoom||(this.isDoubleClickZoom=!0,this._evalNavigationFeature("DoubleClickZoom"))},disableDoubleClickZoom:function(){this.isDoubleClickZoom&&(this.isDoubleClickZoom=!1,this._evalNavigationFeature("DoubleClickZoom"))},enableShiftDoubleClickZoom:function(){this.isShiftDoubleClickZoom||(P(this.declaredClass+
": Map.(enable/disable)ShiftDoubleClickZoom deprecated. Shift-Double-Click zoom behavior will not be supported.",null,"v2.0"),this.navigationManager.enableShiftDoubleClickZoom(),this.isShiftDoubleClickZoom=!0)},disableShiftDoubleClickZoom:function(){this.isShiftDoubleClickZoom&&(P(this.declaredClass+": Map.(enable/disable)ShiftDoubleClickZoom deprecated. Shift-Double-Click zoom behavior will not be supported.",null,"v2.0"),this.navigationManager.disableShiftDoubleClickZoom(),this.isShiftDoubleClickZoom=
!1)},enableClickRecenter:function(){this.isClickRecenter||(this.isClickRecenter=!0,this._evalNavigationFeature("ClickRecenter"))},disableClickRecenter:function(){this.isClickRecenter&&(this.isClickRecenter=!1,this._evalNavigationFeature("ClickRecenter"))},enablePan:function(){this.isPan||(this.isPan=!0,this._evalNavigationFeature("Pan"))},disablePan:function(){this.isPan&&(this.isPan=!1,this._evalNavigationFeature("Pan"))},enableRubberBandZoom:function(){this.isRubberBandZoom||(this.isRubberBandZoom=
!0,this._evalNavigationFeature("RubberBandZoom"))},disableRubberBandZoom:function(){this.isRubberBandZoom&&(this.isRubberBandZoom=!1,this._evalNavigationFeature("RubberBandZoom"))},enablePinchZoom:function(){this.isPinchZoom||(this.isPinchZoom=!0,this._evalNavigationFeature("PinchZoom"))},disablePinchZoom:function(){this.isPinchZoom&&(this.isPinchZoom=!1,this._evalNavigationFeature("PinchZoom"))},enableKeyboardNavigation:function(){this.isKeyboardNavigation||(this.isKeyboardNavigation=!0,this._evalNavigationFeature("KeyboardNavigation"))},
disableKeyboardNavigation:function(){this.isKeyboardNavigation&&(this.isKeyboardNavigation=!1,this._evalNavigationFeature("KeyboardNavigation"))},enableScrollWheel:function(){this.isScrollWheel||(this.isScrollWheel=!0,this._evalNavigationFeature("ScrollWheel"))},disableScrollWheel:function(){this.isScrollWheel&&(this.isScrollWheel=!1,this._evalNavigationFeature("ScrollWheel"))},enableScrollWheelZoom:function(){this.isScrollWheelZoom||(this.navigationManager.enableScrollWheelZoom(),this.isScrollWheelZoom=
!0)},disableScrollWheelZoom:function(){this.isScrollWheelZoom&&(this.navigationManager.disableScrollWheelZoom(),this.isScrollWheelZoom=!1)},enableScrollWheelPan:function(){this.isScrollWheelPan||this.navigationManager.enableScrollWheelPan()},disableScrollWheelPan:function(){this.isScrollWheelPan&&this.navigationManager.disableScrollWheelPan()},showPanArrows:function(){this._navDiv&&(this._navDiv.style.display="block",this.isPanArrows=!0)},hidePanArrows:function(){this._navDiv&&(this._navDiv.style.display=
"none",this.isPanArrows=!1)},showZoomSlider:function(){this._slider&&(M(this._slider.domNode||this._slider,"visibility","inherit"),this.isZoomSlider=!0)},hideZoomSlider:function(){this._slider&&(M(this._slider.domNode||this._slider,"visibility","hidden"),this.isZoomSlider=!1)}})})},"dijit/a11yclick":function(){define(["dojo/keys","dojo/mouse","dojo/on","dojo/touch"],function(k,e,p,q){function n(f){if((f.keyCode===k.ENTER||f.keyCode===k.SPACE)&&!/input|button|textarea/i.test(f.target.nodeName))for(f=
f.target;f;f=f.parentNode)if(f.dojoClick)return!0}var l;p(document,"keydown",function(f){n(f)?(l=f.target,f.preventDefault()):l=null});p(document,"keyup",function(f){n(f)&&f.target==l&&(l=null,p.emit(f.target,"click",{cancelable:!0,bubbles:!0,ctrlKey:f.ctrlKey,shiftKey:f.shiftKey,metaKey:f.metaKey,altKey:f.altKey,_origType:f.type}))});var h=function(f,d){f.dojoClick=!0;return p(f,"click",d)};h.click=h;h.press=function(f,d){var c=p(f,q.press,function(a){("mousedown"!=a.type||e.isLeft(a))&&d(a)}),a=
p(f,"keydown",function(a){a.keyCode!==k.ENTER&&a.keyCode!==k.SPACE||d(a)});return{remove:function(){c.remove();a.remove()}}};h.release=function(f,d){var c=p(f,q.release,function(a){("mouseup"!=a.type||e.isLeft(a))&&d(a)}),a=p(f,"keyup",function(a){a.keyCode!==k.ENTER&&a.keyCode!==k.SPACE||d(a)});return{remove:function(){c.remove();a.remove()}}};h.move=q.move;return h})},"dojo/touch":function(){define("./_base/kernel ./aspect ./dom ./dom-class ./_base/lang ./on ./has ./mouse ./domReady ./_base/window".split(" "),
function(k,e,p,q,n,l,h,f,d,c){function a(a,b,c){return m&&c?function(a,b){return l(a,c,b)}:t?function(c,d){var g=l(c,b,function(a){d.call(this,a);D=(new Date).getTime()}),m=l(c,a,function(a){(!D||(new Date).getTime()>D+1E3)&&d.call(this,a)});return{remove:function(){g.remove();m.remove()}}}:function(b,c){return l(b,a,c)}}function b(a){do if(void 0!==a.dojoClick)return a;while(a=a.parentNode)}function g(a,d,g){if(!f.isRight(a)){var m=b(a.target);if(y=!a.target.disabled&&m&&m.dojoClick)if(z=(w="useTarget"==
y)?m:a.target,w&&a.preventDefault(),x=a.changedTouches?a.changedTouches[0].pageX-c.global.pageXOffset:a.clientX,A=a.changedTouches?a.changedTouches[0].pageY-c.global.pageYOffset:a.clientY,C=("object"==typeof y?y.x:"number"==typeof y?y:0)||4,B=("object"==typeof y?y.y:"number"==typeof y?y:0)||4,!v){a=function(a){c.doc.addEventListener(a,function(b){var c=b.target;y&&!b._dojo_click&&(new Date).getTime()<=E+1E3&&("INPUT"!=c.tagName||!q.contains(c,"dijitOffScreen"))&&(b.stopPropagation(),b.stopImmediatePropagation&&
b.stopImmediatePropagation(),"click"==a&&("INPUT"!=c.tagName||"radio"==c.type&&(q.contains(c,"dijitCheckBoxInput")||q.contains(c,"mblRadioButton"))||"checkbox"==c.type&&(q.contains(c,"dijitCheckBoxInput")||q.contains(c,"mblCheckBox")))&&"TEXTAREA"!=c.tagName&&"AUDIO"!=c.tagName&&"VIDEO"!=c.tagName&&b.preventDefault())},!0)};var r=function(a){y=w?p.isDescendant(c.doc.elementFromPoint(a.changedTouches?a.changedTouches[0].pageX-c.global.pageXOffset:a.clientX,a.changedTouches?a.changedTouches[0].pageY-
c.global.pageYOffset:a.clientY),z):y&&(a.changedTouches?a.changedTouches[0].target:a.target)==z&&Math.abs((a.changedTouches?a.changedTouches[0].pageX-c.global.pageXOffset:a.clientX)-x)<=C&&Math.abs((a.changedTouches?a.changedTouches[0].pageY-c.global.pageYOffset:a.clientY)-A)<=B};v=!0;c.doc.addEventListener(d,function(a){f.isRight(a)||(r(a),w&&a.preventDefault())},!0);c.doc.addEventListener(g,function(a){if(!f.isRight(a)&&(r(a),y)){var b=function(b){var c=document.createEvent("MouseEvents");c._dojo_click=
!0;c.initMouseEvent(b,!0,!0,a.view,a.detail,d.screenX,d.screenY,d.clientX,d.clientY,a.ctrlKey,a.altKey,a.shiftKey,a.metaKey,0,null);return c};E=(new Date).getTime();var c=w?z:a.target;"LABEL"===c.tagName&&(c=p.byId(c.getAttribute("for"))||c);var d=a.changedTouches?a.changedTouches[0]:a,g=b("mousedown"),m=b("mouseup"),t=b("click");setTimeout(function(){l.emit(c,"mousedown",g);l.emit(c,"mouseup",m);l.emit(c,"click",t);E=(new Date).getTime()},0)}},!0);a("click");a("mousedown");a("mouseup")}}}var u=5>
h("ios"),m=h("pointer-events")||h("MSPointer"),r=function(){var a={},b;for(b in{down:1,move:1,up:1,cancel:1,over:1,out:1})a[b]=h("MSPointer")?"MSPointer"+b.charAt(0).toUpperCase()+b.slice(1):"pointer"+b;return a}(),t=h("touch-events"),v,y,w=!1,z,x,A,C,B,E,D,F;h("touch")&&(m?d(function(){c.doc.addEventListener(r.down,function(a){g(a,r.move,r.up)},!0)}):d(function(){function a(a){var b=n.delegate(a,{bubbles:!0});6<=h("ios")&&(b.touches=a.touches,b.altKey=a.altKey,b.changedTouches=a.changedTouches,b.ctrlKey=
a.ctrlKey,b.metaKey=a.metaKey,b.shiftKey=a.shiftKey,b.targetTouches=a.targetTouches);return b}F=c.body();c.doc.addEventListener("touchstart",function(a){D=(new Date).getTime();var b=F;F=a.target;l.emit(b,"dojotouchout",{relatedTarget:F,bubbles:!0});l.emit(F,"dojotouchover",{relatedTarget:b,bubbles:!0});g(a,"touchmove","touchend")},!0);l(c.doc,"touchmove",function(b){D=(new Date).getTime();var d=c.doc.elementFromPoint(b.pageX-(u?0:c.global.pageXOffset),b.pageY-(u?0:c.global.pageYOffset));d&&(F!==d&&
(l.emit(F,"dojotouchout",{relatedTarget:d,bubbles:!0}),l.emit(d,"dojotouchover",{relatedTarget:F,bubbles:!0}),F=d),l.emit(d,"dojotouchmove",a(b))||b.preventDefault())});l(c.doc,"touchend",function(b){D=(new Date).getTime();var d=c.doc.elementFromPoint(b.pageX-(u?0:c.global.pageXOffset),b.pageY-(u?0:c.global.pageYOffset))||c.body();l.emit(d,"dojotouchend",a(b))})}));e={press:a("mousedown","touchstart",r.down),move:a("mousemove","dojotouchmove",r.move),release:a("mouseup","dojotouchend",r.up),cancel:a(f.leave,
"touchcancel",m?r.cancel:null),over:a("mouseover","dojotouchover",r.over),out:a("mouseout","dojotouchout",r.out),enter:f._eventHandler(a("mouseover","dojotouchover",r.over)),leave:f._eventHandler(a("mouseout","dojotouchout",r.out))};return k.touch=e})},"dijit/registry":function(){define(["dojo/_base/array","dojo/_base/window","./main"],function(k,e,p){var q={},n={},l={length:0,add:function(h){if(n[h.id])throw Error("Tried to register widget with id\x3d\x3d"+h.id+" but that id is already registered");
n[h.id]=h;this.length++},remove:function(h){n[h]&&(delete n[h],this.length--)},byId:function(h){return"string"==typeof h?n[h]:h},byNode:function(h){return n[h.getAttribute("widgetId")]},toArray:function(){var h=[],f;for(f in n)h.push(n[f]);return h},getUniqueId:function(h){var f;do f=h+"_"+(h in q?++q[h]:q[h]=0);while(n[f]);return"dijit"==p._scopeName?f:p._scopeName+"_"+f},findWidgets:function(h,f){function d(a){for(a=a.firstChild;a;a=a.nextSibling)if(1==a.nodeType){var b=a.getAttribute("widgetId");
b?(b=n[b])&&c.push(b):a!==f&&d(a)}}var c=[];d(h);return c},_destroyAll:function(){p._curFocus=null;p._prevFocus=null;p._activeStack=[];k.forEach(l.findWidgets(e.body()),function(h){h._destroyed||(h.destroyRecursive?h.destroyRecursive():h.destroy&&h.destroy())})},getEnclosingWidget:function(h){for(;h;){var f=1==h.nodeType&&h.getAttribute("widgetId");if(f)return n[f];h=h.parentNode}return null},_hash:n};return p.registry=l})},"dijit/main":function(){define(["dojo/_base/kernel"],function(k){return k.dijit})},
"esri/_coremap":function(){define("require module dojo/_base/kernel dojo/_base/declare dojo/_base/connect dojo/_base/Deferred dojo/_base/lang dojo/_base/array dojo/_base/event dojo/_base/unload dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/dom-geometry dojo/dom-style dojo/sniff dijit/registry dojox/gfx/matrix ./kernel ./config ./basemaps ./lang ./Evented ./fx ./deferredUtils ./tileUtils ./urlUtils ./PluginTarget ./Color ./arcade/Dictionary ./geometry/Point ./geometry/ScreenPoint ./geometry/Extent ./geometry/Rect ./geometry/mathUtils ./geometry/scaleUtils ./geometry/screenUtils ./geometry/webMercatorUtils ./layers/GraphicsLayer ./layers/TileInfo ./layers/LOD ./layers/ArcGISTiledMapServiceLayer ./layers/MapImageLayer ./layers/OpenStreetMapLayer ./layers/VectorTileLayer ./dijit/Popup ./plugins/popupManager dojo/uacss".split(" "),
function(k,e,p,q,n,l,h,f,d,c,a,b,g,u,m,r,t,v,y,w,z,x,A,C,B,E,D,F,I,M,L,J,P,K,U,O,S,Y,N,W,ca,ha,fa,Z,G,ia,sa){function wa(a,b){var c=a.lods;c.sort(function(a,b){return a.scale>b.scale?-1:a.scale<b.scale?1:0});var d=[],c=f.filter(c,function(a){if(-1===za(d,a.scale))return d.push(a.scale),!0}),g=b.lods=[],m;f.forEach(c,function(a,b){m=g[b]=new ha(a);m.level=b});b.tileInfo=new ca(Ba(a,{lods:g}))}var ua,ma=Y.toMapPoint,ja=Y.toScreenPoint,va=n.connect,la=n.disconnect,na=h.hitch,aa=r.set,za=f.indexOf,Ba=
h.mixin,ta=0,oa=z.defaults.map,Da=oa.layerNamePrefix,Oa=oa.graphicsLayerNamePrefix,Ma=new RegExp("^"+Da+"(\\d+)$"),Fa=new RegExp("^"+Oa+"(\\d+)$"),Ca=function(){},Ja=0;return q([C,I],{declaredClass:"esri._CoreMap",resizeDelay:300,invalidExtent:"Map does not have a valid extent.",invalidGeometry:"Geometry (wkid: ${geometry}) cannot be converted to spatial reference of the map (wkid: ${map})",unknownBasemap:'Unable to find basemap definition for: "${basemapName}". Try one of these: ${list}',invalidBasemap:'Unable to add basemap: "${basemapName}".',
unknownLayerType:'Unknown basemap layer type: "${type}" found in basemap definition for: "${basemapName}".',visible:!0,_eventMap:{"basemap-change":!0,"extent-change":["extent","delta","levelChange","lod"],"layer-add":["layer"],"layer-add-result":["layer","error"],"layer-remove":["layer"],"layer-reorder":["layer","index"],"layer-resume":["layer"],"layer-suspend":["layer"],"layers-add-result":["layers"],"layers-removed":!0,"layers-reordered":["layerIds"],load:["map"],pan:["extent","delta"],"pan-end":["extent",
"delta"],"pan-start":["extent","screenPoint"],reposition:["x","y"],resize:["extent","width","height"],scale:["matrix","immediate"],"time-extent-change":["timeExtent"],"before-unload":["map"],unload:["map"],"update-end":["error"],"update-start":!0,zoom:["extent","zoomFactor","anchor"],"zoom-end":["extent","zoomFactor","anchor","level"],"zoom-start":["extent","zoomFactor","anchor","level"],click:!0,"dbl-click":!0,"key-down":!0,"key-up":!0,"mouse-down":!0,"mouse-drag":!0,"mouse-drag-end":!0,"mouse-drag-start":!0,
"mouse-move":!0,"mouse-out":!0,"mouse-over":!0,"mouse-up":!0,"mouse-wheel":!0,"basic-tap":!0,"double-tap":!0,"pinch-end":!0,"pinch-move":!0,"pinch-start":!0,"processed-double-tap":!0,"processed-tap":!0,"swipe-end":!0,"swipe-move":!0,"swipe-start":!0,tap:!0,"two-finger-tap":!0},constructor:function(d,r){r=r||{};this.registerConnectEvents();Ba(this,{_internalLayerIds:[],_layers:[],_layerDivs:[],_layerSize:0,_connects:[],_zoomAnimDiv:null,_zoomAnim:null,_layersDiv:null,_firstLayerId:null,_delta:null,
_cursor:null,_ratioW:1,_ratioH:1,_params:null,_minResolution:0,_maxResolution:0,cursor:null,layerIds:[],graphicsLayerIds:[],graphics:null,_labels:null,loaded:!1,__panning:!1,__zooming:!1,__container:null,root:null,__LOD:null,__tileInfo:null,__visibleRect:null,__visibleDelta:null,_rids:[]});var t=this.container=a.byId(d),f=this.id=b.get(t,"id")||v.getUniqueId(this.declaredClass);g.add(t,"map");var w=m.getContentBox(t);d=g.add;var h=u.create;this.position=new P(0,0);this._reposition();var l=this.width=
0<w.w?w.w:oa.width,n=this.height=0<w.h?w.h:oa.height,e=this.root=h("div",{id:f+"_root",style:{width:l+"px",height:n+"px",direction:"ltr"}});d(e,"esriMapContainer");w=this.__container=h("div",{id:f+"_container"},e);aa(w,"position","absolute");d(w,"esriMapContainer");t.appendChild(e);r=this._params=Ba({slider:!0,nav:!1,zoom:-1,minZoom:-1,maxZoom:-1,scale:-1,minScale:0,maxScale:0,showInfoWindowOnClick:!0,displayGraphicsOnPan:!0,wrapAround180:!0,fitExtent:!1,optimizePanAnimation:!0},r);this.wrapAround180=
r.wrapAround180;this.optimizePanAnimation=r.optimizePanAnimation;this.setBackgroundColor(r.backgroundColor);A.isDefined(r.resizeDelay)&&(this.resizeDelay=r.resizeDelay);r.lods&&(wa({rows:512,cols:512,dpi:96,format:"JPEG",compressionQuality:75,origin:{x:-180,y:90},spatialReference:{wkid:4326},lods:r.lods},r),this.__tileInfo=r.tileInfo);this.extent=r.extent;this._extentUtil({mapCenter:r.center,targetLevel:r.zoom,targetScale:r.scale});this.__visibleRect=new U(0,0,l,n);this.__visibleDelta=new U(0,0,l,
n);f=this._layersDiv=h("div",{id:f+"_layers"});d(f,"esriMapLayers");w.appendChild(f);this._zoomAnimDiv=h("div",{style:{position:"absolute"}});r.infoWindow?this.infoWindow=r.infoWindow:(d=this.infoWindow=new sa(r.popupOptions,h("div")),d.startup(),d._ootb=!0,aa(d.domNode,"zIndex",40));if(r.showLabels){var y=this;k(["./layers/LabelLayer"],function(a){ua=a;y._createLabelLayer()});this.on("load",function(){y._createLabelLayer()})}this.addPlugin(this._getAbsMid("./plugins/popupManager"),{enabled:r.showInfoWindowOnClick});
this._zoomStartHandler=na(this,this._zoomStartHandler);this._zoomingHandler=na(this,this._zoomingHandler);this._zoomEndHandler=na(this,this._zoomEndHandler);this._panningHandler=na(this,this._panningHandler);this._panEndHandler=na(this,this._panEndHandler);this._endTranslate=na(this,this._endTranslate);this._timedResize=na(this,this._timedResize);this._execResize=na(this,this._execResize);this._processLabelLayers=na(this,this._processLabelLayers);this._updateLabelLayers=na(this,this._updateLabelLayers);
this.resize=na(this,this.resize);c.addOnWindowUnload(this,this.destroy)},_getAbsMid:function(a){return k.toAbsMid?k.toAbsMid(a):e.id.replace(/\/[^\/]*$/ig,"/")+a},_cleanUp:function(){var a=this.infoWindow;a&&(a._ootb&&a.destroy?a.destroy():a.unsetMap(this),delete this.infoWindow);la(this._tsTimeExtentChange_connect);this.removePlugin("./plugins/popupManager");u.destroy(this.root);this.root=null},_addLayer:function(a,b,c){if(a.id){var d=a.id.match(a instanceof W?Fa:Ma);d&&d[1]&&(d=Number(d[1]),ta<=
d&&(ta=d+1))}var g=a.id||(a instanceof W?Oa:Da)+ta++;a.id=g;this._layers[g]=a;var m,r;if(b===this.layerIds||b===this.graphicsLayerIds)m=this._layerSize,this._layerSize++;a._isRefLayer="top"===c;c=!A.isDefined(c)||0>c||c>b.length||"top"===c?b.length:c;0===m&&(this._firstLayerId=g);if(!a._isRefLayer)for(;(r=this.getLayer(b[c-1]))&&r._isRefLayer;)c--;b.splice(c,0,g);var t=na(this,this._addLayerHandler),f=this;c=this._connects;d=function(){a.loaded?f._onLoadFix?(f._onLoadFix=!1,setTimeout(function(){t(a)},
0)):t(a):(f["_"+g+"_addtoken_load"]=va(a,"onLoad",f,"_addLayerHandler"),f["_"+g+"_addtoken_err"]=va(a,"onError",f,function(c){t(a,c,b)}))};this.loaded||0===m||a.loaded&&-1===za(this.graphicsLayerIds,g)?d():c.push(va(this,"onLoad",d));return a},_addLayerHandler:function(a,b,c){var d=this.id,g=a.id,m=za(a instanceof W?this.graphicsLayerIds:this.layerIds,g),r=m,t=!1,f=this._params;la(this["_"+g+"_addtoken_load"]);la(this["_"+g+"_addtoken_err"]);if(b)delete this._layers[g],-1!==m&&(c.splice(m,1),this.onLayerAddResult(a,
b));else{-1===m&&(m=za(this._internalLayerIds,g),r=20+m,t=!0);if(g===this._firstLayerId){b=a.spatialReference;c=this.extent&&this.extent.spatialReference;!c||c.equals(b)||!a.tileInfo&&a.url||(c=null);c=this.spatialReference=c||b;this.wrapAround180=this.wrapAround180&&c&&c._isWrappable()?!0:!1;a.tileInfo&&(this.__tileInfo?(b=this.__tileInfo.lods,this.__tileInfo=Ba({},a.tileInfo),this.__tileInfo.lods=b):(wa(Ba({},a.tileInfo),f),this.__tileInfo=f.tileInfo));if(this.wrapAround180){b=this.__tileInfo;c=
c._getInfo();if(!b||Math.abs(c.origin[0]-b.origin.x)>c.dx)this.wrapAround180=!1;this.wrapAround180&&b&&D._addFrameInfo(b,c)}f.units=a.units;if((b=this.__tileInfo&&this.__tileInfo.lods)&&b.length){c=f.minScale;var m=f.maxScale,v=-1,u=-1,w=!1,h=!1,l;for(l=0;l<b.length;l++)0<c&&!w&&c>=b[l].scale&&(v=b[l].level,w=!0),0<m&&!h&&m>=b[l].scale&&(u=0<l?b[l-1].level:-1,h=!0);-1===f.minZoom&&(f.minZoom=0===c?b[0].level:v);-1===f.maxZoom&&(f.maxZoom=0===m?b[b.length-1].level:u);for(l=0;l<b.length;l++)f.minZoom===
b[l].level&&(f.minScale=b[l].scale,this._minResolution=b[l].resolution),f.maxZoom===b[l].level&&(f.maxScale=b[l].scale,this._maxResolution=b[l].resolution)}else f.minZoom=f.maxZoom=f.zoom=-1}a instanceof W?(this._gc||(this._gc=new W._GraphicsContainer,this._gc._setMap(this,this._layersDiv).id=d+"_gc"),r=a._setMap(this,this._gc._surface),r.id=d+"_"+g,this._layerDivs[g]=r,this._reorderLayers(this.graphicsLayerIds)):(r=a._setMap(this,this._layersDiv,r,this.__LOD),r.id=d+"_"+g,this._layerDivs[g]=r,this._reorderLayers(this.layerIds),
t||-1===a.declaredClass.indexOf("VETiledLayer")||this._onBingLayerAdd(a));g===this._firstLayerId&&(this.graphics=new W({id:d+"_graphics",displayOnPan:f.displayGraphicsOnPan}),this._addLayer(this.graphics,this._internalLayerIds,20));if(a===this.graphics){c=this._layers[this._firstLayerId];d=f.zoom;r=f.scale;b=f.center;c=c.initialExtent||c.fullExtent;this._firstLayerId=null;this.extent&&(this.extent=this._convertGeometry(this,this.extent));!this.extent&&c&&(b&&(b=this._convertGeometry(c,b)),b&&(c=c.centerAt(b),
b=null));if(b=this.extent||c&&new K(c.toJson()))-1<d?b=this.__getExtentForLevel(d,null,b).extent:0<r&&(b=S.getExtentForScale(this,r,b));if(!b){console.log("Map: "+this.invalidExtent);return}f=this._fixExtent(b,f.fitExtent);this.extent=f.extent;this.__LOD=f.lod;this.__setExtent(this.extent);this.loaded=!0;this.attr("data-loaded","");this.infoWindow.setMap(this);this.onLoad(this)}t||(this.onLayerAdd(a),this.onLayerAddResult(a));la(this[g+"_addLayerHandler_connect"])}},_convertGeometry:function(a,b){a=
a&&a.spatialReference;var c=b&&b.spatialReference;a&&c&&!a.equals(c)&&(a._canProject(c)?a.isWebMercator()?b=N.geographicToWebMercator(b):4326===a.wkid&&(b=N.webMercatorToGeographic(b,!0)):(console.log("Map: "+A.substitute({geometry:c.wkid||c.wkt,map:a.wkid||a.wkt},this.invalidGeometry)),b=null));return b},_reorderLayers:function(a){var b=this.onLayerReorder,c=u.place,d=this._layerDivs,g=this._layers,m=this._gc?this._gc._surface.getEventSource():null;if(a===this.graphicsLayerIds)f.forEach(a,function(a,
r){var t=d[a];t&&(c(t.getEventSource(),m,r),b(g[a],r))});else{var r=this.graphics,v=r?r.id:null,w=this._layersDiv,h;f.forEach(a,function(a,m){h=d[a];a!==v&&h&&(c(h,w,m),b(g[a],m))});this._mapImageLyr&&this._placeMapImageLyr();m&&(m=9>t("ie")?m.parentNode:m,c(m,m.parentNode,a.length))}this.onLayersReordered([].concat(a))},_zoomStartHandler:function(){this.__zoomStart(this._zoomAnimDiv.startingExtent,this._zoomAnimDiv.anchor)},_zoomingHandler:function(a){var b=parseFloat(a.left),c=parseFloat(a.top);
a=new K(b,c-parseFloat(a.height),b+parseFloat(a.width),c,this.spatialReference);b=this.extent.getWidth()/a.getWidth();this.__zoom(a,b,this._zoomAnimDiv.anchor)},_zoomEndHandler:function(){var a=this._zoomAnimDiv,b=a.extent,c=this.extent.getWidth()/b.getWidth(),d=a.anchor,g=a.newLod,m=a.levelChange;a.extent=a.anchor=a.levelChange=a.startingExtent=a.newLod=this._delta=this._zoomAnim=null;this.__zoomEnd(b,c,d,g,m)},_panningHandler:function(a){if(isNaN(parseFloat(a.left))||isNaN(parseFloat(a.top))){var b=
Math.round,c=this._panAnim.node;a.left=-1*(this._delta.x-b(this.width/2))+"px";a.top=-1*(this._delta.y-b(this.height/2))+"px";r.set(c,"left",a.left);r.set(c,"top",a.top)}a=new P(parseFloat(a.left),parseFloat(a.top));b=this.toMap(a);this.onPan(this.extent.offset(this.extent.xmin-b.x,this.extent.ymax-b.y),a)},_panEndHandler:function(a){this.__panning=!1;var b=Math.round;a=new P(-b(parseFloat(a.style.left)),-b(parseFloat(a.style.top)));var b=a.x,c=a.y,d=this.__visibleRect,g=this.__visibleDelta;d.x+=
-b;d.y+=-c;g.x+=-b;g.y+=-c;aa(this._zoomAnimDiv,{left:"0px",top:"0px"});var d=this.extent,g=this._ratioW,m=this._ratioH,d=new K(d.xmin+b/g,d.ymin-c/m,d.xmax+b/g,d.ymax-c/m,this.spatialReference);a.setX(-a.x);a.setY(-a.y);this._delta=this._panAnim=null;this._updateExtent(d);this.onPanEnd(d,a);this._fireExtChg([d,a,!1,this.__LOD])},_fixExtent:function(a,b){for(var c=this._reshapeExtent(a),d=1.25;!0===b&&(c.extent.getWidth()<a.getWidth()||c.extent.getHeight()<a.getHeight())&&0<c.lod.level&&3>=d;)c=this._reshapeExtent(a.expand(d)),
d+=.25;return c},_getFrameWidth:function(){var a=-1,b=this.spatialReference._getInfo();this.__LOD?(b=this.__LOD._frameInfo)&&(a=b[3]):b&&(a=Math.round(2*b.valid[1]/(this.extent.getWidth()/this.width)));return a},_fixAspectRatio:function(a){var b=a.getWidth(),c=a.getHeight(),d=b/c,g=this.width/this.height,m=0,r=0;this.width>this.height?b>c?g>d?m=c*g-b:r=b/g-c:m=c*g-b:this.width<this.height?b<c?g>d?m=c*g-b:r=b/g-c:r=b/g-c:b<c?m=c-b:b>c&&(r=b/g-c);m&&(a.xmin-=m/2,a.xmax+=m/2);r&&(a.ymin-=r/2,a.ymax+=
r/2);return a},_reshapeExtent:function(a){a=this._fixAspectRatio(a);return this._getAdjustedExtent(a)},_getAdjustedExtent:function(a){if(this.__tileInfo)return D.getCandidateTileInfo(this,this.__tileInfo,a);var b=S.getScale(this,a),c=this.getMinScale(),d=this.getMaxScale();!c||b<=c?!d||b>=d||(a=S.getExtentForScale(this,d,a)):a=S.getExtentForScale(this,c,a);return{extent:a}},_onBingLayerAdd:function(a){this["__"+a.id+"_vis_connect"]=n.connect(a,"onVisibilityChange",this,"_toggleBingLogo");this._toggleBingLogo(a.visible)},
_onBingLayerRemove:function(a){n.disconnect(this["__"+a.id+"_vis_connect"]);delete this["__"+a.id+"_vis_connect"];var b=f.some(this.layerIds,function(b){return(a=this._layers[b])&&a.visible&&-1!==a.declaredClass.indexOf("VETiledLayer")},this);this._toggleBingLogo(b)},_toggleBingLogo:function(a){a&&!this._bingLogo?(a={left:this._mapParams&&this._mapParams.nav?"25px":""},6===t("ie")&&(a.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(enabled\x3d'true', sizingMethod\x3d'crop', src\x3d'"+k.toUrl("./images/map/bing-logo-lg.png")+
"')"),a=this._bingLogo=u.create("div",{style:a},this.root),g.add(a,"bingLogo-lg")):!a&&this._bingLogo&&(u.destroy(this._bingLogo),delete this._bingLogo)},__panStart:function(a,b){var c=this._zoomAnim,d=this._panAnim;if(c&&c._active)c.stop(),c._fire("onEnd",[c.node]);else if(d&&d._active){d.stop();this._panAnim=null;b=d.curve.getValue(d._getStep());a=Math.round(parseFloat(b.left));b=Math.round(parseFloat(b.top));c=this.navigationManager._dragOrigin;this.__pan(a,b);c&&(c.x-=a,c.y-=b);return}this.__panning=
!0;this.onPanStart(this.extent,new P(a,b))},__pan:function(a,b){var c=this.extent,d=this._ratioW,g=this._ratioH;this.onPan(new K(c.xmin-a/d,c.ymin+b/g,c.xmax-a/d,c.ymax+b/g,this.spatialReference),new P(a,b))},__panEnd:function(a,b){var c=this.__visibleRect,d=this.__visibleDelta;c.x+=a;c.y+=b;d.x+=a;d.y+=b;var c=new P(a,b),d=this.extent,g=this._ratioW,m=this._ratioH,d=new K(d.xmin-a/g,d.ymin+b/m,d.xmax-a/g,d.ymax+b/m,this.spatialReference);this.__panning=!1;this._updateExtent(d);this.onPanEnd(d,c);
this._fireExtChg([d,c,!1,this.__LOD])},__zoomStart:function(a,b){this.__zooming=!0;this.onZoomStart(a,1,b,this.__LOD?this.__LOD.level:null)},__zoom:function(a,b,c){this.onZoom(a,b,c)},__zoomEnd:function(a,b,c,d,g){aa(this._layersDiv,{left:"0px",top:"0px"});this._delta=new P(0,0);this.__visibleRect.x=this.__visibleRect.y=0;a=new K(a);this.__LOD=d;this._ratioW=this.width/a.getWidth();this._ratioH=this.height/a.getHeight();var m=this._delta;this._delta=null;this.__zooming=!1;this._updateExtent(a,g);
this.onZoomEnd(a,b,c,d?d.level:null);this._fireExtChg([a,m,g,d])},_extentUtil:function(a,b,c,d,g){var m=new l,r,t,f,v,u,w,n,e,y,z,k=this.width,x=this.height,p,q,B;a&&(r=a.numLevels,t=a.targetLevel,p=A.isDefined(t),f=a.factor,v=a.mapAnchor,u=a.screenAnchor,w=a.mapCenter,q=a.levelOrFactor,n=a.targetScale,e=A.isDefined(n)&&0<n);b&&(y=b.dx,z=b.dy,w=b.mapCenter);h.isArray(w)&&(w=new J(w));var C=this._panAnim;b=(a=this._stopAnim())?a.divExtent:this.extent;var D=this.__tileInfo,I=this._params;if(!this.loaded){if(c)b&&
(c=this._convertGeometry(b,c)),c&&(this.extent=c,I.zoom=I.scale=-1,I.center=null);else if(w||p||e){if(w)if(b){if(w=this._convertGeometry(b,w))this.extent=b.centerAt(w),I.center=null}else I.center=w;p&&-1<t?(I.zoom=t,I.scale=-1):e&&(I.scale=n,I.zoom=-1)}m.resolve();return m}if(w&&(w=this._convertGeometry(this,w),!w)||v&&(v=this._convertGeometry(this,v),!v)||c&&(c=this._convertGeometry(this,c),!c))return m.reject(),m;C&&v&&u&&(v=ma(this.extent,k,x,u));a&&v&&u&&(v=ma(a.divExtent,k,x,u));p&&(D?(r=this.getMinZoom(),
p=this.getMaxZoom(),t<r?t=r:t>p&&(t=p),r=t-(a?a.level:this.getLevel())):(r=0<t?-1:1,B=q?t:null));if(!c)if(A.isDefined(r))D?(k=a?a.level:this.getLevel(),k=this.__getExtentForLevel(k+r,w,b).extent):(k=(a?a.end:this.extent).expand(B||(0<r?.5*r:2*-r)),B&&w&&(k=k.centerAt(w))),k&&(w?c=k:(y=v||b.getCenter(),x=k.getWidth(),z=k.getHeight(),k=y.x>=b.xmin&&y.x<=b.xmax?(y.x-b.xmin)/b.getWidth():.5,c=y.y>=b.ymin&&y.y<=b.ymax?(y.y-b.ymin)/b.getHeight():.5,k=y.x-k*x,y=y.y-c*z,c=new K(k,y,k+x,y+z,this.spatialReference)));
else if(e)c=S.getExtentForScale(this,n,b);else if(A.isDefined(f))c=b.expand(f);else if(y||z)a?(c=a.end,v=c.getCenter(),B=ja(c,k,x,v),B.x+=y,B.y+=z,B=ma(c,k,x,B),c=c.offset(B.x-v.x,B.y-v.y)):(y=new P(k/2+y,x/2+z),y=ma(b,k,x,y),x=b.getWidth(),z=b.getHeight(),k=y.x-x/2,y=y.y-z/2,c=new K(k,y,k+x,y+z,this.spatialReference));c||(w?(b=a?a.end:b,x=b.getWidth(),z=b.getHeight(),k=w.x-x/2,y=w.y-z/2,c=new K(k,y,k+x,y+z,this.spatialReference)):a&&(c=a.end));c?(this._extentDfd&&-1===this._extentDfd.fired&&(this._extentDfd.then(null,
Ca),this._extentDfd.reject()),this._extentDfd=m,this.__setExtent(c,null,u,d,a,g)):m.reject();return m},__setExtent:function(a,b,c,d,g,m){try{if(this._firstLayerId)this.extent=a;else{var r=!0,t=this.spatialReference,f=g?g.divExtent:this.extent,v=this._fixExtent(a,d||!1);a=v.extent;var u=a.getWidth(),w=a.getHeight(),h=Math.round;if(f)var l=h(1E6*f.getWidth()),n=h(1E6*u),e=h(1E6*f.getHeight()),y=h(1E6*w),r=l!==n||e!==y;var z,k,x=g&&g.rect,p=g&&g.divExtent;if(oa.zoomDuration&&r&&f){p=p||new K(f);x=x||
{left:f.xmin,top:f.ymax,width:f.getWidth(),height:f.getHeight()};k={left:a.xmin,top:a.ymax,width:u,height:w};var q=new J(a.xmin,a.ymax,t),C=new J(a.xmin,a.ymin,t),A=new J(this.extent.xmin,this.extent.ymax,t),D=new J(this.extent.xmin,this.extent.ymin,t);(z=O.getLineIntersection(A,q,D,C,t))||g||(r=!1)}this._ratioW=this.width/u;this._ratioH=this.height/w;var I=this._zoomAnimDiv;if(r)if(aa(this._layersDiv,{left:"0px",top:"0px"}),b=new P(0,0),this.__visibleRect.x=this.__visibleRect.y=0,x&&k){this._delta=
b;I.id="_zAD";I.startingExtent=p;I.extent=a;I.levelChange=r;I.newLod=v.lod;I.anchor=c?c:!z&&g?g.anchor:ja(this.extent,this.width,this.height,z);var F=this.extent.getWidth()/a.getWidth();1024<(1>F?1/F:F)?(this.__zoomStart(p,I.anchor),this.__zoom(p,1,I.anchor),this._fireOnScale(1,I.anchor,!0),this.__zoomEnd(a,F,I.anchor,v.lod,r)):(this._zoomAnim=B.resize({node:I,start:x,end:k,duration:oa.zoomDuration,rate:oa.zoomRate,beforeBegin:g?null:this._zoomStartHandler,onAnimate:this._zoomingHandler,onEnd:this._zoomEndHandler}).play(),
this._fireOnScale(F,I.anchor,m))}else this._updateExtent(a,r,m),this._fireExtChg([this.extent,b,r,this.__LOD=v.lod]);else if(!this.__panning)if(!1===this.loaded||m)this._updateExtent(a,r,m),this._fireExtChg([this.extent,b,r,this.__LOD=v.lod]);else{this.__panning=!0;x=(new U(0,0,this.width,this.height,this.spatialReference)).getCenter();x.x=h(x.x);x.y=h(x.y);var E=this._delta=this.toScreen(a.getCenter()),M=Math.abs(x.x-E.x),L=Math.abs(x.y-E.y);this.optimizePanAnimation&&(M>2*this.width||L>2*this.height)?
(this.__panStart(0,0),this.__pan(0,0),this.__visibleRect.x=this.__visibleRect.y=this.__visibleDelta.x=this.__visibleDelta.y=0,this.__panning=!1,this._delta=null,this._updateExtent(a,!1,m),this.onPanEnd(this.extent,new P(0,0)),this._fireExtChg([this.extent,new P(0,0),!0,this.__LOD])):(this.onPanStart(this.extent,new P(0,0)),this._panAnim=B.slideTo({node:I,left:x.x-E.x,top:x.y-E.y,duration:oa.panDuration,rate:oa.panRate,onAnimate:this._panningHandler,onEnd:this._panEndHandler}),this._panAnim.play())}}}catch(Ua){console.log(Ua.stack),
console.error(Ua)}},_fireOnScale:function(a,b,c){if("css-transforms"===this.navigationMode){var d=this.__visibleDelta;this.onScale(y.scaleAt(a,{x:-1*(this.width/2-(b.x-d.x)),y:-1*(this.height/2-(b.y-d.y))}),c)}},_stopAnim:function(){var a=this._zoomAnim,b=this._panAnim;if(a&&a._active){a.stop();var b=a.curve.getValue(a._getStep()),c=parseFloat(b.left),d=parseFloat(b.top),a=a.node;return{anchor:a.anchor,start:a.startingExtent,end:a.extent,level:a.newLod&&a.newLod.level,rect:b,divExtent:new K(c,d-parseFloat(b.height),
c+parseFloat(b.width),d,this.spatialReference)}}b&&b._active&&(b.stop(),b._fire("onEnd",[b.node]))},__getExtentForLevel:function(a,b,c){var d=this.__tileInfo,d=d&&d.lods;a=A.isDefined(a)?a:0;c=c||this.extent;b=b||c&&c.getCenter();if(d){if(b){c=this.getMinZoom();var g=this.getMaxZoom();a>g&&(a=g);a<c&&(a=c);a=d[a];d=this.width*a.resolution/2;c=this.height*a.resolution/2;return{extent:new K(b.x-d,b.y-c,b.x+d,b.y+c,b.spatialReference),lod:a}}}else if(c)return{extent:c.expand(!a||1>a?1:a).centerAt(b)};
console.log("Map: "+this.invalidExtent)},_jobs:0,_incr:function(){1===++this._jobs&&(this.updating=!0,this.attr("data-updating",""),this.onUpdateStart())},_decr:function(){var a=--this._jobs;a?0>a&&(this._jobs=0):(this.updating=!1,this.attr("data-updating"),this.onUpdateEnd())},_fireEvent:function(a,b){this[a]&&this[a].apply(this,b)},_updateExtent:function(a,b,c){this.extent=a;a=this.spatialReference;this._viewInfo={view:new L({viewingMode:"map",scale:this.getScale()}),sr:a,_version:b?++Ja:Ja};(b||
c)&&this._setClipRect();this._calcGeographicExtent()},_calcGeographicExtent:function(){var a=this.spatialReference;a&&(a.isWebMercator()?this.geographicExtent=N.webMercatorToGeographic(this._getAvailExtent(),!0):4326===a.wkid&&(this.geographicExtent=new K(this._getAvailExtent().toJson())))},_fireExtChg:function(a){this.attr("data-zoom",this.getZoom());this.attr("data-scale",this.getScale());this._fireEvent("onExtentChange",a);if(a=this._extentDfd)delete this._extentDfd,a.resolve()},attr:function(a,
b){var c=this.container;c&&(null==b?c.removeAttribute(a):c.setAttribute(a,b));return this},onUpdateStart:function(){},onUpdateEnd:function(){},onLoad:function(){this._setClipRect();this._calcGeographicExtent()},onBeforeUnload:function(){},onUnload:function(){},onExtentChange:function(a,b,c){},onTimeExtentChange:function(){},onLayerAdd:function(){},onLayerAddResult:function(){},onLayersAddResult:function(){},onLayerRemove:function(){},onLayersRemoved:function(){},onLayerReorder:function(){},onLayersReordered:function(){},
onLayerSuspend:function(){},onLayerResume:function(){},onPanStart:function(){},onPan:function(){},onPanEnd:function(){},onScale:function(){},onZoomStart:function(){},onZoom:function(){},onZoomEnd:function(){},onResize:function(){this._setClipRect()},onReposition:function(){},destroy:function(){this._destroyed||(this.onBeforeUnload(this),this.removeAllLayers(),this._cleanUp(),clearTimeout(this._resizeTimerHandle),this._gc&&this._gc._cleanUp(),this._destroyed=!0,this.onUnload(this))},setCursor:function(a){aa(this.__container,
"cursor",this.cursor=a)},setMapCursor:function(a){this.setCursor(this._cursor=a)},resetMapCursor:function(){this.setCursor(this._cursor)},setBackgroundColor:function(a){a&&!a.declaredClass&&(a=new M(a));this.backgroundColor=a||null;var b="";a&&(b=9>t("ie")?a.toHex():"rgba("+a.toRgba().join(",")+")");r.set(this.root,{backgroundColor:b})},setInfoWindow:function(a){var b=this.infoWindow;b&&b.unsetMap(this);this.infoWindow=a;this.loaded&&a&&a.setMap(this)},setInfoWindowOnClick:function(a){this._params.showInfoWindowOnClick=
a;this.popupManager&&this.popupManager.set("enabled",a)},getInfoWindowAnchor:function(a){return this.infoWindow&&this.infoWindow._getAnchor&&this.infoWindow._getAnchor(a)||"upperright"},toScreen:function(a,b){return ja(this.extent,this.width,this.height,a,b)},toMap:function(a){return ma(this.extent,this.width,this.height,a)},addLayer:function(a,b){a&&!this.getLayer(a.id)&&this._addLayer(a,a instanceof W?this.graphicsLayerIds:this.layerIds,b);return a},addLayers:function(a){var b=[],c=a.length,d,g,
m=a.length;d=n.connect(this,"onLayerAddResult",function(g,m){-1!==f.indexOf(a,g)&&(c--,b.push({layer:g,success:!m,error:m}),c||(n.disconnect(d),this.onLayersAddResult(b)))});for(g=0;g<m;g++)this.addLayer(a[g]);return this},removeLayer:function(a,b){var c=a.id,d=a instanceof W?this.graphicsLayerIds:this.layerIds,g=za(d,c);0<=g&&(d.splice(g,1),a instanceof W?(la(this["_gl_"+a.id+"_click_connect"]),a.loaded&&a._unsetMap(this,this._gc._surface)):a.loaded&&(a._unsetMap(this,this._layersDiv),-1!==a.declaredClass.indexOf("VETiledLayer")&&
this._onBingLayerRemove(a)),delete this._layers[c],delete this._layerDivs[c],b||this._reorderLayers(d),this.onLayerRemove(a))},removeAllLayers:function(){var a=this.layerIds,b;for(b=a.length-1;0<=b;b--)this.removeLayer(this._layers[a[b]],1);a=this.graphicsLayerIds;for(b=a.length-1;0<=b;b--)this.removeLayer(this._layers[a[b]],1);this.onLayersRemoved()},reorderLayer:function(a,b){h.isString(a)&&(p.deprecated(this.declaredClass+": Map.reorderLayer(/*String*/ id, /*Number*/ index) deprecated. Use Map.reorderLayer(/*Layer*/ layer, /*Number*/ index).",
null,"v2.0"),a=this.getLayer(a));var c=a.id,d=a instanceof W?this.graphicsLayerIds:this.layerIds;0>b?b=0:b>=d.length&&(b=d.length-1);a=za(d,c);-1!==a&&a!==b&&(d.splice(a,1),d.splice(b,0,c),this._reorderLayers(d))},getLayer:function(a){return this._layers[a]},setExtent:function(a,b){a=new K(a.toJson());var c=a.getWidth(),d=a.getHeight();return 0===c&&0===d?this.centerAt(new J({x:a.xmin,y:a.ymin,spatialReference:a.spatialReference&&a.spatialReference.toJson()})):this._extentUtil(null,null,a,b)},centerAt:function(a){return this._extentUtil(null,
{mapCenter:a})},centerAndZoom:function(a,b){return this._extentUtil({targetLevel:b,mapCenter:a,levelOrFactor:!0})},getScale:function(){return this.__LOD?this.__LOD.scale:S.getScale(this)},getResolution:function(){return this.__LOD?this.__LOD.resolution:this.extent?this.extent.getWidth()/this.width:0},getResolutionInMeters:function(){return this.getResolution()*S.getUnitValueForSR(this.spatialReference)},getMinResolution:function(){return this._minResolution},getMaxResolution:function(){return this._maxResolution},
getMinScale:function(){return this._params.minScale},getMaxScale:function(){return this._params.maxScale},_getViewInfo:function(){return this._viewInfo},setScale:function(a){return this._extentUtil({targetScale:a})},getLayersVisibleAtScale:function(a){var b=[];(a=a||this.getScale())&&f.forEach(this.layerIds.concat(this.graphicsLayerIds),function(c){c=this.getLayer(c);c.isVisibleAtScale(a)&&b.push(c)},this);return b},getNumLevels:function(){var a=this.getMinZoom(),b=this.getMaxZoom();return a===b&&
0>a?0:b-a+1},getLevel:function(){return this.__LOD?this.__LOD.level:-1},setLevel:function(a){if(-1<a)return this._extentUtil({targetLevel:a})},getZoom:function(){return this.getLevel()},setZoom:function(a){return this.setLevel(a)},getMinZoom:function(){return this._params.minZoom},getMaxZoom:function(){return this._params.maxZoom},setBasemap:function(a){var b;h.isObject(a)?(b=a,a=b.title):b=x&&x[a];if(b){this._basemapDfd&&-1===this._basemapDfd.fired&&this._basemapDfd.cancel();var c=[],d=[],g=0;f.forEach(b.baseMapLayers||
b.layers,function(b){var m,r={id:b.id,displayLevels:b.displayLevels,opacity:A.isDefined(b.opacity)?b.opacity:null,visible:A.isDefined(b.visibility)?b.visibility:null};if(b.type)switch(b.type){case "OpenStreetMap":m=new G(r);break;case "VectorTile":m=F.normalize(b.url);m=new ia(m,r);break;default:console.log("Map.setBasemap: "+A.substitute({basemapName:a,type:b.type},this.unknownLayerType))}else m=F.normalize(b.url),m=new fa(m,r);m&&(c.push(m),d.push(b),b.isReference||g++)},this);if(c.length&&g){var m=
{basemapName:a,infos:d,layers:c};if(this.loaded){var r=this,t=new l(E._dfdCanceller),v=function(a){t._pendingLayers--;a=f.indexOf(m.layers,this);-1<a&&(a=t._layerEvents[a])&&(n.disconnect(a[0]),n.disconnect(a[1]));0>=t._pendingLayers&&(delete t._layerEvents,delete r._basemapDfd,0>t.fired&&t.callback(m))};this._basemapDfd=t;t._pendingLayers=0;t._layerEvents={};f.forEach(c,function(a,b){a&&(t._pendingLayers++,a.loaded?v(a):t._layerEvents[b]=[n.connect(a,"onLoad",a,v),n.connect(a,"onError",a,v)])});
t.addCallback(na(this,this._basemapLoaded))}else this._basemapLoaded(m)}else console.log("Map.setBasemap: "+A.substitute({basemapName:a},this.invalidBasemap))}else{b=[];for(var u in x)b.push(u);console.log("Map.setBasemap: "+A.substitute({basemapName:a,list:b.join(",")},this.unknownBasemap))}},_basemapLoaded:function(a){var b=a.layers,c=a.infos,d=0,g=!0,m;this.loaded&&(f.forEach(b,function(a,b){a.loaded&&(c[b].isReference||d++)}),g=d);g&&(this.basemapLayerIds&&(m={basemapName:this._basemap,infos:x&&
x[this._basemap]&&x[this._basemap].baseMapLayers},m.basemapName||(f.forEach(this.basemapLayerIds,function(a){if(this.getLayer(a)instanceof G)return m.basemapName="osm",m.infos=x&&x.osm&&x.osm.baseMapLayers,!1},this),m.basemapName||(m=null))),this._removeBasemap(),this._basemap=a.basemapName,this.basemapLayerIds=this._addBasemap(b,c),this.attr("data-basemap",this.getBasemap()),this.emit("basemap-change",{current:a,previous:m}))},_addBasemap:function(a,b){var c=[],d=[],g=0;f.forEach(a,function(a,m){b[m].isReference?
c.push(a):(this.addLayer(a,g++),d.push(a.id))},this);c.length&&f.forEach(c,function(a){a.attr("data-reference",!0);this.addLayer(a,"top");d.push(a.id)},this);return d},_removeBasemap:function(){var a=this.basemapLayerIds,b;a&&a.length&&f.forEach(a,function(a){(b=this.getLayer(a))&&this.removeLayer(b)},this)},getBasemap:function(){return this._basemap||""},translate:function(a,b){a=a||0;b=b||0;if(!this._txTimer){this._tx=this._ty=0;var c=this.toScreen(this.extent.getCenter());this.__panStart(c.x,c.y)}this._tx+=
a;this._ty+=b;this.__pan(this._tx,this._ty);clearTimeout(this._txTimer);this._txTimer=setTimeout(this._endTranslate,150)},_endTranslate:function(){clearTimeout(this._txTimer);this._txTimer=null;var a=this._tx,b=this._ty;this._tx=this._ty=0;this.__panEnd(a,b)},setTimeExtent:function(a){a=(this.timeExtent=a)?new a.constructor(a.toJson()):null;this.onTimeExtentChange(a)},setTimeSlider:function(a){this.timeSlider&&(la(this._tsTimeExtentChange_connect),this.timeSlider=this._tsTimeExtentChange_connect=
null);a&&(this.timeSlider=a,this.setTimeExtent(a.getCurrentTimeExtent()),this._tsTimeExtentChange_connect=va(a,"onTimeExtentChange",this,"setTimeExtent"))},setVisibility:function(a){if(this.visible!==a){this.visible=a;a||(this._display=this.container.style.display);this.container.style.display=a?this._display:"none";if(this.autoResize){var b=a?"resume":"pause";this._rszSignal[b]();this._oriSignal[b]()}a&&this.resize()}return this},resize:function(a){clearTimeout(this._resizeTimerHandle);this._destroyed||
(!0===a?this._execResize():this._resizeTimerHandle=setTimeout(this._execResize,this.resizeDelay))},_timedResize:function(){this._resizeTimerHandle||this._execResize()},_execResize:function(){clearTimeout(this._resizeTimerHandle);this._resizeTimerHandle=null;this.reposition();this._resize();this.autoResize&&this._startResizeTimer()},_resize:function(){var a=this.width,b=this.height,c=r.get(this.container,"display"),d=m.getContentBox(this.container);if(!("none"===c||0>=d.w||0>=d.h||a===d.w&&b===d.h)){if(c=
this._zoomAnim||this._panAnim)c.stop(),c._fire("onEnd",[c.node]);aa(this.root,{width:(this.width=d.w)+"px",height:(this.height=d.h)+"px"});d=this.width;c=this.height;this.attribution&&this.attribution.domNode&&r.set(this.attribution.domNode,"maxWidth",Math.floor(d*this._mapParams.attributionWidth)+"px");this.__visibleRect.update(this.__visibleRect.x,this.__visibleRect.y,d,c);this.__visibleDelta.update(this.__visibleDelta.x,this.__visibleDelta.y,d,c);var g=new U(this.extent),a=(new U(g.x,g.y,d/a*g.width,
c/b*g.height,this.spatialReference)).getExtent();this.onResize(a,d,c);this._extentUtil(null,null,a,null,!0)}},reposition:function(){var a=this.position,b=a.x,c=a.y;this._reposition();a=this.position;if(b!==a.x||c!==a.y)this.onReposition(a.x,a.y)},_reposition:function(){var a=m.position(this.container,!0),b=m.getPadBorderExtents(this.container);this.position.update(a.x+b.l,a.y+b.t)},_setClipRect:function(){delete this._clip;var a=7>=t("ie")||void 0===t("ie")&&7<=t("trident")?"rect(auto,auto,auto,auto)":
"auto";if(this.wrapAround180){var b=this.width,c=this.height,d=this._getFrameWidth(),g=b-d;0<g&&(a=g/2,a="rect(0px,"+(a+d)+"px,"+c+"px,"+a+"px)",c=this.extent.getWidth(),b=d/b*c,this._clip=[(c-b)/2,b])}aa(this.__container,"clip",a)},_getAvailExtent:function(){var a=this.extent,b=this._clip;if(b){if(!a._clip){var c=new U(a);c.width=b[1];c.x+=b[0];a._clip=c.getExtent()}return a._clip}return a},_fixedPan:function(a,b){return this._extentUtil(null,{dx:a,dy:b})},panUp:function(){return this._fixedPan(0,
-.75*this.height)},panUpperRight:function(){return this._fixedPan(.75*this.width,-.75*this.height)},panRight:function(){return this._fixedPan(.75*this.width,0)},panLowerRight:function(){return this._fixedPan(.75*this.width,.75*this.height)},panDown:function(){return this._fixedPan(0,.75*this.height)},panLowerLeft:function(){return this._fixedPan(-.75*this.width,.75*this.height)},panLeft:function(){return this._fixedPan(-.75*this.width,0)},panUpperLeft:function(){return this._fixedPan(-.75*this.width,
-.75*this.height)},enableSnapping:function(a){a=a||{};if("esri.SnappingManager"===a.declaredClass)this.snappingManager=a;else{var b=ta++,c=this;this._rids&&this._rids.push(b);k(["./SnappingManager"],function(d){var g=c._rids?f.indexOf(c._rids,b):-1;-1!==g&&(c._rids.splice(g,1),c.snappingManager=new d(h.mixin({map:c},a)))})}return this.snappingManager},disableSnapping:function(){this.snappingManager&&this.snappingManager.destroy();this.snappingManager=null},_createLabelLayer:function(){!this._labels&&
ua&&this.loaded&&(this._labels=new ua({id:"_internal_LabelLayer"}),this._labels._setMap(this,this._gc._surface),this._processLabelLayers(),this.on("layers-reordered",this._processLabelLayers))},_processLabelLayers:function(){null==this._labelProcessor&&(this._labelProcessor=setTimeout(this._updateLabelLayers,0))},_updateLabelLayers:function(){this._labelProcessor=null;this._labels&&(this._labels.removeAllFeatureLayers(),f.forEach(this.graphicsLayerIds,function(a){a=this.getLayer(a);"function"===typeof a.applyEdits?
this._labels.addFeatureLayer(a):"esri.layers.WFSLayer"===a.declaredClass&&this._labels.addFeatureLayer(a)},this))},_getMapImageLyr:function(){this.loaded&&!this._mapImageLyr&&(this._mapImageLyr=new Z,this._mapImageLyr._setMap(this,this._layersDiv),this._placeMapImageLyr());return this._mapImageLyr},_placeMapImageLyr:function(){for(var a=this.layerIds,b=this._layerDivs,c=!1,d,g,m=a.length-1;0<=m;m--)if(d=a[m],g=this.getLayer(d),d=b[d],g&&d&&!g._isReference){u.place(this._mapImageLyr._div,d,"after");
c=!0;break}c||u.place(this._mapImageLyr._div,this._layersDiv,"first")}})})},"dojox/gfx/matrix":function(){define(["./_base","dojo/_base/lang"],function(k,e){var p=k.matrix={},q={};p._degToRad=function(n){return q[n]||(q[n]=Math.PI*n/180)};p._radToDeg=function(n){return n/Math.PI*180};p.Matrix2D=function(n){if(n)if("number"==typeof n)this.xx=this.yy=n;else if(n instanceof Array){if(0<n.length){for(var l=p.normalize(n[0]),h=1;h<n.length;++h){var f=l,d=p.normalize(n[h]),l=new p.Matrix2D;l.xx=f.xx*d.xx+
f.xy*d.yx;l.xy=f.xx*d.xy+f.xy*d.yy;l.yx=f.yx*d.xx+f.yy*d.yx;l.yy=f.yx*d.xy+f.yy*d.yy;l.dx=f.xx*d.dx+f.xy*d.dy+f.dx;l.dy=f.yx*d.dx+f.yy*d.dy+f.dy}e.mixin(this,l)}}else e.mixin(this,n)};e.extend(p.Matrix2D,{xx:1,xy:0,yx:0,yy:1,dx:0,dy:0});e.mixin(p,{identity:new p.Matrix2D,flipX:new p.Matrix2D({xx:-1}),flipY:new p.Matrix2D({yy:-1}),flipXY:new p.Matrix2D({xx:-1,yy:-1}),translate:function(n,l){return 1<arguments.length?new p.Matrix2D({dx:n,dy:l}):new p.Matrix2D({dx:n.x,dy:n.y})},scale:function(n,l){return 1<
arguments.length?new p.Matrix2D({xx:n,yy:l}):"number"==typeof n?new p.Matrix2D({xx:n,yy:n}):new p.Matrix2D({xx:n.x,yy:n.y})},rotate:function(n){var l=Math.cos(n);n=Math.sin(n);return new p.Matrix2D({xx:l,xy:-n,yx:n,yy:l})},rotateg:function(n){return p.rotate(p._degToRad(n))},skewX:function(n){return new p.Matrix2D({xy:Math.tan(n)})},skewXg:function(n){return p.skewX(p._degToRad(n))},skewY:function(n){return new p.Matrix2D({yx:Math.tan(n)})},skewYg:function(n){return p.skewY(p._degToRad(n))},reflect:function(n,
l){1==arguments.length&&(l=n.y,n=n.x);var h=n*n,f=l*l,d=h+f,c=2*n*l/d;return new p.Matrix2D({xx:2*h/d-1,xy:c,yx:c,yy:2*f/d-1})},project:function(n,l){1==arguments.length&&(l=n.y,n=n.x);var h=n*n,f=l*l,d=h+f,c=n*l/d;return new p.Matrix2D({xx:h/d,xy:c,yx:c,yy:f/d})},normalize:function(n){return n instanceof p.Matrix2D?n:new p.Matrix2D(n)},isIdentity:function(n){return 1==n.xx&&0==n.xy&&0==n.yx&&1==n.yy&&0==n.dx&&0==n.dy},clone:function(n){var l=new p.Matrix2D,h;for(h in n)"number"==typeof n[h]&&"number"==
typeof l[h]&&l[h]!=n[h]&&(l[h]=n[h]);return l},invert:function(n){n=p.normalize(n);var l=n.xx*n.yy-n.xy*n.yx;return n=new p.Matrix2D({xx:n.yy/l,xy:-n.xy/l,yx:-n.yx/l,yy:n.xx/l,dx:(n.xy*n.dy-n.yy*n.dx)/l,dy:(n.yx*n.dx-n.xx*n.dy)/l})},_multiplyPoint:function(n,l,h){return{x:n.xx*l+n.xy*h+n.dx,y:n.yx*l+n.yy*h+n.dy}},multiplyPoint:function(n,l,h){n=p.normalize(n);return"number"==typeof l&&"number"==typeof h?p._multiplyPoint(n,l,h):p._multiplyPoint(n,l.x,l.y)},multiplyRectangle:function(n,l){var h=p.normalize(n);
l=l||{x:0,y:0,width:0,height:0};if(p.isIdentity(h))return{x:l.x,y:l.y,width:l.width,height:l.height};n=p.multiplyPoint(h,l.x,l.y);var f=p.multiplyPoint(h,l.x,l.y+l.height),d=p.multiplyPoint(h,l.x+l.width,l.y);l=p.multiplyPoint(h,l.x+l.width,l.y+l.height);var h=Math.min(n.x,f.x,d.x,l.x),c=Math.min(n.y,f.y,d.y,l.y);return{x:h,y:c,width:Math.max(n.x,f.x,d.x,l.x)-h,height:Math.max(n.y,f.y,d.y,l.y)-c}},multiply:function(n){for(var l=p.normalize(n),h=1;h<arguments.length;++h){var f=l,d=p.normalize(arguments[h]),
l=new p.Matrix2D;l.xx=f.xx*d.xx+f.xy*d.yx;l.xy=f.xx*d.xy+f.xy*d.yy;l.yx=f.yx*d.xx+f.yy*d.yx;l.yy=f.yx*d.xy+f.yy*d.yy;l.dx=f.xx*d.dx+f.xy*d.dy+f.dx;l.dy=f.yx*d.dx+f.yy*d.dy+f.dy}return l},_sandwich:function(n,l,h){return p.multiply(p.translate(l,h),n,p.translate(-l,-h))},scaleAt:function(n,l,h,f){switch(arguments.length){case 4:return p._sandwich(p.scale(n,l),h,f);case 3:return"number"==typeof h?p._sandwich(p.scale(n),l,h):p._sandwich(p.scale(n,l),h.x,h.y)}return p._sandwich(p.scale(n),l.x,l.y)},rotateAt:function(n,
l,h){return 2<arguments.length?p._sandwich(p.rotate(n),l,h):p._sandwich(p.rotate(n),l.x,l.y)},rotategAt:function(n,l,h){return 2<arguments.length?p._sandwich(p.rotateg(n),l,h):p._sandwich(p.rotateg(n),l.x,l.y)},skewXAt:function(n,l,h){return 2<arguments.length?p._sandwich(p.skewX(n),l,h):p._sandwich(p.skewX(n),l.x,l.y)},skewXgAt:function(n,l,h){return 2<arguments.length?p._sandwich(p.skewXg(n),l,h):p._sandwich(p.skewXg(n),l.x,l.y)},skewYAt:function(n,l,h){return 2<arguments.length?p._sandwich(p.skewY(n),
l,h):p._sandwich(p.skewY(n),l.x,l.y)},skewYgAt:function(n,l,h){return 2<arguments.length?p._sandwich(p.skewYg(n),l,h):p._sandwich(p.skewYg(n),l.x,l.y)}});k.Matrix2D=p.Matrix2D;return p})},"esri/basemaps":function(){define(["require","dojo/has","./kernel","dojo/i18n!./nls/jsapi"],function(k,e,p,q){return{streets:{title:q.basemaps.streets,thumbnailUrl:k.toUrl("./images/basemap/streets.jpg"),itemId:"d8855ee4d3d74413babfb0f41203b168",baseMapLayers:[{url:"https://services.arcgisonline.com/ArcGIS/rest/services/World_Street_Map/MapServer"}]},
satellite:{title:q.basemaps.satellite,thumbnailUrl:k.toUrl("./images/basemap/satellite.jpg"),itemId:"86de95d4e0244cba80f0fa2c9403a7b2",baseMapLayers:[{url:"https://services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer"}]},hybrid:{title:q.basemaps.hybrid,thumbnailUrl:k.toUrl("./images/basemap/hybrid.jpg"),itemId:"413fd05bbd7342f5991d5ec96f4f8b18",baseMapLayers:[{url:"https://services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer"},{url:"https://services.arcgisonline.com/ArcGIS/rest/services/Reference/World_Boundaries_and_Places/MapServer",
isReference:!0}]},terrain:{title:q.basemaps.terrain,thumbnailUrl:k.toUrl("./images/basemap/terrain.jpg"),itemId:"aab054ab883c4a4094c72e949566ad40",baseMapLayers:[{url:"https://services.arcgisonline.com/ArcGIS/rest/services/World_Terrain_Base/MapServer"},{url:"https://services.arcgisonline.com/ArcGIS/rest/services/Reference/World_Reference_Overlay/MapServer",isReference:!0}]},topo:{title:q.basemaps.topo,thumbnailUrl:k.toUrl("./images/basemap/topo.jpg"),itemId:"6e03e8c26aad4b9c92a87c1063ddb0e3",baseMapLayers:[{url:"https://services.arcgisonline.com/ArcGIS/rest/services/World_Topo_Map/MapServer"}]},
gray:{title:q.basemaps.gray,thumbnailUrl:k.toUrl("./images/basemap/gray.jpg"),itemId:"8b3b470883a744aeb60e5fff0a319ce7",baseMapLayers:[{url:"https://services.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Light_Gray_Base/MapServer"},{url:"https://services.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Light_Gray_Reference/MapServer",isReference:!0}]},"dark-gray":{title:q.basemaps["dark-gray"],thumbnailUrl:k.toUrl("./images/basemap/dark-gray.jpg"),itemId:"da65bacab5bd4defb576f839b6b28098",
baseMapLayers:[{url:"https://services.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Dark_Gray_Base/MapServer"},{url:"https://services.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Dark_Gray_Reference/MapServer",isReference:!0}]},oceans:{title:q.basemaps.oceans,thumbnailUrl:k.toUrl("./images/basemap/oceans.jpg"),itemId:"48b8cec7ebf04b5fbdcaf70d09daff21",baseMapLayers:[{url:"https://services.arcgisonline.com/arcgis/rest/services/Ocean/World_Ocean_Base/MapServer"},{url:"https://services.arcgisonline.com/arcgis/rest/services/Ocean/World_Ocean_Reference/MapServer",
isReference:!0}]},"national-geographic":{title:q.basemaps["national-geographic"],thumbnailUrl:k.toUrl("./images/basemap/national-geographic.jpg"),itemId:"509e2d6b034246d692a461724ae2d62c",baseMapLayers:[{url:"https://services.arcgisonline.com/ArcGIS/rest/services/NatGeo_World_Map/MapServer"}]},osm:{title:q.basemaps.osm,thumbnailUrl:k.toUrl("./images/basemap/osm.jpg"),itemId:"5d2bfa736f8448b3a1708e1f6be23eed",baseMapLayers:[{type:"OpenStreetMap"}]},"dark-gray-vector":{title:q.basemaps["dark-gray"],
thumbnailUrl:k.toUrl("./images/basemap/dark-gray.jpg"),itemId:"c11ce4f7801740b2905eb03ddc963ac8",baseMapLayers:[{url:"https://www.arcgis.com/sharing/rest/content/items/c11ce4f7801740b2905eb03ddc963ac8/resources/styles/root.json",type:"VectorTile"}]},"gray-vector":{title:q.basemaps.gray,thumbnailUrl:k.toUrl("./images/basemap/gray.jpg"),itemId:"8a2cba3b0ebf4140b7c0dc5ee149549a",baseMapLayers:[{url:"https://www.arcgis.com/sharing/rest/content/items/8a2cba3b0ebf4140b7c0dc5ee149549a/resources/styles/root.json",
type:"VectorTile"}]},"streets-vector":{title:q.basemaps.streets,thumbnailUrl:k.toUrl("./images/basemap/streets.jpg"),itemId:"de26a3cf4cc9451298ea173c4b324736",baseMapLayers:[{url:"https://www.arcgis.com/sharing/rest/content/items/de26a3cf4cc9451298ea173c4b324736/resources/styles/root.json",type:"VectorTile"}]},"topo-vector":{title:q.basemaps.topo,thumbnailUrl:k.toUrl("./images/basemap/topo.jpg"),itemId:"7dc6cea0b1764a1f9af2e679f642f0f5",baseMapLayers:[{url:"https://www.arcgis.com/sharing/rest/content/items/7dc6cea0b1764a1f9af2e679f642f0f5/resources/styles/root.json",
type:"VectorTile"}]},"streets-night-vector":{title:q.basemaps["streets-night-vector"],thumbnailUrl:k.toUrl("./images/basemap/streets-night.jpg"),itemId:"86f556a2d1fd468181855a35e344567f",baseMapLayers:[{url:"https://www.arcgis.com/sharing/rest/content/items/86f556a2d1fd468181855a35e344567f/resources/styles/root.json",type:"VectorTile"}]},"streets-relief-vector":{title:q.basemaps["streets-relief-vector"],thumbnailUrl:k.toUrl("./images/basemap/streets-relief.jpg"),itemId:"b266e6d17fc345b498345613930fbd76",
baseMapLayers:[{url:"https://www.arcgis.com/sharing/rest/content/items/b266e6d17fc345b498345613930fbd76/resources/styles/root.json",type:"VectorTile"}]},"streets-navigation-vector":{title:q.basemaps["streets-navigation-vector"],thumbnailUrl:k.toUrl("./images/basemap/streets-navigation.jpg"),itemId:"63c47b7177f946b49902c24129b87252",baseMapLayers:[{url:"https://www.arcgis.com/sharing/rest/content/items/63c47b7177f946b49902c24129b87252/resources/styles/root.json",type:"VectorTile"}]}}})},"esri/Evented":function(){define("dojo/_base/declare dojo/_base/lang dojo/aspect dojo/Evented dojo/has ./kernel".split(" "),
function(k,e,p,q,n,l){return k([q],{declaredClass:"esri.Evented",registerConnectEvents:function(){var h=this.constructor,f=this.constructor._meta.parents,d=[{}],c={},a,b,g=function(a,b){e.isArray(a)||(a=[a]);for(var c=0;c<a.length;c++){var d=a[c];d._meta&&d._meta.parents&&g(d._meta.parents,b);d.prototype._eventMap&&b.push(e.mixin({},d.prototype._eventMap))}return b};if(!h._onMap){g(f,d);d.push(this._eventMap);f=e.mixin.apply(this,d);for(a in this)/^on\w/.test(a)&&e.isFunction(this[a])&&(d=this._hyphenLower(a).toLowerCase(),
f[d]||(c[d]={method:a}));for(b in f)a=this._onCamelCase(b),c[b]={method:a,argKeys:f[b]};h._onMap=c;return h._onMap}},on:function(h,f){if(-1<h.indexOf(",")){for(var d=h.split(/\s*,\s*/),c=d.length,a=[];c--;)a.push(this.on(d[c],f));a.remove=function(){for(var b=0;b<a.length;b++)a[b].remove()};return a}var d=this.constructor._onMap||this.registerConnectEvents(),c="string"==typeof h&&h.toLowerCase(),b=this._onCamelCase(c),g=d&&d[c];return(b=g&&g.method||this[b]&&e.isFunction(this[b])&&b)?g&&e.isArray(g.argKeys)?
(d=this._onArr2Obj(f,d[c].argKeys),p.after(this,b,d,!0)):p.after(this,b,function(a){a=a||{};a.target||(a.target=this);f.call(this,a)},!0):this.inherited(arguments)},emit:function(h,f){var d,c,a,b,g=h.toLowerCase();b=this._onCamelCase(h);var u=this.constructor._onMap||this.registerConnectEvents();b=(a=u&&u[g]&&u[g].method||e.isFunction(this[b])&&b)&&this[a];a&&u&&u[g]&&this._onObj2Arr(function(){c=Array.prototype.slice.call(arguments)},u[g].argKeys)(f);f=f||{};f.target||(f.target=this);b&&(d=c&&c.length?
c:[f],d=b.apply(this,d));this.inherited(arguments,[h,f]);return d},_onObj2Arr:function(h,f){if(f){var d=this;return function(c){var a,b=[],g=f.length;for(a=0;a<g;a++)b[a]=c[f[a]];h.apply(d,b)}}return h},_onArr2Obj:function(h,f){if(f){var d=this;return function(){var c,a={},b=arguments.length;for(c=0;c<b;c++)a[f[c]]=arguments[c];a.target||(a.target=d);h.call(d,a)}}return h},_hyphenLower:function(h){return h.replace(/^on/,"").replace(/[A-Z](?=[a-z])/g,function(f,d){return(d?"-":"")+f.toLowerCase()})},
_onCamelCase:function(h){return"on"+h.substr(0,1).toUpperCase()+h.substr(1).replace(/\-([a-z])/g,function(f,d){return d.toUpperCase()})}})})},"esri/fx":function(){define("dojo/_base/connect dojo/_base/fx dojo/_base/lang dojo/dom dojo/dom-geometry dojo/dom-style dojo/fx dojo/has ./kernel".split(" "),function(k,e,p,q,n,l,h,f,d){return{animateRange:function(c){var a=c.range;return new e.Animation(p.mixin({curve:new e._Line(a.start,a.end)},c))},resize:function(c){var a=c.node=q.byId(c.node),b=c.start,
d=c.end;b||(b=n.getMarginBox(a),a=n.getPadBorderExtents(a),b=c.start={left:b.l+a.l,top:b.t+a.t,width:b.w-a.w,height:b.h-a.h});d||(d=c.anchor?c.anchor:{x:b.left,y:b.top},a=c.size,d=c.end={left:b.left-(a.width-b.width)*(d.x-b.left)/b.width,top:b.top-(a.height-b.height)*(d.y-b.top)/b.height,width:a.width,height:a.height});return e.animateProperty(p.mixin({properties:{left:{start:b.left,end:d.left},top:{start:b.top,end:d.top},width:{start:b.width,end:d.width},height:{start:b.height,end:d.height}}},c))},
slideTo:function(c){var a=c.node=q.byId(c.node),b=l.getComputedStyle,d=null,f=null,m=function(){return function(){var c="absolute"==a.style.position?"absolute":"relative";d="absolute"==c?a.offsetTop:parseInt(b(a).top)||0;f="absolute"==c?a.offsetLeft:parseInt(b(a).left)||0;"absolute"!=c&&"relative"!=c&&(c=n.position(a,!0),d=c.y,f=c.x,a.style.position="absolute",a.style.top=d+"px",a.style.left=f+"px")}}();m();c=e.animateProperty(p.mixin({properties:{top:{start:d,end:c.top||0},left:{start:f,end:c.left||
0}}},c));k.connect(c,"beforeBegin",c,m);return c},flash:function(c){c=p.mixin({end:"#f00",duration:500,count:1},c);c.duration/=2*c.count;var a=q.byId(c.node),b=c.start;b||(b=l.getComputedStyle(a).backgroundColor);var d=c.end,f=[],m=c.count,a={node:a,duration:c.duration};for(c=0;c<m;c++)f.push(e.animateProperty(p.mixin({properties:{backgroundColor:{start:b,end:d}}},a))),f.push(e.animateProperty(p.mixin({properties:{backgroundColor:{start:d,end:b}}},a)));return h.chain(f)}}})},"dojo/fx":function(){define("./_base/lang ./Evented ./_base/kernel ./_base/array ./aspect ./_base/fx ./dom ./dom-style ./dom-geometry ./ready require".split(" "),
function(k,e,p,q,n,l,h,f,d,c,a){p.isAsync||c(0,function(){a(["./fx/Toggler"])});p=p.fx={};c={_fire:function(a,b){this[a]&&this[a].apply(this,b||[]);return this}};var b=function(a){this._index=-1;this._animations=a||[];this._current=this._onAnimateCtx=this._onEndCtx=null;this.duration=0;q.forEach(this._animations,function(a){a&&("undefined"!=typeof a.duration&&(this.duration+=a.duration),a.delay&&(this.duration+=a.delay))},this)};b.prototype=new e;k.extend(b,{_onAnimate:function(){this._fire("onAnimate",
arguments)},_onEnd:function(){this._onAnimateCtx.remove();this._onEndCtx.remove();this._onAnimateCtx=this._onEndCtx=null;this._index+1==this._animations.length?this._fire("onEnd"):(this._current=this._animations[++this._index],this._onAnimateCtx=n.after(this._current,"onAnimate",k.hitch(this,"_onAnimate"),!0),this._onEndCtx=n.after(this._current,"onEnd",k.hitch(this,"_onEnd"),!0),this._current.play(0,!0))},play:function(a,b){this._current||(this._current=this._animations[this._index=0]);if(!b&&"playing"==
this._current.status())return this;var c=n.after(this._current,"beforeBegin",k.hitch(this,function(){this._fire("beforeBegin")}),!0),d=n.after(this._current,"onBegin",k.hitch(this,function(a){this._fire("onBegin",arguments)}),!0),g=n.after(this._current,"onPlay",k.hitch(this,function(a){this._fire("onPlay",arguments);c.remove();d.remove();g.remove()}));this._onAnimateCtx&&this._onAnimateCtx.remove();this._onAnimateCtx=n.after(this._current,"onAnimate",k.hitch(this,"_onAnimate"),!0);this._onEndCtx&&
this._onEndCtx.remove();this._onEndCtx=n.after(this._current,"onEnd",k.hitch(this,"_onEnd"),!0);this._current.play.apply(this._current,arguments);return this},pause:function(){if(this._current){var a=n.after(this._current,"onPause",k.hitch(this,function(b){this._fire("onPause",arguments);a.remove()}),!0);this._current.pause()}return this},gotoPercent:function(a,b){this.pause();var c=this.duration*a;this._current=null;q.some(this._animations,function(a,b){if(c<=a.duration)return this._current=a,this._index=
b,!0;c-=a.duration;return!1},this);this._current&&this._current.gotoPercent(c/this._current.duration);b&&this.play();return this},stop:function(a){if(this._current){if(a){for(;this._index+1<this._animations.length;++this._index)this._animations[this._index].stop(!0);this._current=this._animations[this._index]}var b=n.after(this._current,"onStop",k.hitch(this,function(a){this._fire("onStop",arguments);b.remove()}),!0);this._current.stop()}return this},status:function(){return this._current?this._current.status():
"stopped"},destroy:function(){this.stop();this._onAnimateCtx&&this._onAnimateCtx.remove();this._onEndCtx&&this._onEndCtx.remove()}});k.extend(b,c);p.chain=function(a){return new b(k.isArray(a)?a:Array.prototype.slice.call(a,0))};var g=function(a){this._animations=a||[];this._connects=[];this.duration=this._finished=0;q.forEach(a,function(a){var b=a.duration;a.delay&&(b+=a.delay);this.duration<b&&(this.duration=b);this._connects.push(n.after(a,"onEnd",k.hitch(this,"_onEnd"),!0))},this);this._pseudoAnimation=
new l.Animation({curve:[0,1],duration:this.duration});var b=this;q.forEach("beforeBegin onBegin onPlay onAnimate onPause onStop onEnd".split(" "),function(a){b._connects.push(n.after(b._pseudoAnimation,a,function(){b._fire(a,arguments)},!0))})};k.extend(g,{_doAction:function(a,b){q.forEach(this._animations,function(c){c[a].apply(c,b)});return this},_onEnd:function(){++this._finished>this._animations.length&&this._fire("onEnd")},_call:function(a,b){var c=this._pseudoAnimation;c[a].apply(c,b)},play:function(a,
b){this._finished=0;this._doAction("play",arguments);this._call("play",arguments);return this},pause:function(){this._doAction("pause",arguments);this._call("pause",arguments);return this},gotoPercent:function(a,b){var c=this.duration*a;q.forEach(this._animations,function(a){a.gotoPercent(a.duration<c?1:c/a.duration,b)});this._call("gotoPercent",arguments);return this},stop:function(a){this._doAction("stop",arguments);this._call("stop",arguments);return this},status:function(){return this._pseudoAnimation.status()},
destroy:function(){this.stop();q.forEach(this._connects,function(a){a.remove()})}});k.extend(g,c);p.combine=function(a){return new g(k.isArray(a)?a:Array.prototype.slice.call(a,0))};p.wipeIn=function(a){var b=a.node=h.byId(a.node),c=b.style,d;a=l.animateProperty(k.mixin({properties:{height:{start:function(){d=c.overflow;c.overflow="hidden";if("hidden"==c.visibility||"none"==c.display)return c.height="1px",c.display="",c.visibility="",1;var a=f.get(b,"height");return Math.max(a,1)},end:function(){return b.scrollHeight}}}},
a));var g=function(){c.height="auto";c.overflow=d};n.after(a,"onStop",g,!0);n.after(a,"onEnd",g,!0);return a};p.wipeOut=function(a){var b=(a.node=h.byId(a.node)).style,c;a=l.animateProperty(k.mixin({properties:{height:{end:1}}},a));n.after(a,"beforeBegin",function(){c=b.overflow;b.overflow="hidden";b.display=""},!0);var d=function(){b.overflow=c;b.height="auto";b.display="none"};n.after(a,"onStop",d,!0);n.after(a,"onEnd",d,!0);return a};p.slideTo=function(a){var b=null,c=null,g=function(a){return function(){var g=
f.getComputedStyle(a),m=g.position;b="absolute"==m?a.offsetTop:parseInt(g.top)||0;c="absolute"==m?a.offsetLeft:parseInt(g.left)||0;"absolute"!=m&&"relative"!=m&&(g=d.position(a,!0),b=g.y,c=g.x,a.style.position="absolute",a.style.top=b+"px",a.style.left=c+"px")}}(a.node=h.byId(a.node));g();a=l.animateProperty(k.mixin({properties:{top:a.top||0,left:a.left||0}},a));n.after(a,"beforeBegin",g,!0);return a};return p})},"esri/tileUtils":function(){define(["dojo/_base/array","dojo/has","./kernel","./geometry/Point",
"./geometry/Extent"],function(k,e,p,q,n){return{_addFrameInfo:function(l,h){var f,d,c=2*h.origin[1],a=h.origin[0],b=l.origin.x,g=l.width,u;k.forEach(l.lods,function(m){f=Math.round(c/m.resolution);d=Math.ceil(f/g);u=Math.floor((a-b)/(g*m.resolution));m._frameInfo||(m._frameInfo=[d,u,u+d-1,f])})},getContainingTileCoords:function(l,h,f){var d=l.origin;f=f.resolution;return{row:Math.floor((d.y-h.y)/(l.height*f)),col:Math.floor((h.x-d.x)/(l.width*f))}},getCandidateTileInfo:function(l,h,f){var d;d=l.width;
for(var c=l.height,a=f.xmax-f.xmin,b=f.ymax-f.ymin,g=l.__tileInfo===h,u=g?l.getMinZoom():-1,g=g?l.getMaxZoom():-1,m=-1,r=h.lods,t=Math.abs,v,e,w,g=-1<g?g:r.length-1,u=-1<u?u:0;u<=g;u++)if(e=r[u])if(w=a>b?t(b-c*e.resolution):t(a-d*e.resolution),0>m||w<=m)v=e,m=w;else break;d=v;v=d.resolution;c=(f.xmin+f.xmax)/2;a=(f.ymin+f.ymax)/2;b=l.width/2*v;v*=l.height/2;c=new n(c-b,a-v,c+b,a+v,f.spatialReference);f=new q(c.xmin,c.ymax,f.spatialReference);g=d.resolution;b=h.width;a=h.height;h=h.origin;l=l.__visibleDelta;
v=Math.floor;r=b*g;t=a*g;g=v((h.y-f.y)/t);m=v((f.x-h.x)/r);u=h.y-g*t;h=v(Math.abs((f.x-(h.x+m*r))*b/r))+l.x;l=v(Math.abs((f.y-u)*a/t))+l.y;return{tile:{point:f,coords:{row:g,col:m},offsets:{x:h,y:l}},lod:d,extent:c}},getTileExtent:function(l,h,f,d){var c=l.origin;h=l.lods[h].resolution;var a=l.width,b=l.height;return new n(d*h*a+c.x,c.y-(f+1)*h*b,(d+1)*h*a+c.x,c.y-f*h*b,l.spatialReference)}}})},"esri/geometry/Point":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../lang ../SpatialReference ./Geometry ../srUtils".split(" "),
function(k,e,p,q,n,l,h,f){function d(a,c){89.99999<c?c=89.99999:-89.99999>c&&(c=-89.99999);c*=.017453292519943;return[111319.49079327169*a,3189068.5*Math.log((1+Math.sin(c))/(1-Math.sin(c)))]}function c(a,c,d){a=a/6378137*57.29577951308232;return d?[a,57.29577951308232*(1.5707963267948966-2*Math.atan(Math.exp(-1*c/6378137)))]:[a-360*Math.floor((a+180)/360),57.29577951308232*(1.5707963267948966-2*Math.atan(Math.exp(-1*c/6378137)))]}var a={type:"point",x:0,y:0};k=k(h,{declaredClass:"esri.geometry.Point",
constructor:function(b,c,d){e.mixin(this,a);e.isArray(b)?(this.x=b[0],this.y=b[1],this.spatialReference=c):e.isObject(b)?(e.mixin(this,b),n.isDefined(this.latitude)&&(this.y=this.latitude),n.isDefined(this.longitude)&&(this.x=this.longitude),this.spatialReference&&(this.spatialReference=f.createSpatialReference(this.spatialReference))):(this.x=b,this.y=c,this.spatialReference=d);this.verifySR()},offset:function(a,c){return new this.constructor(this.x+a,this.y+c,this.spatialReference)},setX:function(a){this.x=
a;this.clearCache();return this},setY:function(a){this.y=a;this.clearCache();return this},setLongitude:function(a){var b=this.spatialReference;b&&(b._isWebMercator()?this.setX(d(a,this.y)[0]):4326===b.wkid&&this.setX(a));return this},setLatitude:function(a){var b=this.spatialReference;b&&(b._isWebMercator()?this.setY(d(this.x,a)[1]):4326===b.wkid&&this.setY(a));return this},getLongitude:function(){var a=this.spatialReference,d;a&&(a._isWebMercator()?d=c(this.x,this.y)[0]:4326===a.wkid&&(d=this.x));
return d},getLatitude:function(){var a=this.spatialReference,d;a&&(a._isWebMercator()?d=c(this.x,this.y)[1]:4326===a.wkid&&(d=this.y));return d},update:function(a,c){this.x=a;this.y=c;this.clearCache();return this},normalize:function(){var a=this.x,c=this.spatialReference;if(c){var d=c._getInfo();d&&(a=this._normalizeX(a,d))}return new this.constructor(a,this.y,c)},_normalizeX:function(a,c){var b=c.valid[0],d=c.valid[1];c=2*d;a>d?(b=Math.ceil(Math.abs(a-d)/c),a-=b*c):a<b&&(b=Math.ceil(Math.abs(a-
b)/c),a+=b*c);return a},toJson:function(){var a={x:this.x,y:this.y},c=this.spatialReference;c&&(a.spatialReference=c.toJson());return a}});k.lngLatToXY=d;k.xyToLngLat=c;k.defaultProps=a;k.metersPerDegree=6378137*Math.PI/180;return k})},"esri/geometry/Geometry":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel","../SpatialReference"],function(k,e,p,q,n){return k(null,{declaredClass:"esri.geometry.Geometry",spatialReference:null,type:null,cache:void 0,setSpatialReference:function(l){this.spatialReference=
l;return this},verifySR:function(){this.spatialReference||this.setSpatialReference(new n(4326))},getExtent:function(){return null},clearCache:function(){this.cache=void 0},getCacheValue:function(l){return this.cache&&this.cache[l]},setCacheValue:function(l,h){this.cache||(this.cache={});this.cache[l]=h}})})},"esri/srUtils":function(){define(["./SpatialReference","./ImageSpatialReference","./kernel","./sniff","dojo/_base/lang"],function(k,e,p,q,n){function l(h){var f=!1;h&&(h.ics||h.icsid)&&(f=!0);
return f}return{isICS:l,createSpatialReference:function(h){var f=null;h&&(f=l(h)?new e(h):new k(h));return f}}})},"esri/ImageSpatialReference":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ./kernel ./lang ./SpatialReference".split(" "),function(k,e,p,q,n,l){return k(l,{declaredClass:"esri.ImageSpatialReference",constructor:function(h){h&&e.isObject(h)&&e.mixin(this,h)},icsid:null,icsns:null,ics:null,_isWebMercator:function(){return!1},_isWrappable:function(){return!1},equals:function(h){var f=
!1;if(h)if(this.icsid&&h.icsid){if(f=this.icsid===h.icsid,this.icsns||h.icsns)f=f&&this.icsns===h.icsns}else this.ics&&h.ics&&(f=this.ics===h.ics);return f},toJson:function(h){var f=null,d=n.isDefined;h=d(h)?h:!0;d(this.icsid)?(f={icsid:this.icsid},d(this.icsns)&&(f.icsns=this.icsns)):d(this.ics)&&(f={ics:this.ics});d(this.url)&&d(f)&&h&&(f.url=this.url);return f}})})},"esri/geometry/Extent":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/has ../kernel ../lang ../SpatialReference ./Geometry ./Point ./webMercatorUtils ./mathUtils ../srUtils".split(" "),
function(k,e,p,q,n,l,h,f,d,c,a,b){var g={type:"extent",xmin:0,ymin:0,xmax:0,ymax:0},u=k(f,{declaredClass:"esri.geometry.Extent",constructor:function(a,c,d,f,u){p.mixin(this,g);p.isObject(a)?(p.mixin(this,a),this.spatialReference&&(this.spatialReference=b.createSpatialReference(this.spatialReference))):this.update(a,c,d,f,u);this.verifySR()},getWidth:function(){return Math.abs(this.xmax-this.xmin)},getHeight:function(){return Math.abs(this.ymax-this.ymin)},getCenter:function(){return new d((this.xmin+
this.xmax)/2,(this.ymin+this.ymax)/2,this.spatialReference)},centerAt:function(a){var b=this.getCenter(),c=a.x-b.x;a=a.y-b.y;return new u(this.xmin+c,this.ymin+a,this.xmax+c,this.ymax+a,this.spatialReference)},update:function(a,b,c,d,g){this.xmin=a;this.ymin=b;this.xmax=c;this.ymax=d;this.spatialReference=g;this.clearCache();return this},offset:function(a,b){return new u(this.xmin+a,this.ymin+b,this.xmax+a,this.ymax+b,this.spatialReference)},expand:function(a){var b=(1-a)/2;a=this.getWidth()*b;b*=
this.getHeight();return new u(this.xmin+a,this.ymin+b,this.xmax-a,this.ymax-b,this.spatialReference)},intersects:function(a){if(!a)return!1;var b=a.type,d=this.spatialReference,g=a.spatialReference;d&&g&&!d.equals(g)&&d._canProject(g)&&(a=d.isWebMercator()?c.geographicToWebMercator(a):c.webMercatorToGeographic(a,!0));switch(b){case "point":return this.contains(a);case "multipoint":return this._intersectsMultipoint(a);case "extent":return this._intersectsExtent(a);case "polygon":return this._intersectsPolygon(a);
case "polyline":return this._intersectsPolyline(a)}},normalize:function(){var a=this._normalize(!1,!0);p.isArray(a)||(a=[a]);return a},shiftCentralMeridian:function(){return this._normalize(!0)},bisect:function(){var a=this.spatialReference,b=a&&a._getInfo(),c=[],d=0;if(b&&this._isOutOfBounds(b)){var g=this,d=g.xmin,f=g.ymin,l=g.ymax,n=b.valid[0],e=b.valid[1];g.getWidth()>2*e&&(g=g.getCenter(),g=new u(g.x-e,f,g.x+e,l,new h(a.toJson())));var d=g.xmin-d,k=this._normalizeX(g.xmin,b),b=this._normalizeX(g.xmax,
b);k.frameId===b.frameId?c.push(new u(k.x,f,b.x,l,new h(a.toJson()))):c.push(new u(k.x,f,e,l,new h(a.toJson())),new u(n,f,b.x,l,new h(a.toJson())))}else c.push(this.getExtent());return{extents:c,marginLeft:d}},_intersectsMultipoint:function(a){var b=a.points.length,c;for(c=0;c<b;c++)if(this.contains(a.getPoint(c)))return!0;return!1},_intersectsExtent:function(a){var b,c,d,g,m=!1;this.xmin<=a.xmin?(b=a.xmin,this.xmax<b?m=!0:d=Math.min(this.xmax,a.xmax)-b):(b=this.xmin,a.xmax<b?m=!0:d=Math.min(this.xmax,
a.xmax)-b);this.ymin<=a.ymin?(c=a.ymin,this.ymax<c?m=!0:g=Math.min(this.ymax,a.ymax)-c):(c=this.ymin,a.ymax<c?m=!0:g=Math.min(this.ymax,a.ymax)-c);return m?null:new u(b,c,b+d,c+g,this.spatialReference)},_intersectsPolygon:function(a){var b=[this.xmin,this.ymax],c=[this.xmax,this.ymax],g=[this.xmin,this.ymin],m=[this.xmax,this.ymin],f=[b,c,g,m],b=[[g,b],[b,c],[c,m],[m,g]],g=a.rings,m=g.length,u,h=new d(0,0,this.spatialReference);u=f.length;for(c=0;c<u;c++)if(h.update(f[c][0],f[c][1]),a.contains(h))return!0;
h.setSpatialReference(a.spatialReference);for(var l,n,c=0;c<m;c++)if(f=g[c],u=f.length){l=f[0];h.update(l[0],l[1]);if(this.contains(h))return!0;for(a=1;a<u;a++){n=f[a];h.update(n[0],n[1]);if(this.contains(h)||this._intersectsLine([l,n],b))return!0;l=n}}return!1},_intersectsPolyline:function(a){var b=[[[this.xmin,this.ymin],[this.xmin,this.ymax]],[[this.xmin,this.ymax],[this.xmax,this.ymax]],[[this.xmax,this.ymax],[this.xmax,this.ymin]],[[this.xmax,this.ymin],[this.xmin,this.ymin]]],c,g=a.paths,m=
g.length,f,u,h,l,n=new d(0,0,a.spatialReference);for(a=0;a<m;a++)if(f=g[a],u=f.length){h=f[0];n.update(h[0],h[1]);if(this.contains(n))return!0;for(c=1;c<u;c++){l=f[c];n.update(l[0],l[1]);if(this.contains(n)||this._intersectsLine([h,l],b))return!0;h=l}}return!1},_intersectsLine:function(b,c){var d=a._getLineIntersection2,g,m=c.length;for(g=0;g<m;g++)if(d(b,c[g]))return!0;return!1},contains:function(a){if(!a)return!1;var b=a.type;if("point"===b){var c=this.spatialReference,g=a.spatialReference,b=a.x;
a=a.y;c&&g&&!c.equals(g)&&c._canProject(g)&&(a=c.isWebMercator()?d.lngLatToXY(b,a):d.xyToLngLat(b,a,!0),b=a[0],a=a[1]);return b>=this.xmin&&b<=this.xmax&&a>=this.ymin&&a<=this.ymax}return"extent"===b?this._containsExtent(a):!1},_containsExtent:function(a){var b=a.xmin,c=a.ymin,g=a.xmax,m=a.ymax,f=a.spatialReference;a=new d(b,c,f);b=new d(b,m,f);m=new d(g,m,f);c=new d(g,c,f);return this.contains(a)&&this.contains(b)&&this.contains(m)&&this.contains(c)?!0:!1},union:function(a){return new u(Math.min(this.xmin,
a.xmin),Math.min(this.ymin,a.ymin),Math.max(this.xmax,a.xmax),Math.max(this.ymax,a.ymax),this.spatialReference)},getExtent:function(){var a=this.spatialReference;return new u(this.xmin,this.ymin,this.xmax,this.ymax,a&&new h(a.toJson()))},_shiftCM:function(a){var b=this.getCacheValue("_shifted");if(!b){var b=new u(this.toJson()),d=b.spatialReference;if(a=a||d._getInfo()){var g=this._getCM(a);if(g){var m=d._isWebMercator()?c.webMercatorToGeographic(g):g;b.xmin-=g.x;b.xmax-=g.x;d._isWebMercator()||(m.x=
this._normalizeX(m.x,a).x);b.setSpatialReference(new h(l.substitute({Central_Meridian:m.x},4326===d.wkid?a.altTemplate:a.wkTemplate)))}}this.setCacheValue("_shifted",b)}return b},_getCM:function(a){var b;this._isOutOfBounds(a)&&(b=this.getCenter());return b},_isOutOfBounds:function(a){var b=a.valid[0];a=a.valid[1];var c=this.xmin,d=this.xmax;return!(c>=b&&c<=a&&d>=b&&d<=a)},_normalize:function(a,b,c){var d=new u(this.toJson()),g=d.spatialReference;if(g&&(c=c||g._getInfo())){var m=e.map(this._getParts(c),
function(a){return a.extent});return 2<m.length?a?this._shiftCM(c):d.update(c.valid[0],d.ymin,c.valid[1],d.ymax,g):2===m.length?a?this._shiftCM(c):b?m:{rings:e.map(m,function(a){return[[a.xmin,a.ymin],[a.xmin,a.ymax],[a.xmax,a.ymax],[a.xmax,a.ymin],[a.xmin,a.ymin]]}),spatialReference:g}:m[0]||d}return d},_getParts:function(a){var b=this.getCacheValue("_parts");if(!b){var b=[],c=this.xmin,d=this.xmax,g=this.ymin,m=this.ymax,f=this.spatialReference,h=this.getWidth(),l=c,n=d,e=0,k=0,p,q;a=a||f._getInfo();
p=a.valid[0];q=a.valid[1];k=this._normalizeX(c,a);c=k.x;e=k.frameId;k=this._normalizeX(d,a);d=k.x;k=k.frameId;a=c===d&&0<h;if(h>2*q){h=new u(l<n?c:d,g,q,m,f);c=new u(p,g,l<n?d:c,m,f);q=new u(0,g,q,m,f);g=new u(p,g,0,m,f);f=[];p=[];h.contains(q)&&f.push(e);h.contains(g)&&p.push(e);c.contains(q)&&f.push(k);c.contains(g)&&p.push(k);for(m=e+1;m<k;m++)f.push(m),p.push(m);b.push({extent:h,frameIds:[e]},{extent:c,frameIds:[k]},{extent:q,frameIds:f},{extent:g,frameIds:p})}else c>d||a?b.push({extent:new u(c,
g,q,m,f),frameIds:[e]},{extent:new u(p,g,d,m,f),frameIds:[k]}):b.push({extent:new u(c,g,d,m,f),frameIds:[e]});this.setCacheValue("_parts",b)}return b},_normalizeX:function(a,b){var c=0,d=b.valid[0],g=b.valid[1];b=2*g;a>g?(c=Math.ceil(Math.abs(a-g)/b),a-=c*b):a<d&&(c=Math.ceil(Math.abs(a-d)/b),a+=c*b,c=-c);return{x:a,frameId:c}},toJson:function(){var a={xmin:this.xmin,ymin:this.ymin,xmax:this.xmax,ymax:this.ymax},b=this.spatialReference;b&&(a.spatialReference=b.toJson());return a}});u.defaultProps=
g;return u})},"esri/geometry/webMercatorUtils":function(){define("dojo/_base/array dojo/_base/lang dojo/has ../kernel ../SpatialReference ./Point".split(" "),function(k,e,p,q,n,l){function h(d,c,a,b){if("point"===d.type){var g=c(d.x,d.y,b);return new d.constructor(g[0],g[1],new n(a))}if("extent"===d.type){var g=c(d.xmin,d.ymin,b),f=c(d.xmax,d.ymax,b);return new d.constructor(g[0],g[1],f[0],f[1],new n(a))}if("polyline"===d.type||"polygon"===d.type){var g="polyline"===d.type,m=[],r;k.forEach(g?d.paths:
d.rings,function(a){m.push(r=[]);k.forEach(a,function(a){r.push(c(a[0],a[1],b))})});return g?new d.constructor({paths:m,spatialReference:new n(a)}):new d.constructor({rings:m,spatialReference:new n(a)})}if("multipoint"===d.type){var t=[];k.forEach(d.points,function(a){t.push(c(a[0],a[1],b))});return new d.constructor({points:t,spatialReference:new n(a)})}}function f(d,c){d=d&&(null!=d.wkid?d:d.spatialReference);c=c&&(null!=c.wkid?c:c.spatialReference);return d&&c?c.equals(d)?!0:c._canProject(d):!1}
return{canProject:f,project:function(d,c){var a=d&&d.spatialReference;c=c&&(null!=c.wkid?c:c.spatialReference);a&&c?a.equals(c)?d=new d.constructor(d.toJson()):f(a,c)?c.isWebMercator()?d=h(d,l.lngLatToXY,{wkid:102100}):4326===c.wkid&&(d=h(d,l.xyToLngLat,{wkid:4326})):d=null:d=null;return d},lngLatToXY:l.lngLatToXY,xyToLngLat:l.xyToLngLat,metersPerDegree:l.metersPerDegree,geographicToWebMercator:function(d){return h(d,l.lngLatToXY,{wkid:102100})},webMercatorToGeographic:function(d,c){return h(d,l.xyToLngLat,
{wkid:4326},c)}}})},"esri/geometry/mathUtils":function(){define(["dojo/_base/lang","dojo/has","../kernel","./Point"],function(k,e,p,q){function n(f,d,c){return f instanceof q?new q(f.x+c*(d.x-f.x),f.y+c*(d.y-f.y)):[f[0]+c*(d[0]-f[0]),f[1]+c*(d[1]-f[1])]}function l(f,d){return 1E-8>Math.abs(f-d)}function h(f,d,c,a){var b,g=l(f[0],d[0])?1E10:(f[1]-d[1])/(f[0]-d[0]),u=l(c[0],a[0])?1E10:(c[1]-a[1])/(c[0]-a[0]),m=f[1]-g*f[0],r=c[1]-u*c[0];if(l(g,u)){if(l(m,r)){if(l(f[0],d[0]))if(Math.min(f[1],d[1])<Math.max(c[1],
a[1])||Math.max(f[1],d[1])>Math.min(c[1],a[1]))f=(f[1]+d[1]+c[1]+a[1]-Math.min(f[1],d[1],c[1],a[1])-Math.max(f[1],d[1],c[1],a[1]))/2,b=(f-m)/g;else return null;else if(Math.min(f[0],d[0])<Math.max(c[0],a[0])||Math.max(f[0],d[0])>Math.min(c[0],a[0]))b=(f[0]+d[0]+c[0]+a[0]-Math.min(f[0],d[0],c[0],a[0])-Math.max(f[0],d[0],c[0],a[0]))/2,f=g*b+m;else return null;return[b,f]}return null}l(g,1E10)?(b=f[0],f=u*b+r):l(u,1E10)?(b=c[0],f=g*b+m):(b=-(m-r)/(g-u),f=f[1]===d[1]?f[1]:c[1]===a[1]?c[1]:g*b+m);return[b,
f]}return{getLength:function(f,d){var c=d.x-f.x;f=d.y-f.y;return Math.sqrt(c*c+f*f)},_getLength:function(f,d){var c=d[0]-f[0];f=d[1]-f[1];return Math.sqrt(c*c+f*f)},getPointOnLine:n,getMidpoint:function(f,d){return n(f,d,.5)},_equals:l,_getLineIntersection:h,getLineIntersection:function(f,d,c,a,b){(f=h([f.x,f.y],[d.x,d.y],[c.x,c.y],[a.x,a.y]))&&(f=new q(f[0],f[1],b));return f},_getLineIntersection2:function(f,d){var c=f[0],a=f[1],b=d[0],g=d[1];d=c[0];c=c[1];f=a[0];var a=a[1],u=b[0],m=b[1],b=g[0]-
u,u=d-u,r=f-d,g=g[1]-m,m=c-m,t=a-c,v=g*r-b*t;if(0===v)return!1;b=(b*m-g*u)/v;u=(r*m-t*u)/v;return 0<=b&&1>=b&&0<=u&&1>=u?[d+b*(f-d),c+b*(a-c)]:!1},_pointLineDistance:function(f,d){var c=d[0],a=d[1];d=c[0];var b=c[1],c=f[0];f=f[1];var g=a[0]-d,u=a[1]-b,m=c-d,r=f-b,a=Math.sqrt,t=Math.pow,v=a(t(g,2)+t(u,2)),m=(m*g+r*u)/(v*v),b=b+m*u;return a(t(c-(d+m*g),2)+t(f-b,2))}}})},"esri/PluginTarget":function(){define("require dojo/aspect dojo/_base/array dojo/_base/lang dojo/Deferred dojo/when".split(" "),function(k,
e,p,q,n,l){function h(){e.after(this.constructor._meta,"ctor",this._pluginsHandler,!0);this._plugins={}}h.prototype={addPlugin:function(f,d){var c=this,a=this._plugins,b=new n;try{k([f],function(g){f in a?b.resolve({id:a[f].declaredId||f.replace(/\//g,".")}):(a[f]=g,l(g.add(c,d),function(){var a={id:g.declaredId||f.replace(/\//g,".")};c.emit("plugin-add",a);b.resolve(a)},function(a){b.reject(a)}))})}catch(g){b.reject(g)}return b.promise},removePlugin:function(f){if(f in this._plugins){var d=this._plugins[f];
d.remove(this);delete this._plugins[f];this.emit("plugin-remove",{id:d.declaredId||f.replace(/\//g,".")})}},_pluginsHandler:function(){var f=this;p.some(arguments,function(d){if(d&&d.plugins&&d.plugins instanceof Array){d=d.plugins;var c,a,b;for(b=0;b<d.length;b++)c=d[b],a=c instanceof Object?c.id:c,f.addPlugin(a,c.options);return!0}})}};return h})},"esri/arcade/Dictionary":function(){define(["require","exports","./languageUtils","../geometry/Geometry","./ImmutableArray"],function(k,e,p,q,n){return function(){function l(h){this.attributes=
null;this.plain=!1;this.immutable=!0;this.attributes=h instanceof l?h.attributes:void 0===h?{}:null===h?{}:h}l.prototype.field=function(h){var f=h.toLowerCase();h=this.attributes[h];if(void 0!==h)return h;for(var d in this.attributes)if(d.toLowerCase()===f)return this.attributes[d];throw Error("Field not Found");};l.prototype.setField=function(h,f){if(this.immutable)throw Error("Dictionary is Immutable");var d=h.toLowerCase();if(void 0===this.attributes[h])for(var c in this.attributes)if(c.toLowerCase()===
d){this.attributes[c]=f;return}this.attributes[h]=f};l.prototype.hasField=function(h){var f=h.toLowerCase();if(void 0!==this.attributes[h])return!0;for(var d in this.attributes)if(d.toLowerCase()===f)return!0;return!1};l.prototype.keys=function(){var h=[],f;for(f in this.attributes)h.push(f);return h=h.sort()};l.prototype.castToText=function(){var h="",f;for(f in this.attributes){""!==h&&(h+=",");var d=this.attributes[f];null==d?h+=JSON.stringify(f)+":null":p.isBoolean(d)||p.isNumber(d)||p.isString(d)?
h+=JSON.stringify(f)+":"+JSON.stringify(d):d instanceof q?h+=JSON.stringify(f)+":"+p.toStringExplicit(d):d instanceof n?h+=JSON.stringify(f)+":"+p.toStringExplicit(d):d instanceof Array?h+=JSON.stringify(f)+":"+p.toStringExplicit(d):d instanceof Date?h+=JSON.stringify(f)+":"+JSON.stringify(d):null!==d&&"object"===typeof d&&void 0!==d.castToText&&(h+=JSON.stringify(f)+":"+d.castToText())}return"{"+h+"}"};return l}()})},"esri/arcade/languageUtils":function(){define("require exports ../geometry/Geometry ../moment dojo/number ./ImmutableArray ../kernel ./ImmutablePointArray ./ImmutablePathArray dojo/_base/array ../geometry/Point ../geometry/Polyline ../geometry/Polygon ../geometry/Extent ../geometry/Multipoint ./FunctionWrapper".split(" "),
function(k,e,p,q,n,l,h,f,d,c,a,b,g,u,m,r){function t(a,b,c){if(""===b||null===b||void 0===b||b===c||b===c)return a;do a=a.replace(b,c);while(-1!==a.indexOf(b));return a}function v(a){return a instanceof O||a instanceof r||a instanceof S}function y(a){return"string"===typeof a||a instanceof String}function w(a){return"boolean"===typeof a}function z(a){return"number"===typeof a}function x(a){return a instanceof Array}function A(a){return a instanceof Date}function C(a,b){if(!1===isNaN(a)){if(void 0===
b||null===b||""===b)return a.toString();b=t(b,"\u2030","");b=t(b,"\u00a4","");return n.format(a,{pattern:b})}return a.toString()}function B(a,b){a=q(a);return void 0===b||null===b||""===b?a.format():a.format(E(b))}function E(a){return a.replace(/(LTS)|L|l/g,function(a){return"["+a+"]"})}function D(a,b,c){switch(c){case "\x3e":return a>b;case "\x3c":return a<b;case "\x3e\x3d":return a>=b;case "\x3c\x3d":return a<=b}return!1}function F(b,c){if(b===c||null===b&&c===e.voidOperation||null===c&&b===e.voidOperation)return!0;
if(A(b)&&A(c))return b.getTime()===c.getTime();if(b instanceof d||b instanceof f)return b.equalityTest(c);if(b instanceof a&&c instanceof a){var g=void 0,m=void 0;e.isVersion4?(g=b.cache._arcadeCacheId,m=c.cache._arcadeCacheId):(g=b.getCacheValue("_arcadeCacheId"),m=c.getCacheValue("_arcadeCacheId"));if(void 0!==g&&null!==g)return g===m}return void 0!==b&&void 0!==c&&null!==b&&null!==c&&"object"===typeof b&&"object"===typeof c&&(b._arcadeCacheId===c._arcadeCacheId&&void 0!==b._arcadeCacheId&&null!==
b._arcadeCacheId||b._underlyingGraphic===c._underlyingGraphic&&void 0!==b._underlyingGraphic&&null!==b._underlyingGraphic)?!0:!1}function I(a,b){if(y(a))return a;if(null===a)return"";if(z(a))return C(a,b);if(w(a))return a.toString();if(A(a))return B(a,b);if(a instanceof p)return JSON.stringify(a.toJson());if(x(a)){b=[];for(var c=0;c<a.length;c++)b[c]=L(a[c]);return"["+b.join(",")+"]"}if(a instanceof l){b=[];for(c=0;c<a.length();c++)b[c]=L(a.get(c));return"["+b.join(",")+"]"}return null!==a&&"object"===
typeof a&&void 0!==a.castToText?a.castToText():v(a)?"object, Function":""}function M(a,b){if(y(a))return a;if(null===a)return"";if(z(a))return C(a,b);if(w(a))return a.toString();if(A(a))return B(a,b);if(a instanceof p)return a instanceof u?'{"xmin":'+a.xmin.toString()+',"ymin":'+a.ymin.toString()+","+(a.hasZ?'"zmin":'+a.zmin.toString()+",":"")+(a.hasM?'"mmin":'+a.mmin.toString()+",":"")+'"xmax":'+a.xmax.toString()+',"ymax":'+a.ymax.toString()+","+(a.hasZ?'"zmax":'+a.zmax.toString()+",":"")+(a.hasM?
'"mmax":'+a.mmax.toString()+",":"")+'"spatialReference":'+K(a.spatialReference)+"}":K(a.toJson(),function(a,b){return a.key===b.key?0:"spatialReference"===a.key?1:"spatialReference"===b.key||a.key<b.key?-1:a.key>b.key?1:0});if(x(a)){b=[];for(var c=0;c<a.length;c++)b[c]=L(a[c]);return"["+b.join(",")+"]"}if(a instanceof l){b=[];for(c=0;c<a.length();c++)b[c]=L(a.get(c));return"["+b.join(",")+"]"}return null!==a&&"object"===typeof a&&void 0!==a.castToText?a.castToText():v(a)?"object, Function":""}function L(a){if(null!==
a){if(w(a)||z(a)||y(a))return JSON.stringify(a);if(a instanceof p||a instanceof l||a instanceof Array)return M(a);if(a instanceof Date)return JSON.stringify(B(a,""));if(null!==a&&"object"===typeof a&&void 0!==a.castToText)return a.castToText()}return"null"}function J(a,b){return z(a)?a:null===a||""===a?0:A(a)?NaN:w(a)?a?1:0:x(a)||""===a||void 0===a?NaN:void 0!==b&&y(a)?(b=t(b,"\u2030",""),b=t(b,"\u00a4",""),n.parse(a,{pattern:b})):a===e.voidOperation?0:Number(a)}function P(a,b){var d;c.some(b.fields,
function(b){b.name===a&&(d=b.domain);return!!d});return d}function K(a,b){b||(b={});"function"===typeof b&&(b={cmp:b});var c="boolean"===typeof b.cycles?b.cycles:!1,d=b.cmp&&function(a){return function(b){return function(c,d){return a({key:c,value:b[c]},{key:d,value:b[d]})}}}(b.cmp),g=[];return function Z(a){a&&a.toJson&&"function"===typeof a.toJson&&(a=a.toJson());if(void 0!==a){if("number"===typeof a)return isFinite(a)?""+a:"null";if("object"!==typeof a)return JSON.stringify(a);var b,m;if(Array.isArray(a)){m=
"[";for(b=0;b<a.length;b++)b&&(m+=","),m+=Z(a[b])||"null";return m+"]"}if(null===a)return"null";if(-1!==g.indexOf(a)){if(c)return JSON.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON");}var r=g.push(a)-1,f=Object.keys(a).sort(d&&d(a));m="";for(b=0;b<f.length;b++){var t=f[b],v=Z(a[t]);v&&(m&&(m+=","),m+=JSON.stringify(t)+":"+v)}g.splice(r,1);return"{"+m+"}"}}(a)}Object.defineProperty(e,"__esModule",{value:!0});k=function(){return function(a){this.value=a}}();var U=
function(){return function(a){this.value=a}}(),O=function(){return function(a){this.fn=a}}(),S=function(){return function(a){this.fn=a}}();e.NativeFunction=O;e.ImplicitResult=U;e.ReturnResult=k;e.SizzleFunction=S;e.isVersion4=0===h.version.indexOf("4.");e.voidOperation={type:"VOID"};e.breakResult={type:"BREAK"};e.continueResult={type:"CONTINUE"};e.multiReplace=t;e.isFunctionParameter=v;e.isSimpleType=function(a){return y(a)||z(a)||A(a)||w(a)||null===a||a===e.voidOperation||"number"===typeof a?!0:
!1};e.defaultUndefined=function(a,b){return void 0===a?b:a};e.isString=y;e.isBoolean=w;e.isNumber=z;e.isArray=x;e.isFeatureCursor=function(a){return a&&void 0!==a.isFeatureCursor};e.isImmutableArray=function(a){return a instanceof l};e.isDate=A;e.pcCheck=function(a,b,c){if(a.length<b||a.length>c)throw Error("Function called with wrong number of Parameters");};e.generateUUID=function(){var a=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(b){var c=(a+16*Math.random())%
16|0;a=Math.floor(a/16);return("x"===b?c:c&3|8).toString(16)})};e.formatNumber=C;e.formatDate=B;e.standardiseDateFormat=E;e.greaterThanLessThan=function(a,b,c){if(null===a){if(null===b||b===e.voidOperation)return D(null,null,c);if(z(b))return D(0,b,c);if(y(b)||w(b))return D(0,J(b),c);if(A(b))return D(0,b.getTime(),c)}if(a===e.voidOperation){if(null===b||b===e.voidOperation)return D(null,null,c);if(z(b))return D(0,b,c);if(y(b)||w(b))return D(0,J(b),c);if(A(b))return D(0,b.getTime(),c)}else if(z(a)){if(z(b))return D(a,
b,c);if(w(b))return D(a,J(b),c);if(null===b||b===e.voidOperation)return D(a,0,c);if(y(b))return D(a,J(b),c);if(A(b))return D(a,b.getTime(),c)}else if(y(a)){if(y(b))return D(I(a),I(b),c);if(A(b))return D(J(a),b.getTime(),c);if(z(b))return D(J(a),b,c);if(null===b||b===e.voidOperation)return D(J(a),0,c);if(w(b))return D(J(a),J(b),c)}else if(A(a)){if(A(b))return D(a,b,c);if(null===b||b===e.voidOperation)return D(a.getTime(),0,c);if(z(b))return D(a.getTime(),b,c);if(w(b)||y(b))return D(a.getTime(),J(b),
c)}else if(w(a)){if(w(b))return D(a,b,c);if(z(b))return D(J(a),J(b),c);if(A(b))return D(J(a),b.getTime(),c);if(null===b||b===e.voidOperation)return D(J(a),0,c);if(y(b))return D(J(a),J(b),c)}return!F(a,b)||"\x3c\x3d"!==c&&"\x3e\x3d"!==c?!1:!0};e.equalityTest=F;e.toString=I;e.toNumberArray=function(a){var b=[];if(!1===x(a))return null;if(a instanceof l){for(var c=0;c<a.length();c++)b[c]=J(a.get(c));return b}for(c=0;c<a.length;c++)b[c]=J(a[c]);return b};e.toStringExplicit=M;e.toNumber=J;e.toDate=function(a,
b){return A(a)?a:y(a)&&(a=q(a,[void 0===b||null===b||""===b?q.ISO_8601:b]),a.isValid())?a.toDate():null};e.toDateM=function(a,b){return A(a)?q(a):y(a)&&(a=q(a,[void 0===b||null===b||""===b?q.ISO_8601:b]),a.isValid())?a:null};e.toBoolean=function(a){if(w(a))return a;if(y(a)){if(a=a.toLowerCase(),"true"===a)return!0}else if(z(a))return 0===a||isNaN(a)?!1:!0;return!1};e.fixSpatialReference=function(a,b){if(null===a||void 0===a)return null;if(null===a.spatialReference||void 0===a.spatialReference)a.spatialReference=
b;return a};e.fixNullGeometry=function(c){return null===c?null:c instanceof a?"NaN"===c.x||null===c.x||isNaN(c.x)?null:c:c instanceof g?0===c.rings.length?null:c:c instanceof b?0===c.paths.length?null:c:c instanceof m?0===c.points.length?null:c:c instanceof u?"NaN"===c.xmin||null===c.xmin||isNaN(c.xmin)?null:c:null};e.getDomainValue=function(a,b){if(!a||!a.domain)return null;var c=null;b="string"===a.field.type||"esriFieldTypeString"===a.field.type?I(b):J(b);for(var d=0;d<a.domain.codedValues.length;d++){var g=
a.domain.codedValues[d];g.code===b&&(c=g)}return null===c?null:c.name};e.getDomainCode=function(a,b){if(!a||!a.domain)return null;var c=null;b=I(b);for(var d=0;d<a.domain.codedValues.length;d++){var g=a.domain.codedValues[d];g.name===b&&(c=g)}return null===c?null:c.code};e.getDomain=function(a,b,d,g){void 0===d&&(d=null);if(!b||!b.fields)return null;for(var m=null,r=0;r<b.fields.length;r++){var f=b.fields[r];f.name.toLowerCase()===a.toString().toLowerCase()&&(m=f)}if(null===m)return null;var t,v;
g||(g=d&&b.typeIdField&&d._field(b.typeIdField));null!=g&&c.some(b.types,function(a){return a.id===g?((t=a.domains&&a.domains[m.name])&&"inherited"===t.type&&(t=P(m.name,b),v=!0),!0):!1});v||t||(t=P(a,b));return{field:m,domain:t}};e.stableStringify=K})},"esri/moment":function(){define(["require","exports","./plugins/moment!"],function(k,e,p){return p})},"esri/plugins/moment":function(){define(["require","exports","dojo/_base/kernel","moment/moment"],function(k,e,p,q){Object.defineProperty(e,"__esModule",
{value:!0});var n={ar:1,"ar-dz":1,"ar-kw":1,"ar-ly":1,"ar-ma":1,"ar-sa":1,"ar-tn":1,bs:1,cs:1,da:1,de:1,"de-at":1,"de-ch":1,el:1,"en-au":1,"en-ca":1,"en-gb":1,"en-ie":1,"en-nz":1,es:1,"es-do":1,"es-us":1,et:1,fi:1,fr:1,"fr-ca":1,"fr-ch":1,he:1,hi:1,hr:1,id:1,it:1,ja:1,ko:1,lt:1,lv:1,nb:1,nl:1,"nl-be":1,pl:1,pt:1,"pt-br":1,ro:1,ru:1,sl:1,sr:1,"sr-cyrl":1,sv:1,th:1,tr:1,vi:1,"zh-cn":1,"zh-hk":1,"zh-tw":1};e.load=function(l,h,f){l=p.locale;var d=l in n;if(!d){var c=l.split("-");1<c.length&&c[0]in n&&
(l=c[0],d=!0)}d?h(["moment/locale/"+l],function(){f(q)}):f(q)}})},"moment/moment":function(){(function(k,e){"object"===typeof exports&&"undefined"!==typeof module?module.exports=e():"function"===typeof define&&define.amd?define(e):k.moment=e()})(this,function(){function k(){return Wb.apply(null,arguments)}function e(a){return a instanceof Array||"[object Array]"===Object.prototype.toString.call(a)}function p(a){return null!=a&&"[object Object]"===Object.prototype.toString.call(a)}function q(a){if(Object.getOwnPropertyNames)return 0===
Object.getOwnPropertyNames(a).length;for(var b in a)if(a.hasOwnProperty(b))return!1;return!0}function n(a){return void 0===a}function l(a){return"number"===typeof a||"[object Number]"===Object.prototype.toString.call(a)}function h(a){return a instanceof Date||"[object Date]"===Object.prototype.toString.call(a)}function f(a,b){var c=[],d;for(d=0;d<a.length;++d)c.push(b(a[d],d));return c}function d(a,b){return Object.prototype.hasOwnProperty.call(a,b)}function c(a,b){for(var c in b)d(b,c)&&(a[c]=b[c]);
d(b,"toString")&&(a.toString=b.toString);d(b,"valueOf")&&(a.valueOf=b.valueOf);return a}function a(a,b,c,d){return gb(a,b,c,d,!0).utc()}function b(a){null==a._pf&&(a._pf={empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],meridiem:null,rfc2822:!1,weekdayMismatch:!1});return a._pf}function g(a){if(null==a._isValid){var c=b(a),d=Xb.call(c.parsedDateParts,function(a){return null!=a}),d=!isNaN(a._d.getTime())&&
0>c.overflow&&!c.empty&&!c.invalidMonth&&!c.invalidWeekday&&!c.weekdayMismatch&&!c.nullInput&&!c.invalidFormat&&!c.userInvalidated&&(!c.meridiem||c.meridiem&&d);a._strict&&(d=d&&0===c.charsLeftOver&&0===c.unusedTokens.length&&void 0===c.bigHour);if(null!=Object.isFrozen&&Object.isFrozen(a))return d;a._isValid=d}return a._isValid}function u(d){var g=a(NaN);null!=d?c(b(g),d):b(g).userInvalidated=!0;return g}function m(a,c){var d,g,m;n(c._isAMomentObject)||(a._isAMomentObject=c._isAMomentObject);n(c._i)||
(a._i=c._i);n(c._f)||(a._f=c._f);n(c._l)||(a._l=c._l);n(c._strict)||(a._strict=c._strict);n(c._tzm)||(a._tzm=c._tzm);n(c._isUTC)||(a._isUTC=c._isUTC);n(c._offset)||(a._offset=c._offset);n(c._pf)||(a._pf=b(c));n(c._locale)||(a._locale=c._locale);if(0<Nb.length)for(d=0;d<Nb.length;d++)g=Nb[d],m=c[g],n(m)||(a[g]=m);return a}function r(a){m(this,a);this._d=new Date(null!=a._d?a._d.getTime():NaN);this.isValid()||(this._d=new Date(NaN));!1===Ob&&(Ob=!0,k.updateOffset(this),Ob=!1)}function t(a){return a instanceof
r||null!=a&&null!=a._isAMomentObject}function v(a){return 0>a?Math.ceil(a)||0:Math.floor(a)}function y(a){a=+a;var b=0;0!==a&&isFinite(a)&&(b=v(a));return b}function w(a,b,c){var d=Math.min(a.length,b.length),g=Math.abs(a.length-b.length),m=0,r;for(r=0;r<d;r++)(c&&a[r]!==b[r]||!c&&y(a[r])!==y(b[r]))&&m++;return m+g}function z(a){!1===k.suppressDeprecationWarnings&&"undefined"!==typeof console&&console.warn&&console.warn("Deprecation warning: "+a)}function x(a,b){var d=!0;return c(function(){null!=
k.deprecationHandler&&k.deprecationHandler(null,a);if(d){for(var c=[],g,m=0;m<arguments.length;m++){g="";if("object"===typeof arguments[m]){g+="\n["+m+"] ";for(var r in arguments[0])g+=r+": "+arguments[0][r]+", ";g=g.slice(0,-2)}else g=arguments[m];c.push(g)}z(a+"\nArguments: "+Array.prototype.slice.call(c).join("")+"\n"+Error().stack);d=!1}return b.apply(this,arguments)},b)}function A(a,b){null!=k.deprecationHandler&&k.deprecationHandler(a,b);Yb[a]||(z(b),Yb[a]=!0)}function C(a){return a instanceof
Function||"[object Function]"===Object.prototype.toString.call(a)}function B(a,b){var g=c({},a),m;for(m in b)d(b,m)&&(p(a[m])&&p(b[m])?(g[m]={},c(g[m],a[m]),c(g[m],b[m])):null!=b[m]?g[m]=b[m]:delete g[m]);for(m in a)d(a,m)&&!d(b,m)&&p(a[m])&&(g[m]=c({},g[m]));return g}function E(a){null!=a&&this.set(a)}function D(a,b){var c=a.toLowerCase();rb[c]=rb[c+"s"]=rb[b]=a}function F(a){return"string"===typeof a?rb[a]||rb[a.toLowerCase()]:void 0}function I(a){var b={},c,g;for(g in a)d(a,g)&&(c=F(g))&&(b[c]=
a[g]);return b}function M(a){var b=[],c;for(c in a)b.push({unit:c,priority:Ga[c]});b.sort(function(a,b){return a.priority-b.priority});return b}function L(a,b,c){var d=""+Math.abs(a);return(0<=a?c?"+":"":"-")+Math.pow(10,Math.max(0,b-d.length)).toString().substr(1)+d}function J(a,b,c,d){var g=d;"string"===typeof d&&(g=function(){return this[d]()});a&&(ob[a]=g);b&&(ob[b[0]]=function(){return L(g.apply(this,arguments),b[1],b[2])});c&&(ob[c]=function(){return this.localeData().ordinal(g.apply(this,arguments),
a)})}function P(a){return a.match(/\[[\s\S]/)?a.replace(/^\[|\]$/g,""):a.replace(/\\/g,"")}function K(a){var b=a.match($b),c,d;c=0;for(d=b.length;c<d;c++)b[c]=ob[b[c]]?ob[b[c]]:P(b[c]);return function(c){var g="",m;for(m=0;m<d;m++)g+=C(b[m])?b[m].call(c,a):b[m];return g}}function U(a,b){if(!a.isValid())return a.localeData().invalidDate();b=O(b,a.localeData());Pb[b]=Pb[b]||K(b);return Pb[b](a)}function O(a,b){function c(a){return b.longDateFormat(a)||a}var d=5;for(Eb.lastIndex=0;0<=d&&Eb.test(a);)a=
a.replace(Eb,c),Eb.lastIndex=0,--d;return a}function S(a,b,c){Rb[a]=C(b)?b:function(a,d){return a&&c?c:b}}function Y(a,b){return d(Rb,a)?Rb[a](b._strict,b._locale):new RegExp(N(a))}function N(a){return W(a.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(a,b,c,d,g){return b||c||d||g}))}function W(a){return a.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$\x26")}function ca(a,b){var c,d=b;"string"===typeof a&&(a=[a]);l(b)&&(d=function(a,c){c[b]=y(a)});for(c=0;c<a.length;c++)Sb[a[c]]=d}
function ha(a,b){ca(a,function(a,c,d,g){d._w=d._w||{};b(a,d._w,d,g)})}function fa(a){return 0===a%4&&0!==a%100||0===a%400}function Z(a,b){return function(c){return null!=c?(ia(this,a,c),k.updateOffset(this,b),this):G(this,a)}}function G(a,b){return a.isValid()?a._d["get"+(a._isUTC?"UTC":"")+b]():NaN}function ia(a,b,c){if(a.isValid()&&!isNaN(c))if("FullYear"===b&&fa(a.year())&&1===a.month()&&29===a.date())a._d["set"+(a._isUTC?"UTC":"")+b](c,a.month(),sa(c,a.month()));else a._d["set"+(a._isUTC?"UTC":
"")+b](c)}function sa(a,b){if(isNaN(a)||isNaN(b))return NaN;var c=(b%12+12)%12;return 1===c?fa(a+(b-c)/12)?29:28:31-c%7%2}function wa(a,b){var c;if(!a.isValid())return a;if("string"===typeof b)if(/^\d+$/.test(b))b=y(b);else if(b=a.localeData().monthsParse(b),!l(b))return a;c=Math.min(a.date(),sa(a.year(),b));a._d["set"+(a._isUTC?"UTC":"")+"Month"](b,c);return a}function ua(a){return null!=a?(wa(this,a),k.updateOffset(this,!0),this):G(this,"Month")}function ma(){function b(a,b){return b.length-a.length}
var c=[],d=[],g=[],m,r;for(m=0;12>m;m++)r=a([2E3,m]),c.push(this.monthsShort(r,"")),d.push(this.months(r,"")),g.push(this.months(r,"")),g.push(this.monthsShort(r,""));c.sort(b);d.sort(b);g.sort(b);for(m=0;12>m;m++)c[m]=W(c[m]),d[m]=W(d[m]);for(m=0;24>m;m++)g[m]=W(g[m]);this._monthsShortRegex=this._monthsRegex=new RegExp("^("+g.join("|")+")","i");this._monthsStrictRegex=new RegExp("^("+d.join("|")+")","i");this._monthsShortStrictRegex=new RegExp("^("+c.join("|")+")","i")}function ja(a,b,c,d,g,m,r){b=
new Date(a,b,c,d,g,m,r);100>a&&0<=a&&isFinite(b.getFullYear())&&b.setFullYear(a);return b}function va(a){var b=new Date(Date.UTC.apply(null,arguments));100>a&&0<=a&&isFinite(b.getUTCFullYear())&&b.setUTCFullYear(a);return b}function la(a,b,c){c=7+b-c;return-((7+va(a,0,c).getUTCDay()-b)%7)+c-1}function na(a,b,c,d,g){c=(7+c-d)%7;d=la(a,d,g);d=1+7*(b-1)+c+d;0>=d?(b=a-1,a=(fa(b)?366:365)+d):d>(fa(a)?366:365)?(b=a+1,a=d-(fa(a)?366:365)):(b=a,a=d);return{year:b,dayOfYear:a}}function aa(a,b,c){var d=la(a.year(),
b,c),d=Math.floor((a.dayOfYear()-d-1)/7)+1;1>d?(a=a.year()-1,b=d+za(a,b,c)):d>za(a.year(),b,c)?(b=d-za(a.year(),b,c),a=a.year()+1):(a=a.year(),b=d);return{week:b,year:a}}function za(a,b,c){var d=la(a,b,c);b=la(a+1,b,c);return((fa(a)?366:365)-d+b)/7}function Ba(b,c,d){var g,m;b=b.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],g=0;7>g;++g)m=a([2E3,1]).day(g),this._minWeekdaysParse[g]=this.weekdaysMin(m,"").toLocaleLowerCase(),
this._shortWeekdaysParse[g]=this.weekdaysShort(m,"").toLocaleLowerCase(),this._weekdaysParse[g]=this.weekdays(m,"").toLocaleLowerCase();if(d)c="dddd"===c?Ea.call(this._weekdaysParse,b):"ddd"===c?Ea.call(this._shortWeekdaysParse,b):Ea.call(this._minWeekdaysParse,b);else if("dddd"===c){c=Ea.call(this._weekdaysParse,b);if(-1!==c)return c;c=Ea.call(this._shortWeekdaysParse,b);if(-1!==c)return c;c=Ea.call(this._minWeekdaysParse,b)}else if("ddd"===c){c=Ea.call(this._shortWeekdaysParse,b);if(-1!==c)return c;
c=Ea.call(this._weekdaysParse,b);if(-1!==c)return c;c=Ea.call(this._minWeekdaysParse,b)}else{c=Ea.call(this._minWeekdaysParse,b);if(-1!==c)return c;c=Ea.call(this._weekdaysParse,b);if(-1!==c)return c;c=Ea.call(this._shortWeekdaysParse,b)}return-1!==c?c:null}function ta(){function b(a,b){return b.length-a.length}var c=[],d=[],g=[],m=[],r,f,t,v;for(r=0;7>r;r++)f=a([2E3,1]).day(r),t=this.weekdaysMin(f,""),v=this.weekdaysShort(f,""),f=this.weekdays(f,""),c.push(t),d.push(v),g.push(f),m.push(t),m.push(v),
m.push(f);c.sort(b);d.sort(b);g.sort(b);m.sort(b);for(r=0;7>r;r++)d[r]=W(d[r]),g[r]=W(g[r]),m[r]=W(m[r]);this._weekdaysMinRegex=this._weekdaysShortRegex=this._weekdaysRegex=new RegExp("^("+m.join("|")+")","i");this._weekdaysStrictRegex=new RegExp("^("+g.join("|")+")","i");this._weekdaysShortStrictRegex=new RegExp("^("+d.join("|")+")","i");this._weekdaysMinStrictRegex=new RegExp("^("+c.join("|")+")","i")}function oa(){return this.hours()%12||12}function Da(a,b){J(a,0,0,function(){return this.localeData().meridiem(this.hours(),
this.minutes(),b)})}function Oa(a,b){return b._meridiemParse}function Ma(a){return a?a.toLowerCase().replace("_","-"):a}function Fa(a){var b=null;if(!Ha[a]&&"undefined"!==typeof module&&module&&module.exports)try{b=Hb._abbr,require("./locale/"+a),Ca(b)}catch(Wc){}return Ha[a]}function Ca(a,b){a&&(a=n(b)?Ka(a):Ja(a,b))&&(Hb=a);return Hb._abbr}function Ja(a,b){if(null!==b){var c=ec;b.abbr=a;if(null!=Ha[a])A("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),
c=Ha[a]._config;else if(null!=b.parentLocale)if(null!=Ha[b.parentLocale])c=Ha[b.parentLocale]._config;else return Ab[b.parentLocale]||(Ab[b.parentLocale]=[]),Ab[b.parentLocale].push({name:a,config:b}),null;Ha[a]=new E(B(c,b));Ab[a]&&Ab[a].forEach(function(a){Ja(a.name,a.config)});Ca(a);return Ha[a]}delete Ha[a];return null}function Ka(a){var b;a&&a._locale&&a._locale._abbr&&(a=a._locale._abbr);if(!a)return Hb;if(!e(a)){if(b=Fa(a))return b;a=[a]}a:{b=0;for(var c,d,g,m;b<a.length;){m=Ma(a[b]).split("-");
c=m.length;for(d=(d=Ma(a[b+1]))?d.split("-"):null;0<c;){if(g=Fa(m.slice(0,c).join("-"))){a=g;break a}if(d&&d.length>=c&&w(m,d,!0)>=c-1)break;c--}b++}a=null}return a}function Va(a){var c;(c=a._a)&&-2===b(a).overflow&&(c=0>c[db]||11<c[db]?db:1>c[bb]||c[bb]>sa(c[Xa],c[db])?bb:0>c[Ia]||24<c[Ia]||24===c[Ia]&&(0!==c[Ya]||0!==c[eb]||0!==c[lb])?Ia:0>c[Ya]||59<c[Ya]?Ya:0>c[eb]||59<c[eb]?eb:0>c[lb]||999<c[lb]?lb:-1,b(a)._overflowDayOfYear&&(c<Xa||c>bb)&&(c=bb),b(a)._overflowWeeks&&-1===c&&(c=mc),b(a)._overflowWeekday&&
-1===c&&(c=nc),b(a).overflow=c);return a}function Na(a,b,c){return null!=a?a:null!=b?b:c}function Qa(a){var c,d=[],g;if(!a._d){g=new Date(k.now());g=a._useUTC?[g.getUTCFullYear(),g.getUTCMonth(),g.getUTCDate()]:[g.getFullYear(),g.getMonth(),g.getDate()];if(a._w&&null==a._a[bb]&&null==a._a[db]){var m,r,f,t,v,u;m=a._w;if(null!=m.GG||null!=m.W||null!=m.E){if(v=1,u=4,r=Na(m.GG,a._a[Xa],aa(R(),1,4).year),f=Na(m.W,1),t=Na(m.E,1),1>t||7<t)c=!0}else if(v=a._locale._week.dow,u=a._locale._week.doy,f=aa(R(),
v,u),r=Na(m.gg,a._a[Xa],f.year),f=Na(m.w,f.week),null!=m.d){if(t=m.d,0>t||6<t)c=!0}else if(null!=m.e){if(t=m.e+v,0>m.e||6<m.e)c=!0}else t=v;1>f||f>za(r,v,u)?b(a)._overflowWeeks=!0:null!=c?b(a)._overflowWeekday=!0:(c=na(r,f,t,v,u),a._a[Xa]=c.year,a._dayOfYear=c.dayOfYear)}if(null!=a._dayOfYear){c=Na(a._a[Xa],g[Xa]);if(a._dayOfYear>(fa(c)?366:365)||0===a._dayOfYear)b(a)._overflowDayOfYear=!0;c=va(c,0,a._dayOfYear);a._a[db]=c.getUTCMonth();a._a[bb]=c.getUTCDate()}for(c=0;3>c&&null==a._a[c];++c)a._a[c]=
d[c]=g[c];for(;7>c;c++)a._a[c]=d[c]=null==a._a[c]?2===c?1:0:a._a[c];24===a._a[Ia]&&0===a._a[Ya]&&0===a._a[eb]&&0===a._a[lb]&&(a._nextDay=!0,a._a[Ia]=0);a._d=(a._useUTC?va:ja).apply(null,d);null!=a._tzm&&a._d.setUTCMinutes(a._d.getUTCMinutes()-a._tzm);a._nextDay&&(a._a[Ia]=24);a._w&&"undefined"!==typeof a._w.d&&a._w.d!==a._d.getDay()&&(b(a).weekdayMismatch=!0)}}function T(a){var c,d;c=a._i;var g=oc.exec(c)||pc.exec(c),m,r,f,t;if(g){b(a).iso=!0;c=0;for(d=Ib.length;c<d;c++)if(Ib[c][1].exec(g[1])){r=
Ib[c][0];m=!1!==Ib[c][2];break}if(null==r)a._isValid=!1;else{if(g[3]){c=0;for(d=Tb.length;c<d;c++)if(Tb[c][1].exec(g[3])){f=(g[2]||" ")+Tb[c][0];break}if(null==f){a._isValid=!1;return}}if(m||null==f){if(g[4])if(qc.exec(g[4]))t="Z";else{a._isValid=!1;return}a._f=r+(f||"")+(t||"");da(a)}else a._isValid=!1}}else a._isValid=!1}function La(a){var c=rc.exec(a._i.replace(/\([^)]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").trim());if(c){var d=c[3],g=c[2],m=c[5],r=c[6],f=c[7],t=parseInt(c[4],10),d=[49>=t?2E3+
t:999>=t?1900+t:t,fc.indexOf(d),parseInt(g,10),parseInt(m,10),parseInt(r,10)];f&&d.push(parseInt(f,10));a:{if(f=c[1])if(f=gc.indexOf(f),g=(new Date(d[0],d[1],d[2])).getDay(),f!==g){b(a).weekdayMismatch=!0;f=a._isValid=!1;break a}f=!0}f&&(a._a=d,(f=c[8])?c=sc[f]:c[9]?c=0:(c=parseInt(c[10],10),f=c%100,c=(c-f)/100*60+f),a._tzm=c,a._d=va.apply(null,a._a),a._d.setUTCMinutes(a._d.getUTCMinutes()-a._tzm),b(a).rfc2822=!0)}else a._isValid=!1}function xa(a){var b=tc.exec(a._i);null!==b?a._d=new Date(+b[1]):
(T(a),!1===a._isValid&&(delete a._isValid,La(a),!1===a._isValid&&(delete a._isValid,k.createFromInputFallback(a))))}function da(a){if(a._f===k.ISO_8601)T(a);else if(a._f===k.RFC_2822)La(a);else{a._a=[];b(a).empty=!0;var c=""+a._i,g,m,r,f,t,v=c.length,u=0;r=O(a._f,a._locale).match($b)||[];for(g=0;g<r.length;g++){f=r[g];if(m=(c.match(Y(f,a))||[])[0])t=c.substr(0,c.indexOf(m)),0<t.length&&b(a).unusedInput.push(t),c=c.slice(c.indexOf(m)+m.length),u+=m.length;if(ob[f]){if(m?b(a).empty=!1:b(a).unusedTokens.push(f),
t=a,null!=m&&d(Sb,f))Sb[f](m,t._a,t,f)}else a._strict&&!m&&b(a).unusedTokens.push(f)}b(a).charsLeftOver=v-u;0<c.length&&b(a).unusedInput.push(c);12>=a._a[Ia]&&!0===b(a).bigHour&&0<a._a[Ia]&&(b(a).bigHour=void 0);b(a).parsedDateParts=a._a.slice(0);b(a).meridiem=a._meridiem;c=a._a;g=Ia;v=a._locale;r=a._a[Ia];u=a._meridiem;null!=u&&(null!=v.meridiemHour?r=v.meridiemHour(r,u):null!=v.isPM&&((v=v.isPM(u))&&12>r&&(r+=12),v||12!==r||(r=0)));c[g]=r;Qa(a);Va(a)}}function Wa(a){if(!a._d){var b=I(a._i);a._a=
f([b.year,b.month,b.day||b.date,b.hour,b.minute,b.second,b.millisecond],function(a){return a&&parseInt(a,10)});Qa(a)}}function Sa(a){var d=a._i,f=a._f;a._locale=a._locale||Ka(a._l);if(null===d||void 0===f&&""===d)return u({nullInput:!0});"string"===typeof d&&(a._i=d=a._locale.preparse(d));if(t(d))return new r(Va(d));if(h(d))a._d=d;else if(e(f)){var v,w,l;if(0===a._f.length)b(a).invalidFormat=!0,a._d=new Date(NaN);else{for(d=0;d<a._f.length;d++)if(f=0,v=m({},a),null!=a._useUTC&&(v._useUTC=a._useUTC),
v._f=a._f[d],da(v),g(v)&&(f+=b(v).charsLeftOver,f+=10*b(v).unusedTokens.length,b(v).score=f,null==l||f<l))l=f,w=v;c(a,w||v)}}else f?da(a):ka(a);g(a)||(a._d=null);return a}function ka(a){var b=a._i;n(b)?a._d=new Date(k.now()):h(b)?a._d=new Date(b.valueOf()):"string"===typeof b?xa(a):e(b)?(a._a=f(b.slice(0),function(a){return parseInt(a,10)}),Qa(a)):p(b)?Wa(a):l(b)?a._d=new Date(b):k.createFromInputFallback(a)}function gb(a,b,c,d,g){var m={};if(!0===c||!1===c)d=c,c=void 0;if(p(a)&&q(a)||e(a)&&0===a.length)a=
void 0;m._isAMomentObject=!0;m._useUTC=m._isUTC=g;m._l=c;m._i=a;m._f=b;m._strict=d;a=new r(Va(Sa(m)));a._nextDay&&(a.add(1,"d"),a._nextDay=void 0);return a}function R(a,b,c,d){return gb(a,b,c,d,!1)}function qa(a,b){var c,d;1===b.length&&e(b[0])&&(b=b[0]);if(!b.length)return R();c=b[0];for(d=1;d<b.length;++d)if(!b[d].isValid()||b[d][a](c))c=b[d];return c}function H(a){for(var b in a)if(-1===Ea.call(Bb,b)||null!=a[b]&&isNaN(a[b]))return!1;b=!1;for(var c=0;c<Bb.length;++c)if(a[Bb[c]]){if(b)return!1;
parseFloat(a[Bb[c]])!==y(a[Bb[c]])&&(b=!0)}return!0}function ea(a){a=I(a);var b=a.year||0,c=a.quarter||0,d=a.month||0,g=a.week||0,m=a.day||0,r=a.hour||0,f=a.minute||0,t=a.second||0,v=a.millisecond||0;this._isValid=H(a);this._milliseconds=+v+1E3*t+6E4*f+36E5*r;this._days=+m+7*g;this._months=+d+3*c+12*b;this._data={};this._locale=Ka();this._bubble()}function ga(a){return a instanceof ea}function pa(a){return 0>a?-1*Math.round(-1*a):Math.round(a)}function X(a,b){J(a,0,0,function(){var a=this.utcOffset(),
c="+";0>a&&(a=-a,c="-");return c+L(~~(a/60),2)+b+L(~~a%60,2)})}function ba(a,b){a=(b||"").match(a);if(null===a)return null;a=((a[a.length-1]||[])+"").match(uc)||["-",0,0];b=+(60*a[1])+y(a[2]);return 0===b?0:"+"===a[0]?b:-b}function Q(a,b){return b._isUTC?(b=b.clone(),a=(t(a)||h(a)?a.valueOf():R(a).valueOf())-b.valueOf(),b._d.setTime(b._d.valueOf()+a),k.updateOffset(b,!1),b):R(a).local()}function zb(){return this.isValid()?this._isUTC&&0===this._offset:!1}function Pa(a,b){var c=a,g=null;ga(a)?c={ms:a._milliseconds,
d:a._days,M:a._months}:l(a)?(c={},b?c[b]=a:c.milliseconds=a):(g=vc.exec(a))?(c="-"===g[1]?-1:1,c={y:0,d:y(g[bb])*c,h:y(g[Ia])*c,m:y(g[Ya])*c,s:y(g[eb])*c,ms:y(pa(1E3*g[lb]))*c}):(g=wc.exec(a))?(c="-"===g[1]?-1:1,c={y:Za(g[2],c),M:Za(g[3],c),w:Za(g[4],c),d:Za(g[5],c),h:Za(g[6],c),m:Za(g[7],c),s:Za(g[8],c)}):null==c?c={}:"object"===typeof c&&("from"in c||"to"in c)&&(g=R(c.from),c=R(c.to),g.isValid()&&c.isValid()?(c=Q(c,g),g.isBefore(c)?c=xb(g,c):(c=xb(c,g),c.milliseconds=-c.milliseconds,c.months=-c.months),
g=c):g={milliseconds:0,months:0},c={},c.ms=g.milliseconds,c.M=g.months);c=new ea(c);ga(a)&&d(a,"_locale")&&(c._locale=a._locale);return c}function Za(a,b){a=a&&parseFloat(a.replace(",","."));return(isNaN(a)?0:a)*b}function xb(a,b){var c={milliseconds:0,months:0};c.months=b.month()-a.month()+12*(b.year()-a.year());a.clone().add(c.months,"M").isAfter(b)&&--c.months;c.milliseconds=+b-+a.clone().add(c.months,"M");return c}function $a(a,b){return function(c,d){var g;null===d||isNaN(+d)||(A(b,"moment()."+
b+"(period, number) is deprecated. Please use moment()."+b+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),g=c,c=d,d=g);c=Pa("string"===typeof c?+c:c,d);sb(this,c,a);return this}}function sb(a,b,c,d){var g=b._milliseconds,m=pa(b._days);b=pa(b._months);a.isValid()&&(d=null==d?!0:d,b&&wa(a,G(a,"Month")+b*c),m&&ia(a,"Date",G(a,"Date")+m*c),g&&a._d.setTime(a._d.valueOf()+g*c),d&&k.updateOffset(a,m||b))}function pb(a,b){var c=12*(b.year()-a.year())+(b.month()-
a.month()),d=a.clone().add(c,"months");0>b-d?(a=a.clone().add(c-1,"months"),b=(b-d)/(d-a)):(a=a.clone().add(c+1,"months"),b=(b-d)/(a-d));return-(c+b)||0}function ub(a){if(void 0===a)return this._locale._abbr;a=Ka(a);null!=a&&(this._locale=a);return this}function tb(){return this._locale}function Ua(a,b){J(0,[a,a.length],0,b)}function yb(a,b,c,d,g){var m;if(null==a)return aa(this,d,g).year;m=za(a,d,g);b>m&&(b=m);a=na(a,b,c,d,g);a=va(a.year,0,a.dayOfYear);this.year(a.getUTCFullYear());this.month(a.getUTCMonth());
this.date(a.getUTCDate());return this}function nb(a,b){b[lb]=y(1E3*("0."+a))}function Ta(a){return a}function kb(b,c,d,g){var m=Ka();c=a().set(g,c);return m[d](c,b)}function vb(a,b,c){l(a)&&(b=a,a=void 0);a=a||"";if(null!=b)return kb(a,b,c,"month");var d=[];for(b=0;12>b;b++)d[b]=kb(a,b,c,"month");return d}function qb(a,b,c,d){"boolean"!==typeof a&&(c=b=a,a=!1);l(b)&&(c=b,b=void 0);b=b||"";var g=Ka();a=a?g._week.dow:0;if(null!=c)return kb(b,(c+a)%7,d,"day");g=[];for(c=0;7>c;c++)g[c]=kb(b,(c+a)%7,d,
"day");return g}function wb(a,b,c,d){b=Pa(b,c);a._milliseconds+=d*b._milliseconds;a._days+=d*b._days;a._months+=d*b._months;return a._bubble()}function Gb(a){return 0>a?Math.floor(a):Math.ceil(a)}function ab(a){return function(){return this.as(a)}}function jb(a){return function(){return this.isValid()?this._data[a]:NaN}}function lc(a,b,c,d,g){return g.relativeTime(b||1,!!c,a,d)}function mb(a){return(0<a)-(0>a)||+a}function Db(){if(!this.isValid())return this.localeData().invalidDate();var a=Ub(this._milliseconds)/
1E3,b=Ub(this._days),c=Ub(this._months),d,g;d=v(a/60);g=v(d/60);a%=60;d%=60;var m=v(c/12),c=c%12,a=a?a.toFixed(3).replace(/\.?0+$/,""):"",r=this.asSeconds();if(!r)return"P0D";var f=0>r?"-":"",t=mb(this._months)!==mb(r)?"-":"",u=mb(this._days)!==mb(r)?"-":"",r=mb(this._milliseconds)!==mb(r)?"-":"";return f+"P"+(m?t+m+"Y":"")+(c?t+c+"M":"")+(b?u+b+"D":"")+(g||d||a?"T":"")+(g?r+g+"H":"")+(d?r+d+"M":"")+(a?r+a+"S":"")}var Wb,Xb;Xb=Array.prototype.some?Array.prototype.some:function(a){for(var b=Object(this),
c=b.length>>>0,d=0;d<c;d++)if(d in b&&a.call(this,b[d],d,b))return!0;return!1};var Nb=k.momentProperties=[],Ob=!1,Yb={};k.suppressDeprecationWarnings=!1;k.deprecationHandler=null;var Zb;Zb=Object.keys?Object.keys:function(a){var b,c=[];for(b in a)d(a,b)&&c.push(b);return c};var rb={},Ga={},$b=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,Eb=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,
Pb={},ob={},ac=/\d/,Ra=/\d\d/,dc=/\d{3}/,Qb=/\d{4}/,Fb=/[+-]?\d{6}/,Aa=/\d\d?/,bc=/\d\d\d\d?/,cc=/\d\d\d\d\d\d?/,Jb=/\d{1,3}/,Vb=/\d{1,4}/,Kb=/[+-]?\d{1,6}/,xc=/\d+/,Lb=/[+-]?\d+/,yc=/Z|[+-]\d\d:?\d\d/gi,Mb=/Z|[+-]\d\d(?::?\d\d)?/gi,Cb=/[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i,Rb={},Sb={},Xa=0,db=1,bb=2,Ia=3,Ya=4,eb=5,lb=6,mc=7,nc=8;J("Y",0,0,function(){var a=this.year();return 9999>=a?""+a:"+"+a});J(0,["YY",2],0,function(){return this.year()%
100});J(0,["YYYY",4],0,"year");J(0,["YYYYY",5],0,"year");J(0,["YYYYYY",6,!0],0,"year");D("year","y");Ga.year=1;S("Y",Lb);S("YY",Aa,Ra);S("YYYY",Vb,Qb);S("YYYYY",Kb,Fb);S("YYYYYY",Kb,Fb);ca(["YYYYY","YYYYYY"],Xa);ca("YYYY",function(a,b){b[Xa]=2===a.length?k.parseTwoDigitYear(a):y(a)});ca("YY",function(a,b){b[Xa]=k.parseTwoDigitYear(a)});ca("Y",function(a,b){b[Xa]=parseInt(a,10)});k.parseTwoDigitYear=function(a){return y(a)+(68<y(a)?1900:2E3)};var hc=Z("FullYear",!0),Ea;Ea=Array.prototype.indexOf?Array.prototype.indexOf:
function(a){var b;for(b=0;b<this.length;++b)if(this[b]===a)return b;return-1};J("M",["MM",2],"Mo",function(){return this.month()+1});J("MMM",0,0,function(a){return this.localeData().monthsShort(this,a)});J("MMMM",0,0,function(a){return this.localeData().months(this,a)});D("month","M");Ga.month=8;S("M",Aa);S("MM",Aa,Ra);S("MMM",function(a,b){return b.monthsShortRegex(a)});S("MMMM",function(a,b){return b.monthsRegex(a)});ca(["M","MM"],function(a,b){b[db]=y(a)-1});ca(["MMM","MMMM"],function(a,c,d,g){g=
d._locale.monthsParse(a,g,d._strict);null!=g?c[db]=g:b(d).invalidMonth=a});var ic=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,fc="Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" ");J("w",["ww",2],"wo","week");J("W",["WW",2],"Wo","isoWeek");D("week","w");D("isoWeek","W");Ga.week=5;Ga.isoWeek=5;S("w",Aa);S("ww",Aa,Ra);S("W",Aa);S("WW",Aa,Ra);ha(["w","ww","W","WW"],function(a,b,c,d){b[d.substr(0,1)]=y(a)});J("d",0,"do","day");J("dd",0,0,function(a){return this.localeData().weekdaysMin(this,a)});J("ddd",
0,0,function(a){return this.localeData().weekdaysShort(this,a)});J("dddd",0,0,function(a){return this.localeData().weekdays(this,a)});J("e",0,0,"weekday");J("E",0,0,"isoWeekday");D("day","d");D("weekday","e");D("isoWeekday","E");Ga.day=11;Ga.weekday=11;Ga.isoWeekday=11;S("d",Aa);S("e",Aa);S("E",Aa);S("dd",function(a,b){return b.weekdaysMinRegex(a)});S("ddd",function(a,b){return b.weekdaysShortRegex(a)});S("dddd",function(a,b){return b.weekdaysRegex(a)});ha(["dd","ddd","dddd"],function(a,c,d,g){g=
d._locale.weekdaysParse(a,g,d._strict);null!=g?c.d=g:b(d).invalidWeekday=a});ha(["d","e","E"],function(a,b,c,d){b[d]=y(a)});var gc="Sun Mon Tue Wed Thu Fri Sat".split(" ");J("H",["HH",2],0,"hour");J("h",["hh",2],0,oa);J("k",["kk",2],0,function(){return this.hours()||24});J("hmm",0,0,function(){return""+oa.apply(this)+L(this.minutes(),2)});J("hmmss",0,0,function(){return""+oa.apply(this)+L(this.minutes(),2)+L(this.seconds(),2)});J("Hmm",0,0,function(){return""+this.hours()+L(this.minutes(),2)});J("Hmmss",
0,0,function(){return""+this.hours()+L(this.minutes(),2)+L(this.seconds(),2)});Da("a",!0);Da("A",!1);D("hour","h");Ga.hour=13;S("a",Oa);S("A",Oa);S("H",Aa);S("h",Aa);S("k",Aa);S("HH",Aa,Ra);S("hh",Aa,Ra);S("kk",Aa,Ra);S("hmm",bc);S("hmmss",cc);S("Hmm",bc);S("Hmmss",cc);ca(["H","HH"],Ia);ca(["k","kk"],function(a,b,c){a=y(a);b[Ia]=24===a?0:a});ca(["a","A"],function(a,b,c){c._isPm=c._locale.isPM(a);c._meridiem=a});ca(["h","hh"],function(a,c,d){c[Ia]=y(a);b(d).bigHour=!0});ca("hmm",function(a,c,d){var g=
a.length-2;c[Ia]=y(a.substr(0,g));c[Ya]=y(a.substr(g));b(d).bigHour=!0});ca("hmmss",function(a,c,d){var g=a.length-4,m=a.length-2;c[Ia]=y(a.substr(0,g));c[Ya]=y(a.substr(g,2));c[eb]=y(a.substr(m));b(d).bigHour=!0});ca("Hmm",function(a,b,c){c=a.length-2;b[Ia]=y(a.substr(0,c));b[Ya]=y(a.substr(c))});ca("Hmmss",function(a,b,c){c=a.length-4;var d=a.length-2;b[Ia]=y(a.substr(0,c));b[Ya]=y(a.substr(c,2));b[eb]=y(a.substr(d))});var zc=Z("Hours",!0),ec={calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",
nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},longDateFormat:{LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},invalidDate:"Invalid date",ordinal:"%d",dayOfMonthOrdinalParse:/\d{1,2}/,relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},
months:"January February March April May June July August September October November December".split(" "),monthsShort:fc,week:{dow:0,doy:6},weekdays:"Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),weekdaysMin:"Su Mo Tu We Th Fr Sa".split(" "),weekdaysShort:gc,meridiemParse:/[ap]\.?m?\.?/i},Ha={},Ab={},Hb,oc=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,pc=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,
qc=/Z|[+-]\d\d(?::?\d\d)?/,Ib=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/]],Tb=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",
/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],tc=/^\/?Date\((\-?\d+)/i,rc=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,sc={UT:0,GMT:0,EDT:-240,EST:-300,CDT:-300,CST:-360,MDT:-360,MST:-420,PDT:-420,PST:-480};k.createFromInputFallback=x("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged and will be removed in an upcoming major release. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",
function(a){a._d=new Date(a._i+(a._useUTC?" UTC":""))});k.ISO_8601=function(){};k.RFC_2822=function(){};var Ac=x("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var a=R.apply(null,arguments);return this.isValid()&&a.isValid()?a<this?this:a:u()}),Bc=x("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var a=R.apply(null,arguments);return this.isValid()&&a.isValid()?a>this?this:
a:u()}),Bb="year quarter month week day hour minute second millisecond".split(" ");X("Z",":");X("ZZ","");S("Z",Mb);S("ZZ",Mb);ca(["Z","ZZ"],function(a,b,c){c._useUTC=!0;c._tzm=ba(Mb,a)});var uc=/([\+\-]|\d\d)/gi;k.updateOffset=function(){};var vc=/^(\-|\+)?(?:(\d*)[. ])?(\d+)\:(\d+)(?:\:(\d+)(\.\d*)?)?$/,wc=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;Pa.fn=ea.prototype;Pa.invalid=
function(){return Pa(NaN)};var Cc=$a(1,"add"),Dc=$a(-1,"subtract");k.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";k.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";var jc=x("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(a){return void 0===a?this.localeData():this.locale(a)});J(0,["gg",2],0,function(){return this.weekYear()%100});J(0,["GG",2],0,function(){return this.isoWeekYear()%100});Ua("gggg","weekYear");
Ua("ggggg","weekYear");Ua("GGGG","isoWeekYear");Ua("GGGGG","isoWeekYear");D("weekYear","gg");D("isoWeekYear","GG");Ga.weekYear=1;Ga.isoWeekYear=1;S("G",Lb);S("g",Lb);S("GG",Aa,Ra);S("gg",Aa,Ra);S("GGGG",Vb,Qb);S("gggg",Vb,Qb);S("GGGGG",Kb,Fb);S("ggggg",Kb,Fb);ha(["gggg","ggggg","GGGG","GGGGG"],function(a,b,c,d){b[d.substr(0,2)]=y(a)});ha(["gg","GG"],function(a,b,c,d){b[d]=k.parseTwoDigitYear(a)});J("Q",0,"Qo","quarter");D("quarter","Q");Ga.quarter=7;S("Q",ac);ca("Q",function(a,b){b[db]=3*(y(a)-1)});
J("D",["DD",2],"Do","date");D("date","D");Ga.date=9;S("D",Aa);S("DD",Aa,Ra);S("Do",function(a,b){return a?b._dayOfMonthOrdinalParse||b._ordinalParse:b._dayOfMonthOrdinalParseLenient});ca(["D","DD"],bb);ca("Do",function(a,b){b[bb]=y(a.match(Aa)[0],10)});var kc=Z("Date",!0);J("DDD",["DDDD",3],"DDDo","dayOfYear");D("dayOfYear","DDD");Ga.dayOfYear=4;S("DDD",Jb);S("DDDD",dc);ca(["DDD","DDDD"],function(a,b,c){c._dayOfYear=y(a)});J("m",["mm",2],0,"minute");D("minute","m");Ga.minute=14;S("m",Aa);S("mm",Aa,
Ra);ca(["m","mm"],Ya);var Ec=Z("Minutes",!1);J("s",["ss",2],0,"second");D("second","s");Ga.second=15;S("s",Aa);S("ss",Aa,Ra);ca(["s","ss"],eb);var Fc=Z("Seconds",!1);J("S",0,0,function(){return~~(this.millisecond()/100)});J(0,["SS",2],0,function(){return~~(this.millisecond()/10)});J(0,["SSS",3],0,"millisecond");J(0,["SSSS",4],0,function(){return 10*this.millisecond()});J(0,["SSSSS",5],0,function(){return 100*this.millisecond()});J(0,["SSSSSS",6],0,function(){return 1E3*this.millisecond()});J(0,["SSSSSSS",
7],0,function(){return 1E4*this.millisecond()});J(0,["SSSSSSSS",8],0,function(){return 1E5*this.millisecond()});J(0,["SSSSSSSSS",9],0,function(){return 1E6*this.millisecond()});D("millisecond","ms");Ga.millisecond=16;S("S",Jb,ac);S("SS",Jb,Ra);S("SSS",Jb,dc);var hb;for(hb="SSSS";9>=hb.length;hb+="S")S(hb,xc);for(hb="S";9>=hb.length;hb+="S")ca(hb,nb);var Gc=Z("Milliseconds",!1);J("z",0,0,"zoneAbbr");J("zz",0,0,"zoneName");var V=r.prototype;V.add=Cc;V.calendar=function(a,b){a=a||R();var c=Q(a,this).startOf("day"),
c=k.calendarFormat(this,c)||"sameElse";b=b&&(C(b[c])?b[c].call(this,a):b[c]);return this.format(b||this.localeData().calendar(c,this,R(a)))};V.clone=function(){return new r(this)};V.diff=function(a,b,c){var d;if(!this.isValid())return NaN;a=Q(a,this);if(!a.isValid())return NaN;d=6E4*(a.utcOffset()-this.utcOffset());b=F(b);switch(b){case "year":b=pb(this,a)/12;break;case "month":b=pb(this,a);break;case "quarter":b=pb(this,a)/3;break;case "second":b=(this-a)/1E3;break;case "minute":b=(this-a)/6E4;break;
case "hour":b=(this-a)/36E5;break;case "day":b=(this-a-d)/864E5;break;case "week":b=(this-a-d)/6048E5;break;default:b=this-a}return c?b:v(b)};V.endOf=function(a){a=F(a);if(void 0===a||"millisecond"===a)return this;"date"===a&&(a="day");return this.startOf(a).add(1,"isoWeek"===a?"week":a).subtract(1,"ms")};V.format=function(a){a||(a=this.isUtc()?k.defaultFormatUtc:k.defaultFormat);a=U(this,a);return this.localeData().postformat(a)};V.from=function(a,b){return this.isValid()&&(t(a)&&a.isValid()||R(a).isValid())?
Pa({to:this,from:a}).locale(this.locale()).humanize(!b):this.localeData().invalidDate()};V.fromNow=function(a){return this.from(R(),a)};V.to=function(a,b){return this.isValid()&&(t(a)&&a.isValid()||R(a).isValid())?Pa({from:this,to:a}).locale(this.locale()).humanize(!b):this.localeData().invalidDate()};V.toNow=function(a){return this.to(R(),a)};V.get=function(a){a=F(a);return C(this[a])?this[a]():this};V.invalidAt=function(){return b(this).overflow};V.isAfter=function(a,b){a=t(a)?a:R(a);if(!this.isValid()||
!a.isValid())return!1;b=F(n(b)?"millisecond":b);return"millisecond"===b?this.valueOf()>a.valueOf():a.valueOf()<this.clone().startOf(b).valueOf()};V.isBefore=function(a,b){a=t(a)?a:R(a);if(!this.isValid()||!a.isValid())return!1;b=F(n(b)?"millisecond":b);return"millisecond"===b?this.valueOf()<a.valueOf():this.clone().endOf(b).valueOf()<a.valueOf()};V.isBetween=function(a,b,c,d){d=d||"()";return("("===d[0]?this.isAfter(a,c):!this.isBefore(a,c))&&(")"===d[1]?this.isBefore(b,c):!this.isAfter(b,c))};V.isSame=
function(a,b){a=t(a)?a:R(a);if(!this.isValid()||!a.isValid())return!1;b=F(b||"millisecond");if("millisecond"===b)return this.valueOf()===a.valueOf();a=a.valueOf();return this.clone().startOf(b).valueOf()<=a&&a<=this.clone().endOf(b).valueOf()};V.isSameOrAfter=function(a,b){return this.isSame(a,b)||this.isAfter(a,b)};V.isSameOrBefore=function(a,b){return this.isSame(a,b)||this.isBefore(a,b)};V.isValid=function(){return g(this)};V.lang=jc;V.locale=ub;V.localeData=tb;V.max=Bc;V.min=Ac;V.parsingFlags=
function(){return c({},b(this))};V.set=function(a,b){if("object"===typeof a){a=I(a);b=M(a);for(var c=0;c<b.length;c++)this[b[c].unit](a[b[c].unit])}else if(a=F(a),C(this[a]))return this[a](b);return this};V.startOf=function(a){a=F(a);switch(a){case "year":this.month(0);case "quarter":case "month":this.date(1);case "week":case "isoWeek":case "day":case "date":this.hours(0);case "hour":this.minutes(0);case "minute":this.seconds(0);case "second":this.milliseconds(0)}"week"===a&&this.weekday(0);"isoWeek"===
a&&this.isoWeekday(1);"quarter"===a&&this.month(3*Math.floor(this.month()/3));return this};V.subtract=Dc;V.toArray=function(){return[this.year(),this.month(),this.date(),this.hour(),this.minute(),this.second(),this.millisecond()]};V.toObject=function(){return{years:this.year(),months:this.month(),date:this.date(),hours:this.hours(),minutes:this.minutes(),seconds:this.seconds(),milliseconds:this.milliseconds()}};V.toDate=function(){return new Date(this.valueOf())};V.toISOString=function(){if(!this.isValid())return null;
var a=this.clone().utc();return 0>a.year()||9999<a.year()?U(a,"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]"):C(Date.prototype.toISOString)?this.toDate().toISOString():U(a,"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]")};V.inspect=function(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var a="moment",b="";this.isLocal()||(a=0===this.utcOffset()?"moment.utc":"moment.parseZone",b="Z");var a="["+a+'("]',c=0<=this.year()&&9999>=this.year()?"YYYY":"YYYYYY";return this.format(a+c+"-MM-DD[T]HH:mm:ss.SSS"+(b+'[")]'))};
V.toJSON=function(){return this.isValid()?this.toISOString():null};V.toString=function(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")};V.unix=function(){return Math.floor(this.valueOf()/1E3)};V.valueOf=function(){return this._d.valueOf()-6E4*(this._offset||0)};V.creationData=function(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}};V.year=hc;V.isLeapYear=function(){return fa(this.year())};V.weekYear=function(a){return yb.call(this,
a,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)};V.isoWeekYear=function(a){return yb.call(this,a,this.isoWeek(),this.isoWeekday(),1,4)};V.quarter=V.quarters=function(a){return null==a?Math.ceil((this.month()+1)/3):this.month(3*(a-1)+this.month()%3)};V.month=ua;V.daysInMonth=function(){return sa(this.year(),this.month())};V.week=V.weeks=function(a){var b=this.localeData().week(this);return null==a?b:this.add(7*(a-b),"d")};V.isoWeek=V.isoWeeks=function(a){var b=
aa(this,1,4).week;return null==a?b:this.add(7*(a-b),"d")};V.weeksInYear=function(){var a=this.localeData()._week;return za(this.year(),a.dow,a.doy)};V.isoWeeksInYear=function(){return za(this.year(),1,4)};V.date=kc;V.day=V.days=function(a){if(!this.isValid())return null!=a?this:NaN;var b=this._isUTC?this._d.getUTCDay():this._d.getDay();if(null!=a){var c=this.localeData();"string"===typeof a&&(isNaN(a)?(a=c.weekdaysParse(a),a="number"===typeof a?a:null):a=parseInt(a,10));return this.add(a-b,"d")}return b};
V.weekday=function(a){if(!this.isValid())return null!=a?this:NaN;var b=(this.day()+7-this.localeData()._week.dow)%7;return null==a?b:this.add(a-b,"d")};V.isoWeekday=function(a){if(!this.isValid())return null!=a?this:NaN;if(null!=a){var b=this.localeData();a="string"===typeof a?b.weekdaysParse(a)%7||7:isNaN(a)?null:a;return this.day(this.day()%7?a:a-7)}return this.day()||7};V.dayOfYear=function(a){var b=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864E5)+1;return null==a?b:
this.add(a-b,"d")};V.hour=V.hours=zc;V.minute=V.minutes=Ec;V.second=V.seconds=Fc;V.millisecond=V.milliseconds=Gc;V.utcOffset=function(a,b,c){var d=this._offset||0,g;if(!this.isValid())return null!=a?this:NaN;if(null!=a){if("string"===typeof a){if(a=ba(Mb,a),null===a)return this}else 16>Math.abs(a)&&!c&&(a*=60);!this._isUTC&&b&&(g=15*-Math.round(this._d.getTimezoneOffset()/15));this._offset=a;this._isUTC=!0;null!=g&&this.add(g,"m");d!==a&&(!b||this._changeInProgress?sb(this,Pa(a-d,"m"),1,!1):this._changeInProgress||
(this._changeInProgress=!0,k.updateOffset(this,!0),this._changeInProgress=null));return this}return this._isUTC?d:15*-Math.round(this._d.getTimezoneOffset()/15)};V.utc=function(a){return this.utcOffset(0,a)};V.local=function(a){this._isUTC&&(this.utcOffset(0,a),this._isUTC=!1,a&&this.subtract(15*-Math.round(this._d.getTimezoneOffset()/15),"m"));return this};V.parseZone=function(){if(null!=this._tzm)this.utcOffset(this._tzm,!1,!0);else if("string"===typeof this._i){var a=ba(yc,this._i);null!=a?this.utcOffset(a):
this.utcOffset(0,!0)}return this};V.hasAlignedHourOffset=function(a){if(!this.isValid())return!1;a=a?R(a).utcOffset():0;return 0===(this.utcOffset()-a)%60};V.isDST=function(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()};V.isLocal=function(){return this.isValid()?!this._isUTC:!1};V.isUtcOffset=function(){return this.isValid()?this._isUTC:!1};V.isUtc=zb;V.isUTC=zb;V.zoneAbbr=function(){return this._isUTC?"UTC":""};V.zoneName=function(){return this._isUTC?
"Coordinated Universal Time":""};V.dates=x("dates accessor is deprecated. Use date instead.",kc);V.months=x("months accessor is deprecated. Use month instead",ua);V.years=x("years accessor is deprecated. Use year instead",hc);V.zone=x("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",function(a,b){return null!=a?("string"!==typeof a&&(a=-a),this.utcOffset(a,b),this):-this.utcOffset()});V.isDSTShifted=x("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",
function(){if(!n(this._isDSTShifted))return this._isDSTShifted;var b={};m(b,this);b=Sa(b);if(b._a){var c=b._isUTC?a(b._a):R(b._a);this._isDSTShifted=this.isValid()&&0<w(b._a,c.toArray())}else this._isDSTShifted=!1;return this._isDSTShifted});var ya=E.prototype;ya.calendar=function(a,b,c){a=this._calendar[a]||this._calendar.sameElse;return C(a)?a.call(b,c):a};ya.longDateFormat=function(a){var b=this._longDateFormat[a],c=this._longDateFormat[a.toUpperCase()];if(b||!c)return b;this._longDateFormat[a]=
c.replace(/MMMM|MM|DD|dddd/g,function(a){return a.slice(1)});return this._longDateFormat[a]};ya.invalidDate=function(){return this._invalidDate};ya.ordinal=function(a){return this._ordinal.replace("%d",a)};ya.preparse=Ta;ya.postformat=Ta;ya.relativeTime=function(a,b,c,d){var g=this._relativeTime[c];return C(g)?g(a,b,c,d):g.replace(/%d/i,a)};ya.pastFuture=function(a,b){a=this._relativeTime[0<a?"future":"past"];return C(a)?a(b):a.replace(/%s/i,b)};ya.set=function(a){var b,c;for(c in a)b=a[c],C(b)?this[c]=
b:this["_"+c]=b;this._config=a;this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)};ya.months=function(a,b){return a?e(this._months)?this._months[a.month()]:this._months[(this._months.isFormat||ic).test(b)?"format":"standalone"][a.month()]:e(this._months)?this._months:this._months.standalone};ya.monthsShort=function(a,b){return a?e(this._monthsShort)?this._monthsShort[a.month()]:this._monthsShort[ic.test(b)?"format":
"standalone"][a.month()]:e(this._monthsShort)?this._monthsShort:this._monthsShort.standalone};ya.monthsParse=function(b,c,d){var g,m;if(this._monthsParseExact){a:{b=b.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],g=0;12>g;++g)m=a([2E3,g]),this._shortMonthsParse[g]=this.monthsShort(m,"").toLocaleLowerCase(),this._longMonthsParse[g]=this.months(m,"").toLocaleLowerCase();if(d)c="MMM"===c?Ea.call(this._shortMonthsParse,b):Ea.call(this._longMonthsParse,
b);else if("MMM"===c){c=Ea.call(this._shortMonthsParse,b);if(-1!==c)break a;c=Ea.call(this._longMonthsParse,b)}else{c=Ea.call(this._longMonthsParse,b);if(-1!==c)break a;c=Ea.call(this._shortMonthsParse,b)}c=-1!==c?c:null}return c}this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]);for(g=0;12>g;g++)if(m=a([2E3,g]),d&&!this._longMonthsParse[g]&&(this._longMonthsParse[g]=new RegExp("^"+this.months(m,"").replace(".","")+"$","i"),this._shortMonthsParse[g]=new RegExp("^"+
this.monthsShort(m,"").replace(".","")+"$","i")),d||this._monthsParse[g]||(m="^"+this.months(m,"")+"|^"+this.monthsShort(m,""),this._monthsParse[g]=new RegExp(m.replace(".",""),"i")),d&&"MMMM"===c&&this._longMonthsParse[g].test(b)||d&&"MMM"===c&&this._shortMonthsParse[g].test(b)||!d&&this._monthsParse[g].test(b))return g};ya.monthsRegex=function(a){if(this._monthsParseExact)return d(this,"_monthsRegex")||ma.call(this),a?this._monthsStrictRegex:this._monthsRegex;d(this,"_monthsRegex")||(this._monthsRegex=
Cb);return this._monthsStrictRegex&&a?this._monthsStrictRegex:this._monthsRegex};ya.monthsShortRegex=function(a){if(this._monthsParseExact)return d(this,"_monthsRegex")||ma.call(this),a?this._monthsShortStrictRegex:this._monthsShortRegex;d(this,"_monthsShortRegex")||(this._monthsShortRegex=Cb);return this._monthsShortStrictRegex&&a?this._monthsShortStrictRegex:this._monthsShortRegex};ya.week=function(a){return aa(a,this._week.dow,this._week.doy).week};ya.firstDayOfYear=function(){return this._week.doy};
ya.firstDayOfWeek=function(){return this._week.dow};ya.weekdays=function(a,b){return a?e(this._weekdays)?this._weekdays[a.day()]:this._weekdays[this._weekdays.isFormat.test(b)?"format":"standalone"][a.day()]:e(this._weekdays)?this._weekdays:this._weekdays.standalone};ya.weekdaysMin=function(a){return a?this._weekdaysMin[a.day()]:this._weekdaysMin};ya.weekdaysShort=function(a){return a?this._weekdaysShort[a.day()]:this._weekdaysShort};ya.weekdaysParse=function(b,c,d){var g,m;if(this._weekdaysParseExact)return Ba.call(this,
b,c,d);this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]);for(g=0;7>g;g++)if(m=a([2E3,1]).day(g),d&&!this._fullWeekdaysParse[g]&&(this._fullWeekdaysParse[g]=new RegExp("^"+this.weekdays(m,"").replace(".",".?")+"$","i"),this._shortWeekdaysParse[g]=new RegExp("^"+this.weekdaysShort(m,"").replace(".",".?")+"$","i"),this._minWeekdaysParse[g]=new RegExp("^"+this.weekdaysMin(m,"").replace(".",".?")+"$","i")),this._weekdaysParse[g]||
(m="^"+this.weekdays(m,"")+"|^"+this.weekdaysShort(m,"")+"|^"+this.weekdaysMin(m,""),this._weekdaysParse[g]=new RegExp(m.replace(".",""),"i")),d&&"dddd"===c&&this._fullWeekdaysParse[g].test(b)||d&&"ddd"===c&&this._shortWeekdaysParse[g].test(b)||d&&"dd"===c&&this._minWeekdaysParse[g].test(b)||!d&&this._weekdaysParse[g].test(b))return g};ya.weekdaysRegex=function(a){if(this._weekdaysParseExact)return d(this,"_weekdaysRegex")||ta.call(this),a?this._weekdaysStrictRegex:this._weekdaysRegex;d(this,"_weekdaysRegex")||
(this._weekdaysRegex=Cb);return this._weekdaysStrictRegex&&a?this._weekdaysStrictRegex:this._weekdaysRegex};ya.weekdaysShortRegex=function(a){if(this._weekdaysParseExact)return d(this,"_weekdaysRegex")||ta.call(this),a?this._weekdaysShortStrictRegex:this._weekdaysShortRegex;d(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=Cb);return this._weekdaysShortStrictRegex&&a?this._weekdaysShortStrictRegex:this._weekdaysShortRegex};ya.weekdaysMinRegex=function(a){if(this._weekdaysParseExact)return d(this,
"_weekdaysRegex")||ta.call(this),a?this._weekdaysMinStrictRegex:this._weekdaysMinRegex;d(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=Cb);return this._weekdaysMinStrictRegex&&a?this._weekdaysMinStrictRegex:this._weekdaysMinRegex};ya.isPM=function(a){return"p"===(a+"").toLowerCase().charAt(0)};ya.meridiem=function(a,b,c){return 11<a?c?"pm":"PM":c?"am":"AM"};Ca("en",{dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(a){var b=a%10,b=1===y(a%100/10)?"th":1===b?"st":2===b?"nd":3===b?
"rd":"th";return a+b}});k.lang=x("moment.lang is deprecated. Use moment.locale instead.",Ca);k.langData=x("moment.langData is deprecated. Use moment.localeData instead.",Ka);var fb=Math.abs,Hc=ab("ms"),Ic=ab("s"),Jc=ab("m"),Kc=ab("h"),Lc=ab("d"),Mc=ab("w"),Nc=ab("M"),Oc=ab("y"),Pc=jb("milliseconds"),Qc=jb("seconds"),Rc=jb("minutes"),Sc=jb("hours"),Tc=jb("days"),Uc=jb("months"),Vc=jb("years"),ib=Math.round,cb={ss:44,s:45,m:45,h:22,d:26,M:11},Ub=Math.abs,ra=ea.prototype;ra.isValid=function(){return this._isValid};
ra.abs=function(){var a=this._data;this._milliseconds=fb(this._milliseconds);this._days=fb(this._days);this._months=fb(this._months);a.milliseconds=fb(a.milliseconds);a.seconds=fb(a.seconds);a.minutes=fb(a.minutes);a.hours=fb(a.hours);a.months=fb(a.months);a.years=fb(a.years);return this};ra.add=function(a,b){return wb(this,a,b,1)};ra.subtract=function(a,b){return wb(this,a,b,-1)};ra.as=function(a){if(!this.isValid())return NaN;var b,c=this._milliseconds;a=F(a);if("month"===a||"year"===a)return b=
this._days+c/864E5,b=this._months+4800*b/146097,"month"===a?b:b/12;b=this._days+Math.round(146097*this._months/4800);switch(a){case "week":return b/7+c/6048E5;case "day":return b+c/864E5;case "hour":return 24*b+c/36E5;case "minute":return 1440*b+c/6E4;case "second":return 86400*b+c/1E3;case "millisecond":return Math.floor(864E5*b)+c;default:throw Error("Unknown unit "+a);}};ra.asMilliseconds=Hc;ra.asSeconds=Ic;ra.asMinutes=Jc;ra.asHours=Kc;ra.asDays=Lc;ra.asWeeks=Mc;ra.asMonths=Nc;ra.asYears=Oc;ra.valueOf=
function(){return this.isValid()?this._milliseconds+864E5*this._days+this._months%12*2592E6+31536E6*y(this._months/12):NaN};ra._bubble=function(){var a=this._milliseconds,b=this._days,c=this._months,d=this._data;0<=a&&0<=b&&0<=c||0>=a&&0>=b&&0>=c||(a+=864E5*Gb(146097*c/4800+b),c=b=0);d.milliseconds=a%1E3;a=v(a/1E3);d.seconds=a%60;a=v(a/60);d.minutes=a%60;a=v(a/60);d.hours=a%24;b+=v(a/24);a=v(4800*b/146097);c+=a;b-=Gb(146097*a/4800);a=v(c/12);d.days=b;d.months=c%12;d.years=a;return this};ra.clone=
function(){return Pa(this)};ra.get=function(a){a=F(a);return this.isValid()?this[a+"s"]():NaN};ra.milliseconds=Pc;ra.seconds=Qc;ra.minutes=Rc;ra.hours=Sc;ra.days=Tc;ra.weeks=function(){return v(this.days()/7)};ra.months=Uc;ra.years=Vc;ra.humanize=function(a){if(!this.isValid())return this.localeData().invalidDate();var b=this.localeData(),c;c=!a;var d=Pa(this).abs(),g=ib(d.as("s")),m=ib(d.as("m")),r=ib(d.as("h")),f=ib(d.as("d")),t=ib(d.as("M")),d=ib(d.as("y")),g=g<=cb.ss&&["s",g]||g<cb.s&&["ss",g]||
1>=m&&["m"]||m<cb.m&&["mm",m]||1>=r&&["h"]||r<cb.h&&["hh",r]||1>=f&&["d"]||f<cb.d&&["dd",f]||1>=t&&["M"]||t<cb.M&&["MM",t]||1>=d&&["y"]||["yy",d];g[2]=c;g[3]=0<+this;g[4]=b;c=lc.apply(null,g);a&&(c=b.pastFuture(+this,c));return b.postformat(c)};ra.toISOString=Db;ra.toString=Db;ra.toJSON=Db;ra.locale=ub;ra.localeData=tb;ra.toIsoString=x("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",Db);ra.lang=jc;J("X",0,0,"unix");J("x",0,0,"valueOf");S("x",Lb);S("X",/[+-]?\d+(\.\d{1,3})?/);
ca("X",function(a,b,c){c._d=new Date(1E3*parseFloat(a,10))});ca("x",function(a,b,c){c._d=new Date(y(a))});k.version="2.19.2";Wb=R;k.fn=V;k.min=function(){var a=[].slice.call(arguments,0);return qa("isBefore",a)};k.max=function(){var a=[].slice.call(arguments,0);return qa("isAfter",a)};k.now=function(){return Date.now?Date.now():+new Date};k.utc=a;k.unix=function(a){return R(1E3*a)};k.months=function(a,b){return vb(a,b,"months")};k.isDate=h;k.locale=Ca;k.invalid=u;k.duration=Pa;k.isMoment=t;k.weekdays=
function(a,b,c){return qb(a,b,c,"weekdays")};k.parseZone=function(){return R.apply(null,arguments).parseZone()};k.localeData=Ka;k.isDuration=ga;k.monthsShort=function(a,b){return vb(a,b,"monthsShort")};k.weekdaysMin=function(a,b,c){return qb(a,b,c,"weekdaysMin")};k.defineLocale=Ja;k.updateLocale=function(a,b){if(null!=b){var c,d=ec;c=Fa(a);null!=c&&(d=c._config);b=B(d,b);b=new E(b);b.parentLocale=Ha[a];Ha[a]=b;Ca(a)}else null!=Ha[a]&&(null!=Ha[a].parentLocale?Ha[a]=Ha[a].parentLocale:null!=Ha[a]&&
delete Ha[a]);return Ha[a]};k.locales=function(){return Zb(Ha)};k.weekdaysShort=function(a,b,c){return qb(a,b,c,"weekdaysShort")};k.normalizeUnits=F;k.relativeTimeRounding=function(a){return void 0===a?ib:"function"===typeof a?(ib=a,!0):!1};k.relativeTimeThreshold=function(a,b){if(void 0===cb[a])return!1;if(void 0===b)return cb[a];cb[a]=b;"s"===a&&(cb.ss=b-1);return!0};k.calendarFormat=function(a,b){a=a.diff(b,"days",!0);return-6>a?"sameElse":-1>a?"lastWeek":0>a?"lastDay":1>a?"sameDay":2>a?"nextDay":
7>a?"nextWeek":"sameElse"};k.prototype=V;return k})},"esri/arcade/ImmutableArray":function(){define(["require","exports"],function(k,e){return function(){function e(e){void 0===e&&(e=[]);this._elements=e}e.prototype.length=function(){return this._elements.length};e.prototype.get=function(e){return this._elements[e]};e.prototype.toArray=function(){for(var e=[],n=0;n<this.length();n++)e.push(this.get(n));return e};return e}()})},"esri/arcade/ImmutablePointArray":function(){define("require exports ../core/tsSupport/extendsHelper ./ImmutableArray ../geometry/Point ../kernel".split(" "),
function(k,e,p,q,n,l){var h=0===l.version.indexOf("4.");return function(f){function d(c,a,b,d,u,m){c=f.call(this,c)||this;c._lazyPt=[];c._hasZ=!1;c._hasM=!1;c._spRef=a;c._hasZ=b;c._hasM=d;c._cacheId=u;c._partId=m;return c}p(d,f);d.prototype.get=function(c){if(void 0===this._lazyPt[c]){var a=this._elements[c];if(void 0===a)return;var b=this._hasZ,d=this._hasM,f=null,f=b&&!d?new n(a[0],a[1],a[2],void 0,this._spRef):d&&b?new n(a[0],a[1],void 0,a[2],this._spRef):b&&d?new n(a[0],a[1],a[2],a[3],this._spRef):
new n(a[0],a[1],this._spRef);h?f.cache._arcadeCacheId=this._cacheId.toString()+"-"+this._partId.toString()+"-"+c.toString():f.setCacheValue("_arcadeCacheId",this._cacheId.toString()+"-"+this._partId.toString()+"-"+c.toString());this._lazyPt[c]=f}return this._lazyPt[c]};d.prototype.equalityTest=function(c){return c===this?!0:null===c||!1===c instanceof d?!1:c.getUniqueHash()===this.getUniqueHash()};d.prototype.getUniqueHash=function(){return this._cacheId.toString()+"-"+this._partId.toString()};return d}(q)})},
"esri/core/tsSupport/extendsHelper":function(){define([],function(){return function(){var k=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,k){e.__proto__=k}||function(e,k){for(var p in k)k.hasOwnProperty(p)&&(e[p]=k[p])};return function(e,p){function q(){this.constructor=e}k(e,p);e.prototype=null===p?Object.create(p):(q.prototype=p.prototype,new q)}}()})},"esri/arcade/ImmutablePathArray":function(){define(["require","exports","../core/tsSupport/extendsHelper","./ImmutableArray",
"./ImmutablePointArray"],function(k,e,p,q,n){return function(l){function h(f,d,c,a,b){f=l.call(this,f)||this;f._lazyPath=[];f._hasZ=!1;f._hasM=!1;f._hasZ=c;f._hasM=a;f._spRef=d;f._cacheId=b;return f}p(h,l);h.prototype.get=function(f){if(void 0===this._lazyPath[f]){var d=this._elements[f];if(void 0===d)return;this._lazyPath[f]=new n(d,this._spRef,this._hasZ,this._hasM,this._cacheId,f)}return this._lazyPath[f]};h.prototype.equalityTest=function(f){return f===this?!0:null===f||!1===f instanceof h?!1:
f.getUniqueHash()===this.getUniqueHash()};h.prototype.getUniqueHash=function(){return this._cacheId.toString()};return h}(q)})},"esri/geometry/Polyline":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/has ../kernel ../lang ../SpatialReference ./Geometry ./Point ./Extent ../srUtils".split(" "),function(k,e,p,q,n,l,h,f,d,c,a){var b={type:"polyline",paths:null};k=k(f,{declaredClass:"esri.geometry.Polyline",constructor:function(c){p.mixin(this,b);this.paths=[];this._path=0;
c&&(p.isArray(c)?this.paths=p.isArray(c[0][0])?c:[c]:c.paths?p.mixin(this,c):this.spatialReference=c,this.spatialReference&&(this.spatialReference=a.createSpatialReference(this.spatialReference)));this.verifySR()},addPath:function(a){this.clearCache();this._path=this.paths.length;this.paths[this._path]=[];p.isArray(a[0])?e.forEach(a,this._addPointArr,this):e.forEach(a,this._addPoint,this);return this},_addPointArr:function(a){this.paths[this._path].push(a)},_addPoint:function(a){this.paths[this._path].push([a.x,
a.y])},_insertPoints:function(a,b){this.clearCache();this._path=b;this.paths[this._path]||(this.paths[this._path]=[]);e.forEach(a,this._addPoint,this)},_validateInputs:function(a,b){return null!==a&&void 0!==a&&(0>a||a>=this.paths.length)||null!==b&&void 0!==a&&(0>b||b>=this.paths[a].length)?!1:!0},getPoint:function(a,b){if(this._validateInputs(a,b))return new d(this.paths[a][b],this.spatialReference)},setPoint:function(a,b,c){if(this._validateInputs(a,b))return this.clearCache(),this.paths[a][b]=
[c.x,c.y],this},insertPoint:function(a,b,c){if(this._validateInputs(a)&&l.isDefined(b)&&0<=b&&b<=this.paths[a].length)return this.clearCache(),this.paths[a].splice(b,0,[c.x,c.y]),this},removePath:function(a){if(this._validateInputs(a,null)){this.clearCache();a=this.paths.splice(a,1)[0];var b,c=a.length,g=this.spatialReference;for(b=0;b<c;b++)a[b]=new d(a[b],g);return a}},removePoint:function(a,b){if(this._validateInputs(a,b))return this.clearCache(),new d(this.paths[a].splice(b,1)[0],this.spatialReference)},
getExtent:function(){var a;a=this.getCacheValue("_extent");var b=this.getCacheValue("_partwise");if(a)return a=new c(a),a._partwise=b,a;a=this.paths;var d=a.length;if(d&&a[0].length){var r,f,v,h,w,l,n,e,k=h=a[0][0][0],p=w=a[0][0][1],q=Math.min,D=Math.max,F=this.spatialReference,b=[],I,M,L,J;for(l=0;l<d;l++){r=a[l];I=M=r[0]&&r[0][0];L=J=r[0]&&r[0][1];e=r.length;for(n=0;n<e;n++)f=r[n],v=f[0],f=f[1],k=q(k,v),p=q(p,f),h=D(h,v),w=D(w,f),I=q(I,v),L=q(L,f),M=D(M,v),J=D(J,f);b.push(new c({xmin:I,ymin:L,xmax:M,
ymax:J,spatialReference:F?F.toJson():null}))}a={xmin:k,ymin:p,xmax:h,ymax:w,spatialReference:F?F.toJson():null};b=1<b.length?b:null;this.setCacheValue("_extent",a);this.setCacheValue("_partwise",b);a=new c(a);a._partwise=b;return a}},toJson:function(){var a={paths:p.clone(this.paths)},b=this.spatialReference;b&&(a.spatialReference=b.toJson());return a}});k.defaultProps=b;return k})},"esri/geometry/Polygon":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/has ../kernel ../lang ../SpatialReference ./Geometry ./Point ./Extent ./mathUtils ../srUtils".split(" "),
function(k,e,p,q,n,l,h,f,d,c,a,b){var g={type:"polygon",rings:null},u=k(f,{declaredClass:"esri.geometry.Polygon",constructor:function(a){p.mixin(this,g);this.rings=[];this._ring=0;a&&(p.isArray(a)?this.rings=p.isArray(a[0][0])?a:[a]:a.rings?p.mixin(this,a):this.spatialReference=a,this.spatialReference&&(this.spatialReference=b.createSpatialReference(this.spatialReference)));this.verifySR()},addRing:function(a){this.clearCache();this._ring=this.rings.length;this.rings[this._ring]=[];p.isArray(a[0])?
e.forEach(a,this._addPointArr,this):e.forEach(a,this._addPoint,this);return this},_addPointArr:function(a){this.rings[this._ring].push(a)},_addPoint:function(a){this.rings[this._ring].push([a.x,a.y])},_insertPoints:function(a,b){this.clearCache();this._ring=b;this.rings[this._ring]||(this.rings[this._ring]=[]);e.forEach(a,this._addPoint,this)},_validateInputs:function(a,b){return null!==a&&void 0!==a&&(0>a||a>=this.rings.length)||null!==b&&void 0!==a&&(0>b||b>=this.rings[a].length)?!1:!0},getPoint:function(a,
b){if(this._validateInputs(a,b))return new d(this.rings[a][b],this.spatialReference)},setPoint:function(a,b,c){if(this._validateInputs(a,b))return this.clearCache(),this.rings[a][b]=[c.x,c.y],this},insertPoint:function(a,b,c){if(this._validateInputs(a)&&l.isDefined(b)&&0<=b&&b<=this.rings[a].length)return this.clearCache(),this.rings[a].splice(b,0,[c.x,c.y]),this},removeRing:function(a){if(this._validateInputs(a,null)){this.clearCache();a=this.rings.splice(a,1)[0];var b,c=a.length,g=this.spatialReference;
for(b=0;b<c;b++)a[b]=new d(a[b],g);return a}},removePoint:function(a,b){if(this._validateInputs(a,b))return this.clearCache(),new d(this.rings[a].splice(b,1)[0],this.spatialReference)},getExtent:function(){var a;a=this.getCacheValue("_extent");var b=this.getCacheValue("_partwise");if(a)return a=new c(a),a._partwise=b,a;a=this.rings;var d=a.length;if(d&&a[0].length){var g,f,u,h,l,n,e,k,p=h=a[0][0][0],q=l=a[0][0][1],F=Math.min,I=Math.max,M=this.spatialReference,b=[],L,J,P,K;for(n=0;n<d;n++){g=a[n];
L=J=g[0]&&g[0][0];P=K=g[0]&&g[0][1];k=g.length;for(e=0;e<k;e++)f=g[e],u=f[0],f=f[1],p=F(p,u),q=F(q,f),h=I(h,u),l=I(l,f),L=F(L,u),P=F(P,f),J=I(J,u),K=I(K,f);b.push(new c({xmin:L,ymin:P,xmax:J,ymax:K,spatialReference:M?M.toJson():null}))}a={xmin:p,ymin:q,xmax:h,ymax:l,spatialReference:M?M.toJson():null};b=1<b.length?b:null;this.setCacheValue("_extent",a);this.setCacheValue("_partwise",b);a=new c(a);a._partwise=b;return a}},contains:function(a){var b=this.rings,c,g=!1,m,f,u,h,l,n,e=b.length;c=this.spatialReference;
m=a.spatialReference;var k=a.x;a=a.y;c&&m&&!c.equals(m)&&c._canProject(m)&&(a=c.isWebMercator()?d.lngLatToXY(k,a):d.xyToLngLat(k,a,!0),k=a[0],a=a[1]);for(n=0;n<e;n++)for(c=b[n],u=c.length,l=h=0;l<u;l++)h++,h===u&&(h=0),m=c[l],f=c[h],(m[1]<a&&f[1]>=a||f[1]<a&&m[1]>=a)&&m[0]+(a-m[1])/(f[1]-m[1])*(f[0]-m[0])<k&&(g=!g);return g},getCentroid:function(){var a=this.getCacheValue("_centroid");if(void 0!==a)return a;var a=this.rings,b,c,g,f,u=[],h,l,n=Infinity,k=-Infinity,p=Infinity,q=-Infinity;e.forEach(a,
function(a){b=c=g=0;e.forEach(a,function(d,m){m<a.length-1&&(h=a[m+1],l=d[0]*h[1]-h[0]*d[1],b+=(d[0]+h[0])*l,c+=(d[1]+h[1])*l,g+=l,d[0]<n&&(n=d[0]),d[0]>k&&(k=d[0]),d[1]<p&&(p=d[1]),d[1]>q&&(q=d[1]))});0<g&&(g*=-1);g&&u.push([b,c,g/2])});u.sort(function(a,b){return a[2]-b[2]});b=c=void 0;u[0]&&(f=6*u[0][2],b=u[0][0]/f,c=u[0][1]/f,b<n||b>k||c<p||c>q)&&(b=c=void 0);if(void 0===b||void 0===c)if(a=a[0]&&a[0].length?this._getLineCentroid(a[0]):null)b=a.x,c=a.y;a=isNaN(b)||isNaN(c)?null:new d(b,c,this.spatialReference);
this.setCacheValue("_centroid",a);return a},_getLineCentroid:function(b){var c,d=0,g=0,m=0,f,u,h={x:0,y:0},l={x:0,y:0},n,e=b.length,k;for(n=0;n<e-1;n++)f=b[n],u=b[n+1],f&&u&&(h.x=f[0],h.y=f[1],l.x=u[0],l.y=u[1],c=a.getLength(h,l),0<c&&(d+=c,f=a.getMidpoint(f,u),g+=c*f[0],m+=c*f[1]));0<d?k={x:g/d,y:m/d}:b[0]&&(k={x:b[0][0],y:b[0][1]});return k},isClockwise:function(a){var b=0,c,d=a.length,g=p.isArray(a[0])?function(a,b){return a[0]*b[1]-b[0]*a[1]}:function(a,b){return a.x*b.y-b.x*a.y};for(c=0;c<d;c++)b+=
g(a[c],a[(c+1)%d]);return 0>=b/2},isSelfIntersecting:function(b){b=b||this;var c,d,g,m,f,u,h,l=b.rings.length,n;for(g=0;g<l;g++){for(c=0;c<b.rings[g].length-1;c++)for(f=[[b.rings[g][c][0],b.rings[g][c][1]],[b.rings[g][c+1][0],b.rings[g][c+1][1]]],d=g+1;d<l;d++)for(m=0;m<b.rings[d].length-1;m++)if(u=[[b.rings[d][m][0],b.rings[d][m][1]],[b.rings[d][m+1][0],b.rings[d][m+1][1]]],(h=a._getLineIntersection2(f,u))&&!(h[0]===f[0][0]&&h[1]===f[0][1]||h[0]===u[0][0]&&h[1]===u[0][1]||h[0]===f[1][0]&&h[1]===
f[1][1]||h[0]===u[1][0]&&h[1]===u[1][1]))return!0;m=b.rings[g].length;if(!(4>=m))for(c=0;c<m-3;c++)for(n=m-1,0===c&&(n=m-2),f=[[b.rings[g][c][0],b.rings[g][c][1]],[b.rings[g][c+1][0],b.rings[g][c+1][1]]],d=c+2;d<n;d++)if(u=[[b.rings[g][d][0],b.rings[g][d][1]],[b.rings[g][d+1][0],b.rings[g][d+1][1]]],(h=a._getLineIntersection2(f,u))&&!(h[0]===f[0][0]&&h[1]===f[0][1]||h[0]===u[0][0]&&h[1]===u[0][1]||h[0]===f[1][0]&&h[1]===f[1][1]||h[0]===u[1][0]&&h[1]===u[1][1]))return!0}return!1},toJson:function(){var a=
{rings:p.clone(this.rings)},b=this.spatialReference;b&&(a.spatialReference=b.toJson());return a}});u.defaultProps=g;u.createEllipse=function(a){var b=a.center.x,c=a.center.y,d=a.longAxis,g=a.shortAxis,m=a.numberOfPoints,f=a.map,h,l,n;a=[];var e=2*Math.PI/m;for(l=0;l<m;l++)h=Math.cos(l*e),n=Math.sin(l*e),h=f.toMap({x:d*h+b,y:g*n+c}),a.push(h);a.push(a[0]);b=new u(f.spatialReference);b.addRing(a);return b};u.createCircle=function(a){return u.createEllipse({center:a.center,longAxis:a.r,shortAxis:a.r,
numberOfPoints:a.numberOfPoints,map:a.map})};u.fromExtent=function(a){var b=a.normalize();a=a.spatialReference;return new u({rings:e.map(b,function(a){return[[a.xmin,a.ymin],[a.xmin,a.ymax],[a.xmax,a.ymax],[a.xmax,a.ymin],[a.xmin,a.ymin]]}),spatialReference:a?a.toJson():null})};return u})},"esri/geometry/Multipoint":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../SpatialReference ./Geometry ./Point ./Extent ../srUtils".split(" "),function(k,e,p,q,n,l,h,f,d){var c={type:"multipoint",
points:null};k=k(l,{declaredClass:"esri.geometry.Multipoint",constructor:function(a){e.mixin(this,c);this.points=[];a&&(a.points?e.mixin(this,a):this.spatialReference=a,this.spatialReference&&(this.spatialReference=d.createSpatialReference(this.spatialReference)));this.verifySR()},addPoint:function(a){this.clearCache();e.isArray(a)?this.points.push(a):this.points.push([a.x,a.y]);return this},removePoint:function(a){if(this._validateInputs(a))return this.clearCache(),new h(this.points.splice(a,1)[0],
this.spatialReference)},getExtent:function(){var a=this.getCacheValue("_extent");if(a)return new f(a);var a=this.points,b=a.length;if(b){var c=a[0],d,m,r=d=c[0],t=m=c[1],v=Math.min,h=Math.max,w=this.spatialReference,l,n;for(n=0;n<b;n++)c=a[n],l=c[0],c=c[1],r=v(r,l),t=v(t,c),d=h(d,l),m=h(m,c);a={xmin:r,ymin:t,xmax:d,ymax:m,spatialReference:w?w.toJson():null};this.setCacheValue("_extent",a);return new f(a)}},_validateInputs:function(a){return null===a||0>a||a>=this.points.length?!1:!0},getPoint:function(a){if(this._validateInputs(a))return a=
this.points[a],new h(a[0],a[1],this.spatialReference)},setPoint:function(a,b){if(this._validateInputs(a))return this.clearCache(),this.points[a]=[b.x,b.y],this},toJson:function(){var a={points:e.clone(this.points)},b=this.spatialReference;b&&(a.spatialReference=b.toJson());return a}});k.defaultProps=c;return k})},"esri/arcade/FunctionWrapper":function(){define(["require","exports"],function(k,e){return function(){return function(e,k){this.context=this.definition=null;this.definition=e;this.context=
k}}()})},"esri/geometry/ScreenPoint":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel","./Point"],function(k,e,p,q,n){return k(n,{declaredClass:"esri.geometry.ScreenPoint",verifySR:function(){}})})},"esri/geometry/Rect":function(){define("dojo/_base/declare dojo/_base/lang dojo/has dojox/gfx/_base ../kernel ../SpatialReference ./Geometry ./Point ./Extent ../srUtils".split(" "),function(k,e,p,q,n,l,h,f,d,c){var a=k(h,{declaredClass:"esri.geometry.Rect",constructor:function(a,
d,f,m,r){e.mixin(this,q.defaultRect);e.isObject(a)&&"extent"===a.type&&(d=a.ymax,f=a.getWidth(),m=a.getHeight(),r=a.spatialReference,a=a.xmin);e.isObject(a)?(e.mixin(this,a),this.spatialReference&&(this.spatialReference=c.createSpatialReference(this.spatialReference))):(this.x=a,this.y=d,this.width=f,this.height=m,this.spatialReference=r);this.verifySR()},getCenter:function(){return new f(this.x+this.width/2,this.y+this.height/2,this.spatialReference)},offset:function(b,c){return new a(this.x+b,this.y+
c,this.width,this.height,this.spatialReference)},intersects:function(a){return a.x+a.width<=this.x||a.y+a.height<=this.y||a.y>=this.y+this.height||a.x>=this.x+this.width?!1:!0},getExtent:function(){return new d(parseFloat(this.x),parseFloat(this.y)-parseFloat(this.height),parseFloat(this.x)+parseFloat(this.width),parseFloat(this.y),this.spatialReference)},update:function(a,c,d,m,f){this.x=a;this.y=c;this.width=d;this.height=m;this.spatialReference=f;this.clearCache();return this}});return a})},"esri/geometry/scaleUtils":function(){define("dojo/_base/lang dojo/has ../kernel ../config ../lang ../WKIDUnitConversion".split(" "),
function(k,e,p,q,n,l){var h=6370997*Math.PI/180,f=q.defaults,d={getUnitValueForSR:function(c){return this.getUnitValue(c)||h},getUnitValue:function(c){var a,b,d;c&&("object"===typeof c?(a=c.wkid,b=c.wkt):"number"===typeof c?a=c:"string"===typeof c&&(b=c));a?d=l.values[l[a]]:b&&-1!==b.search(/^PROJCS/i)&&(c=/UNIT\[([^\]]+)\]\]$/i.exec(b))&&c[1]&&(d=parseFloat(c[1].split(",")[1]));return d},getScale:function(c,a,b){var g,u,m;1<arguments.length&&n.isDefined(a)&&!a.declaredClass?(g=c,u=a,a=null,m=d.getUnitValue(b)):
(g=a||c.extent,u=c.width,m=d.getUnitValue(g&&g.spatialReference));return g&&u?g.getWidth()/u*(m||h)*39.37*f.screenDPI:0},getExtentForScale:function(c,a,b){b=b||c.extent;var g;g=d.getUnitValue(c.spatialReference);return b.expand(a*c.width/(39.37*(g||h)*f.screenDPI)/b.getWidth())}};return d})},"esri/WKIDUnitConversion":function(){define(["dojo/has","./kernel"],function(k,e){e={values:[1,.3048,.3048006096012192,.3047972654,.9143917962,.201166195164,.9143984146160287,.3047994715386762,20.11676512155263,
20.11678249437587,.9143985307444408,.91439523,.3047997101815088,20.116756,5E4,15E4],units:"Meter Foot Foot_US Foot_Clarke Yard_Clarke Link_Clarke Yard_Sears Foot_Sears Chain_Sears Chain_Benoit_1895_B Yard_Indian Yard_Indian_1937 Foot_Gold_Coast Chain_Sears_1922_Truncated 50_Kilometers 150_Kilometers".split(" "),2066:5,2136:12,2155:2,2157:0,2158:0,2159:12,2160:12,2204:2,2219:0,2220:0,2254:2,2255:2,2256:1,2265:1,2266:1,2267:2,2268:2,2269:1,2270:1,2271:2,2272:2,2273:1,2294:0,2295:0,2314:3,2899:2,2900:2,
2901:1,2909:1,2910:1,2911:2,2912:2,2913:1,2914:1,2992:1,2993:0,2994:1,3080:1,3089:2,3090:0,3091:2,3102:2,3141:0,3142:0,3167:13,3359:2,3360:0,3361:1,3362:0,3363:2,3364:0,3365:2,3366:3,3404:2,3405:0,3406:0,3407:3,3439:0,3440:0,3479:1,3480:0,3481:1,3482:0,3483:1,3484:0,3485:2,3486:0,3487:2,3488:0,3489:0,3490:2,3491:0,3492:2,3493:0,3494:2,3495:0,3496:2,3497:0,3498:2,3499:0,3500:2,3501:0,3502:2,3503:0,3504:2,3505:0,3506:2,3507:0,3508:2,3509:0,3510:2,3511:0,3512:2,3513:0,3514:0,3515:2,3516:0,3517:2,3518:0,
3519:2,3520:0,3521:2,3522:0,3523:2,3524:0,3525:2,3526:0,3527:2,3528:0,3529:2,3530:0,3531:2,3532:0,3533:2,3534:0,3535:2,3536:0,3537:2,3538:0,3539:2,3540:0,3541:2,3542:0,3543:2,3544:0,3545:2,3546:0,3547:2,3548:0,3549:2,3550:0,3551:2,3552:0,3553:2,3582:2,3583:0,3584:2,3585:0,3586:2,3587:0,3588:1,3589:0,3590:1,3591:0,3592:0,3593:1,3598:2,3599:0,3600:2,3605:1,3606:0,3607:0,3608:2,3609:0,3610:2,3611:0,3612:2,3613:0,3614:2,3615:0,3616:2,3617:0,3618:2,3619:0,3620:2,3621:0,3622:2,3623:0,3624:2,3625:0,3626:2,
3627:0,3628:2,3629:0,3630:2,3631:0,3632:2,3633:0,3634:1,3635:0,3636:1,3640:2,3641:0,3642:2,3643:0,3644:1,3645:0,3646:1,3647:0,3648:1,3649:0,3650:2,3651:0,3652:2,3653:0,3654:2,3655:0,3656:1,3657:0,3658:2,3659:0,3660:2,3661:0,3662:2,3663:0,3664:2,3668:2,3669:0,3670:2,3671:0,3672:2,3673:0,3674:2,3675:0,3676:1,3677:2,3678:0,3679:1,3680:2,3681:0,3682:1,3683:2,3684:0,3685:0,3686:2,3687:0,3688:2,3689:0,3690:2,3691:0,3692:2,3696:2,3697:0,3698:2,3699:0,3700:2,3793:0,3794:0,3812:0,3854:0,3857:0,3920:0,3978:0,
3979:0,3991:2,3992:2,4026:0,4037:0,4038:0,4071:0,4082:0,4083:0,4087:0,4088:0,4217:2,4414:0,4415:0,4417:0,4434:0,4437:0,4438:2,4439:2,4462:0,4467:0,4471:0,4474:0,4559:0,4647:0,4822:0,4826:0,4839:0,5018:0,5048:0,5167:0,5168:0,5221:0,5223:0,5234:0,5235:0,5243:0,5247:0,5266:0,5316:0,5320:0,5321:0,5325:0,5337:0,5361:0,5362:0,5367:0,5382:0,5383:0,5396:0,5456:0,5457:0,5469:0,5472:4,5490:0,5513:0,5514:0,5523:0,5559:0,5588:1,5589:3,5596:0,5627:0,5629:0,5641:0,5643:0,5644:0,5646:2,5654:2,5655:2,5659:0,5700:0,
5825:0,5836:0,5837:0,5839:0,5842:0,5844:0,5858:0,5879:0,5880:0,5887:0,5890:0,6128:1,6129:1,6141:1,6204:0,6210:0,6211:0,6307:0,6312:0,6316:0,6362:0,6391:1,6405:1,6406:0,6407:1,6408:0,6409:1,6410:0,6411:2,6412:0,6413:2,6414:0,6415:0,6416:2,6417:0,6418:2,6419:0,6420:2,6421:0,6422:2,6423:0,6424:2,6425:0,6426:2,6427:0,6428:2,6429:0,6430:2,6431:0,6432:2,6433:0,6434:2,6435:0,6436:2,6437:0,6438:2,6439:0,6440:0,6441:2,6442:0,6443:2,6444:0,6445:2,6446:0,6447:2,6448:0,6449:2,6450:0,6451:2,6452:0,6453:2,6454:0,
6455:2,6456:0,6457:2,6458:0,6459:2,6460:0,6461:2,6462:0,6463:2,6464:0,6465:2,6466:0,6467:2,6468:0,6469:2,6470:0,6471:2,6472:0,6473:2,6474:0,6475:2,6476:0,6477:2,6478:0,6479:2,6484:2,6485:0,6486:2,6487:0,6488:2,6489:0,6490:2,6491:0,6492:2,6493:0,6494:1,6495:0,6496:1,6497:0,6498:0,6499:1,6500:0,6501:2,6502:0,6503:2,6504:0,6505:2,6506:0,6507:2,6508:0,6509:0,6510:2,6515:1,6516:0,6518:0,6519:2,6520:0,6521:2,6522:0,6523:2,6524:0,6525:2,6526:0,6527:2,6528:0,6529:2,6530:0,6531:2,6532:0,6533:2,6534:0,6535:2,
6536:0,6537:2,6538:0,6539:2,6540:0,6541:2,6542:0,6543:2,6544:0,6545:1,6546:0,6547:1,6548:0,6549:2,6550:0,6551:2,6552:0,6553:2,6554:0,6555:2,6556:0,6557:1,6558:0,6559:1,6560:0,6561:1,6562:0,6563:2,6564:0,6565:2,6566:0,6567:0,6568:2,6569:0,6570:1,6571:0,6572:2,6573:0,6574:2,6575:0,6576:2,6577:0,6578:2,6582:2,6583:0,6584:2,6585:0,6586:2,6587:0,6588:2,6589:0,6590:2,6591:0,6592:0,6593:2,6594:0,6595:2,6596:0,6597:2,6598:0,6599:2,6600:0,6601:2,6602:0,6603:2,6605:2,6606:0,6607:2,6608:0,6609:2,6610:0,6611:0,
6612:2,6613:0,6614:2,6615:0,6616:2,6617:0,6618:2,6633:2,6646:0,6703:0,6784:0,6785:1,6786:0,6787:1,6788:0,6789:1,6790:0,6791:1,6792:0,6793:1,6794:0,6795:1,6796:0,6797:1,6798:0,6799:1,6800:0,6801:1,6802:0,6803:1,6804:0,6805:1,6806:0,6807:1,6808:0,6809:1,6810:0,6811:1,6812:0,6813:1,6814:0,6815:1,6816:0,6817:1,6818:0,6819:1,6820:0,6821:1,6822:0,6823:1,6824:0,6825:1,6826:0,6827:1,6828:0,6829:1,6830:0,6831:1,6832:0,6833:1,6834:0,6835:1,6836:0,6837:1,6838:0,6839:1,6840:0,6841:1,6842:0,6843:1,6844:0,6845:1,
6846:0,6847:1,6848:0,6849:1,6850:0,6851:1,6852:0,6853:1,6854:0,6855:1,6856:0,6857:1,6858:0,6859:1,6860:0,6861:1,6862:0,6863:1,6867:0,6868:1,6870:0,6875:0,6876:0,6879:0,6880:2,6884:0,6885:1,6886:0,6887:1,6915:0,6922:0,6923:2,6924:0,6925:2,6962:0,6984:0,6991:0,7128:2,7131:0,7132:2,7142:0,7257:0,7258:2,7259:0,7260:2,7261:0,7262:2,7263:0,7264:2,7265:0,7266:2,7267:0,7268:2,7269:0,7270:2,7271:0,7272:2,7273:0,7274:2,7275:0,7276:2,7277:0,7278:2,7279:0,7280:2,7281:0,7282:2,7283:0,7284:2,7285:0,7286:2,7287:0,
7288:2,7289:0,7290:2,7291:0,7292:2,7293:0,7294:2,7295:0,7296:2,7297:0,7298:2,7299:0,7300:2,7301:0,7302:2,7303:0,7304:2,7305:0,7306:2,7307:0,7308:2,7309:0,7310:2,7311:0,7312:2,7313:0,7314:2,7315:0,7316:2,7317:0,7318:2,7319:0,7320:2,7321:0,7322:2,7323:0,7324:2,7325:0,7326:2,7327:0,7328:2,7329:0,7330:2,7331:0,7332:2,7333:0,7334:2,7335:0,7336:2,7337:0,7338:2,7339:0,7340:2,7341:0,7342:2,7343:0,7344:2,7345:0,7346:2,7347:0,7348:2,7349:0,7350:2,7351:0,7352:2,7353:0,7354:2,7355:0,7356:2,7357:0,7358:2,7359:0,
7360:2,7361:0,7362:2,7363:0,7364:2,7365:0,7366:2,7367:0,7368:2,7369:0,7370:2,7877:0,7878:0,7882:0,7883:0,7887:0,7899:0,7991:0,7992:0,8058:0,8059:0,8311:0,8312:1,8313:0,8314:1,8315:0,8316:1,8317:0,8318:1,8319:0,8320:1,8321:0,8322:1,8323:0,8324:1,8325:0,8326:1,8327:0,8328:1,8329:0,8330:1,8331:0,8332:1,8333:0,8334:1,8335:0,8336:1,8337:0,8338:1,8339:0,8340:1,8341:0,8342:1,8343:0,8344:1,8345:0,8346:1,8347:0,8348:1,20499:0,20538:0,20539:0,20790:0,20791:0,21291:0,21292:0,21500:0,21817:0,21818:0,22032:0,
22033:0,22091:0,22092:0,22332:0,22391:0,22392:0,22700:0,22770:0,22780:0,22832:0,23090:0,23095:0,23239:0,23240:0,23433:0,23700:0,24047:0,24048:0,24100:3,24200:0,24305:0,24306:0,24382:10,24383:0,24500:0,24547:0,24548:0,24571:9,24600:0,25E3:0,25231:0,25884:0,25932:0,26237:0,26331:0,26332:0,26432:0,26591:0,26592:0,26632:0,26692:0,27120:0,27200:0,27291:6,27292:6,27429:0,27492:0,27493:0,27500:0,27700:0,28232:0,28600:0,28991:0,28992:0,29100:0,29101:0,29220:0,29221:0,29333:0,29635:0,29636:0,29701:0,29738:0,
29739:0,29849:0,29850:0,29871:8,29872:7,29873:0,30200:5,30339:0,30340:0,30591:0,30592:0,30791:0,30792:0,30800:0,31028:0,31121:0,31154:0,31170:0,31171:0,31370:0,31528:0,31529:0,31600:0,31700:0,31838:0,31839:0,31900:0,31901:0,32061:0,32062:0,32098:0,32099:2,32100:0,32104:0,32161:0,32766:0,53034:0,53048:0,53049:0,54034:0,65061:2,65062:2,65161:0,65163:0,102041:2,102064:11,102068:14,102069:15,102118:2,102119:1,102120:2,102121:2,102217:2,102218:0,102219:2,102220:2,102378:1,102379:1,102380:0,102381:1,102589:2,
102599:2,102600:2,102604:2,102647:0,102704:2,102705:2,102706:0,102761:2,102762:0,102763:2,102764:0,102765:0,102766:2,102962:0,102963:0,102970:1,102974:2,102993:0,102994:0,102995:2,102996:2,103015:0,103016:2,103017:0,103018:2,103025:0,103026:0,103027:2,103028:2,103035:0,103036:0,103037:2,103038:2,103039:0,103040:0,103041:2,103042:2,103043:0,103044:0,103045:2,103046:2,103047:0,103048:0,103049:2,103050:2,103051:0,103052:2,103053:0,103054:2,103055:0,103056:2,103057:0,103058:0,103059:2,103060:2,103061:0,
103062:0,103063:2,103064:2,103069:2,103070:0,103071:0,103072:2,103073:2,103086:0,103087:0,103088:2,103089:2,103094:1,103095:0,103096:2,103103:0,103104:2,103105:0,103106:2,103121:0,103122:2,103123:0,103124:0,103125:1,103126:1,103127:0,103128:0,103129:2,103130:2,103131:0,103132:0,103133:2,103134:2,103135:0,103136:0,103137:1,103138:1,103139:0,103140:2,103141:0,103142:2,103143:0,103144:2,103145:0,103146:1,103147:0,103148:0,103149:2,103150:2,103151:0,103152:2,103172:0,103173:2,103174:0,103175:0,103176:2,
103177:2,103178:0,103179:0,103180:2,103181:2,103182:0,103183:0,103184:2,103185:2,103228:0,103229:0,103230:2,103231:2,103250:0,103251:2,103252:0,103253:2,103260:0,103261:0,103262:2,103263:2,103270:0,103271:0,103272:2,103273:2,103274:0,103275:0,103276:2,103277:2,103278:0,103279:0,103280:2,103281:2,103282:0,103283:0,103284:2,103285:2,103286:0,103287:2,103288:0,103289:2,103290:0,103291:2,103292:0,103293:0,103294:2,103295:2,103296:0,103297:0,103298:2,103299:2,103376:2,103377:0,103378:0,103379:2,103380:2,
103393:0,103394:0,103395:2,103396:2,103472:0,103473:1,103474:0,103475:2,103482:0,103483:2,103484:0,103485:2,103500:0,103501:2,103502:0,103503:0,103504:1,103505:1,103506:0,103507:0,103508:2,103509:2,103510:0,103511:0,103512:2,103513:2,103514:0,103515:2,103516:0,103517:2,103518:0,103519:2,103520:0,103521:1,103522:0,103523:0,103524:2,103525:2,103526:0,103527:2,103561:2,103562:2,103563:0,103564:0,103565:2,103566:2,103567:0,103568:0,103569:2,103570:2,103584:0,103585:2,103695:2};for(k=2E3;2045>=k;k++)e[k]=
0;for(k=2056;2065>=k;k++)e[k]=0;for(k=2067;2135>=k;k++)e[k]=0;for(k=2137;2154>=k;k++)e[k]=0;for(k=2161;2170>=k;k++)e[k]=0;for(k=2172;2193>=k;k++)e[k]=0;for(k=2195;2198>=k;k++)e[k]=0;for(k=2200;2203>=k;k++)e[k]=0;for(k=2205;2217>=k;k++)e[k]=0;for(k=2222;2224>=k;k++)e[k]=1;for(k=2225;2250>=k;k++)e[k]=2;for(k=2251;2253>=k;k++)e[k]=1;for(k=2257;2264>=k;k++)e[k]=2;for(k=2274;2279>=k;k++)e[k]=2;for(k=2280;2282>=k;k++)e[k]=1;for(k=2283;2289>=k;k++)e[k]=2;for(k=2290;2292>=k;k++)e[k]=0;for(k=2308;2313>=k;k++)e[k]=
0;for(k=2315;2491>=k;k++)e[k]=0;for(k=2494;2866>=k;k++)e[k]=0;for(k=2867;2869>=k;k++)e[k]=1;for(k=2870;2888>=k;k++)e[k]=2;for(k=2891;2895>=k;k++)e[k]=2;for(k=2896;2898>=k;k++)e[k]=1;for(k=2902;2908>=k;k++)e[k]=2;for(k=2915;2920>=k;k++)e[k]=2;for(k=2921;2923>=k;k++)e[k]=1;for(k=2924;2930>=k;k++)e[k]=2;for(k=2931;2962>=k;k++)e[k]=0;for(k=2964;2968>=k;k++)e[k]=2;for(k=2969;2973>=k;k++)e[k]=0;for(k=2975;2991>=k;k++)e[k]=0;for(k=2995;3051>=k;k++)e[k]=0;for(k=3054;3079>=k;k++)e[k]=0;for(k=3081;3088>=k;k++)e[k]=
0;for(k=3092;3101>=k;k++)e[k]=0;for(k=3106;3138>=k;k++)e[k]=0;for(k=3146;3151>=k;k++)e[k]=0;for(k=3153;3166>=k;k++)e[k]=0;for(k=3168;3172>=k;k++)e[k]=0;for(k=3174;3203>=k;k++)e[k]=0;for(k=3294;3358>=k;k++)e[k]=0;for(k=3367;3403>=k;k++)e[k]=0;for(k=3408;3416>=k;k++)e[k]=0;for(k=3417;3438>=k;k++)e[k]=2;for(k=3441;3446>=k;k++)e[k]=2;for(k=3447;3450>=k;k++)e[k]=0;for(k=3451;3459>=k;k++)e[k]=2;for(k=3460;3478>=k;k++)e[k]=0;for(k=3554;3559>=k;k++)e[k]=0;for(k=3560;3570>=k;k++)e[k]=2;for(k=3571;3581>=k;k++)e[k]=
0;for(k=3594;3597>=k;k++)e[k]=0;for(k=3601;3604>=k;k++)e[k]=0;for(k=3637;3639>=k;k++)e[k]=0;for(k=3665;3667>=k;k++)e[k]=0;for(k=3693;3695>=k;k++)e[k]=0;for(k=3701;3727>=k;k++)e[k]=0;for(k=3728;3739>=k;k++)e[k]=2;for(k=3740;3751>=k;k++)e[k]=0;for(k=3753;3760>=k;k++)e[k]=2;for(k=3761;3773>=k;k++)e[k]=0;for(k=3775;3777>=k;k++)e[k]=0;for(k=3779;3781>=k;k++)e[k]=0;for(k=3783;3785>=k;k++)e[k]=0;for(k=3788;3791>=k;k++)e[k]=0;for(k=3797;3802>=k;k++)e[k]=0;for(k=3814;3816>=k;k++)e[k]=0;for(k=3825;3829>=k;k++)e[k]=
0;for(k=3832;3841>=k;k++)e[k]=0;for(k=3844;3852>=k;k++)e[k]=0;for(k=3873;3885>=k;k++)e[k]=0;for(k=3890;3893>=k;k++)e[k]=0;for(k=3907;3912>=k;k++)e[k]=0;for(k=3942;3950>=k;k++)e[k]=0;for(k=3968;3970>=k;k++)e[k]=0;for(k=3973;3976>=k;k++)e[k]=0;for(k=3986;3989>=k;k++)e[k]=0;for(k=3994;3997>=k;k++)e[k]=0;for(k=4048;4051>=k;k++)e[k]=0;for(k=4056;4063>=k;k++)e[k]=0;for(k=4093;4096>=k;k++)e[k]=0;for(k=4390;4398>=k;k++)e[k]=0;for(k=4399;4413>=k;k++)e[k]=2;for(k=4418;4433>=k;k++)e[k]=2;for(k=4455;4457>=k;k++)e[k]=
2;for(k=4484;4489>=k;k++)e[k]=0;for(k=4491;4554>=k;k++)e[k]=0;for(k=4568;4589>=k;k++)e[k]=0;for(k=4652;4656>=k;k++)e[k]=0;for(k=4766;4800>=k;k++)e[k]=0;for(k=5014;5016>=k;k++)e[k]=0;for(k=5069;5072>=k;k++)e[k]=0;for(k=5105;5130>=k;k++)e[k]=0;for(k=5173;5188>=k;k++)e[k]=0;for(k=5253;5259>=k;k++)e[k]=0;for(k=5269;5275>=k;k++)e[k]=0;for(k=5292;5311>=k;k++)e[k]=0;for(k=5329;5331>=k;k++)e[k]=0;for(k=5343;5349>=k;k++)e[k]=0;for(k=5355;5357>=k;k++)e[k]=0;for(k=5387;5389>=k;k++)e[k]=0;for(k=5459;5463>=k;k++)e[k]=
0;for(k=5479;5482>=k;k++)e[k]=0;for(k=5518;5520>=k;k++)e[k]=0;for(k=5530;5539>=k;k++)e[k]=0;for(k=5550;5552>=k;k++)e[k]=0;for(k=5562;5583>=k;k++)e[k]=0;for(k=5623;5625>=k;k++)e[k]=2;for(k=5631;5639>=k;k++)e[k]=0;for(k=5649;5653>=k;k++)e[k]=0;for(k=5663;5680>=k;k++)e[k]=0;for(k=5682;5685>=k;k++)e[k]=0;for(k=5875;5877>=k;k++)e[k]=0;for(k=5921;5940>=k;k++)e[k]=0;for(k=6050;6125>=k;k++)e[k]=0;for(k=6244;6275>=k;k++)e[k]=0;for(k=6328;6348>=k;k++)e[k]=0;for(k=6350;6356>=k;k++)e[k]=0;for(k=6366;6372>=k;k++)e[k]=
0;for(k=6381;6387>=k;k++)e[k]=0;for(k=6393;6404>=k;k++)e[k]=0;for(k=6480;6483>=k;k++)e[k]=0;for(k=6511;6514>=k;k++)e[k]=0;for(k=6579;6581>=k;k++)e[k]=0;for(k=6619;6624>=k;k++)e[k]=0;for(k=6625;6627>=k;k++)e[k]=2;for(k=6628;6632>=k;k++)e[k]=0;for(k=6634;6637>=k;k++)e[k]=0;for(k=6669;6692>=k;k++)e[k]=0;for(k=6707;6709>=k;k++)e[k]=0;for(k=6720;6723>=k;k++)e[k]=0;for(k=6732;6738>=k;k++)e[k]=0;for(k=6931;6933>=k;k++)e[k]=0;for(k=6956;6959>=k;k++)e[k]=0;for(k=7005;7007>=k;k++)e[k]=0;for(k=7057;7070>=k;k++)e[k]=
2;for(k=7074;7082>=k;k++)e[k]=0;for(k=7109;7118>=k;k++)e[k]=0;for(k=7119;7127>=k;k++)e[k]=1;for(k=7374;7376>=k;k++)e[k]=0;for(k=7528;7586>=k;k++)e[k]=0;for(k=7587;7645>=k;k++)e[k]=2;for(k=7755;7787>=k;k++)e[k]=0;for(k=7791;7795>=k;k++)e[k]=0;for(k=7799;7801>=k;k++)e[k]=0;for(k=7803;7805>=k;k++)e[k]=0;for(k=7825;7831>=k;k++)e[k]=0;for(k=7845;7859>=k;k++)e[k]=0;for(k=8013;8032>=k;k++)e[k]=0;for(k=20002;20032>=k;k++)e[k]=0;for(k=20062;20092>=k;k++)e[k]=0;for(k=20135;20138>=k;k++)e[k]=0;for(k=20248;20258>=
k;k++)e[k]=0;for(k=20348;20358>=k;k++)e[k]=0;for(k=20436;20440>=k;k++)e[k]=0;for(k=20822;20824>=k;k++)e[k]=0;for(k=20934;20936>=k;k++)e[k]=0;for(k=21035;21037>=k;k++)e[k]=0;for(k=21095;21097>=k;k++)e[k]=0;for(k=21148;21150>=k;k++)e[k]=0;for(k=21413;21423>=k;k++)e[k]=0;for(k=21473;21483>=k;k++)e[k]=0;for(k=21780;21782>=k;k++)e[k]=0;for(k=21891;21894>=k;k++)e[k]=0;for(k=21896;21899>=k;k++)e[k]=0;for(k=22171;22177>=k;k++)e[k]=0;for(k=22181;22187>=k;k++)e[k]=0;for(k=22191;22197>=k;k++)e[k]=0;for(k=22234;22236>=
k;k++)e[k]=0;for(k=22521;22525>=k;k++)e[k]=0;for(k=22991;22994>=k;k++)e[k]=0;for(k=23028;23038>=k;k++)e[k]=0;for(k=23830;23853>=k;k++)e[k]=0;for(k=23866;23872>=k;k++)e[k]=0;for(k=23877;23884>=k;k++)e[k]=0;for(k=23886;23894>=k;k++)e[k]=0;for(k=23946;23948>=k;k++)e[k]=0;for(k=24311;24313>=k;k++)e[k]=0;for(k=24342;24347>=k;k++)e[k]=0;for(k=24370;24374>=k;k++)e[k]=10;for(k=24375;24381>=k;k++)e[k]=0;for(k=24718;24721>=k;k++)e[k]=0;for(k=24817;24821>=k;k++)e[k]=0;for(k=24877;24882>=k;k++)e[k]=0;for(k=24891;24893>=
k;k++)e[k]=0;for(k=25391;25395>=k;k++)e[k]=0;for(k=25828;25838>=k;k++)e[k]=0;for(k=26191;26195>=k;k++)e[k]=0;for(k=26391;26393>=k;k++)e[k]=0;for(k=26701;26722>=k;k++)e[k]=0;for(k=26729;26799>=k;k++)e[k]=2;for(k=26801;26803>=k;k++)e[k]=2;for(k=26811;26813>=k;k++)e[k]=2;for(k=26847;26870>=k;k++)e[k]=2;for(k=26891;26899>=k;k++)e[k]=0;for(k=26901;26923>=k;k++)e[k]=0;for(k=26929;26946>=k;k++)e[k]=0;for(k=26948;26998>=k;k++)e[k]=0;for(k=27037;27040>=k;k++)e[k]=0;for(k=27205;27232>=k;k++)e[k]=0;for(k=27258;27260>=
k;k++)e[k]=0;for(k=27391;27398>=k;k++)e[k]=0;for(k=27561;27564>=k;k++)e[k]=0;for(k=27571;27574>=k;k++)e[k]=0;for(k=27581;27584>=k;k++)e[k]=0;for(k=27591;27594>=k;k++)e[k]=0;for(k=28191;28193>=k;k++)e[k]=0;for(k=28348;28358>=k;k++)e[k]=0;for(k=28402;28432>=k;k++)e[k]=0;for(k=28462;28492>=k;k++)e[k]=0;for(k=29118;29122>=k;k++)e[k]=0;for(k=29168;29172>=k;k++)e[k]=0;for(k=29177;29185>=k;k++)e[k]=0;for(k=29187;29195>=k;k++)e[k]=0;for(k=29900;29903>=k;k++)e[k]=0;for(k=30161;30179>=k;k++)e[k]=0;for(k=30491;30494>=
k;k++)e[k]=0;for(k=30729;30732>=k;k++)e[k]=0;for(k=31251;31259>=k;k++)e[k]=0;for(k=31265;31268>=k;k++)e[k]=0;for(k=31275;31279>=k;k++)e[k]=0;for(k=31281;31297>=k;k++)e[k]=0;for(k=31461;31469>=k;k++)e[k]=0;for(k=31491;31495>=k;k++)e[k]=0;for(k=31917;31922>=k;k++)e[k]=0;for(k=31965;32E3>=k;k++)e[k]=0;for(k=32001;32003>=k;k++)e[k]=2;for(k=32005;32031>=k;k++)e[k]=2;for(k=32033;32060>=k;k++)e[k]=2;for(k=32064;32067>=k;k++)e[k]=2;for(k=32074;32077>=k;k++)e[k]=2;for(k=32081;32086>=k;k++)e[k]=0;for(k=32107;32130>=
k;k++)e[k]=0;for(k=32133;32158>=k;k++)e[k]=0;for(k=32164;32167>=k;k++)e[k]=2;for(k=32180;32199>=k;k++)e[k]=0;for(k=32201;32260>=k;k++)e[k]=0;for(k=32301;32360>=k;k++)e[k]=0;for(k=32601;32662>=k;k++)e[k]=0;for(k=32664;32667>=k;k++)e[k]=2;for(k=32701;32761>=k;k++)e[k]=0;for(k=53001;53004>=k;k++)e[k]=0;for(k=53008;53019>=k;k++)e[k]=0;for(k=53021;53032>=k;k++)e[k]=0;for(k=53042;53046>=k;k++)e[k]=0;for(k=53074;53080>=k;k++)e[k]=0;for(k=54001;54004>=k;k++)e[k]=0;for(k=54008;54019>=k;k++)e[k]=0;for(k=54021;54032>=
k;k++)e[k]=0;for(k=54042;54046>=k;k++)e[k]=0;for(k=54048;54053>=k;k++)e[k]=0;for(k=54074;54080>=k;k++)e[k]=0;for(k=102001;102040>=k;k++)e[k]=0;for(k=102042;102063>=k;k++)e[k]=0;for(k=102065;102067>=k;k++)e[k]=0;for(k=102070;102117>=k;k++)e[k]=0;for(k=102122;102216>=k;k++)e[k]=0;for(k=102221;102377>=k;k++)e[k]=0;for(k=102382;102388>=k;k++)e[k]=0;for(k=102389;102398>=k;k++)e[k]=2;for(k=102399;102444>=k;k++)e[k]=0;for(k=102445;102447>=k;k++)e[k]=2;for(k=102448;102458>=k;k++)e[k]=0;for(k=102459;102468>=
k;k++)e[k]=2;for(k=102469;102496>=k;k++)e[k]=0;for(k=102500;102519>=k;k++)e[k]=1;for(k=102520;102524>=k;k++)e[k]=0;for(k=102525;102529>=k;k++)e[k]=2;for(k=102530;102568>=k;k++)e[k]=0;for(k=102570;102588>=k;k++)e[k]=0;for(k=102590;102598>=k;k++)e[k]=0;for(k=102601;102603>=k;k++)e[k]=0;for(k=102605;102628>=k;k++)e[k]=0;for(k=102629;102646>=k;k++)e[k]=2;for(k=102648;102700>=k;k++)e[k]=2;for(k=102701;102703>=k;k++)e[k]=0;for(k=102707;102730>=k;k++)e[k]=2;for(k=102733;102758>=k;k++)e[k]=2;for(k=102767;102900>=
k;k++)e[k]=0;for(k=102965;102969>=k;k++)e[k]=0;for(k=102971;102973>=k;k++)e[k]=0;for(k=102975;102989>=k;k++)e[k]=0;for(k=102990;102992>=k;k++)e[k]=1;for(k=102997;103002>=k;k++)e[k]=0;for(k=103003;103008>=k;k++)e[k]=2;for(k=103009;103011>=k;k++)e[k]=0;for(k=103012;103014>=k;k++)e[k]=2;for(k=103019;103021>=k;k++)e[k]=0;for(k=103022;103024>=k;k++)e[k]=2;for(k=103029;103031>=k;k++)e[k]=0;for(k=103032;103034>=k;k++)e[k]=2;for(k=103065;103068>=k;k++)e[k]=0;for(k=103074;103076>=k;k++)e[k]=0;for(k=103077;103079>=
k;k++)e[k]=1;for(k=103080;103082>=k;k++)e[k]=0;for(k=103083;103085>=k;k++)e[k]=2;for(k=103090;103093>=k;k++)e[k]=0;for(k=103097;103099>=k;k++)e[k]=0;for(k=103100;103102>=k;k++)e[k]=2;for(k=103107;103109>=k;k++)e[k]=0;for(k=103110;103112>=k;k++)e[k]=2;for(k=103113;103116>=k;k++)e[k]=0;for(k=103117;103120>=k;k++)e[k]=2;for(k=103153;103157>=k;k++)e[k]=0;for(k=103158;103162>=k;k++)e[k]=2;for(k=103163;103165>=k;k++)e[k]=0;for(k=103166;103168>=k;k++)e[k]=1;for(k=103169;103171>=k;k++)e[k]=2;for(k=103186;103188>=
k;k++)e[k]=0;for(k=103189;103191>=k;k++)e[k]=2;for(k=103192;103195>=k;k++)e[k]=0;for(k=103196;103199>=k;k++)e[k]=2;for(k=103200;103224>=k;k++)e[k]=0;for(k=103225;103227>=k;k++)e[k]=1;for(k=103232;103237>=k;k++)e[k]=0;for(k=103238;103243>=k;k++)e[k]=2;for(k=103244;103246>=k;k++)e[k]=0;for(k=103247;103249>=k;k++)e[k]=2;for(k=103254;103256>=k;k++)e[k]=0;for(k=103257;103259>=k;k++)e[k]=2;for(k=103264;103266>=k;k++)e[k]=0;for(k=103267;103269>=k;k++)e[k]=2;for(k=103300;103375>=k;k++)e[k]=0;for(k=103381;103383>=
k;k++)e[k]=0;for(k=103384;103386>=k;k++)e[k]=1;for(k=103387;103389>=k;k++)e[k]=0;for(k=103390;103392>=k;k++)e[k]=2;for(k=103397;103399>=k;k++)e[k]=0;for(k=103400;103471>=k;k++)e[k]=2;for(k=103476;103478>=k;k++)e[k]=0;for(k=103479;103481>=k;k++)e[k]=2;for(k=103486;103488>=k;k++)e[k]=0;for(k=103489;103491>=k;k++)e[k]=2;for(k=103492;103495>=k;k++)e[k]=0;for(k=103496;103499>=k;k++)e[k]=2;for(k=103528;103543>=k;k++)e[k]=0;for(k=103544;103548>=k;k++)e[k]=2;for(k=103549;103551>=k;k++)e[k]=0;for(k=103552;103554>=
k;k++)e[k]=1;for(k=103555;103557>=k;k++)e[k]=2;for(k=103558;103560>=k;k++)e[k]=0;for(k=103571;103573>=k;k++)e[k]=0;for(k=103574;103576>=k;k++)e[k]=2;for(k=103577;103580>=k;k++)e[k]=0;for(k=103581;103583>=k;k++)e[k]=2;for(k=103600;103694>=k;k++)e[k]=0;for(k=103700;103793>=k;k++)e[k]=2;for(k=103794;103871>=k;k++)e[k]=0;for(k=103900;103971>=k;k++)e[k]=2;return e})},"esri/geometry/screenUtils":function(){define("dojo/_base/array dojo/_base/lang dojo/sniff ../kernel ./Point ./ScreenPoint ./Polyline ./Polygon ./Multipoint ./Extent".split(" "),
function(k,e,p,q,n,l,h,f,d,c){var a=function(){return 9>p("ie")?function(a,c,d,m,f,t,v,h,l){var b=[],g=Math.round,r,u=v.length,w,n,e,k,y,p;for(r=0;r<u;r++)if(w=v[r],k=h?h(w[0][0],w[0][1],l):w[0],1<(e=w.length))for(y=g((k[0]-a)*d+f),p=g((c-k[1])*m+t),k=h?h(w[1][0],w[1][1],l):w[1],n=g((k[0]-a)*d+f),k=g((c-k[1])*m+t),b.push("M",y+","+p,"L",n+","+k),n=2;n<e;n++)k=h?h(w[n][0],w[n][1],l):w[n],y=g((k[0]-a)*d+f),p=g((c-k[1])*m+t),b.push(y+","+p);else y=g((k[0]-a)*d+f),p=g((c-k[1])*m+t),b.push("M",y+","+p);
return b}:function(a,c,d,m,f,t,v,h,w,l){var b=[],g,r,u,n,e,k,z=Math.round;g=0;for(u=v?v.length:0;g<u;g++){e=v[g];b.push("M");r=0;for(n=e?e.length:0;r<n;r++)k=h?h(e[r][0],e[r][1],w):e[r],b.push(z((k[0]-a)*d+f)+","+z((c-k[1])*m+t));l||b.push("Z")}return b}}();return{toScreenPoint:function(a,c,d,m,f){var b=a.spatialReference,g=m.spatialReference,r=m.x;m=m.y;b&&g&&!b.equals(g)&&b._canProject(g)&&(b=b.isWebMercator()?n.lngLatToXY(r,m):n.xyToLngLat(r,m,!0),r=b[0],m=b[1]);r=(r-a.xmin)*(c/a.getWidth());m=
(a.ymax-m)*(d/a.getHeight());f||(r=Math.round(r),m=Math.round(m));return new l(r,m)},toScreenGeometry:function(a,g,u,m){var b=a.xmin,t=a.ymax,v=g/a.getWidth(),l=u/a.getHeight(),w=k.forEach,e=Math.round;if(m instanceof n)return new n(e((m.x-b)*v),e((t-m.y)*l));if(m instanceof d){a=new d;var x=a.points;w(m.points,function(a,c){x[c]=[e((a[0]-b)*v),e((t-a[1])*l)]});return a}if(m instanceof c)return new c(e((m.xmin-b)*v),e((t-m.ymin)*l),e((m.xmax-b)*v),e((t-m.ymax)*v));if(m instanceof h){a=new h;var p=
a.paths,q;w(m.paths,function(a,c){q=p[c]=[];w(a,function(a,c){q[c]=[e((a[0]-b)*v),e((t-a[1])*l)]})});return a}if(m instanceof f){a=new f;var B=a.rings,E;w(m.rings,function(a,c){E=B[c]=[];w(a,function(a,c){E[c]=[e((a[0]-b)*v),e((t-a[1])*l)]})});return a}},_toScreenPath:function(b,c,d,m,f,t){var g=m instanceof h,r=b.spatialReference,u=m.spatialReference,l,e;r&&u&&!r.equals(u)&&r._canProject(u)&&(r.isWebMercator()?l=n.lngLatToXY:(l=n.xyToLngLat,e=!0));return a(b.xmin,b.ymax,c/b.getWidth(),d/b.getHeight(),
f,t,g?m.paths:m.rings,l,e,g)},toMapPoint:function(a,c,d,m){return new n(a.xmin+m.x/(c/a.getWidth()),a.ymax-m.y/(d/a.getHeight()),a.spatialReference)},toMapGeometry:function(a,g,u,m){var b=a.xmin,t=a.ymax,v=a.spatialReference,l=g/a.getWidth(),w=u/a.getHeight(),e=k.forEach;if(m instanceof n)return new n(b+m.x/l,t-m.y/w,v);if(m instanceof d){a=new d(v);var x=a.points;e(m.points,function(a,c){x[c]=[b+a[0]/l,t-a[1]/w]});return a}if(m instanceof c)return new c(b+m.xmin/l,t-m.ymin/w,b+m.xmax/l,t-m.ymax/
w,v);if(m instanceof h){a=new h(v);var p=a.paths,q;e(m.paths,function(a,c){q=p[c]=[];e(a,function(a,c){q[c]=[b+a[0]/l,t-a[1]/w]})});return a}if(m instanceof f){a=new f(v);var B=a.rings,E;e(m.rings,function(a,c){E=B[c]=[];e(a,function(a,c){E[c]=[b+a[0]/l,t-a[1]/w]})});return a}}}})},"esri/layers/GraphicsLayer":function(){define("dojo/_base/declare dojo/_base/connect dojo/_base/lang dojo/_base/array dojo/_base/window dojo/dom-attr dojo/dom-construct dojo/dom-style dojo/dom dojox/gfx dojox/gfx/matrix ./gfxSniff!esri-svg?dojox/gfx/filters ./layer ../kernel ../lang ../sniff ../Color ../domUtils ../symbols/MarkerSymbol ../symbols/SimpleMarkerSymbol ../symbols/utils ../geometry/Point ../geometry/ScreenPoint ../geometry/Extent ../geometry/mathUtils ../geometry/screenUtils ../PluginTarget ./gfxSniff!esri-svg?dojox/gfx/svgext".split(" "),
function(k,e,p,q,n,l,h,f,d,c,a,b,g,u,m,r,t,v,y,w,z,x,A,C,B,E,D){var F,I=-1!==c.renderer.toLowerCase().indexOf("svg"),M=-1!==c.renderer.toLowerCase().indexOf("canvas");n=M?"canvas-2d":c.renderer;var L=9>r("ie");y=10===r("ie");var J=void 0===r("ie")&&7==r("trident"),P=y||J,K=r("esri-touch");y=k(null,{declaredClass:"esri.layers._GraphicsContainer",_setMap:function(a,b){var d,g=this._connects=[];this._map=a;this._useWillChange="css-transforms"===a.navigationMode&&I&&r("esri-will-change");M?(d=h.create("div",
{style:"overflow: visible; position: absolute;"},b),this._surface={getEventSource:function(){return d}},g.push(e.connect(d,"onmousedown",this,this._canvasDownHandler)),g.push(e.connect(d,"onmouseup",this,this._canvasUpHandler)),g.push(e.connect(d,"onclick",this,this._canvasClickHandler)),F.prototype._canvas=!0):(d=(this._surface=c.createSurface(b,a.width,a.height)).getEventSource(),this._useWillChange&&f.set(d,"will-change","transform"),f.set(d=L?d.parentNode:d,{overflow:"visible",position:"absolute"}));
g.push(e.connect(a,"onResize",this,"_onResizeHandler"));this._useWillChange&&(g.push(e.connect(a,"onPan",this,"_onPanHandler")),g.push(e.connect(a,"onPanEnd",this,"_onPanEndHandler")),g.push(e.connect(a,"onExtentChange",this,"_onExtentChangeHandler")));return d},_onPanHandler:function(a,b){var c=this._map.__visibleRect;a=c.x+b.x;b=c.y+b.y;this._panDx=a;this._panDy=b;f.set(this._surface.getEventSource(),u._css.names.transform,u._css.translate(a,b))},_onPanEndHandler:function(a,b){b=this._map.__visibleRect;
a=b.x;b=b.y;this._panDx=a;this._panDy=b;f.set(this._surface.getEventSource(),u._css.names.transform,u._css.translate(a,b))},_onExtentChangeHandler:function(a,b,c,d){c&&(this._panDy=this._panDx=0,f.set(this._surface.getEventSource(),u._css.names.transform,u._css.translate(0,0)))},_getTransform:function(){return{dx:this._panDx||0,dy:this._panDy||0}},_onResizeHandler:function(a,b,c){a=this._surface.getEventSource();var d=this._map,g;L&&f.set(a=a.parentNode,{width:b+"px",height:c+"px",clip:"rect(0px "+
b+"px "+c+"px 0px)"});l.set(a,"width",b);l.set(a,"height",c);this._surface.declaredClass||q.forEach(a.childNodes,function(a){l.set(a,"width",b);l.set(a,"height",c)});d.loaded&&(d.graphics.suspended||(d.graphics._resized=!0),q.forEach(d.graphicsLayerIds,function(a){g=d.getLayer(a);g.suspended||(g._resized=!0,g._childLayer&&(g._childLayer._resized=!0));g._updateSVGFilters(null,null,b,c)}),d.graphics._updateSVGFilters(null,null,b,c),d._labels&&d._labels._updateSVGFilters(null,null,b,c))},_cleanUp:function(){q.forEach(this._connects,
e.disconnect,e);this._map=this._surface=null},_processEvent:function(a){var b=this._map;a.screenPoint=new A(a.pageX-b.position.x,a.pageY-b.position.y);a.mapPoint=b.toMap(a.screenPoint)},_canvasDownHandler:function(a){this._processEvent(a);this._downPt=a.screenPoint.x+","+a.screenPoint.y},_canvasUpHandler:function(a){this._processEvent(a);this._upPt=a.screenPoint.x+","+a.screenPoint.y},_tolerance:15,_isPrimaryMatch:function(a,b,c,d){if(!a.visible||!b)return!1;var g=b.getTransformedBoundingBox(),m;
return g?(m=new C(g[0].x,g[0].y,g[2].x,g[2].y),delete m.spatialReference,K?m.intersects(c):m.contains(d)):q.some(b.children||[],function(a){g=a.getTransformedBoundingBox();m=new C(g[0].x,g[0].y,g[2].x,g[2].y);delete m.spatialReference;return K?m.intersects(c):m.contains(d)})},_canvasClickHandler:function(a){if(this._downPt&&this._upPt&&this._downPt===this._upPt){this._processEvent(a);var b=this._map,c=q.map(b.graphicsLayerIds,function(a){return b.getLayer(a)});c.push(b.graphics);c.reverse();var c=
q.filter(c,function(a){return a.loaded&&a._mouseEvents&&!a.suspended&&(!m.isDefined(a.opacity)||0<a.opacity)}),d=a.screenPoint,g=this._tolerance,f=d.x-g,r=d.y+g,t=d.x+g,g=d.y-g,v=new C(f,g,t,r),f=b.toMap(new A(f,r)),t=b.toMap(new A(t,g)),r=f.spatialReference._getInfo(),u=new C(C.prototype._normalizeX(f.x,r).x,f.y,C.prototype._normalizeX(t.x,r).x,t.y,f.spatialReference),h;delete v.spatialReference;q.some(c,function(a){a=q.filter(a.graphics,function(a){return this._isPrimaryMatch(a,a.getDojoShape(),
v,d)||!(!a._bgShape||!this._isPrimaryMatch(a,a._bgShape,v,d))},this);a.reverse();if(0<a.length){var b;q.some(a,function(a){return a.geometry&&u.intersects(a.geometry)?(b=a,!0):!1});if(b)return h=b,!0}return!1},this);h&&(c=h.getLayer())&&(a.graphic=h,c.onClick(a))}}});F=k(g,{declaredClass:"esri.layers._GraphicsLayer",managedSuspension:!0,surfaceType:n,renderer:null,_eventMap:{"graphic-add":["graphic"],"graphic-remove":["graphic"],"renderer-change":["renderer"]},_suspendGraphics:!1,constructor:function(a,
b){a=a||{};if(p.isString(a)||p.isObject(a)&&(a.layerDefinition||a.query))a=b;this._params=p.mixin({displayOnPan:!0,drawMode:!0,styling:!0},a);b=this._params.dataAttributes;"string"===typeof b&&(b=[b]);this.styling=I?this._params.styling:!0;this.dataAttributes=b;this.infoTemplate=a&&a.infoTemplate;this.graphics=[];this._draw=p.hitch(this,this._draw);this._refresh=p.hitch(this,this._refresh);this._acquireSVGMarker=p.hitch(this,this._acquireSVGMarker);this.registerConnectEvents()},getNode:function(){return this._div&&
this._div.getEventSource()},setDrawMode:function(a){this._params.drawMode=a},suspendGraphics:function(a){this._suspendGraphics=a;q.forEach(this.graphics,function(b){b._suspended=a})},_setMap:function(a,b){this.inherited(arguments);this._map=a;this._wrap=a.wrapAround180;this._srInfo=a.spatialReference._getInfo();this._svgFilters={};this._lineMarkers={};this._canvas?(b=c.createSurface(b.getEventSource(),a.width,a.height),f.set(b.rawNode,"position","absolute"),this._div=b.createGroup(),this._renderProto=
this._div.constructor.prototype._render,this._div._render=p.hitch(this,this._canvasRender)):this._div=b.createGroup();this._bgGroup=this._div.createGroup();this._div.getEventSource().id=this.id+"_layer";this._initOpacity();return this._div},_unsetMap:function(a,b){q.forEach(this.graphics,function(a){a._shape=null});this._canvas?(b=this._div.getParent(),b._parent={},h.destroy(b.rawNode),b.destroy()):(this._div.clear(),b.remove(this._div),h.destroy(this._div.getEventSource()));this._map=this._div=this._svgFilters=
this._lineMarkers=null;clearTimeout(this._wakeTimer);this._wakeTimer=null;this._disableDrawConnectors();this.inherited(arguments)},_initOpacity:function(){var a=this.opacity;m.isDefined(a)&&1>a&&this.setOpacity(a,!0)},_onZoomStartHandler:function(){v.hide(this._div.getEventSource())},_onExtentChangeHandler:function(a,b,c,d){clearTimeout(this._wakeTimer);this._wakeTimer=null;c?(a=this._map.__visibleRect,b=this._div,this._evalSDRenderer(),this._refresh(!0),this._params._child||this._updateTransform(b,
a.x,a.y,!0),this._renderProto&&b.surface.pendingRender?this._dirty=!0:this.suspended||v.show(b.getEventSource())):this._resized&&(this._resized=!1,this._refresh(!1));if(0<this.graphics.length)this.onUpdate()},_canvasRender:function(){var a=this._div;this._dirty&&(delete this._dirty,this.suspended||v.show(a.getEventSource()));return this._renderProto.apply(a,arguments)},_refresh:function(a){var b=this.graphics,c=b.length,d,g=this._draw;for(d=0;d<c;d++)g(b[d],a)},refresh:function(){this._refresh(!0)},
redraw:function(){this._refresh(!0)},_getTransform:function(){var a={dx:0,dy:0};this._map&&(this._map._gc._useWillChange?a=this._map._gc._getTransform():this._div&&(a=this._div.getTransform()));return a},_onPanHandler:function(a,b){this._panDx=b.x;this._panDy=b.y;a=this._map.__visibleRect;this._updateTransform(this._div,a.x+b.x,a.y+b.y);J&&this._updateSVGMarkers()},_onPanEndUpdateHandler:function(a,b){a=this._map.__visibleRect;this._params._child||b.x===this._panDx&&b.y===this._panDy?(this._updateSVGFilters(-a.x,
-a.y),this._updateSVGMarkers()):this._updateTransform(this._div,a.x,a.y,!0);this._refresh(!1);if(this.graphics.length)this.onUpdate()},_onPanStartHandler:function(){v.hide(this._div.getEventSource())},_onPanEndHandler:function(){var a=this._map.__visibleRect,b=this._div;this._updateTransform(b,a.x,a.y,!0);this._refresh(!1);this._renderProto&&b.surface.pendingRender?this._dirty=!0:v.show(b.getEventSource());if(this.graphics.length)this.onUpdate()},_updateTransform:function(b,c,d,g){this._map._gc._useWillChange||
b.setTransform(a.translate({x:c,y:d}));g&&(this._updateSVGFilters(-c,-d),this._updateSVGMarkers())},onSuspend:function(){this.inherited(arguments);v.hide(this._div.getEventSource());clearTimeout(this._wakeTimer);this._wakeTimer=null;this._disableDrawConnectors()},onResume:function(a){this.inherited(arguments);a.firstOccurrence&&this._evalSDRenderer();this._enableDrawConnectors();this._wakeTimer=this._wakeTimer||setTimeout(p.hitch(this,function(){this.suspended||this._map.__zooming||this._onExtentChangeHandler(null,
null,!0)}),0)},_enableDrawConnectors:function(){var a=this._map,b=e.connect;this._disableDrawConnectors();this._params.displayOnPan?(this._params._child||(this._onPanHandler_connect=b(a,"onPan",this,"_onPanHandler")),this._onPanEndHandler_connect=b(a,"onPanEnd",this,"_onPanEndUpdateHandler")):(this._onPanStartHandler_connect=b(a,"onPanStart",this,"_onPanStartHandler"),this._onPanEndHandler_connect=b(a,"onPanEnd",this,"_onPanEndHandler"));this._onZoomStartHandler_connect=b(a,"onZoomStart",this,"_onZoomStartHandler");
this._onExtentChangeHandler_connect=b(a,"onExtentChange",this,"_onExtentChangeHandler")},_disableDrawConnectors:function(){var a=e.disconnect;a(this._onExtentChangeHandler_connect);a(this._onZoomStartHandler_connect);a(this._onPanHandler_connect);a(this._onPanStartHandler_connect);a(this._onPanEndHandler_connect);this._onExtentChangeHandler_connect=this._onZoomStartHandler_connect=this._onPanHandler_connect=this._onPanStartHandler_connect=this._onPanEndHandler_connect=null},_updateExtent:function(a){var b=
a.geometry;if(!b)a._extent=null;else if(!(a._extent=b.getExtent())){var c,d;if("esri.geometry.Point"===b.declaredClass)c=b.x,d=b.y;else if("esri.geometry.Multipoint"===b.declaredClass)c=b.points[0][0],d=b.points[0][1];else{a._extent=null;return}a._extent=new C(c,d,c,d,b.spatialReference)}},_intersects:function(a,b,c){var d=a.spatialReference,g=b.spatialReference,m=d&&g&&!d.equals(g)&&d._canProject(g)&&4326===g.wkid;if(this._wrap&&!c){c=[];var d=a._getFrameWidth(),f=this._srInfo,r=a._clip?a._getAvailExtent():
a.extent,t,v,u,h,l=[];t=b._partwise;m&&(r=a.geographicExtent,f=g._getInfo());a=r._getParts(f);if(t&&t.length)for(b=[],g=0,m=t.length;g<m;g++)b=b.concat(t[g]._getParts(f));else b=b._getParts(f);g=0;for(m=b.length;g<m;g++)for(u=b[g],f=0,r=a.length;f<r;f++)if(h=a[f],h.extent.intersects(u.extent))for(t=0,v=u.frameIds.length;t<v;t++)c.push((h.frameIds[0]-u.frameIds[t])*d);g=0;for(m=c.length;g<m;g++)t=c[g],q.indexOf(c,t)===g&&l.push(t);return l.length?l:null}return(m?a.geographicExtent:a.extent).intersects(b)?
[0]:null},_defaultMarker:{type:"simplemarkersymbol",style:"square",size:1,xoffset:0,yoffset:0,angle:0},_draw:function(a,b){if(this._params.drawMode&&this._map&&!this.suspended&&!this._map.__zooming&&!this._resized)try{var c=a._extent,d,g,m=!I||this.styling,f=I&&this.dataAttributes,r=a.getDojoShape(),t;if(!a._suspended&&a.visible&&c&&(d=this._intersects(this._map,c,a.geometry._originOnly))&&(g=m?this._getSymbol(a):this._defaultMarker)){if(a._offsets&&a._offsets.join(",")===d.join(",")?t=!0:a._offsets=
d,!r||b||!t){var v=a.geometry.type;b={graphic:a};var u=a._bgShape,h=m&&!a.symbol?this._getRenderer(a):null,l=h&&h.backgroundFillSymbol;if("point"===v)this._isInvalidShape(g,r)&&this._removeShape(a),a._shape=this._drawPoint(this._div,a.geometry,g,a.getDojoShape(),d,h,a),m&&this._symbolizePoint(a.getDojoShape(),g,h,a);else if("multipoint"===v)this._drawMarkers(a,g,d,h),m&&this._symbolizeMarkers(a,g,h);else{var w,v=g,n,e,k;m&&(v=(w="simplemarkersymbol"===g.type||"picturemarkersymbol"===g.type||"textsymbol"===
g.type?g:null)?l:g);m&&v&&-1<v.type.indexOf("fillsymbol")&&(n=this._bgGroup,k=!(!n||!w));u&&!k&&this._removeBgShape(a);v&&(!k&&this._isInvalidShape(v,a._shape)&&this._removeShape(a,!1),e=this._drawShape(a,d,n||this._div,k?u:a.getDojoShape()),m&&this._symbolizeShape(e,v,h,v===l,a),a[k?"_bgShape":"_shape"]=e);if(w){this._isInvalidShape(w,a._shape)&&this._removeShape(a,!1);var z=a.geometry.getCentroid();(e=z&&this._drawPoint(this._div,z,w,a._shape,d,h,a))&&this._symbolizePoint(e,w,h,a);a._shape=e}}M||
(a._bgShape&&this._initNode(a,a._bgShape,a._bgShape!==u,b,f),a._shape&&this._initNode(a,a._shape,a._shape!==r,b,f));a._applyDataAttrs();b.node=a.getNode();this.onGraphicDraw(b)}}else r&&this._removeShape(a)}catch(la){this._errorHandler(la,a)}},_initNode:function(a,b,c,d,g){if(b=b&&b.getNode())b.e_graphic=a,this._addDataAttrs(a,g,b),c&&(d.node=b,this.onGraphicNodeAdd(d))},_removeShape:function(a,b,c){var d=a.getDojoShape(),g=d&&d.getNode();d&&!c&&(d.removeShape(),d.destroy());a._shape=a._offsets=null;
!1!==b&&this._removeBgShape(a,c);if(g&&(g.e_graphic=null,!M))this.onGraphicNodeRemove({graphic:a,node:g})},_removeBgShape:function(a,b){var c=a._bgShape,d=c&&c.getNode();c&&!b&&(c.removeShape(),c.destroy());a._bgShape=null;if(d&&(d.e_graphic=null,!M))this.onGraphicNodeRemove({graphic:a,node:d})},_addDataAttrs:function(a,b,c){var d=a.attributes,g,m=b?b.length:0,f=this._getRenderer(a);if(c&&d){for(g=0;g<m;g++)(c=b[g])&&a.attr("data-"+c,d[c]);!this.styling&&f&&(f.getBreakIndex?(b=f.getBreakIndex(a),
a.attr("data-class-break",-1!==b?b:null)):f.getUniqueValueInfo&&(b=f.getUniqueValueInfo(a),a.attr("data-unique-value",b?b.value:null)))}},_drawShape:function(a,b,c,d){a=a.geometry;var g=a.type,m=this._map,f=m.extent,r=m.width,t=m.height,m=m.__visibleRect,v=[],u,h;u="extent"===g;if("rect"===g||u)v={x:0,y:0,spatialReference:a.spatialReference},v.x=u?a.xmin:a.x,v.y=u?a.ymax:a.y,g=E.toScreenPoint(f,r,t,v),v.x=u?a.xmax:a.x+a.width,v.y=u?a.ymin:a.y+a.height,a=E.toScreenPoint(f,r,t,v),b={x:g.x-m.x+b[0],
y:g.y-m.y,width:Math.abs(a.x-g.x),height:Math.abs(a.y-g.y)},0===b.width&&(b.width=1),0===b.height&&(b.height=1),d=this._drawRect(c,d,b);else if("polyline"===g||"polygon"===g){u=0;for(h=b.length;u<h;u++)v=v.concat(E._toScreenPath(f,r,t,a,-m.x+b[u],-m.y));d=this._drawPath(c,d,v);this._rendererLimits&&("polyline"===g?this._clipPolyline(d,a):this._clipPolygon(d,a))}return d},_drawRect:function(a,b,c){return b?b.setShape(c):a.createRect(c)},_drawImage:function(a,b,c){return b?b.setShape(c):a.createImage(c)},
_drawCircle:function(a,b,c){return b?b.setShape(c):a.createCircle(c)},_drawPath:function(){return L?function(a,b,d,g){d=g?d:d.join(" ");if(b)return b.setShape(d);b=a.createObject(g?c.Path:c.EsriPath,d);a._overrideSize(b.getEventSource());return b}:function(a,b,c,d){c=d?c:c.join(" ");return b?b.setShape(c):a.createPath(c)}}(),_drawText:function(a,b,c){return b?b.setShape(c):a.createText(c)},_evalSDRenderer:function(a){var b=this._map,c=this.renderer,d,g=this._rndForScale;b&&b.loaded&&c&&c.getRendererInfo&&
(d="zoom"===c.rangeType?c.getRendererInfoByZoom(b.getZoom()):c.getRendererInfoByScale(b.getScale()));this._rndForScale=d&&d.renderer;a||this._rndForScale==g||this.emit("renderer-change",{renderer:this._rndForScale})},_getRenderer:function(a){var b=this._rndForScale||this.renderer;a&&b&&b.getObservationRenderer&&(b=b.getObservationRenderer(a));return b},_getSymbol:function(a){var b=this._getRenderer();return a.symbol||b&&b.getSymbol(a)},_getVariable:function(a,b,c){var d;a&&(d=(a=a.getVisualVariablesForType(b,
c))&&a[0]);return d},_applyOpacity:function(a,b,c,d){b=b.getOpacity(d,{opacityInfo:c});null!=b&&(a=new t(a),a.a=b);return a},_symbolizeShape:function(a,b,c,d,g){var m=b.getStroke(),f=b.getFill(),r=b.type,t,v,u=-1!==r.indexOf("linesymbol"),h=-1!==r.indexOf("fillsymbol")?null:this._getVariable(c,"sizeInfo",!1),l=this._getVariable(c,"colorInfo",!1),w=this._getVariable(c,"opacityInfo",!1),n=u?"none"!==b.style:b.outline&&"none"!==b.outline.style,e=u?null:this._getVariable(c,"sizeInfo","outline"),h=(h=
d?e:e||h)?c.getSize(g,{sizeInfo:h,resolution:this._map.getResolutionInMeters(),scale:this._map.getScale()}):null;d&&(l=w=null);(l||w)&&"picturefillsymbol"!==r&&(u?(t=m&&m.color,l&&(t=c.getColor(g,{colorInfo:l})||t),t&&w&&(t=this._applyOpacity(t,c,w,g))):f&&f.toCss&&(v=f,l&&(v=c.getColor(g,{colorInfo:l})||v),v&&w&&(v=this._applyOpacity(v,c,w,g))));a.setStroke(!n||null==h&&!t?m:p.mixin({},m,null!=h?{width:h}:null,t&&{color:t})).setFill(v||f);u&&z.applyLineMarker(a,b,t,this._acquireSVGMarker)},_smsToPath:function(){return L?
function(a,b,c,d,g,m,f,r,t){switch(b){case a.STYLE_SQUARE:return["M",g+","+f,"L",m+","+f,m+","+r,g+","+r,"X","E"];case a.STYLE_CROSS:return["M",c+","+f,"L",c+","+r,"M",g+","+d,"L",m+","+d,"E"];case a.STYLE_X:return["M",g+","+f,"L",m+","+r,"M",g+","+r,"L",m+","+f,"E"];case a.STYLE_DIAMOND:return["M",c+","+f,"L",m+","+d,c+","+r,g+","+d,"X","E"];case a.STYLE_TARGET:return["M",g+","+f,"L",m+","+f,m+","+r,g+","+r,g+","+f,"M",g-t+","+d,"L",g+","+d,"M",c+","+(f-t),"L",c+","+f,"M",m+t+","+d,"L",m+","+d,"M",
c+","+(r+t),"L",c+","+r,"E"]}}:function(a,b,c,d,g,m,f,r,t){switch(b){case a.STYLE_SQUARE:return["M",g+","+f,m+","+f,m+","+r,g+","+r,"Z"];case a.STYLE_CROSS:return["M",c+","+f,c+","+r,"M",g+","+d,m+","+d];case a.STYLE_X:return["M",g+","+f,m+","+r,"M",g+","+r,m+","+f];case a.STYLE_DIAMOND:return["M",c+","+f,m+","+d,c+","+r,g+","+d,"Z"];case a.STYLE_TARGET:return["M",g+","+f,m+","+f,m+","+r,g+","+r,g+","+f,"M",g-t+","+d,g+","+d,"M",c+","+(f-t),c+","+f,"M",m+t+","+d,m+","+d,"M",c+","+(r+t),c+","+r]}}}(),
_pathStyles:{square:1,cross:1,x:1,diamond:1,target:1},_typeMaps:{picturemarkersymbol:"image",picturefillsymbol:"path",simplefillsymbol:"path",simplelinesymbol:"path",cartographiclinesymbol:"path",textsymbol:"text"},_isInvalidShape:function(a,b){b=b&&b.shape&&b.shape.type;var c=a&&a.type;a=a&&a.style;"rect"===b&&(b="path");c&&(a=this._typeMaps[c]||a);this._pathStyles[a]&&(a="path");return"shieldlabelsymbol"===c?!0:!(!b||!a||b===a)},_reArialFont:/\s*(^|,)\s*arial\s*(,|$)\s*/i,_fallbackFont:"Arial",
_drawPoint:function(b,c,d,g,m,f,r){var t=d.type,v=this._map,u=v.__visibleRect,h=E.toScreenPoint(v.extent,v.width,v.height,c).offset(-u.x+m[0],-u.y),u=h.x,l=h.y,n;c=[];var e,k=this._getVariable(f,"rotationInfo",!1),k=k?f.getRotationAngle(r,{rotationInfo:k}):null,z=this._getVariable(f,"sizeInfo",!1),v=z?f.getSize(r,{sizeInfo:z,shape:d.style,resolution:v.getResolutionInMeters(),scale:v.getScale()}):r.size;k&&c.push(a.rotategAt(k,h));if(0!==d.xoffset||0!==d.yoffset)e=a.translate(d.xoffset,-d.yoffset),
c.push(e);0!==d.angle&&c.push(a.rotategAt(d.angle,h));if("simplemarkersymbol"===t)switch(n=d.style,f=Math.round,v=null!=v?v:d.size,n){case w.STYLE_SQUARE:case w.STYLE_CROSS:case w.STYLE_X:case w.STYLE_DIAMOND:d=isNaN(v)?16:v/2;n=this._drawPath(b,g,this._smsToPath(w,n,u,l,f(u-d),f(u+d),f(l-d),f(l+d)));break;case w.STYLE_TARGET:r=d._targetWidth/2;h=d._targetHeight/2;n=this._drawPath(b,g,this._smsToPath(w,n,u,l,f(u-r),f(u+r),f(l-h),f(l+h),d._spikeSize));break;case w.STYLE_PATH:n=this._drawPath(b,g,d.path,
!0);d=n.getBoundingBox();b=this._getScaleMatrix(d,v);1===b.xx&&1===b.yy||c.push(a.scaleAt(b.xx,b.yy,h));c.push(a.translate(-(d.x+d.width/2)+u,-(d.y+d.height/2)+l));break;default:d=isNaN(v)?16:v/2,n=this._drawCircle(b,g,{cx:u,cy:l,r:d})}else if("shieldlabelsymbol"===t)n=d.width,h=d.height,g=b.createGroup(),n=b.createImage({x:u-n/2,y:l-h/2,width:n,height:h,src:d.url}),g.add(n),null!=d.font&&(l+=.2*d.getHeight(),b=b.createText({type:"text",text:d.text,x:u,y:l,align:"middle",decoration:d.decoration,rotated:d.rotated,
kerning:d.kerning}),b.setFont(d.font),b.setFill(d.color),g.add(b)),n=g;else if("picturemarkersymbol"===t){if(null==v?(n=d.width,h=d.height):(h=v,n=d.width/d.height*h,e&&(null!=e.dx&&(e.dx=e.dx/d.width*n),null!=e.dy&&(e.dy=e.dy/d.height*h))),n=this._drawImage(b,g,{x:u-n/2,y:l-h/2,width:n,height:h,src:d.url}),I&&(b=n.getNode()))d=(d=this._getVariable(f,"opacityInfo",!1))?f.getOpacity(r,{opacityInfo:d}):null,null!=d?b.setAttribute("opacity",d):b.setAttribute("opacity",1)}else if("textsymbol"===t){if(f=
d.font){n=null!=v;r=f.family&&!this._reArialFont.test(f.family);if(n||r)f=new f.constructor(f.toJson());n&&f.setSize(v);r&&f.setFamily(f.family+","+this._fallbackFont)}n=this._drawText(b,g,{type:"text",text:d.text,x:u,y:l,align:d.getSVGAlign(),decoration:d.decoration||f&&f.decoration,rotated:d.rotated,kerning:d.kerning});f&&n.setFont(f);I&&(b=n.getNode(),u=d.getSVGBaseline(),l=d.getSVGBaselineShift(),b&&(b.setAttribute("dominant-baseline",u),l&&b.setAttribute("baseline-shift",l),this._applyHalo(n,
d.haloColor,d.haloSize)))}n.setTransform(a.multiply(c));n._wrapOffsets=m;return n},_acquireSVGMarker:function(a,b,c,d){a=this._getSVGMarkerId(b,d);var g=this._getSVGMarker(a);g||(g=z.createSVGMarker(b,a,c,d),this._div.getParent().defNode.appendChild(g),this._lineMarkers[a]=g);return g},_getSVGMarkerId:function(a,b){return"marker_"+this._map.id+"_"+a.r+"_"+a.g+"_"+a.b+"_"+b},_getSVGMarker:function(a){return this._lineMarkers[a]},_updateSVGMarkers:function(){if(I&&P){var a=this._lineMarkers,b;for(b in a){var c=
a[b];c.setAttribute("id",b+"_temp");c.setAttribute("id",b)}}},_applyHalo:function(a,b,c){var d=b&&c?this._getHaloId(b,c):null;a.setFilter(b&&c?r("webkit")||r("ff")?this._getDilateFilter(b,c,d):this._getOffsetFilter(b,c,d):null)},_getDilateFilter:function(a,c,d){var g=this._getSVGFilter(d);g||(g=this._createSVGFilter({id:d},[b.feMorphology({operator:"dilate",radius:c,result:"dilated"}),b.feFlood({"flood-color":a.toCss(!0)}),b.feComposite({in2:"dilated",operator:"in",result:"composite"}),b.feMerge("composite",
"SourceGraphic")]));return g},_getOffsetFilter:function(a,c,d){var g=this._getSVGFilter(d);if(!g){a=a.toCss(!0);var g=this._offsetPrimitives,m,f=g.length,r=[],t=[];for(m=0;m<f;m++){var v=g[m],u="offset"+v.dir,h="composite"+v.dir;t.push(h);r.push(b.feOffset({dx:v.dx*c,dy:v.dy*c,"in":"SourceAlpha",result:u}),b.feFlood({"flood-color":a}),b.feComposite({in2:u,operator:"in",result:h}))}t.push("SourceGraphic");r.push(b.feMerge.apply(b.feMerge,t));g=this._createSVGFilter({id:d},r)}return g},_offsetPrimitives:[{dir:"L",
dx:-1,dy:0},{dir:"TL",dx:-1,dy:-1},{dir:"T",dx:0,dy:-1},{dir:"TR",dx:1,dy:-1},{dir:"R",dx:1,dy:0},{dir:"BR",dx:1,dy:1},{dir:"B",dx:0,dy:1},{dir:"BL",dx:-1,dy:1}],_getHaloId:function(a,b){return"halo_"+this._map.id+"_"+this.id+"_"+a.r+"_"+a.g+"_"+a.b+"_"+a.a+"_"+b},_getSVGFilter:function(a){return this._svgFilters[a]},_createSVGFilter:function(a,c){c=b.createFilter(a,c);var d=this._map,g=d.__visibleRect;c.x=-g.x;c.y=-g.y;c.width=d.width;c.height=d.height;return this._svgFilters[a.id]=c},_updateSVGFilters:function(a,
b,c,g){var m=this._svgFilters,f,r,t;for(r in m)if(f=m[r]){if(t=d.byId(r))null!=a&&t.setAttribute("x",a),null!=b&&t.setAttribute("y",b),null!=c&&t.setAttribute("width",c),null!=g&&t.setAttribute("height",g);null!=a&&(f.x=a);null!=b&&(f.y=b);null!=c&&(f.width=c);null!=g&&(f.height=g)}},_getScaleMatrix:function(a,b){var c=a.width/a.height,d=1,g=1;isNaN(b)||(1<c?(d=b/a.width,g=b/c/a.height):(g=b/a.height,d=b*c/a.width));return{xx:d,yy:g}},_symbolizePoint:function(a,b,c,d){var g=b.type,m=b.style;if("shieldlabelsymbol"!==
g&&"picturemarkersymbol"!==g){var f=b.getStroke();b=b.getFill();var m=m===w.STYLE_X||m===w.STYLE_CROSS,r=f&&f.color,t=m?r:b;if(c){var v=this._getVariable(c,"colorInfo",!1),u=this._getVariable(c,"opacityInfo",!1);v&&(t=c.getColor(d,{colorInfo:v})||t);t&&u&&(t=this._applyOpacity(t,c,u,d));t&&(m?t!==r&&(f=f?p.mixin({},f):{},f.color=t):t!==b&&(b=t))}"textsymbol"===g?a.setFill(b):"simplemarkersymbol"===g&&a.setFill(b).setStroke(f)}},_drawMarkers:function(a,b,c,d){var g=a.geometry,m=g.points,f=a.getDojoShape()||
this._div.createGroup(),r,t,v=m.length,u=[],h=0,l,w=c?c.length:0;f.children[0]&&this._isInvalidShape(b,f.children[0])&&f.clear();for(t=0;t<v;t++)for(r=m[t],l=0;l<w;l++)u[0]=c[l],this._drawPoint(f,{x:r[0],y:r[1],spatialReference:g.spatialReference},b,f.children[h++],u,d,a);b=f.children.length;if(v*c.length<b)for(t=b-1;t>=v*c.length;t--)f.children[t].removeShape();a._shape=f},_symbolizeMarkers:function(a,b,c){var d=a.getDojoShape().children,g,m=d.length;for(g=0;g<m;g++)this._symbolizePoint(d[g],b,c,
a)},_errorHandler:function(a,b){a.message=b?"Unable to draw graphic (geometry:"+(b.geometry?b.geometry.declaredClass:null)+", symbol:"+(b.symbol?b.symbol.declaredClass:null)+"): "+a.message:"Unable to draw graphic (null): "+a.message;this.inherited(arguments)},_rendererLimits:function(){var a,b,c;L?(a=1E5,b=-1E5,c=1E5):r("chrome")&&6>r("chrome")&&(a=8150,b=-1E4,c=1E4);if(a)return{clipLimit:a,rangeMin:b,rangeMax:c,clipBBox:[-a,-a,a,a],clipSegments:[[[-a,-a],[a,-a]],[[a,-a],[a,a]],[[a,a],[-a,a]],[[-a,
a],[-a,-a]]]}}(),_clipPolyline:function(a,b){b=this._getCorners(a,b);var c=b.br,d=this._rendererLimits,g=d.rangeMin,m=d.rangeMax,f=d.clipBBox,r=d.clipSegments,d=this._isPointWithinRange,t=this._isPointWithinBBox,v=this._getClipperIntersection,u=this._getPlaneIndex;if(!d(b.tl,g,m)||!d(c,g,m)){L&&this._createSegments(a);var h=[];q.forEach(a.segments,function(a){a=a.args;var b=a.length,c=[],d;for(d=0;d<b;d+=2){var g=[a[d],a[d+1]],m=[a[d+2],a[d+3]],l=t(g,f),w=t(m,f);if(l^w){if(w=v([g,m],r))l?(d?c.push(w[1]):
c.push(g,w[1]),h.push(c),c=[]):c.push(w[1],m)}else l?d?c.push(m):c.push(g,m):(w=u(g,f),l=u(m,f),-1!==w&&-1!==l&&w!==l&&(g=v([g,m],r,!0),0<g.length&&(g[w]||(w=g[w[0]]?w[0]:w[1]),g[l]||(l=g[l[0]]?l[0]:l[1]),m=g[w],g=g[l],m&&c.push(m),g&&(c.push(g),h.push(c),c=[]))))}h.push(c)});a.setShape(this._getPathStringFromPaths(h))}},_clipPolygon:function(a,b){b=this._getCorners(a,b);var c=b.br,d=this._rendererLimits,g=d.clipLimit,m=d.rangeMin,f=d.rangeMax,r=d.clipBBox,t=d.clipSegments,d=this._isPointWithinRange,
v=this._isPointWithinBBox,u=this._getClipperIntersection,h=this._getPlaneIndex,l=B._pointLineDistance;d(b.tl,m,f)&&d(c,m,f)||(L&&this._createSegments(a),b=q.filter(a.segments,function(a){return a.args&&a.args.length}),b=q.map(b,function(a){var b=a.args,c=b.length,d=[];a=[];var m;for(m=0;m<c;m+=2){var f=[b[m],b[m+1]],w=[b[m+2],b[m+3]];if(m===c-2){d.push(f);break}var n=v(f,r),e=v(w,r);d.push(f);if(n^e){if(e=u([f,w],t))f=e[1],f[n?"inOut":"outIn"]=!0,d.push(f),a.push([n?"INOUT":"OUTIN",d.length-1,e[0]])}else if(!n){var n=
h(f,r),k=h(w,r);-1!==n&&-1!==k&&n!==k&&(e=u([f,w],t,!0),0<e.length?(e[n]||(n=e[n[0]]?n[0]:n[1]),e[k]||(k=e[k[0]]?k[0]:k[1]),f=e[n],w=e[k],f&&(f.outIn=!0,d.push(f),a.push(["OUTIN",d.length-1,n])),w&&(w.inOut=!0,d.push(w),a.push(["INOUT",d.length-1,k]))):p.isArray(n)&&p.isArray(k)&&(e=n.concat(k),e.sort(),"0123"===e.join("")&&(e=[],3===n[0]+n[1]?e.push([g,-g],[-g,g]):e.push([-g,-g],[g,g]),n=l(e[0],[f,w]),f=l(e[1],[f,w]),d.push(n<f?e[0]:e[1]))))}}var z=r[0],y=r[1],x=r[2],B=r[3];q.forEach(d,function(a){a[0]<
z&&(a[1]>=y&&a[1]<=B?a[0]=z:(a[0]=z,a[1]=a[1]<y?y:B))});q.forEach(d,function(a){a[1]<y&&(a[0]>=z&&a[0]<=x?a[1]=y:(a[1]=y,a[0]=a[0]<z?z:x))});q.forEach(d,function(a){a[0]>x&&(a[1]>=y&&a[1]<=B?a[0]=x:(a[0]=x,a[1]=a[1]<y?y:B))});q.forEach(d,function(a){a[1]>B&&(a[0]>=z&&a[0]<=x?a[1]=B:(a[1]=B,a[0]=a[0]<z?z:x))});b=0;c=a.length;if(0<c){do{w=a[b];m=a[(b+1)%c];if(w[2]===m[2]&&"INOUT"===w[0]&&"OUTIN"===m[0])if(f=w[1],m=m[1],f<m)for(f+=1;f<m;f++)d[f][2]=!0;else if(f>m){for(f+=1;f<d.length;f++)d[f][2]=!0;
for(f=0;f<m;f++)d[f][2]=!0}b=(b+1)%c}while(0!==b)}c=d[0];b=d[d.length-1];c[2]&&(b[2]=!0,q.some(a,function(a){return 1===a[1]?(d.splice(d.length-1,0,p.clone(d[1])),!0):!1}));d=q.filter(d,function(a){return a[2]?!1:!0});for(b=0;b<d.length-1;b++)c=d[b],(m=d[b+1])&&c[0]===m[0]&&c[1]===m[1]&&(m.outIn?c.outIn=!0:m.inOut&&(c.inOut=!0),d.splice(b+1,1));c=Math.abs;a=[];for(b=0;b<d.length-1;b++){w=d[b];f=w[0];w=w[1];n=c(f)===g;e=c(w)===g;m=d[b+1];k=m[0];m=m[1];var C=c(k)===g,A=c(m)===g;n&&A?a.push([b+1,[f,
m]]):e&&C&&a.push([b+1,[k,w]])}for(b=a.length-1;0<=b;b--)m=a[b],f=d[m[0]-1],c=d[m[0]],f.outIn||f.inOut||c.outIn||c.inOut||d.splice(m[0],0,m[1]);c=d[0];b=d[d.length-1];c[0]===b[0]&&c[1]===b[1]||d.push(c);return d}),a.setShape(this._getPathStringFromPaths(b)))},_getCorners:function(a,b){if(L){a=this._map;var c=b.getExtent(),d=c.spatialReference;b=a.toScreen(new x(c.xmin,c.ymax,d));a=a.toScreen(new x(c.xmax,c.ymin,d));return{tl:b,br:a}}a=a.getTransformedBoundingBox();return{tl:a[0],br:a[2]}},_createSegments:function(a){a.shape.path=
a.vmlPath;a.segmented=!1;a._confirmSegmented();var b=a.segments;1<b.length&&(a.segments=q.filter(b,function(a,b,c){b=c[b+1];return"M"===a.action&&b&&"L"===b.action?(a.args=a.args.concat(b.args),!0):!1}))},_getPathStringFromPaths:function(a){L?(a=q.map(a,function(a){return"m "+q.map(a,function(a,b){return(1===b?"l ":"")+a.join(",")}).join(" ")}),a.push("e")):a=q.map(a,function(a){return"M "+q.map(a,function(a){return a.join(",")}).join(" ")});return a.join(" ")},_isPointWithinBBox:function(a,b){var c=
b[1],d=b[2],g=b[3],m=a[0];a=a[1];return m>b[0]&&m<d&&a>c&&a<g?!0:!1},_isPointWithinRange:function(a,b,c){var d=a.x;a=a.y;return d<b||a<b||d>c||a>c?!1:!0},_getClipperIntersection:function(a,b,c){var d,g=B._getLineIntersection2,m=Math.round,f={length:0};for(d=0;4>d;d++){var r=g(a,b[d]);if(r)if(r[0]=m(r[0]),r[1]=m(r[1]),c)f[d]=r,f.length++;else return[d,r]}return c?f:null},_getPlaneIndex:function(a,b){var c=a[0];a=a[1];var d=b[0],g=b[1],m=b[2];b=b[3];return c<=d?a>=g&&a<=b?3:a<g?[0,3]:[2,3]:a<=g?c>=
d&&c<=m?0:c<d?[3,0]:[1,0]:c>=m?a>=g&&a<=b?1:a<g?[0,1]:[2,1]:a>=b?c>=d&&c<=m?2:c<d?[3,2]:[1,2]:-1},onGraphicAdd:function(){},onGraphicRemove:function(){},onGraphicNodeAdd:function(){},onGraphicNodeRemove:function(){},onGraphicDraw:function(){},onGraphicsClear:function(){},onRendererChange:function(){},onOpacityChange:function(){},onInfoTemplateChange:function(){},setInfoTemplate:function(a){this.infoTemplate=a;this.onInfoTemplateChange()},add:function(a,b){if(a._graphicsLayer===this)return a;a._suspended=
this._suspendGraphics;b||this.graphics.push(a);a._graphicsLayer=this;a._sourceLayer||(a._layer&&"esri.layers.GraphicsLayer"!==a._layer.declaredClass?a._sourceLayer=a._layer:"esri.layers.GraphicsLayer"!==this.declaredClass&&(a._sourceLayer=this));a._layer=this;this._updateExtent(a);this._draw(a);if(!b)this.onGraphicAdd(a);return a},remove:function(a,b,c){if(!b&&!c){b=this.graphics;if(-1===(a=q.indexOf(b,a)))return null;a=b.splice(a,1)[0]}a.getDojoShape()&&this._removeShape(a,null,c);a._shape=a._graphicsLayer=
null;this.onGraphicRemove(a);return a},clear:function(a,b){a=this.graphics;var c,d=!L;for(c=a.length-1;0<=c;c--)this.remove(a[c],null,d);this.graphics=[];this._destroyAllNodes();if(!b)this.onGraphicsClear()},_destroyAllNodes:function(){if(!L&&this._div){var a;this._childLayer&&(a=this._childLayer.getNode())&&a.parentNode&&a.parentNode.removeChild(a);this._bgGroup.clear();this._div.clear();this._bgGroup=this._div.createGroup();a&&this._div.getEventSource().appendChild(a);this._initOpacity()}},clearNodes:function(){var a=
this.graphics,b=a.length,c;for(c=0;c<b;c++)this._removeShape(a[c],!0,!0);this._destroyAllNodes()},_setIEOpacity:function(a,b){var c=a&&a.getNode();if(c){var d=a.strokeStyle,g=c.stroke;d&&g&&(g.opacity=d.color.a*b);a=a.fillStyle;d=c.fill;a&&d&&("tile"===d.type?f.set(c,"opacity",b):d.opacity=a.a*b)}},setOpacity:function(a,b){if(b||this.opacity!=a){var c=this._div;c&&(L?(q.forEach(this.graphics,function(b){this._setIEOpacity(b._shape,a);this._setIEOpacity(b._bgShape,a)},this),c._esriIeOpacity=a,this._bgGroup._esriIeOpacity=
a):this._canvas?f.set(c.getEventSource(),"opacity",a):c.getEventSource().setAttribute("opacity",a));this.opacity=a;if(!b)this.onOpacityChange(a)}},setRenderer:function(a){this.renderer=a;this._evalSDRenderer(!0);this.emit("renderer-change",{renderer:this._rndForScale||a})}});k=k([F,D],{declaredClass:"esri.layers.GraphicsLayer",constructor:function(){this.enableMouseEvents=p.hitch(this,this.enableMouseEvents);this.disableMouseEvents=p.hitch(this,this.disableMouseEvents);this._processEvent=p.hitch(this,
this._processEvent);this._initLayer()},_initLayer:function(){this.loaded=!0;this.onLoad(this)},_setMap:function(){var a=this.inherited("_setMap",arguments);this.enableMouseEvents();return a},_unsetMap:function(){this.disableMouseEvents();this.inherited("_unsetMap",arguments)},_processEvent:function(a){var b=this._map,c=a.target,d;a.screenPoint=new A(a.pageX-b.position.x,a.pageY-b.position.y);for(a.mapPoint=b.toMap(a.screenPoint);c&&!(d=c.e_graphic);)c=c.parentNode;if(d)return a.graphic=d,a},_onMouseOverHandler:function(a){if(this._processEvent(a))this.onMouseOver(a)},
_onMouseMoveHandler:function(a){if(this._processEvent(a))this.onMouseMove(a)},_onMouseDragHandler:function(a){if(this._processEvent(a))this.onMouseDrag(a)},_onMouseOutHandler:function(a){if(this._processEvent(a))this.onMouseOut(a)},_onMouseDownHandler:function(a){this._downGr=this._downPt=null;this._processEvent(a)&&(e.disconnect(this._onmousemove_connect),e.disconnect(this._onmousedrag_connect),this._onmousedrag_connect=e.connect(this._div.getEventSource(),"onmousemove",this,"_onMouseDragHandler"),
this._downGr=a.graphic,this._downPt=a.screenPoint.x+","+a.screenPoint.y,this.onMouseDown(a))},_onMouseUpHandler:function(a){this._upGr=this._upPt=null;this._processEvent(a)&&(e.disconnect(this._onmousedrag_connect),e.disconnect(this._onmousemove_connect),this._onmousemove_connect=e.connect(this._div.getEventSource(),"onmousemove",this,"_onMouseMoveHandler"),this._upGr=a.graphic,this._upPt=a.screenPoint.x+","+a.screenPoint.y,this.onMouseUp(a))},_onClickHandler:function(a){if(this._processEvent(a)){var b=
this._downGr,c=this._upGr;b&&c&&b===c&&this._downPt===this._upPt&&(L&&(u._ieGraphic=a.graphic),this.onClick(a))}},_onDblClickHandler:function(a){if(this._processEvent(a))this.onDblClick(a)},onMouseOver:function(){},onMouseMove:function(){},onMouseDrag:function(){},onMouseOut:function(){},onMouseDown:function(){},onMouseUp:function(){},onClick:function(){},onDblClick:function(){},enableMouseEvents:function(){if(!this._mouseEvents){var a=e.connect,b=this._div.getEventSource();M||(this._onmouseover_connect=
a(b,"onmouseover",this,"_onMouseOverHandler"),this._onmousemove_connect=a(b,"onmousemove",this,"_onMouseMoveHandler"),this._onmouseout_connect=a(b,"onmouseout",this,"_onMouseOutHandler"),this._onmousedown_connect=a(b,"onmousedown",this,"_onMouseDownHandler"),this._onmouseup_connect=a(b,"onmouseup",this,"_onMouseUpHandler"),this._onclick_connect=a(b,"onclick",this,"_onClickHandler"),this._ondblclick_connect=a(b,"ondblclick",this,"_onDblClickHandler"));this._mouseEvents=!0}},disableMouseEvents:function(){if(this._mouseEvents){var a=
e.disconnect;a(this._onmouseover_connect);a(this._onmousemove_connect);a(this._onmousedrag_connect);a(this._onmouseout_connect);a(this._onmousedown_connect);a(this._onmouseup_connect);a(this._onclick_connect);a(this._ondblclick_connect);this._mouseEvents=!1}}});k._GraphicsContainer=y;k._GraphicsLayer=F;return k})},"dojox/gfx":function(){define(["dojo/_base/lang","./gfx/_base","./gfx/renderer!"],function(k,e,p){e.switchTo(p);return e})},"dojox/gfx/renderer":function(){define(["./_base","dojo/_base/lang",
"dojo/_base/sniff","dojo/_base/window","dojo/_base/config"],function(k,e,p,q,n){var l=null;p.add("vml",function(h,f,d){d.innerHTML='\x3cv:shape adj\x3d"1"/\x3e';h="adj"in d.firstChild;d.innerHTML="";return h});return{load:function(h,f,d){function c(){f(["dojox/gfx/"+a],function(b){k.renderer=a;l=b;d(b)})}if(l&&"force"!=h)d(l);else{var a=n.forceGfxRenderer;h=!a&&(e.isString(n.gfxRenderer)?n.gfxRenderer:"svg,vml,canvas,silverlight").split(",");for(var b,g;!a&&h.length;)switch(h.shift()){case "svg":"SVGAngle"in
q.global&&(a="svg");break;case "vml":p("vml")&&(a="vml");break;case "silverlight":try{p("ie")?(b=new ActiveXObject("AgControl.AgControl"),b.IsVersionSupported("1.0"))&&(g=!0):navigator.plugins["Silverlight Plug-In"]&&(g=!0)}catch(u){g=!1}finally{b=null}g&&(a="silverlight");break;case "canvas":q.global.CanvasRenderingContext2D&&(a="canvas")}"canvas"===a&&!1!==n.canvasEvents&&(a="canvasWithEvents");n.isDebug&&console.log("gfx renderer \x3d "+a);"svg"==a&&"undefined"!=typeof window.svgweb?window.svgweb.addOnLoad(c):
c()}}}})},"esri/layers/gfxSniff":function(){define(["dojo/has","dojox/gfx"],function(k,e){k.add("esri-svg",function(){return-1!==e.renderer.toLowerCase().indexOf("svg")});return k})},"esri/layers/layer":function(){define("dojo/_base/declare dojo/_base/config dojo/_base/connect dojo/_base/lang dojo/_base/Deferred dojo/_base/json dojo/has ../Evented ../kernel ../lang ../request ../deferredUtils ../urlUtils ../SpatialReference ../geometry/Extent".split(" "),function(k,e,p,q,n,l,h,f,d,c,a,b,g,u,m){var r=
k([f],{declaredClass:"esri.layers.Layer",_eventMap:{error:["error"],load:["layer"],"opacity-change":["opacity"],"update-end":["error"],"visibility-change":["visible"]},constructor:function(a,b){this._attrs={};a&&q.isString(a)?this._url=g.urlToObject(this.url=a):(this.url=this._url=null,(b=b||a)&&(b.layerDefinition||b.query)&&(b=null));this.spatialReference=new u(4326);this.initialExtent=new m(-180,-90,180,90,new u(4326));this._map=this._div=null;this.normalization=!0;b&&(b.id&&(this.id=b.id),!1===
b.visible&&(this.visible=!1),c.isDefined(b.opacity)&&(this.opacity=b.opacity),c.isDefined(b.minScale)&&this.setMinScale(b.minScale),c.isDefined(b.maxScale)&&this.setMaxScale(b.maxScale),this.attributionDataUrl=b.attributionDataUrl||"",this.hasAttributionData=!!this.attributionDataUrl,c.isDefined(b.showAttribution)&&(this.showAttribution=b.showAttribution),this.className=b.className,this.refreshInterval=b.refreshInterval||0);this._errorHandler=q.hitch(this,this._errorHandler);this.refresh=q.hitch(this,
this.refresh);if(this.managedSuspension){var d=this._setMap;this._setMap=function(a){var b=d.apply(this,arguments);this.evaluateSuspension();if(this.suspended&&!a.loaded)var c=p.connect(a,"onLoad",this,function(){p.disconnect(c);c=null;this.evaluateSuspension()});return b}}this.registerConnectEvents()},id:null,visible:!0,opacity:1,loaded:!1,loadError:null,minScale:0,maxScale:0,visibleAtMapScale:!1,suspended:!0,attributionDataUrl:"",hasAttributionData:!1,showAttribution:!0,refreshInterval:0,_errorHandler:function(a){this.loaded||
(this.loadError=a);this.onError(a)},_setMap:function(a,b,c,d){this._map=a;this._lyrZEHandle=p.connect(a,"onZoomEnd",this,this._processMapScale);if(a.loaded)this.visibleAtMapScale=this._isMapAtVisibleScale();else var g=p.connect(a,"onLoad",this,function(){p.disconnect(g);g=null;this._processMapScale()})},_unsetMap:function(a,b){p.disconnect(this._lyrZEHandle);this._toggleRT();this._map=this._lyrZEHandle=null;this._resumedOnce=void 0;this.suspended=!0},_cleanUp:function(){this._map=this._div=null},
_fireUpdateStart:function(){this.updating||(this.updating=!0,this.attr("data-updating",""),this._toggleRT(),this.onUpdateStart(),this._map&&this._map._incr())},_fireUpdateEnd:function(a,b){this.updating&&(this.updating=!1,this.attr("data-updating"),this._toggleRT(!0),this.onUpdateEnd(a,b),this._map&&this._map._decr())},_getToken:function(){var a=this._url,b=this.credential;return a&&a.query&&a.query.token||b&&b.token||void 0},_findCredential:function(){this.credential=d.id&&this._url&&d.id.findCredential(this._url.path)},
_useSSL:function(){var a=this._url,b=/^http:/i;this.url&&(this.url=this.url.replace(b,"https:"));a&&a.path&&(a.path=a.path.replace(b,"https:"))},refresh:function(){},show:function(){this.setVisibility(!0)},hide:function(){this.setVisibility(!1)},setMinScale:function(a){this.setScaleRange(a)},setMaxScale:function(a){this.setScaleRange(null,a)},setScaleRange:function(a,b){var d=c.isDefined(a),g=c.isDefined(b);this.loaded||(this._hasMin=this._hasMin||d,this._hasMax=this._hasMax||g);var m=this.minScale,
f=this.maxScale;this.minScale=(d?a:this.minScale)||0;this.maxScale=(g?b:this.maxScale)||0;if(m!==this.minScale||f!==this.maxScale)this.onScaleRangeChange(),this._processMapScale()},suspend:function(){this._suspended=!0;this.evaluateSuspension()},resume:function(){this._suspended=!1;this.evaluateSuspension()},canResume:function(){return this.loaded&&this._map&&this._map.loaded&&this.visible&&this.visibleAtMapScale&&!this._suspended},evaluateSuspension:function(){this.canResume()?this.suspended&&this._resume():
this.suspended||this._suspend()},_suspend:function(){this.suspended=!0;this.attr("data-suspended","");this._toggleRT();this.onSuspend();if(this._map)this._map.onLayerSuspend(this)},_resume:function(){this.suspended=!1;this.attr("data-suspended");var a=void 0===this._resumedOnce,b=this.className,c=this._attrs,d=this.getNode(),g;if(a){this._resumedOnce=!0;if(b&&d){var m=d.getAttribute("class")||"";(new RegExp("(^|\\s)"+b+"(\\s|$)","i")).test(m)||d.setAttribute("class",m+((m?" ":"")+b))}if(c&&d)for(g in c)c.hasOwnProperty(g)&&
d.setAttribute(g,c[g])}this._toggleRT(!0);this.onResume({firstOccurrence:a});if(this._map)this._map.onLayerResume(this)},_processMapScale:function(){var a=this.visibleAtMapScale;this.visibleAtMapScale=this._isMapAtVisibleScale();a!==this.visibleAtMapScale&&(this.onScaleVisibilityChange(),this.evaluateSuspension())},isVisibleAtScale:function(a){return a?r.prototype._isMapAtVisibleScale.apply(this,arguments):!1},_isMapAtVisibleScale:function(a,b){if(!(a||this._map&&this._map.loaded))return!1;var c=
this._map;a=a||c.getScale();var d=this.minScale,g=this.maxScale,m=!d,f=!g,r;b&&(r=c.width>c.height?c.width:c.height);m||(a<=d?m=!0:b&&(m=Math.abs(d-a)/d<1/r));f||(a>=g?f=!0:b&&(f=Math.abs(g-a)/g<1/r));return m&&f},getAttributionData:function(){var c=this.attributionDataUrl,d=new n(b._dfdCanceller);this.hasAttributionData&&c?(d._pendingDfd=a({url:c,content:{f:"json"},handleAs:"json",callbackParamName:"callback"}),d._pendingDfd.then(function(a){d.callback(a)},function(a){d.errback(a)})):(c=Error("Layer does not have attribution data"),
c.log=!!e.isDebug,d.errback(c));return d},getResourceInfo:function(){var a=this.resourceInfo;return q.isString(a)?l.fromJson(a):q.clone(a)},getMap:function(){return this._map},getNode:function(){return this._div},attr:function(a,b){var c=this.getNode();if("data-reference"===a&&11>h("ie"))return this;c&&(null==b?c.removeAttribute(a):c.setAttribute(a,b));this._attrs&&(null==b?delete this._attrs[a]:this._attrs[a]=b);return this},setRefreshInterval:function(a){var b=this.refreshInterval;this.refreshInterval=
a;this._toggleRT();a&&(this.updating||this.suspended||this._toggleRT(!0));if(b!==a)this.onRefreshIntervalChange();return this},_toggleRT:function(a){a&&this.refreshInterval?(clearTimeout(this._refreshT),this._refreshT=setTimeout(this.refresh,6E4*this.refreshInterval)):this._refreshT&&(clearTimeout(this._refreshT),this._refreshT=null)},setNormalization:function(a){this.normalization=a},setVisibility:function(a){this.visible!==a&&(this.visible=a,this.onVisibilityChange(this.visible),this.evaluateSuspension());
this.attr("data-hidden",a?null:"")},onLoad:function(){},onVisibilityChange:function(){},onScaleRangeChange:function(){},onScaleVisibilityChange:function(){},onSuspend:function(){},onResume:function(){},onUpdate:function(){},onUpdateStart:function(){},onUpdateEnd:function(){},onRefreshIntervalChange:function(){},onError:function(){}});return r})},"esri/domUtils":function(){define(["./kernel","dojo/_base/connect","dojo/_base/lang","dojo/dom-style","dojo/has"],function(k,e,p,q,n){var l={show:function(h){if(h=
l.getNode(h))h.style.display="block"},getNode:function(h){return h&&h.domNode||h},hide:function(h){if(h=l.getNode(h))h.style.display="none"},toggle:function(h){if(h=l.getNode(h))h.style.display="none"===h.style.display?"block":"none"},documentBox:8>=n("ie")?{w:document.documentElement.clientWidth,h:document.documentElement.clientHeight}:{w:window.innerWidth,h:window.innerHeight},setScrollable:function(h){if(h=this.getNode(h)){var f=0,d=0,c=0,a=0,b=0,g=0;return[e.connect(h,"ontouchstart",function(u){f=
u.touches[0].screenX;d=u.touches[0].screenY;c=h.scrollWidth;a=h.scrollHeight;b=h.clientWidth;g=h.clientHeight}),e.connect(h,"ontouchmove",function(u){u.preventDefault();var m=h.firstChild;m instanceof Text&&(m=h.childNodes[1]);var r=m._currentX||0,t=m._currentY||0,r=r+(u.touches[0].screenX-f);0<r?r=0:0>r&&Math.abs(r)+b>c&&(r=-1*(c-b));m._currentX=r;t+=u.touches[0].screenY-d;0<t?t=0:0>t&&Math.abs(t)+g>a&&(t=-1*(a-g));m._currentY=t;q.set(m,{"-webkit-transition-property":"-webkit-transform","-webkit-transform":"translate("+
r+"px, "+t+"px)"});f=u.touches[0].screenX;d=u.touches[0].screenY})]}}};return l})},"esri/symbols/MarkerSymbol":function(){define("dojo/_base/declare dojo/_base/lang dojo/has dojox/gfx/_base ../kernel ./Symbol".split(" "),function(k,e,p,q,n,l){return k(l,{declaredClass:"esri.symbol.MarkerSymbol",angle:0,xoffset:0,yoffset:0,size:12,constructor:function(h){h&&e.isObject(h)&&(this.size="auto"===this.size?this.size:q.pt2px(this.size),this.xoffset=q.pt2px(this.xoffset),this.yoffset=q.pt2px(this.yoffset),
this.angle&&(this.angle*=-1))},setAngle:function(h){this.angle=h;return this},setSize:function(h){this.size=h;return this},setOffset:function(h,f){this.xoffset=h;this.yoffset=f;return this},toJson:function(){var h=q.px2pt(this.size),h=isNaN(h)?void 0:h,f=q.px2pt(this.xoffset),f=isNaN(f)?void 0:f,d=q.px2pt(this.yoffset),d=isNaN(d)?void 0:d;return e.mixin(this.inherited("toJson",arguments),{size:"auto"===this.size?this.size:h,angle:this.angle&&-1*this.angle,xoffset:f,yoffset:d})}})})},"esri/symbols/Symbol":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../lang ../Color".split(" "),
function(k,e,p,q,n,l){return k(null,{declaredClass:"esri.symbol.Symbol",color:new l([0,0,0,1]),type:null,constructor:function(h){h&&e.isObject(h)&&(e.mixin(this,h),this.color&&n.isDefined(this.color[0])&&(this.color=l.toDojoColor(this.color)),(h=this.type)&&0===h.indexOf("esri")&&(this.type={esriSMS:"simplemarkersymbol",esriPMS:"picturemarkersymbol",esriSLS:"simplelinesymbol",esriCLS:"cartographiclinesymbol",esriSFS:"simplefillsymbol",esriPFS:"picturefillsymbol",esriTS:"textsymbol",esriSHD:"shieldlabelsymbol"}[h]))},
setColor:function(h){this.color=h;return this},toJson:function(){return{color:l.toJsonColor(this.color)}}})})},"esri/symbols/SimpleMarkerSymbol":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/Color dojo/has dojox/gfx/_base ../kernel ../lang ./MarkerSymbol ./SimpleLineSymbol".split(" "),function(k,e,p,q,n,l,h,f,d){var c={STYLE_CIRCLE:"circle",STYLE_SQUARE:"square",STYLE_CROSS:"cross",STYLE_X:"x",STYLE_DIAMOND:"diamond",STYLE_PATH:"path",STYLE_TARGET:"target"},a={style:c.STYLE_CIRCLE,
color:[255,255,255,.25],size:12,angle:0,xoffset:0,yoffset:0};k=k(f,{declaredClass:"esri.symbol.SimpleMarkerSymbol",type:"simplemarkersymbol",_styles:{circle:"esriSMSCircle",square:"esriSMSSquare",cross:"esriSMSCross",x:"esriSMSX",diamond:"esriSMSDiamond",path:"esriSMSPath"},constructor:function(b,g,f,m){b?e.isString(b)?(this.style=b,g&&(this.size=g),f&&(this.outline=f),m&&(this.color=m)):(this.style=h.valueOf(this._styles,this.style),b.outline&&(this.outline=new d(b.outline))):(e.mixin(this,a),this.size=
n.pt2px(this.size),this.outline=new d(this.outline),this.color=new p(this.color));this.style||(this.style=c.STYLE_CIRCLE)},setStyle:function(a){this.style=a;return this},setPath:function(a){this.path=a;this.setStyle(c.STYLE_PATH);return this},setOutline:function(a){this.outline=a;return this},getStroke:function(){return this.outline&&this.outline.getStroke()},getFill:function(){return this.color},_setDim:function(a,c,d){this._targetWidth=a;this._targetHeight=c;this._spikeSize=d},getShapeDescriptors:function(){var b,
d,f,m=this.style,r=(this.size||n.pt2px(a.size))/2,t=0-r,v=0+r,h=0-r,l=0+r;switch(m){case c.STYLE_CIRCLE:b={type:"circle",cx:0,cy:0,r:r};d=this.getFill();if(f=this.getStroke())f.style=f.style||"Solid";break;case c.STYLE_CROSS:b={type:"path",path:"M "+t+",0 L "+v+",0 M 0,"+h+" L 0,"+l+" E"};d=null;f=this.getStroke();break;case c.STYLE_DIAMOND:b={type:"path",path:"M "+t+",0 L 0,"+h+" L "+v+",0 L 0,"+l+" L "+t+",0 Z"};d=this.getFill();f=this.getStroke();break;case c.STYLE_SQUARE:b={type:"path",path:"M "+
t+","+l+" L "+t+","+h+" L "+v+","+h+" L "+v+","+l+" L "+t+","+l+" Z"};d=this.getFill();f=this.getStroke();break;case c.STYLE_X:b={type:"path",path:"M "+t+","+l+" L "+v+","+h+" M "+t+","+h+" L "+v+","+l+" E"};d=null;f=this.getStroke();break;case c.STYLE_PATH:b={type:"path",path:this.path||""},d=this.getFill(),f=this.getStroke()}return{defaultShape:b,fill:d,stroke:f}},toJson:function(){var a=this.style,c=this.outline,d=e.mixin(this.inherited("toJson",arguments),{type:"esriSMS",style:this._styles[a]||
"esriSMSCircle"});c&&(d.outline=c.toJson());"x"===a||"cross"===a?delete d.color:"target"===a&&(d.style="esriSMSSquare",delete d.color,0<this._targetHeight&&0<this._targetWidth&&(d.size=n.px2pt(Math.max(this._targetHeight,this._targetWidth))));d.path=this.path;return h.fixJson(d)}});e.mixin(k,c);k.defaultProps=a;return k})},"esri/symbols/SimpleLineSymbol":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/Color dojo/has dojox/gfx/_base ../kernel ../lang ./LineSymbol".split(" "),function(k,
e,p,q,n,l,h,f){var d={STYLE_SOLID:"solid",STYLE_DASH:"dash",STYLE_DOT:"dot",STYLE_DASHDOT:"dashdot",STYLE_DASHDOTDOT:"longdashdotdot",STYLE_NULL:"none",STYLE_SHORTDASH:"shortdash",STYLE_SHORTDOT:"shortdot",STYLE_SHORTDASHDOT:"shortdashdot",STYLE_SHORTDASHDOTDOT:"shortdashdotdot",STYLE_LONGDASH:"longdash",STYLE_LONGDASHDOT:"longdashdot"},c={color:[0,0,0,1],style:d.STYLE_SOLID,width:1};k=k(f,{declaredClass:"esri.symbol.SimpleLineSymbol",type:"simplelinesymbol",marker:null,_styles:{solid:"esriSLSSolid",
dash:"esriSLSDash",dot:"esriSLSDot",dashdot:"esriSLSDashDot",longdashdotdot:"esriSLSDashDotDot",none:"esriSLSNull",insideframe:"esriSLSInsideFrame",shortdash:"esriSLSShortDash",shortdot:"esriSLSShortDot",shortdashdot:"esriSLSShortDashDot",shortdashdotdot:"esriSLSShortDashDotDot",longdash:"esriSLSLongDash",longdashdot:"esriSLSLongDashDot"},constructor:function(a,b,g){a?e.isString(a)?(this.style=a,b&&(this.color=b),g&&(this.width=g)):(this.style=h.valueOf(this._styles,a.style)||d.STYLE_SOLID,this.marker=
a.marker):(e.mixin(this,c),this.color=new p(this.color),this.width=n.pt2px(this.width))},setStyle:function(a){this.style=a;return this},setMarker:function(a){this.marker=a},getStroke:function(){return this.style===d.STYLE_NULL||0===this.width?null:{color:this.color,style:this.style,width:this.width}},getFill:function(){return null},getShapeDescriptors:function(){return{defaultShape:{type:"path",path:"M -15,0 L 15,0 E"},fill:null,stroke:this.getStroke()}},toJson:function(){return h.fixJson(e.mixin(this.inherited("toJson",
arguments),{type:"esriSLS",style:this._styles[this.style],marker:this.marker?e.clone(this.marker):void 0}))}});e.mixin(k,d);k.defaultProps=c;return k})},"esri/symbols/LineSymbol":function(){define("dojo/_base/declare dojo/_base/lang dojo/has dojox/gfx/_base ../kernel ./Symbol".split(" "),function(k,e,p,q,n,l){return k(l,{declaredClass:"esri.symbol.LineSymbol",constructor:function(h){e.isObject(h)?this.width=q.pt2px(this.width):this.width=12},setWidth:function(h){this.width=h;return this},toJson:function(){var h=
q.px2pt(this.width),h=isNaN(h)?void 0:h;return e.mixin(this.inherited("toJson",arguments),{width:h})}})})},"esri/symbols/utils":function(){define(["dojo/_base/lang","dojo/_base/window","dojo/has","dojox/gfx","../kernel"],function(k,e,p,q,n){function l(a){a.removeAttribute("marker-start");a.removeAttribute("marker-end");a.removeAttribute("opacity")}function h(a,c){for(var b in c)a.setAttribute(b,c[b])}function f(a,c,d){c="url(#"+c.getAttribute("id")+")";a.rawNode.setAttribute("marker-"+d,c)}var d=
-1!==q.renderer.toLowerCase().indexOf("svg"),c=9===p("ie"),a={marker:{markerWidth:"6",markerHeight:"6",markerUnits:"strokeWidth",orient:"auto"},spear:{marker:{end:{viewBox:"0 0 25.4 23.43",refX:"20",refY:"12.76"},start:{viewBox:"-25.4 0 25.4 23.43",refX:"-20",refY:"12.76"}},path:{common:{d:"M1.63 23.43 L5.37 16.6 L5.37 8.93 L1.63 2.09 L25.4 12.76 L1.63 23.43 Z","stroke-width":"0","fill-opacity":"1"},start:{transform:"matrix(-1, 0, 0, 1, 0, 0)"}}}};return{applyLineMarker:function(a,g,h,m){if(d&&!c){var b=
a&&a.rawNode,t=g.marker;h=h||g.color;b&&"none"!==g.style&&h&&t&&"arrow"===t.style&&t.placement?b.getTotalLength&&0===b.getTotalLength()?l(b):(g=-1!==t.placement.indexOf("begin"),t=-1!==t.placement.indexOf("end"),g||t?(b.removeAttribute("stroke-opacity"),b.setAttribute("opacity",h.a),g?(g=m(a,h,"spear","start"),f(a,g,"start")):b.removeAttribute("marker-start"),t?(h=m(a,h,"spear","end"),f(a,h,"end")):b.removeAttribute("marker-end")):l(b)):b&&l(b)}},createSVGMarker:function(b,c,d,m){d=a[d];var g=e.doc.createElementNS("http://www.w3.org/2000/svg",
"marker");g.setAttribute("id",c);h(g,a.marker);h(g,d.marker[m]);c=e.doc.createElementNS("http://www.w3.org/2000/svg","path");c.setAttribute("fill",b.toCss());h(c,d.path.common);h(c,d.path[m]);g.appendChild(c);return g}}})},"esri/layers/TileInfo":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has ../kernel ../lang ../SpatialReference ../geometry/Point ./LOD".split(" "),function(k,e,p,q,n,l,h,f,d){return k(null,{declaredClass:"esri.layers.TileInfo",constructor:function(c){e.mixin(this,
c);this.width=this.cols;this.height=this.rows;this._levelToLOD={};c=this.spatialReference;var a=this.origin;c&&(c=this.spatialReference=new h(c.toJson?c.toJson():c));a&&(this.origin=new f(a.toJson?a.toJson():a),!a.spatialReference&&c&&this.origin.setSpatialReference(new h(c.toJson())));this.lods=p.map(this.lods,function(a){return new d(a)});p.forEach(this.lods,function(a){this._levelToLOD[a.level]=a},this);c=!1;var a=this.spatialReference,b=this.origin;if(a&&b){var g=a._getInfo();g&&(c=a._isWrappable()&&
Math.abs(g.origin[0]-b.x)<=g.dx)}this.isWrappable=c},toJson:function(){return l.fixJson({rows:this.rows,cols:this.cols,dpi:this.dpi,format:this.format,compressionQuality:this.compressionQuality,origin:this.origin&&this.origin.toJson(),spatialReference:this.spatialReference&&this.spatialReference.toJson(),lods:this.lods&&p.map(this.lods,function(c){return c.toJson()})})},lodAt:function(c){return this._levelToLOD&&this._levelToLOD[c]||null}})})},"esri/layers/LOD":function(){define(["dojo/_base/declare",
"dojo/_base/lang","dojo/has","../kernel","../lang"],function(k,e,p,q,n){return k(null,{declaredClass:"esri.layers.LOD",constructor:function(l){e.mixin(this,l)},toJson:function(){return n.fixJson({level:this.level,levelValue:this.levelValue,resolution:this.resolution,scale:this.scale})}})})},"esri/layers/ArcGISTiledMapServiceLayer":function(){define("dojo/_base/kernel dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/json dojo/has dojo/io-query ../kernel ../urlUtils ../SpatialReference ./TiledMapServiceLayer ./ArcGISMapServiceLayer ./TileInfo ./TimeInfo ./TileMap".split(" "),
function(k,e,p,q,n,l,h,f,d,c,a,b,g,u,m){return e([a,b],{declaredClass:"esri.layers.ArcGISTiledMapServiceLayer",_agolAttrs:"Canvas/World_Dark_Gray_Base Canvas/World_Dark_Gray_Reference Canvas/World_Light_Gray_Base Canvas/World_Light_Gray_Reference Elevation/World_Hillshade Ocean/World_Ocean_Base Ocean/World_Ocean_Reference Ocean_Basemap Reference/World_Boundaries_and_Places Reference/World_Boundaries_and_Places_Alternate Reference/World_Transportation World_Imagery World_Street_Map World_Topo_Map".split(" "),
_isReference:!1,_referenceLayers:"Canvas/World_Dark_Gray_Reference Canvas/World_Light_Gray_Reference Ocean/World_Ocean_Reference Reference/World_Boundaries_and_Places Reference/World_Boundaries_and_Places_Alternate Reference/World_Reference_Overlay Reference/World_Transportation".split(" "),constructor:function(a,b){b&&(b.roundrobin&&(k.deprecated(this.declaredClass+" : Constructor option 'roundrobin' deprecated. Use option 'tileServers'."),b.tileServers=b.roundrobin),this._setTileServers(b.tileServers),
this._loadCallback=b.loadCallback);this._params=p.mixin({},this._url.query);this._initLayer=p.hitch(this,this._initLayer);(a=b&&b.resourceInfo)?this._initLayer(a):(this._load=p.hitch(this,this._load),this._load())},_TILE_FORMATS:{PNG:"png",PNG8:"png",PNG24:"png",PNG32:"png",JPG:"jpg",JPEG:"jpg",GIF:"gif"},_setTileServers:function(a){if(a&&0<a.length){this.tileServers=a;var b,c=a.length;for(b=0;b<c;b++)a[b]=d.urlToObject(a[b]).path}},_initLayer:function(a,b){this.inherited(arguments);this.resourceInfo=
n.toJson(a);this.tileInfo=new g(a.tileInfo);!1!==this.resampling&&(a.capabilities&&-1<a.capabilities.indexOf("Tilemap")?(this.resampling=!0,this.tileMap=new m(this)):this.resampling=!!a.resampling);!this.spatialReference&&this.tileInfo.spatialReference&&(this.spatialReference=new c(this.tileInfo.spatialReference.toJson()));this.isPNG32="PNG24"===this.tileInfo.format||"PNG32"===this.tileInfo.format;a.timeInfo&&(this.timeInfo=new u(a.timeInfo));a.mensurationCapabilities&&(this.mensurationCapabilities=
a.mensurationCapabilities);var f=this._url.path,r=this._loadCallback,t=d.getProtocolForWebResource(!0),h=f.match(/^https?\:\/\/(server|services)\.arcgisonline\.com\/arcgis\/rest\/services\/([^\/]+(\/[^\/]+)*)\/mapserver/i),h=h&&h[2];if(!this.tileServers)if(a.tileServers)this._setTileServers(a.tileServers);else{var l=-1!==f.search(/^https?\:\/\/server\.arcgisonline\.com/i),e=-1!==f.search(/^https?\:\/\/services\.arcgisonline\.com/i);(l||e)&&this._setTileServers([f,f.replace(l?/server\.arcgisonline/i:
/services\.arcgisonline/i,l?"services.arcgisonline":"server.arcgisonline")])}if(h){h=h.toLowerCase();for(f=0;f<this._agolAttrs.length;f++)if(l=this._agolAttrs[f],l.toLowerCase()===h){this.hasAttributionData=!0;this.attributionDataUrl=this.attributionDataUrl||t+"//static.arcgis.com/attribution/"+l;break}for(f=0;f<this._referenceLayers.length;f++)if(l=this._referenceLayers[f],l.toLowerCase()===h){this._isReference=!0;break}}this.loaded=!0;this.onLoad(this);r&&(delete this._loadCallback,r(this))},getTileUrl:function(a,
b,c){var g=this.tileServers,m=this._getToken(),f=this._url.query;a=(g?g[b%g.length]:this._url.path)+"/tile/"+a+"/"+b+"/"+c;a=d.upgradeToHTTPS(a);this.resampling&&!this.tileMap&&(a+="?blankTile\x3dfalse");f&&(a=this.resampling&&!this.tileMap?a+("\x26"+h.objectToQuery(f)):a+("?"+h.objectToQuery(f)));!m||f&&f.token||(a+=(-1===a.indexOf("?")?"?":"\x26")+"token\x3d"+m);a=this.addTimestampToURL(a);return d.addProxy(a)}})})},"esri/layers/TiledMapServiceLayer":function(){define("dojo/_base/declare dojo/_base/connect dojo/_base/lang dojo/_base/array dojo/_base/url dojo/dom-construct dojo/dom-class dojo/dom-geometry dojo/dom-style dojo/dom dojox/collections/ArrayList dojox/gfx/matrix ../kernel ../config ../sniff ../domUtils ../tileUtils ../geometry/Point ../geometry/Rect ../geometry/Extent ./layer".split(" "),
function(k,e,p,q,n,l,h,f,d,c,a,b,g,u,m,r,t,v,y,w,z){return k(z,{declaredClass:"esri.layers.TiledMapServiceLayer",constructor:function(a,b){e.connect(this,"onLoad",this,"_initTiledLayer");this._lowestLevel=(this._displayLevels=b?b.displayLevels:null)?this._displayLevels[0]:0;this.resampling=b?b.resampling:void 0;this._resamplingTolerance=b?b.resamplingTolerance:null;this.exclusionAreas=b?b.exclusionAreas:null;a=p.hitch;this._addImage=a(this,this._addImage);this._tileLoadHandler=a(this,this._tileLoadHandler);
this._tileErrorHandler=a(this,this._tileErrorHandler);this._popTile=a(this,this._popTile);this._cleanUpRemovedImages=a(this,this._cleanUpRemovedImages);this._fireOnUpdateEvent=a(this,this._fireOnUpdateEvent);this._transitionEnd=a(this,this._transitionEnd);this._tileMapCallback=a(this,this._tileMapCallback)},opacity:1,isPNG32:!1,_multiple:1,isResampling:!1,_initTiledLayer:function(){var a=this.tileInfo,b=a.lods;this.resampling=null!=this.resampling?this.resampling:!1;this._tileW=a.width;this._tileH=
a.height;var c=this.scales=[],d=this._displayLevels,g=-Infinity,f=Infinity,r=this.fullExtent,h=new v(r.xmin,r.ymax),r=new v(r.xmax,r.ymin),u=t.getContainingTileCoords,l,w,n,e=b.length;for(n=0;n<e;n++)w=b[n],l=u(a,h,w),w.startTileRow=0>l.row?0:l.row,w.startTileCol=0>l.col?0:l.col,l=u(a,r,w),w.endTileRow=l.row,w.endTileCol=l.col,d&&-1===q.indexOf(d,w.level)||(c[n]=w.scale,g=w.scale>g?w.scale:g,f=w.scale<f?w.scale:f);-Infinity===g||this._hasMin||this.setMinScale(g);Infinity===f||this._hasMax||this.setMaxScale(f);
this.setExclusionAreas(this.exclusionAreas);this._patchIE=6<=m("ie")&&7>m("ie")&&(this.isPNG32||"Mixed"===a.format)},isVisibleAtScale:function(a){return a?z.prototype._isMapAtVisibleScale.call(this,a,!0):!1},_isMapAtVisibleScale:function(a){var b=this.inherited(arguments,[a,!0]);if(b){var c;c=this._map;var b=this.scales,d=c.getScale(),g=!1,m=c.width>c.height?c.width:c.height;for(c=0;c<b.length;c++)if(Math.abs(b[c]-d)/b[c]<1/m){g=!0;break}b=g}return b},_setMap:function(a,b,c,m){this.inherited(arguments);
this._map=a;var f=this._div=l.create("div",null,b),r=a.__visibleDelta,v=e.connect,h=g._css.names,w={position:"absolute",width:a.width+"px",height:a.height+"px",overflow:"visible"},n=u.defaults.map.zoomDuration;"css-transforms"===a.navigationMode?(w[h.transform]=g._css.translate(-r.x,-r.y),d.set(f,w),delete w[h.transform],w[h.transition]=h.transformName+" "+n+"ms ease",d.set(this._active=l.create("div",null,f),w),this._active._remove=0,this._passives=[]):(w.left=-r.x+"px",w.top=-r.y+"px",d.set(f,w));
this._onResizeHandler_connect=v(a,"onResize",this,"_onResizeHandler");this._opacityChangeHandler_connect=v(this,"onOpacityChange",this,"_opacityChangeHandler");r=this.tileInfo;v=r.spatialReference;h=v._getInfo();(this._wrap=a.wrapAround180&&v._isWrappable()&&Math.abs(h.origin[0]-r.origin.x)<=h.dx)&&t._addFrameInfo(r,h);this.setExclusionAreas(this.exclusionAreas);this.evaluateSuspension();if(this.suspended&&!a.loaded)var k=e.connect(a,"onLoad",this,function(){e.disconnect(k);k=null;this.setExclusionAreas(this.exclusionAreas);
this.evaluateSuspension()});return f},_unsetMap:function(a,b){this.suspended||this._suspendImpl();l.destroy(this._div);this._map=this._div=null;var c=e.disconnect;c(this._onResizeHandler_connect);c(this._opacityChangeHandler_connect);this.inherited(arguments)},onSuspend:function(){this.inherited(arguments);this._suspendImpl()},_suspendImpl:function(){r.hide(this._div);clearTimeout(this._wakeTimer);this._wakeTimer=null;this._disableDrawConnectors();var a=this._tiles,b=this._tileIds,c=this._loadingList,
d,g,m=e.disconnect,f=l.destroy;c&&0<c.count&&(c.forEach(function(b){if(d=a[b])m(d._onload_connect),m(d._onerror_connect),m(d._onabort_connect),d._onload_connect=d._onerror_connect=d._onabort_connect=null}),c.clear(),this._fireUpdateEnd());this._removeList.clear();for(c=b.length-1;0<=c;c--)(d=(g=b[c])&&a[g])&&f(d);if("css-transforms"===this._map.navigationMode){b=this._active;g=this._passives;var t;this._noDom=0;for(c=g.length-1;0<=c;c--)t=g[c],t._endHandle&&m(t._endHandle),t._matrix=t._multiply=t._endHandle=
null,t._marked=t._remove=0,g.splice(c,1),f(t);b._matrix=b._multiply=null;b._marked=b._remove=0}this._tileIds=this._tiles=this._tileBounds=this._ct=this._loadingList=this._removeList=this._standby=null},onResume:function(){this.inherited(arguments);this._tileIds=[];this._tiles=[];this._tileBounds=[];this._ct=null;this._removeList=new a;this._loadingList=new a;r.show(this._div);this._enableDrawConnectors();this._wakeTimer=this._wakeTimer||setTimeout(p.hitch(this,function(){this.suspended||this._onExtentChangeHandler(this._map.extent,
null,!0,this._map.__LOD)}),0)},_enableDrawConnectors:function(){var a=this._map,b=e.connect;if("css-transforms"===a.navigationMode){if(this._onScaleHandler_connect=b(a,"onScale",this,this._onScaleHandler),m("esri-mobile")){this._standby=[];var c=this,d=function(){c._noDom=1};this._onPanStartHandler_connect=b(a,"onPanStart",d);this._onZoomStartHandler_connect=b(a,"onZoomStart",d)}}else this._onZoomHandler_connect=b(a,"onZoom",this,"_onZoomHandler");this._onPanHandler_connect=b(a,"onPan",this,"_onPanHandler");
this._onExtentChangeHandler_connect=b(a,"onExtentChange",this,"_onExtentChangeHandler")},_disableDrawConnectors:function(){var a=e.disconnect;a(this._onPanHandler_connect);a(this._onZoomHandler_connect);a(this._onScaleHandler_connect);a(this._onExtentChangeHandler_connect);a(this._onPanStartHandler_connect);a(this._onZoomStartHandler_connect);this._onPanHandler_connect=this._onZoomHandler_connect=this._onScaleHandler_connect=this._onExtentChangeHandler_connect=this._onPanStartHandler_connect=this._onZoomStartHandler_connect=
null},_onResizeHandler:function(a,b,c){a={width:b+"px",height:c+"px"};b=d.set;b(this._div,a);if("css-transforms"===this._map.navigationMode)for(this._active&&b(this._active,a),c=this._passives.length-1;0<=c;c--)b(this._passives[c],a)},_onExtentChangeHandler:function(a,c,m,r){c=this._map;var v=this._standby,h;clearTimeout(this._wakeTimer);this._wakeTimer=null;if(!c._isPanningOrZooming()){if("css-transforms"===c.navigationMode){if(m)for(r=this._passives.length-1;0<=r;r--)h=this._passives[r],d.set(h,
g._css.names.transition,"none"),h._marked?(this._passives.splice(r,1),h.parentNode&&h.parentNode.removeChild(h),l.destroy(h)):0<h.childNodes.length&&(h._multiply=h._multiply?b.multiply(h._matrix,h._multiply):h._matrix);this._noDom=0;if(v&&v.length)for(r=v.length-1;0<=r;r--)h=v[r],d.set(h,"visibility","inherit"),this._popTile(h),v.splice(r,1)}this._fireUpdateStart();this._rrIndex=0;r=t.getCandidateTileInfo(c,this.tileInfo,a);a=c.__visibleDelta;if(!this._ct||r.lod.level!==this._ct.lod.level||m){h=r&&
this._ct&&r.lod.level!==this._ct.lod.level;this._ct=r;var u=this._tiles,w=this._tileIds,n=this._tileBounds,e=this._removeList,k,z=w.length;this._cleanUpRemovedImages();for(r=0;r<z;r++)v=w[r],k=u[v],n[v]=w[r]=null,"css-transforms"===c.navigationMode&&h&&k.parentNode&&c.fadeOnZoom&&(k._fadeOut=h,k.parentNode._remove++),e.add(k);m&&(this._tileIds=[],this._tiles=[],this._tileBounds=[])}r=a.x;m=a.y;"css-transforms"===c.navigationMode?(v={},v[g._css.names.transform]=g._css.translate(r,m),d.set(this._div,
v)):d.set(this._div,{left:r+"px",top:m+"px"});this.__coords_dx=r;this.__coords_dy=m;this._updateImages(new y(0,0,a.width,a.height));0===this._loadingList.count?(this._cleanUpRemovedImages(),this.onUpdate(),this._fireUpdateEnd()):this._fireOnUpdate=!0;m=this._tileW;u=this._tileH;a=new y(-a.x,-a.y,a.width,a.height);for(r=this._tileIds.length-1;0<=r;r--)(v=this._tileIds[r])?(h=this._tiles[v],w=f.getMarginBox(h),w=new y(w.l,w.t,m,u),"css-transforms"===c.navigationMode&&(w.x=h._left,w.y=h._top),a.intersects(w)?
this._tileBounds[v]=w:(this._loadingList.contains(v)&&this._popTile(h),l.destroy(h),this._tileIds.splice(r,1),delete this._tileBounds[v],delete this._tiles[v])):(this._tileIds.splice(r,1),delete this._tileBounds[v],delete this._tiles[v])}},_onPanHandler:function(a,b){a=this._map;b=a.__visibleDelta.offset(b.x,b.y);this.__coords_dx=this.__coords_dy=0;"css-transforms"===a.navigationMode?(a={},a[g._css.names.transform]=g._css.translate(b.x,b.y),d.set(this._div,a),m("esri-mobile")||this._updateImages({x:-b.x,
y:-b.y,width:b.width,height:b.height})):(d.set(this._div,{left:b.x+"px",top:b.y+"px"}),this._updateImages({x:-b.x,y:-b.y,width:b.width,height:b.height}));0<this._loadingList.count&&(this._fireUpdateStart(),this._fireOnUpdate=!0)},_onScaleHandler:function(a,c){var m,f={},r=g._css.names,t=this._map,v=u.defaults.map.zoomDuration;for(m=this._passives.length-1;0<=m;m--){var h=this._passives[m];0===h.childNodes.length?(this._passives.splice(m,1),l.destroy(h)):("none"===h.style[r.transition]&&d.set(h,r.transition,
r.transformName+" "+v+"ms ease"),d.set(h,r.transition,c?"none":r.transformName+" "+v+"ms ease"),h._matrix=a,f[r.transform]=g._css.matrix(h._multiply?b.multiply(a,h._multiply):a),d.set(h,f))}this._active&&0===this._active.childNodes.length||(d.set(this._active,r.transition,c?"none":r.transformName+" "+v+"ms ease"),this._active._matrix=a,f[r.transform]=g._css.matrix(this._active._matrix),d.set(this._active,f),this._passives.push(this._active),f={position:"absolute",width:t.width+"px",height:t.height+
"px",overflow:"visible"},f[r.transition]=r.transformName+" "+v+"ms ease",d.set(this._active=l.create("div",null,this._div),f),this._active._remove=0,t.fadeOnZoom&&l.place(this._active,this._div,"first"))},_onZoomHandler:function(a,b,c){a=f.getMarginBox(this._div);c=c.offset(-a.l,-a.t);this._previousScale&&1!==b||(this._previousScale=1);var g,r=this._tileW*b,t=this._tileH*b,v=this._tileBounds,h=this._tiles,u=this._previousScale,l=this._multiple,w=d.set,n,e;if((a=m("ie"))&&8>a)q.forEach(this._tileIds,
function(a){e="";g=v[a];n=h[a].style.margin.split(" ");q.forEach(n,function(a){""!==e&&(e+=" ");a=parseFloat(a);e+=a/u*b+"px"});w(h[a],{left:g.x-(r-g.width)*(c.x-g.x)/g.width+"px",top:g.y-(t-g.height)*(c.y-g.y)/g.height+"px",margin:1!==l&&-1===e.indexOf("NaN")?e:"",zoom:b})});else{var k=r*l,z=t*l,y,p;q.forEach(this._tileIds,function(a){e="";g=v[a];y=g.x-(r-g.width)*(c.x-g.x)/g.width;p=g.y-(t-g.height)*(c.y-g.y)/g.height;n=h[a].style.margin.split(" ");q.forEach(n,function(a){""!==e&&(e+=" ");a=parseFloat(a);
e+=a/u*b+"px"});w(h[a],{left:y+"px",top:p+"px",margin:1!==l&&-1===e.indexOf("NaN")?e:"",width:k+"px",height:z+"px"})})}this._previousScale=b},_updateImages:function(a){if(this._ct){var b,c=this._tileW,d=this._tileH,g=this._ct;b=g.lod;var g=g.tile,m=g.offsets,f=g.coords,r=f.row,f=f.col,t=b.level,v=this.opacity,h=this._tileIds,u=this._loadingList,l=this._addImage,w=this._map.id,n=this.id,e=a.x,k=a.y,z=b.startTileRow,y=b.endTileRow,p=b.startTileCol,x=b.endTileCol,fa=q.indexOf,Z,G,ia=m.x-this.__coords_dx,
sa=m.y-this.__coords_dy;G=c-ia+-a.x;var wa=d-sa+-a.y;Z=Math.ceil;G=0<G?G%c:c-Math.abs(G)%c;wa=0<wa?wa%d:d-Math.abs(wa)%d;e=0<e?Math.floor((e+ia)/c):Z((e-(c-ia))/c);k=0<k?Math.floor((k+sa)/d):Z((k-(d-sa))/d);sa=e+Z((a.width-G)/c);a=k+Z((a.height-wa)/d);var ua,ma,ja;this._wrap&&(ua=b._frameInfo,ma=ua[0],ja=ua[1],ua=ua[2]);for(wa=e;wa<=sa;wa++)for(e=k;e<=a;e++)Z=r+e,G=f+wa,this._wrap&&(G<ja?(G%=ma,G=G<ja?G+ma:G):G>ua&&(G%=ma)),!this._isExcluded(t,Z,G)&&Z>=z&&Z<=y&&G>=p&&G<=x&&(b=w+"_"+n+"_tile_"+t+"_"+
e+"_"+wa,-1===fa(h,b)&&(u.add(b),h.push(b),l(t,e,Z,wa,G,b,c,d,v,g,m)))}},_cleanUpRemovedImages:function(){var a=this._removeList,b=l.destroy,c,m=g._css.names;a.forEach(function(a){a._fadeOut||(a.style.filter="",a.style.zoom=1,b(a))});if("css-transforms"===this._map.navigationMode)for(c=this._passives.length-1;0<=c;c--){var f=this._passives[c];0===f.childNodes.length?(this._passives.splice(c,1),b(f)):this._map.fadeOnZoom&&!f._marked&&f._remove===f.childNodes.length&&(f._marked=1,2048>g._css.getScaleFromMatrix(d.get(f,
m.transform))?(d.set(f,m.transition,"opacity 0.65s"),d.set(f,"opacity",0),e.disconnect(f._endHandle),f._endHandle=e.connect(f,m.endEvent,this._transitionEnd)):this._transitionEnd({propertyName:"opacity",target:f}))}a.clear()},_transitionEnd:function(a){var b=a.target;"opacity"===a.propertyName&&(e.disconnect(b._endHandle),b._endHandle=null,a=q.indexOf(this._passives,b),-1<a&&this._passives.splice(a,1),b.parentNode&&b.parentNode.removeChild(b),l.destroy(b))},_addImage:function(a,b,c,m,f,r,t,v,u,w,
n){if(this._patchIE)w=this._tiles[r]=l.create("div"),w.id=r,h.add(w,"layerTile"),d.set(w,{left:t*m-n.x+"px",top:v*b-n.y+"px",width:t+"px",height:v+"px",filter:"progid:DXImageTransform.Microsoft.AlphaImageLoader(src\x3d'"+this.getTileUrl(a,c,f)+"', sizingMethod\x3d'scale')"}),1>u&&d.set(w,"opacity",u),a=w.appendChild(l.create("div")),d.set(a,{opacity:0,width:t+"px",height:v+"px"}),this._div.appendChild(w),w=null,this._loadingList.remove(r),this._fireOnUpdateEvent();else{w=this._tiles[r]=l.create("img");
var k=e.connect;w.id=r;w._uid=a+"_"+c+"_"+f;w.alt="";h.add(w,"layerTile");m=t*m-n.x;n=v*b-n.y;b=this._map;var z=g._css.names;t={width:t+"px",height:v+"px",visibility:"hidden"};"css-transforms"===b.navigationMode?(t[z.transform]=g._css.translate(m,n),d.set(w,t),w._left=m,w._top=n):(t.left=m+"px",t.top=n+"px",d.set(w,t));1>u&&d.set(w,"opacity",u);w._onload_connect=k(w,"onload",this,"_tileLoadHandler");w._onerror_connect=k(w,"onerror",p.hitch(this,"_tileErrorHandler",c,f));w._onabort_connect=k(w,"onabort",
this,"_tileAbortHandler");if(this.tileMap)this.tileMap.getTile(a,c,f,r,this._tileMapCallback);else if(r=this.getTileUrl(a,c,f,w))this._failedRequests&&this._failedRequests[r]?(d.set(w,this._failedRequests[r].css),w.src=this._failedRequests[r].src,this._multiple=parseInt(this._failedRequests[r].css.width)/this._tileW,this.isResampling=1!==this._multiple):(this._multiple=1,this.isResampling=!1,w.src=r);"css-transforms"===b.navigationMode?this._active.appendChild(w):this._div.appendChild(w);w=null}},
_tileMapCallback:function(a,b){var g;if(!this.suspended){g=this._tiles[b.id]||c.byId(b.id);var m=b.level+"_"+b.row+"_"+b.col;g&&g._uid===m?(this._multiple=2*(b.level-a.level)||1,this.isResampling=1!==this._multiple,b=this.tileMap.style(a,b),d.set(g,b),g.src=this.getTileUrl(a.level,a.row,a.col)):this._popTile(b)}},getTileUrl:function(a,b,c){},_reCheckTS:/[\?\&]_ts=/ig,_reReplaceTS:/([\?\&]_ts=)[0-9]+/ig,addTimestampToURL:function(a){var b=this._refreshTS;b&&(a=this._reCheckTS.test(a)?a.replace(this._reReplaceTS,
"$$$1"+b):a+((-1===a.indexOf("?")?"?":"\x26")+"_ts\x3d"+b));return a},refresh:function(){this.suspended||(this._refreshTS=(new Date).getTime(),this._onExtentChangeHandler(this._map.extent,null,!0,this._map.__LOD))},_popTile:function(a){var b=e.disconnect;b(a._onload_connect);b(a._onerror_connect);b(a._onabort_connect);a._onload_connect=a._onerror_connect=a._onabort_connect=null;this._loadingList.remove(a.id);this._fireOnUpdateEvent()},_tileLoadHandler:function(a){a=a.currentTarget;this._noDom?this._standby.push(a):
(d.set(a,"visibility","inherit"),this._popTile(a))},_tileAbortHandler:function(a){a=a.currentTarget;this.onError(Error("Unable to load tile: "+a.src));d.set(a,"visibility","hidden");this._popTile(a)},_tileErrorHandler:function(a,b,c){c=c.currentTarget;var g,m,f=!0;if(this.tileMap||!this.resampling)f=!1;else if(g=new n(c.src),g=g.path.split("/"),g=parseInt(g[g.length-3]),m=this._ct.lod.level-g+1,this._multiple=Math.pow(2,m),g===this._lowestLevel||0===this._resamplingTolerance||this._resamplingTolerance&&
Math.log(this._multiple)/Math.LN2>this._resamplingTolerance)f=!1;f?(this.isResampling=!0,this._resample(c,a,b)):(this.onError(Error("Unable to load tile: "+c.src)),d.set(c,"visibility","hidden"),this._popTile(c))},_resample:function(a,b,c){var g=(new n(a.src)).path.split("/"),f=this._multiple,r=parseInt(g[g.length-3])-1,t=parseInt(b/f),v=parseInt(c/f),g=c%f,h=b%f,t=this.getTileUrl(r,t,v);b=this.getTileUrl(r+Math.log(f)/Math.LN2,b,c);f={width:this._tileW*f+"px",height:this._tileH*f+"px",margin:"-"+
this._tileW*h+"px 0 0 "+("-"+this._tileH*g+"px")};this._failedRequests||(this._failedRequests={});this._failedRequests[b]={src:t,css:f};d.set(a,f);m("chrome")&&a.setAttribute("src",null);a.src=t},_fireOnUpdateEvent:function(){0===this._loadingList.count&&(this._cleanUpRemovedImages(),this._fireOnUpdate&&(this._fireOnUpdate=!1,this.onUpdate(),this._fireUpdateEnd()))},setOpacity:function(a){if(this.opacity!=a)this.onOpacityChange(this.opacity=a)},onOpacityChange:function(){},_opacityChangeHandler:function(a){var b=
d.set,c,g,m;if("css-transforms"===this._map.navigationMode){if(this._active)for(m=this._active.childNodes,c=m.length-1;0<=c;c--)b(m[c],"opacity",a);for(c=this._passives.length-1;0<=c;c--)for(m=this._passives[c].childNodes,g=m.length-1;0<=g;g--)b(m[g],"opacity",a)}else for(m=this._div.childNodes,c=m.length-1;0<=c;c--)b(m[c],"opacity",a)},setExclusionAreas:function(a){this.exclusionAreas=a;if(this.loaded&&this._map&&this._map.loaded){var b=this._map.spatialReference,c=this.tileInfo,d=c.origin,g=c.lods,
m=g[0].level,f=g[g.length-1].level,r,t,h,u,l,n,e,k,z;if(this.exclusionAreas&&this.exclusionAreas.length)for(this._exclusionsPerZoom=[],t=0,h=a.length;t<h;t++){if(r=a[t],(z=r.geometry)&&"extent"===z.type&&z.xmin<=z.xmax&&z.ymin<=z.ymax){if(!b.equals(z.spatialReference))if(b._canProject(z.spatialReference))b.isWebMercator()?(k=v.lngLatToXY(z.xmin,z.ymin),z=v.lngLatToXY(z.xmax,z.ymax)):(k=v.xyToLngLat(z.xmin,z.ymin,!0),z=v.xyToLngLat(z.xmax,z.ymax,!0)),z=new w(k[0],k[1],z[0],z[1],b);else continue;e=
-1;if(r.minZoom&&-1!==r.minZoom)e=r.minZoom;else if(r.minScale&&-1!==r.minScale)for(u=0,l=g.length;u<l;u++)if(g[u].scale<=r.minScale){e=g[u].level;break}e=Math.max(e,m);k=-1;if(r.maxZoom&&-1!==r.maxZoom)k=r.maxZoom;else if(r.maxScale&&-1!==r.maxScale)for(u=0,l=g.length;u<l;u++)if(g[u].scale<r.maxScale){k=g[u-1].level;break}else if(g[u].scale===r.maxScale){k=g[u].level;break}k=-1===k?f:Math.min(k,f);for(r=e;r<=k;r++){u=0;for(l=g.length;u<l;u++)if(g[u].level===r){n=g[u];break}n&&(this._exclusionsPerZoom[r]||
(this._exclusionsPerZoom[r]=[]),u=1/n.resolution/c.rows,l=1/n.resolution/c.cols,this._exclusionsPerZoom[r].push({rowFrom:Math.floor((d.y-z.ymax)*u),rowTo:Math.ceil((d.y-z.ymin)*u),colFrom:Math.floor((z.xmin-d.x)*l),colTo:Math.ceil((z.xmax-d.x)*l)}))}}}else this._exclusionsPerZoom=null;this.suspended||this._onExtentChangeHandler(this._map.extent,null,!0,this._map.__LOD)}},_isExcluded:function(a,b,c){var d,g,m;if(!this._exclusionsPerZoom)return!1;d=this._exclusionsPerZoom[a];if(!d)return!1;g=0;for(m=
d.length;g<m;g++)if(a=d[g],b>=a.rowFrom&&b<a.rowTo&&c>=a.colFrom&&c<a.colTo)return!0;return!1}})})},"dojox/collections/ArrayList":function(){define(["dojo/_base/kernel","dojo/_base/array","./_base"],function(k,e,p){p.ArrayList=function(e){var n=[];e&&(n=n.concat(e));this.count=n.length;this.add=function(l){n.push(l);this.count=n.length};this.addRange=function(l){if(l.getIterator)for(l=l.getIterator();!l.atEnd();)this.add(l.get());else for(var h=0;h<l.length;h++)n.push(l[h]);this.count=n.length};this.clear=
function(){n.splice(0,n.length);this.count=0};this.clone=function(){return new p.ArrayList(n)};this.contains=function(l){for(var h=0;h<n.length;h++)if(n[h]==l)return!0;return!1};this.forEach=function(l,h){k.forEach(n,l,h)};this.getIterator=function(){return new p.Iterator(n)};this.indexOf=function(l){for(var h=0;h<n.length;h++)if(n[h]==l)return h;return-1};this.insert=function(l,h){n.splice(l,0,h);this.count=n.length};this.item=function(l){return n[l]};this.remove=function(l){l=this.indexOf(l);0<=
l&&n.splice(l,1);this.count=n.length};this.removeAt=function(l){n.splice(l,1);this.count=n.length};this.reverse=function(){n.reverse()};this.sort=function(l){l?n.sort(l):n.sort()};this.setByIndex=function(l,h){n[l]=h;this.count=n.length};this.toArray=function(){return[].concat(n)};this.toString=function(l){return n.join(l||",")}};return p.ArrayList})},"dojox/collections/_base":function(){define(["dojo/_base/kernel","dojo/_base/lang","dojo/_base/array"],function(k,e,p){k=e.getObject("dojox.collections",
!0);k.DictionaryEntry=function(e,n){this.key=e;this.value=n;this.valueOf=function(){return this.value};this.toString=function(){return String(this.value)}};k.Iterator=function(e){var n=0;this.element=e[n]||null;this.atEnd=function(){return n>=e.length};this.get=function(){return this.atEnd()?null:this.element=e[n++]};this.map=function(l,h){return p.map(e,l,h)};this.reset=function(){n=0;this.element=e[n]}};k.DictionaryIterator=function(e){var n=[],l={},h;for(h in e)l[h]||n.push(e[h]);var f=0;this.element=
n[f]||null;this.atEnd=function(){return f>=n.length};this.get=function(){return this.atEnd()?null:this.element=n[f++]};this.map=function(d,c){return p.map(n,d,c)};this.reset=function(){f=0;this.element=n[f]}};return k})},"esri/layers/ArcGISMapServiceLayer":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has ../kernel ../lang ../request ../SpatialReference ../geometry/Extent ./LayerInfo".split(" "),function(k,e,p,q,n,l,h,f,d,c){return k(null,{declaredClass:"esri.layers.ArcGISMapServiceLayer",
infoTemplates:null,constructor:function(a,b){this.layerInfos=[];b&&(this.infoTemplates=b.infoTemplates||null);a=this._params={};if(b=this._url.query?this._url.query.token:null)a.token=b},setInfoTemplates:function(a){this.infoTemplates=a},_load:function(){h({url:this._url.path,content:e.mixin({f:"json"},this._params),callbackParamName:"callback",load:this._initLayer,error:this._errorHandler})},spatialReference:null,initialExtent:null,fullExtent:null,description:null,units:null,_initLayer:function(a,
b){try{this._findCredential();(this.credential&&this.credential.ssl||a&&a._ssl)&&this._useSSL();this.description=a.description;this.copyright=a.copyrightText;this.spatialReference=a.spatialReference&&new f(a.spatialReference);this.initialExtent=a.initialExtent&&new d(a.initialExtent);this.fullExtent=a.fullExtent&&new d(a.fullExtent);this.units=a.units;this.maxRecordCount=a.maxRecordCount;this.maxImageHeight=a.maxImageHeight;this.maxImageWidth=a.maxImageWidth;this.supportsDynamicLayers=a.supportsDynamicLayers;
var g=this.layerInfos=[],h=a.layers,m=this._defaultVisibleLayers=[];p.forEach(h,function(a,b){g[b]=new c(a);a.defaultVisibility&&m.push(a.id)});this.visibleLayers||(this.visibleLayers=m);this.version=a.currentVersion;this.version||(this.version="capabilities"in a||"tables"in a?10:"supportedImageFormatTypes"in a?9.31:9.3);this.capabilities=a.capabilities;l.isDefined(a.minScale)&&!this._hasMin&&this.setMinScale(a.minScale);l.isDefined(a.maxScale)&&!this._hasMax&&this.setMaxScale(a.maxScale)}catch(r){this._errorHandler(r)}}})})},
"esri/layers/LayerInfo":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel","../lang"],function(k,e,p,q,n){return k(null,{declaredClass:"esri.layers.LayerInfo",constructor:function(l){e.mixin(this,l)},toJson:function(){return n.fixJson({defaultVisibility:this.defaultVisibility,id:this.id,maxScale:this.maxScale,minScale:this.minScale,name:this.name,parentLayerId:this.parentLayerId,subLayerIds:this.subLayerIds})}})})},"esri/layers/TimeInfo":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../TimeExtent ./TimeReference ./LayerTimeOptions".split(" "),
function(k,e,p,q,n,l,h){k=k(null,{declaredClass:"esri.layers.TimeInfo",constructor:function(f){null!==f&&(e.mixin(this,f),f.exportOptions&&(this.exportOptions=new h(f.exportOptions)),this.timeExtent=null,f.timeExtent&&2===f.timeExtent.length&&(this.timeExtent=new n(f.timeExtent)),this.timeReference=new l(f.timeReference))}});e.mixin(k,{UNIT_CENTURIES:"esriTimeUnitsCenturies",UNIT_DAYS:"esriTimeUnitsDays",UNIT_DECADES:"esriTimeUnitsDecades",UNIT_HOURS:"esriTimeUnitsHours",UNIT_MILLISECONDS:"esriTimeUnitsMilliseconds",
UNIT_MINUTES:"esriTimeUnitsMinutes",UNIT_MONTHS:"esriTimeUnitsMonths",UNIT_SECONDS:"esriTimeUnitsSeconds",UNIT_UNKNOWN:"esriTimeUnitsUnknown",UNIT_WEEKS:"esriTimeUnitsWeeks",UNIT_YEARS:"esriTimeUnitsYears"});return k})},"esri/TimeExtent":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","./kernel"],function(k,e,p,q){var n=k(null,{declaredClass:"esri.TimeExtent",constructor:function(l){if(1<arguments.length)this._create(arguments[0],arguments[1]);else if(l)if(e.isArray(l)){var h=
l[0],f=l[1];this.startTime=null===h||"null"===h?null:new Date(h);this.endTime=null===f||"null"===f?null:new Date(f)}else l instanceof Date&&this._create(l,null)},offset:function(l,h){var f=new n,d=this.startTime,c=this.endTime;d&&(f.startTime=this._getOffsettedDate(d,l,h));c&&(f.endTime=this._getOffsettedDate(c,l,h));return f},intersection:function(l){return this._intersection(this,l)},toJson:function(){var l=[],h=this.startTime;l.push(h?h.getTime():"null");h=this.endTime;l.push(h?h.getTime():"null");
return l},_create:function(l,h){this.startTime=l?new Date(l.getTime()):null;this.endTime=h?new Date(h.getTime()):null},_refData:{esriTimeUnitsMilliseconds:{getter:"getUTCMilliseconds",setter:"setUTCMilliseconds",multiplier:1},esriTimeUnitsSeconds:{getter:"getUTCSeconds",setter:"setUTCSeconds",multiplier:1},esriTimeUnitsMinutes:{getter:"getUTCMinutes",setter:"setUTCMinutes",multiplier:1},esriTimeUnitsHours:{getter:"getUTCHours",setter:"setUTCHours",multiplier:1},esriTimeUnitsDays:{getter:"getUTCDate",
setter:"setUTCDate",multiplier:1},esriTimeUnitsWeeks:{getter:"getUTCDate",setter:"setUTCDate",multiplier:7},esriTimeUnitsMonths:{getter:"getUTCMonth",setter:"setUTCMonth",multiplier:1},esriTimeUnitsYears:{getter:"getUTCFullYear",setter:"setUTCFullYear",multiplier:1},esriTimeUnitsDecades:{getter:"getUTCFullYear",setter:"setUTCFullYear",multiplier:10},esriTimeUnitsCenturies:{getter:"getUTCFullYear",setter:"setUTCFullYear",multiplier:100}},_intersection:function(l,h){if(l&&h){var f=l.startTime;l=l.endTime;
var d=h.startTime;h=h.endTime;f=f?f.getTime():-Infinity;d=d?d.getTime():-Infinity;l=l?l.getTime():Infinity;h=h?h.getTime():Infinity;var c,a;d>=f&&d<=l?c=d:f>=d&&f<=h&&(c=f);l>=d&&l<=h?a=l:h>=f&&h<=l&&(a=h);if(isNaN(c)||isNaN(a))return null;f=new n;f.startTime=-Infinity===c?null:new Date(c);f.endTime=Infinity===a?null:new Date(a);return f}return null},_getOffsettedDate:function(l,h,f){var d=this._refData;l=new Date(l.getTime());h&&f&&(d=d[f],l[d.setter](l[d.getter]()+h*d.multiplier));return l}});return n})},
"esri/layers/TimeReference":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel"],function(k,e,p,q){return k(null,{declaredClass:"esri.layers.TimeReference",constructor:function(n){n&&e.mixin(this,n)}})})},"esri/layers/LayerTimeOptions":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel","../lang"],function(k,e,p,q,n){return k(null,{declaredClass:"esri.layers.LayerTimeOptions",constructor:function(l){l&&e.mixin(this,l)},toJson:function(){return n.fixJson({timeDataCumulative:this.timeDataCumulative,
timeOffset:this.timeOffset,timeOffsetUnits:this.timeOffsetUnits,useTime:this.useTime})}})})},"esri/layers/TileMap":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/Deferred dojo/io-query ../request ../urlUtils ../sniff".split(" "),function(k,e,p,q,n,l,h,f){var d=f("esri-iphone");return k(null,{declaredClass:"esri.layers.TileMap",constructor:function(c){this.layer=c;this._tileMaps={}},getTile:function(c,a,b,d,f){c={id:d,level:c,row:a,col:b};a=this._getResamplingBudget();
0<a?this._process({tile:c,requestedTile:c,callback:f,resamplingBudget:a}):(f||this.callback).call(this,c,c)},statusOf:function(c,a,b){var d=this._getResamplingBudget();c={level:c,row:a,col:b};if(0===d)return 1;for(;0<=d;){a=this._tileToTileMap(c);if(!this._tileMaps[a.uid])return-1;a=this._tileMaps[a.uid];if(!a.promise.isFulfilled())return-1;if(this._isTileAvailable(c,a))return 1;c=this._parentTile(c);if(!c)break;d--}return 0},style:function(c,a){if(c.level!==a.level||c.row!==a.row||c.col!==a.col){for(var b=
this.layer.tileInfo,g=b.lods,f=b.cols,b=b.rows,m,r,t=g.length-1;!m||!r;)m||g[t].level!==c.level||(m=g[t]),r||g[t].level!==a.level||(r=g[t]),t--;g=Math.round(m.resolution/r.resolution);c=a.col%g*-1*f;a=a.row%g*-1*b;g={width:f*g+"px",height:b*g+"px",margin:a+"px 0 0 "+c+"px","will-change":"transform"};d&&(c=0===c?0:-1*c,a=0===a?0:-1*a,g.clip="rect("+a+"px,"+(c+f)+"px,"+(a+b)+"px,"+c+"px)");return g}},_process:function(c){var a=c.tile,b=this._tileToTileMap(a),d=this._parentTile(a);this._getTileMap(b).then(e.hitch(this,
function(g){b=g;this._isTileAvailable(a,b)?(c.callback||this.callback).call(this,a,c.requestedTile):0<c.resamplingBudget&&d?(c.resamplingBudget--,c.tile=d,this._process(c)):(c.callback||this.callback).call(this,c.requestedTile,c.requestedTile)}),e.hitch(this,function(){(c.callback||this.callback).call(this,c.requestedTile,c.requestedTile)}))},_getTileMap:function(c){var a,b,d,f,m=null;this._tileMaps[c.uid]?(c=this._tileMaps[c.uid],a=c.promise):(this._tileMaps[c.uid]=c,b=new q,l({url:this._getTileMapUrl(c.level,
c.row,c.col),handleAs:"json",callbackParamName:"callback",timeout:3E3,load:function(a){e.mixin(c,a);if(c.data&&0<c.data.length){f=c.data.length;if(1===f)m=c.data[0];else for(m=c.data[0],d=1;d<f;d++)if(c.data[d]!==m){m=null;break}null!==m&&(delete c.data,c.value=m)}b.resolve(c)},error:function(a){b.reject()}}),a=c.promise=b.promise);return a},_parentTile:function(c){var a=this.layer.tileInfo.lods,b,d,f=null;p.some(a,function(a,g){return c.level===a.level?(b=a,d=g,!0):!1});0<d&&(a=a[d-1],f={id:c.id,
level:a.level,row:Math.floor(c.row*b.resolution/a.resolution+.01),col:Math.floor(c.col*b.resolution/a.resolution+.01)});return f},_tileToTileMap:function(c){var a=8*Math.floor(c.row/8),b=8*Math.floor(c.col/8);return{uid:c.level+"_"+a+"_"+b,level:c.level,row:a,col:b}},_isTileAvailable:function(c,a){var b,d;a.valid?void 0!==a.value?c=a.value:(b=a.location.left,d=a.location.top,c=(c.row-d)*a.location.width+(c.col-b),c=c<a.data.length?a.data[c]:0):c=0;return c},_getTileMapUrl:function(c,a,b){var d=this.layer,
f=d.tileServers,m=d._getToken(),r=d._url.query;c=(f?f[a%f.length]:d._url.path)+"/tilemap/"+c+"/"+a+"/"+b+"/8/8";r&&(c+="?"+n.objectToQuery(r));!m||r&&r.token||(c+=(-1===c.indexOf("?")?"?":"\x26")+"token\x3d"+m);return c=d.addTimestampToURL(c)},_getResamplingBudget:function(){var c=this.layer,a=0;c.resampling&&(a=c._resamplingTolerance,null===a||void 0===a)&&(a=c.tileInfo.lods.length);return a}})})},"esri/layers/MapImageLayer":function(){define("dojo/_base/declare dojo/_base/connect dojo/_base/lang dojo/_base/array dojo/dom-construct dojo/dom-style ../kernel ../config ../sniff ../domUtils ../geometry/Point ../geometry/webMercatorUtils ./layer".split(" "),
function(k,e,p,q,n,l,h,f,d,c,a,b,g){var u=k([g],{declaredClass:"esri.layers.MapImageLayer","-chains-":{constructor:"manual"},constructor:function(a){this.inherited(arguments,[null,a]);this._mapImages=[];var b=p.hitch;this._panStart=b(this,this._panStart);this._pan=b(this,this._pan);this._extentChange=b(this,this._extentChange);this._zoom=b(this,this._zoom);this._zoomStart=b(this,this._zoomStart);this._scale=b(this,this._scale);this._resize=b(this,this._resize);e.connect(this,"onSuspend",this,this._onSuspend);
e.connect(this,"onResume",this,this._onResume);this.loaded=!0;this.onLoad(this)},opacity:1,addImage:function(a){var b=this._mapImages.push(a),b=b-1;a._idx=b;a._layer=this;this._div&&this._createImage(a,b)},removeImage:function(a){if(a){var b=a._idx,c=this._mapImages;if(c[b]===a){delete c[b];if(b=a._node)this._clearEvents(b),b.e_idx=b.e_bl=b.e_tr=b.e_l=b.e_t=b.e_w=b.e_h=null,b.parentNode&&(b.parentNode.removeChild(b),n.destroy(b));a._node=a._idx=a._layer=null}}},removeAllImages:function(){var a=this._mapImages,
b,c=a.length;for(b=0;b<c;b++){var d=a[b];d&&this.removeImage(d)}this._mapImages=[]},getImages:function(){var a=this._mapImages,b=[],c,d=a.length;for(c=0;c<d;c++)a[c]&&b.push(a[c]);return b},setOpacity:function(a){this.opacity!=a&&(this._opacityChanged(this.opacity=a),this.onOpacityChange())},onOpacityChange:function(){},_opacityChanged:function(a){var b=this._div,c,g;if(b)if(!d("ie")||8<d("ie"))l.set(b,"opacity",a);else for(g=b.childNodes,c=g.length,b=0;b<c;b++)l.set(g[b],"opacity",a)},_createImage:function(a,
b){var c=n.create("img");l.set(c,{position:"absolute"});1>a.opacity?l.set(c,"opacity",a.opacity):8>=d("ie")&&l.set(c,"opacity",this.opacity);!a.rotation||9>d("ie")||l.set(c,h._css.names.transform,h._css.rotate(360-a.rotation));a._node=c;c.e_idx=b;c.e_layer=this;c.e_load=e.connect(c,"onload",u.prototype._imageLoaded);c.e_error=e.connect(c,"onerror",u.prototype._imageError);c.e_abort=e.connect(c,"onabort",u.prototype._imageError);c.src=a.href},_imageLoaded:function(a,b){a=b||a.target||a.currentTarget;
b=a.e_layer;var c=b._mapImages[a.e_idx],d=b._map;d&&(d.__zooming||d.__panning||!b._sr)?b._standby.push(a):(b._clearEvents(a),c&&c._node===a&&d&&b._attach(c))},_imageError:function(a){a=a.target||a.currentTarget;var b=a.e_layer,c=b._mapImages[a.e_idx];b._clearEvents(a);c&&(c._node=null)},_clearEvents:function(a){var b=e.disconnect;b(a.e_load);b(a.e_error);b(a.e_abort);a.e_load=a.e_error=a.e_abort=a.e_layer=null},_attach:function(c){var d=c.extent,g=d.spatialReference,m=this._sr,f=this._div,h=c._node,
u=new a({x:d.xmin,y:d.ymin,spatialReference:g}),d=new a({x:d.xmax,y:d.ymax,spatialReference:g});m.equals(g)||(m.isWebMercator()&&4326===g.wkid?(u=b.geographicToWebMercator(u),d=b.geographicToWebMercator(d)):g.isWebMercator()&&4326===m.wkid&&(u=b.webMercatorToGeographic(u),d=b.webMercatorToGeographic(d)));h.e_bl=u;h.e_tr=d;c.visible&&(this._setPos(h,f._left,f._top),(this._active||f).appendChild(h))},_setPos:function(a,b,c){var d=a.e_bl,g=a.e_tr,m=this._map,d=m.toScreen(d),g=m.toScreen(g);b=d.x-b;c=
g.y-c;var f=Math.abs(g.x-d.x),d=Math.abs(d.y-g.y),g={width:f+"px",height:d+"px"},r=this._mapImages[a.e_idx];"css-transforms"===m.navigationMode?g[h._css.names.transform]=h._css.translate(b,c)+(r.rotation?" "+h._css.rotate(360-r.rotation):""):(g.left=b+"px",g.top=c+"px");l.set(a,g);a.e_l=b;a.e_t=c;a.e_w=f;a.e_h=d},managedSuspension:!0,_setMap:function(a,b){this.inherited(arguments);var g=this._div=n.create("div",null,b),m=h._css.names,f={position:"absolute"},r=a.__visibleDelta;if(!d("ie")||8<d("ie"))f.opacity=
this.opacity;"css-transforms"===a.navigationMode?(f[m.transform]=h._css.translate(r.x,r.y),l.set(g,f),g._left=r.x,g._top=r.y,f={position:"absolute",width:a.width+"px",height:a.height+"px",overflow:"visible"},this._active=n.create("div",null,g),l.set(this._active,f),this._passive=n.create("div",null,g),l.set(this._passive,f)):(g._left=0,g._top=0,l.set(g,f));this._standby=[];m=this._mapImages;r=m.length;for(f=0;f<r;f++){var u=m[f];u._node||this._createImage(u,u._idx)}c.hide(g);return g},_unsetMap:function(a,
b){this._disconnect();var c=this._div;if(c){var d=this._mapImages,g,m=d.length;for(g=0;g<m;g++){var f=d[g];if(f){var r=f._node;r&&(this._clearEvents(r),r.e_idx=r.e_bl=r.e_tr=r.e_l=r.e_t=r.e_w=r.e_h=null);f._node=null}}b.removeChild(c);n.destroy(c)}this._map=this._div=this._sr=this._active=this._passive=this._standby=null;this.inherited(arguments)},_onSuspend:function(){this._disconnect();c.hide(this._div)},_onResume:function(a){a.firstOccurrence&&(this._sr=this._map.spatialReference,this._processStandbyList());
a=this._map;var b=this._div,d=a.__visibleDelta;"css-transforms"===a.navigationMode&&(b._left=d.x,b._top=d.y,l.set(b,h._css.names.transform,h._css.translate(b._left,b._top)));this._redraw("css-transforms"===a.navigationMode);this._connect(a);c.show(b)},_connect:function(a){if(!this._connections){var b=e.connect,c="css-transforms"===a.navigationMode;this._connections=[b(a,"onPanStart",this._panStart),b(a,"onPan",this._pan),b(a,"onExtentChange",this._extentChange),c&&b(a,"onZoomStart",this._zoomStart),
c?b(a,"onScale",this._scale):b(a,"onZoom",this._zoom),c&&b(a,"onResize",this._resize)]}},_disconnect:function(){this._connections&&(q.forEach(this._connections,e.disconnect),this._connections=null)},_panStart:function(){this._panL=this._div._left;this._panT=this._div._top},_pan:function(a,b){a=this._div;a._left=this._panL+b.x;a._top=this._panT+b.y;"css-transforms"===this._map.navigationMode?l.set(a,h._css.names.transform,h._css.translate(a._left,a._top)):l.set(a,{left:a._left+"px",top:a._top+"px"})},
_extentChange:function(a,b,c){c?this._redraw("css-transforms"===this._map.navigationMode):b&&this._pan(a,b);this._processStandbyList()},_processStandbyList:function(){var a,b=this._standby;if(b&&b.length)for(a=b.length-1;0<=a;a--)this._imageLoaded(null,b[a]),b.splice(a,1)},_redraw:function(a){if(a){a=this._passive;var b=h._css.names;l.set(a,b.transition,"none");this._moveImages(a,this._active);l.set(a,b.transform,"none")}a=this._active||this._div;var b=this._div._left,c=this._div._top,d,g=a.childNodes.length,
m;for(d=0;d<g;d++)m=a.childNodes[d],this._setPos(m,b,c)},_zoom:function(a,b,c){a=this._div;var d=a._left,g=a._top,m,f=a.childNodes.length,r;for(m=0;m<f;m++){r=a.childNodes[m];var t=r.e_w*b,h=r.e_h*b,u=(c.x-d-r.e_l)*(t-r.e_w)/r.e_w,n=(c.y-g-r.e_t)*(h-r.e_h)/r.e_h,u=isNaN(u)?0:u,n=isNaN(n)?0:n;l.set(r,{left:r.e_l-u+"px",top:r.e_t-n+"px",width:t+"px",height:h+"px"})}},_zoomStart:function(){this._moveImages(this._active,this._passive)},_moveImages:function(a,b){a=a.childNodes;var c;c=a.length;if(0<c)for(--c;0<=
c;c--)b.appendChild(a[c])},_scale:function(a,b){var c=h._css.names,d=this._passive;l.set(d,c.transition,b?"none":c.transformName+" "+f.defaults.map.zoomDuration+"ms ease");({})[c.transform]=h._css.matrix(a);l.set(d,c.transform,h._css.matrix(a))},_resize:function(a,b,c){l.set(this._active,{width:b+"px",height:c+"px"});l.set(this._passive,{width:b+"px",height:c+"px"})}});return u})},"esri/layers/OpenStreetMapLayer":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../urlUtils ../SpatialReference ../geometry/Extent ./TiledMapServiceLayer ./TileInfo".split(" "),
function(k,e,p,q,n,l,h,f,d){return k(f,{declaredClass:"esri.layers.OpenStreetMapLayer",constructor:function(c){this.spatialReference=new l({wkid:102100});this.tileInfo=new d({rows:256,cols:256,dpi:96,format:"PNG8",compressionQuality:0,origin:{x:-2.0037508342787E7,y:2.0037508342787E7},spatialReference:{wkid:102100},lods:[{level:0,scale:5.91657527591555E8,resolution:156543.033928},{level:1,scale:2.95828763795777E8,resolution:78271.5169639999},{level:2,scale:1.47914381897889E8,resolution:39135.7584820001},
{level:3,scale:7.3957190948944E7,resolution:19567.8792409999},{level:4,scale:3.6978595474472E7,resolution:9783.93962049996},{level:5,scale:1.8489297737236E7,resolution:4891.96981024998},{level:6,scale:9244648.868618,resolution:2445.98490512499},{level:7,scale:4622324.434309,resolution:1222.99245256249},{level:8,scale:2311162.217155,resolution:611.49622628138},{level:9,scale:1155581.108577,resolution:305.748113140558},{level:10,scale:577790.554289,resolution:152.874056570411},{level:11,scale:288895.277144,
resolution:76.4370282850732},{level:12,scale:144447.638572,resolution:38.2185141425366},{level:13,scale:72223.819286,resolution:19.1092570712683},{level:14,scale:36111.909643,resolution:9.55462853563415},{level:15,scale:18055.954822,resolution:4.77731426794937},{level:16,scale:9027.977411,resolution:2.38865713397468},{level:17,scale:4513.988705,resolution:1.19432856685505},{level:18,scale:2256.994353,resolution:.597164283559817},{level:19,scale:1128.497176,resolution:.298582141647617}]});this.fullExtent=
new h({xmin:-2.003750834E7,ymin:-2.003750834E7,xmax:2.003750834E7,ymax:2.003750834E7,spatialReference:{wkid:102100}});this.initialExtent=new h({xmin:-2.003750834E7,ymin:-2.003750834E7,xmax:2.003750834E7,ymax:2.003750834E7,spatialReference:{wkid:102100}});this.tileServers=c&&c.tileServers||["//a.tile.openstreetmap.org","//b.tile.openstreetmap.org","//c.tile.openstreetmap.org"];this.serversLength=this.tileServers.length;this._displayLevels=c?c.displayLevels:null;this.copyright=c&&c.copyright||"Map data \u00a9 OpenStreetMap contributors, CC-BY-SA";
this.loaded=!0;this.onLoad(this);(c=c&&c.loadCallback)&&c(this)},getTileUrl:function(c,a,b){c=this.tileServers[a%this.serversLength]+"/"+c+"/"+b+"/"+a+".png";c=n.normalize(c);c=this.addTimestampToURL(c);return n.addProxy(c)}})})},"esri/layers/VectorTileLayer":function(){(function(){var k=function(){var e;try{e=window.WebGLRenderingContext}catch(d){e=!1}var k;try{for(var n=document.createElement("canvas"),l=["webgl","experimental-webgl","webkit-3d","moz-webgl"],h=null,f=0;f<l.length;++f){try{h=n.getContext(l[f])}catch(d){}if(h)break}k=
h}catch(d){k=!1}return e&&k?!0:!1}(),e=["dojo/_base/lang","dojo/has","dojo/Deferred","../sniff","./layer"];k&&e.push("./VectorTileLayerImpl");define(e,function(e,q,n,l,h,f){q=f?f:h.createSubclass({declaredClass:"esri.layers.VectorTileLayer",constructor:function(){var d=new n;d.reject(Error("esri.layers.VectorTileLayer is not supported"));d.promise.otherwise(e.hitch(this,function(c){this._errorHandler(c)}))}});q.ACCESS_TOKEN=null;q.supported=function(){return k};return q})})()},"esri/dijit/Popup":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/_base/kernel dojo/has dojo/window dojo/Stateful dojo/query dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/dom-geometry dojo/dom-style dijit/registry ../kernel ../lang ../domUtils ../geometry/Polyline ../geometry/Polygon ../geometry/Multipoint ../geometry/normalizeUtils ../InfoWindowBase ../PopupBase dojo/i18n!../nls/jsapi dojo/NodeList-dom require require".split(" "),
function(k,e,p,q,n,l,h,f,d,c,a,b,g,u,m,r,t,v,y,w,z,x,A,C,B,E){return k([C,B,f],{declaredClass:"esri.dijit.Popup",offsetX:3,offsetY:3,zoomFactor:4,marginLeft:25,marginTop:25,highlight:!0,pagingControls:!0,pagingInfo:!0,keepHighlightOnHide:!1,popupWindow:!0,titleInBody:!0,anchor:"auto",visibleWhenEmpty:!0,hideDelay:1E3,location:null,constructor:function(d,g){this.initialize();e.mixin(this,d);this.domNode=c.byId(g);g=this._nls=e.mixin({},E.widgets.popup);d=this.domNode;b.add(d,"esriPopup");(this._isRTL=
!u.isBodyLtr())&&m.set(d,"direction","rtl");a.set(d,"innerHTML","\x3cdiv class\x3d'esriPopupWrapper' style\x3d'position: absolute;'\x3e\x3cdiv class\x3d'sizer'\x3e\x3cdiv class\x3d'titlePane'\x3e\x3cdiv class\x3d'spinner hidden' title\x3d'"+g.NLS_searching+"...'\x3e\x3c/div\x3e\x3cdiv class\x3d'title'\x3e\x3c/div\x3e\x3cdiv class\x3d'titleButton prev hidden' title\x3d'"+g.NLS_prevFeature+"'\x3e\x3c/div\x3e\x3cdiv class\x3d'titleButton next hidden' title\x3d'"+g.NLS_nextFeature+"'\x3e\x3c/div\x3e\x3cdiv class\x3d'titleButton maximize' title\x3d'"+
g.NLS_maximize+"'\x3e\x3c/div\x3e\x3cdiv class\x3d'titleButton close' title\x3d'"+g.NLS_close+"'\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d'sizer content'\x3e\x3cdiv class\x3d'contentPane'\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d'sizer'\x3e\x3cdiv class\x3d'actionsPane'\x3e\x3cdiv class\x3d'actionList hidden'\x3e\x3ca title\x3d'"+g.NLS_zoomTo+"' class\x3d'action zoomTo' href\x3d'javascript:void(0);'\x3e\x3cspan\x3e"+g.NLS_zoomTo+"\x3c/span\x3e\x3c/a\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d'pointer hidden'\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d'outerPointer hidden'\x3e\x3c/div\x3e");
this._sizers=n.query(".sizer",d);g=n.query(".titlePane",d)[0];this._title=n.query(".title",g)[0];this._prevFeatureButton=n.query(".prev",g)[0];this._nextFeatureButton=n.query(".next",g)[0];this._maxButton=n.query(".maximize",g)[0];this._spinner=n.query(".spinner",g)[0];this._contentPane=n.query(".contentPane",d)[0];this._positioner=n.query(".esriPopupWrapper",d)[0];this._pointer=n.query(".pointer",d)[0];this._outerPointer=n.query(".outerPointer",d)[0];this._actionList=n.query(".actionsPane .actionList",
d)[0];this._contentUpdateHandles={};this._eventConnections=[q.connect(n.query(".close",g)[0],"onclick",this,this.hide),q.connect(this._prevFeatureButton,"onclick",this,this.selectPrevious),q.connect(this._nextFeatureButton,"onclick",this,this.selectNext),q.connect(this._maxButton,"onclick",this,this._toggleSize),q.connect(n.query(".zoomTo",this._actionList)[0],"onclick",this,this._zoomToFeature),q.connect(this,"onClearFeatures",this,this._featuresCleared),q.connect(this,"onSelectionChange",this,this._featureSelected),
q.connect(this,"onDfdComplete",this,this._updateUI)];l("esri-touch")&&(d=y.setScrollable(this._contentPane),this._eventConnections.push(d[0],d[1]));this._toggleVisibility(!1)},onMaximize:function(){},onRestore:function(){},setMap:function(a){this.inherited(arguments);g.place(this.domNode,a.root);this.highlight&&this.enableHighlight(a);this._maxHeight=m.get(this._contentPane,"maxHeight")},unsetMap:function(){this.disableHighlight(this.map);this.inherited(arguments)},setTitle:function(a){this.popupWindow&&
(v.isDefined(a)&&""!==a||(a="\x26nbsp;"),this.destroyDijits(this._title),this.place(a,this._title),this.isShowing&&(this.startupDijits(this._title),this.reposition()))},setContent:function(a){this.popupWindow&&(v.isDefined(a)&&""!==a||(a="\x26nbsp;"),this._destroyContent(),this.place(a,this._contentPane),this.isShowing&&(this._startupContent(),this.reposition()))},show:function(a,b){if(this.popupWindow)if(this._delayHide=!1,a){var c=this.map;a.spatialReference?(this.location=a,a=c.toScreen(a)):this.location=
c.toMap(a);var d=c._getFrameWidth();if(-1!==d&&(a.x%=d,0>a.x&&(a.x+=d),c.width>d))for(c=(c.width-d)/2;a.x<c;)a.x+=d;this._maximized?this.restore():this._setPosition(a);b&&b.closestFirst&&this.showClosestFirst(this.location);this.isShowing||(this._toggleVisibility(!0),this._followMap(),this.startupDijits(this._title),this._startupContent(),this.reposition(),this.showHighlight(),this.onShow())}else this._toggleVisibility(!0)},hide:function(){this.isShowing&&(this._toggleVisibility(!1),this._unfollowMap(),
this.keepHighlightOnHide||this.hideHighlight(),this.onHide())},resize:function(a,b){this.popupWindow&&(this._sizers.style({width:a+"px"}),m.set(this._contentPane,"maxHeight",b+"px"),this._maxHeight=b,this.isShowing&&this.reposition())},reposition:function(){this.popupWindow&&this.map&&this.location&&!this._maximized&&this.isShowing&&this._setPosition(this.map.toScreen(this.location))},addActions:function(a){return p.map(a,function(a){var b=g.create("a",{href:"javascript:void(0);",className:"action "+
a.className,title:a.title,innerHTML:a.title},this._actionList);q.connect(b,"onclick",a.callback);return{action:a,node:b}},this)},removeActions:function(a){p.forEach(a,function(a){g.destroy(a.node)})},getCurrentAnchor:function(){return this._anchor},maximize:function(){var c=this.map;if(c&&!this._maximized&&this.popupWindow){this._maximized=!0;var d=this._maxButton;b.remove(d,"maximize");b.add(d,"restore");a.set(d,"title",this._nls.NLS_restore);var d=this.marginLeft,g=this.marginTop,f=c.width-2*d,
c=c.height-2*g;m.set(this.domNode,{left:this._isRTL?null:d+"px",right:this._isRTL?d+"px":null,top:g+"px",bottom:null});m.set(this._positioner,{left:null,right:null,top:null,bottom:null});this._savedWidth=m.get(this._sizers[0],"width");this._savedHeight=m.get(this._contentPane,"maxHeight");this._sizers.style({width:f+"px"});m.set(this._contentPane,{maxHeight:c-65+"px",height:c-65+"px"});this._showPointer("");this._unfollowMap();b.add(this.domNode,"esriPopupMaximized");this.onMaximize()}},restore:function(){if(this.map&&
this._maximized&&this.popupWindow){this._maximized=!1;var c=this._maxButton;b.remove(c,"restore");b.add(c,"maximize");a.set(c,"title",this._nls.NLS_maximize);m.set(this._contentPane,"height",null);this.resize(this._savedWidth,this._savedHeight);this._savedWidth=this._savedHeight=null;this.show(this.location);this._followMap();b.remove(this.domNode,"esriPopupMaximized");this.onRestore()}},startup:function(){},destroy:function(){this.map&&this.unsetMap();this.cleanup();this.isShowing&&this.hide();this.destroyDijits(this._title);
this._destroyContent();p.forEach(this._eventConnections,q.disconnect);g.destroy(this.domNode);this._sizers=this._contentPane=this._actionList=this._positioner=this._pointer=this._outerPointer=this._title=this._prevFeatureButton=this._nextFeatureButton=this._spinner=this._eventConnections=this._pagerScope=this._targetLocation=this._nls=this._maxButton=null},selectNext:function(){this.select(this.selectedIndex+1)},selectPrevious:function(){this.select(this.selectedIndex-1)},setFeatures:function(a,b){this._transientAnchor=
b&&b.anchor;this.inherited(arguments);this._updateUI()},clearFeatures:function(a){a||(this._transientAnchor=null);this.inherited(arguments)},postscript:null,_highlightSetter:function(a){var b=this.highlight,c=this.map;this.highlight=a;if(c&&a!==b)if(a){if(this.enableHighlight(c),a=this.features&&this.features[this.selectedIndex])this.updateHighlight(c,a),this.showHighlight()}else this.disableHighlight(c)},_pagingControlsSetter:function(a){var b=this.pagingControls,c=this.map;this.pagingControls=a;
c&&a!==b&&this._updatePagingControls()},_pagingInfoSetter:function(a){var b=this.pagingInfo,c=this.map;this.pagingInfo=a;c&&a!==b&&this.features&&this.features.length&&this._updatePagingInfo()},_popupWindowSetter:function(a){var b=this.popupWindow,c=this.map;this.popupWindow=a;c&&a!==b&&(a?(this._updateUI(),this._updateWindow()):(this.hide(),this.showHighlight()))},_anchorSetter:function(a){var b=this.anchor;this.anchor=a;this.map&&a!==b&&this.reposition()},_startupContent:function(){var a=this._contentPane;
this.startupDijits(a);p.forEach(this._getPopupRendererDijits(a),function(a){if(!this._contentUpdateHandles[a.id]){var b=a.on("content-update",e.hitch(this,function(){this.reposition()}));this._contentUpdateHandles[a.id]=b}},this)},_destroyContent:function(){var a=this._contentPane;p.forEach(this._getPopupRendererDijits(a),function(a){var b=this._contentUpdateHandles[a.id];b&&(b.remove(),delete this._contentUpdateHandles[a.id])},this);this.destroyDijits(a)},_getPopupRendererDijits:function(a){a=this.getDijits(a);
return a=p.filter(a,function(a){return a&&a.set&&/_PopupRenderer/.test(a.declaredClass)})},_featuresCleared:function(){this.setTitle("\x26nbsp;");this.setContent("\x26nbsp;");this._setPagerCallbacks(this);this._updateUI();this.hideHighlight()},_featureSelected:function(){this._updateUI();this._updateWindow()},_updateWindow:function(){var a=this.selectedIndex;if(0<=a){var b=this.features[a].getContent();if(!this.titleInBody&&b&&e.isString(b.id)){var c=r.byId(b.id);c&&c.set&&/_PopupRenderer/.test(c.declaredClass)&&
c.set("showTitle",!1)}this.setContent(b);this.updateHighlight(this.map,this.features[a]);this.showHighlight()}},_toggleVisibility:function(a){this._setVisibility(a);this.isShowing=a},_setVisibility:function(a){b.toggle(this.domNode,"esriPopupVisible",a);b.toggle(this.domNode,"esriPopupHidden",!a)},_waitAndHide:function(a){var b=this;this._delayHide=!0;setTimeout(function(){b._delayHide&&(b._delayHide=!1,b.hide())},a)},_followMap:function(){this._unfollowMap();var a=this.map;this._handles=[q.connect(a,
"onPanStart",this,this._onPanStart),q.connect(a,"onPan",this,this._onPan),q.connect(a,"onZoomStart",this,this._onZoomStart),q.connect(a,"onExtentChange",this,this._onExtentChange)]},_unfollowMap:function(){var a=this._handles;a&&(p.forEach(a,q.disconnect),this._handles=null)},_onPanStart:function(){var a=this.domNode.style;this._panOrigin={left:a.left,top:a.top,right:a.right,bottom:a.bottom}},_onPan:function(a,b){var c=this._panOrigin;a=b.x;b=b.y;var d=c.left,g=c.top,f=c.right,c=c.bottom;d&&(d=parseFloat(d)+
a+"px");g&&(g=parseFloat(g)+b+"px");f&&(f=parseFloat(f)-a+"px");c&&(c=parseFloat(c)-b+"px");m.set(this.domNode,{left:d,top:g,right:f,bottom:c})},_onZoomStart:function(){this._setVisibility(!1)},_onExtentChange:function(a,b,c){c&&(this._setVisibility(!0),this.show(this._targetLocation||this.location));this._targetLocation=null},_toggleSize:function(){this._maximized?this.restore():this.maximize()},_getTargetAnchor:function(){return this._transientAnchor||this.anchor},_setPosition:function(a){var b=
a.x,c=a.y;a=this.offsetX||0;var d=this.offsetY||0,g=0,f=0,r=u.position(this.map.container,!0),t=r.w,v=r.h,l="Left",w="bottom",n="right",e="top",k=u.getContentBox(this._positioner),z=k.w/2,y=k.h/2,p=m.get(this._sizers[0],"height")+this._maxHeight+m.get(this._sizers[2],"height"),x=p/2,q=0,B=0,C=b,A=c,D=this._getTargetAnchor().toLowerCase();if("auto"===D){if(D=h.getBox)D=D(),q=Math.max(D.l,r.x),t=Math.min(D.l+D.w,r.x+r.w),B=Math.max(D.t,r.y),v=Math.min(D.t+D.h,r.y+r.h),C+=r.x,A+=r.y;r=A-B>=p;p=v-A>=
p;D=t-C>=k.w;k=C-q>=k.w;A-B>x&&v-A>=x&&(D?(w="",l="Left",e="",n="right"):k&&(w="",l="Right",e="",n="left"));l&&w&&C-q>z&&t-C>=z&&(r?(l="",w="bottom",n="",e="top"):p&&(l="",w="top",n="",e="bottom"));l&&w&&(D&&r?(l="Left",w="bottom",n="right",e="top"):D&&p?(l="Left",w="top",n="right",e="bottom"):k&&p?(l="Right",w="top",n="left",e="bottom"):k&&r&&(l="Right",w="bottom",n="left",e="top"));this._anchor=e&&n?e+"-"+n:e||n}else w=l="",-1!==D.indexOf("top")?w="bottom":-1!==D.indexOf("bottom")&&(w="top"),-1!==
D.indexOf("left")?l="Right":-1!==D.indexOf("right")&&(l="Left"),this._anchor=this._getTargetAnchor();n=w+l;switch(n){case "top":case "bottom":f=14;break;case "Left":case "Right":g=13;break;case "topLeft":case "topRight":case "bottomLeft":case "bottomRight":f=14,g=-16}m.set(this.domNode,{left:b+"px",top:c+"px",right:null,bottom:null});b={left:null,right:null,top:null,bottom:null};l?b[l.toLowerCase()]=g+a+"px":b.left=-z+"px";w?b[w]=f+d+"px":b.top=-y+"px";m.set(this._positioner,b);this._showPointer(n)},
_showPointer:function(a){b.remove(this._pointer,"top bottom right left topLeft topRight bottomRight bottomLeft hidden".split(" "));b.remove(this._outerPointer,["right","left","hidden"]);"Right"===a||"Left"===a?(a=a.toLowerCase(),b.add(this._outerPointer,a)):b.add(this._pointer,a)},_setPagerCallbacks:function(a,b,c){if(this.pagingControls&&(a!==this||this._pagerScope&&this._pagerScope!==this)&&a!==this._pagerScope){this._pagerScope=a;a===this&&(b=this.selectPrevious,c=this.selectNext);var d=this._eventConnections;
q.disconnect(d[1]);q.disconnect(d[2]);b&&(d[1]=q.connect(this._prevFeatureButton,"onclick",a,b));c&&(d[2]=q.connect(this._nextFeatureButton,"onclick",a,c))}},_getLocation:function(a){var b,c,d=a&&a.geometry;if(d)switch(d.type){case "point":b=d;a.isAggregate()&&(a=a.getChildGraphics(),c=a[0],a=(c=c.geometry&&c.geometry.spatialReference)&&new x({points:p.map(a,function(a){a=a.geometry;return[a.x,a.y]}),spatialReference:c.toJson()}),c=A.getDenormalizedExtent(a));break;case "multipoint":b=d.getPoint(0);
c=A.getDenormalizedExtent(d);break;case "polyline":case "polygon":b=d.getPoint(0,0),c=A.getDenormalizedExtent(d)}return[b,c]},_zoomToFeature:function(a){a.preventDefault();var b=this.features,c=this.selectedIndex;a=this.map;if(b)if(c=this._getLocation(b[c]),b=c[0],c=c[1],b||(b=this.location),c&&c.intersects(this.location)||(this.location=b),c&&c.getWidth()&&c.getHeight())a.setExtent(c,!0);else{var d=a.getNumLevels(),c=a.getLevel(),g=a.getMaxZoom(),m=this.zoomFactor||1;0<d?c!==g&&(d=c+m,d>g&&(d=g),
a.navigationManager._wheelZoom({value:d-c,mapPoint:b},!0)):a.navigationManager._wheelZoom({value:1/Math.pow(2,m)*2,mapPoint:b},!0)}},_updatePagingControls:function(){var a=this._prevFeatureButton,c=this._nextFeatureButton,d=this.selectedIndex,g=this.features?this.features.length:0;this.pagingControls&&1<g?(0===d?b.add(a,"hidden"):b.remove(a,"hidden"),d===g-1?b.add(c,"hidden"):b.remove(c,"hidden")):(b.add(a,"hidden"),b.add(c,"hidden"))},_updatePagingInfo:function(){var a=this.features?this.features.length:
0,b=this._nls,c="\x26nbsp;";this.pagingInfo&&1<a&&b.NLS_pagingInfo&&(c=v.substitute({index:this.selectedIndex+1,total:a},b.NLS_pagingInfo));a&&(b=this.getSelectedFeature(),a=b.getInfoTemplate(),b=b.getTitle(),a&&!/esri\.InfoTemplate/.test(a.declaredClass)&&this.titleInBody||!b||(c=b+("\x26nbsp;"===c?"":" "+c)));this.setTitle(c)},_updateUI:function(){if(this.popupWindow){var a=this.features,c=this.deferreds,d=a?a.length:0,g=this._spinner,m=this._actionList,f=this._nls;this._updatePagingControls();
this._updatePagingInfo();d?b.remove(m,"hidden"):b.add(m,"hidden");c&&c.length?a?b.remove(g,"hidden"):this.setContent("\x3cdiv style\x3d'text-align: center;'\x3e"+f.NLS_searching+"...\x3c/div\x3e"):b.add(g,"hidden");d||c&&c.length?this._delayHide=!1:(this.setContent("\x3cdiv style\x3d'text-align: center;'\x3e"+f.NLS_noInfo+".\x3c/div\x3e"),this.visibleWhenEmpty||this._waitAndHide(this.hideDelay))}}})})},"dojo/window":function(){define("./_base/lang ./sniff ./_base/window ./dom ./dom-geometry ./dom-style ./dom-construct".split(" "),
function(k,e,p,q,n,l,h){e.add("rtl-adjust-position-for-verticalScrollBar",function(d,c){d=p.body(c);c=h.create("div",{style:{overflow:"scroll",overflowX:"visible",direction:"rtl",visibility:"hidden",position:"absolute",left:"0",top:"0",width:"64px",height:"64px"}},d,"last");var a=h.create("div",{style:{overflow:"hidden",direction:"ltr"}},c,"last"),b=0!=n.position(a).x;c.removeChild(a);d.removeChild(c);return b});e.add("position-fixed-support",function(d,c){d=p.body(c);c=h.create("span",{style:{visibility:"hidden",
position:"fixed",left:"1px",top:"1px"}},d,"last");var a=h.create("span",{style:{position:"fixed",left:"0",top:"0"}},c,"last"),b=n.position(a).x!=n.position(c).x;c.removeChild(a);d.removeChild(c);return b});var f={getBox:function(d){d=d||p.doc;var c="BackCompat"==d.compatMode?p.body(d):d.documentElement,a=n.docScroll(d);if(e("touch")){var b=f.get(d);d=b.innerWidth||c.clientWidth;c=b.innerHeight||c.clientHeight}else d=c.clientWidth,c=c.clientHeight;return{l:a.x,t:a.y,w:d,h:c}},get:function(d){if(e("ie")&&
f!==document.parentWindow){d.parentWindow.execScript("document._parentWindow \x3d window;","Javascript");var c=d._parentWindow;d._parentWindow=null;return c}return d.parentWindow||d.defaultView},scrollIntoView:function(d,c){try{d=q.byId(d);var a=d.ownerDocument||p.doc,b=p.body(a),g=a.documentElement||b.parentNode,f=e("ie")||e("trident"),m=e("webkit");if(d!=b&&d!=g)if(!(e("mozilla")||f||m||e("opera")||e("trident")||e("edge"))&&"scrollIntoView"in d)d.scrollIntoView(!1);else{var r="BackCompat"==a.compatMode,
t=Math.min(b.clientWidth||g.clientWidth,g.clientWidth||b.clientWidth),h=Math.min(b.clientHeight||g.clientHeight,g.clientHeight||b.clientHeight),a=m||r?b:g,k=c||n.position(d),w=d.parentNode;c=function(a){return 6>=f||7==f&&r?!1:e("position-fixed-support")&&"fixed"==l.get(a,"position").toLowerCase()};var z=this,m=function(a,b,c){"BODY"==a.tagName||"HTML"==a.tagName?z.get(a.ownerDocument).scrollBy(b,c):(b&&(a.scrollLeft+=b),c&&(a.scrollTop+=c))};if(!c(d))for(;w;){w==b&&(w=a);var x=n.position(w),A=c(w),
C="rtl"==l.getComputedStyle(w).direction.toLowerCase();if(w==a)x.w=t,x.h=h,a==g&&(f||e("trident"))&&C&&(x.x+=a.offsetWidth-x.w),x.x=0,x.y=0;else{var B=n.getPadBorderExtents(w);x.w-=B.w;x.h-=B.h;x.x+=B.l;x.y+=B.t;var E=w.clientWidth,D=x.w-E;0<E&&0<D&&(C&&e("rtl-adjust-position-for-verticalScrollBar")&&(x.x+=D),x.w=E);E=w.clientHeight;D=x.h-E;0<E&&0<D&&(x.h=E)}A&&(0>x.y&&(x.h+=x.y,x.y=0),0>x.x&&(x.w+=x.x,x.x=0),x.y+x.h>h&&(x.h=h-x.y),x.x+x.w>t&&(x.w=t-x.x));var F=k.x-x.x,I=k.y-x.y,M=F+k.w-x.w,L=I+k.h-
x.h,J,P;0<M*F&&(w.scrollLeft||w==a||w.scrollWidth>w.offsetHeight)&&(J=Math[0>F?"max":"min"](F,M),C&&(8==f&&!r||5<=e("trident"))&&(J=-J),P=w.scrollLeft,m(w,J,0),J=w.scrollLeft-P,k.x-=J);0<L*I&&(w.scrollTop||w==a||w.scrollHeight>w.offsetHeight)&&(J=Math.ceil(Math[0>I?"max":"min"](I,L)),P=w.scrollTop,m(w,0,J),J=w.scrollTop-P,k.y-=J);w=w!=a&&!A&&w.parentNode}}}catch(K){console.error("scrollIntoView: "+K),d.scrollIntoView(!1)}}};k.setObject("dojo.window",f);return f})},"dojo/Stateful":function(){define(["./_base/declare",
"./_base/lang","./_base/array","./when"],function(k,e,p,q){return k("dojo.Stateful",null,{_attrPairNames:{},_getAttrNames:function(n){var l=this._attrPairNames;return l[n]?l[n]:l[n]={s:"_"+n+"Setter",g:"_"+n+"Getter"}},postscript:function(n){n&&this.set(n)},_get:function(n,l){return"function"===typeof this[l.g]?this[l.g]():this[n]},get:function(n){return this._get(n,this._getAttrNames(n))},set:function(n,l){if("object"===typeof n){for(var h in n)n.hasOwnProperty(h)&&"_watchCallbacks"!=h&&this.set(h,
n[h]);return this}h=this._getAttrNames(n);var f=this._get(n,h);h=this[h.s];var d;"function"===typeof h?d=h.apply(this,Array.prototype.slice.call(arguments,1)):this[n]=l;if(this._watchCallbacks){var c=this;q(d,function(){c._watchCallbacks(n,f,l)})}return this},_changeAttrValue:function(n,l){var h=this.get(n);this[n]=l;this._watchCallbacks&&this._watchCallbacks(n,h,l);return this},watch:function(n,l){var h=this._watchCallbacks;if(!h)var f=this,h=this._watchCallbacks=function(c,a,b,d){var g=function(d){if(d){d=
d.slice();for(var g=0,m=d.length;g<m;g++)d[g].call(f,c,a,b)}};g(h["_"+c]);d||g(h["*"])};l||"function"!==typeof n?n="_"+n:(l=n,n="*");var d=h[n];"object"!==typeof d&&(d=h[n]=[]);d.push(l);n={};n.unwatch=n.remove=function(){var c=p.indexOf(d,l);-1<c&&d.splice(c,1)};return n}})})},"esri/geometry/normalizeUtils":function(){define("dojo/_base/array dojo/_base/lang dojo/_base/Deferred dojo/has ../kernel ../config ../deferredUtils ./Extent ./Polyline ./Polygon ./webMercatorUtils ./jsonUtils".split(" "),
function(k,e,p,q,n,l,h,f,d,c,a,b){function g(a,b){return Math.ceil((a-b)/(2*b))}function u(a,b){var c=a.paths||a.rings,d,g,m=c.length,f;for(d=0;d<m;d++)for(f=c[d].length,g=0;g<f;g++){var r=a.getPoint(d,g);a.setPoint(d,g,r.offset(b,0))}return a}function m(a,b){if(!(a instanceof d||a instanceof c))throw console.error("_straightLineDensify: the input geometry is neither polyline nor polygon"),Error("_straightLineDensify: the input geometry is neither polyline nor polygon");var g=a instanceof d,m=[],
f;k.forEach(g?a.paths:a.rings,function(a){m.push(f=[]);f.push([a[0][0],a[0][1]]);var c,d,g,r,t,h,v,u,l,w,n,e;for(t=0;t<a.length-1;t++){c=a[t][0];d=a[t][1];g=a[t+1][0];r=a[t+1][1];v=Math.sqrt((g-c)*(g-c)+(r-d)*(r-d));u=(r-d)/v;l=(g-c)/v;w=v/b;if(1<w){for(h=1;h<=w-1;h++)e=h*b,n=l*e+c,e=u*e+d,f.push([n,e]);h=(v+Math.floor(w-1)*b)/2;n=l*h+c;e=u*h+d;f.push([n,e])}f.push([g,r])}});return g?new d({paths:m,spatialReference:a.spatialReference}):new c({rings:m,spatialReference:a.spatialReference})}function r(b,
c,d){c&&(b=m(b,1E6),b=a.webMercatorToGeographic(b,!0));d&&(b=u(b,d));return b}function t(a,b,c){var d=a.x||a[0],m;d>b?(m=g(d,b),a.x?a=a.offset(-2*m*b,0):a[0]=d+-2*m*b):d<c&&(m=g(d,c),a.x?a=a.offset(-2*m*c,0):a[0]=d+-2*m*c);return a}function v(a,b){var c=-1;k.forEach(b.cutIndexes,function(d,m){var f=b.geometries[m];k.forEach(f.rings||f.paths,function(a,b){k.some(a,function(c){if(!(180>c[0])){c=0;var d,m=a.length,r;for(d=0;d<m;d++)r=a[d][0],c=r>c?r:c;c=Number(c.toFixed(9));c=-360*g(c,180);m=a.length;
for(d=0;d<m;d++)r=f.getPoint(b,d),f.setPoint(b,d,r.offset(c,0))}return!0})});d===c?f.rings?k.forEach(f.rings,function(b){a[d]=a[d].addRing(b)}):k.forEach(f.paths,function(b){a[d]=a[d].addPath(b)}):(c=d,a[d]=f)});return a}function y(m,f,h,w){var n=new p;n.addCallbacks(h,w);f=f||l.defaults.geometryService;var e=[],z=[],y,x,q,B,C,A,D,E,N=0;k.forEach(m,function(a){if(a)if(y||(y=a.spatialReference,x=y._getInfo(),B=(q=y._isWebMercator())?2.0037508342788905E7:180,C=q?-2.0037508342788905E7:-180,A=q?102100:
4326,D=new d({paths:[[[B,C],[B,B]]],spatialReference:{wkid:A}}),E=new d({paths:[[[C,C],[C,B]]],spatialReference:{wkid:A}})),x){var m=b.fromJson(a.toJson()),f=a.getExtent();"point"===a.type?e.push(t(m,B,C)):"multipoint"===a.type?(m.points=k.map(m.points,function(a){return t(a,B,C)}),e.push(m)):"extent"===a.type?(m=f._normalize(null,null,x),e.push(m.rings?new c(m):m)):f?(a=2*g(f.xmin,C)*B,m=0===a?m:u(m,a),f=f.offset(a,0),f.intersects(D)&&f.xmax!==B?(N=f.xmax>N?f.xmax:N,m=r(m,q),z.push(m),e.push("cut")):
f.intersects(E)&&f.xmin!==C?(N=2*f.xmax*B>N?2*f.xmax*B:N,m=r(m,q,360),z.push(m),e.push("cut")):e.push(m)):e.push(m)}else e.push(a);else e.push(a)});h=new d;w=g(N,B);for(var W=-90,ca=w;0<w;){var ha=-180+360*w;h.addPath([[ha,W],[ha,-1*W]]);W*=-1;w--}0<z.length&&0<ca?f?f.cut(z,h,function(b){z=v(z,b);var c=[];k.forEach(e,function(b,d){"cut"===b&&(b=z.shift(),m[d].rings&&1<m[d].rings.length&&b.rings.length>=m[d].rings.length?(e[d]="simplify",c.push(b)):e[d]=!0===q?a.geographicToWebMercator(b):b)});0<c.length?
f.simplify(c,function(b){k.forEach(e,function(c,d){"simplify"===c&&(e[d]=!0===q?a.geographicToWebMercator(b.shift()):b.shift())});n.callback(e)},function(a){n.errback(a)}):n.callback(e)},function(a){n.errback(a)}):n.errback(Error("esri.geometry.normalizeCentralMeridian: 'geometryService' argument is missing.")):(k.forEach(e,function(b,c){"cut"===b&&(b=z.shift(),e[c]=!0===q?a.geographicToWebMercator(b):b)}),n.callback(e));return n}function w(a,b,c,d){var g=!1,m;e.isObject(a)&&a&&(e.isArray(a)?a.length&&
((m=a[0]&&a[0].declaredClass)&&-1!==m.indexOf("Graphic")?(a=k.map(a,function(a){return a.geometry}),g=a.length?!0:!1):m&&-1!==m.indexOf("esri.geometry.")&&(g=!0)):(m=a.declaredClass)&&-1!==m.indexOf("FeatureSet")?(a=k.map(a.features||[],function(a){return a.geometry}),g=a.length?!0:!1):m&&-1!==m.indexOf("esri.geometry.")&&(g=!0));g&&b.push({index:c,property:d,value:a})}function z(a,b){var c=[];k.forEach(b,function(b){var d=b.i,g=a[d];b=b.p;var m;if(e.isObject(g)&&g)if(b)if("*"===b[0])for(m in g)g.hasOwnProperty(m)&&
w(g[m],c,d,m);else k.forEach(b,function(a){w(e.getObject(a,!1,g),c,d,a)});else w(g,c,d)});return c}function x(a,b){var c=0,d={};k.forEach(b,function(b){var g=b.index,m=b.property,f=b.value,r=f.length||1,t=a.slice(c,c+r);e.isArray(f)||(t=t[0]);c+=r;delete b.value;m?(d[g]=d[g]||{},d[g][m]=t):d[g]=t});return d}function A(a){for(var b=[],c=0,d=0,g=Math.min,m=Math.max,f=0;f<a.length;f++){for(var r=a[f],t=null,h=0;h<r.length;h++)t=r[h],b.push(t),0===h?d=c=t[0]:(c=g(c,t[0]),d=m(d,t[0]));t&&b.push([(c+d)/
2,0])}return b}return{normalizeCentralMeridian:y,_foldCutResults:v,_prepareGeometryForCut:r,_offsetMagnitude:g,_pointNormalization:t,_updatePolyGeometry:u,_straightLineDensify:m,_createWrappers:function(a){var b=e.isObject(a)?a.prototype:e.getObject(a+".prototype");k.forEach(b.__msigns,function(a){var c=b[a.n];b[a.n]=function(){var b=this,d=[],g,m=new p(h._dfdCanceller);a.f&&h._fixDfd(m);for(g=0;g<a.c;g++)d[g]=arguments[g];var f={dfd:m};d.push(f);var r,t=[],v;b.normalization&&!b._isTable&&(r=z(d,
a.a),k.forEach(r,function(a){t=t.concat(a.value)}),t.length&&(v=y(t)));v?(m._pendingDfd=v,v.addCallbacks(function(a){m.canceled||(f.assembly=x(a,r),m._pendingDfd=c.apply(b,d))},function(c){var g=b.declaredClass;g&&-1!==g.indexOf("FeatureLayer")?b._resolve([c],null,d[a.e],m,!0):b._errorHandler(c,d[a.e],m)})):m._pendingDfd=c.apply(b,d);return m}})},_disassemble:z,_addToBucket:w,_reassemble:x,getDenormalizedExtent:function(a){if(!a)return null;var b=a.getExtent();if(!b)return null;var c=a.spatialReference&&
a.spatialReference._getInfo();if(!c)return b;var d=c.valid[0],c=c.valid[1],g=2*c,m=b.getWidth(),r=b.xmax,t=b.xmin;if("extent"===a.type||0===m||m<=c||m>g||r<d||t>c)return b;var h;switch(a.type){case "polygon":if(1<a.rings.length)h=A(a.rings);else return b;break;case "polyline":if(1<a.paths.length)h=A(a.paths);else return b;break;case "multipoint":h=a.points}a=Math.min;for(var d=Math.max,g=new f(b.toJson()),v=0;v<h.length;v++){var u=h[v][0];0>u?(u+=c,t=d(u,t)):(u-=c,r=a(u,r))}g.xmin=r;g.xmax=t;return g.getWidth()<
m?(g.xmin-=c,g.xmax-=c,g):b}}})},"esri/geometry/jsonUtils":function(){define("dojo/_base/lang dojo/has ../kernel ./Point ./Polyline ./Polygon ./Multipoint ./Extent".split(" "),function(k,e,p,q,n,l,h,f){return{fromJson:function(d){if(void 0!==d.x&&void 0!==d.y)return new q(d);if(void 0!==d.paths)return new n(d);if(void 0!==d.rings)return new l(d);if(void 0!==d.points)return new h(d);if(void 0!==d.xmin&&void 0!==d.ymin&&void 0!==d.xmax&&void 0!==d.ymax)return new f(d)},getJsonType:function(d){return d instanceof
q?"esriGeometryPoint":d instanceof n?"esriGeometryPolyline":d instanceof l?"esriGeometryPolygon":d instanceof f?"esriGeometryEnvelope":d instanceof h?"esriGeometryMultipoint":null},getGeometryType:function(d){return"esriGeometryPoint"===d?q:"esriGeometryPolyline"===d?n:"esriGeometryPolygon"===d?l:"esriGeometryEnvelope"===d?f:"esriGeometryMultipoint"===d?h:null}}})},"esri/InfoWindowBase":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/_base/Deferred dojo/dom-construct dojo/has dijit/registry ./kernel ./lang ./geometry/ScreenPoint".split(" "),
function(k,e,p,q,n,l,h,f,d,c,a){return k(null,{declaredClass:"esri.InfoWindowBase",constructor:function(){var a=e.hitch;this.__set_title=a(this,this.__set_title);this.__err_title=a(this,this.__err_title);this.__set_content=a(this,this.__set_content);this.__err_content=a(this,this.__err_content)},setMap:function(a){this.map=a},unsetMap:function(a){delete this.map},setTitle:function(){},setContent:function(){},show:function(){},hide:function(){},resize:function(){},onShow:function(){},onHide:function(){},
place:function(a,d){c.isDefined(a)?e.isObject(a)?l.place(a,d,"only"):d.innerHTML=a:d.innerHTML=""},startupDijits:function(a){this._processDijits(a)},destroyDijits:function(a){this._processDijits(a,!0)},getDijits:function(a){var b=[];a&&1===a.children.length&&(a=a.children[0])&&(b=(b=f.byNode(a))?[b]:f.findWidgets(a));return b},_processDijits:function(a,c){a=this.getDijits(a);p.forEach(a,function(a){if(c){if(a._started&&!a._destroyed)try{a.destroyRecursive?a.destroyRecursive():a.destroy&&a.destroy()}catch(m){console.debug("An error occurred when destroying a widget embedded within InfoWindow: "+
m.message)}}else if(!a._started)try{a.startup()}catch(m){console.debug("An error occurred when starting a widget embedded within InfoWindow: "+m.message)}})},__registerMapListeners:function(){this.__unregisterMapListeners();var a=this.map;this.__handles=[q.connect(a,"onPan",this,this.__onMapPan),q.connect(a,"onZoomStart",this,this.__onMapZmStart),q.connect(a,"onExtentChange",this,this.__onMapExtChg)]},__unregisterMapListeners:function(){var a=this.__handles;a&&(p.forEach(a,q.disconnect,q),this.__handles=
null)},__onMapPan:function(a,c){this.move(c,!0)},__onMapZmStart:function(){this.__mcoords=this.mapCoords||this.map.toMap(new a(this.coords));this.hide(null,!0)},__onMapExtChg:function(a,c,d){a=this.map;var b=this.mapCoords;b?this.show(b,null,!0):(c=d?a.toScreen(this.__mcoords):this.coords.offset(c&&c.x||0,c&&c.y||0),this.show(c,null,!0))},__setValue:function(a,d){this[a].innerHTML="";var b="_dfd"+a,g=this[b];g&&-1===g.fired&&(g.cancel(),this[b]=null);c.isDefined(d)&&(d instanceof n?(this[b]=d,d.addCallbacks(this["__set"+
a],this["__err"+a])):this.__render(a,d))},__set_title:function(a){this._dfd_title=null;this.__render("_title",a)},__err_title:function(a){this._dfd_title=null},__set_content:function(a){this._dfd_content=null;this.__render("_content",a)},__err_content:function(a){this._dfd_content=null},__render:function(a,c){var b=this[a];this.place(c,b);this.isShowing&&(this.startupDijits(b),"_title"===a&&this._adjustContentArea&&this._adjustContentArea())}})})},"esri/PopupBase":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/Color dojo/_base/Deferred dojo/has ./kernel ./graphic ./geometry/Point ./geometry/jsonUtils ./geometry/mathUtils ./geometry/webMercatorUtils ./symbols/SimpleMarkerSymbol ./symbols/SimpleLineSymbol ./symbols/CartographicLineSymbol ./symbols/SimpleFillSymbol ./tasks/query ./Evented require".split(" "),
function(k,e,p,q,n,l,h,f,d,c,a,b,g,u,m,r,t,v){function y(a){return"sizeInfo"===a.type}return k(v,{declaredClass:"esri.PopupBase",_featureLayers:{},_updateEndHandles:[],_evtMap:{"set-features":!0,"clear-features":!0,"selection-change":!0,"dfd-complete":!0},onSetFeatures:function(){},onClearFeatures:function(){},onSelectionChange:function(){},onDfdComplete:function(){},initialize:function(){this.count=0;this.selectedIndex=-1;this.on("clear-features",e.hitch(this,this._resetUpdateEndListeners));this.on("dfd-complete",
e.hitch(this,this._processFeatures));this.on("set-features",e.hitch(this,this._processFeatures))},cleanup:function(){this.features=this.deferreds=null;this._resetUpdateEndListeners()},setFeatures:function(a){if(a&&a.length){this.clearFeatures(!0);var b,c;a[0]instanceof n?c=a:b=a;b?this._updateFeatures(null,b):(this.deferreds=c,c=c.slice(0),p.forEach(c,function(a){a.addBoth(e.hitch(this,this._updateFeatures,a))},this))}},clearFeatures:function(a){this.features=this.deferreds=this._marked=null;this.count=
0;var b=this.selectedIndex;this.selectedIndex=-1;if(-1<b)this.onSelectionChange();this.onClearFeatures({isIntermediate:!!a})},getSelectedFeature:function(){var a=this.features;if(a)return a[this.selectedIndex]},select:function(a){0>a||a>=this.count||(this.selectedIndex=a,this.onSelectionChange())},enableHighlight:function(a){this._highlighted=a.graphics.add(new f(new d(0,0,a.spatialReference)));this._highlighted.attr("data-popup-highlight","");this._highlighted.hide();this.markerSymbol||(a=this.markerSymbol=
new g,a.setStyle(g.STYLE_TARGET),a._setDim(16,16,0),a.setOutline(new m(u.STYLE_SOLID,new q([0,255,255]),2,m.CAP_ROUND,m.JOIN_ROUND)),a.setColor(new q([0,0,0,0])));this.lineSymbol||(this.lineSymbol=new u(u.STYLE_SOLID,new q([0,255,255]),2));this.fillSymbol||(this.fillSymbol=new r(r.STYLE_NULL,new u(u.STYLE_SOLID,new q([0,255,255]),2),new q([0,0,0,0])));this.clusterFillSymbol||(this.clusterFillSymbol=new r(r.STYLE_SOLID,new u(u.STYLE_SOLID,new q([0,255,255]),1.33),null))},disableHighlight:function(a){var b=
this._highlighted;b&&(b.hide(),a.graphics.remove(b),delete this._highlighted);this.markerSymbol=this.lineSymbol=this.fillSymbol=null},showHighlight:function(){var a=this.features&&this.features[this.selectedIndex];this._highlighted&&a&&a.geometry&&this._highlighted.show()},hideHighlight:function(){this._highlighted&&this._highlighted.hide()},updateHighlight:function(a,b){var d=b.geometry,g=this._highlighted;if(d&&g){g.hide();!g._graphicsLayer&&a&&a.graphics.add(g);g.setGeometry(c.fromJson(d.toJson()));
var m;switch(d.type){case "point":case "multipoint":var f=b.getLayer(),d=b.symbol||f&&f._getSymbol(b);if(f&&d){var r,t,h=0,v=0,u=0;m=b.symbol?null:f._getRenderer(b);if(f=this._getSizeInfo(m))r=t=m.getSize(b,{sizeInfo:f,shape:d.style,resolution:a&&a.getResolutionInMeters&&a.getResolutionInMeters()});else if(null!=b.size)r=t=b.size;else switch(d.type){case "simplemarkersymbol":r=t=d.size||0;break;case "picturemarkersymbol":r=d.width||0,t=d.height||0}h=d.xoffset||0;v=d.yoffset||0;u=d.angle||0;m=this.markerSymbol;
m.setOffset(0,0);m.setAngle(0);r&&t&&m._setDim(r+4,t+4,0);m.setOffset(h,v);m.setAngle(u)}break;case "polyline":m=this.lineSymbol;break;case "polygon":m=this.fillSymbol}g.setSymbol(m)}else g&&g.hide()},showClosestFirst:function(c){var d=this.features;if(d&&d.length){if(1<d.length){var g,m=Infinity,f=-1,r,t=a.getLength,h,v=c.spatialReference,u,l;c=c.normalize();for(g=d.length-1;0<=g;g--)if(r=d[g].geometry){u=r.spatialReference;h=0;try{l="point"===r.type?r:r.getExtent().getCenter(),l=l.normalize(),v&&
u&&!v.equals(u)&&v._canProject(u)&&(l=v.isWebMercator()?b.geographicToWebMercator(l):b.webMercatorToGeographic(l)),h=t(c,l)}catch(L){}0<h&&h<m&&(m=h,f=g)}0<f&&(d.splice(0,0,d.splice(f,1)[0]),this.select(0))}}else this.deferreds&&(this._marked=c)},_unbind:function(a){a=p.indexOf(this.deferreds,a);if(-1!==a)return this.deferreds.splice(a,1),this.deferreds.length?1:(this.deferreds=null,2)},_fireComplete:function(a){var b=this._marked;b&&(this._marked=null,this.showClosestFirst(b));this.onDfdComplete(a)},
_updateFeatures:function(a,b){if(a){if(this.deferreds&&(a=this._unbind(a)))if(b&&b instanceof Error){if(this._fireComplete(b),2===a)this.onSetFeatures()}else if(b&&b.length)if(this.features){if(b=p.filter(b,function(a){return-1===p.indexOf(this.features,a)},this),this.features=this.features.concat(b),this.count=this.features.length,this._fireComplete(),2===a)this.onSetFeatures()}else{this.features=b;this.count=b.length;this.selectedIndex=0;this._fireComplete();if(2===a)this.onSetFeatures();this.select(0)}else if(this._fireComplete(),
2===a)this.onSetFeatures()}else this.features=b,this.count=b.length,this.selectedIndex=0,this.onSetFeatures(),this.select(0)},_getSizeInfo:function(a){return a?a.sizeInfo||p.filter(a.visualVariables,y)[0]:null},_resetUpdateEndListeners:function(){this._featureLayers={};p.forEach(this._updateEndHandles,function(a){a.remove()});this._updateEndHandles=[]},_processFeatures:function(){p.forEach(this.features,function(a){(a=a.getLayer())&&!this._featureLayers[a.id]&&(1===a.currentMode||0===a.currentMode&&
6===a.mode)&&a.objectIdField&&a.hasXYFootprint&&a.queryFeatures&&("esriGeometryPolygon"===a.geometryType||"esriGeometryPolyline"===a.geometryType||a.hasXYFootprint())&&(this._featureLayers[a.id]=a,a=a.on("update-end",e.hitch(this,this._fLyrUpdateEndHandler)),this._updateEndHandles.push(a))},this)},_fLyrUpdateEndHandler:function(a){if(!a.error){var b=this,c=a.target,d=c.getSelectedFeatures(),g=0===c.currentMode&&6===c.mode,m={},f=[];p.forEach(this.features,function(a){if(a.getLayer()===c){var b=a.attributes[c.objectIdField];
m[b]=a;f.push(b)}});f.length&&(a=new t,a.objectIds=f,c.queryFeatures(a,function(a){p.forEach(a.features,function(a){var b=m[a.attributes[c.objectIdField]],f=!1;b.geometry!==a.geometry?(b.setGeometry(a.geometry),f=!0):g&&d&&-1!==p.indexOf(d,a)&&(f=!0);f&&this._highlighted&&b===this.getSelectedFeature()&&this._highlighted.setGeometry(a.geometry)},b)}))}}})})},"esri/graphic":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ./kernel ./domUtils ./lang ./InfoTemplate ./geometry/jsonUtils ./symbols/jsonUtils".split(" "),
function(k,e,p,q,n,l,h,f,d){k=k(null,{declaredClass:"esri.Graphic",constructor:function(c,a,b,g){this._geomVersion=0;c&&!c.declaredClass?(this.geometry=c.geometry?f.fromJson(c.geometry):null,this.symbol=c.symbol?d.fromJson(c.symbol):null,this.attributes=c.attributes||null,this.infoTemplate=c.infoTemplate?new h(c.infoTemplate):null):(this.geometry=c,this.symbol=a,this.attributes=b,this.infoTemplate=g)},_geomVersion:null,_shape:null,_dataAttrs:null,_graphicsLayer:null,_suspended:!1,size:null,_visible:!0,
visible:!0,_aggregationSourceLayer:null,_aggregationInfo:null,setSize:function(c){this.size=c},getAggregationSourceLayer:function(){return this._aggregationSourceLayer},setAggregationSourceLayer:function(c){this._aggregationSourceLayer=c},isAggregate:function(){return!!this._aggregationInfo},getAggregationInfo:function(){return this._aggregationInfo},setAggregationInfo:function(c){this._aggregationInfo=c},getChildGraphics:function(){var c=this.getAggregationSourceLayer();return c?c.getChildGraphics(this):
[]},getDojoShape:function(){return this._shape},getShapes:function(){var c=[];this._shape&&c.push(this._shape);this._bgShape&&c.push(this._bgShape);return c},getNode:function(){var c=this._shape&&this._shape.getNode();return c&&c.nodeType?c:null},getNodes:function(){var c=this.getShapes(),a,b,d=c.length,f=[];for(b=0;b<d;b++)(a=c[b]&&c[b].getNode())&&a.nodeType&&f.push(a);return f},getLayer:function(){return this._layer},getSourceLayer:function(){return this._sourceLayer||this._layer},clone:function(){var c=
new this.constructor(this.toJson());c.visible=this.visible;c._visible=this._visible;c._layer=this._layer;c._sourceLayer=this._sourceLayer;c._aggregationSourceLayer=this._aggregationSourceLayer;c._aggregationInfo=this._aggregationInfo;return c},draw:function(){var c=this._graphicsLayer;c&&c._draw(this,!0);return this},setGeometry:function(c){this.geometry=c;this._geomVersion++;var a=this._graphicsLayer;a&&(a._updateExtent(this),a._draw(this,!0),c&&"polyline"===c.type&&a._updateSVGMarkers());return this},
setSymbol:function(c,a){var b=this._graphicsLayer,d=this._shape;this.symbol=c;b&&(a&&d&&b._removeShape(this),b._draw(this,!0));return this},setAttributes:function(c){this.attributes=c;this._clearCache();return this},setInfoTemplate:function(c){this.infoTemplate=c;return this},getInfoTemplate:function(){return this._getEffInfoTemplate()},_getEffInfoTemplate:function(){var c=this.getLayer();return this.infoTemplate||c&&c.infoTemplate},getTitle:function(){var c=this.getInfoTemplate(),a=c&&c.title;if(e.isFunction(a))a=
a.call(c,this);else if(e.isString(a))var b=(c=this.getLayer())&&c._getDateOpts,a=l.substitute(this.attributes,a,{first:!0,dateFormat:b&&b.call(c)});return a},getContent:function(){var c=this.getInfoTemplate(),a=c&&c.content;if(e.isFunction(a))a=a.call(c,this);else if(e.isString(a))var b=(c=this.getLayer())&&c._getDateOpts,a=l.substitute(this.attributes,a,{dateFormat:b&&b.call(c)});return a},attr:function(c,a){null==a||this._dataAttrs||(this._dataAttrs={});this._dataAttrs&&(this._dataAttrs[c]=a,this._setDataAttr(c,
a));return this},show:function(){this.visible=this._visible=!0;this.attr("data-hidden");var c,a,b;if(this.getShapes().length)for(c=this.getNodes(),b=c.length,a=0;a<b;a++)n.show(c[a]);else this._graphicsLayer&&this._graphicsLayer._draw(this,!0);return this},hide:function(){this.visible=this._visible=!1;this.attr("data-hidden","");var c=this._graphicsLayer,a,b;if(c)if("canvas-2d"===c.surfaceType)c._removeShape(this);else if(c=this.getNodes(),b=c.length)for(a=0;a<b;a++)n.hide(c[a]);return this},toJson:function(){var c=
{};this.geometry&&(c.geometry=this.geometry.toJson());this.attributes&&(c.attributes=e.mixin({},this.attributes));this.symbol&&(c.symbol=this.symbol.toJson());this.infoTemplate&&(c.infoTemplate=this.infoTemplate.toJson());return c},_setDataAttr:function(c,a){var b=this.getNodes(),d,f=b.length;for(d=0;d<f;d++)this._setDOMDataAttr(b[d],c,a)},_setDOMDataAttr:function(c,a,b){null==b?c.removeAttribute(a):c.setAttribute(a,b)},_applyDataAttrs:function(){var c=this._dataAttrs;if(c){var a=this.getNodes(),
b,d=a.length;for(b=0;b<d;b++)for(var f in c)this._setDOMDataAttr(a[b],f,c[f])}},_getViewInfo:function(c){return(c=(c=c||this.getLayer())&&c.getMap())&&c._getViewInfo()},_getDataValue:function(c,a,b,d,f){var g=a.id,r=this.attributes,t=c.field,h=a.isNumeric,l=null;if(g){var u=this._computedAttributes,n=this._computedVersion,e=this._computedGeomVersion;d=this._getViewInfo(d);var k=a.dependsOnView||a.isJSFunc,p=a.dependsOnGeometry,q=p&&!!f;u||(u=this._computedAttributes={});k&&!n&&(n=this._computedVersion=
{});p&&!e&&(e=this._computedGeomVersion={});var E=k&&n[g]!==d._version||p&&e[g]!==this._geomVersion,l=u[g];if(void 0===l||E||q)l=null,a.hasExpr?(l=b.createExecContext(this,d),(c=l.vars.$feature)&&f&&(c.geometry=f),l=b.executeFunction(a.compiledFunc,l)):a.isJSFunc?l=t(this,c):r&&(l=r[t],h&&this._isValidNumber(l)&&(a=c.normalizationType||"field",b=l,l=null,f=c.normalizationTotal,c=r[c.normalizationField],"log"===a&&0!==b?l=Math.log(b)*Math.LOG10E:"percent-of-total"===a&&this._isValidNumber(f)&&0!==
f?l=b/f*100:"field"===a&&this._isValidNumber(c)&&0!==c&&(l=b/c))),l=this._sanitizeValue(l,h),q||(u[g]=l,k&&(n[g]=d._version),p&&(e[g]=this._geomVersion))}else r&&(l=this._sanitizeValue(r[t],h));return l},_sanitizeValue:function(c,a){a&&!this._isValidNumber(c)&&(c=null);return c},_isValidNumber:function(c){return"number"===typeof c&&!isNaN(c)&&Infinity!==c&&-Infinity!==c},_clearCache:function(){this._computedAttributes=this._computedVersion=this._computedGeomVersion=null}});k.prototype.getShape=k.prototype.getDojoShape;
return k})},"esri/InfoTemplate":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","./kernel","./lang"],function(k,e,p,q,n){return k(null,{declaredClass:"esri.InfoTemplate",constructor:function(l,h){l&&e.isObject(l)&&!e.isFunction(l)?e.mixin(this,l):(this.title=l||"${*}",this.content=h||"${*}")},setTitle:function(l){this.title=l;return this},setContent:function(l){this.content=l;return this},toJson:function(){return n.fixJson({title:this.title,content:this.content})}})})},"esri/symbols/jsonUtils":function(){define("dojo/_base/lang dojo/has ../kernel ./SimpleMarkerSymbol ./PictureMarkerSymbol ./SimpleLineSymbol ./CartographicLineSymbol ./SimpleFillSymbol ./PictureFillSymbol ./TextSymbol".split(" "),
function(k,e,p,q,n,l,h,f,d,c){return{fromJson:function(a){var b=null;switch(a.type){case "esriSMS":b=new q(a);break;case "esriPMS":b=new n(a);break;case "esriTS":b=new c(a);break;case "esriSLS":b=void 0!==a.cap?new h(a):new l(a);break;case "esriCLS":b=new h(a);break;case "esriSFS":b=new f(a);break;case "esriPFS":b=new d(a)}return b},getShapeDescriptors:function(a){return a&&a.getShapeDescriptors?a.getShapeDescriptors():{defaultShape:null,fill:null,stroke:null}}}})},"esri/symbols/PictureMarkerSymbol":function(){define("dojo/_base/declare dojo/_base/lang dojo/sniff dojox/gfx/_base ../kernel ../lang ../urlUtils ./MarkerSymbol".split(" "),
function(k,e,p,q,n,l,h,f){var d={url:"",width:12,height:12,angle:0,xoffset:0,yoffset:0};k=k(f,{declaredClass:"esri.symbol.PictureMarkerSymbol",type:"picturemarkersymbol",constructor:function(c,a,b){c?e.isString(c)?(this.url=c,a&&(this.width=a),b&&(this.height=b)):(this.width=q.pt2px(c.width),this.height=q.pt2px(c.height),a=c.imageData,9>p("ie")||!a||(b=this.url,this.url="data:"+(c.contentType||"image")+";base64,"+a,this.imageData=b)):(e.mixin(this,d),this.width=q.pt2px(this.width),this.height=q.pt2px(this.height))},
getStroke:function(){return null},getFill:function(){return null},setWidth:function(c){this.width=c;return this},setHeight:function(c){this.height=c;return this},setUrl:function(c){c!==this.url&&(delete this.imageData,delete this.contentType);this.url=c;return this},getShapeDescriptors:function(){return{defaultShape:{type:"image",x:-Math.round(this.width/2),y:-Math.round(this.height/2),width:this.width,height:this.height,src:this.url||""},fill:null,stroke:null}},toJson:function(){var c=this.url,a=
this.imageData;if(0===c.indexOf("data:"))var b=c,c=a,a=b.indexOf(";base64,")+8,a=b.substr(a);!e.isString(c)||0!==c.indexOf("/")&&0!==c.indexOf("//")&&0!==c.indexOf("./")&&0!==c.indexOf("../")||(c=h.getAbsoluteUrl(c));var b=q.px2pt(this.width),b=isNaN(b)?void 0:b,d=q.px2pt(this.height),d=isNaN(d)?void 0:d,c=l.fixJson(e.mixin(this.inherited("toJson",arguments),{type:"esriPMS",url:c,imageData:a,contentType:this.contentType,width:b,height:d}));delete c.color;delete c.size;c.imageData||delete c.imageData;
return c}});k.defaultProps=d;return k})},"esri/symbols/CartographicLineSymbol":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/Color dojo/has dojox/gfx/_base ../kernel ../lang ./SimpleLineSymbol".split(" "),function(k,e,p,q,n,l,h,f){var d={STYLE_SOLID:"solid",STYLE_DASH:"dash",STYLE_DOT:"dot",STYLE_DASHDOT:"dashdot",STYLE_DASHDOTDOT:"longdashdotdot",STYLE_NULL:"none",STYLE_INSIDE_FRAME:"insideframe",STYLE_SHORTDASH:"shortdash",STYLE_SHORTDOT:"shortdot",STYLE_SHORTDASHDOT:"shortdashdot",
STYLE_SHORTDASHDOTDOT:"shortdashdotdot",STYLE_LONGDASH:"longdash",STYLE_LONGDASHDOT:"longdashdot",CAP_BUTT:"butt",CAP_ROUND:"round",CAP_SQUARE:"square",JOIN_MITER:"miter",JOIN_ROUND:"round",JOIN_BEVEL:"bevel"},c={color:[0,0,0,1],style:d.STYLE_SOLID,width:1,cap:d.CAP_BUTT,join:d.JOIN_MITER,miterLimit:10};k=k(f,{declaredClass:"esri.symbol.CartographicLineSymbol",type:"cartographiclinesymbol",_caps:{butt:"esriLCSButt",round:"esriLCSRound",square:"esriLCSSquare"},_joins:{miter:"esriLJSMiter",round:"esriLJSRound",
bevel:"esriLJSBevel"},constructor:function(a,b,d,f,m,r){a?e.isString(a)?(this.style=a,b&&(this.color=b),void 0!==d&&(this.width=d),f&&(this.cap=f),m&&(this.join=m),void 0!==r&&(this.miterLimit=r)):(this.cap=h.valueOf(this._caps,a.cap),this.join=h.valueOf(this._joins,a.join),this.width=n.pt2px(a.width),this.miterLimit=n.pt2px(a.miterLimit)):(e.mixin(this,c),this.color=new p(this.color),this.width=n.pt2px(this.width),this.miterLimit=n.pt2px(this.miterLimit))},setCap:function(a){this.cap=a;return this},
setJoin:function(a){this.join=a;return this},setMiterLimit:function(a){this.miterLimit=a;return this},getStroke:function(){return e.mixin(this.inherited("getStroke",arguments),{cap:this.cap,join:this.join===d.JOIN_MITER?this.miterLimit:this.join})},getFill:function(){return null},getShapeDescriptors:function(){return{defaultShape:{type:"path",path:"M -15,0 L 15,0 E"},fill:null,stroke:this.getStroke()}},toJson:function(){var a=n.px2pt(this.miterLimit),a=isNaN(a)?void 0:a;return h.fixJson(e.mixin(this.inherited("toJson",
arguments),{type:"esriCLS",cap:this._caps[this.cap],join:this._joins[this.join],miterLimit:a}))}});e.mixin(k,d);k.defaultProps=c;return k})},"esri/symbols/SimpleFillSymbol":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/Color dojo/has dojox/gfx/_base ../kernel ../lang ./FillSymbol ./SimpleLineSymbol require".split(" "),function(k,e,p,q,n,l,h,f,d,c){var a={STYLE_SOLID:"solid",STYLE_NULL:"none",STYLE_HORIZONTAL:"horizontal",STYLE_VERTICAL:"vertical",STYLE_FORWARD_DIAGONAL:"forwarddiagonal",
STYLE_BACKWARD_DIAGONAL:"backwarddiagonal",STYLE_CROSS:"cross",STYLE_DIAGONAL_CROSS:"diagonalcross",STYLE_FORWARDDIAGONAL:"forwarddiagonal",STYLE_BACKWARDDIAGONAL:"backwarddiagonal",STYLE_DIAGONALCROSS:"diagonalcross"},b={style:a.STYLE_SOLID,color:[0,0,0,.25]};k=k(f,{declaredClass:"esri.symbol.SimpleFillSymbol",type:"simplefillsymbol",_styles:{solid:"esriSFSSolid",none:"esriSFSNull",horizontal:"esriSFSHorizontal",vertical:"esriSFSVertical",forwarddiagonal:"esriSFSForwardDiagonal",backwarddiagonal:"esriSFSBackwardDiagonal",
cross:"esriSFSCross",diagonalcross:"esriSFSDiagonalCross"},constructor:function(a,c,m){a?e.isString(a)?(this.style=a,void 0!==c&&(this.outline=c),void 0!==m&&(this.color=m)):this.style=h.valueOf(this._styles,a.style):(e.mixin(this,b),this.outline=new d(this.outline),this.color=new p(this.color))},setStyle:function(a){this.style=a;return this},getStroke:function(){return this.outline&&this.outline.getStroke()},getFill:function(){var b=this.style;return b===a.STYLE_NULL?null:b===a.STYLE_SOLID?this.color:
e.mixin({},n.defaultPattern,{src:c.toUrl("../images/symbol/sfs/"+b+".png"),width:10,height:10})},getShapeDescriptors:function(){return{defaultShape:{type:"path",path:"M -10,-10 L 10,0 L 10,10 L -10,10 L -10,-10 Z"},fill:this.getFill(),stroke:this.getStroke()}},toJson:function(){return h.fixJson(e.mixin(this.inherited("toJson",arguments),{type:"esriSFS",style:this._styles[this.style]}))}});e.mixin(k,a);k.defaultProps=b;return k})},"esri/symbols/FillSymbol":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ./Symbol ./SimpleLineSymbol".split(" "),
function(k,e,p,q,n,l){return k(n,{declaredClass:"esri.symbol.FillSymbol",constructor:function(h){h&&e.isObject(h)&&h.outline&&(this.outline=new l(h.outline))},setOutline:function(h){this.outline=h;return this},toJson:function(){var h=this.inherited("toJson",arguments);this.outline&&(h.outline=this.outline.toJson());return h}})})},"esri/symbols/PictureFillSymbol":function(){define("dojo/_base/declare dojo/_base/lang dojo/sniff dojox/gfx/_base ../kernel ../lang ../urlUtils ./FillSymbol".split(" "),
function(k,e,p,q,n,l,h,f){var d={xoffset:0,yoffset:0,width:12,height:12};k=k(f,{declaredClass:"esri.symbol.PictureFillSymbol",type:"picturefillsymbol",xscale:1,yscale:1,xoffset:0,yoffset:0,constructor:function(c,a,b,g){c?e.isString(c)?(this.url=c,void 0!==a&&(this.outline=a),void 0!==b&&(this.width=b),void 0!==g&&(this.height=g)):(this.xoffset=q.pt2px(c.xoffset),this.yoffset=q.pt2px(c.yoffset),this.width=q.pt2px(c.width),this.height=q.pt2px(c.height),a=c.imageData,9>p("ie")||!a||(b=this.url,this.url=
"data:"+(c.contentType||"image")+";base64,"+a,this.imageData=b)):(e.mixin(this,d),this.width=q.pt2px(this.width),this.height=q.pt2px(this.height))},setWidth:function(c){this.width=c;return this},setHeight:function(c){this.height=c;return this},setOffset:function(c,a){this.xoffset=c;this.yoffset=a;return this},setUrl:function(c){c!==this.url&&(delete this.imageData,delete this.contentType);this.url=c;return this},setXScale:function(c){this.xscale=c;return this},setYScale:function(c){this.yscale=c;
return this},getStroke:function(){return this.outline&&this.outline.getStroke()},getFill:function(){return e.mixin({},q.defaultPattern,{src:this.url,width:this.width*this.xscale,height:this.height*this.yscale,x:this.xoffset,y:this.yoffset})},getShapeDescriptors:function(){return{defaultShape:{type:"path",path:"M -10,-10 L 10,0 L 10,10 L -10,10 L -10,-10 Z"},fill:this.getFill(),stroke:this.getStroke()}},toJson:function(){var c=this.url,a=this.imageData;if(0===c.indexOf("data:"))var b=c,c=a,a=b.indexOf(";base64,")+
8,a=b.substr(a);!e.isString(c)||0!==c.indexOf("/")&&0!==c.indexOf("//")&&0!==c.indexOf("./")&&0!==c.indexOf("../")||(c=h.getAbsoluteUrl(c));var b=q.px2pt(this.width),b=isNaN(b)?void 0:b,d=q.px2pt(this.height),d=isNaN(d)?void 0:d,f=q.px2pt(this.xoffset),f=isNaN(f)?void 0:f,m=q.px2pt(this.yoffset),m=isNaN(m)?void 0:m,c=l.fixJson(e.mixin(this.inherited("toJson",arguments),{type:"esriPFS",url:c,imageData:a,contentType:this.contentType,width:b,height:d,xoffset:f,yoffset:m,xscale:this.xscale,yscale:this.yscale}));
c.imageData||delete c.imageData;return c}});k.defaultProps=d;return k})},"esri/symbols/TextSymbol":function(){define("dojo/_base/declare dojo/_base/lang dojo/has dojox/gfx/_base ../kernel ../lang ../Color ./Symbol ./Font".split(" "),function(k,e,p,q,n,l,h,f,d){var c={type:"textsymbol",x:0,y:0,text:"",rotated:!1,kerning:!0,color:[0,0,0,1],font:q.defaultFont,angle:0,xoffset:0,yoffset:0,horizontalAlignment:"center"},a={start:"left",middle:"center",end:"right"},b={left:"start",center:"middle",right:"end",
justify:"start"},g={top:"text-before-edge",middle:"central",baseline:"alphabetic",bottom:"text-after-edge"},u=document.createElement("canvas");k=k(f,{declaredClass:"esri.symbol.TextSymbol",angle:0,xoffset:0,yoffset:0,constructor:function(a,b,g){e.mixin(this,c);this.font=new d(this.font);this.color=new h(this.color);a&&(e.isObject(a)?(e.mixin(this,a),this.color&&l.isDefined(this.color[0])&&(this.color=h.toDojoColor(this.color)),this.type="textsymbol",this.font=new d(this.font),this.xoffset=q.pt2px(this.xoffset),
this.yoffset=q.pt2px(this.yoffset),this.angle&&(this.angle*=-1),this.haloSize&&(this.haloSize=q.pt2px(this.haloSize)),this.haloColor&&(this.haloColor=h.toDojoColor(this.haloColor))):(this.text=a,b&&(this.font=b),g&&(this.color=g)));this.setAlign(this.align||this.getSVGAlign())},setFont:function(a){this.font=a;return this},setSize:function(a){this.font.size=a;return this},setAngle:function(a){this.angle=a;return this},setOffset:function(a,b){this.xoffset=a;this.yoffset=b;return this},setHaloColor:function(a){this.haloColor=
a;return this},setHaloSize:function(a){this.haloSize=a;return this},setAlign:function(b){this.align=b;this.setHorizontalAlignment(b&&a[b.toLowerCase()]||"center");return this},setHorizontalAlignment:function(a){this.horizontalAlignment=a;return this},getSVGAlign:function(){var a=this.horizontalAlignment;return a=a&&b[a.toLowerCase()]||"middle"},setVerticalAlignment:function(a){this.verticalAlignment=a;return this},getSVGBaseline:function(){var a=this.verticalAlignment;return a&&g[a.toLowerCase()]||
"alphabetic"},getSVGBaselineShift:function(){return"bottom"===this.verticalAlignment?"super":null},setDecoration:function(a){this.decoration=a;this.font||this.setFont(new d);this.font.setDecoration(a);return this},setRotated:function(a){this.rotated=a;return this},setKerning:function(a){this.kerning=a;return this},setText:function(a){this.text=a;return this},getStroke:function(){return null},getFill:function(){return this.color},getWidth:function(){var a=u&&u.getContext&&u.getContext("2d");if(a){var b=
this.font;a.font=(b.style?b.style:q.defaultFont.style)+" "+(b.weight?b.weight:q.defaultFont.weight)+" "+(b.size?b.size:q.defaultFont.size)+"px "+(b.family?b.family:q.defaultFont.family);return a.measureText(this.text).width}var a=this.getHeight(),b=0,c,d;for(c=0;c<this.text.length;c++)d=this.text.charAt(c),b=d==d.toUpperCase()?b+.7*a:b+.5*a;return b},getHeight:function(){return q.normalizedLength(this.font.size)},getShapeDescriptors:function(){var a=this.font,b;a&&(b={},a.size&&(b.size=a.size),a.style&&
(b.style=a.style),a.variant&&(b.variant=a.variant),a.decoration&&(b.decoration=a.decoration),a.weight&&(b.weight=a.weight),a.family&&(b.family=a.family));return{defaultShape:{type:"text",text:this.text,x:0,y:this.getHeight()/4,align:"middle",decoration:this.decoration||a&&a.decoration,rotated:this.rotated,kerning:this.kerning},font:b,fill:this.getFill(),stroke:this.getStroke()}},toJson:function(){var a=q.px2pt(this.xoffset),b=q.px2pt(this.yoffset),c=q.px2pt(this.haloSize),a=isNaN(a)?void 0:a,b=isNaN(b)?
void 0:b,c=isNaN(c)?void 0:c;return l.fixJson(e.mixin(this.inherited("toJson",arguments),{type:"esriTS",backgroundColor:this.backgroundColor,borderLineColor:this.borderLineColor,borderLineSize:this.borderLineSize,haloSize:c,haloColor:this.haloColor&&h.toJsonColor(this.haloColor),verticalAlignment:this.verticalAlignment,horizontalAlignment:this.horizontalAlignment,rightToLeft:this.rightToLeft,width:this.width,angle:this.angle&&-1*this.angle,xoffset:a,yoffset:b,text:this.text,rotated:this.rotated,kerning:this.kerning,
font:this.font.toJson()}))}});e.mixin(k,{ALIGN_START:"start",ALIGN_MIDDLE:"middle",ALIGN_END:"end",DECORATION_NONE:"none",DECORATION_UNDERLINE:"underline",DECORATION_OVERLINE:"overline",DECORATION_LINETHROUGH:"line-through"});k.defaultProps=c;return k})},"esri/symbols/Font":function(){define("dojo/_base/declare dojo/_base/lang dojo/sniff dojox/gfx/_base ../kernel ../lang".split(" "),function(k,e,p,q,n,l){k=k(null,{declaredClass:"esri.symbol.Font",constructor:function(h,f,d,c,a){h?e.isObject(h)?e.mixin(this,
h):(this.size=h,parseFloat(this.size)==this.size&&(this.size+="px"),void 0!==f&&(this.style=f),void 0!==d&&(this.variant=d),void 0!==c&&(this.weight=c),void 0!==a&&(this.family=a)):e.mixin(this,q.defaultFont);parseFloat(this.size)==this.size&&(this.size+="pt");9>p("ie")&&this.size&&e.isString(this.size)&&-1<this.size.indexOf("em")&&(this.size=q.pt2px(12*parseFloat(this.size))+"px");this.size=this._convert2PxSize(this.size)},setSize:function(h){this.size=this._convert2PxSize(h);return this},_convert2PxSize:function(h){var f;
parseFloat(h)==h?f=h:e.isString(h)&&(-1<h.indexOf("pt")?f=q.pt2px(parseFloat(h)):-1<h.indexOf("px")?f=parseFloat(h):-1<h.indexOf("em")?f=q.pt2px(12*parseFloat(h)):-1<h.indexOf("%")&&(f=q.pt2px(.12*parseFloat(h))));return f},setStyle:function(h){this.style=h;return this},setVariant:function(h){this.variant=h;return this},setWeight:function(h){this.weight=h;return this},setFamily:function(h){this.family=h;return this},setDecoration:function(h){this.decoration=h;return this},toJson:function(){return l.fixJson({size:q.px2pt(this.size),
style:this.style,decoration:this.decoration,weight:this.weight,family:this.family})}});e.mixin(k,{STYLE_NORMAL:"normal",STYLE_ITALIC:"italic",STYLE_OBLIQUE:"oblique",VARIANT_NORMAL:"normal",VARIANT_SMALLCAPS:"small-caps",WEIGHT_NORMAL:"normal",WEIGHT_BOLD:"bold",WEIGHT_BOLDER:"bolder",WEIGHT_LIGHTER:"lighter"});return k})},"esri/tasks/query":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/json dojo/has ../kernel ../geometry/jsonUtils ./SpatialRelationship require require require".split(" "),
function(k,e,p,q,n,l,h,f){var d=k(null,{declaredClass:"esri.tasks.Query",constructor:function(){this.spatialRelationship=d.SPATIAL_REL_INTERSECTS},text:null,where:"",geometry:null,groupByFieldsForStatistics:null,objectIds:null,returnGeometry:!1,returnDistinctValues:!1,orderByFields:null,outSpatialReference:null,outFields:null,outStatistics:null,timeExtent:null,relationParam:null,pixelSize:null,distance:null,units:null,resultOffset:null,resultRecordCount:null,resultType:null,sqlFormat:null,quantizationParameters:null,
_units:{meters:"esriSRUnit_Meter",kilometers:"esriSRUnit_Kilometer",feet:"esriSRUnit_Foot",miles:"esriSRUnit_StatuteMile","nautical-miles":"esriSRUnit_NauticalMile","us-nautical-miles":"esriSRUnit_USNauticalMile"},toJson:function(c){var a={text:this.text,where:this.where,returnGeometry:this.returnGeometry,spatialRel:this.spatialRelationship,maxAllowableOffset:this.maxAllowableOffset,geometryPrecision:this.geometryPrecision,sqlFormat:this.sqlFormat},b=c&&c.geometry||this.geometry,g=this.objectIds,
f=this.outFields,m=this.outSpatialReference,r=this.groupByFieldsForStatistics,t=this.orderByFields,v=this.outStatistics;c=this.distance;b&&(a.geometry=b,a.geometryType=h.getJsonType(b),a.inSR=b.spatialReference.wkid||q.toJson(b.spatialReference.toJson()));g&&(a.objectIds=g.join(","));f&&(a.outFields=f.join(","));this.returnDistinctValues&&(a.returnDistinctValues=!0);r&&(a.groupByFieldsForStatistics=r.join(","));t&&(a.orderByFields=t.join(","));if(v){var l=[];p.forEach(v,function(a){l.push(a.toJson())});
a.outStatistics=q.toJson(l)}m?a.outSR=m.wkid||q.toJson(m.toJson()):b&&(a.outSR=b.spatialReference.wkid||q.toJson(b.spatialReference.toJson()));b=this.timeExtent;a.time=b?b.toJson().join(","):null;(b=this.relationParam)&&this.spatialRelationship===d.SPATIAL_REL_RELATION&&(a.relationParam=b);c&&(a.distance=this.distance,this.hasOwnProperty("units")?a.units=this._units[this.units]||this._units.meters:(console.warn("esri/tasks/query::no distance unit provided, defaulting to meters"),a.units=this._units.meters));
this.hasOwnProperty("start")&&(a.resultOffset=this.start,a.resultRecordCount=10,""===a.where&&(a.where="1\x3d1"));this.hasOwnProperty("num")&&(a.resultRecordCount=this.num);a.resultType=this.resultType;a.pixelSize=this.pixelSize?q.toJson(this.pixelSize.toJson()):null;a.multipatchOption=this.multipatchOption;this.quantizationParameters&&(a.quantizationParameters=q.toJson(this.quantizationParameters));a._ts=this._ts;return a}});e.mixin(d,f);return d})},"esri/tasks/SpatialRelationship":function(){define(["dojo/_base/lang",
"dojo/has","../kernel"],function(k,e,p){return{SPATIAL_REL_INTERSECTS:"esriSpatialRelIntersects",SPATIAL_REL_CONTAINS:"esriSpatialRelContains",SPATIAL_REL_CROSSES:"esriSpatialRelCrosses",SPATIAL_REL_ENVELOPEINTERSECTS:"esriSpatialRelEnvelopeIntersects",SPATIAL_REL_INDEXINTERSECTS:"esriSpatialRelIndexIntersects",SPATIAL_REL_OVERLAPS:"esriSpatialRelOverlaps",SPATIAL_REL_TOUCHES:"esriSpatialRelTouches",SPATIAL_REL_WITHIN:"esriSpatialRelWithin",SPATIAL_REL_RELATION:"esriSpatialRelRelation"}})},"esri/plugins/popupManager":function(){define(["../PopupManager"],
function(k){return{add:function(e,p){e.popupManager||(e.popupManager=new k(p),e.popupManager.setMap(e))},remove:function(e){var k=e.popupManager;k&&(k.unsetMap(),e.popupManager=void 0)}}})},"esri/PopupManager":function(){define("./geometry/Extent ./geometry/ScreenPoint ./kernel ./layerUtils ./tasks/query dijit/registry dojo/_base/array dojo/_base/declare dojo/_base/Deferred dojo/_base/lang dojo/has dojo/on dojo/promise/all dojo/Stateful require".split(" "),function(k,e,p,q,n,l,h,f,d,c,a,b,g,u,m){var r;
return f(u,{declaredClass:"esri.PopupManager",enabled:!1,map:null,_mapClickHandle:null,_featureLayersCache:{},constructor:function(a){this._mapClickHandler=c.hitch(this,this._mapClickHandler)},setMap:function(a){if(this.map)if(a!==this.map)this.unsetMap();else return;this.map=a;this._setupClickHandler()},unsetMap:function(){this.map&&(this.map=null);this._mapClickHandle&&(this._mapClickHandle.remove(),this._mapClickHandle=null)},getMapLayer:function(a){var b;if(a&&(b=a.getLayer())&&(a=b.id,this._featureLayersCache[a])){var c=
a.lastIndexOf("_");-1<c&&(a=a.substring(0,c),b=this.map.getLayer(a))}return b},_enabledSetter:function(a){this.enabled=a;this._setupClickHandler()},_setupClickHandler:function(){this._mapClickHandle&&(this._mapClickHandle.remove(),this._mapClickHandle=null);this.enabled&&this.map&&(this._mapClickHandle=this.map.on("click",this._mapClickHandler))},_mapClickHandler:function(a){var b=this.map.infoWindow,c=a.graphic;b&&this.map.loaded&&(b.clearFeatures&&b.setFeatures?this._showPopup(a):c&&c.getInfoTemplate()&&
this._showInfoWindow(c,a.mapPoint))},_showPopup:function(a){var b=this.map,c=b.infoWindow,g=this,m=[],f=[b.graphics].concat(h.map(b.graphicsLayerIds,b.getLayer,b));h.forEach(f,function(a){a&&a.loaded&&a.infoTemplate&&!a.suspended&&m.push(a)});var r=[];h.forEach(b.layerIds,function(a){(a=b.getLayer(a))&&a.loaded&&!a.suspended&&(g._isImageServiceLayer(a)&&a.infoTemplate?m.push(a):"esri.layers.WMSLayer"===a.declaredClass&&a.getFeatureInfoURL?m.push(a):"esri.layers.ArcGISDynamicMapServiceLayer"!==a.declaredClass&&
"esri.layers.ArcGISTiledMapServiceLayer"!==a.declaredClass||!a.infoTemplates||r.push(a))});this._getSubLayerFeatureLayers(r).then(function(f){m=m.concat(f);var r=null;a.graphic&&a.graphic.getInfoTemplate()&&!g._isImageServiceLayer(a.graphic._layer)&&(r=a.graphic);if(m.length||r){var t=g._calculateClickTolerance(m),v=a.screenPoint;f=b.toMap(new e(v.x-t,v.y+t));var t=b.toMap(new e(v.x+t,v.y-t)),l=new k(f.x,f.y,t.x,t.y,b.spatialReference);if(l=l.intersects(b.extent)){var u=new n,w=!!r,z=!0;f=h.map(m,
function(c){u.timeExtent=c.useMapTime?b.timeExtent:null;var m=g._isReductionEnabled(c);c=m?c.getFeatureReductionLayer():c;var f;if(g._isImageServiceLayer(c))u.geometry=a.mapPoint,z=!1,f=c.queryVisibleRasters(u,{rasterAttributeTableFieldPrefix:"Raster.",returnDomainValues:!0}),f.addCallback(function(){var a=c.getVisibleRasters();w=w||0<a.length;return a});else if("esri.layers.WMSLayer"===c.declaredClass){f=new d;var t=c._getPopupGraphic(b,a.screenPoint);t?(f.resolve([t]),w=!0):f.resolve([])}else g._featureLayersCache[c.id]||
"function"===typeof c.queryFeatures&&(0===c.currentMode||1===c.currentMode)?(u.geometry=l,f=c.queryFeatures(u),f.addCallback(function(a){a=a.features;a=h.filter(a,function(a){return a.visible});w=w||0<a.length;return a})):(f=new d,t=h.filter(c.graphics,function(a){return a&&a.visible&&l.intersects(a.geometry)}),m&&g._isParentLayer(c,r)&&(m=g._findGraphicById(t,r,"cluster_id"))&&(r=m),w=w||0<t.length,f.resolve(t));return f});r&&(t=new d,t.resolve([r]),f.unshift(t));h.some(f,function(a){return!a.isFulfilled()})||
w?(c.setFeatures(f),c.show(a.mapPoint,{closestFirst:z})):(c.hide(),c.clearFeatures())}}})},_getSubLayerFeatureLayers:function(a,c){var f=c||new d,t=[];c=a.length;var v=Math.floor(this.map.extent.getWidth()/this.map.width),l=this.map.getScale(),u=!1,n=this,e=0;a:for(;e<c;e++){var k=a[e],p=k.dynamicLayerInfos||k.layerInfos;if(p){var F=null;k._params&&(k._params.layers||k._params.dynamicLayers)&&(F=k.visibleLayers);for(var F=q._getVisibleLayers(p,F),I=q._getLayersForScale(l,p),M=p.length,L=0;L<M;L++){var J=
p[L],P=J.id,K=k.infoTemplates[P];if(!J.subLayerIds&&K&&K.infoTemplate&&-1<h.indexOf(F,P)&&-1<h.indexOf(I,P)){if(!r){u=!0;break a}var U=k.id+"_"+P,O=this._featureLayersCache[U];O&&O.loadError||(O||((O=K.layerUrl)||(O=J.source?this._getLayerUrl(k.url,"/dynamicLayer"):this._getLayerUrl(k.url,P)),O=new r(O,{id:U,drawMode:!1,mode:r.MODE_SELECTION,outFields:this._getOutFields(K.infoTemplate),resourceInfo:K.resourceInfo,source:J.source}),this._featureLayersCache[U]=O),O.setDefinitionExpression(k.layerDefinitions&&
k.layerDefinitions[P]),O.setGDBVersion(k.gdbVersion),O.setInfoTemplate(K.infoTemplate),O.setMaxAllowableOffset(v),O.setUseMapTime(!!k.useMapTime),k.layerDrawingOptions&&k.layerDrawingOptions[P]&&k.layerDrawingOptions[P].renderer&&O.setRenderer(k.layerDrawingOptions[P].renderer),t.push(O))}}}}if(u){var S=new d;m(["./layers/FeatureLayer"],function(a){r=a;S.resolve()});S.then(function(){n._getSubLayerFeatureLayers(a,f)})}else{var Y=[];h.forEach(t,function(a){if(!a.loaded){var c=new d;b.once(a,"load, error",
function(){c.resolve()});Y.push(c.promise)}});Y.length?g(Y).then(function(){t=h.filter(t,function(a){return!a.loadError&&a.isVisibleAtScale(l)});f.resolve(t)}):(t=h.filter(t,function(a){return a.isVisibleAtScale(l)}),f.resolve(t))}return f.promise},_getLayerUrl:function(a,b){var c=a.indexOf("?");return-1===c?a+"/"+b:a.substring(0,c)+"/"+b+a.substring(c)},_getOutFields:function(a){var b;a.info&&"esri.dijit.PopupTemplate"===a.declaredClass?(b=[],h.forEach(a.info.fieldInfos,function(a){var c=a.fieldName&&
a.fieldName.toLowerCase();c&&"shape"!==c&&0!==c.indexOf("relationships/")&&b.push(a.fieldName)})):b=["*"];return b},_calculateClickTolerance:function(a){var b=6,c,d;h.forEach(a,function(a){if(c=a.renderer)"esri.renderer.SimpleRenderer"===c.declaredClass?((d=c.symbol)&&d.xoffset&&(b=Math.max(b,Math.abs(d.xoffset))),d&&d.yoffset&&(b=Math.max(b,Math.abs(d.yoffset)))):"esri.renderer.UniqueValueRenderer"!==c.declaredClass&&"esri.renderer.ClassBreaksRenderer"!==c.declaredClass||h.forEach(c.infos,function(a){(d=
a.symbol)&&d.xoffset&&(b=Math.max(b,Math.abs(d.xoffset)));d&&d.yoffset&&(b=Math.max(b,Math.abs(d.yoffset)))})});return b},_showInfoWindow:function(a,b){var d=this.map.infoWindow,g=a.geometry;b=g&&"point"===g.type?g:b;g=a.getContent();d.setTitle(a.getTitle());g&&c.isString(g.id)&&(a=l.byId(g.id))&&a.set&&/_PopupRenderer/.test(a.declaredClass)&&a.set("showTitle",!1);d.setContent(g);d.show(b)},_findGraphicById:function(a,b,c){var d,g=(b=b.attributes)&&b[c];h.some(a,function(a){var b=a.attributes;b&&
b[c]===g&&(d=a);return!!d});return d},_isParentLayer:function(a,b){b=b&&b.getLayer();return a&&b===a},_isReductionEnabled:function(a){return a&&a.isFeatureReductionActive&&a.isFeatureReductionActive()},_isImageServiceLayer:function(a){return"esri.layers.ArcGISImageServiceLayer"===a.declaredClass||"esri.layers.ArcGISImageServiceVectorLayer"===a.declaredClass}})})},"esri/layerUtils":function(){define(["dojo/_base/lang","dojo/_base/array","dojo/_base/json","dojo/has","./kernel"],function(k,e,p,q,n){return{_serializeLayerDefinitions:function(l,
h){var f=[],d=/[:;]/;if(l&&(e.forEach(l,function(a,b){a&&(f.push([b,a]),!h&&d.test(a)&&(h=!0))}),0<f.length)){var c;h?(c={},e.forEach(f,function(a){c[a[0]]=a[1]}),c=p.toJson(c)):(c=[],e.forEach(f,function(a){c.push(a[0]+":"+a[1])}),c=c.join(";"));return c}return null},_serializeTimeOptions:function(l,h){if(l){var f=[];e.forEach(l,function(d,c){d&&(d=d.toJson(),h&&-1!==e.indexOf(h,c)&&(d.useTime=!1),f.push('"'+c+'":'+p.toJson(d)))});if(f.length)return"{"+f.join(",")+"}"}},_getVisibleLayers:function(l,
h){var f=[],d,c;if(!l)return f;if(h)for(f=h.concat(),c=0;c<l.length;c++)h=l[c],d=e.indexOf(l,h.id),h.subLayerIds&&-1<d&&(f.splice(d,1),f=f.concat(h.subLayerIds));else f=this._getDefaultVisibleLayers(l);return f},_getDefaultVisibleLayers:function(l){var h=[],f;if(!l)return h;for(f=0;f<l.length;f++)0<=l[f].parentLayerId&&-1===e.indexOf(h,l[f].parentLayerId)&&e.some(l,function(d){return d.id===l[f].parentLayerId})||l[f].defaultVisibility&&h.push(l[f].id);return h},_getLayersForScale:function(l,h){var f=
[];if(0<l&&h){var d;for(d=0;d<h.length;d++)if(!(0<=h[d].parentLayerId&&-1===e.indexOf(f,h[d].parentLayerId)&&e.some(h,function(a){return a.id===h[d].parentLayerId}))&&0<=h[d].id){var c=!0,a=h[d].maxScale,b=h[d].minScale;if(0<a||0<b)0<a&&0<b?c=a<=l&&l<=b:0<a?c=a<=l:0<b&&(c=l<=b);c&&f.push(h[d].id)}}return f}}})},"dojo/uacss":function(){define(["./dom-geometry","./_base/lang","./domReady","./sniff","./_base/window"],function(k,e,p,q,n){var l=n.doc.documentElement;n=q("ie");var h=q("trident"),f=q("opera"),
d=Math.floor,c=q("ff"),a=k.boxModel.replace(/-/,""),f={dj_quirks:q("quirks"),dj_opera:f,dj_khtml:q("khtml"),dj_webkit:q("webkit"),dj_safari:q("safari"),dj_chrome:q("chrome"),dj_edge:q("edge"),dj_gecko:q("mozilla"),dj_ios:q("ios"),dj_android:q("android")};n&&(f.dj_ie=!0,f["dj_ie"+d(n)]=!0,f.dj_iequirks=q("quirks"));h&&(f.dj_trident=!0,f["dj_trident"+d(h)]=!0);c&&(f["dj_ff"+d(c)]=!0);f["dj_"+a]=!0;var b="",g;for(g in f)f[g]&&(b+=g+" ");l.className=e.trim(l.className+" "+b);p(function(){if(!k.isBodyLtr()){var a=
"dj_rtl dijitRtl "+b.replace(/ /g,"-rtl ");l.className=e.trim(l.className+" "+a+"dj_rtl dijitRtl "+b.replace(/ /g,"-rtl "))}});return q})},"esri/MapNavigationManager":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/_base/event dojo/mouse dojo/keys dijit/focus ./kernel ./MouseEvents ./TouchEvents ./PointerEvents ./config ./sniff ./lang ./fx ./graphic ./tileUtils ./geometry/ScreenPoint ./geometry/Extent ./geometry/Rect ./geometry/mathUtils ./symbols/SimpleFillSymbol".split(" "),
function(k,e,p,q,n,l,h,f,d,c,a,b,g,u,m,r,t,v,y,w,z,x,A){var C=q.connect,B=q.disconnect,E=u("chrome"),D=u("safari"),F=[h.NUMPAD_PLUS,61,187,h.NUMPAD_MINUS,173,189,h.UP_ARROW,h.NUMPAD_8,h.RIGHT_ARROW,h.NUMPAD_6,h.DOWN_ARROW,h.NUMPAD_2,h.LEFT_ARROW,h.NUMPAD_4,h.PAGE_UP,h.NUMPAD_9,h.PAGE_DOWN,h.NUMPAD_3,h.END,h.NUMPAD_1,h.HOME,h.NUMPAD_7];return k(null,{declaredClass:"esri.MapNavigationManager",eventModel:"",constructor:function(d,m){this.map=d;e.mixin(this,m);m=d.__container;u("esri-pointer")?(this.pointerEvents=
new b(m,{map:d}),this.eventModel="pointer"):u("esri-touch")?(u("ios")||(this.mouseEvents=new c(m,{map:d})),this.touchEvents=new a(m,{map:d,mouseEvents:this.mouseEvents}),this.eventModel="touch"):(this.mouseEvents=new c(m,{map:d}),this.eventModel="mouse");this._zoomRect=new t(null,new A(g.defaults.map.zoomSymbol));this._keyDx=this._keyDy=0;this._adjustPinch=e.hitch(this,this._adjustPinch);this._adjustPinchEnd=e.hitch(this,this._adjustPinchEnd)},_panInit:function(a){var b=this.mouseEvents;l.isLeft(a)&&
this.map.isPan&&!a.shiftKey&&(this._dragOrigin=new y(0,0),e.mixin(this._dragOrigin,a.screenPoint),B(this._panStartHandle),B(this._panHandle),B(this._panEndHandle),this._panStartHandle=C(b,"onMouseDragStart",this,this._panStart),this._panHandle=C(b,"onMouseDrag",this,this._pan),this._panEndHandle=C(b,"onMouseUp",this,this._panEnd),E||D)&&(a.preventDefault(),f.curNode&&f.curNode.blur())},_panStart:function(a){this.map.setCursor("move");this.map.__panStart(a.screenPoint.x,a.screenPoint.y)},_pan:function(a){this.map.__pan(a.screenPoint.x-
this._dragOrigin.x,a.screenPoint.y-this._dragOrigin.y)},_panEnd:function(a){B(this._panStartHandle);B(this._panHandle);B(this._panEndHandle);this._panStartHandle=this._panHandle=this._panEndHandle=null;var b=this.map;b.__panning&&(b.__panEnd(a.screenPoint.x-this._dragOrigin.x,a.screenPoint.y-this._dragOrigin.y),b.resetMapCursor())},_zoomInit:function(a){var b=this.map,c=this.pointerEvents||this.mouseEvents;(l.isLeft(a)||a.pointerType)&&b.isRubberBandZoom&&a.shiftKey&&(b.setCursor("crosshair"),this._dragOrigin=
e.mixin({},a.screenPoint),this._zoomDir=a.ctrlKey||a.metaKey?-1:1,this.pointerEvents?(this._zoomHandle=C(c,"onSwipeMove",this,this._zoom),this._zoomEndHandle=C(c,"onSwipeEnd",this,this._zoomEnd)):(this._zoomHandle=C(c,"onMouseDrag",this,this._zoom),this._zoomEndHandle=C(c,"onMouseUp",this,this._zoomEnd)),E&&a.preventDefault())},_zoom:function(a){var b=this.map,c=this._normalizeRect(a).offset(b.__visibleRect.x,b.__visibleRect.y);a=b.graphics;var d=this._zoomRect;d.geometry||b.setCursor("crosshair");
d.geometry&&a.remove(d,!0);var g=b.toMap(new y(c.x,c.y)),c=b.toMap(new y(c.x+c.width,c.y+c.height)),c=new z(g.x,g.y,c.x-g.x,g.y-c.y,b.spatialReference);c._originOnly=!0;d.setGeometry(c);a.add(d,!0)},_zoomEnd:function(a){var b=this._zoomRect,c=this.map,d=c.extent,g=c.spatialReference;B(this._zoomHandle);B(this._zoomEndHandle);this._zoomHandle=this._zoomEndHandle=null;if(c._canZoom(this._zoomDir)&&b.getDojoShape()){c.graphics.remove(b);b.geometry=null;a=this._normalizeRect(a);a.x+=c.__visibleRect.x;
a.y+=c.__visibleRect.y;if(-1===this._zoomDir){var m=d.getWidth();a=(m*c.width/a.width-m)/2;g=new w(d.xmin-a,d.ymin-a,d.xmax+a,d.ymax+a,g)}else d=c.toMap({x:a.x,y:a.y+a.height}),a=c.toMap({x:a.x+a.width,y:a.y}),g=new w(d.x,d.y,a.x,a.y,g);c._extentUtil(null,null,g)}b.getDojoShape()&&c.graphics.remove(b,!0);this._zoomDir=0;c.resetMapCursor()},_wheelZoom:function(a,b){var c=this.map;if(!b){if(c.smartNavigation&&!a.shiftKey&&!c._isPanningOrZooming()){c.disableScrollWheelZoom();this._setScrollWheelPan(!0);
this._wheelPan(a);return}b=a.timeStamp;if(!m.isDefined(b)||0>=b)b=(new Date).getTime();if(100>(this._mwts?b-this._mwts:b))return;this._mwts=b}c._canZoom(a.value)&&c._extentUtil({numLevels:a.value,mapAnchor:a.mapPoint,screenAnchor:a.screenPoint})},_wheelPan:function(a){var b=this.map;if(a.shiftKey&&!b._isPanningOrZooming())this._setScrollWheelPan(!1),b.enableScrollWheelZoom(),this._wheelZoom(a);else{var c=0,d=0;u("ff")?a.axis===a.HORIZONTAL_AXIS?c=-a.detail:d=-a.detail:(c=a.wheelDeltaX,d=a.wheelDeltaY);
b.translate(c,d)}},_setScrollWheelPan:function(a){this.map.isScrollWheelPan=a;this.mouseEvents.enableMouseWheel(a);B(this._mwMacHandle);this._mwMacHandle=null;a&&(this._mwMacHandle=C(this.mouseEvents,"onMouseWheel",this,this._wheelPan))},_recenter:function(a){a.shiftKey&&!this.map._isPanningOrZooming()&&this.map.centerAt(a.mapPoint)},_recenterZoom:function(a){a.shiftKey&&!this.map._isPanningOrZooming()&&(a.value=a.ctrlKey||a.metaKey?-1:1,this._wheelZoom(a,!0))},_dblClickZoom:function(a){this.map._isPanningOrZooming()||
(a.value=1,this._wheelZoom(a,!0))},_twoFingerTap:function(a){this.map._isPanningOrZooming()||(a.value=-1,this._wheelZoom(a,!0))},_keyDown:function(a){var b=a.keyCode,c=this.map;if(-1!==p.indexOf(F,b)){if(b===h.NUMPAD_PLUS||61===b||187===b)c._extentUtil({numLevels:1});else if(b===h.NUMPAD_MINUS||173===b||189===b)c._extentUtil({numLevels:-1});else{c.__panning||c.__panStart(0,0);switch(b){case h.UP_ARROW:case h.NUMPAD_8:this._keyDy+=10;break;case h.RIGHT_ARROW:case h.NUMPAD_6:this._keyDx-=10;break;case h.DOWN_ARROW:case h.NUMPAD_2:this._keyDy-=
10;break;case h.LEFT_ARROW:case h.NUMPAD_4:this._keyDx+=10;break;case h.PAGE_UP:case h.NUMPAD_9:this._keyDx-=10;this._keyDy+=10;break;case h.PAGE_DOWN:case h.NUMPAD_3:this._keyDx-=10;this._keyDy-=10;break;case h.END:case h.NUMPAD_1:this._keyDx+=10;this._keyDy-=10;break;case h.HOME:case h.NUMPAD_7:this._keyDx+=10;this._keyDy+=10;break;default:return}c.__pan(this._keyDx,this._keyDy)}n.stop(a)}},_keyEnd:function(a){var b=this.map;b.__panning&&a.keyCode!==h.SHIFT&&(b.__panEnd(this._keyDx,this._keyDy),
this._keyDx=this._keyDy=0)},_swipeInit:function(a){var b=this.map,b=b._zoomAnim||b._panAnim;if(a.shiftKey)return!1;b&&b._active&&(b.stop(),b._fire("onEnd",[b.node]));this._dragOrigin=new y(0,0);e.mixin(this._dragOrigin,a.screenPoint);B(this._swipeHandle);B(this._swipeEndHandle);this._swipeHandle=C(this.touchEvents||this.pointerEvents,"onSwipeMove",this,this._swipe);this._swipeEndHandle=C(this.touchEvents||this.pointerEvents,"onSwipeEnd",this,this._swipeEnd)},_swipe:function(a){var b=this.map;b.__panning?
(this._panX=a.screenPoint.x,this._panY=a.screenPoint.y,b.__pan(a.screenPoint.x-this._dragOrigin.x,a.screenPoint.y-this._dragOrigin.y)):(b.setCursor("move"),b.__panStart(a.screenPoint.x,a.screenPoint.y))},_swipeEnd:function(a){B(this._swipeHandle);B(this._swipeEndHandle);this._swipeHandle=this._swipeEndHandle=null;var b=this.map;b.__panning&&(b.resetMapCursor(),b.__panEnd(a.screenPoint.x-this._dragOrigin.x,a.screenPoint.y-this._dragOrigin.y))},_pinchInit:function(a){var b=this.map,c=b._zoomAnim||b._panAnim;
c&&c._active?(c.stop(),c._fire("onEnd",[c.node])):b.__panning&&(a.screenPoint=new y(this._panX,this._panY),a.mapPoint=b.toMap(a.screenPoint),this._swipeEnd(a));B(this._pinchHandle);B(this._pinchEndHandle);this._pinchHandle=C(this.touchEvents||this.pointerEvents,"onPinchMove",this,this._pinch);this._pinchEndHandle=C(this.touchEvents||this.pointerEvents,"onPinchEnd",this,this._pinchEnd)},_pinch:function(a){var b=this.map;if(a.screenPoints){this.currLength=x.getLength(a.screenPoints[0],a.screenPoints[1]);
var c;b.__zooming?(c=this.currLength/this._length,this._zoomStartExtent=this.__scaleExtent(b.extent,c,this._dragOrigin),b.__zoom(this._zoomStartExtent,c,this._dragOrigin)):(this._dragOrigin=new y((a.screenPoints[0].x+a.screenPoints[1].x)/2,(a.screenPoints[0].y+a.screenPoints[1].y)/2),this._length=this.currLength,b.__zoomStart(b.extent,this._dragOrigin));this._pinchScale=c;b._fireOnScale(this.currLength/this._length,this._dragOrigin,!0)}},_pinchEnd:function(a){a=this.map;B(this._pinchHandle);B(this._pinchEndHandle);
this._pinchHandle=this._pinchEndHandle=null;this._pinchScale=0;if(a.__zooming&&null===a._zoomAnim){var b=this.currLength/this._length,c=a.extent.getWidth();this._zoomAnimAnchor=a.toMap(this._dragOrigin);this._zoomStartExtent=this.__scaleExtent(a.extent,1/b,this._zoomAnimAnchor);if(a.__tileInfo){var d=v.getCandidateTileInfo(a,a.__tileInfo,this._zoomStartExtent),m=a.__getExtentForLevel(d.lod.level,this._zoomAnimAnchor),f=a.getMinZoom(),t=a.getMaxZoom(),h=m.extent,m=m.lod,l=c/h.getWidth(),u=d.lod.level;
1>b?l>b&&u--:l<b&&u++;u<f?u=f:u>t&&(u=t);u!==d.lod.level&&(m=a.__getExtentForLevel(u,this._zoomAnimAnchor),h=m.extent,m=m.lod);this._zoomEndExtent=h;this._zoomEndLod=m;a._zoomAnim=r.animateRange({range:{start:c/this._zoomStartExtent.getWidth(),end:l},duration:g.defaults.map.zoomDuration,rate:g.defaults.map.zoomRate,onAnimate:this._adjustPinch,onEnd:this._adjustPinchEnd});a._zoomAnim.play();a._fireOnScale(a.extent.getWidth()/this._zoomEndExtent.getWidth(),this._dragOrigin)}else this._zoomEndExtent=
this._zoomStartExtent,a._fireOnScale(a.extent.getWidth()/this._zoomEndExtent.getWidth(),this._dragOrigin),this._adjustPinchEnd()}},_adjustPinch:function(a){var b=this.__scaleExtent(this.map.extent,a,this._zoomAnimAnchor);this.map.__zoom(b,a,this._dragOrigin)},_adjustPinchEnd:function(){var a=this.map,b=a.extent.getWidth()/this._zoomEndExtent.getWidth(),c=this.__scaleExtent(a.extent,1/b,this._zoomAnimAnchor),d=this._dragOrigin,g=this._zoomEndLod;this._zoomStartExtent=this._zoomEndExtent=this._zoomEndLod=
this._dragOrigin=a._zoomAnim=this._zoomAnimAnchor=null;a.__zoomEnd(c,b,d,g,!0)},__scaleExtent:function(a,b,c){c=c||a.getCenter();b=a.expand(b);var d=a.xmin-(b.getWidth()-a.getWidth())*(c.x-a.xmin)/a.getWidth();c=a.ymax-(b.getHeight()-a.getHeight())*(c.y-a.ymax)/a.getHeight();return new w(d,c-b.getHeight(),d+b.getWidth(),c,a.spatialReference)},_normalizeRect:function(a){a=a.screenPoint;var b=this._dragOrigin.x,c=this._dragOrigin.y;a=new z((a.x<b?a.x:b)-this.map.__visibleRect.x,(a.y<c?a.y:c)-this.map.__visibleRect.y,
Math.abs(a.x-b),Math.abs(a.y-c));delete a.spatialReference;0===a.width&&(a.width=1);0===a.height&&(a.height=1);return a},setImmediateClick:function(a){switch(this.eventModel){case "mouse":this.mouseEvents.setImmediateClick(a);break;case "touch":this.touchEvents.setImmediateTap(a);this.mouseEvents&&this.mouseEvents.setImmediateClick(a);break;case "pointer":this.pointerEvents.setImmediateTap(a)}},enablePan:function(){this.disablePan();switch(this.eventModel){case "mouse":this._panInitHandle=C(this.mouseEvents,
"onMouseDown",this,this._panInit);break;case "touch":this._panInitHandle=C(this.mouseEvents,"onMouseDown",this,this._panInit);this._swipeInitHandle=C(this.touchEvents,"onSwipeStart",this,this._swipeInit);break;case "pointer":this._swipeInitHandle=C(this.pointerEvents,"onSwipeStart",this,this._swipeInit)}},disablePan:function(){B(this._panInitHandle);this._panInitHandle=null;B(this._swipeInitHandle);this._swipeInitHandle=null},enableRubberBandZoom:function(){this.disableRubberBandZoom();this._zoomInitHandle=
this.pointerEvents?C(this.pointerEvents,"onSwipeStart",this,this._zoomInit):C(this.mouseEvents,"onMouseDown",this,this._zoomInit)},disableRubberBandZoom:function(){B(this._zoomInitHandle);this._zoomInitHandle=null},enablePinchZoom:function(){this.disablePinchZoom();if("touch"===this.eventModel||"pointer"===this.eventModel)this._pinchInitHandle=C(this.touchEvents||this.pointerEvents,"onPinchStart",this,this._pinchInit)},disablePinchZoom:function(){B(this._pinchInitHandle);this._pinchInitHandle=null},
enableScrollWheelZoom:function(){this.disableScrollWheelZoom();this._wheelHandle=C(this.mouseEvents||this.pointerEvents,"onMouseWheel",this,this._wheelZoom)},disableScrollWheelZoom:function(){B(this._wheelHandle);this._wheelHandle=null},enableScrollWheelPan:function(){var a=this.map;a&&a.loaded&&a.smartNavigation&&(this.disableScrollWheelPan(),this._setScrollWheelPan(!0))},disableScrollWheelPan:function(){var a=this.map;a&&a.loaded&&a.smartNavigation&&this._setScrollWheelPan(!1)},enableDoubleClickZoom:function(){this.disableDoubleClickZoom();
switch(this.eventModel){case "mouse":this._dblClickHandle=C(this.mouseEvents,"onDblClick",this,this._dblClickZoom);break;case "touch":this._dblClickHandle=C(this.mouseEvents,"onDblClick",this,this._dblClickZoom);this._dblTapHandle=C(this.touchEvents,"onDoubleTap",this,this._dblClickZoom);this._zoomOutHandle=C(this.touchEvents,"onTwoFingerTap",this,this._twoFingerTap);break;case "pointer":this._dblTapHandle=C(this.pointerEvents,"onDoubleTap",this,this._dblClickZoom),this._zoomOutHandle=C(this.pointerEvents,
"onTwoFingerTap",this,this._twoFingerTap)}},disableDoubleClickZoom:function(){B(this._dblClickHandle);B(this._zoomOutHandle);this._dblTapHandle&&B(this._dblTapHandle);this._dblClickHandle=this._zoomOutHandle=this._dblTapHandle=null},enableShiftDoubleClickZoom:function(){this.disableShiftDoubleClickZoom();this._sDblClickHandle=C(this.pointerEvents||this.mouseEvents,"onDblClick",this,this._recenterZoom)},disableShiftDoubleClickZoom:function(){B(this._sDblClickHandle);this._sDblClickHandle=null},enableClickRecenter:function(){this.disableClickRecenter();
this._recenterHandle=C(this.pointerEvents||this.mouseEvents,"onClick",this,this._recenter)},disableClickRecenter:function(){B(this._recenterHandle);this._recenterHandle=null},enableKeyboardNavigation:function(){this.disableKeyboardNavigation();this._keyHandle=C(this.pointerEvents||this.mouseEvents,"onKeyDown",this,this._keyDown);this._keyEndHandle=C(this.pointerEvents||this.mouseEvents,"onKeyUp",this,this._keyEnd)},disableKeyboardNavigation:function(){B(this._keyHandle);B(this._keyEndHandle);this._keyHandle=
this._keyEndHandle=null},enableScrollWheel:function(){var a=this.map;a&&(a.smartNavigation?this.enableScrollWheelPan():a.enableScrollWheelZoom())},disableScrollWheel:function(){var a=this.map;a&&(a.disableScrollWheelZoom(),a.smartNavigation&&this.disableScrollWheelPan())},enableNavigation:function(){var a=this.map;a&&a.loaded&&(a._evalNavigationFeature("DoubleClickZoom"),a._evalNavigationFeature("ClickRecenter"),a._evalNavigationFeature("Pan"),a._evalNavigationFeature("RubberBandZoom"),a._evalNavigationFeature("PinchZoom"),
a._evalNavigationFeature("KeyboardNavigation"),a._evalNavigationFeature("ScrollWheel"))},disableNavigation:function(){var a=this.map;a&&a.loaded&&(a._evalNavigationFeature("DoubleClickZoom"),a._evalNavigationFeature("ClickRecenter"),a._evalNavigationFeature("Pan"),a._evalNavigationFeature("RubberBandZoom"),a._evalNavigationFeature("PinchZoom"),a._evalNavigationFeature("KeyboardNavigation"),a._evalNavigationFeature("ScrollWheel"))},destroy:function(){this.touchEvents&&this.touchEvents.destroy();this.mouseEvents&&
this.mouseEvents.destroy();this.pointerEvents&&this.pointerEvents.destroy();var a,b=[this._panInitHandle,this._panStartHandle,this._panHandle,this._panEndHandle,this._zoomInitHandle,this._zoomHandle,this._zoomEndHandle,this._wheelHandle,this._mwMacHandle,this._dblClickHandle,this._zoomOutHandle,this._recenterHandle,this._sDblClickHandle,this._dblTapHandle,this._keyHandle,this._keyEndHandle,this._swipeInitHandle,this._swipeHandle,this._swipeEndHandle,this._pinchInitHandle,this._pinchHandle,this._pinchEndHandle];
for(a=0;a<b.length;a++)B(b[a]);this.map=this.touchEvents=this.mouseEvents=this.eventModel=this.pointerEvents=this._zoomRect=this._dragOrigin=this._panInitHandle=this._panStartHandle=this._panHandle=this._panEndHandle=this._zoomInitHandle=this._zoomHandle=this._zoomEndHandle=this._wheelHandle=this._mwMacHandle=this._dblClickHandle=this._zoomOutHandle=this._recenterHandle=this._sDblClickHandle=this._dblTapHandle=this._keyHandle=this._keyEndHandle=this._swipeInitHandle=this._swipeHandle=this._swipeEndHandle=
this._pinchInitHandle=this._pinchHandle=this._pinchEndHandle=null}})})},"dijit/focus":function(){define("dojo/aspect dojo/_base/declare dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/Evented dojo/_base/lang dojo/on dojo/domReady dojo/sniff dojo/Stateful dojo/_base/window dojo/window ./a11y ./registry ./main".split(" "),function(k,e,p,q,n,l,h,f,d,c,a,b,g,u,m,r,t){var v,y,w=new (e([b,h],{curNode:null,activeStack:[],constructor:function(){var a=f.hitch(this,function(a){p.isDescendant(this.curNode,
a)&&this.set("curNode",null);p.isDescendant(this.prevNode,a)&&this.set("prevNode",null)});k.before(l,"empty",a);k.before(l,"destroy",a)},registerIframe:function(a){return this.registerWin(a.contentWindow,a)},registerWin:function(b,c){var g=this,f=b.document&&b.document.body;if(f){var r=a("pointer-events")?"pointerdown":a("MSPointer")?"MSPointerDown":a("touch-events")?"mousedown, touchstart":"mousedown",t=d(b.document,r,function(a){a&&a.target&&null==a.target.parentNode||g._onTouchNode(c||a.target,
"mouse")}),h=d(f,"focusin",function(a){if(a.target.tagName){var b=a.target.tagName.toLowerCase();"#document"!=b&&"body"!=b&&(m.isFocusable(a.target)?g._onFocusNode(c||a.target):g._onTouchNode(c||a.target))}}),v=d(f,"focusout",function(a){g._onBlurNode(c||a.target)});return{remove:function(){t.remove();h.remove();v.remove();f=t=h=v=null}}}},_onBlurNode:function(a){a=(new Date).getTime();a<v+100||(this._clearFocusTimer&&clearTimeout(this._clearFocusTimer),this._clearFocusTimer=setTimeout(f.hitch(this,
function(){this.set("prevNode",this.curNode);this.set("curNode",null)}),0),this._clearActiveWidgetsTimer&&clearTimeout(this._clearActiveWidgetsTimer),a<y+100||(this._clearActiveWidgetsTimer=setTimeout(f.hitch(this,function(){delete this._clearActiveWidgetsTimer;this._setStack([])}),0)))},_onTouchNode:function(a,b){y=(new Date).getTime();this._clearActiveWidgetsTimer&&(clearTimeout(this._clearActiveWidgetsTimer),delete this._clearActiveWidgetsTimer);n.contains(a,"dijitPopup")&&(a=a.firstChild);var c=
[];try{for(;a;){var d=q.get(a,"dijitPopupParent");if(d)a=r.byId(d).domNode;else if(a.tagName&&"body"==a.tagName.toLowerCase()){if(a===g.body())break;a=u.get(a.ownerDocument).frameElement}else{var m=a.getAttribute&&a.getAttribute("widgetId"),f=m&&r.byId(m);!f||"mouse"==b&&f.get("disabled")||c.unshift(m);a=a.parentNode}}}catch(F){}this._setStack(c,b)},_onFocusNode:function(a){a&&9!=a.nodeType&&(v=(new Date).getTime(),this._clearFocusTimer&&(clearTimeout(this._clearFocusTimer),delete this._clearFocusTimer),
this._onTouchNode(a),a!=this.curNode&&(this.set("prevNode",this.curNode),this.set("curNode",a)))},_setStack:function(a,b){var c=this.activeStack,d=c.length-1,g=a.length-1;if(a[g]!=c[d]){this.set("activeStack",a);var m;for(m=d;0<=m&&c[m]!=a[m];m--)if(d=r.byId(c[m]))d._hasBeenBlurred=!0,d.set("focused",!1),d._focusManager==this&&d._onBlur(b),this.emit("widget-blur",d,b);for(m++;m<=g;m++)if(d=r.byId(a[m]))d.set("focused",!0),d._focusManager==this&&d._onFocus(b),this.emit("widget-focus",d,b)}},focus:function(a){if(a)try{a.focus()}catch(A){}}}));
c(function(){var b=w.registerWin(u.get(document));a("ie")&&d(window,"unload",function(){b&&(b.remove(),b=null)})});t.focus=function(a){w.focus(a)};for(var z in w)/^_/.test(z)||(t.focus[z]="function"==typeof w[z]?f.hitch(w,z):w[z]);w.watch(function(a,b,c){t.focus[a]=c});return w})},"dijit/a11y":function(){define("dojo/_base/array dojo/dom dojo/dom-attr dojo/dom-style dojo/_base/lang dojo/sniff ./main".split(" "),function(k,e,p,q,n,l,h){var f={_isElementShown:function(d){var c=q.get(d);return"hidden"!=
c.visibility&&"collapsed"!=c.visibility&&"none"!=c.display&&"hidden"!=p.get(d,"type")},hasDefaultTabStop:function(d){switch(d.nodeName.toLowerCase()){case "a":return p.has(d,"href");case "area":case "button":case "input":case "object":case "select":case "textarea":return!0;case "iframe":var c;try{var a=d.contentDocument;if("designMode"in a&&"on"==a.designMode)return!0;c=a.body}catch(b){try{c=d.contentWindow.document.body}catch(g){return!1}}return c&&("true"==c.contentEditable||c.firstChild&&"true"==
c.firstChild.contentEditable);default:return"true"==d.contentEditable}},effectiveTabIndex:function(d){if(!p.get(d,"disabled"))return p.has(d,"tabIndex")?+p.get(d,"tabIndex"):f.hasDefaultTabStop(d)?0:void 0},isTabNavigable:function(d){return 0<=f.effectiveTabIndex(d)},isFocusable:function(d){return-1<=f.effectiveTabIndex(d)},_getTabNavigable:function(d){function c(a){return a&&"input"==a.tagName.toLowerCase()&&a.type&&"radio"==a.type.toLowerCase()&&a.name&&a.name.toLowerCase()}function a(a){return v[c(a)]||
a}var b,g,h,m,r,t,v={},n=f._isElementShown,e=f.effectiveTabIndex,k=function(a){for(a=a.firstChild;a;a=a.nextSibling)if(!(1!=a.nodeType||9>=l("ie")&&"HTML"!==a.scopeName)&&n(a)){var d=e(a);if(0<=d){if(0==d)b||(b=a),g=a;else if(0<d){if(!h||d<m)m=d,h=a;if(!r||d>=t)t=d,r=a}d=c(a);p.get(a,"checked")&&d&&(v[d]=a)}"SELECT"!=a.nodeName.toUpperCase()&&k(a)}};n(d)&&k(d);return{first:a(b),last:a(g),lowest:a(h),highest:a(r)}},getFirstInTabbingOrder:function(d,c){d=f._getTabNavigable(e.byId(d,c));return d.lowest?
d.lowest:d.first},getLastInTabbingOrder:function(d,c){d=f._getTabNavigable(e.byId(d,c));return d.last?d.last:d.highest}};n.mixin(h,f);return f})},"esri/MouseEvents":function(){define("dojo/_base/declare dojo/_base/html dojo/_base/lang dojo/_base/sniff dojo/_base/connect dojo/_base/event ./kernel ./Evented ./geometry/Point ./geometry/ScreenPoint".split(" "),function(k,e,p,q,n,l,h,f,d,c){var a=n.connect,b=n.disconnect;return k([f],{declaredClass:"esri.MouseEvents",doubleClickDuration:300,minWheelValue:1,
maxWheelValue:1,mozWheelDivisor:-1!==q("mac")?1:3,wheelDivisor:2>q("chrome")?360:120,preventPageScroll:!0,map:null,constructor:function(b,c){this.node=b;p.mixin(this,c);c=function(a){l.stop(a);return!1};q("mozilla")&&e.style(b,"MozUserSelect","none");this._handles=[a(b,"onselectstart",c),a(b,"ondragstart",c),a(b,"onmouseenter",this,this._onMouseEnterHandler),a(b,"onmouseleave",this,this._onMouseLeaveHandler),a(b,"onmousedown",this,this._onMouseDownHandler),a(b,"onclick",this,this._onClickHandler),
a(b,"ondblclick",this,this._onDblClickHandler)];this._onMouseMoveHandler_connect=a(b,"onmousemove",this,this._onMouseMoveHandler);this._onMouseUpHandler_connect=a(b,"onmouseup",this,this._onMouseUpHandler);this._fireClickEvent=p.hitch(this,this._fireClickEvent);this._initialDuration=this.doubleClickDuration;this.preventPageScroll=(b=this.map)?b.isScrollWheelZoom||b.isScrollWheelPan:this.preventPageScroll;this.enableMouseWheel(!1)},_fire:function(a,b){if(!this._preventClick||"onClick"!==a&&"onDblClick"!==
a){if(this[a])this[a](b);if(this.map&&this.map[a])this.map[a](b)}},_processEvent:function(a){a=l.fix(a,a.target);var b=this.map,g=b&&b.position;g&&("DOMMouseScroll"===a.type&&3>q("ff")?a.screenPoint=new c(window.scrollX+a.screenX-g.x,window.scrollY+a.screenY-g.y):a.screenPoint=new c(a.pageX-g.x,a.pageY-g.y),a.mapPoint=b.extent?b.toMap(a.screenPoint):new d);a.numPoints=0;return a},_onMouseEnterHandler:function(c){b(this._onKeyDown_connect);b(this._onKeyUp_connect);this._onKeyDown_connect=a(document,
"onkeydown",this,this._onKeyDownHandler);this._onKeyUp_connect=a(document,"onkeyup",this,this._onKeyUpHandler);this._fire("onMouseOver",this._processEvent(c))},_onMouseLeaveHandler:function(a){b(this._onKeyDown_connect);b(this._onKeyUp_connect);this._onKeyDown_connect=this._onKeyUp_connect=null;this._fire("onMouseOut",this._processEvent(a))},_onMouseMoveHandler:function(a){this._dragEnd?this._dragEnd=!1:this._fire("onMouseMove",this._processEvent(a))},_onMouseDownHandler:function(c){b(this._onMouseMoveHandler_connect);
this._onMouseMoveHandler_connect=null;this.node.setCapture&&this.node.setCapture(!1);b(this._onMouseDragHandler_connect);this._onMouseDragHandler_connect=a(document,"onmousemove",this,this._onMouseDragHandler);this._startX=c.pageX;this._startY=c.pageY;this._fire("onMouseDown",this._processEvent(c))},_onMouseUpHandler:function(c){var d=this.node;d.releaseCapture&&d.releaseCapture();b(this._onMouseDragHandler_connect);this._onMouseDragHandler_connect=null;b(this._onMouseMoveHandler_connect);this._onMouseMoveHandler_connect=
a(d,"onmousemove",this,this._onMouseMoveHandler);this._fire("onMouseUp",this._processEvent(c))},_onMouseDragHandler:function(c){b(this._onMouseDragHandler_connect);this._onMouseDragHandler_connect=a(document,"onmousemove",this,this._onMouseDraggingHandler);b(this._onMouseUpHandler_connect);this._onMouseUpHandler_connect=a(document,"onmouseup",this,this._onDragMouseUpHandler);this._docLeaveConnect=a(document,"onmouseout",this,this._onDocMouseOut);this._fire("onMouseDragStart",this._processEvent(c))},
_onMouseDraggingHandler:function(a){l.stop(a);this._fire("onMouseDrag",this._processEvent(a))},_onDragMouseUpHandler:function(c){var d=this.node;d.releaseCapture&&d.releaseCapture();this._dragEnd=!0;b(this._docLeaveConnect);b(this._onMouseDragHandler_connect);b(this._onMouseUpHandler_connect);this._docLeaveConnect=this._onMouseDragHandler_connect=null;this._onMouseMoveHandler_connect=a(d,"onmousemove",this,this._onMouseMoveHandler);this._onMouseUpHandler_connect=a(d,"onmouseup",this,this._onMouseUpHandler);
c=this._processEvent(c);this._fire("onMouseDragEnd",c);this._fire("onMouseUp",c)},_onDocMouseOut:function(a){var b=9>q("ie")?a.toElement:a.relatedTarget,c=b&&b.nodeName.toLowerCase();(!b||(q("chrome")||q("safari"))&&"html"===c)&&this._onDragMouseUpHandler(a)},_onClickHandler:function(a){a=this._processEvent(a);if(a.pageX===this._startX&&a.pageY===this._startY){clearTimeout(this._clickTimer);var b={},c="movementX"in a,d;for(d in a)if(!c||"webkitMovementX"!==d&&"webkitMovementY"!==d)b[d]=a[d];this._clickEvent=
b;this._clickTimer=setTimeout(this._fireClickEvent,this.doubleClickDuration)}},_fireClickEvent:function(){clearTimeout(this._clickTimer);9>q("ie")&&(this._clickEvent.graphic=h._ieGraphic,delete h._ieGraphic);this._fire("onClick",this._clickEvent)},_onDblClickHandler:function(a){clearTimeout(this._clickTimer);this._fire("onDblClick",this._processEvent(a))},_onMouseWheelHandler:function(a){var b=this.map;(b?b.isScrollWheelZoom||b.isScrollWheelPan:this.preventPageScroll)&&l.stop(a);var b=q("ff")||q("mozilla")?
-a.detail/this.mozWheelDivisor:a.wheelDelta/this.wheelDivisor,c=Math.abs(b),c=c<=this.minWheelValue?this.minWheelValue:this.maxWheelValue;a.value=0>b?-c:c;this._fire("onMouseWheel",this._processEvent(a))},_onKeyDownHandler:function(a){this._fire("onKeyDown",a)},_onKeyUpHandler:function(a){this._fire("onKeyUp",a)},enableMouseWheel:function(c){b(this._scrollHandle);this._scrollHandle=a(this.node,q("ff")||q("mozilla")?c?"MozMousePixelScroll":"DOMMouseScroll":"onmousewheel",this,this._onMouseWheelHandler)},
setImmediateClick:function(a){this.doubleClickDuration=a?0:this._initialDuration},preventClickEvents:function(a){this._preventClick=a},destroy:function(){var a=this._handles.concat([this._onMouseMoveHandler_connect,this._onMouseUpHandler_connect,this._onMouseDragHandler_connect,this._scrollHandle,this._onKeyDown_connect,this._onKeyUp_connect,this._docLeaveConnect]),c;for(c=0;c<a.length;c++)b(a[c]);clearTimeout(this._clickTimer);this.node=this.map=this._handles=this._clickEvent=this._onMouseMoveHandler_connect=
this._onMouseUpHandler_connect=this._onMouseDragHandler_connect=this._scrollHandle=this._onKeyDown_connect=this._onKeyUp_connect=this._docLeaveConnect=null}})})},"esri/TouchEvents":function(){define("dojo/_base/declare dojo/_base/html dojo/_base/lang dojo/_base/sniff dojo/dom ./kernel ./Evented ./geometry/Point ./geometry/ScreenPoint".split(" "),function(k,e,p,q,n,l,h,f,d){return k([h],{declaredClass:"esri.TouchEvents",tapRadius:8,doubleTapRadius:10,tapStartTolerance:50,doubleTapDuration:300,map:null,
constructor:function(c,a){this.node=c;p.mixin(this,a);e.setSelectable(c,!1);this._touchStart=p.hitch(this,this._touchStart);this._touchMove=p.hitch(this,this._touchMove);this._touchEnd=p.hitch(this,this._touchEnd);this._touchCancel=p.hitch(this,this._touchCancel);this._fireClickEvent=p.hitch(this,this._fireClickEvent);c.addEventListener("touchstart",this._touchStart,!1);c.addEventListener("touchmove",this._touchMove,!1);c.addEventListener("touchend",this._touchEnd,!1);c.addEventListener("touchcancel",
this._touchCancel,!1);this.map&&q("ios")&&(this._mouseOver=p.hitch(this,this._mouseOver),this._mouseOut=p.hitch(this,this._mouseOut),this._mouseDown=p.hitch(this,this._mouseDown),this._mouseUp=p.hitch(this,this._mouseUp),this._mouseClick=p.hitch(this,this._mouseClick),c.addEventListener("mouseover",this._mouseOver,!1),c.addEventListener("mouseout",this._mouseOut,!1),c.addEventListener("mousedown",this._mouseDown,!1),c.addEventListener("mouseup",this._mouseUp,!1),c.addEventListener("click",this._mouseClick,
!1));this._numTouches=0;this._nodeTouches=[];this._touches={};this._touchIds=[];this._taps=[];this._immediate=!1},_touchStart:function(c){var a=this._touches,b,d=c.changedTouches.length,f,m,r,t,h=(new Date).getTime();this._touchStartTS=h;if(!(q("android")&&q("safari")&&1===c.targetTouches.length&&c.touches.length===c.targetTouches.length&&c.targetTouches.length===c.changedTouches.length&&0===c.changedTouches[0].identifier&&a[c.changedTouches[0].identifier])){this._addTouch(c);for(b=0;b<d;b++)f=c.changedTouches[b],
m=a[f.identifier]={},m.startX=f.pageX,m.startY=f.pageY,m.startTS=h,-1===this._touchIds.indexOf(f.identifier)&&this._touchIds.push(f.identifier);this._swipeActive&&(r=this._nodeTouches[0]);this._pinchActive&&(t=this._nodeTouches[1]);1===this._numTouches?this._swipeActive?(this._swipeActive=!1,this._fire("onSwipeEnd",this._processTouchEvent(c,r))):this._pinchActive&&(this._pinchActive=!1,this._fire("onPinchEnd",this._processTouchEvent(c,[r,t]))):2===this._numTouches?this._swipeActive&&(r&&(m=a[this._touchIds[0]],
m.startX=r.pageX,m.startY=r.pageY,m.moved=!1),this._swipeActive=!1,this._fire("onSwipeEnd",this._processTouchEvent(c,r))):this._swipeActive?(this._swipeActive=!1,this._fire("onSwipeEnd",this._processTouchEvent(c,r))):this._pinchActive&&(this._pinchActive=!1,this._fire("onPinchEnd",this._processTouchEvent(c,[r,t])))}},_touchMove:function(c){c.preventDefault();this._updateTouch(c);var a=this._touches,b,d=c.changedTouches.length,f,m,r,t;if(!(q("android")&&q("safari")&&1===c.targetTouches.length&&c.touches.length===
c.targetTouches.length&&c.targetTouches.length===c.changedTouches.length&&0===c.changedTouches[0].identifier&&a[c.changedTouches[0].identifier]&&1<this._touchIds.length)){for(b=0;b<d;b++)if(f=c.changedTouches[b],m=a[f.identifier])r=Math.abs(f.pageX-m.startX),f=Math.abs(f.pageY-m.startY),!m.moved&&(r>=this.tapRadius||f>=this.tapRadius)&&(m.moved=m.absMoved=!0),t=t?t:m.moved;1===this._numTouches?(a=c.changedTouches[0],this._swipeActive?this._fire("onSwipeMove",this._processTouchEvent(c,a)):t&&(this._swipeActive=
!0,this._fire("onSwipeStart",this._processTouchEvent(c,a)))):2===this._numTouches&&(b=this._nodeTouches[0],d=this._nodeTouches[1],this._pinchActive?this._fire("onPinchMove",this._processTouchEvent(c,[b,d])):t&&(t=a[b.identifier],m=a[d.identifier],a=Math.abs(t.startX-m.startX),t=Math.abs(t.startY-m.startY),m=Math.abs(b.pageX-d.pageX),r=Math.abs(b.pageY-d.pageY),Math.abs(Math.sqrt(m*m+r*r)-Math.sqrt(a*a+t*t))>=2*this.tapRadius&&(this._pinchActive=!0,this._fire("onPinchStart",this._processTouchEvent(c,
[b,d])))))}},_touchEnd:function(c){this._removeTouch(c);var a=this._touches,b=c.changedTouches,d,f=b.length,m,r,t=(new Date).getTime(),h=this._touchIds;for(d=0;d<f;d++)if(r=a[b[d].identifier])r.absMoved&&(m=!0),r.pageX=b[d].pageX,r.pageY=b[d].pageY,r.endTS=t;if(0===this._numTouches)if(this._touches={},this._touchIds=[],this._swipeActive)this._swipeActive=!1,this._fire("onSwipeEnd",this._processTouchEvent(c,b[0]));else if(this._pinchActive)this._pinchActive=!1,this._fire("onPinchEnd",this._processTouchEvent(c,
b));else{if(!m){f=Infinity;m=-Infinity;var t=Infinity,l=-Infinity,n=this.tapStartTolerance,e=[],k=!0;for(d=0;d<h.length;d++)r=a[h[d]],e.push(r),r.startTS<f&&(f=r.startTS),r.startTS>m&&(m=r.startTS),r.endTS<t&&(t=r.endTS),r.endTS>l&&(l=r.endTS),delete a[h[d]];1===e.length&&b[0]&&(a=Math.abs(b[0].pageY-e[0].startY),Math.abs(b[0].pageX-e[0].startX)>=this.tapRadius||a>=this.tapRadius)&&(k=!1);k&&Math.abs(m-f)<=n&&Math.abs(l-t)<=n&&this._basicTap(c,e)}}else 1===this._numTouches&&this._pinchActive&&(d=
this._nodeTouches[0],r=a[d.identifier],r.startX=d.pageX,r.startY=d.pageY,this._pinchActive=r.moved=!1,this._fire("onPinchEnd",this._processTouchEvent(c,[b[0],d])))},_touchCancel:function(c){this._numTouches&&this._touchEnd(c)},_basicTap:function(c,a){var b=(new Date).getTime(),d=this;c=this._processTouchEvent(c,a);this._taps.push({touchInfos:a,ts:b,event:c});2<this._taps.length&&this._taps.shift();this._fire("onBasicTap",c);clearTimeout(this._tapTimer);this._immediate?this._analyzeTap(!0):this._tapTimer=
setTimeout(function(){var a=d;d=null;clearTimeout(a._tapTimer);a._analyzeTap()},2===this._taps.length?this.doubleTapDuration/2:this.doubleTapDuration)},_analyzeTap:function(c){var a=this._taps,b=a[0],d=a[1],f=b.touchInfos,m=d&&d.touchInfos;a.length&&(c||(this._taps=[]),b&&d?f.length===m.length?d.ts-b.ts<=this.doubleTapDuration?(1===f.length?(c=Math.abs(f[0].startX-m[0].startX),f=Math.abs(f[0].startY-m[0].startY),f=c<=this.doubleTapRadius&&f<=this.doubleTapRadius):f=!0,f?this._processedDoubleTap(a):
this._processedTap(d)):this._processedTap(d):this._processedTap(d):this._processedTap(b||d))},_processedTap:function(c){var a=c.event;this._fire("onProcessedTap",a);1===c.touchInfos.length?this._fire("onTap",this._fixEvent(a)):2===c.touchInfos.length&&this._fire("onTwoFingerTap",a)},_processedDoubleTap:function(c){var a=1===c[1].touchInfos.length,b;a&&(b=[this._fixEvent(c[0].event),this._fixEvent(c[1].event)],b[1].relatedEvents=b);c=[c[0].event,c[1].event];c[1].relatedEvents=c;this._fire("onProcessedDoubleTap",
c[1]);a&&(this._fire("onDoubleTap",b[1]),this._fire("onDblClick",b[1]))},_addTouch:function(c){var a=c.changedTouches,b=this._nodeTouches,d,f,m;this._numTouches+=a.length;for(c=0;c<a.length;c++){f=b.length;m=!1;for(d=0;d<f&&!(m=b[d].identifier===a[c].identifier);d++);m?this._numTouches--:b.push(a[c])}for(c=b.length-1;0<=c;c--)n.isDescendant(b[c].target,document.body)||(b.splice(c,1),this._numTouches--);0>this._numTouches&&(this._numTouches=0)},_removeTouch:function(c){var a=[],b=[],d=c.changedTouches,
f=this._nodeTouches;this._numTouches-=d.length;0>this._numTouches&&(this._numTouches=0);for(c=0;c<d.length;c++)a.push(d[c].identifier);for(c=f.length-1;0<=c;c--)-1!==a.indexOf(f[c].identifier)&&b.push(f.splice(c,1)[0]);return b},_updateTouch:function(c){var a=[],b,d=c.changedTouches,f=this._nodeTouches;for(c=0;c<d.length;c++)a.push(d[c].identifier);for(c=0;c<f.length;c++)b=a.indexOf(f[c].identifier),-1!==b&&f.splice(c,1,d[b])},_mouseOver:function(c){this._fire("onMouseOver",this._processMouseEvent(c))},
_mouseOut:function(c){this._fire("onMouseOut",this._processMouseEvent(c))},_mouseDown:function(c){this._fire("onMouseDown",this._processMouseEvent(c))},_mouseUp:function(c){this._fire("onMouseUp",this._processMouseEvent(c))},_mouseClick:function(c){clearTimeout(this._clickTimer);300<(new Date).getTime()-this._touchStartTS?this._fire("onClick",this._processMouseEvent(c)):(this._clickEvent=c,this._clickTimer=setTimeout(this._fireClickEvent,this.doubleTapDuration))},_fireClickEvent:function(){clearTimeout(this._clickTimer);
this._fire("onClick",this._processMouseEvent(this._clickEvent))},_fire:function(c,a){"onDblClick"===c&&clearTimeout(this._clickTimer);if("onDblClick"===c&&this.mouseEvents){this.mouseEvents.preventClickEvents(!0);var b=this;setTimeout(function(){b.mouseEvents.preventClickEvents(!1)},350)}if(this[c])this[c](a);if(this.map&&this.map[c])this.map[c](a)},_fixEvent:function(c){var a={},b;for(b in c)a[b]=c[b];this.map&&(a.screenPoint=a.screenPoints[0],a.mapPoint=a.mapPoints[0]);return a},_processTouchEvent:function(c,
a){var b=this.map,g=b&&b.position,h=0;if(g&&a)if(p.isArray(a)){var m,r;c.screenPoints=[];c.mapPoints=[];for(m=0;m<a.length;m++)a[m]?(r=new d(a[m].pageX-g.x,a[m].pageY-g.y),c.screenPoints.push(r),c.mapPoints.push(b.extent?b.toMap(r):new f)):h++}else c.screenPoint=new d(a.pageX-g.x,a.pageY-g.y),c.mapPoint=b.extent?b.toMap(c.screenPoint):new f;c.numPoints=a?p.isArray(a)?a.length-h:1:0;return c},_processMouseEvent:function(c){var a=this.map,b=a&&a.position;b&&(c.screenPoint=new d(c.pageX-b.x,c.pageY-
b.y),c.mapPoint=a.extent?a.toMap(c.screenPoint):new f);return c},setImmediateTap:function(c){this._immediate=c},destroy:function(){var c=this.node;c.removeEventListener("touchstart",this._touchStart,!1);c.removeEventListener("touchmove",this._touchMove,!1);c.removeEventListener("touchend",this._touchEnd,!1);c.removeEventListener("touchcancel",this._touchCancel,!1);this.map&&(c.removeEventListener("mouseover",this._mouseOver,!1),c.removeEventListener("mouseout",this._mouseOut,!1),c.removeEventListener("mousedown",
this._mouseDown,!1),c.removeEventListener("mouseup",this._mouseUp,!1),c.removeEventListener("click",this._mouseClick,!1));e.setSelectable(c,!0);clearTimeout(this._tapTimer);clearTimeout(this._clickTimer);this.node=this.map=this._numTouches=this._nodeTouches=this._touches=this._touchIds=this._taps=null}})})},"esri/PointerEvents":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has ./kernel ./Evented ./geometry/Point ./geometry/ScreenPoint".split(" "),function(k,e,p,q,n,l,
h,f){return k([l],{declaredClass:"esri.PointerEvents",tapRadius:8,clickRadius:2,doubleTapRadius:10,tapStartTolerance:50,doubleTapDuration:300,minWheelValue:1,maxWheelValue:1,mozWheelDivisor:-1!==q("mac")?1:3,wheelDivisor:120,preventPageScroll:!0,_dragging:!1,constructor:function(d,c){this.node=d;e.mixin(this,c);void 0!==d.style.msTouchAction?d.style.msTouchAction="none":void 0!==d.style.touchAction&&(d.style.touchAction="none");c=navigator.msPointerEnabled;var a=function(a){a.preventDefault()};d.addEventListener("selectstart",
a,!1);d.addEventListener("dragstart",a,!1);this._pointerDown=e.hitch(this,this._pointerDown);this._pointerMove=e.hitch(this,this._pointerMove);this._pointerUp=e.hitch(this,this._pointerUp);this._pointerCancel=e.hitch(this,this._pointerCancel);d.addEventListener(c?"MSPointerDown":"pointerdown",this._pointerDown,!1);d.addEventListener(c?"MSPointerMove":"pointermove",this._pointerMove,!1);d.addEventListener(c?"MSPointerUp":"pointerup",this._pointerUp,!1);d.addEventListener(c?"MSPointerCancel":"pointercancel",
this._pointerCancel,!1);this.map&&(this._mouseOver=e.hitch(this,this._mouseOver),this._mouseOut=e.hitch(this,this._mouseOut),this._mouseLeave=e.hitch(this,this._mouseLeave),this._mouseDown=e.hitch(this,this._mouseDown),this._mouseUp=e.hitch(this,this._mouseUp),this._mouseClick=e.hitch(this,this._mouseClick),this._mouseWheel=e.hitch(this,this._mouseWheel),this._mouseMove=e.hitch(this,this._mouseMove),this._mouseEnter=e.hitch(this,this._mouseEnter),this._onKeyDown=e.hitch(this,this._onKeyDown),this._onKeyUp=
e.hitch(this,this._onKeyUp),d.addEventListener("mouseover",this._mouseOver,!1),d.addEventListener("mouseout",this._mouseOut,!1),d.addEventListener("mouseleave",this._mouseLeave,!1),d.addEventListener("mousedown",this._mouseDown,!1),d.addEventListener("mouseup",this._mouseUp,!1),d.addEventListener("click",this._mouseClick,!1),d.addEventListener("mousewheel",this._mouseWheel,!1),d.addEventListener("mousemove",this._mouseMove,!1),d.addEventListener("mouseenter",this._mouseEnter,!1));this._numTouches=
0;this._touches={};this._touchIds=[];this._taps=[];this._immediate=!1},_pointerDown:function(d){if(-1<p.indexOf(this._touchIds,d.pointerId))this._pointerUp(d);else{var c=this._touches,a=d.target,b=d.pointerId,g=this._touchIds,f,m=(new Date).getTime();f=c[b]={};f.pointerId=b;f.startX=f.pageX=d.pageX;f.startY=f.pageY=d.pageY;f.startTS=m;g.push(b);this._numTouches++;a.setPointerCapture?a.setPointerCapture(b):a.msSetPointerCapture&&a.msSetPointerCapture(b);a=c[g[0]];c=c[g[1]];1!==this._numTouches&&(2===
this._numTouches?this._swipeActive&&(a&&(a.startX=a.pageX,a.startY=a.pageY,a.moved=!1),this._swipeActive=!1,this._fire("onSwipeEnd",this._processTouchEvent(d,a))):this._swipeActive?(this._swipeActive=!1,this._fire("onSwipeEnd",this._processTouchEvent(d,a))):this._pinchActive&&(this._pinchActive=!1,this._fire("onPinchEnd",this._processTouchEvent(d,[a,c]))))}},_pointerMove:function(d){var c=this._touches,a=this._touchIds,b,g,f;if((b=c[d.pointerId])&&(b.pageX!==d.pageX||b.pageY!==d.pageY))if(b.pageX=
d.pageX,b.pageY=d.pageY,g=Math.abs(b.pageX-b.startX),f=Math.abs(b.pageY-b.startY),!b.moved&&(g>=this.tapRadius||f>=this.tapRadius)&&(b.moved=b.absMoved=!0),1===this._numTouches)this._swipeActive?this._fire("onSwipeMove",this._processTouchEvent(d,d)):b.moved&&(this._swipeActive=!0,this._fire("onSwipeStart",this._processTouchEvent(d,d)));else if(2===this._numTouches)if(b=c[a[0]],c=c[a[1]],this._pinchActive)this._fire("onPinchMove",this._processTouchEvent(d,[b,c]));else if(b.moved||c.moved){a=Math.abs(b.startX-
c.startX);g=Math.abs(b.startY-c.startY);f=Math.abs(b.pageX-c.pageX);var m=Math.abs(b.pageY-c.pageY);Math.abs(Math.sqrt(f*f+m*m)-Math.sqrt(a*a+g*g))>=2*this.tapRadius&&(this._pinchActive=!0,this._fire("onPinchStart",this._processTouchEvent(d,[b,c])))}},_pointerUp:function(d){var c=this._touches,a,b=this.node,g=d.target,f=d.pointerId,m=this._touchIds,r=m.slice(0),t=p.map(r,function(a){return c[a]}),h=(new Date).getTime();if(a=c[f])if(a.pageX=d.pageX,a.pageY=d.pageY,a.endTS=h,this._numTouches--,g.releasePointerCapture?
g.releasePointerCapture(f):g.msReleasePointerCapture&&g.msReleasePointerCapture(f),0===this._numTouches)if(this._touches={},this._touchIds=[],this._swipeActive)this._swipeActive=!1,this._fire("onSwipeEnd",this._processTouchEvent(d,d));else if(this._pinchActive)this._pinchActive=!1,this._fire("onPinchEnd",this._processTouchEvent(d,d));else{if(!a.absMoved){var g=Infinity,f=-Infinity,m=Infinity,h=-Infinity,l=this.tapStartTolerance,n;for(n=0;n<r.length;n++)a=t[n],a.startTS<g&&(g=a.startTS),a.startTS>
f&&(f=a.startTS),a.endTS<m&&(m=a.endTS),a.endTS>h&&(h=a.endTS);Math.abs(f-g)<=l&&Math.abs(h-m)<=l&&this._basicTap(d,t)}}else 1===this._numTouches&&this._pinchActive&&(m.splice(p.indexOf(m,d.pointerId),1),delete c[d.pointerId],a=c[m[0]],a.startX=a.pageX,a.startY=a.pageY,a.moved=!1,document.msElementsFromPoint&&(r=document.msElementsFromPoint(a.pageX,a.pageY),p.some(r,function(a){return a===b})||(this._touches={},this._touchIds=[],this._numTouches=0)),this._pinchActive=!1,this._fire("onPinchEnd",this._processTouchEvent(d,
[d,a])))},_pointerCancel:function(d){this._numTouches&&this._pointerUp(d)},_basicTap:function(d,c){var a=(new Date).getTime(),b=this,g=this._immediate;d=this._processTouchEvent(d,c);this._taps.push({touchInfos:c,ts:a,event:d});2<this._taps.length&&this._taps.shift();this._fire("onBasicTap",d);clearTimeout(this._tapTimer);d=2===this._taps.length?this.doubleTapDuration/2:this.doubleTapDuration;this._tapTimer=setTimeout(function(){var a=b;b=null;clearTimeout(a._tapTimer);a._analyzeTap(g)},g?0:d)},_analyzeTap:function(d){var c=
this._taps,a=c[0],b=c[1],g=a.touchInfos,f=b&&b.touchInfos;c.length&&(d||(this._taps=[]),a&&b?g.length===f.length?b.ts-a.ts<=this.doubleTapDuration?(1===g.length?(d=Math.abs(g[0].startX-f[0].startX),g=Math.abs(g[0].startY-f[0].startY),g=d<=this.doubleTapRadius&&g<=this.doubleTapRadius):g=!0,g?this._processedDoubleTap(c):this._processedTap(b)):this._processedTap(b):this._processedTap(b):this._processedTap(a||b))},_processedTap:function(d){var c=d.event;this._fire("onProcessedTap",c);1===d.touchInfos.length?
this._fire("onTap",this._fixEvent(c)):2===d.touchInfos.length&&this._fire("onTwoFingerTap",c)},_processedDoubleTap:function(d){var c=1===d[1].touchInfos.length,a;c&&(a=[this._fixEvent(d[0].event),this._fixEvent(d[1].event)],a[1].relatedEvents=a);d=[d[0].event,d[1].event];d[1].relatedEvents=d;this._fire("onProcessedDoubleTap",d[1]);c&&(this._fire("onDoubleTap",a[1]),this._fire("onDblClick",a[1]))},_mouseOver:function(d){this._fire("onMouseOver",this._processMouseEvent(d))},_mouseMove:function(d){this._dragging?
this._fire("onMouseDrag",this._processMouseEvent(d)):this._fire("onMouseMove",this._processMouseEvent(d))},_mouseOut:function(d){this._fire("onMouseOut",this._processMouseEvent(d))},_mouseLeave:function(d){document.removeEventListener("keydown",this._onKeyDown,!1);document.removeEventListener("keyup",this._onKeyUp,!1);this._fire("onMouseOut",this._processMouseEvent(event))},_mouseDown:function(d){this._downX=d.pageX;this._downY=d.pageY;this._fire("onMouseDown",this._processMouseEvent(d));0===d.button&&
(this._dragging=!0,this._fire("onMouseDragStart",this._processMouseEvent(d)))},_mouseUp:function(d){this._dragging&&(this._dragging=!1,this._fire("onMouseDragEnd",this._processMouseEvent(d)));this._fire("onMouseUp",this._processMouseEvent(d))},_mouseClick:function(d){Math.abs(d.pageX-this._downX)<=this.clickRadius&&Math.abs(d.pageY-this._downY)<=this.clickRadius&&this._fire("onClick",this._processMouseEvent(d))},_mouseWheel:function(d){var c=this.map;(c?c.isScrollWheelZoom||c.isScrollWheelPan:this.preventPageScroll)&&
d.preventDefault();var c=d.wheelDelta?d.wheelDelta/this.wheelDivisor:-d.detail/this.mozWheelDivisor,a=Math.abs(c),a=a<=this.minWheelValue?this.minWheelValue:this.maxWheelValue;d.value=0>c?-a:a;this._fire("onMouseWheel",this._processMouseEvent(d))},_mouseEnter:function(d){document.removeEventListener("keydown",this._onKeyDown,!1);document.removeEventListener("keyup",this._onKeyUp,!1);document.addEventListener("keydown",this._onKeyDown,!1);document.addEventListener("keyup",this._onKeyUp,!1);this._fire("onMouseEnter",
this._processMouseEvent(d))},_onKeyDown:function(d){this._fire("onKeyDown",d)},_onKeyUp:function(d){this._fire("onKeyUp",d)},_fire:function(d,c){if(this[d])this[d](c);if(this.map&&this.map[d])this.map[d](c)},_fixEvent:function(d){var c={},a;for(a in d)c[a]=d[a];c.preventDefault=function(){d.preventDefault()};c.stopPropagation=function(){d.stopPropagation()};this.map&&(c.screenPoint=c.screenPoints[0],c.mapPoint=c.mapPoints[0]);return c},_processTouchEvent:function(d,c){var a=this.map,b=a&&a.position,
g=0;if(b&&c)if(e.isArray(c)){var l,m;d.screenPoints=[];d.mapPoints=[];for(l=0;l<c.length;l++)c[l]?(m=new f(c[l].pageX-b.x,c[l].pageY-b.y),d.screenPoints.push(m),d.mapPoints.push(a.extent?a.toMap(m):new h)):g++}else d.screenPoint=new f(c.pageX-b.x,c.pageY-b.y),d.mapPoint=a.extent?a.toMap(d.screenPoint):new h;d.numPoints=c?e.isArray(c)?c.length-g:1:0;return d},_processMouseEvent:function(d){var c=this.map,a=c&&c.position;a&&(d.screenPoint=new f(d.pageX-a.x,d.pageY-a.y),d.mapPoint=c.extent?c.toMap(d.screenPoint):
new h);return d},setImmediateTap:function(d){this._immediate=d},destroy:function(){var d=this.node;d.removeEventListener("MSPointerDown",this._pointerDown,!1);d.removeEventListener("MSPointerMove",this._pointerMove,!1);d.removeEventListener("MSPointerUp",this._pointerUp,!1);d.removeEventListener("MSPointerCancel",this._pointerCancel,!1);this.map&&(d.removeEventListener("mouseover",this._mouseOver,!1),d.removeEventListener("mousemove",this._mouseMove,!1),d.removeEventListener("mouseout",this._mouseOut,
!1),d.removeEventListener("mouseleave",this._mouseLeave,!1),d.removeEventListener("mousedown",this._mouseDown,!1),d.removeEventListener("mouseup",this._mouseUp,!1),d.removeEventListener("click",this._mouseClick,!1),d.removeEventListener("mouseenter",this._mouseEnter,!1));clearTimeout(this._tapTimer);this.node=this.map=this._numTouches=this._touches=this._touchIds=this._taps=null}})})},"esri/renderers/jsonUtils":function(){define("dojo/_base/array dojo/_base/lang dojo/has dojox/gfx/_base ../kernel ../Color ../symbols/jsonUtils ./SimpleRenderer ./UniqueValueRenderer ./ClassBreaksRenderer ./VectorFieldRenderer ./DotDensityRenderer ./ScaleDependentRenderer ./TimeClassBreaksAger ./TimeRampAger ./TemporalRenderer ./HeatmapRenderer ./StretchRenderer".split(" "),
function(k,e,p,q,n,l,h,f,d,c,a,b,g,u,m,r,t,v){return{fromJson:function(b){var g;switch(b.type||""){case "simple":g=new f(b);break;case "uniqueValue":g=new d(b);break;case "classBreaks":g=new c(b);break;case "vectorField":g=new a(b);break;case "scaleDependent":g=this._scaleDependentFromJson(b);break;case "dotDensity":g=this._dotDensityFromJson(b);break;case "temporal":g=this._temporalFromJson(b);break;case "heatmap":g=this._heatmapFromJson(b);break;case "rasterStretch":g=new v(b)}return g},_scaleDependentFromJson:function(a){var b=
{},c=a.minScale;b.rendererInfos=k.map(a.rendererInfos,function(a){var b=a.maxScale;a={minScale:c,maxScale:b,renderer:a.renderer&&this.fromJson(a.renderer)};c=b;return a},this);return new g(b)},_dotDensityFromJson:function(a){a.backgroundColor&&e.isArray(a.backgroundColor)&&(a.backgroundColor=l.toDojoColor(a.backgroundColor));0<a.dotSize&&(a.dotSize=q.pt2px(a.dotSize));a.fields&&k.forEach(a.fields,function(a){a&&e.isArray(a.color)&&(a.color=l.toDojoColor(a.color))});a.legendOptions&&(a.legendOptions.backgroundColor&&
e.isArray(a.legendOptions.backgroundColor)&&(a.legendOptions.backgroundColor=l.toDojoColor(a.legendOptions.backgroundColor)),a.legendOptions.outline&&(a.legendOptions.outline=h.fromJson(a.legendOptions.outline)));a.outline&&(a.outline=h.fromJson(a.outline));return new b(a)},_temporalFromJson:function(a){var b,c,d;a=a||{};b=this.fromJson(a.observationRenderer);c=a.latestObservationRenderer?this.fromJson(a.latestObservationRenderer):null;d=a.trackRenderer?this.fromJson(a.trackRenderer):null;a=this._agerFromJson(a.observationAger);
return new r(b,c,d,a)},_agerFromJson:function(a){var b;a=a||{};a.colorRange||a.sizeRange||a.alphaRange?b=this._timeRampFromJson(a):a.agerClassBreakInfos&&(b=this._timeClassBreaksFromJson(a));return b},_timeRampFromJson:function(a){var b,c,d;a.colorRange&&1<a.colorRange.length&&(b=[l.toDojoColor(a.colorRange[0]),l.toDojoColor(a.colorRange[1])]);a.sizeRange&&1<a.sizeRange.length&&(c=[a.sizeRange[0],a.sizeRange[1]]);a.alphaRange&&1<a.alphaRange.length&&(d=[a.alphaRange[0]/255,a.alphaRange[1]/255]);return new m(b,
c,d)},_timeClassBreaksFromJson:function(a){var b=a.agerClassBreakInfos,c,d,g=[],m;c=u.UNIT_DAYS;switch(a.timeUnits){case "esriTimeUnitsSeconds":c=u.UNIT_SECONDS;break;case "esriTimeUnitsMilliseconds":c=u.UNIT_MILLISECONDS;break;case "esriTimeUnitsHours":c=u.UNIT_HOURS;break;case "esriTimeUnitsMinutes":c=u.UNIT_MINUTES;break;case "esriTimeUnitsMonths":c=u.UNIT_MONTHS;break;case "esriTimeUnitsWeeks":c=u.UNIT_WEEKS;break;case "esriTimeUnitsYears":c=u.UNIT_YEARS}for(m=0;m<b.length;m+=1)a=b[m],d={minAge:0,
maxAge:a.oldestAge||Infinity},a.color&&(d.color=l.toDojoColor(a.color)),a.alpha&&(d.alpha=a.alpha/255),d.size=a.size,g[m]=d;return new u(g,c)},_heatmapFromJson:function(a){var b=a.colorStops;b&&b instanceof Array&&k.forEach(b,function(a){a.color=l.toDojoColor(a.color)});return new t(a)}}})},"esri/renderers/SimpleRenderer":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../lang ../symbols/jsonUtils ./Renderer".split(" "),function(k,e,p,q,n,l,h){return k(h,{declaredClass:"esri.renderer.SimpleRenderer",
constructor:function(f){if(f&&!f.declaredClass){var d=f;this.symbol=(f=d.symbol)&&(f.declaredClass?f:l.fromJson(f));this.label=d.label;this.description=d.description}else this.symbol=f},getSymbol:function(f){return this.symbol},toJson:function(){var f=e.mixin(this.inherited(arguments),{type:"simple",label:this.label,description:this.description,symbol:this.symbol&&this.symbol.toJson()});return n.fixJson(f)}})})},"esri/renderers/Renderer":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has dojox/gfx/_base ../kernel ../Color ../layers/support/attributeUtils ../support/expressionUtils".split(" "),
function(k,e,p,q,n,l,h,f,d){var c=Math.PI;return k(null,{declaredClass:"esri.renderer.Renderer",constructor:function(a){this._cache={};if(a&&!a.declaredClass){this.rotationInfo=a.rotationInfo;if(!this.rotationInfo){var b=a.rotationType,c=a.rotationExpression;if(b||c)this.rotationInfo={type:b,expression:c}}this.setRotationInfo(this.rotationInfo);this.setSizeInfo(this._readSizeInfo(a.sizeInfo));this.setColorInfo(this._readColorInfo(a.colorInfo));this.setOpacityInfo(this._readOpacityInfo(a.transparencyInfo));
this.setVisualVariables(this._readVariables(a.visualVariables));this.setAuthoringInfo(a.authoringInfo)}this.getSymbol=e.hitch(this,this.getSymbol)},getSymbol:function(a){},_readSizeInfo:function(a){if(a){var b=a.minSize,c=a.maxSize;b&&(a.minSize="number"===typeof b?n.pt2px(b):this._readSizeInfo(b));c&&(a.maxSize="number"===typeof c?n.pt2px(c):this._readSizeInfo(c));a.stops&&p.forEach(a.stops,function(a){a.size&&"number"===typeof a.size&&(a.size=n.pt2px(a.size))})}return a},_readColorInfo:function(a){a&&
(p.forEach(a.colors,function(b,c){e.isArray(b)&&(a.colors[c]=h.toDojoColor(b))}),p.forEach(a.stops,function(b,c){b.color&&e.isArray(b.color)&&(a.stops[c].color=h.toDojoColor(b.color))}));return a},_readOpacityInfo:function(a){var b;a&&(b=e.mixin({},a),b.transparencyValues&&(b.opacityValues=p.map(b.transparencyValues,function(a){return 1-a/100}),delete b.transparencyValues),b.stops&&(b.stops=p.map(b.stops,function(a){a=e.mixin({},a);a.opacity=1-a.transparency/100;delete a.transparency;return a})));
return b},_readVariables:function(a){a&&(a=p.map(a,function(a){"sizeInfo"===a.type?a=this._readSizeInfo(a):"colorInfo"===a.type?a=this._readColorInfo(a):"transparencyInfo"===a.type&&(a=this._readOpacityInfo(a),a.type="opacityInfo");return a},this));return a},setAuthoringInfo:function(a){this.authoringInfo=a},setRotationInfo:function(a){if(a=this.rotationInfo="string"===typeof a?{field:a}:a){if(a.expression&&!e.isFunction(a.expression)&&!a.field){var b=a.expression.match(this.rotationRE);b&&b[1]&&
(a.field=b[1])}a.rotationType=a.type}this._cache.rotationInfo=this._processRotationInfo(a);return this},rotationRE:/^\[([^\]]+)\]$/i,_processRotationInfo:function(a){return this._createCache(a)},getRotationAngle:function(a,b){var c=this._getVarInfo(b&&b.rotationInfo,"rotationInfo");b=c.variable;var c=this._cache[c.cacheKey],d="arithmetic"===this._getRotationType(b),m=c&&c.hasExpr,f=null;if(b.field||m)f=this._getDataValue(a,b,null,c),null!=f&&(f=(f+(d?-90:0))*(d?-1:1));return f},_getRotationType:function(a){return a&&
("rotationInfo"===a.type?a.rotationType:a.type)},_getDataValue:function(a,b,c,f,m){f||(f=this._getVarInfo(b,c),b=f.variable,f=this._cache[f.cacheKey],"sizeInfo"===c&&(f=f.root));return a._getDataValue(b,f,d,m)},setVisualVariables:function(a){var b=this._cache;p.forEach(this.visualVariables,function(a,c){b.hasOwnProperty(c)&&(b[c]=null)},this);this.visualVariables=a;p.some(a,function(a){return!!a.target})&&a.sort(function(a,b){return a.target===b.target?0:a.target?1:-1});p.forEach(a,function(a,c){"colorInfo"===
a.type?b[c]=this._processColorInfo(a):"opacityInfo"===a.type?b[c]=this._processOpacityInfo(a):"sizeInfo"===a.type?b[c]=this._processSizeInfo(a):"rotationInfo"===a.type&&(b[c]=this._processRotationInfo(a))},this);return this},getVisualVariableValues:function(a){var b=this.visualVariables,c;b&&(c=p.map(b,function(b){var c;switch(b.type){case "sizeInfo":c=this.getSize(a,{sizeInfo:b});break;case "colorInfo":c=this.getColor(a,{colorInfo:b});break;case "opacityInfo":c=this.getOpacity(a,{opacityInfo:b});
break;case "rotationInfo":c=this.getRotationAngle(a,{rotationInfo:b})}return{variable:b,value:c}},this));return c},getFieldsUsedInExpressions:function(){var a=[];p.forEach(this._getCacheObjects(),function(b){b.syntaxTree&&(a=a.concat(d.extractFieldNames(b.syntaxTree)))});a.sort();return p.filter(a,function(b,c){return 0===c||a[c-1]!==b})},hasGeometryOperations:function(){return p.some(this._getCacheObjects(),function(a){return a.syntaxTree?d.hasGeometryOperations(a.syntaxTree):!1})},hasVisualVariables:function(a,
b){return a?!!this.getVisualVariablesForType(a,b):!!(this.getVisualVariablesForType("sizeInfo",b)||this.getVisualVariablesForType("colorInfo",b)||this.getVisualVariablesForType("opacityInfo",b)||this.getVisualVariablesForType("rotationInfo",b))},getVisualVariablesForType:function(a,b){var c=this.visualVariables,d;!b&&this[a]?("rotationInfo"===a&&(this[a].rotationType=this[a].type),d=[this[a]]):c&&(d=p.filter(c,function(c){return c.type===a&&("string"===typeof b?c.target===b:!1===b?!c.target:!0)}))&&
0===d.length&&(d=void 0);return d},setSizeInfo:function(a){this.sizeInfo=this.proportionalSymbolInfo=a;this._cache.sizeInfo=this._processSizeInfo(a);return this},_processSizeInfo:function(a){return a&&{root:this._createCache(a),minSize:this._createCache(a.minSize),maxSize:this._createCache(a.maxSize)}},_convertExpressionToArcade:function(a){a&&a.expression&&(a.valueExpression="$view.scale")},_getVarInfo:function(a,b){var c;a&&a.type===b?(c=p.indexOf(this.visualVariables,a),a=this.visualVariables[c]):
(c=b,a=this[b]);return{variable:a,cacheKey:c}},setProportionalSymbolInfo:function(a){this.setSizeInfo(a);return this},getSize:function(a,b){var c=this._getVarInfo(b&&b.sizeInfo,"sizeInfo"),d=c.variable,c=this._cache[c.cacheKey],m=null;if(d)var f=d.minSize,m=d.maxSize,f="object"===typeof f&&f?this._getSize(a,f,c&&c.minSize,b):f,m="object"===typeof m&&m?this._getSize(a,m,c&&c.maxSize,b):m,m=this._getSize(a,d,c&&c.root,b,[f,m]);return m},_getSize:function(a,b,d,f,m){var g=b.stops,t=0,h=d&&d.hasExpr,
l=d&&d.ipData,n=d&&d.isScaleDriven,e="object"===typeof a&&!!a,u="number"===typeof a?a:null;if(b.field||n||h){var k=f&&f.scale,h=m?m[0]:b.minSize;m=m?m[1]:b.maxSize;var p=b.minDataValue,q=b.maxDataValue,E=b.valueUnit||"unknown",D=b.valueRepresentation,F=b.scaleBy,I=f&&f.shape;n?u=k:"number"!==typeof u&&e&&(u=this._getDataValue(a,b,null,d));if(!this._isValidNumber(u))return null;if(g)h=this._lookupData(u,l),u=h[0],m=h[1],u===m?t=g[u].size:(u=g[u].size,g=g[m].size,t=u+(g-u)*h[2]);else if(null!=h&&null!=
m&&null!=p&&null!=q)u<=p?t=h:u>=q?t=m:(g=(u-p)/(q-p),"area"===F&&I?(h=(u="circle"===I)?c*Math.pow(h/2,2):h*h,g=h+g*((u?c*Math.pow(m/2,2):m*m)-h),t=u?2*Math.sqrt(g/c):Math.sqrt(g)):t=h+g*(m-h));else if("unknown"===E)null!=h&&null!=p&&(h&&p?(g=u/p,t="circle"===I?2*Math.sqrt(g*Math.pow(h/2,2)):"square"===I||"diamond"===I||"image"===I?Math.sqrt(g*Math.pow(h,2)):g*h):t=u+(h||p),t=t<h?h:t,null!=m&&t>m&&(t=m));else{g=(f&&f.resolution?f.resolution:1)*this._meterIn[E];if("area"===D)t=Math.sqrt(u/c)/g,t*=2;
else if(t=u/g,"radius"===D||"distance"===D)t*=2;null!=h&&t<h&&(t=h);null!=m&&t>m&&(t=m)}}else t=g&&g[0]&&g[0].size,null==t&&(t=b.minSize);return t=isNaN(t)?0:t},getSizeRangeAtScale:function(a,b){var c;a=this._getVarInfo(a,"sizeInfo");var d=this._cache[a.cacheKey],m={scale:b};if((a=a.variable)&&b){var f=a.minSize;b=a.maxSize;var t=a.stops;t&&t.length?(a=t[0].size,d=t[t.length-1].size):(a="object"===typeof f&&f?this._getSize({},f,d&&d.minSize,m):f,d="object"===typeof b&&b?this._getSize({},b,d&&d.maxSize,
m):b);if(null!=a||null!=d)a>d&&(c=d,d=a,a=c),c={minSize:a,maxSize:d}}return c},setColorInfo:function(a){this.colorInfo=a;this._cache.colorInfo=this._processColorInfo(a);return this},_createCache:function(a,b){if(b=f.createAttributeCache(a,b))b.ipData=this._interpolateData(a);return b},_getCacheObjects:function(a){var b;a=a||this._cache;var c=[];for(b in a){var d=a[b];a.hasOwnProperty(b)&&d&&"object"===typeof d&&(d.hasOwnProperty("idSource")?c.push(d):c=c.concat(this._getCacheObjects(d)))}return c},
_processColorInfo:function(a){a&&(p.forEach(a.colors,function(b,c){e.isArray(b)&&(a.colors[c]=new h(b))}),p.forEach(a.stops,function(b,c){b.color&&e.isArray(b.color)&&(a.stops[c].color=new h(b.color))}));return this._createCache(a)},getColor:function(a,b){b=this._getVarInfo(b&&b.colorInfo,"colorInfo");return this._getColorComponent(a,b.variable,this._cache[b.cacheKey])},setOpacityInfo:function(a){this.opacityInfo=a;this._cache.opacityInfo=this._processOpacityInfo(a);return this},_processOpacityInfo:function(a){return this._createCache(a)},
getOpacity:function(a,b){b=this._getVarInfo(b&&b.opacityInfo,"opacityInfo");return this._getColorComponent(a,b.variable,this._cache[b.cacheKey],!0)},_getColorComponent:function(a,b,c,d,m){var g="number"===typeof a?a:null,f=c&&c.hasExpr,h=c&&c.ipData,l;b&&b.field||f?("number"!==typeof g&&"object"===typeof a&&a&&(g=this._getDataValue(a,b,null,c)),this._isValidNumber(g)||(g=null),null!=g&&(l=d?this._getOpacity(g,b,h):this._getColor(g,b,h))):b&&(a=b.stops,d?(l=a&&a[0]&&a[0].opacity,null==l&&(l=b.opacityValues&&
b.opacityValues[0])):l=a&&a[0]&&a[0].color||b.colors&&b.colors[0]);m&&(m.data=g,m.value=l);return m||l},_isValidNumber:function(a){return"number"===typeof a&&!isNaN(a)&&Infinity!==a&&-Infinity!==a},_interpolateData:function(a){var b;if(a)if(a.colors||a.opacityValues){var c=(a.colors||a.opacityValues).length,d=a.minDataValue,m=(a.maxDataValue-d)/(c-1);b=[];for(a=0;a<c;a++)b[a]=d+a*m}else a.stops&&(b=p.map(a.stops,function(a){return a.value}));return b},_getOpacity:function(a,b,c){a=this._lookupData(a,
c);var d;b=b||this.opacityInfo;a&&(c=a[0],d=a[1],c===d?d=this._getOpacValue(b,c):(c=this._getOpacValue(b,c),b=this._getOpacValue(b,d),d=c+(b-c)*a[2]));return d},_getOpacValue:function(a,b){return a.opacityValues?a.opacityValues[b]:a.stops[b].opacity},_getColor:function(a,b,c){a=this._lookupData(a,c);var d;b=b||this.colorInfo;a&&(d=a[0],c=a[1],d=d===c?this._getColorObj(b,d):h.blendColors(this._getColorObj(b,d),this._getColorObj(b,c),a[2]));return d},_getColorObj:function(a,b){return a.colors?a.colors[b]:
a.stops[b].color},_lookupData:function(a,b){var c;if(b){var d=0,m=b.length-1;p.some(b,function(b,c){if(a<b)return m=c,!0;d=c;return!1});c=[d,m,(a-b[d])/(b[m]-b[d])]}return c},_meterIn:{inches:1/.0254,feet:1/.3048,yards:1/.9144,miles:1/1609.344,"nautical-miles":1/1852,millimeters:1E3,centimeters:100,decimeters:10,meters:1,kilometers:.001,"decimal-degrees":180/20015077},_writeSizeInfo:function(a){if(a){a=e.mixin({},a);this._convertExpressionToArcade(a);var b=a.minSize,c=a.maxSize;b&&(a.minSize="number"===
typeof b?n.px2pt(b):this._writeSizeInfo(b));c&&(a.maxSize="number"===typeof c?n.px2pt(c):this._writeSizeInfo(c));if(b=a.legendOptions)if(a.legendOptions=e.mixin({},b),b=b.customValues)a.legendOptions.customValues=b.slice(0);a.stops&&(a.stops=p.map(a.stops,function(a){a=e.mixin({},a);a.size&&"number"===typeof a.size&&(a.size=n.px2pt(a.size));return a}))}return a},_writeColorInfo:function(a){a&&(a=e.mixin({},a),a.colors&&(a.colors=p.map(a.colors,function(a){return h.toJsonColor(a)})),a.stops&&(a.stops=
p.map(a.stops,function(a){a=e.mixin({},a);a.color&&(a.color=h.toJsonColor(a.color));return a})),a.legendOptions&&(a.legendOptions=e.mixin({},a.legendOptions)));return a},_writeOpacityInfo:function(a){var b;a&&(b=e.mixin({},a),b.opacityValues&&(b.transparencyValues=p.map(b.opacityValues,function(a){return 100*(1-a)}),delete b.opacityValues),b.stops&&(b.stops=p.map(b.stops,function(a){a=e.mixin({},a);a.transparency=100*(1-a.opacity);delete a.opacity;return a})),b.legendOptions&&(b.legendOptions=e.mixin({},
b.legendOptions)));return b},toJson:function(a){var b=this.visualVariables,c=e.clone(this.authoringInfo),d=a&&a.useLegacyRotationProperties,m=(a=(a=this.getVisualVariablesForType("rotationInfo",!1))&&a[0])&&a.field,f;a&&(a===this.rotationInfo||d)&&(f=a.expression||m&&(e.isFunction(m)?m:"["+m+"]"));b&&(b=p.map(b,function(a){"sizeInfo"===a.type?a=this._writeSizeInfo(a):"colorInfo"===a.type?a=this._writeColorInfo(a):"opacityInfo"===a.type?(a=this._writeOpacityInfo(a),a.type="transparencyInfo"):"rotationInfo"===
a.type&&(a=d?null:e.mixin({},a));return a},this),b=p.filter(b,function(a){return null!=a}));c&&p.forEach(c.visualVariables,function(a){"opacityInfo"===a.type&&(a.type="transparencyInfo")});return{rotationType:f&&(this._getRotationType(a)||"geographic"),rotationExpression:f,colorInfo:this._writeColorInfo(this.colorInfo),transparencyInfo:this._writeOpacityInfo(this.opacityInfo),sizeInfo:this._writeSizeInfo(this.sizeInfo),visualVariables:b,authoringInfo:c}}})})},"esri/layers/support/attributeUtils":function(){define("dojo/_base/lang dojo/has dojox/encoding/digests/_base dojox/encoding/digests/MD5 ../../kernel ../../support/expressionUtils".split(" "),
function(k,e,p,q,n,l){var h={viewScaleRE:/^\s*(return\s+)?\$view\.scale\s*(;)?\s*$/i,getAttributeId:function(f){return"string"===typeof f?q(f,p.outputTypes.Hex):null},getAttributeIdSource:function(f){if(!f)return null;var d=f.field,c=f.valueExpression,a=null;if(c)a=c;else if(k.isFunction(d))a=d.toString();else if(d){var b=(c=f.normalizationField)?"field":f.normalizationType;f=parseFloat(f.normalizationTotal);if(b)if(b=b.toLowerCase(),a=d.toLowerCase()+",norm:"+b,c)a+=","+c.toLowerCase();else if("percent-of-total"===
b){d=f;if("number"!==typeof d||isNaN(d)||Infinity===d||-Infinity===d||0===f)f=null;a+=","+f}}return a},createAttributeCache:function(f,d){if(!f)return null;var c=f.valueExpression,a=l.createSyntaxTree(c),b=h.getAttributeIdSource(f);return{attributeInfo:f,isNumeric:!d,idSource:b,id:h.getAttributeId(b),hasExpr:!!c,compiledFunc:l.createFunction(a),syntaxTree:a,isScaleDriven:!!f.expression||h.viewScaleRE.test(c),dependsOnView:a?l.dependsOnView(a):!1,dependsOnGeometry:a?l.hasGeometryOperations(a):!1,isJSFunc:k.isFunction(f.field)}}};
return h})},"dojox/encoding/digests/_base":function(){define(["dojo/_base/lang"],function(k){k=k.getObject("dojox.encoding.digests",!0);k.outputTypes={Base64:0,Hex:1,String:2,Raw:3};k.addWords=function(e,k){var p=(e&65535)+(k&65535);return(e>>16)+(k>>16)+(p>>16)<<16|p&65535};k.stringToWord=function(e){for(var k=[],q=0,n=8*e.length;q<n;q+=8)k[q>>5]|=(e.charCodeAt(q/8)&255)<<q%32;return k};k.wordToString=function(e){for(var k=[],q=0,n=32*e.length;q<n;q+=8)k.push(String.fromCharCode(e[q>>5]>>>q%32&255));
return k.join("")};k.wordToHex=function(e){for(var k=[],q=0,n=4*e.length;q<n;q++)k.push("0123456789abcdef".charAt(e[q>>2]>>q%4*8+4&15)+"0123456789abcdef".charAt(e[q>>2]>>q%4*8&15));return k.join("")};k.wordToBase64=function(e){for(var k=[],q=0,n=4*e.length;q<n;q+=3)for(var l=(e[q>>2]>>q%4*8&255)<<16|(e[q+1>>2]>>(q+1)%4*8&255)<<8|e[q+2>>2]>>(q+2)%4*8&255,h=0;4>h;h++)8*q+6*h>32*e.length?k.push("\x3d"):k.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(l>>6*(3-h)&63));return k.join("")};
k.stringToUtf8=function(e){for(var k="",q=-1,n,l;++q<e.length;)n=e.charCodeAt(q),l=q+1<e.length?e.charCodeAt(q+1):0,55296<=n&&56319>=n&&56320<=l&&57343>=l&&(n=65536+((n&1023)<<10)+(l&1023),q++),127>=n?k+=String.fromCharCode(n):2047>=n?k+=String.fromCharCode(192|n>>>6&31,128|n&63):65535>=n?k+=String.fromCharCode(224|n>>>12&15,128|n>>>6&63,128|n&63):2097151>=n&&(k+=String.fromCharCode(240|n>>>18&7,128|n>>>12&63,128|n>>>6&63,128|n&63));return k};return k})},"dojox/encoding/digests/MD5":function(){define(["./_base"],
function(k){function e(f,d){return f<<d|f>>>32-d}function p(f,d,c,a,b,g){return k.addWords(e(k.addWords(k.addWords(d,f),k.addWords(a,g)),b),c)}function q(f,d,c,a,b,g,h){return p(d&c|~d&a,f,d,b,g,h)}function n(f,d,c,a,b,g,h){return p(d&a|c&~a,f,d,b,g,h)}function l(f,d,c,a,b,g,h){return p(c^(d|~a),f,d,b,g,h)}function h(f,d){f[d>>5]|=128<<d%32;f[(d+64>>>9<<4)+14]=d;d=1732584193;for(var c=-271733879,a=-1732584194,b=271733878,g=0;g<f.length;g+=16){var h=d,m=c,r=a,t=b;d=q(d,c,a,b,f[g+0],7,-680876936);b=
q(b,d,c,a,f[g+1],12,-389564586);a=q(a,b,d,c,f[g+2],17,606105819);c=q(c,a,b,d,f[g+3],22,-1044525330);d=q(d,c,a,b,f[g+4],7,-176418897);b=q(b,d,c,a,f[g+5],12,1200080426);a=q(a,b,d,c,f[g+6],17,-1473231341);c=q(c,a,b,d,f[g+7],22,-45705983);d=q(d,c,a,b,f[g+8],7,1770035416);b=q(b,d,c,a,f[g+9],12,-1958414417);a=q(a,b,d,c,f[g+10],17,-42063);c=q(c,a,b,d,f[g+11],22,-1990404162);d=q(d,c,a,b,f[g+12],7,1804603682);b=q(b,d,c,a,f[g+13],12,-40341101);a=q(a,b,d,c,f[g+14],17,-1502002290);c=q(c,a,b,d,f[g+15],22,1236535329);
d=n(d,c,a,b,f[g+1],5,-165796510);b=n(b,d,c,a,f[g+6],9,-1069501632);a=n(a,b,d,c,f[g+11],14,643717713);c=n(c,a,b,d,f[g+0],20,-373897302);d=n(d,c,a,b,f[g+5],5,-701558691);b=n(b,d,c,a,f[g+10],9,38016083);a=n(a,b,d,c,f[g+15],14,-660478335);c=n(c,a,b,d,f[g+4],20,-405537848);d=n(d,c,a,b,f[g+9],5,568446438);b=n(b,d,c,a,f[g+14],9,-1019803690);a=n(a,b,d,c,f[g+3],14,-187363961);c=n(c,a,b,d,f[g+8],20,1163531501);d=n(d,c,a,b,f[g+13],5,-1444681467);b=n(b,d,c,a,f[g+2],9,-51403784);a=n(a,b,d,c,f[g+7],14,1735328473);
c=n(c,a,b,d,f[g+12],20,-1926607734);d=p(c^a^b,d,c,f[g+5],4,-378558);b=p(d^c^a,b,d,f[g+8],11,-2022574463);a=p(b^d^c,a,b,f[g+11],16,1839030562);c=p(a^b^d,c,a,f[g+14],23,-35309556);d=p(c^a^b,d,c,f[g+1],4,-1530992060);b=p(d^c^a,b,d,f[g+4],11,1272893353);a=p(b^d^c,a,b,f[g+7],16,-155497632);c=p(a^b^d,c,a,f[g+10],23,-1094730640);d=p(c^a^b,d,c,f[g+13],4,681279174);b=p(d^c^a,b,d,f[g+0],11,-358537222);a=p(b^d^c,a,b,f[g+3],16,-722521979);c=p(a^b^d,c,a,f[g+6],23,76029189);d=p(c^a^b,d,c,f[g+9],4,-640364487);b=
p(d^c^a,b,d,f[g+12],11,-421815835);a=p(b^d^c,a,b,f[g+15],16,530742520);c=p(a^b^d,c,a,f[g+2],23,-995338651);d=l(d,c,a,b,f[g+0],6,-198630844);b=l(b,d,c,a,f[g+7],10,1126891415);a=l(a,b,d,c,f[g+14],15,-1416354905);c=l(c,a,b,d,f[g+5],21,-57434055);d=l(d,c,a,b,f[g+12],6,1700485571);b=l(b,d,c,a,f[g+3],10,-1894986606);a=l(a,b,d,c,f[g+10],15,-1051523);c=l(c,a,b,d,f[g+1],21,-2054922799);d=l(d,c,a,b,f[g+8],6,1873313359);b=l(b,d,c,a,f[g+15],10,-30611744);a=l(a,b,d,c,f[g+6],15,-1560198380);c=l(c,a,b,d,f[g+13],
21,1309151649);d=l(d,c,a,b,f[g+4],6,-145523070);b=l(b,d,c,a,f[g+11],10,-1120210379);a=l(a,b,d,c,f[g+2],15,718787259);c=l(c,a,b,d,f[g+9],21,-343485551);d=k.addWords(d,h);c=k.addWords(c,m);a=k.addWords(a,r);b=k.addWords(b,t)}return[d,c,a,b]}k.MD5=function(f,d){d=d||k.outputTypes.Base64;f=h(k.stringToWord(f),8*f.length);switch(d){case k.outputTypes.Raw:return f;case k.outputTypes.Hex:return k.wordToHex(f);case k.outputTypes.String:return k.wordToString(f);default:return k.wordToBase64(f)}};k.MD5._hmac=
function(f,d,c){c=c||k.outputTypes.Base64;var a=k.stringToWord(d);16<a.length&&(a=h(a,8*d.length));var b=[];d=[];for(var g=0;16>g;g++)b[g]=a[g]^909522486,d[g]=a[g]^1549556828;f=h(b.concat(k.stringToWord(f)),512+8*f.length);f=h(d.concat(f),640);switch(c){case k.outputTypes.Raw:return f;case k.outputTypes.Hex:return k.wordToHex(f);case k.outputTypes.String:return k.wordToString(f);default:return k.wordToBase64(f)}};return k.MD5})},"esri/support/expressionUtils":function(){define(["dojo/_base/lang",
"dojo/_base/array","dojo/has","../kernel","../arcade/arcade"],function(k,e,p,q,n){var l={vars:{$feature:"any",$view:"any"}},h=/^\$feature\./i,f={_getSyntaxTree:function(d,c){return"string"===typeof d?f.createSyntaxTree(d,c):d},createSyntaxTree:function(d,c){c=c||k.clone(l);var a;try{a=d?n.parseScript(d,c):null}catch(b){a=null}return a},createFunction:function(d,c){c=c||k.clone(l);d=f._getSyntaxTree(d,c);var a;try{a=d?n.compileScript(d,c):null}catch(b){a=null}return a},createExecContext:function(d,
c){return{vars:{$feature:n.constructFeature(d),$view:c&&c.view},spatialReference:c&&c.sr}},evalSyntaxTree:function(d,c){var a;try{a=n.executeScript(d,c,c.spatialReference)}catch(b){a=null}return a},executeFunction:function(d,c){var a;try{a=d?d(c,c.spatialReference):null}catch(b){a=null}return a},extractFieldNames:function(d,c){d=f._getSyntaxTree(d,c);d=n.extractFieldLiterals(d);var a=[];e.forEach(d,function(b){h.test(b)&&(b=b.replace(h,""),a.push(b))});a.sort();return e.filter(a,function(b,c){return 0===
c||a[c-1]!==b})},dependsOnView:function(d){return n.referencesMember(d,"$view")},hasGeometryOperations:function(d){return(d=f._getSyntaxTree(d))?n.scriptUsesGeometryEngine(d):!1},enableGeometryOperations:function(){return n.enableGeometrySupport()}};return f})},"esri/arcade/arcade":function(){define("require exports ./arcadeRuntime ./parser ./Feature ./arcadeCompiler dojo/has dojo/Deferred".split(" "),function(k,e,p,q,n,l,h,f){Object.defineProperty(e,"__esModule",{value:!0});var d="disjoint intersects touches crosses within contains overlaps equals relate intersection union difference symmetricdifference clip cut area areageodetic length lengthgeodetic distance densify densifygeodetic generalize buffer buffergeodetic offset rotate issimple simplify multiparttosinglepart".split(" ");
e.compileScript=function(c,a){return h("csp-restrictions")?function(a,d){return p.executeScript(c,a,d)}:l.compileScript(c,a)};e.extend=function(c){p.extend(c);l.extend(c)};e.constructFeature=function(c){return n.fromFeature(c)};e.parseScript=function(c){return q.parseScript(c)};e.validateScript=function(c,a){return q.validateScript(c,a,"simple")};e.scriptCheck=function(c,a,b){return q.scriptCheck(c,a,b,"full")};e.parseAndExecuteScript=function(c,a,b){return p.executeScript(q.parseScript(c),a,b)};
e.executeScript=function(c,a,b){return p.executeScript(c,a,b)};e.referencesMember=function(c,a){return p.referencesMember(c,a)};e.referencesFunction=function(c,a){return p.referencesFunction(c,a)};e.extractFieldLiterals=function(c,a){void 0===a&&(a=!1);return q.extractFieldLiterals(c,a)};e.scriptUsesGeometryEngine=function(c){c=p.findFunctionCalls(c);for(var a=0;a<c.length;a++)if(-1<d.indexOf(c[a]))return!0;return!1};e.enableGeometrySupport=function(){var c=new f;k(["esri/geometry/geometryEngine",
"./functions/geomsync"],function(a,b){b.setGeometryEngine(a);c.resolve(!0)},function(a){c.reject(a)});return c.promise}})},"esri/arcade/arcadeRuntime":function(){define("require exports ../geometry/Polygon ../geometry/Polyline ../geometry/Point ../geometry/Extent ../geometry/Multipoint ../SpatialReference ./languageUtils ./treeAnalysis ./Dictionary ./Feature ./FunctionWrapper ./functions/date ./functions/string ./functions/maths ./functions/geometry ./functions/geomsync ./functions/stats ./ImmutablePathArray ./ImmutablePointArray ../geometry/Geometry".split(" "),
function(k,e,p,q,n,l,h,f,d,c,a,b,g,u,m,r,t,v,y,w,z,x){function A(a,b){for(var c=[],d=0;d<b.arguments.length;d++)c.push(B(a,b.arguments[d]));return c}function C(a,b,c){try{return c(a,b,A(a,b))}catch(ma){throw ma;}}function B(m,f){try{switch(f.type){case "EmptyStatement":return d.voidOperation;case "VariableDeclarator":var r=null===f.init?null:B(m,f.init);r===d.voidOperation&&(r=null);var h=f.id.name.toLowerCase();null!==m.localScope?m.localScope[h]={value:r,valueset:!0,node:f.init}:m.globalScope[h]=
{value:r,valueset:!0,node:f.init};return d.voidOperation;case "VariableDeclaration":for(var t=0;t<f.declarations.length;t++)B(m,f.declarations[t]);return d.voidOperation;case "BlockStatement":var l;a:{for(var v=d.voidOperation,t=0;t<f.body.length;t++)if(v=B(m,f.body[t]),v instanceof d.ReturnResult||v===d.breakResult||v===d.continueResult){l=v;break a}l=v}return l;case "FunctionDeclaration":var n=f.id.name.toLowerCase();m.globalScope[n]={valueset:!0,node:null,value:new g(f,m)};return d.voidOperation;
case "ReturnStatement":var e;if(null===f.argument)e=new d.ReturnResult(d.voidOperation);else{var u=B(m,f.argument);e=new d.ReturnResult(u)}return e;case "IfStatement":var w;if("AssignmentExpression"===f.test.type||"UpdateExpression"===f.test.type)throw Error(c.nodeErrorMessage(f.test,"RUNTIME","CANNOT_USE_ASSIGNMENT_IN_CONDITION"));var k=B(m,f.test);if(!0===k)w=B(m,f.consequent);else if(!1===k)w=null!==f.alternate?B(m,f.alternate):d.voidOperation;else throw Error(c.nodeErrorMessage(f,"RUNTIME","CANNOT_USE_NONBOOLEAN_IN_CONDITION"));
return w;case "ExpressionStatement":var z;if("AssignmentExpression"===f.expression.type||"UpdateExpression"===f.expression.type)z=B(m,f.expression);else{var y=B(m,f.expression);z=y===d.voidOperation?d.voidOperation:new d.ImplicitResult(y)}return z;case "AssignmentExpression":var p;var q=B(m,f.right),t=null,x="";if("MemberExpression"===f.left.type){t=B(m,f.left.object);x=!0===f.left.computed?B(m,f.left.property):f.left.property.name;if(d.isArray(t))if(d.isNumber(x)){0>x&&(x=t.length+x);if(0>x||x>t.length)throw Error("Assignment outside of array bounds");
if(x===t.length&&"\x3d"!==f.operator)throw Error("Invalid Parameter");t[x]=D(q,f.operator,t[x],f)}else throw Error("Invalid Parameter");else if(t instanceof a){if(!1===d.isString(x))throw Error("Dictionary accessor must be a string");if(!0===t.hasField(x))t.setField(x,D(q,f.operator,t.field(x),f));else{if("\x3d"!==f.operator)throw Error("Invalid Parameter");t.setField(x,D(q,f.operator,null,f))}}else if(t instanceof b){if(!1===d.isString(x))throw Error("Feature accessor must be a string");if(!0===
t.hasField(x))t.setField(x,D(q,f.operator,t.field(x),f));else{if("\x3d"!==f.operator)throw Error("Invalid Parameter");t.setField(x,D(q,f.operator,null,f))}}else{if(d.isImmutableArray(t))throw Error("Array is Immutable");throw Error("Invalid Parameter");}p=d.voidOperation}else if(t=f.left.name.toLowerCase(),null!==m.localScope&&void 0!==m.localScope[t])m.localScope[t]={value:D(q,f.operator,m.localScope[t].value,f),valueset:!0,node:f.right},p=d.voidOperation;else if(void 0!==m.globalScope[t])m.globalScope[t]=
{value:D(q,f.operator,m.globalScope[t].value,f),valueset:!0,node:f.right},p=d.voidOperation;else throw Error("Variable not recognised");return p;case "UpdateExpression":var A;var C,t=null,x="";if("MemberExpression"===f.argument.type){t=B(m,f.argument.object);x=!0===f.argument.computed?B(m,f.argument.property):f.argument.property.name;if(d.isArray(t))if(d.isNumber(x)){0>x&&(x=t.length+x);if(0>x||x>=t.length)throw Error("Assignment outside of array bounds");C=d.toNumber(t[x]);t[x]="++"===f.operator?
C+1:C-1}else throw Error("Invalid Parameter");else if(t instanceof a){if(!1===d.isString(x))throw Error("Dictionary accessor must be a string");if(!0===t.hasField(x))C=d.toNumber(t.field(x)),t.setField(x,"++"===f.operator?C+1:C-1);else throw Error("Invalid Parameter");}else if(t instanceof b){if(!1===d.isString(x))throw Error("Feature accessor must be a string");if(!0===t.hasField(x))C=d.toNumber(t.field(x)),t.setField(x,"++"===f.operator?C+1:C-1);else throw Error("Invalid Parameter");}else{if(d.isImmutableArray(t))throw Error("Array is Immutable");
throw Error("Invalid Parameter");}A=!1===f.prefix?C:"++"===f.operator?C+1:C-1}else if(t=f.argument.name.toLowerCase(),null!==m.localScope&&void 0!==m.localScope[t])C=d.toNumber(m.localScope[t].value),m.localScope[t]={value:"++"===f.operator?C+1:C-1,valueset:!0,node:f},A=!1===f.prefix?C:"++"===f.operator?C+1:C-1;else if(void 0!==m.globalScope[t])C=d.toNumber(m.globalScope[t].value),m.globalScope[t]={value:"++"===f.operator?C+1:C-1,valueset:!0,node:f},A=!1===f.prefix?C:"++"===f.operator?C+1:C-1;else throw Error("Variable not recognised");
return A;case "BreakStatement":return d.breakResult;case "ContinueStatement":return d.continueResult;case "ForStatement":null!==f.init&&B(m,f.init);x={testResult:!0,lastAction:d.voidOperation};do b:{p=m;q=f;A=x;if(null!==q.test){A.testResult=B(p,q.test);if(!1===A.testResult)break b;if(!0!==A.testResult)throw Error(c.nodeErrorMessage(q,"RUNTIME","CANNOT_USE_NONBOOLEAN_IN_CONDITION"));}A.lastAction=B(p,q.body);A.lastAction===d.breakResult?A.testResult=!1:A.lastAction instanceof d.ReturnResult?A.testResult=
!1:null!==q.update&&B(p,q.update)}while(!0===x.testResult);t=x.lastAction instanceof d.ReturnResult?x.lastAction:d.voidOperation;return t;case "ForInStatement":return E(m,f);case "Identifier":return P(m,f);case "MemberExpression":return I(m,f);case "Literal":return f.value;case "ThisExpression":throw Error(c.nodeErrorMessage(f,"RUNTIME","NOTSUPPORTED"));case "CallExpression":return K(m,f);case "UnaryExpression":return M(m,f);case "BinaryExpression":return L(m,f);case "LogicalExpression":return J(m,
f);case "ConditionalExpression":throw Error(c.nodeErrorMessage(f,"RUNTIME","NOTSUPPORTED"));case "ArrayExpression":try{for(t=[],x=0;x<f.elements.length;x++){var F=B(m,f.elements[x]);if(d.isFunctionParameter(F))throw Error(c.nodeErrorMessage(f,"RUNTIME","FUNCTIONCONTEXTILLEGAL"));F===d.voidOperation?t.push(null):t.push(F)}}catch(Qa){throw Qa;}return t;case "ObjectExpression":t={};for(x=0;x<f.properties.length;x++){var G=B(m,f.properties[x]);if(d.isFunctionParameter(G.value))throw Error("Illegal Argument");
if(!1===d.isString(G.key))throw Error("Illegal Argument");t[G.key.toString()]=G.value===d.voidOperation?null:G.value}var Z=new a(t);Z.immutable=!1;return Z;case "Property":return{key:"Identifier"===f.key.type?f.key.name:B(m,f.key),value:B(m,f.value)};case "Array":throw Error(c.nodeErrorMessage(f,"RUNTIME","NOTSUPPORTED"));default:throw Error(c.nodeErrorMessage(f,"RUNTIME","UNREOGNISED"));}}catch(Qa){throw Qa;}}function E(g,m){var f=B(g,m.right);"VariableDeclaration"===m.left.type&&B(g,m.left);var r=
null,t="VariableDeclaration"===m.left.type?m.left.declarations[0].id.name:m.left.name;null!==g.localScope&&void 0!==g.localScope[t]&&(r=g.localScope[t]);null===r&&void 0!==g.globalScope[t]&&(r=g.globalScope[t]);if(null===r)throw Error(c.nodeErrorMessage(m,"RUNTIME","VARIABLENOTDECLARED"));if(d.isArray(f)||d.isString(f)){for(var f=f.length,h=0;h<f&&(r.value=h,t=B(g,m.body),t!==d.breakResult);h++)if(t instanceof d.ReturnResult)return t;return d.voidOperation}if(d.isImmutableArray(f)){for(h=0;h<f.length()&&
(r.value=h,t=B(g,m.body),t!==d.breakResult);h++)if(t instanceof d.ReturnResult)return t;return d.voidOperation}if(f instanceof a||f instanceof b)for(f=f.keys(),h=0;h<f.length&&(r.value=f[h],t=B(g,m.body),t!==d.breakResult);h++){if(t instanceof d.ReturnResult)return t}else return d.voidOperation}function D(a,b,g,m){switch(b){case "\x3d":return a===d.voidOperation?null:a;case "/\x3d":return d.toNumber(g)/d.toNumber(a);case "*\x3d":return d.toNumber(g)*d.toNumber(a);case "-\x3d":return d.toNumber(g)-
d.toNumber(a);case "+\x3d":return d.isString(g)||d.isString(a)?d.toString(g)+d.toString(a):d.toNumber(g)+d.toNumber(a);case "%\x3d":return d.toNumber(g)%d.toNumber(a);default:throw Error(c.nodeErrorMessage(m,"RUNTIME","OPERATORNOTRECOGNISED"));}}function F(b,g,m,f){g=g.toLowerCase();switch(g){case "hasz":return b=b.hasZ,void 0===b?!1:b;case "hasm":return b=b.hasM,void 0===b?!1:b;case "spatialreference":return g=b.spatialReference._arcadeCacheId,void 0===g&&(m=!0,Object.freeze&&Object.isFrozen(b.spatialReference)&&
(m=!1),m&&(fa++,g=b.spatialReference._arcadeCacheId=fa)),b=new a({wkt:b.spatialReference.wkt,wkid:b.spatialReference.wkid}),void 0!==g&&(b._arcadeCacheId="SPREF"+g.toString()),b}switch(b.type){case "extent":switch(g){case "xmin":case "xmax":case "ymin":case "ymax":case "zmin":case "zmax":case "mmin":case "mmax":return b=b[g],void 0!==b?b:null;case "type":return"Extent"}break;case "polygon":switch(g){case "rings":return g=d.isVersion4?b.cache._arcadeCacheId:b.getCacheValue("_arcadeCacheId"),void 0===
g&&(fa++,g=fa,d.isVersion4?b.cache._arcadeCacheId=g:b.setCacheValue("_arcadeCacheId",g)),b=new w(b.rings,b.spatialReference,!0===b.hasZ,!0===b.hasM,g);case "type":return"Polygon"}break;case "point":switch(g){case "x":case "y":case "z":case "m":return void 0!==b[g]?b[g]:null;case "type":return"Point"}break;case "polyline":switch(g){case "paths":return g=d.isVersion4?b.cache._arcadeCacheId:b.getCacheValue("_arcadeCacheId"),void 0===g&&(fa++,g=fa,d.isVersion4?b.cache._arcadeCacheId=g:b.setCacheValue("_arcadeCacheId",
g)),b=new w(b.paths,b.spatialReference,!0===b.hasZ,!0===b.hasM,g);case "type":return"Polyline"}break;case "multipoint":switch(g){case "points":return g=d.isVersion4?b.cache._arcadeCacheId:b.getCacheValue("_arcadeCacheId"),void 0===g&&(fa++,g=fa,d.isVersion4?b.cache._arcadeCacheId=g:b.setCacheValue("_arcadeCacheId",g)),b=new z(b.points,b.spatialReference,!0===b.hasZ,!0===b.hasM,g,1);case "type":return"Multipoint"}}throw Error(c.nodeErrorMessage(f,"RUNTIME","PROPERTYNOTFOUND"));}function I(g,m){try{var f=
B(g,m.object);if(null===f)throw Error(c.nodeErrorMessage(m,"RUNTIME","NOTFOUND"));if(!1===m.computed){if(f instanceof a||f instanceof b)return f.field(m.property.name);if(f instanceof x)return F(f,m.property.name,g,m);throw Error(c.nodeErrorMessage(m,"RUNTIME","INVALIDTYPE"));}var r=B(g,m.property);if(f instanceof a||f instanceof b){if(d.isString(r))return f.field(r)}else if(f instanceof x){if(d.isString(r))return F(f,r,g,m)}else if(d.isArray(f)){if(d.isNumber(r)&&isFinite(r)&&Math.floor(r)===r){0>
r&&(r=f.length+r);if(r>=f.length||0>r)throw Error(c.nodeErrorMessage(m,"RUNTIME","OUTOFBOUNDS"));return f[r]}}else if(d.isString(f)){if(d.isNumber(r)&&isFinite(r)&&Math.floor(r)===r){0>r&&(r=f.length+r);if(r>=f.length||0>r)throw Error(c.nodeErrorMessage(m,"RUNTIME","OUTOFBOUNDS"));return f[r]}}else if(d.isImmutableArray(f)&&d.isNumber(r)&&isFinite(r)&&Math.floor(r)===r){0>r&&(r=f.length()+r);if(r>=f.length()||0>r)throw Error(c.nodeErrorMessage(m,"RUNTIME","OUTOFBOUNDS"));return f.get(r)}throw Error(c.nodeErrorMessage(m,
"RUNTIME","INVALIDTYPE"));}catch(ja){throw ja;}}function M(a,b){try{var g=B(a,b.argument);if(d.isBoolean(g)){if("!"===b.operator)return!g;if("-"===b.operator)return-1*d.toNumber(g);if("+"===b.operator)return 1*d.toNumber(g);throw Error(c.nodeErrorMessage(b,"RUNTIME","NOTSUPPORTEDUNARYOPERATOR"));}if("-"===b.operator)return-1*d.toNumber(g);if("+"===b.operator)return 1*d.toNumber(g);throw Error(c.nodeErrorMessage(b,"RUNTIME","NOTSUPPORTEDUNARYOPERATOR"));}catch(ma){throw ma;}}function L(a,b){try{var g=
[B(a,b.left),B(a,b.right)],m=g[0],f=g[1];switch(b.operator){case "\x3d\x3d":return d.equalityTest(m,f);case "\x3d":return d.equalityTest(m,f);case "!\x3d":return!d.equalityTest(m,f);case "\x3c":return d.greaterThanLessThan(m,f,b.operator);case "\x3e":return d.greaterThanLessThan(m,f,b.operator);case "\x3c\x3d":return d.greaterThanLessThan(m,f,b.operator);case "\x3e\x3d":return d.greaterThanLessThan(m,f,b.operator);case "+":return d.isString(m)||d.isString(f)?d.toString(m)+d.toString(f):d.toNumber(m)+
d.toNumber(f);case "-":return d.toNumber(m)-d.toNumber(f);case "*":return d.toNumber(m)*d.toNumber(f);case "/":return d.toNumber(m)/d.toNumber(f);case "%":return d.toNumber(m)%d.toNumber(f);default:throw Error(c.nodeErrorMessage(b,"RUNTIME","OPERATORNOTRECOGNISED"));}}catch(va){throw va;}}function J(a,b){try{if("AssignmentExpression"===b.left.type||"UpdateExpression"===b.left.type)throw Error(c.nodeErrorMessage(b.left,"RUNTIME","CANNOT_USE_ASSIGNMENT_IN_CONDITION"));if("AssignmentExpression"===b.right.type||
"UpdateExpression"===b.right.type)throw Error(c.nodeErrorMessage(b.right,"RUNTIME","CANNOT_USE_ASSIGNMENT_IN_CONDITION"));var g=B(a,b.left);if(d.isBoolean(g))switch(b.operator){case "||":if(!0===g)return g;var m=B(a,b.right);if(d.isBoolean(m))return m;throw Error(c.nodeErrorMessage(b,"RUNTIME","ONLYORORAND"));case "\x26\x26":if(!1===g)return g;m=B(a,b.right);if(d.isBoolean(m))return m;throw Error(c.nodeErrorMessage(b,"RUNTIME","ONLYORORAND"));default:throw Error(c.nodeErrorMessage(b,"RUNTIME","ONLYORORAND"));
}else throw Error(c.nodeErrorMessage(b,"RUNTIME","ONLYBOOLEAN"));}catch(ja){throw ja;}}function P(a,b){var d;try{var g=b.name.toLowerCase();if(null!==a.localScope&&void 0!==a.localScope[g])return d=a.localScope[g],!0!==d.valueset&&(d.value=B(a,d.node),d.valueset=!0),d.value;if(void 0!==a.globalScope[g])return d=a.globalScope[g],!0!==d.valueset&&(d.value=B(a,d.node),d.valueset=!0),d.value;throw Error(c.nodeErrorMessage(b,"RUNTIME","VARIABLENOTFOUND"));}catch(ja){throw ja;}}function K(a,b){try{if("Identifier"!==
b.callee.type)throw Error(c.nodeErrorMessage(b,"RUNTIME","ONLYNODESSUPPORTED"));if(null!==a.localScope&&void 0!==a.localScope[b.callee.name.toLowerCase()]){var m=a.localScope[b.callee.name.toLowerCase()];if(m.value instanceof d.NativeFunction)return m.value.fn(a,b);if(m.value instanceof g)return W(a,b,m.value.definition);throw Error(c.nodeErrorMessage(b,"RUNTIME","NOTAFUNCTION"));}if(void 0!==a.globalScope[b.callee.name.toLowerCase()]){m=a.globalScope[b.callee.name.toLowerCase()];if(m.value instanceof
d.NativeFunction)return m.value.fn(a,b);if(m.value instanceof g)return W(a,b,m.value.definition);throw Error(c.nodeErrorMessage(b,"RUNTIME","NOTAFUNCTION"));}throw Error(c.nodeErrorMessage(b,"RUNTIME","NOTFOUND"));}catch(ma){throw ma;}}function U(c){return null==c?"":d.isArray(c)||d.isImmutableArray(c)?"Array":d.isDate(c)?"Date":d.isString(c)?"String":d.isBoolean(c)?"Boolean":d.isNumber(c)?"Number":c instanceof a?"Dictionary":c instanceof b?"Feature":c instanceof n?"Point":c instanceof p?"Polygon":
c instanceof q?"Polyline":c instanceof h?"Multipoint":c instanceof l?"Extent":d.isFunctionParameter(c)?"Function":c===d.voidOperation?"":"number"===typeof c&&isNaN(c)?"Number":"Unrecognised Type"}function O(a,b,c,g){try{var m=B(a,b.arguments[c]);if(d.equalityTest(m,g))return B(a,b.arguments[c+1]);var f=b.arguments.length-c;return 1===f?B(a,b.arguments[c]):2===f?null:3===f?B(a,b.arguments[c+2]):O(a,b,c+2,g)}catch(la){throw la;}}function S(a,b,c,g){try{if(!0===g)return B(a,b.arguments[c+1]);if(3===
b.arguments.length-c)return B(a,b.arguments[c+2]);var m=B(a,b.arguments[c+2]);if(!1===d.isBoolean(m))throw Error("WHEN needs boolean test conditions");return S(a,b,c+2,m)}catch(va){throw va;}}function Y(a,b){var c=a.length,d=Math.floor(c/2);if(0===c)return[];if(1===c)return[a[0]];var g=Y(a.slice(0,d),b);a=Y(a.slice(d,c),b);for(c=[];0<g.length||0<a.length;)0<g.length&&0<a.length?(d=b(g[0],a[0]),isNaN(d)&&(d=0),0>=d?(c.push(g[0]),g=g.slice(1)):(c.push(a[0]),a=a.slice(1))):0<g.length?(c.push(g[0]),g=
g.slice(1)):0<a.length&&(c.push(a[0]),a=a.slice(1));return c}function N(a,b,c){try{var g=a.body;if(c.length!==a.params.length)throw Error("Invalid Parameter calls to function.");for(var m=0;m<c.length;m++)b.localScope[a.params[m].name.toLowerCase()]={value:c[m],valueset:!0,node:null};var f=B(b,g);if(f instanceof d.ReturnResult)return f.value;if(f===d.breakResult)throw Error("Cannot Break from a Function");if(f===d.continueResult)throw Error("Cannot Continue from a Function");return f instanceof d.ImplicitResult?
f.value:f}catch(la){throw la;}}function W(a,b,c){return C(a,b,function(b,d,g){b={spatialReference:a.spatialReference,applicationCache:void 0===a.applicationCache?null:a.applicationCache,globalScope:a.globalScope,depthCounter:a.depthCounter+1,console:a.console,localScope:{}};if(64<b.depthCounter)throw Error("Exceeded maximum function depth");return N(c,b,g)})}function ca(a){return function(){var b={applicationCache:void 0===a.context.applicationCache?null:a.context.applicationCache,spatialReference:a.context.spatialReference,
console:a.context.console,localScope:{},depthCounter:a.context.depthCounter+1,globalScope:a.context.globalScope};if(64<b.depthCounter)throw Error("Exceeded maximum function depth");return N(a.definition,b,arguments)}}function ha(a){console.log(a)}Object.defineProperty(e,"__esModule",{value:!0});var fa=0,Z={};u.registerFunctions(Z,C);m.registerFunctions(Z,C);r.registerFunctions(Z,C);t.registerFunctions(Z,C);y.registerFunctions(Z,C);v.registerFunctions(Z,C);Z["typeof"]=function(a,b){return C(a,b,function(a,
b,c){d.pcCheck(c,1,1);a=U(c[0]);if("Unrecognised Type"===a)throw Error("Unrecognised Type");return a})};Z.iif=function(a,b){try{d.pcCheck(null===b.arguments?[]:b.arguments,3,3);var c=B(a,b.arguments[0]);if(!1===d.isBoolean(c))throw Error("IF Function must have a boolean test condition");return!0===c?B(a,b.arguments[1]):B(a,b.arguments[2])}catch(ma){throw ma;}};Z.decode=function(a,b){try{if(2>b.arguments.length)throw Error("Missing Parameters");if(2===b.arguments.length)return B(a,b.arguments[1]);
if(0===(b.arguments.length-1)%2)throw Error("Must have a default value result.");var c=B(a,b.arguments[0]);return O(a,b,1,c)}catch(ma){throw ma;}};Z.when=function(a,b){try{if(3>b.arguments.length)throw Error("Missing Parameters");if(0===b.arguments.length%2)throw Error("Must have a default value result.");var c=B(a,b.arguments[0]);if(!1===d.isBoolean(c))throw Error("WHEN needs boolean test conditions");return S(a,b,0,c)}catch(ma){throw ma;}};Z.top=function(a,b){return C(a,b,function(a,b,c){d.pcCheck(c,
2,2);if(d.isArray(c[0]))return d.toNumber(c[1])>=c[0].length?c[0].slice(0):c[0].slice(0,d.toNumber(c[1]));if(d.isImmutableArray(c[0]))return d.toNumber(c[1])>=c[0].length()?c[0].slice(0):c[0].slice(0,d.toNumber(c[1]));throw Error("Top cannot accept this parameter type");})};Z.first=function(a,b){return C(a,b,function(a,b,c){d.pcCheck(c,1,1);return d.isArray(c[0])?0===c[0].length?null:c[0][0]:d.isImmutableArray(c[0])?0===c[0].length()?null:c[0].get(0):null})};Z.sort=function(a,b){return C(a,b,function(a,
b,c){d.pcCheck(c,1,2);a=c[0];d.isImmutableArray(a)&&(a=a.toArray());if(!1===d.isArray(a))throw Error("Illegal Argument");if(1<c.length){if(!1===d.isFunctionParameter(c[1]))throw Error("Illegal Argument");var g=ca(c[1]);a=Y(a,function(a,b){return g(a,b)})}else{if(0===a.length)return[];c={};for(b=0;b<a.length;b++){var m=U(a[b]);""!==m&&(c[m]=!0)}if(!0===c.Array||!0===c.Dictionary||!0===c.Feature||!0===c.Point||!0===c.Polygon||!0===c.Polyline||!0===c.Multipoint||!0===c.Extent||!0===c.Function)return a.slice(0);
b=0;var m="",f;for(f in c)b++,m=f;a=1<b||"String"===m?Y(a,function(a,b){if(null===a||void 0===a||a===d.voidOperation)return null===b||void 0===b||b===d.voidOperation?0:1;if(null===b||void 0===b||b===d.voidOperation)return-1;a=d.toString(a);b=d.toString(b);return a<b?-1:a===b?0:1}):"Number"===m?Y(a,function(a,b){return a-b}):"Boolean"===m?Y(a,function(a,b){return a===b?0:b?-1:1}):"Date"===m?Y(a,function(a,b){return b-a}):a.slice(0)}return a})};for(var G in Z)Z[G]={value:new d.NativeFunction(Z[G]),
valueset:!0,node:null};var ia=function(){};ia.prototype=Z;ia.prototype.infinity={value:Number.POSITIVE_INFINITY,valueset:!0,node:null};ia.prototype.pi={value:Math.PI,valueset:!0,node:null};e.functionHelper={fixSpatialReference:d.fixSpatialReference,parseArguments:A,standardFunction:C};e.extend=function(a){for(var b={mode:"sync",compiled:!1,functions:{},signatures:[],standardFunction:C,evaluateIdentifier:P,arcadeCustomFunctionHandler:ca},g=0;g<a.length;g++)a[g].registerFunctions(b);for(var m in b.functions)Z[m]=
{value:new d.NativeFunction(b.functions[m]),valueset:!0,node:null},ia.prototype[m]=Z[m];for(g=0;g<b.signatures.length;g++)c.addFunctionDeclaration(b.signatures[g],"f")};e.executeScript=function(c,m,r){r||(r=new f(102100));var t=m.vars,h=m.customfunctions,l=new ia;t||(t={});h||(h={});var v=new a({newline:"\n",tab:"\t",singlequote:"'",doublequote:'"',forwardslash:"/",backwardslash:"\\"});v.immutable=!1;l.textformatting={value:v,valueset:!0,node:null};for(var n in h)l[n]={value:new d.NativeFunction(h[n]),
"native":!0,valueset:!0,node:null};for(n in t)l[n]=t[n]&&"esri.Graphic"===t[n].declaredClass?{value:new b(t[n]),valueset:!0,node:null}:{value:t[n],valueset:!0,node:null};c=B({spatialReference:r,globalScope:l,localScope:null,console:m.console?m.console:ha,depthCounter:1,applicationCache:void 0===m.applicationCache?null:m.applicationCache},c.body[0].body);c instanceof d.ReturnResult&&(c=c.value);c instanceof d.ImplicitResult&&(c=c.value);c===d.voidOperation&&(c=null);if(c===d.breakResult)throw Error("Cannot return BREAK");
if(c===d.continueResult)throw Error("Cannot return CONTINUE");if(c instanceof g)throw Error("Cannot return FUNCTION");if(c instanceof d.NativeFunction)throw Error("Cannot return FUNCTION");return c};e.extractFieldLiterals=function(a,b){void 0===b&&(b=!1);return c.findFieldLiterals(a,b)};e.validateScript=function(a,b){return c.validateScript(a,b,"simple")};e.referencesMember=function(a,b){return c.referencesMember(a,b)};e.referencesFunction=function(a,b){return c.referencesFunction(a,b)};e.findFunctionCalls=
function(a){return c.findFunctionCalls(a,!1)}})},"esri/arcade/treeAnalysis":function(){define(["require","exports"],function(k,e){function p(a,b,c,d){return"0"!==a.min&&c.length<Number(a.min)||"*"!==a.max&&c.length>Number(a.max)?-2:1}function q(a,b,c){if(null!==c.localScope&&void 0!==c.localScope[a.toLowerCase()]){var d=c.localScope[a.toLowerCase()];if("FormulaFunction"===d.type||"any"===d.type)return void 0===d.signature&&(d.signature={min:"0",max:"*"}),p(d.signature,a,b,c)}return void 0!==c.globalScope[a.toLowerCase()]&&
(d=c.globalScope[a.toLowerCase()],"FormulaFunction"===d.type||"any"===d.type)?(void 0===d.signature&&(d.signature={min:"0",max:"*"}),p(d.signature,a,b,c)):-1}function n(a,b){void 0===b&&(b=!0);var c=g(a,"SYNTAX","UNREOGNISED");try{switch(a.type){case "VariableDeclarator":return null!==a.init&&"FunctionExpression"===a.init.type?g(a,"SYNTAX","FUNCTIONVARIABLEDECLARATOR"):"Identifier"!==a.id.type?g(a,"SYNTAX","VARIABLEMUSTHAVEIDENTIFIER"):null!==a.init?n(a.init,!1):"";case "VariableDeclaration":for(var d=
0;d<a.declarations.length;d++)if(c=n(a.declarations[d],b),""!==c)return c;return"";case "ForInStatement":c=n(a.left,b);if(""!==c)break;if("VariableDeclaration"===a.left.type){if(1<a.left.declarations.length)return g(a,"SYNTAX","ONLY1VAR");if(null!==a.left.declarations[0].init)return g(a,"SYNTAX","CANNOTDECLAREVAL")}else if("Identifier"!==a.left.type)return g(a,"SYNTAX","LEFTNOTVAR");c=n(a.right,b);if(""!==c)break;c=n(a.body,b);if(""!==c)break;return"";case "ForStatement":if(null!==a.test&&(c=n(a.test,
b),""!==c))break;if(null!==a.init&&(c=n(a.init,b),""!==c))break;if(null!==a.update&&(c=n(a.update,b),""!==c))break;if(null!==a.body&&(c=n(a.body,b),""!==c))break;return"";case "ContinueStatement":return"";case "EmptyStatement":return"";case "BreakStatement":return"";case "IfStatement":c=n(a.test,b);if(""!==c)break;if(null!==a.consequent&&(c=n(a.consequent,!1),""!==c))break;if(null!==a.alternate&&(c=n(a.alternate,!1),""!==c))break;return"";case "BlockStatement":for(var m=[],d=0;d<a.body.length;d++)"EmptyStatement"!==
a.body[d].type&&m.push(a.body[d]);a.body=m;for(d=0;d<a.body.length;d++)if(c=n(a.body[d],b),""!==c)return c;return"";case "FunctionDeclaration":return!1===b?g(a,"SYNTAX","GLOBALFUNCTIONSONLY"):"Identifier"!==a.id.type?g(a,"SYNTAX","FUNCTIONMUSTHAVEIDENTIFIER"):n(a.body,!1);case "ReturnStatement":return null!==a.argument?n(a.argument,b):"";case "UpdateExpression":return"Identifier"!==a.argument.type&&"MemberExpression"!==a.argument.type?g(a,"SYNTAX","ASSIGNMENTTOVARSONLY"):n(a.argument,b);case "AssignmentExpression":if("Identifier"!==
a.left.type&&"MemberExpression"!==a.left.type)return g(a,"SYNTAX","ASSIGNMENTTOVARSONLY");c=n(a.left,b);if(""!==c)break;switch(a.operator){case "\x3d":case "/\x3d":case "*\x3d":case "%\x3d":case "+\x3d":case "-\x3d":break;default:return g(a,"SYNTAX","OPERATORNOTRECOGNISED")}return n(a.right,!1);case "ExpressionStatement":return n(a.expression,!1);case "Identifier":c="";break;case "MemberExpression":c=n(a.object,b);if(""!==c)break;return!0===a.computed?n(a.property,b):"";case "Literal":return"";case "ThisExpression":return g(a,
"SYNTAX","NOTSUPPORTED");case "CallExpression":if("Identifier"!==a.callee.type)return g(a,"SYNTAX","ONLYNODESSUPPORTED");c="";for(d=0;d<a.arguments.length;d++)if(c=n(a.arguments[d],b),""!==c)return c;return"";case "UnaryExpression":c=n(a.argument,b);break;case "BinaryExpression":c=n(a.left,b);if(""!==c)break;c=n(a.right,b);if(""!==c)break;switch(a.operator){case "\x3d\x3d":case "!\x3d":case "\x3c":case "\x3c\x3d":case "\x3e":case "\x3e\x3d":case "+":case "-":case "*":case "/":case "%":break;default:return g(a,
"SYNTAX","OPERATORNOTRECOGNISED")}return"";case "LogicalExpression":c=n(a.left,b);if(""!==c)break;c=n(a.right);if(""!==c)break;switch(a.operator){case "\x26\x26":case "||":break;default:return g(a,"SYNTAX","OPERATORNOTRECOGNISED")}return"";case "ConditionalExpression":return g(a,"SYNTAX","NOTSUPPORTED");case "ArrayExpression":c="";for(d=0;d<a.elements.length&&(c=n(a.elements[d],b),""===c);d++);break;case "Array":return g(a,"SYNTAX","NOTSUPPORTED");case "ObjectExpression":c="";for(d=0;d<a.properties.length&&
(c="",null!==a.properties[d].key&&("Literal"!==a.properties[d].key.type&&"Identifier"!==a.properties[d].key.type&&(c=g(a,"SYNTAX","OBJECTPROPERTYMUSTBESTRING")),"Literal"===a.properties[d].key.type&&(m=a.properties[d].key.value,"string"===typeof m||m instanceof String||(c=g(a,"SYNTAX","OBJECTPROPERTYMUSTBESTRING")))),""===c&&(c=n(a.properties[d],b)),""===c);d++);break;case "Property":if("Literal"!==a.key.type&&"Identifier"!==a.key.type)return g(a,"SYNTAX","ONLYLITERAL");if("Identifier"!==a.key.type&&
(c=n(a.key,b),""!==c))break;c=n(a.value,b)}return c}catch(A){throw A;}}function l(b,d){var m=g(b,"SYNTAX","UNREOGNISED"),f=null,r="";try{switch(b.type){case "VariableDeclarator":if(null!==b.init&&"FunctionExpression"===b.init.type)return g(b,"SYNTAX","FUNCTIONVARIABLEDECLARATOR");b.id.name.toLowerCase();var t=null===b.init?"":l(b.init,d);if(""!==t)return t;null===d.localScope?d.globalScope[b.id.name.toLowerCase()]={type:"any"}:d.localScope[b.id.name.toLowerCase()]={type:"any"};return"";case "FunctionDeclaration":f=
c(b.id.name.toLowerCase(),b,d);r=a(b,d);if(""!==r)return r;if(null!==d.localScope)return g(b,"SYNTAX","GLOBALFUNCTIONSONLY");f.isnative=!1;d.globalScope[b.id.name.toLowerCase()]={type:"FormulaFunction",signature:[f]};return"";case "VariableDeclaration":for(var m="",h=0;h<b.declarations.length&&(m=l(b.declarations[h],d),""===m);h++);break;case "IfStatement":m=l(b.test,d);if(""!==m)break;if("AssignmentExpression"===b.test.type||"UpdateExpression"===b.test.type)return g(b.test,"SYNTAX","CANNOT_USE_ASSIGNMENT_IN_CONDITION");
if(null!==b.consequent&&(m=l(b.consequent,d),""!==m))break;if(null!==b.alternate&&(m=l(b.alternate,d),""!==m))break;return"";case "EmptyStatement":return"";case "BlockStatement":for(h=0;h<b.body.length;h++)if(m=l(b.body[h],d),""!==m)return m;return"";case "ReturnStatement":return null!==b.argument?l(b.argument,d):"";case "ForInStatement":if("VariableDeclaration"===b.left.type){if(1<b.left.declarations.length)return g(b,"SYNTAX","ONLY1VAR");if(null!==b.left.declarations[0].init)return g(b,"SYNTAX",
"CANNOTDECLAREVAL")}else if("Identifier"!==b.left.type)return g(b,"SYNTAX","LEFTNOTVAR");m=l(b.left,d);if(""!==m)break;m=l(b.right,d);if(""!==m)break;m=l(b.body,d);if(""!==m)break;return"";case "ForStatement":if(null!==b.init&&(m=l(b.init,d),""!==m))break;if(null!==b.test&&(m=l(b.test,d),""!==m))break;if(null!==b.body&&(m=l(b.body,d),""!==m))break;if(null!==b.update&&(m=l(b.update,d),""!==m))break;return"";case "BreakStatement":return"";case "ContinueStatement":return"";case "UpdateExpression":if("Identifier"!==
b.argument.type&&"MemberExpression"!==b.argument.type)return g(b,"SYNTAX","ASSIGNMENTTOVARSONLY");var n=!1;if("MemberExpression"===b.argument.type)return l(b.argument,d);null!==d.localScope&&void 0!==d.localScope[b.argument.name.toLowerCase()]&&(n=!0);void 0!==d.globalScope[b.argument.name.toLowerCase()]&&(n=!0);return!1===n?"Identifier "+b.argument.name+" has not been declared.":"";case "AssignmentExpression":if("Identifier"!==b.left.type&&"MemberExpression"!==b.left.type)return g(b,"SYNTAX","ASSIGNMENTTOVARSONLY");
var e=l(b.right,d);if(""!==e)return e;n=!1;if("MemberExpression"===b.left.type)return e=l(b.left,d),""!==e?e:"";null!==d.localScope&&void 0!==d.localScope[b.left.name.toLowerCase()]&&(n=!0);void 0!==d.globalScope[b.left.name.toLowerCase()]&&(n=!0);return!1===n?"Identifier "+b.left.name+" has not been declared.":"";case "ExpressionStatement":return l(b.expression,d);case "Identifier":var v=b.name.toLowerCase();if(null!==d.localScope&&void 0!==d.localScope[v])return"";m=void 0!==d.globalScope[v]?"":
g(b,"SYNTAX","VARIABLENOTFOUND");break;case "MemberExpression":m=l(b.object,d);if(""!==m)break;return!0===b.computed?l(b.property,d):"";case "Literal":return"";case "ThisExpression":m=g(b,"SYNTAX","NOTSUPPORTED");break;case "CallExpression":if("Identifier"!==b.callee.type)return g(b,"SYNTAX","ONLYNODESSUPPORTED");m="";for(h=0;h<b.arguments.length;h++)if(m=l(b.arguments[h],d),""!==m)return m;var u=q(b.callee.name,b.arguments,d);-1===u&&(m=g(b,"SYNTAX","NOTFOUND"));-2===u&&(m=g(b,"SYNTAX","WRONGSIGNATURE"));
break;case "UnaryExpression":m=l(b.argument,d);break;case "BinaryExpression":m=l(b.left,d);if(""!==m)break;m=l(b.right,d);if(""!==m)break;return"";case "LogicalExpression":m=l(b.left,d);if(""!==m)break;if("AssignmentExpression"===b.left.type||"UpdateExpression"===b.left.type)return g(b.left,"SYNTAX","CANNOT_USE_ASSIGNMENT_IN_CONDITION");m=l(b.right,d);if(""!==m)break;return"AssignmentExpression"===b.right.type||"UpdateExpression"===b.right.type?g(b.right,"SYNTAX","CANNOT_USE_ASSIGNMENT_IN_CONDITION"):
"";case "ConditionalExpression":return g(b,"SYNTAX","NOTSUPPORTED");case "ArrayExpression":m="";for(h=0;h<b.elements.length&&(m=l(b.elements[h],d),""===m);h++);break;case "ObjectExpression":m="";for(h=0;h<b.properties.length;h++){m="";if(null!==b.properties[h].key&&("Literal"!==b.properties[h].key.type&&"Identifier"!==b.properties[h].key.type&&(m=g(b,"SYNTAX","OBJECTPROPERTYMUSTBESTRING")),"Literal"===b.properties[h].key.type)){var k=b.properties[h].key.value;"string"===typeof k||k instanceof String||
(m=g(b,"SYNTAX","OBJECTPROPERTYMUSTBESTRING"))}""===m&&(m=l(b.properties[h],d));if(""!==m)break}break;case "Property":if("Literal"!==b.key.type&&"Identifier"!==b.key.type)return g(b,"SYNTAX","ONLYLITERAL");if("Identifier"!==b.key.type&&(m=l(b.key,d),""!==m))break;m=l(b.value,d);break;case "Array":return g(b,"SYNTAX","NOTSUPPORTED")}return m}catch(M){throw M;}}function h(a,b){var c=!1;try{switch(a.type){case "VariableDeclarator":return null!==a.init?h(a.init,b):c;case "FunctionDeclaration":return h(a.body,
b);case "VariableDeclaration":for(var d=0;d<a.declarations.length;d++)if(h(a.declarations[d],b))return!0;return c;case "IfStatement":return h(a.test,b)||null!==a.consequent&&h(a.consequent,b)||null!==a.alternate&&h(a.alternate,b)?!0:c;case "EmptyStatement":return c;case "BlockStatement":for(d=0;d<a.body.length;d++)if(h(a.body[d],b))return!0;return c;case "ReturnStatement":return null!==a.argument?h(a.argument,b):c;case "UpdateExpression":return h(a.argument,b);case "AssignmentExpression":return(c=
h(a.right,b))?c:h(a.left,b);case "ExpressionStatement":return h(a.expression,b);case "ForInStatement":return(c=h(a.left,b))||(c=h(a.right,b))?c:c=h(a.body,b);case "ForStatement":if(null!==a.init&&(c=h(a.init,b))||null!==a.test&&(c=h(a.test,b))||null!==a.body&&(c=h(a.body,b)))return c;null!==a.update&&(c=h(a.update,b));return c;case "BreakStatement":return c;case "ContinueStatement":return c;case "Compound":return c;case "Identifier":return b.toLowerCase()===a.name.toLowerCase();case "MemberExpression":if(c=
h(a.object,b))return c;!0===a.computed&&(c=h(a.property,b));return c;case "Literal":return c;case "ThisExpression":return c;case "CallExpression":for(d=0;d<a.arguments.length;d++)h(a.arguments[d],b)&&(c=!0);return c;case "ArrayExpression":for(d=0;d<a.elements.length;d++)h(a.elements[d],b)&&(c=!0);return c;case "UnaryExpression":return h(a.argument,b);case "BinaryExpression":return(c=h(a.left,b))?c:c=h(a.right,b);case "LogicalExpression":return(c=h(a.left,b))?c:c=h(a.right,b);case "ObjectExpression":for(d=
0;d<a.properties.length;d++)h(a.properties[d],b)&&(c=!0);return c;case "Property":return c=h(a.value,b);case "ConditionalExpression":return c;case "Array":return c;default:return c}}catch(x){throw x;}}function f(a,b){var c=!1;try{switch(a.type){case "VariableDeclarator":return null!==a.init?f(a.init,b):c;case "FunctionDeclaration":return f(a.body,b);case "VariableDeclaration":for(var d=0;d<a.declarations.length;d++)if(f(a.declarations[d],b))return!0;return c;case "IfStatement":return f(a.test,b)||
null!==a.consequent&&f(a.consequent,b)||null!==a.alternate&&f(a.alternate,b)?!0:c;case "EmptyStatement":return c;case "BlockStatement":for(d=0;d<a.body.length;d++)if(f(a.body[d],b))return!0;return c;case "ReturnStatement":return null!==a.argument?f(a.argument,b):c;case "UpdateExpression":return f(a.argument,b);case "AssignmentExpression":return f(a.left,b)?!0:f(a.right,b);case "ExpressionStatement":return f(a.expression,b);case "ForInStatement":return(c=f(a.left,b))||(c=f(a.right,b))?c:c=f(a.body,
b);case "ForStatement":if(null!==a.init&&(c=f(a.init,b))||null!==a.test&&(c=f(a.test,b))||null!==a.body&&(c=f(a.body,b)))return c;null!==a.update&&(c=f(a.update,b));return c;case "BreakStatement":return c;case "ContinueStatement":return c;case "Compound":return c;case "Identifier":return c;case "MemberExpression":if(c=f(a.object,b))return c;!0===a.computed&&(c=f(a.property,b));return c;case "Literal":return c;case "ThisExpression":return c;case "CallExpression":if(a.callee.name.toLowerCase()===b.toLowerCase())return!0;
for(d=0;d<a.arguments.length;d++)f(a.arguments[d],b)&&(c=!0);return c;case "ArrayExpression":for(d=0;d<a.elements.length;d++)f(a.elements[d],b)&&(c=!0);return c;case "UnaryExpression":return f(a.argument,b);case "BinaryExpression":return(c=f(a.left,b))?c:c=f(a.right,b);case "LogicalExpression":return(c=f(a.left,b))?c:c=f(a.right,b);case "ConditionalExpression":return c;case "ObjectExpression":for(d=0;d<a.properties.length;d++)f(a.properties[d],b)&&(c=!0);return c;case "Property":return c=f(a.value,
b);case "Array":return c;default:return c}}catch(x){throw x;}}function d(a,b){var c=[],g;try{switch(a.type){case "VariableDeclarator":return null!==a.init?d(a.init,b):c;case "FunctionDeclaration":return d(a.body,b);case "VariableDeclaration":for(var m=0;m<a.declarations.length;m++)g=d(a.declarations[m],b),c=c.concat(g);return c;case "ForInStatement":return g=d(a.left,b),c=c.concat(g),g=d(a.right,b),c=c.concat(g),g=d(a.body,b),c=c.concat(g);case "ForStatement":return null!==a.init&&(g=d(a.init,b),
c=c.concat(g)),null!==a.test&&(g=d(a.test,b),c=c.concat(g)),null!==a.body&&(g=d(a.body,b),c=c.concat(g)),null!==a.update&&(g=d(a.update,b),c=c.concat(g)),c;case "IfStatement":return g=d(a.test,b),c=c.concat(g),null!==a.consequent&&(g=d(a.consequent,b),c=c.concat(g)),null!==a.alternate&&(g=d(a.alternate,b),c=c.concat(g)),c;case "EmptyStatement":return c;case "BlockStatement":for(m=0;m<a.body.length;m++)g=d(a.body[m],b),c=c.concat(g);return c;case "ReturnStatement":return null!==a.argument?d(a.argument,
b):c;case "UpdateExpression":return d(a.argument,b);case "AssignmentExpression":return c=d(a.left,b),c=c.concat(d(a.right,b));case "ExpressionStatement":return d(a.expression,b);case "BreakStatement":return c;case "ContinueStatement":return c;case "Compound":return c;case "Identifier":return c;case "MemberExpression":if("Identifier"!==a.object.type)return c;if(!1===a.computed)c.push(a.object.name.toLowerCase()+"."+a.property.name.toLowerCase());else try{"Literal"===a.property.type&&"string"===typeof a.property.value&&
c.push(a.object.name.toLowerCase()+"."+a.property.value.toString().toLowerCase())}catch(A){}return c;case "Literal":return c;case "ThisExpression":return c;case "CallExpression":for(m=0;m<a.arguments.length;m++)g=d(a.arguments[m],b),c=c.concat(g);return c;case "ArrayExpression":for(m=0;m<a.elements.length;m++)g=d(a.elements[m],b),c=c.concat(g);return c;case "UnaryExpression":return d(a.argument,b);case "ObjectExpression":for(m=0;m<a.properties.length;m++)g=d(a.properties[m],b),c=c.concat(g);return c;
case "Property":return d(a.value,b);case "BinaryExpression":return g=d(a.left,b),c=c.concat(g),g=d(a.right,b),c=c.concat(g);case "LogicalExpression":return g=d(a.left,b),c=c.concat(g),g=d(a.right,b),c=c.concat(g);case "ConditionalExpression":return c;case "Array":return c;default:return c}}catch(A){throw A;}}function c(a,b,c){c=[];if(void 0!==b.params&&null!==b.params)for(var d=0;d<b.params.length;d++)c.push("any");return{name:a,"return":"any",params:c}}function a(a,b){b={globalScope:b.globalScope,
localScope:{}};for(var c=0;c<a.params.length;c++)b.localScope[a.params[c].name.toLowerCase()]={type:"any"};return l(a.body,b)}function b(a,b,c,d){var g={};if(void 0===a||null===a)a={};if(void 0===c||null===c)c={};g.infinity={type:"any"};g.textformatting={type:"any"};g.pi={type:"any"};for(var m in b)if("simple"!==d||"simple"===d&&"a"===b[m].av)g[m]={type:"FormulaFunction",signature:{min:b[m].min,max:b[m].max}},"simple"!==d&&(void 0!==b[m].fmin&&(g[m].signature.min=b[m].fmin),void 0!==b[m].fmax&&(g[m].signature.max=
b[m].fmax));for(b=0;b<c.length;b++)m=c[b],g[m.name]={type:"FormulaFunction",signature:m};for(m in a)g[m]=a[m],g[m].type="any";return g}function g(a,b,c){var d="";switch(b){case "SYNTAX":d="Syntax Error: ";break;case "RUNTIME":d="Runtime Error: ";break;default:d="Syntax Error: "}try{switch(a.type){case "IfStatement":switch(c){case "CANNOT_USE_ASSIGNMENT_IN_CONDITION":d+=" Assignments not be made in logical tests";break;case "CANNOT_USE_NONBOOLEAN_IN_CONDITION":d+=" Non Boolean used as Condition"}break;
case "UpdateExpression":case "AssignmentExpression":switch(c){case "CANNOT_USE_ASSIGNMENT_IN_CONDITION":d+=" Assignments not be made in logical tests";break;case "ASSIGNMENTTOVARSONLY":d+=" Assignments can only be made to identifiers"}break;case "ExpressionStatement":d+=" Assignments can only be made to identifiers";break;case "FunctionDeclaration":switch(c){case "GLOBALFUNCTIONSONLY":d+=" Functions cannot be declared as variables";break;case "FUNCTIONMUSTHAVEIDENTIFIER":d+=" Function Definition must have an identifier"}break;
case "VariableDeclaration":d+=" Only 1 variable can be declared at a time";break;case "VariableDeclarator":switch(c){case "FUNCTIONVARIABLEDECLARATOR":d+=" Functions cannot be declared as variables";break;case "VARIABLEMUSTHAVEIDENTIFIER":d+=" Variable Definition must have an identifier"}break;case "Identifier":d+=" Identifier Not Found. ";d+=a.name;break;case "ObjectExpression":switch(c){case "OBJECTPROPERTYMUSTBESTRING":d+=" Property name must be a string"}break;case "ForStatement":switch(c){case "CANNOT_USE_NONBOOLEAN_IN_CONDITION":d+=
" Non Boolean used as Condition"}break;case "ForInStatement":switch(c){case "ONLY1VAR":d+=" Can only declare 1 var for use with IN";break;case "CANNOTDECLAREVAL":d+=" Can only declare value for use with IN";break;case "LEFTNOVAR":d+="Must provide a variable to iterate with.";break;case "VARIABLENOTDECLARED":d+="Variable must be declared before it is used..";break;case "CANNOTITERATETHISTYPE":d+="This type cannot be used in an IN loop"}break;case "MemberExpression":switch(c){case "PROPERTYNOTFOUND":d+=
"Cannot find member property. ";d+=!1===a.computed?a.property.name:"";break;case "OUTOFBOUNDS":d+="Out of Bounds. ";d+=!1===a.computed?a.property.name:"";break;case "NOTFOUND":d+="Cannot call member method on null. ";d+=!1===a.computed?a.property.name:"";break;case "INVALIDTYPE":d+="Cannot call member property on object of this type. ",d+=!1===a.computed?a.property.name:""}break;case "Property":switch(c){case "ONLYLITERAL":d+="Property names must be literals or identifiers"}break;case "Literal":break;
case "ThisExpression":d+="THIS construct is not supported.";case "CallExpression":switch(c){case "WRONGSIGNATURE":d+="Function signature does not match: ";d+=a.callee.name;break;case "ONLYNODESUPPORTED":d+="Functions must be declared.";d+=a.callee.name;break;case "NOTAFUNCTION":d+="Not a Function: ";d+=a.callee.name;break;case "NOTFOUND":d+="Function Not Found: "+a.callee.name}break;case "UnaryExpression":switch(c){case "NOTSUPPORTEDUNARYOPERATOR":d+="Operator "+a.operator+" not allowed in this context. Only ! can be used with boolean, and - with a number";
break;case "NOTSUPPORTEDTYPE":d+="Unary operator "+a.operator+" cannot be used with this argument."}case "BinaryExpression":switch(c){case "OPERATORNOTRECOGNISED":d+="Binary Operator not recognised "+a.operator}break;case "LogicalExpression":switch(c){case "ONLYBOOLEAN":d+="Operator "+a.operator+" cannot be used. Only || or \x26\x26 are allowed values";break;case "ONLYORORAND":d+="Logical Expression "+a.operator+" being applied to parameters that are not boolean."}break;case "ConditionalExpression":d+=
"Conditional statements not supported.";break;case "ArrayExpression":switch(c){case "FUNCTIONCONTEXTILLEGAL":d+=" Cannot Put Function inside Array."}break;case "Array":d+="Expression contains unrecognised array structure.";break;default:d+="Expression contains unrecognised code structures."}}catch(x){throw x;}return d}function u(a,b,c){return{line:a.loc.start.line,character:a.loc.start.column,reason:g(a,b,c)}}function m(a,b,c,d,g){void 0===g&&(g=!0);b={globalScope:b.globalScope,localScope:{}};for(g=
0;g<a.params.length;g++)b.localScope[a.params[g].name.toLowerCase()]={type:"any"};r(a.body,b,c,d,!1)}function r(a,b,d,g,f){void 0===f&&(f=!0);if(null===a)throw Error("Unnexpexted Expression Syntax");var t=null;try{switch(a.type){case "VariableDeclarator":if(null!==a.init&&"FunctionExpression"===a.init.type){g.push(u(a,"SYNTAX","FUNCTIONVARIABLEDECLARATOR"));break}"Identifier"!==a.id.type?g.push(u(a,"SYNTAX","VARIABLEMUSTHAVEIDENTIFIER")):(a.id.name.toLowerCase(),null===b.localScope?b.globalScope[a.id.name.toLowerCase()]=
{type:"any"}:b.localScope[a.id.name.toLowerCase()]={type:"any"});null===a.init?"":r(a.init,b,d,g,f);break;case "FunctionDeclaration":!1===f&&g.push(u(a,"SYNTAX","GLOBALFUNCTIONSONLY"));"Identifier"!==a.id.type&&g.push(u(a,"SYNTAX","FUNCTIONMUSTHAVEIDENTIFIER"));t=c("",a,b);m(a,b,d,g,f);null!==b.localScope&&g.push(u(a,"SYNTAX","GLOBALFUNCTIONSONLY"));t.isnative=!1;"Identifier"===a.id.type&&(b.globalScope[a.id.name.toLowerCase()]={type:"FormulaFunction",signature:[t]});break;case "VariableDeclaration":for(var h=
0;h<a.declarations.length;h++)r(a.declarations[h],b,d,g,f);break;case "IfStatement":null!==a.test&&(r(a.test,b,d,g,f),"AssignmentExpression"!==a.test.type&&"UpdateExpression"!==a.test.type||g.push(u(a.test,"SYNTAX","CANNOT_USE_ASSIGNMENT_IN_CONDITION")));null!==a.consequent&&r(a.consequent,b,d,g,f);null!==a.alternate&&r(a.alternate,b,d,g,f);break;case "EmptyStatement":break;case "BlockStatement":if(null!==a.body)for(h=0;h<a.body.length;h++)r(a.body[h],b,d,g,f);break;case "ReturnStatement":null!==
a.argument&&r(a.argument,b,d,g,f);break;case "ForInStatement":"VariableDeclaration"===a.left.type?(1<a.left.declarations.length&&g.push(u(a,"SYNTAX","ONLY1VAR")),null!==a.left.declarations[0].init&&g.push(u(a,"SYNTAX","CANNOTDECLAREVAL"))):"Identifier"!==a.left.type&&g.push(u(a,"SYNTAX","LEFTNOTVAR"));r(a.left,b,d,g,f);r(a.right,b,d,g,f);r(a.body,b,d,g,f);break;case "ForStatement":null!==a.init&&r(a.init,b,d,g,f);null!==a.test&&r(a.test,b,d,g,f);null!==a.body&&r(a.body,b,d,g,f);null!==a.update&&r(a.update,
b,d,g,f);break;case "BreakStatement":break;case "ContinueStatement":break;case "UpdateExpression":"Identifier"!==a.argument.type&&"MemberExpression"!==a.argument.type?g.push(u(a,"SYNTAX","ASSIGNMENTTOVARSONLY")):("Identifier"===a.argument.type&&(t=!1,!1===d&&(null!==b.localScope&&void 0!==b.localScope[a.argument.name.toLowerCase()]&&(t=!0),void 0!==b.globalScope[a.argument.name.toLowerCase()]&&(t=!0),!1===t&&g.push({line:null===a?0:a.loc.start.line,character:null===a?0:a.loc.start.column,reason:"Identifier "+
a.argument.name+" has not been declared."}))),"MemberExpression"===a.argument.type&&r(a.argument,b,d,g,f));break;case "AssignmentExpression":"Identifier"!==a.left.type&&"MemberExpression"!==a.left.type&&g.push(u(a,"SYNTAX","ASSIGNMENTTOVARSONLY"));switch(a.operator){case "\x3d":case "/\x3d":case "*\x3d":case "%\x3d":case "+\x3d":case "-\x3d":break;default:g.push(u(a,"SYNTAX","OPERATORNOTRECOGNISED"))}r(a.right,b,d,g,f);t=!1;"Identifier"===a.left.type&&(null!==b.localScope&&void 0!==b.localScope[a.left.name.toLowerCase()]&&
(t=!0),void 0!==b.globalScope[a.left.name.toLowerCase()]&&(t=!0),!1===d&&!1===t&&g.push({line:null===a?0:a.loc.start.line,character:null===a?0:a.loc.start.column,reason:"Identifier "+a.argument.name+" has not been declared."}));"MemberExpression"===a.left.type&&r(a.left,b,d,g,f);break;case "ExpressionStatement":r(a.expression,b,d,g,f);break;case "Identifier":var l=a.name.toLowerCase();if(null!==b.localScope&&void 0!==b.localScope[l])break;void 0===b.globalScope[l]&&!1===d&&g.push(u(a,"SYNTAX","VARIABLENOTFOUND"));
break;case "MemberExpression":r(a.object,b,d,g,f);!0===a.computed&&r(a.property,b,d,g,f);break;case "Literal":return"";case "ThisExpression":g.push(u(a,"SYNTAX","NOTSUPPORTED"));break;case "CallExpression":"Identifier"!==a.callee.type&&g.push(u(a,"SYNTAX","ONLYNODESSUPPORTED"));for(h=0;h<a.arguments.length;h++)r(a.arguments[h],b,d,g,f);var n=q(a.callee.name,a.arguments,b);!1===d&&-1===n&&g.push(u(a,"SYNTAX","NOTFOUND"));-2===n&&g.push(u(a,"SYNTAX","WRONGSIGNATURE"));break;case "UnaryExpression":r(a.argument,
b,d,g,f);break;case "BinaryExpression":r(a.left,b,d,g,f);r(a.right,b,d,g,f);switch(a.operator){case "\x3d\x3d":case "!\x3d":case "\x3c":case "\x3c\x3d":case "\x3e":case "\x3e\x3d":case "+":case "-":case "*":case "/":case "%":break;default:g.push(u(a,"SYNTAX","OPERATORNOTRECOGNISED"))}break;case "LogicalExpression":switch(a.operator){case "\x26\x26":case "||":break;default:g.push(u(a,"SYNTAX","OPERATORNOTRECOGNISED"))}r(a.left,b,d,g,f);"AssignmentExpression"!==a.left.type&&"UpdateExpression"!==a.left.type||
g.push(u(a,"SYNTAX","CANNOT_USE_ASSIGNMENT_IN_CONDITION"));r(a.right,b,d,g,f);"AssignmentExpression"!==a.right.type&&"UpdateExpression"!==a.right.type||g.push(u(a,"SYNTAX","CANNOT_USE_ASSIGNMENT_IN_CONDITION"));break;case "ConditionalExpression":g.push(u(a,"SYNTAX","NOTSUPPORTED"));break;case "ArrayExpression":for(h=0;h<a.elements.length;h++)r(a.elements[h],b,d,g,f);break;case "Array":g.push(u(a,"SYNTAX","NOTSUPPORTED"));case "ObjectExpression":for(h=0;h<a.properties.length;h++)r(a.properties[h],
b,d,g,f);break;case "Property":"Literal"!==a.key.type&&"Identifier"!==a.key.type&&g.push(u(a,"SYNTAX","ONLYLITERAL"));"Literal"===a.key.type&&r(a.key,b,d,g,f);r(a.value,b,d,g,f);break;default:g.push(u(a,"SYNTAX","UNRECOGNISED"))}}catch(D){g.push({line:null===a?0:a.loc.start.line,character:null===a?0:a.loc.start.column,reason:"Unnexpected Syntax"})}}function t(a,b){var c=[],d;try{switch(a.type){case "VariableDeclarator":return null!==a.init?t(a.init,b):c;case "FunctionDeclaration":return t(a.body,
b);case "VariableDeclaration":for(var g=0;g<a.declarations.length;g++)d=t(a.declarations[g],b),c=c.concat(d);return c;case "ForInStatement":return d=t(a.left,b),c=c.concat(d),d=t(a.right,b),c=c.concat(d),d=t(a.body,b),c=c.concat(d);case "ForStatement":return null!==a.init&&(d=t(a.init,b),c=c.concat(d)),null!==a.test&&(d=t(a.test,b),c=c.concat(d)),null!==a.body&&(d=t(a.body,b),c=c.concat(d)),null!==a.update&&(d=t(a.update,b),c=c.concat(d)),c;case "IfStatement":return d=t(a.test,b),c=c.concat(d),null!==
a.consequent&&(d=t(a.consequent,b),c=c.concat(d)),null!==a.alternate&&(d=t(a.alternate,b),c=c.concat(d)),c;case "EmptyStatement":return c;case "BlockStatement":for(g=0;g<a.body.length;g++)d=t(a.body[g],b),c=c.concat(d);return c;case "ReturnStatement":return null!==a.argument?t(a.argument,b):c;case "UpdateExpression":return t(a.argument,b);case "AssignmentExpression":return c=t(a.left,b),c=c.concat(t(a.right,b));case "ExpressionStatement":return t(a.expression,b);case "BreakStatement":return c;case "ContinueStatement":return c;
case "Compound":return c;case "Identifier":return c;case "MemberExpression":return c;case "Literal":return c;case "ThisExpression":return c;case "CallExpression":for(g=0;g<a.arguments.length;g++)d=t(a.arguments[g],b),c=c.concat(d);c.push(a.callee.name.toLowerCase());return c;case "ArrayExpression":for(g=0;g<a.elements.length;g++)d=t(a.elements[g],b),c=c.concat(d);return c;case "UnaryExpression":return t(a.argument,b);case "ObjectExpression":for(g=0;g<a.properties.length;g++)d=t(a.properties[g],b),
c=c.concat(d);return c;case "Property":return t(a.value,b);case "BinaryExpression":return d=t(a.left,b),c=c.concat(d),d=t(a.right,b),c=c.concat(d);case "LogicalExpression":return d=t(a.left,b),c=c.concat(d),d=t(a.right,b),c=c.concat(d);case "ConditionalExpression":return c;case "Array":return c;default:return c}}catch(A){throw A;}}Object.defineProperty(e,"__esModule",{value:!0});e.functionDecls={concatenate:{min:"0",max:"*",av:"a"},split:{min:"2",max:"4",av:"a"},guid:{min:"0",max:"1",av:"a"},today:{min:"0",
max:"0",av:"a"},now:{min:"0",max:"0",av:"a"},timestamp:{min:"0",max:"0",av:"a"},day:{min:"1",max:"1",av:"a"},month:{min:"1",max:"1",av:"a"},year:{min:"1",max:"1",av:"a"},hour:{min:"1",max:"1",av:"a"},second:{min:"1",max:"1",av:"a"},millisecond:{min:"1",max:"1",av:"a"},minute:{min:"1",max:"1",av:"a"},weekday:{min:"1",max:"1",av:"a"},toutc:{min:"1",max:"1",av:"a"},tolocal:{min:"1",max:"1",av:"a"},date:{min:"0",max:"7",av:"a"},datediff:{min:"2",max:"3",av:"a"},dateadd:{min:"2",max:"3",av:"a"},trim:{min:"1",
max:"1",av:"a"},text:{min:"1",max:"2",av:"a"},left:{min:"2",max:"2",av:"a"},right:{min:"2",max:"2",av:"a"},mid:{min:"2",max:"3",av:"a"},upper:{min:"1",max:"1",av:"a"},proper:{min:"1",max:"2",av:"a"},lower:{min:"1",max:"1",av:"a"},find:{min:"2",max:"3",av:"a"},iif:{min:"3",max:"3",av:"a"},decode:{min:"2",max:"*",av:"a"},when:{min:"2",max:"*",av:"a"},defaultvalue:{min:"2",max:"2",av:"a"},isempty:{min:"1",max:"1",av:"a"},domaincode:{min:"3",max:"4",av:"a"},domainname:{min:"2",max:"4",av:"a"},polygon:{min:"1",
max:"1",av:"a"},point:{min:"1",max:"1",av:"a"},polyline:{min:"1",max:"1",av:"a"},extent:{min:"1",max:"1",av:"a"},multipoint:{min:"1",max:"1",av:"a"},geometry:{min:"1",max:"1",av:"a"},count:{min:"0",max:"*",av:"a"},number:{min:"1",max:"2",av:"a"},acos:{min:"1",max:"1",av:"a"},asin:{min:"1",max:"1",av:"a"},atan:{min:"1",max:"1",av:"a"},atan2:{min:"2",max:"2",av:"a"},ceil:{min:"1",max:"2",av:"a"},floor:{min:"1",max:"2",av:"a"},round:{min:"1",max:"2",av:"a"},cos:{min:"1",max:"1",av:"a"},exp:{min:"1",
max:"1",av:"a"},log:{min:"1",max:"1",av:"a"},min:{min:"0",max:"*",av:"a"},constrain:{min:"3",max:"3",av:"a"},console:{min:"0",max:"*",av:"a"},max:{min:"0",max:"*",av:"a"},pow:{min:"2",max:"2",av:"a"},random:{min:"0",max:"0",av:"a"},sqrt:{min:"1",max:"1",av:"a"},sin:{min:"1",max:"1",av:"a"},tan:{min:"1",max:"1",av:"a"},abs:{min:"1",max:"1",av:"a"},isnan:{min:"1",max:"1",av:"a"},stdev:{min:"0",max:"*",av:"a"},average:{min:"0",max:"*",av:"a"},mean:{min:"0",max:"*",av:"a"},sum:{min:"0",max:"*",av:"a"},
variance:{min:"0",max:"*",av:"a"},distinct:{min:"0",max:"*",av:"a"},first:{min:"1",max:"1",av:"a"},top:{min:"2",max:"2",av:"a"},"boolean":{min:"1",max:"1",av:"a"},dictionary:{min:"0",max:"*",av:"a"},"typeof":{min:"1",max:"1",av:"a"},reverse:{min:"1",max:"1",av:"a"},replace:{min:"3",max:"4",av:"a"},sort:{min:"1",max:"2",av:"a"},feature:{min:"1",max:"*",av:"a"},haskey:{min:"2",max:"2",av:"a"},indexof:{min:"2",max:"2",av:"a"},disjoint:{min:"2",max:"2",av:"a"},intersects:{min:"2",max:"2",av:"a"},touches:{min:"2",
max:"2",av:"a"},crosses:{min:"2",max:"2",av:"a"},within:{min:"2",max:"2",av:"a"},contains:{min:"2",max:"2",av:"a"},overlaps:{min:"2",max:"2",av:"a"},equals:{min:"2",max:"2",av:"a"},relate:{min:"3",max:"3",av:"a"},intersection:{min:"2",max:"2",av:"a"},union:{min:"1",max:"2",av:"a"},difference:{min:"2",max:"2",av:"a"},symmetricdifference:{min:"2",max:"2",av:"a"},clip:{min:"2",max:"2",av:"a"},cut:{min:"2",max:"2",av:"a"},area:{min:"1",max:"2",av:"a"},areageodetic:{min:"1",max:"2",av:"a"},length:{min:"1",
max:"2",av:"a"},lengthgeodetic:{min:"1",max:"2",av:"a"},distance:{min:"2",max:"3",av:"a"},densify:{min:"2",max:"3",av:"a"},densifygeodetic:{min:"2",max:"3",av:"a"},generalize:{min:"2",max:"4",av:"a"},buffer:{min:"2",max:"3",av:"a"},buffergeodetic:{min:"2",max:"3",av:"a"},offset:{min:"2",max:"6",av:"a"},rotate:{min:"2",max:"3",av:"a"},issimple:{min:"1",max:"1",av:"a"},simplify:{min:"1",max:"1",av:"a"},centroid:{min:"1",max:"1",av:"a"},multiparttosinglepart:{min:"1",max:"1",av:"a"},setgeometry:{min:"2",
max:"2",av:"a"}};e.addFunctionDeclaration=function(a,b){var c=e.functionDecls[a.name.toLowerCase()];void 0===c?e.functionDecls[a.name.toLowerCase()]={min:a.min,max:a.max,av:b}:"a"===c.av&&"f"===b?(void 0!==c.fmin&&delete c.fmin,void 0!==c.fmax&&delete c.fmax,c.fmin=a.min,c.fmax=a.max):"f"===c.av&&"a"===b?(void 0===c.fmin&&(c.fmin=c.min),void 0===c.fmax&&(c.fmax=c.max),c.min=a.min,c.max=a.max,c.av="a"):"f"===b?(c.fmin=a.min,c.fmax=a.max):"a"===b&&(c.min=a.min,c.max=a.max)};e.checkFunctionSignature=
p;e.findFunction=q;e.validateLanguageNode=n;e.testValidityOfExpression=l;e.referencesMemberImpl=h;e.referencesMember=function(a,b){return!0===h(a.body[0].body,b.toLowerCase())?!0:!1};e.referencesFunctionImpl=f;e.referencesFunction=function(a,b){return!0===f(a.body[0].body,b)?!0:!1};e.findFieldLiteralsImpl=d;e.findFieldLiterals=function(a,b){return d(a.body[0].body,b)};e.extractFunctionDeclaration=c;e.validateFunction=a;e.constructGlobalScope=b;e.validateScript=function(a,c,d){void 0===d&&(d="full");
c={globalScope:b(c.vars,e.functionDecls,c.customFunctions,d),localScope:null};return l(a.body[0].body,c)};e.validateLanguage=function(a){return"BlockStatement"!==a.body[0].body.type?"Invalid formula content.":n(a.body[0].body)};e.nodeErrorMessage=g;e.makeError=u;e.extractAllIssuesInFunction=m;e.extractAllIssues=r;e.checkScript=function(a,c,d,g){void 0===g&&(g="full");var m=[];if("BlockStatement"!==a.body[0].body.type)return[{line:0,character:0,reason:"Invalid Body"}];if(null===c||void 0===c)c={vars:{},
customFunctions:[]};c={globalScope:b(c.vars,e.functionDecls,c.customFunctions,g),localScope:null};try{r(a.body[0].body,c,d,m)}catch(A){}return m};e.findFunctionCallsImpl=t;e.findFunctionCalls=function(a,b){return t(a.body[0].body,b)}})},"esri/arcade/Feature":function(){define("require exports dojo/_base/lang ../geometry/Geometry ../geometry/jsonUtils ./Dictionary ./languageUtils ./ImmutableArray ../geometry/Point".split(" "),function(k,e,p,q,n,l,h,f,d){return function(){function c(a,b,d){this._layer=
this.attributes=this.geometry=null;this.immutable=this._datesfixed=!0;a instanceof c?(this.attributes=a.attributes,this.geometry=a.geometry,a._layer&&(this._layer=a._layer)):a&&"esri.Graphic"===a.declaredClass?(this.geometry=a.geometry,this.attributes=void 0===a.attributes?{}:null===a.attributes?{}:a.attributes,a._sourceLayer?(this._layer=a._sourceLayer,this._datesfixed=!1):a._layer?(this._layer=a._layer,this._datesfixed=!1):a.layer&&(this._layer=a.layer,this._datesfixed=!1)):a instanceof l?(this.attributes=
a.field("attributes"),null!==this.attributes&&(this.attributes=this.attributes instanceof l?this.attributes.attributes:null),this.geometry=a.field("geometry"),null!==this.geometry&&(this.geometry instanceof l?this.geometry=c.parseGeometryFromDictionary(this.geometry):this.geometry instanceof q||(this.geometry=null))):(b instanceof q||null===b?(this.geometry=b,this.attributes=void 0===a?{}:null===a?{}:a):"string"===typeof a?(a=JSON.parse(a),null!==a.geometry&&void 0!==a.geometry&&(this.geometry=n.fromJson(a.geometry)),
this.attributes=void 0===a.attributes?{}:null===a.attributes?{}:a.attributes):(void 0===a?this.attributes={}:null===a&&(this.attributes={}),this.geometry=null),void 0!==d&&(this._layer=d))}c.prototype.castToText=function(){var a="",b;for(b in this.attributes){""!==a&&(a+=",");var c=this.attributes[b];null==c?a+=JSON.stringify(b)+":null":h.isBoolean(c)||h.isNumber(c)||h.isString(c)?a+=JSON.stringify(b)+":"+JSON.stringify(c):c instanceof q?a+=JSON.stringify(b)+":"+h.toStringExplicit(c):c instanceof
f?a+=JSON.stringify(b)+":"+h.toStringExplicit(c):c instanceof Array?a+=JSON.stringify(b)+":"+h.toStringExplicit(c):c instanceof Date?a+=JSON.stringify(b)+":"+JSON.stringify(c):null!==c&&"object"===typeof c&&void 0!==c.castToText&&(a+=JSON.stringify(b)+":"+c.castToText())}return'{"geometry":'+(null===this.geometry?"null":h.toStringExplicit(this.geometry))+',"attributes":{'+a+"}}"};c.prototype._fixDates=function(){for(var a=[],b=0;b<this._layer.fields.length;b++){var c=this._layer.fields[b];"date"!==
c.type&&"esriFieldTypeDate"!==c.type||a.push(c.name)}0<a.length&&this._fixDateFields(a);this._datesfixed=!0};c.prototype._fixDateFields=function(a){this.attributes=p.mixin({},this.attributes);for(var b=0;b<a.length;b++){var c=this.attributes[a[b]];if(null!==c)if(void 0===c)for(var d in this.attributes){if(d.toLowerCase()===a[b]){c=this.attributes[d];null===c||c instanceof Date||(this.attributes[d]=new Date(c));break}}else c instanceof Date||(this.attributes[a[b]]=new Date(c))}};c.prototype.field=
function(a){!1===this._datesfixed&&this._fixDates();var b=a.toLowerCase();a=this.attributes[a];if(void 0!==a)return a;for(var c in this.attributes)if(c.toLowerCase()===b)return this.attributes[c];if(this._hasFieldDefinition(b))return null;throw Error("Field not Found");};c.prototype._hasFieldDefinition=function(a){if(null===this._layer)return!1;for(var b=0;b<this._layer.fields.length;b++)if(this._layer.fields[b].name.toLowerCase()===a)return!0;return!1};c.prototype._field=function(a){!1===this._datesfixed&&
this._fixDates();var b=a.toLowerCase();a=this.attributes[a];if(void 0!==a)return a;for(var c in this.attributes)if(c.toLowerCase()===b)return this.attributes[c];return null};c.prototype.setField=function(a,b){if(this.immutable)throw Error("Feature is Immutable");if(!1===h.isSimpleType(b))throw Error("Illegal Value Assignment to Feature");var c=a.toLowerCase();if(void 0===this.attributes[a])for(var d in this.attributes)if(d.toLowerCase()===c){this.attributes[d]=b;return}this.attributes[a]=b};c.prototype.hasField=
function(a){var b=a.toLowerCase();if(void 0!==this.attributes[a])return!0;for(var c in this.attributes)if(c.toLowerCase()===b)return!0;return this._hasFieldDefinition(b)?!0:!1};c.prototype.keys=function(){var a=[],b={},c;for(c in this.attributes)a.push(c),b[c.toLowerCase()]=1;if(null!==this._layer)for(c=0;c<this._layer.fields.length;c++){var d=this._layer.fields[c];1!==b[d.name.toLowerCase()]&&a.push(d.name)}return a=a.sort()};c.fromFeature=function(a){return new c(a)};c.parseGeometryFromDictionary=
function(a){a=c.convertDictionaryToJson(a,!0);void 0!==a.spatialreference&&(a.spatialReference=a.spatialreference,delete a.spatialreference);void 0!==a.rings&&(a.rings=this.fixPathArrays(a.rings,!0===a.hasZ,!0===a.hasM));void 0!==a.paths&&(a.paths=this.fixPathArrays(a.paths,!0===a.hasZ,!0===a.hasM));void 0!==a.points&&(a.points=this.fixPointArrays(a.points,!0===a.hasZ,!0===a.hasM));return n.fromJson(a)};c.fixPathArrays=function(a,b,c){var d=[];if(a instanceof Array)for(var g=0;g<a.length;g++)d.push(this.fixPointArrays(a[g],
b,c));else if(a instanceof f)for(g=0;g<a.length();g++)d.push(this.fixPointArrays(a.get(g),b,c));return d};c.fixPointArrays=function(a,b,c){var g=[];if(a instanceof Array)for(var m=0;m<a.length;m++){var r=a[m];r instanceof d?b&&c?g.push([r.x,r.y,r.z,r.m]):b?g.push([r.x,r.y,r.z]):c?g.push([r.x,r.y,r.m]):g.push([r.x,r.y]):g.push(r)}else if(a instanceof f)for(m=0;m<a.length();m++)r=a.get(m),r instanceof d?b&&c?g.push([r.x,r.y,r.z,r.m]):b?g.push([r.x,r.y,r.z]):c?g.push([r.x,r.y,r.m]):g.push([r.x,r.y]):
g.push(r);return g};c.convertDictionaryToJson=function(a,b){void 0===b&&(b=!1);var d={},f;for(f in a.attributes){var m=a.attributes[f];m instanceof l&&(m=c.convertDictionaryToJson(m));b?d[f.toLowerCase()]=m:d[f]=m}return d};c.parseAttributesFromDictionary=function(a){var b={},c;for(c in a.attributes){var d=a.attributes[c];if(h.isSimpleType(d))b[c]=d;else throw Error("Illegal Argument");}return b};c.fromJson=function(a){var b=null;null!==a.geometry&&void 0!==a.geometry&&(b=n.fromJson(a.geometry));
var d={};if(null!==a.attributes&&void 0!==a.attributes)for(var f in a.attributes){var m=a.attributes[f];if(h.isString(m)||h.isNumber(m)||h.isBoolean(m)||h.isDate(m))d[f]=m;else throw Error("Illegal Argument");}return new c(d,b)};c.prototype.domainValueLookup=function(a,b,c){if(null===this._layer||!this._layer.fields)return null;c=h.getDomain(a,this._layer,this,c);if(void 0===b)try{b=this.field(a)}catch(u){return null}return h.getDomainValue(c,b)};c.prototype.domainCodeLookup=function(a,b,c){if(null===
this._layer||!this._layer.fields)return null;a=h.getDomain(a,this._layer,this,c);return h.getDomainCode(a,b)};return c}()})},"esri/arcade/functions/date":function(){define(["require","exports","../../moment","../languageUtils"],function(k,e,p,q){function n(l){return null===l?l:isNaN(l.getTime())?null:l}Object.defineProperty(e,"__esModule",{value:!0});e.registerFunctions=function(l,h){l.today=function(f,d){return h(f,d,function(c,a,b){q.pcCheck(b,0,0);c=new Date;c.setHours(0,0,0,0);return c})};l.now=
function(f,d){return h(f,d,function(c,a,b){q.pcCheck(b,0,0);return new Date})};l.timestamp=function(f,d){return h(f,d,function(c,a,b){q.pcCheck(b,0,0);c=new Date;return c=new Date(c.getUTCFullYear(),c.getUTCMonth(),c.getUTCDate(),c.getUTCHours(),c.getUTCMinutes(),c.getUTCSeconds(),c.getUTCMilliseconds())})};l.toutc=function(f,d){return h(f,d,function(c,a,b){q.pcCheck(b,1,1);c=q.toDate(b[0]);return null===c?null:new Date(c.getUTCFullYear(),c.getUTCMonth(),c.getUTCDate(),c.getUTCHours(),c.getUTCMinutes(),
c.getUTCSeconds(),c.getUTCMilliseconds())})};l.tolocal=function(f,d){return h(f,d,function(c,a,b){q.pcCheck(b,1,1);c=q.toDate(b[0]);return null===c?null:p.utc([c.getFullYear(),c.getMonth(),c.getDate(),c.getHours(),c.getMinutes(),c.getSeconds(),c.getMilliseconds()]).toDate()})};l.day=function(f,d){return h(f,d,function(c,a,b){q.pcCheck(b,1,1);c=q.toDate(b[0]);return null===c?NaN:c.getDate()})};l.month=function(f,d){return h(f,d,function(c,a,b){q.pcCheck(b,1,1);c=q.toDate(b[0]);return null===c?NaN:
c.getMonth()})};l.year=function(f,d){return h(f,d,function(c,a,b){q.pcCheck(b,1,1);c=q.toDate(b[0]);return null===c?NaN:c.getFullYear()})};l.hour=function(f,d){return h(f,d,function(c,a,b){q.pcCheck(b,1,1);c=q.toDate(b[0]);return null===c?NaN:c.getHours()})};l.second=function(f,d){return h(f,d,function(c,a,b){q.pcCheck(b,1,1);c=q.toDate(b[0]);return null===c?NaN:c.getSeconds()})};l.millisecond=function(f,d){return h(f,d,function(c,a,b){q.pcCheck(b,1,1);c=q.toDate(b[0]);return null===c?NaN:c.getMilliseconds()})};
l.minute=function(f,d){return h(f,d,function(c,a,b){q.pcCheck(b,1,1);c=q.toDate(b[0]);return null===c?NaN:c.getMinutes()})};l.weekday=function(f,d){return h(f,d,function(c,a,b){q.pcCheck(b,1,1);c=q.toDate(b[0]);return null===c?NaN:c.getDay()})};l.date=function(f,d){return h(f,d,function(c,a,b){q.pcCheck(b,0,7);if(3===b.length)return n(new Date(q.toNumber(b[0]),q.toNumber(b[1]),q.toNumber(b[2]),0,0,0,0));if(4===b.length)return n(new Date(q.toNumber(b[0]),q.toNumber(b[1]),q.toNumber(b[2]),q.toNumber(b[3]),
0,0,0));if(5===b.length)return n(new Date(q.toNumber(b[0]),q.toNumber(b[1]),q.toNumber(b[2]),q.toNumber(b[3]),q.toNumber(b[4]),0,0));if(6===b.length)return n(new Date(q.toNumber(b[0]),q.toNumber(b[1]),q.toNumber(b[2]),q.toNumber(b[3]),q.toNumber(b[4]),q.toNumber(b[5]),0));if(7===b.length)return n(new Date(q.toNumber(b[0]),q.toNumber(b[1]),q.toNumber(b[2]),q.toNumber(b[3]),q.toNumber(b[4]),q.toNumber(b[5]),q.toNumber(b[6])));if(2===b.length){c=q.toString(b[1]);if(""===c)return null;c=q.standardiseDateFormat(c);
b=p(q.toString(b[0]),c,!0);return!0===b.isValid()?b.toDate():null}if(1===b.length){if(q.isString(b[0])&&""===b[0].replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""))return null;c=q.toNumber(b[0]);return!1===isNaN(c)?n(new Date(c)):q.toDate(b[0])}if(0===b.length)return new Date})};l.datediff=function(f,d){return h(f,d,function(c,a,b){q.pcCheck(b,2,3);c=q.toDateM(b[0]);a=q.toDateM(b[1]);if(null===c||null===a)return NaN;switch(q.toString(b[2]).toLowerCase()){case "days":case "day":case "d":return c.diff(a,
"days",!0);case "months":case "month":return c.diff(a,"months",!0);case "minutes":case "minute":case "m":return"M"===b[2]?c.diff(a,"months",!0):c.diff(a,"minutes",!0);case "seconds":case "second":case "s":return c.diff(a,"seconds",!0);case "milliseconds":case "millisecond":case "ms":return c.diff(a);case "hours":case "hour":case "h":return c.diff(a,"hours",!0);case "years":case "year":case "y":return c.diff(a,"years",!0);default:return c.diff(a)}})};l.dateadd=function(f,d){return h(f,d,function(c,
a,b){q.pcCheck(b,2,3);c=q.toDateM(b[0]);if(null===c)return null;a="milliseconds";switch(q.toString(b[2]).toLowerCase()){case "days":case "day":case "d":a="days";break;case "months":case "month":a="months";break;case "minutes":case "minute":case "m":a="M"===b[2]?"months":"minutes";break;case "seconds":case "second":case "s":a="seconds";break;case "milliseconds":case "millisecond":case "ms":a="milliseconds";break;case "hours":case "hour":case "h":a="hours";break;case "years":case "year":case "y":a=
"years"}c.add(q.toNumber(b[1]),a);return c.toDate()})}}})},"esri/arcade/functions/string":function(){define(["require","exports","../languageUtils","../Feature"],function(k,e,p,q){Object.defineProperty(e,"__esModule",{value:!0});e.registerFunctions=function(n,l){n.trim=function(h,f){return l(h,f,function(d,c,a){p.pcCheck(a,1,1);return p.toString(a[0]).trim()})};n.upper=function(h,f){return l(h,f,function(d,c,a){p.pcCheck(a,1,1);return p.toString(a[0]).toUpperCase()})};n.proper=function(h,f){return l(h,
f,function(d,c,a){p.pcCheck(a,1,2);d=1;2===a.length&&"firstword"===p.toString(a[1]).toLowerCase()&&(d=2);c=/\s/;a=p.toString(a[0]);for(var b="",g=!0,f=0;f<a.length;f++){var m=a[f];c.test(m)?1===d&&(g=!0):m.toUpperCase()!==m.toLowerCase()&&(g?(m=m.toUpperCase(),g=!1):m=m.toLowerCase());b+=m}return b})};n.lower=function(h,f){return l(h,f,function(d,c,a){p.pcCheck(a,1,1);return p.toString(a[0]).toLowerCase()})};n.guid=function(h,f){return l(h,f,function(d,c,a){p.pcCheck(a,0,1);if(0<a.length)switch(p.toString(a[0]).toLowerCase()){case "digits":return p.generateUUID().replace("-",
"").replace("-","").replace("-","").replace("-","");case "digits-hyphen":return p.generateUUID();case "digits-hyphen-parentheses":return"("+p.generateUUID()+")"}return"{"+p.generateUUID()+"}"})};n.console=function(h,f){return l(h,f,function(d,c,a){0!==a.length&&(1===a.length?h.console(p.toString(a[0])):h.console(p.toString(a)));return p.voidOperation})};n.mid=function(h,f){return l(h,f,function(d,c,a){p.pcCheck(a,2,3);d=p.toNumber(a[1]);if(isNaN(d))return"";0>d&&(d=0);if(2===a.length)return p.toString(a[0]).substr(d);
c=p.toNumber(a[2]);if(isNaN(c))return"";0>c&&(c=0);return p.toString(a[0]).substr(d,c)})};n.find=function(h,f){return l(h,f,function(d,c,a){p.pcCheck(a,2,3);d=0;if(2<a.length){d=p.toNumber(p.defaultUndefined(a[2],0));if(isNaN(d))return-1;0>d&&(d=0)}return p.toString(a[1]).indexOf(p.toString(a[0]),d)})};n.left=function(h,f){return l(h,f,function(d,c,a){p.pcCheck(a,2,2);d=p.toNumber(a[1]);if(isNaN(d))return"";0>d&&(d=0);return p.toString(a[0]).substr(0,d)})};n.right=function(h,f){return l(h,f,function(d,
c,a){p.pcCheck(a,2,2);d=p.toNumber(a[1]);if(isNaN(d))return"";0>d&&(d=0);return p.toString(a[0]).substr(-1*d,d)})};n.split=function(h,f){return l(h,f,function(d,c,a){p.pcCheck(a,2,4);d=p.toNumber(p.defaultUndefined(a[2],-1));c=p.toBoolean(p.defaultUndefined(a[3],!1));-1===d||null===d||!0===c?a=p.toString(a[0]).split(p.toString(a[1])):(isNaN(d)&&(d=-1),-1>d&&(d=-1),a=p.toString(a[0]).split(p.toString(a[1]),d));if(!1===c)return a;c=[];for(var b=0;b<a.length&&!(-1!==d&&c.length>=d);b++)""!==a[b]&&void 0!==
a[b]&&c.push(a[b]);return c})};n.text=function(h,f){return l(h,f,function(d,c,a){p.pcCheck(a,1,2);return p.toStringExplicit(a[0],a[1])})};n.concatenate=function(h,f){return l(h,f,function(d,c,a){d=[];if(1>a.length)return"";if(p.isArray(a[0])){c=p.defaultUndefined(a[2],"");for(var b=0;b<a[0].length;b++)d[b]=p.toStringExplicit(a[0][b],c);return 1<a.length?d.join(a[1]):d.join("")}if(p.isImmutableArray(a[0])){c=p.defaultUndefined(a[2],"");for(b=0;b<a[0].length();b++)d[b]=p.toStringExplicit(a[0].get(b),
c);return 1<a.length?d.join(a[1]):d.join("")}for(b=0;b<a.length;b++)d[b]=p.toStringExplicit(a[b]);return d.join("")})};n.reverse=function(h,f){return l(h,f,function(d,c,a){p.pcCheck(a,1,1);if(p.isArray(a[0]))return d=a[0].slice(0),d.reverse(),d;if(p.isImmutableArray(a[0]))return d=a[0].toArray().slice(0),d.reverse(),d;throw Error("Invalid Parameter");})};n.replace=function(h,f){return l(h,f,function(d,c,a){p.pcCheck(a,3,4);d=p.toString(a[0]);c=p.toString(a[1]);var b=p.toString(a[2]);return(4===a.length?
p.toBoolean(a[3]):1)?p.multiReplace(d,c,b):d.replace(c,b)})};n.domainname=function(h,f){return l(h,f,function(d,c,a){p.pcCheck(a,2,4);if(a[0]instanceof q)return a[0].domainValueLookup(p.toString(a[1]),a[2],void 0===a[3]?void 0:p.toNumber(a[3]));throw Error("Invalid Parameter");})};n.domaincode=function(h,f){return l(h,f,function(d,c,a){p.pcCheck(a,3,4);if(a[0]instanceof q)return a[0].domainCodeLookup(p.toString(a[1]),a[2],void 0===a[3]?void 0:p.toNumber(a[3]));throw Error("Invalid Parameter");})}}})},
"esri/arcade/functions/maths":function(){define(["require","exports","../languageUtils","dojo/number"],function(k,e,p,q){function n(l,h,f){if("undefined"===typeof f||0===+f)return Math[l](h);h=+h;f=+f;if(isNaN(h)||"number"!==typeof f||0!==f%1)return NaN;h=h.toString().split("e");h=Math[l](+(h[0]+"e"+(h[1]?+h[1]-f:-f)));h=h.toString().split("e");return+(h[0]+"e"+(h[1]?+h[1]+f:f))}Object.defineProperty(e,"__esModule",{value:!0});e.registerFunctions=function(l,h){function f(d,c,a){d=p.toNumber(d);return isNaN(d)?
d:isNaN(c)||isNaN(a)||c>a?NaN:d<c?c:d>a?a:d}l.number=function(d,c){return h(d,c,function(a,b,c){p.pcCheck(c,1,2);a=c[0];return p.isNumber(a)?a:null===a?0:p.isDate(a)||p.isBoolean(a)?Number(a):p.isArray(a)?NaN:""===a||void 0===a?Number(a):p.isString(a)?void 0!==c[1]?(c=p.multiReplace(c[1],"\u2030",""),c=p.multiReplace(c,"\u00a4",""),q.parse(a,{pattern:c})):Number(a.trim()):Number(a)})};l.abs=function(d,c){return h(d,c,function(a,b,c){p.pcCheck(c,1,1);return Math.abs(p.toNumber(c[0]))})};l.acos=function(d,
c){return h(d,c,function(a,b,c){p.pcCheck(c,1,1);return Math.acos(p.toNumber(c[0]))})};l.asin=function(d,c){return h(d,c,function(a,b,c){p.pcCheck(c,1,1);return Math.asin(p.toNumber(c[0]))})};l.atan=function(d,c){return h(d,c,function(a,b,c){p.pcCheck(c,1,1);return Math.atan(p.toNumber(c[0]))})};l.atan2=function(d,c){return h(d,c,function(a,b,c){p.pcCheck(c,2,2);return Math.atan2(p.toNumber(c[0]),p.toNumber(c[1]))})};l.ceil=function(d,c){return h(d,c,function(a,b,c){p.pcCheck(c,1,2);return 2===c.length?
(a=p.toNumber(c[1]),isNaN(a)&&(a=0),n("ceil",p.toNumber(c[0]),-1*a)):Math.ceil(p.toNumber(c[0]))})};l.round=function(d,c){return h(d,c,function(a,b,c){p.pcCheck(c,1,2);return 2===c.length?(a=p.toNumber(c[1]),isNaN(a)&&(a=0),n("round",p.toNumber(c[0]),-1*a)):Math.round(p.toNumber(c[0]))})};l.floor=function(d,c){return h(d,c,function(a,b,c){p.pcCheck(c,1,2);return 2===c.length?(a=p.toNumber(c[1]),isNaN(a)&&(a=0),n("floor",p.toNumber(c[0]),-1*a)):Math.floor(p.toNumber(c[0]))})};l.cos=function(d,c){return h(d,
c,function(a,b,c){p.pcCheck(c,1,1);return Math.cos(p.toNumber(c[0]))})};l.isnan=function(d,c){return h(d,c,function(a,b,c){p.pcCheck(c,1,1);return"number"===typeof c[0]&&isNaN(c[0])})};l.exp=function(d,c){return h(d,c,function(a,b,c){p.pcCheck(c,1,1);return Math.exp(p.toNumber(c[0]))})};l.log=function(d,c){return h(d,c,function(a,b,c){p.pcCheck(c,1,1);return Math.log(p.toNumber(c[0]))})};l.pow=function(d,c){return h(d,c,function(a,b,c){p.pcCheck(c,2,2);return Math.pow(p.toNumber(c[0]),p.toNumber(c[1]))})};
l.random=function(d,c){return h(d,c,function(a,b,c){p.pcCheck(c,0,0);return Math.random()})};l.sin=function(d,c){return h(d,c,function(a,b,c){p.pcCheck(c,1,1);return Math.sin(p.toNumber(c[0]))})};l.sqrt=function(d,c){return h(d,c,function(a,b,c){p.pcCheck(c,1,1);return Math.sqrt(p.toNumber(c[0]))})};l.tan=function(d,c){return h(d,c,function(a,b,c){p.pcCheck(c,1,1);return Math.tan(p.toNumber(c[0]))})};l.defaultvalue=function(d,c){return h(d,c,function(a,b,c){p.pcCheck(c,2,2);return null===c[0]||""===
c[0]||void 0===c[0]?c[1]:c[0]})};l.isempty=function(d,c){return h(d,c,function(a,b,c){p.pcCheck(c,1,1);return null===c[0]||""===c[0]||void 0===c[0]?!0:!1})};l["boolean"]=function(d,c){return h(d,c,function(a,b,c){p.pcCheck(c,1,1);return p.toBoolean(c[0])})};l.constrain=function(d,c){return h(d,c,function(a,b,c){p.pcCheck(c,3,3);a=p.toNumber(c[1]);b=p.toNumber(c[2]);if(p.isArray(c[0])){var d=[],g=0;for(c=c[0];g<c.length;g++)d.push(f(c[g],a,b));return d}if(p.isImmutableArray(c[0])){d=[];for(g=0;g<c[0].length();g++)d.push(f(c[0].get(g),
a,b));return d}return f(c[0],a,b)})}}})},"esri/arcade/functions/geometry":function(){define("require exports ../../geometry/Geometry ../../geometry/Polygon ../../geometry/Polyline ../../geometry/Point ../../geometry/Extent ../../geometry/Multipoint ../../geometry/jsonUtils ../languageUtils ../Dictionary ../Feature".split(" "),function(k,e,p,q,n,l,h,f,d,c,a,b){Object.defineProperty(e,"__esModule",{value:!0});e.registerFunctions=function(g,e){g.polygon=function(g,f){return e(g,f,function(m,f,r){c.pcCheck(r,
1,1);m=null;if(r[0]instanceof a){if(m=c.fixSpatialReference(b.parseGeometryFromDictionary(r[0]),g.spatialReference),!1===m instanceof q)throw Error("Illegal Parameter");}else m=r[0]instanceof q?d.fromJson(r[0].toJson()):c.fixSpatialReference(new q(JSON.parse(r[0])),g.spatialReference);if(null!==m&&!1===m.spatialReference.equals(g.spatialReference))throw Error("Cannot create Geometry in this SpatialReference. Engine is using a different spatial reference.");return c.fixNullGeometry(m)})};g.polyline=
function(g,f){return e(g,f,function(m,f,r){c.pcCheck(r,1,1);m=null;if(r[0]instanceof a){if(m=c.fixSpatialReference(b.parseGeometryFromDictionary(r[0]),g.spatialReference),!1===m instanceof n)throw Error("Illegal Parameter");}else m=r[0]instanceof n?d.fromJson(r[0].toJson()):c.fixSpatialReference(new n(JSON.parse(r[0])),g.spatialReference);if(null!==m&&!1===m.spatialReference.equals(g.spatialReference))throw Error("Cannot create Geometry in this SpatialReference. Engine is using a different spatial reference.");
return c.fixNullGeometry(m)})};g.point=function(g,f){return e(g,f,function(m,f,r){c.pcCheck(r,1,1);m=null;if(r[0]instanceof a){if(m=c.fixSpatialReference(b.parseGeometryFromDictionary(r[0]),g.spatialReference),!1===m instanceof l)throw Error("Illegal Parameter");}else m=r[0]instanceof l?d.fromJson(r[0].toJson()):c.fixSpatialReference(new l(JSON.parse(r[0])),g.spatialReference);if(null!==m&&!1===m.spatialReference.equals(g.spatialReference))throw Error("Cannot create Geometry in this SpatialReference. Engine is using a different spatial reference.");
return c.fixNullGeometry(m)})};g.multipoint=function(g,r){return e(g,r,function(m,r,h){c.pcCheck(h,1,1);m=null;if(h[0]instanceof a){if(m=c.fixSpatialReference(b.parseGeometryFromDictionary(h[0]),g.spatialReference),!1===m instanceof f)throw Error("Illegal Parameter");}else m=h[0]instanceof f?d.fromJson(h[0].toJson()):c.fixSpatialReference(new f(JSON.parse(h[0])),g.spatialReference);if(null!==m&&!1===m.spatialReference.equals(g.spatialReference))throw Error("Cannot create Geometry in this SpatialReference. Engine is using a different spatial reference.");
return c.fixNullGeometry(m)})};g.extent=function(g,r){return e(g,r,function(m,r,e){c.pcCheck(e,1,1);m=null;e[0]instanceof a?m=c.fixSpatialReference(b.parseGeometryFromDictionary(e[0]),g.spatialReference):e[0]instanceof l?(m={xmin:e[0].x,ymin:e[0].y,xmax:e[0].x,ymax:e[0].y,spatialReference:e[0].spatialReference.toJson()},e[0].hasZ?(m.zmin=e[0].z,m.zmax=e[0].z):e[0].hasM&&(m.mmin=e[0].m,m.mmax=e[0].m),m=d.fromJson(m)):m=e[0]instanceof q?d.fromJson(e[0].getExtent().toJson()):e[0]instanceof n?d.fromJson(e[0].getExtent().toJson()):
e[0]instanceof f?d.fromJson(e[0].getExtent().toJson()):e[0]instanceof h?d.fromJson(e[0].toJson()):c.fixSpatialReference(new h(JSON.parse(e[0])),g.spatialReference);if(null!==m&&!1===m.spatialReference.equals(g.spatialReference))throw Error("Cannot create Geometry in this SpatialReference. Engine is using a different spatial reference.");return c.fixNullGeometry(m)})};g.geometry=function(g,f){return e(g,f,function(m,f,r){c.pcCheck(r,1,1);m=null;m=r[0]instanceof b?c.fixSpatialReference(r[0].geometry,
g.spatialReference):r[0]instanceof a?c.fixSpatialReference(b.parseGeometryFromDictionary(r[0]),g.spatialReference):c.fixSpatialReference(d.fromJson(JSON.parse(r[0])),g.spatialReference);if(null!==m&&!1===m.spatialReference.equals(g.spatialReference))throw Error("Cannot create Geometry in this SpatialReference. Engine is using a different spatial reference.");return c.fixNullGeometry(m)})};g.setgeometry=function(a,d){return e(a,d,function(a,d,g){c.pcCheck(g,2,2);if(g[0]instanceof b){if(!0===g[0].immutable)throw Error("Feature is Immutable");
if(g[1]instanceof p||null===g[1])g[0].geometry=g[1];else throw Error("Illegal Argument");}else throw Error("Illegal Argument");return c.voidOperation})};g.feature=function(d,g){return e(d,g,function(g,m,f){if(0===f.length)throw Error("Missing Parameters");g=null;if(1===f.length)if(c.isString(f[0]))g=b.fromJson(JSON.parse(f[0]));else if(f[0]instanceof b)g=new b(f[0]);else if(f[0]instanceof p)g=new b(null,f[0]);else if(f[0]instanceof a)g=f[0].hasField("geometry")?f[0].field("geometry"):null,m=f[0].hasField("attributes")?
f[0].field("attributes"):null,null!==g&&g instanceof a&&(g=b.parseGeometryFromDictionary(g)),null!==m&&(m=b.parseAttributesFromDictionary(m)),g=new b(m,g);else throw Error("Illegal Argument");else{if(2===f.length){m=g=null;if(null!==f[0])if(f[0]instanceof p)g=f[0];else if(g instanceof a)g=b.parseGeometryFromDictionary(f[0]);else throw Error("Illegal Argument");if(null!==f[1])if(f[1]instanceof a)m=b.parseAttributesFromDictionary(f[1]);else throw Error("Illegal Argument");}else{g=null;m={};if(null!==
f[0])if(f[0]instanceof p)g=f[0];else if(g instanceof a)g=b.parseGeometryFromDictionary(f[0]);else throw Error("Illegal Argument");for(var r=1;r<f.length;r+=2){var h=c.toString(f[r]),t=f[r+1];if(null===t||void 0===t||c.isString(t)||isNaN(t)||c.isDate(t)||c.isNumber(t)||c.isBoolean(t)){if(c.isFunctionParameter(t)||!1===c.isSimpleType(t))throw Error("Illegal Argument");m[h]=t===c.voidOperation?null:t}else throw Error("Illegal Argument");}}g=new b(m,g)}g.geometry=c.fixSpatialReference(g.geometry,d.spatialReference);
g.immutable=!1;return g})};g.dictionary=function(b,d){return e(b,d,function(b,d,g){if(0===g.length)throw Error("Missing Parameters");if(0!==g.length%2)throw Error("Missing Parameters");b={};for(d=0;d<g.length;d+=2){var m=c.toString(g[d]),f=g[d+1];if(null===f||void 0===f||c.isString(f)||isNaN(f)||c.isDate(f)||c.isNumber(f)||c.isBoolean(f)||c.isArray(f)||c.isImmutableArray(f)){if(c.isFunctionParameter(f))throw Error("Illegal Argument");b[m]=f===c.voidOperation?null:f}else throw Error("Illegal Argument");
}g=new a(b);g.immutable=!1;return g})};g.haskey=function(d,g){return e(d,g,function(d,g,m){c.pcCheck(m,2,2);d=c.toString(m[1]);if(m[0]instanceof b||m[0]instanceof a)return m[0].hasField(d);throw Error("Illegal Argument");})};g.indexof=function(a,b){return e(a,b,function(a,b,d){c.pcCheck(d,2,2);a=d[1];if(c.isArray(d[0])){for(b=0;b<d[0].length;b++)if(c.equalityTest(a,d[0][b]))return b;return-1}if(c.isImmutableArray(d[0])){var g=d[0].length();for(b=0;b<g;b++)if(c.equalityTest(a,d[0].get(b)))return b;
return-1}throw Error("Illegal Argument");})}}})},"esri/arcade/functions/geomsync":function(){define("require exports ../../geometry/Geometry ../../geometry/Polygon ../../geometry/Polyline ../../geometry/Point ../../geometry/Extent ../../geometry/Multipoint ../../geometry/jsonUtils ./centroid ../languageUtils ../kernel ../../kernel".split(" "),function(k,e,p,q,n,l,h,f,d,c,a,b,g){function u(a){return t?a.clone():d.fromJson(a.toJson())}function m(a){return 0===g.version.indexOf("4.")?q.fromExtent(a):
new q({spatialReference:a.spatialReference,rings:[[[a.xmin,a.ymin],[a.xmin,a.ymax],[a.xmax,a.ymax],[a.xmax,a.ymin],[a.xmin,a.ymin]]]})}Object.defineProperty(e,"__esModule",{value:!0});var r=null,t=0===g.version.indexOf("4.");e.setGeometryEngine=function(a){r=a};e.registerFunctions=function(g,e){function k(b){a.pcCheck(b,2,2);if(!(b[0]instanceof p&&b[1]instanceof p||b[0]instanceof p&&null===b[1]||b[1]instanceof p&&null===b[0]||null===b[0]&&null===b[1]))throw Error("Illegal Argument");}g.disjoint=function(a,
b){return e(a,b,function(a,b,c){k(c);return null===c[0]||null===c[1]?!0:r.disjoint(c[0],c[1])})};g.intersects=function(a,b){return e(a,b,function(a,b,c){k(c);return null===c[0]||null===c[1]?!1:r.intersects(c[0],c[1])})};g.touches=function(a,b){return e(a,b,function(a,b,c){k(c);return null===c[0]||null===c[1]?!1:r.touches(c[0],c[1])})};g.crosses=function(a,b){return e(a,b,function(a,b,c){k(c);return null===c[0]||null===c[1]?!1:r.crosses(c[0],c[1])})};g.within=function(a,b){return e(a,b,function(a,
b,c){k(c);return null===c[0]||null===c[1]?!1:r.within(c[0],c[1])})};g.contains=function(a,b){return e(a,b,function(a,b,c){k(c);return null===c[0]||null===c[1]?!1:r.contains(c[0],c[1])})};g.overlaps=function(a,b){return e(a,b,function(a,b,c){k(c);return null===c[0]||null===c[1]?!1:r.overlaps(c[0],c[1])})};g.equals=function(b,c){return e(b,c,function(b,c,d){a.pcCheck(d,2,2);return d[0]===d[1]?!0:d[0]instanceof p&&d[1]instanceof p?r.equals(d[0],d[1]):a.isDate(d[0])&&a.isDate(d[1])?d[0].getTime()===d[1].getTime():
!1})};g.relate=function(b,c){return e(b,c,function(b,c,d){a.pcCheck(d,3,3);if(d[0]instanceof p&&d[1]instanceof p)return r.relate(d[0],d[1],a.toString(d[2]));if(d[0]instanceof p&&null===d[1]||d[1]instanceof p&&null===d[0]||null===d[0]&&null===d[1])return!1;throw Error("Illegal Argument");})};g.intersection=function(a,b){return e(a,b,function(a,b,c){k(c);return null===c[0]||null===c[1]?null:r.intersect(c[0],c[1])})};g.union=function(b,c){return e(b,c,function(c,d,g){c=[];if(0===g.length)throw Error("Function called with wrong number of Parameters");
if(1===g.length)if(a.isArray(g[0]))for(d=0;d<g[0].length;d++){if(null!==g[0][d])if(g[0][d]instanceof p)c.push(g[0][d]);else throw Error("Illegal Argument");}else if(a.isImmutableArray(g[0]))for(g=g[0].toArray(),d=0;d<g.length;d++){if(null!==g[d])if(g[d]instanceof p)c.push(g[d]);else throw Error("Illegal Argument");}else{if(g[0]instanceof p)return a.fixSpatialReference(u(g[0]),b.spatialReference);if(null===g[0])return null;throw Error("Illegal Argument");}else for(d=0;d<g.length;d++)if(null!==g[d])if(g[d]instanceof
p)c.push(g[d]);else throw Error("Illegal Argument");return 0===c.length?null:r.union(c)})};g.difference=function(a,b){return e(a,b,function(a,b,c){k(c);return null!==c[0]&&null===c[1]?u(c[0]):null===c[0]?null:r.difference(c[0],c[1])})};g.symmetricdifference=function(a,b){return e(a,b,function(a,b,c){k(c);return null===c[0]&&null===c[1]?null:null===c[0]?u(c[1]):null===c[1]?u(c[0]):r.symmetricDifference(c[0],c[1])})};g.clip=function(b,c){return e(b,c,function(b,c,d){a.pcCheck(d,2,2);if(!(d[1]instanceof
h)&&null!==d[1])throw Error("Illegal Argument");if(null===d[0])return null;if(!(d[0]instanceof p))throw Error("Illegal Argument");return null===d[1]?null:r.clip(d[0],d[1])})};g.cut=function(b,c){return e(b,c,function(b,c,d){a.pcCheck(d,2,2);if(!(d[1]instanceof n)&&null!==d[1])throw Error("Illegal Argument");if(null===d[0])return[];if(!(d[0]instanceof p))throw Error("Illegal Argument");return null===d[1]?[u(d[0])]:r.cut(d[0],d[1])})};g.area=function(c,d){return e(c,d,function(c,d,g){a.pcCheck(g,1,
2);if(null===g[0])return 0;if(!(g[0]instanceof p))throw Error("Illegal Argument");return r.planarArea(g[0],b.convertSquareUnitsToCode(a.defaultUndefined(g[1],-1)))})};g.areageodetic=function(c,d){return e(c,d,function(c,d,g){a.pcCheck(g,1,2);if(null===g[0])return 0;if(!(g[0]instanceof p))throw Error("Illegal Argument");return r.geodesicArea(g[0],b.convertSquareUnitsToCode(a.defaultUndefined(g[1],-1)))})};g.length=function(c,d){return e(c,d,function(c,d,g){a.pcCheck(g,1,2);if(null===g[0])return 0;
if(!(g[0]instanceof p))throw Error("Illegal Argument");return r.planarLength(g[0],b.convertLinearUnitsToCode(a.defaultUndefined(g[1],-1)))})};g.lengthgeodetic=function(c,d){return e(c,d,function(c,d,g){a.pcCheck(g,1,2);if(null===g[0])return 0;if(!(g[0]instanceof p))throw Error("Illegal Argument");return r.geodesicLength(g[0],b.convertLinearUnitsToCode(a.defaultUndefined(g[1],-1)))})};g.distance=function(c,d){return e(c,d,function(c,d,g){a.pcCheck(g,2,3);if(!(g[0]instanceof p))throw Error("Illegal Argument");
if(!(g[1]instanceof p))throw Error("Illegal Argument");return r.distance(g[0],g[1],b.convertLinearUnitsToCode(a.defaultUndefined(g[2],-1)))})};g.densify=function(c,d){return e(c,d,function(c,d,g){a.pcCheck(g,2,3);if(null===g[0])return null;if(!(g[0]instanceof p))throw Error("Illegal Argument");c=a.toNumber(g[1]);if(isNaN(c))throw Error("Illegal Argument");if(0>=c)throw Error("Illegal Argument");return g[0]instanceof q||g[0]instanceof n?r.densify(g[0],c,b.convertLinearUnitsToCode(a.defaultUndefined(g[2],
-1))):g[0]instanceof h?r.densify(m(g[0]),c,b.convertLinearUnitsToCode(a.defaultUndefined(g[2],-1))):g[0]})};g.densifygeodetic=function(c,d){return e(c,d,function(c,d,g){a.pcCheck(g,2,3);if(null===g[0])return null;if(!(g[0]instanceof p))throw Error("Illegal Argument");c=a.toNumber(g[1]);if(isNaN(c))throw Error("Illegal Argument");if(0>=c)throw Error("Illegal Argument");return g[0]instanceof q||g[0]instanceof n?r.geodesicDensify(g[0],c,b.convertLinearUnitsToCode(a.defaultUndefined(g[2],-1))):g[0]instanceof
h?r.geodesicDensify(m(g[0]),c,b.convertLinearUnitsToCode(a.defaultUndefined(g[2],-1))):g[0]})};g.generalize=function(c,d){return e(c,d,function(c,d,g){a.pcCheck(g,2,4);if(null===g[0])return null;if(!(g[0]instanceof p))throw Error("Illegal Argument");c=a.toNumber(g[1]);if(isNaN(c))throw Error("Illegal Argument");return r.generalize(g[0],c,a.toBoolean(a.defaultUndefined(g[2],!0)),b.convertLinearUnitsToCode(a.defaultUndefined(g[3],-1)))})};g.buffer=function(c,d){return e(c,d,function(c,d,g){a.pcCheck(g,
2,3);if(null===g[0])return null;if(!(g[0]instanceof p))throw Error("Illegal Argument");c=a.toNumber(g[1]);if(isNaN(c))throw Error("Illegal Argument");return 0===c?u(g[0]):r.buffer(g[0],c,b.convertLinearUnitsToCode(a.defaultUndefined(g[2],-1)))})};g.buffergeodetic=function(c,d){return e(c,d,function(c,d,g){a.pcCheck(g,2,3);if(null===g[0])return null;if(!(g[0]instanceof p))throw Error("Illegal Argument");c=a.toNumber(g[1]);if(isNaN(c))throw Error("Illegal Argument");return 0===c?u(g[0]):r.geodesicBuffer(g[0],
c,b.convertLinearUnitsToCode(a.defaultUndefined(g[2],-1)))})};g.offset=function(c,d){return e(c,d,function(c,d,g){a.pcCheck(g,2,6);if(null===g[0])return null;if(!(g[0]instanceof q||g[0]instanceof n))throw Error("Illegal Argument");c=a.toNumber(g[1]);if(isNaN(c))throw Error("Illegal Argument");d=a.toNumber(a.defaultUndefined(g[4],10));if(isNaN(d))throw Error("Illegal Argument");var m=a.toNumber(a.defaultUndefined(g[5],0));if(isNaN(m))throw Error("Illegal Argument");return r.offset(g[0],c,b.convertLinearUnitsToCode(a.defaultUndefined(g[2],
-1)),a.toString(a.defaultUndefined(g[3],"round")).toLowerCase(),d,m)})};g.rotate=function(b,c){return e(b,c,function(b,c,d){a.pcCheck(d,2,3);b=d[0];if(null===b)return null;if(!(b instanceof p))throw Error("Illegal Argument");b instanceof h&&(b=q.fromExtent(b));c=a.toNumber(d[1]);if(isNaN(c))throw Error("Illegal Argument");d=a.defaultUndefined(d[2],null);if(null===d)return r.rotate(b,c);if(d instanceof l)return r.rotate(b,c,d);throw Error("Illegal Argument");})};g.centroid=function(b,d){return e(b,
d,function(d,g,m){a.pcCheck(m,1,1);if(null===m[0])return null;if(!(m[0]instanceof p))throw Error("Illegal Argument");return m[0]instanceof l?a.fixSpatialReference(u(m[0]),b.spatialReference):m[0]instanceof q?t?m[0].centroid:m[0].getCentroid():m[0]instanceof n?c.centroidPolyline(m[0]):m[0]instanceof f?c.centroidMultiPoint(m[0]):m[0]instanceof h?t?m[0].center:m[0].getExtent().getCenter():null})};g.multiparttosinglepart=function(b,c){return e(b,c,function(c,g,m){a.pcCheck(m,1,1);g=[];if(null===m[0])return null;
if(!(m[0]instanceof p))throw Error("Illegal Argument");if(m[0]instanceof l||m[0]instanceof h)return[a.fixSpatialReference(u(m[0]),b.spatialReference)];c=r.simplify(m[0]);if(c instanceof q){g=[];var t=[];for(m=0;m<c.rings.length;m++)if(c.isClockwise(c.rings[m])){var e=d.fromJson({rings:[c.rings[m]],hasZ:c.hasZ,hasM:c.hasM,spatialReference:c.spatialReference.toJson()});g.push(e)}else t.push({ring:c.rings[m],pt:c.getPoint(m,0)});for(c=0;c<t.length;c++)for(m=0;m<g.length;m++)if(g[m].contains(t[c].pt)){g[m].addRing(t[c].ring);
break}return g}if(c instanceof n){g=[];for(m=0;m<c.paths.length;m++)t=d.fromJson({paths:[c.paths[m]],hasZ:c.hasZ,hasM:c.hasM,spatialReference:c.spatialReference.toJson()}),g.push(t);return g}if(m[0]instanceof f){c=a.fixSpatialReference(u(m[0]),b.spatialReference);for(m=0;m<c.points.length;m++)g.push(c.getPoint(m));return g}return null})};g.issimple=function(b,c){return e(b,c,function(b,c,d){a.pcCheck(d,1,1);if(null===d[0])return!0;if(d[0]instanceof p)return r.isSimple(d[0]);throw Error("Illegal Argument");
})};g.simplify=function(b,c){return e(b,c,function(b,c,d){a.pcCheck(d,1,1);if(null===d[0])return null;if(d[0]instanceof p)return r.simplify(d[0]);throw Error("Illegal Argument");})}}})},"esri/arcade/functions/centroid":function(){define(["require","exports","../../geometry/Point","../../kernel"],function(k,e,p,q){function n(h,f,d){var c={x:0,y:0};f&&(c.z=0);d&&(c.m=0);for(var a=0,b=h[0],g=0;g<h.length;g++){var n=h[g],m;a:if(n.length!==b.length)m=!1;else{for(m=0;m<n.length;m++)if(n[m]!==b[m]){m=!1;
break a}m=!0}if(!1===m){m=l(b,n,f);var r=n,t=f,e=d,k={x:(b[0]+r[0])/2,y:(b[1]+r[1])/2};t&&(k.z=(b[2]+r[2])/2);t&&e?k.m=(b[3]+r[3])/2:e&&(k.m=(b[2]+r[2])/2);b=k;b.x*=m;b.y*=m;c.x+=b.x;c.y+=b.y;f&&(b.z*=m,c.z+=b.z);d&&(b.m*=m,c.m+=b.m);a+=m;b=n}}0<a?(c.x/=a,c.y/=a,f&&(c.z/=a),d&&(c.m/=a)):(c.x=h[0][0],c.y=h[0][1],f&&(c.z=h[0][2]),d&&f?c.m=h[0][3]:d&&(c.m=h[0][2]));return c}function l(h,f,d){var c=f[0]-h[0];h=f[1]-h[1];return d?(f=f[2]-f[2],Math.sqrt(c*c+h*h+f*f)):Math.sqrt(c*c+h*h)}Object.defineProperty(e,
"__esModule",{value:!0});q.version.indexOf("4.");e.centroidPolyline=function(h){for(var f={x:0,y:0,spatialReference:h.spatialReference.toJson()},d={x:0,y:0,spatialReference:h.spatialReference.toJson()},c=0,a=0,b=0;b<h.paths.length;b++)if(0!==h.paths[b].length){var g;g=h.paths[b];var e=!0===h.hasZ;if(1>=g.length)g=0;else{for(var m=0,r=1;r<g.length;r++)m+=l(g[r-1],g[r],e);g=m}0===g?(e=n(h.paths[b],!0===h.hasZ,!0===h.hasM),f.x+=e.x,f.y+=e.y,!0===h.hasZ&&(f.z+=e.z),!0===h.hasM&&(f.m+=e.m),++c):(e=n(h.paths[b],
!0===h.hasZ,!0===h.hasM),d.x+=e.x*g,d.y+=e.y*g,!0===h.hasZ&&(d.z+=e.z*g),!0===h.hasM&&(d.m+=e.m*g),a+=g)}return 0<a?(d.x/=a,d.y/=a,!0===h.hasZ&&(d.z/=a),!0===h.hasM&&(d.m/=a),new p(d)):0<c?(f.x/=c,f.y/=c,!0===h.hasZ&&(d.z/=c),!0===h.hasM&&(f.m/=c),new p(f)):null};e.centroidMultiPoint=function(h){if(0===h.points.length)return null;for(var f=0,d=0,c=0,a=0,b=0;b<h.points.length;b++){var g=h.getPoint(b);!0===g.hasZ&&(c+=g.z);!0===g.hasM&&(a+=g.m);f+=g.x;d+=g.y;a+=g.m}f={x:f/h.points.length,y:d/h.points.length,
spatialReference:null};f.spatialReference=h.spatialReference.toJson();!0===h.hasZ&&(f.z=c/h.points.length);!0===h.hasM&&(f.m=a/h.points.length);return new p(f)}})},"esri/arcade/kernel":function(){define(["require","exports","../geometry/Extent"],function(k,e,p){Object.defineProperty(e,"__esModule",{value:!0});e.errback=function(e){return function(n){e.reject(n)}};e.callback=function(e,n){return function(){try{e.apply(null,arguments)}catch(l){n.reject(l)}}};e.convertSquareUnitsToCode=function(e){if(void 0===
e)return null;if("number"===typeof e)return e;switch(e.toLowerCase()){case "meters":case "meter":case "m":case "squaremeters":case "squaremeter":case "square-meter":case "square_meters":return 109404;case "miles":case "mile":case "squaremile":case "squaremiles":case "square-miles":case "square-mile":return 109413;case "kilometers":case "kilometer":case "squarekilometers":case "squarekilometer":case "square-kilometers":case "square-kilometer":case "km":return 109414;case "acres":case "acre":case "ac":return 109402;
case "hectares":case "hectare":case "ha":return 109401;case "yard":case "yd":case "yards":case "square-yards":case "square-yard":case "squareyards":case "squareyard":return 109442;case "feet":case "ft":case "foot":case "square-feet":case "square-foot":case "squarefeet":case "squarefoot":return 109405}return null};e.shapeExtent=function(e){if(null===e)return null;switch(e.type){case "polygon":case "multipoint":case "polyline":return e.extent;case "point":return new p({xmin:e.x,ymin:e.y,xmax:e.x,ymax:e.y,
spatialReference:e.spatialReference});case "extent":return e}return null};e.convertLinearUnitsToCode=function(e){if(void 0===e)return null;if("number"===typeof e||"number"===typeof e)return e;switch(e.toLowerCase()){case "meters":case "meter":case "m":case "squaremeters":case "squaremeter":case "square-meter":case "square-meters":return 9001;case "miles":case "mile":case "squaremile":case "squaremiles":case "square-miles":case "square-mile":return 9035;case "kilometers":case "kilometer":case "squarekilometers":case "squarekilometer":case "square-kilometers":case "square-kilometer":case "km":return 9036;
case "yard":case "yd":case "yards":case "square-yards":case "square-yard":case "squareyards":case "squareyard":return 9096;case "feet":case "ft":case "foot":case "square-feet":case "square-foot":case "squarefeet":case "squarefoot":return 9002}return null};e.sameGeomType=function(e,n){return e===n||"point"===e&&"esriGeometryPoint"===n||"polyline"===e&&"esriGeometryPolyline"===n||"polygon"===e&&"esriGeometryPolygon"===n||"extent"===e&&"esriGeometryEnvelope"===n||"multipoint"===e&&"esriGeometryMultipoint"===
n||"point"===n&&"esriGeometryPoint"===e||"polyline"===n&&"esriGeometryPolyline"===e||"polygon"===n&&"esriGeometryPolygon"===e||"extent"===n&&"esriGeometryEnvelope"===e||"multipoint"===n&&"esriGeometryMultipoint"===e?!0:!1}})},"esri/arcade/functions/stats":function(){define(["require","exports","../languageUtils","./fieldStats"],function(k,e,p,q){function n(l,h,f,d){if(1===d.length){if(p.isArray(d[0]))return q.calculateStat(l,d[0],-1);if(p.isImmutableArray(d[0]))return q.calculateStat(l,d[0].toArray(),
-1)}return q.calculateStat(l,d,-1)}Object.defineProperty(e,"__esModule",{value:!0});e.registerFunctions=function(l,h){l.stdev=function(f,d){return h(f,d,function(c,a,b){return n("stdev",c,a,b)})};l.variance=function(f,d){return h(f,d,function(c,a,b){return n("variance",c,a,b)})};l.average=function(f,d){return h(f,d,function(c,a,b){return n("mean",c,a,b)})};l.mean=function(f,d){return h(f,d,function(c,a,b){return n("mean",c,a,b)})};l.sum=function(f,d){return h(f,d,function(c,a,b){return n("sum",c,
a,b)})};l.min=function(f,d){return h(f,d,function(c,a,b){return n("min",c,a,b)})};l.max=function(f,d){return h(f,d,function(c,a,b){return n("max",c,a,b)})};l.distinct=function(f,d){return h(f,d,function(c,a,b){return n("distinct",c,a,b)})};l.count=function(f,d){return h(f,d,function(c,a,b){p.pcCheck(b,1,1);if(p.isArray(b[0])||p.isString(b[0]))return b[0].length;if(p.isImmutableArray(b[0]))return b[0].length();throw Error("Invalid Parameters for Count");})}}})},"esri/arcade/functions/fieldStats":function(){define(["require",
"exports","../languageUtils"],function(k,e,p){function q(l){for(var h=0,f=0;f<l.length;f++)h+=l[f];return h/l.length}function n(l){for(var h=q(l),f=0,d=0;d<l.length;d++)f+=Math.pow(h-l[d],2);return f/l.length}Object.defineProperty(e,"__esModule",{value:!0});e.decodeStatType=function(l){switch(l.toLowerCase()){case "distinct":return"distinct";case "avg":case "mean":return"avg";case "min":return"min";case "sum":return"sum";case "max":return"max";case "stdev":case "stddev":return"stddev";case "var":case "variance":return"var";
case "count":return"count"}return""};e.calculateStat=function(l,h,f){void 0===f&&(f=1E3);switch(l.toLowerCase()){case "distinct":a:{l=f;f=[];for(var d={},c=[],a=0;a<h.length;a++){if(void 0!==h[a]&&null!==h[a]&&h[a]!==p.voidOperation){var b=h[a];if(p.isNumber(b)||p.isString(b))void 0===d[b]&&(f.push(b),d[b]=1);else{for(var g=!1,e=0;e<c.length;e++)!0===p.equalityTest(c[e],b)&&(g=!0);!1===g&&(c.push(b),f.push(b))}}if(f.length>=l&&-1!==l){h=f;break a}}h=f}return h;case "avg":case "mean":return q(p.toNumberArray(h));
case "min":return Math.min.apply(Math,p.toNumberArray(h));case "sum":h=p.toNumberArray(h);for(f=l=0;f<h.length;f++)l+=h[f];return l;case "max":return Math.max.apply(Math,p.toNumberArray(h));case "stdev":case "stddev":return Math.sqrt(n(p.toNumberArray(h)));case "var":case "variance":return n(p.toNumberArray(h));case "count":return h.length}return 0}})},"esri/arcade/parser":function(){define(["require","exports","./treeAnalysis","./lib/esprima"],function(k,e,p,q){Object.defineProperty(e,"__esModule",
{value:!0});e.parseScript=function(e){e=q.parse("function _() { "+e+"\n}");if(null===e.body||void 0===e.body)throw Error("No formula provided.");if(0===e.body.length)throw Error("No formula provided.");if(0===e.body.length)throw Error("No formula provided.");if("BlockStatement"!==e.body[0].body.type)throw Error("Invalid formula content.");var l=p.validateLanguage(e);if(""!==l)throw Error(l);return e};e.scriptCheck=function(e,l,h,f){var d=[];try{var c=q.parse("function _() { "+e+"\n}",{tolerant:!0,
loc:!0}),a=c.errors;if(0<a.length)for(var b=0;b<a.length;b++)d.push({line:a[b].lineNumber,character:a[b].column,reason:a[b].description});var g=p.checkScript(c,l,h,f);for(l=0;l<g.length;l++)d.push(g[l])}catch(u){try{"Unexpected token }"===u.description?(u.index=("function _() { "+e+"\n}").length-1,d.push({line:u.lineNumber,character:u.column,reason:"Unexpected end of script"})):d.push({line:u.lineNumber,character:u.column,reason:u.description})}catch(m){}}return d};e.extractFieldLiterals=function(e,
l){void 0===l&&(l=!1);return p.findFieldLiterals(e,l)};e.validateScript=function(e,l,h){void 0===h&&(h="full");return p.validateScript(e,l,h)};e.referencesMember=function(e,l){return p.referencesMember(e,l)};e.referencesFunction=function(e,l){return p.referencesFunction(e,l)}})},"esri/arcade/lib/esprima":function(){(function(k,e){"function"===typeof define&&define.amd?define(["exports"],e):"undefined"!==typeof exports?e(exports):e(k.esprima={})})(this,function(k){function e(a,b){if(!a)throw Error("ASSERT: "+
b);}function p(a){return 48<=a&&57>=a}function q(a){return 0<="0123456789abcdefABCDEF".indexOf(a)}function n(a){return 0<="01234567".indexOf(a)}function l(a){return 10===a||13===a||8232===a||8233===a}function h(a){return 36===a||95===a||65<=a&&90>=a||97<=a&&122>=a||92===a||128<=a&&gb.NonAsciiIdentifierStart.test(String.fromCharCode(a))}function f(a){return 36===a||95===a||65<=a&&90>=a||97<=a&&122>=a||48<=a&&57>=a||92===a||128<=a&&gb.NonAsciiIdentifierPart.test(String.fromCharCode(a))}function d(a){a=
a.toLowerCase();switch(a.length){case 2:return"if"===a||"in"===a;case 3:return"var"===a||"for"===a;case 4:return"else"===a;case 5:return"break"===a;case 6:return"return"===a;case 8:return"function"===a.toLowerCase()||"continue"===a;default:return!1}}function c(a,b,c,d,g){e("number"===typeof c,"Comment must have valid position");ba.lastCommentStart>=c||(ba.lastCommentStart=c,a={type:a,value:b},Q.range&&(a.range=[c,d]),Q.loc&&(a.loc=g),Q.comments.push(a),Q.attachComment&&(Q.leadingComments.push(a),
Q.trailingComments.push(a)))}function a(a){var b,d,g;b=H-a;for(d={start:{line:ea,column:H-ga-a}};H<pa;)if(g=R.charCodeAt(H),++H,l(g)){Q.comments&&(a=R.slice(b+a,H-1),d.end={line:ea,column:H-ga-1},c("Line",a,b,H-1,d));13===g&&10===R.charCodeAt(H)&&++H;++ea;ga=H;return}Q.comments&&(a=R.slice(b+a,H),d.end={line:ea,column:H-ga},c("Line",a,b,H,d))}function b(){var b,d;for(d=0===H;H<pa;)if(b=R.charCodeAt(H),32===b||9===b||11===b||12===b||160===b||5760<=b&&0<=[5760,6158,8192,8193,8194,8195,8196,8197,8198,
8199,8200,8201,8202,8239,8287,12288,65279].indexOf(b))++H;else if(l(b))++H,13===b&&10===R.charCodeAt(H)&&++H,++ea,ga=H,d=!0;else if(47===b)if(b=R.charCodeAt(H+1),47===b)++H,++H,a(2),d=!0;else if(42===b){++H;++H;a:{var g=b=void 0,m=void 0,m=void 0;Q.comments&&(b=H-2,g={start:{line:ea,column:H-ga-2}});for(;H<pa;)if(m=R.charCodeAt(H),l(m))13===m&&10===R.charCodeAt(H+1)&&++H,++ea,++H,ga=H,H>=pa&&K();else{if(42===m&&47===R.charCodeAt(H+1)){++H;++H;Q.comments&&(m=R.slice(b+2,H-2),g.end={line:ea,column:H-
ga},c("Block",m,b,H,g));break a}++H}K()}}else break;else if(d&&45===b)if(45===R.charCodeAt(H+1)&&62===R.charCodeAt(H+2))H+=3,a(3);else break;else if(60===b)if("!--"===R.slice(H+1,H+4))++H,++H,++H,++H,a(4);else break;else break}function g(a){var b,c,d=0;b="u"===a?4:2;for(a=0;a<b;++a)if(H<pa&&q(R[H]))c=R[H++],d=16*d+"0123456789abcdef".indexOf(c.toLowerCase());else return"";return String.fromCharCode(d)}function u(){var a,b;a=R.charCodeAt(H++);b=String.fromCharCode(a);92===a&&(117!==R.charCodeAt(H)&&
K(),++H,(a=g("u"))&&"\\"!==a&&h(a.charCodeAt(0))||K(),b=a);for(;H<pa;){a=R.charCodeAt(H);if(!f(a))break;++H;b+=String.fromCharCode(a);92===a&&(b=b.substr(0,b.length-1),117!==R.charCodeAt(H)&&K(),++H,(a=g("u"))&&"\\"!==a&&f(a.charCodeAt(0))||K(),b+=a)}return b}function m(){var a=H,b=R.charCodeAt(H),c,d=R[H];switch(b){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++H,Q.tokenize&&(40===b?Q.openParenToken=Q.tokens.length:123===b&&(Q.openCurlyToken=
Q.tokens.length)),{type:T.Punctuator,value:String.fromCharCode(b),lineNumber:ea,lineStart:ga,start:a,end:H};default:if(c=R.charCodeAt(H+1),61===c)switch(b){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:return H+=2,{type:T.Punctuator,value:String.fromCharCode(b)+String.fromCharCode(c),lineNumber:ea,lineStart:ga,start:a,end:H};case 33:case 61:return H+=2,61===R.charCodeAt(H)&&++H,{type:T.Punctuator,value:R.slice(a,H),lineNumber:ea,lineStart:ga,start:a,end:H}}}b=R.substr(H,
4);if("\x3e\x3e\x3e\x3d"===b)return H+=4,{type:T.Punctuator,value:b,lineNumber:ea,lineStart:ga,start:a,end:H};b=b.substr(0,3);if("\x3e\x3e\x3e"===b||"\x3c\x3c\x3d"===b||"\x3e\x3e\x3d"===b)return H+=3,{type:T.Punctuator,value:b,lineNumber:ea,lineStart:ga,start:a,end:H};b=b.substr(0,2);if(d===b[1]&&0<="+-\x3c\x3e\x26|".indexOf(d)||"\x3d\x3e"===b)return H+=2,{type:T.Punctuator,value:b,lineNumber:ea,lineStart:ga,start:a,end:H};if(0<="\x3c\x3e\x3d!+-*%\x26|^/".indexOf(d))return++H,{type:T.Punctuator,value:d,
lineNumber:ea,lineStart:ga,start:a,end:H};K()}function r(){var a,b,c;c=R[H];e(p(c.charCodeAt(0))||"."===c,"Numeric literal must start with a decimal digit or a decimal point");b=H;a="";if("."!==c){a=R[H++];c=R[H];if("0"===a){if("x"===c||"X"===c){++H;for(a="";H<pa&&q(R[H]);)a+=R[H++];0===a.length&&K();h(R.charCodeAt(H))&&K();return{type:T.NumericLiteral,value:parseInt("0x"+a,16),lineNumber:ea,lineStart:ga,start:b,end:H}}if("b"===c||"B"===c){++H;for(c="";H<pa;){a=R[H];if("0"!==a&&"1"!==a)break;c+=R[H++]}0===
c.length&&K();H<pa&&(a=R.charCodeAt(H),(h(a)||p(a))&&K());return{type:T.NumericLiteral,value:parseInt(c,2),lineNumber:ea,lineStart:ga,start:b,end:H}}if("o"===c||"O"===c||n(c)){n(c)?(c=!0,a="0"+R[H++]):(c=!1,++H,a="");for(;H<pa&&n(R[H]);)a+=R[H++];c||0!==a.length||K();(h(R.charCodeAt(H))||p(R.charCodeAt(H)))&&K();return{type:T.NumericLiteral,value:parseInt(a,8),octal:c,lineNumber:ea,lineStart:ga,start:b,end:H}}c&&p(c.charCodeAt(0))&&K()}for(;p(R.charCodeAt(H));)a+=R[H++];c=R[H]}if("."===c){for(a+=
R[H++];p(R.charCodeAt(H));)a+=R[H++];c=R[H]}if("e"===c||"E"===c){a+=R[H++];c=R[H];if("+"===c||"-"===c)a+=R[H++];if(p(R.charCodeAt(H)))for(;p(R.charCodeAt(H));)a+=R[H++];else K()}h(R.charCodeAt(H))&&K();return{type:T.NumericLiteral,value:parseFloat(a),lineNumber:ea,lineStart:ga,start:b,end:H}}function t(){X=null;b();L("Regular Expression language structures not supported")}function v(){b();t()}function y(){var a;a=Q.tokens[Q.tokens.length-1];if(!a)return v();if("Punctuator"===a.type){if("]"===a.value)return m();
if(")"===a.value)return a=Q.tokens[Q.openParenToken-1],!a||"Keyword"!==a.type||"if"!==a.value.toLowerCase()&&"while"!==a.value.toLowerCase()&&"for"!==a.value.toLowerCase()&&"with"!==a.value.toLowerCase()?m():v();if("}"===a.value){if(Q.tokens[Q.openCurlyToken-3]&&"Keyword"===Q.tokens[Q.openCurlyToken-3].type){if(a=Q.tokens[Q.openCurlyToken-4],!a)return m()}else if(Q.tokens[Q.openCurlyToken-4]&&"Keyword"===Q.tokens[Q.openCurlyToken-4].type){if(a=Q.tokens[Q.openCurlyToken-5],!a)return v()}else return m();
if(0<=xa.indexOf(a.value))return m()}return v()}return"Keyword"===a.type&&"this"!==a.value?v():m()}function w(){var a;b();if(H>=pa)return{type:T.EOF,lineNumber:ea,lineStart:ga,start:H,end:H};a=R.charCodeAt(H);if(h(a)){var c;a=H;if(92===R.charCodeAt(H))c=u();else a:{var t;for(c=H++;H<pa;){t=R.charCodeAt(H);if(92===t){H=c;c=u();break a}if(f(t))++H;else break}c=R.slice(c,H)}return{type:1===c.length?T.Identifier:d(c)?T.Keyword:"null"===c.toLowerCase()?T.NullLiteral:"true"===c.toLowerCase()||"false"===
c.toLowerCase()?T.BooleanLiteral:T.Identifier,value:c,lineNumber:ea,lineStart:ga,start:a,end:H}}if(40===a||41===a||59===a)return m();if(39===a||34===a){var k="",v,w,z;t=!1;var x,B;x=ea;B=ga;a=R[H];e("'"===a||'"'===a,"String literal must starts with a quote");c=H;for(++H;H<pa;)if(v=R[H++],v===a){a="";break}else if("\\"===v)if((v=R[H++])&&l(v.charCodeAt(0)))++ea,"\r"===v&&"\n"===R[H]&&++H,ga=H;else switch(v){case "u":case "x":if("{"===R[H]){++H;w=v=void 0;v=R[H];w=0;for("}"===v&&K();H<pa;){v=R[H++];
if(!q(v))break;w=16*w+"0123456789abcdef".indexOf(v.toLowerCase())}(1114111<w||"}"!==v)&&K();v=65535>=w?String.fromCharCode(w):String.fromCharCode((w-65536>>10)+55296,(w-65536&1023)+56320);k+=v}else z=H,(w=g(v))?k+=w:(H=z,k+=v);break;case "n":k+="\n";break;case "r":k+="\r";break;case "t":k+="\t";break;case "b":k+="\b";break;case "f":k+="\f";break;case "v":k+="\x0B";break;default:n(v)?(w="01234567".indexOf(v),0!==w&&(t=!0),H<pa&&n(R[H])&&(t=!0,w=8*w+"01234567".indexOf(R[H++]),0<="0123".indexOf(v)&&
H<pa&&n(R[H])&&(w=8*w+"01234567".indexOf(R[H++]))),k+=String.fromCharCode(w)):k+=v}else if(l(v.charCodeAt(0)))break;else k+=v;""!==a&&K();return{type:T.StringLiteral,value:k,octal:t,startLineNumber:x,startLineStart:B,lineNumber:ea,lineStart:ga,start:c,end:H}}return 46===a?p(R.charCodeAt(H+1))?r():m():p(a)?r():Q.tokenize&&47===a?y():m()}function z(){var a,c,d;b();a={start:{line:ea,column:H-ga}};c=w();a.end={line:ea,column:H-ga};c.type!==T.EOF&&(d=R.slice(c.start,c.end),a={type:La[c.type],value:d,range:[c.start,
c.end],loc:a},c.regex&&(a.regex={pattern:c.regex.pattern,flags:c.regex.flags}),Q.tokens.push(a));return c}function x(){var a;a=X;H=a.end;ea=a.lineNumber;ga=a.lineStart;X="undefined"!==typeof Q.tokens?z():w();H=a.end;ea=a.lineNumber;ga=a.lineStart;return a}function A(){var a,b,c;a=H;b=ea;c=ga;X="undefined"!==typeof Q.tokens?z():w();H=a;ea=b;ga=c}function C(){this.line=ea;this.column=H-ga}function B(){this.start=new C;this.end=null}function E(a){this.start=a.type===T.StringLiteral?{line:a.startLineNumber,
column:a.start-a.startLineStart}:{line:a.lineNumber,column:a.start-a.lineStart};this.end=null}function D(){H=X.start;X.type===T.StringLiteral?(ea=X.startLineNumber,ga=X.startLineStart):(ea=X.lineNumber,ga=X.lineStart);Q.range&&(this.range=[H,0]);Q.loc&&(this.loc=new B)}function F(a){Q.range&&(this.range=[a.start,0]);Q.loc&&(this.loc=new E(a))}function I(){var a,c,d,g;a=H;c=ea;d=ga;b();g=ea!==c;H=a;ea=c;ga=d;return g}function M(a,b,c){var d=Error("Line "+a+": "+c);d.index=b;d.lineNumber=a;d.column=
b-ga+1;d.description=c;return d}function L(a){var b,c;b=Array.prototype.slice.call(arguments,1);c=a.replace(/%(\d)/g,function(a,c){e(c<b.length,"Message reference must be in range");return b[c]});throw M(ea,H,c);}function J(a){var b,c;b=Array.prototype.slice.call(arguments,1);c=a.replace(/%(\d)/g,function(a,c){e(c<b.length,"Message reference must be in range");return b[c]});c=M(ea,H,c);if(Q.errors)Q.errors.push(c);else throw c;}function P(a,b){var c=ka.UnexpectedToken;a&&(c=b?b:a.type===T.EOF?ka.UnexpectedEOS:
a.type===T.Identifier?ka.UnexpectedIdentifier:a.type===T.NumericLiteral?ka.UnexpectedNumber:a.type===T.StringLiteral?ka.UnexpectedString:ka.UnexpectedToken);c=c.replace("%0",a?a.value:"ILLEGAL");return a&&"number"===typeof a.lineNumber?M(a.lineNumber,a.start,c):M(ea,H,c)}function K(a,b){throw P(a,b);}function U(a,b){a=P(a,b);if(Q.errors)Q.errors.push(a);else throw a;}function O(a){var b=x();b.type===T.Punctuator&&b.value===a||K(b)}function S(){var a;Q.errors?(a=X,a.type===T.Punctuator&&","===a.value?
x():a.type===T.Punctuator&&";"===a.value?(x(),U(a)):U(a,ka.UnexpectedToken)):O(",")}function Y(a){var b=x();b.type===T.Keyword&&b.value.toLowerCase()===a.toLowerCase()||K(b)}function N(a){return X.type===T.Punctuator&&X.value===a}function W(a){return X.type===T.Keyword&&X.value.toLowerCase()===a.toLowerCase()}function ca(){var a;59===R.charCodeAt(H)||N(";")?x():(a=ea,b(),ea===a&&(X.type===T.EOF||N("}")||K(X)))}function ha(a){return a.type===da.Identifier||a.type===da.MemberExpression}function fa(a,
b){var c,d=new D;b=qa;c=Ca();qa=b;return d.finishFunctionExpression(null,a,[],c)}function Z(){var a,b;a=qa;qa=!0;b=Ka();b=fa(b.params);qa=a;return b}function G(){var a,b=new D;a=x();return a.type===T.StringLiteral||a.type===T.NumericLiteral?(qa&&a.octal&&U(a,ka.StrictOctalLiteral),b.finishLiteral(a)):b.finishIdentifier(a.value)}function ia(){var a,b,c,d=new D;a=X;if(a.type===T.Identifier)return b=G(),"get"!==a.value||N(":")||N("(")?"set"!==a.value||N(":")||N("(")?N(":")?(x(),a=ta(),d.finishProperty("init",
b,a,!1,!1)):N("(")?(a=Z(),d.finishProperty("init",b,a,!0,!1)):d.finishProperty("init",b,b,!1,!0):(b=G(),O("("),a=X,a.type!==T.Identifier?(O(")"),U(a),a=fa([])):(c=[Da()],O(")"),a=fa(c,a)),d.finishProperty("set",b,a,!1,!1)):(b=G(),O("("),O(")"),a=fa([]),d.finishProperty("get",b,a,!1,!1));if(a.type===T.EOF||a.type===T.Punctuator)K(a);else{b=G();if(N(":"))return x(),a=ta(),d.finishProperty("init",b,a,!1,!1);if(N("("))return a=Z(),d.finishProperty("init",b,a,!0,!1);K(x())}}function sa(a){var b=[],c,d,
g={},m=String,f=new D;for(!0!==a&&O("{");!N("}");)a=ia(),c=a.key.type===da.Identifier?a.key.name:m(a.key.value),d="init"===a.kind?Sa.Data:"get"===a.kind?Sa.Get:Sa.Set,c="$"+c,Object.prototype.hasOwnProperty.call(g,c)?(g[c]===Sa.Data?qa&&d===Sa.Data?J(ka.StrictDuplicateProperty):d!==Sa.Data&&J(ka.AccessorDataProperty):d===Sa.Data?J(ka.AccessorDataProperty):g[c]&d&&J(ka.AccessorGetSet),g[c]|=d):g[c]=d,b.push(a),N("}")||S();O("}");return f.finishObjectExpression(b)}function wa(){var a,b,c,d;if(N("("))return O("("),
N(")")?(x(),b=Wa.ArrowParameterPlaceHolder):(++ba.parenthesisCount,b=oa(),O(")")),b;if(N("[")){b=[];var g=new D;for(O("[");!N("]");)N(",")?(x(),b.push(null)):(b.push(ta()),N("]")||O(","));x();return g.finishArrayExpression(b)}if(N("{"))return sa();a=X.type;d=new D;if(a===T.Identifier)c=d.finishIdentifier(x().value);else if(a===T.StringLiteral||a===T.NumericLiteral)qa&&X.octal&&U(X,ka.StrictOctalLiteral),c=d.finishLiteral(x());else if(a===T.Keyword){if(W("function")){d=null;var m;c=[];var f=[],r,h=
new D;Y("function");N("(")||(d=Da());m=Ka(b);c=m.params;f=m.defaults;a=m.stricted;b=m.firstRestricted;m.message&&(g=m.message);r=qa;m=Ca();qa&&b&&K(b,g);qa&&a&&U(a,g);qa=r;return h.finishFunctionExpression(d,c,f,m)}W("this")?(x(),c=d.finishThisExpression()):K(x())}else a===T.BooleanLiteral?(b=x(),b.value="true"===b.value.toLowerCase(),c=d.finishLiteral(b)):a===T.NullLiteral?(b=x(),b.value=null,c=d.finishLiteral(b)):N("/")||N("/\x3d")?(c="undefined"!==typeof Q.tokens?d.finishLiteral(v()):d.finishLiteral(t()),
A()):K(x());return c}function ua(){var a=[];O("(");if(!N(")"))for(;H<pa;){a.push(ta());if(N(")"))break;S()}O(")");return a}function ma(){O(".");var a,b=new D;a=x();a.type===T.Identifier||a.type===T.Keyword||a.type===T.BooleanLiteral||a.type===T.NullLiteral||K(a);return b.finishIdentifier(a.value)}function ja(){var a;O("[");a=oa();O("]");return a}function va(){var a,b,c=new D;Y("new");var d;e(ba.allowIn,"callee of new expression always allow in keyword.");d=X;for(a=W("new")?va():wa();;)if(N("["))b=
ja(),a=(new F(d)).finishMemberExpression("[",a,b);else if(N("."))b=ma(),a=(new F(d)).finishMemberExpression(".",a,b);else break;b=N("(")?ua():[];return c.finishNewExpression(a,b)}function la(){var a,b,c=X,d,g=ba.allowIn;b=X;ba.allowIn=!0;for(a=W("new")?va():wa();;)if(N("."))d=ma(),a=(new F(b)).finishMemberExpression(".",a,d);else if(N("("))d=ua(),a=(new F(b)).finishCallExpression(a,d);else if(N("["))d=ja(),a=(new F(b)).finishMemberExpression("[",a,d);else break;ba.allowIn=g;X.type!==T.Punctuator||
!N("++")&&!N("--")||I()||(ha(a)||J(ka.InvalidLHSInAssignment),b=x(),a=(new F(c)).finishPostfixExpression(b.value,a));return a}function na(){var a,b,c;X.type!==T.Punctuator&&X.type!==T.Keyword?b=la():N("++")||N("--")?(c=X,a=x(),b=na(),ha(b)||J(ka.InvalidLHSInAssignment),b=(new F(c)).finishUnaryExpression(a.value,b)):N("+")||N("-")||N("~")||N("!")?(c=X,a=x(),b=na(),b=(new F(c)).finishUnaryExpression(a.value,b)):W("delete")||W("void")||W("typeof")?(c=X,a=x(),b=na(),b=(new F(c)).finishUnaryExpression(a.value,
b),qa&&"delete"===b.operator&&b.argument.type===da.Identifier&&J(ka.StrictDelete)):b=la();return b}function aa(a,b){var c=0;if(a.type!==T.Punctuator&&a.type!==T.Keyword)return 0;switch(a.value){case "||":c=1;break;case "\x26\x26":c=2;break;case "|":c=3;break;case "^":c=4;break;case "\x26":c=5;break;case "\x3d\x3d":case "!\x3d":case "\x3d\x3d\x3d":case "!\x3d\x3d":c=6;break;case "\x3c":case "\x3e":case "\x3c\x3d":case "\x3e\x3d":case "instanceof":c=7;break;case "in":c=b?7:0;break;case "\x3c\x3c":case "\x3e\x3e":case "\x3e\x3e\x3e":c=
8;break;case "+":case "-":c=9;break;case "*":case "/":case "%":c=11}return c}function za(){var a,b,c,d,g,m;a=X;b=na();if(b===Wa.ArrowParameterPlaceHolder)return b;c=X;d=aa(c,ba.allowIn);if(0===d)return b;c.prec=d;x();a=[a,X];m=na();for(g=[b,c,m];0<(d=aa(X,ba.allowIn));){for(;2<g.length&&d<=g[g.length-2].prec;)m=g.pop(),c=g.pop().value,b=g.pop(),a.pop(),b=(new F(a[a.length-1])).finishBinaryExpression(c,b,m),g.push(b);c=x();c.prec=d;g.push(c);a.push(X);b=na();g.push(b)}d=g.length-1;b=g[d];for(a.pop();1<
d;)b=(new F(a.pop())).finishBinaryExpression(g[d-1].value,g[d-2],b),d-=2;return b}function Ba(a){var b,c,d,g,m,f,r;g=[];m=[];f=0;r={paramSet:{}};b=0;for(c=a.length;b<c;b+=1)if(d=a[b],d.type===da.Identifier)g.push(d),m.push(null),Ja(r,d,d.name);else if(d.type===da.AssignmentExpression)g.push(d.left),m.push(d.right),++f,Ja(r,d.left,d.left.name);else return null;r.message===ka.StrictParamDupe&&(a=qa?r.stricted:r.firstRestricted,K(a,r.message));0===f&&(m=[]);return{params:g,defaults:m,rest:null,stricted:r.stricted,
firstRestricted:r.firstRestricted,message:r.message}}function ta(){var a,b,c,d,g;a=ba.parenthesisCount;b=g=X;var m,f;f=X;c=za();c!==Wa.ArrowParameterPlaceHolder&&N("?")&&(x(),m=ba.allowIn,ba.allowIn=!0,b=ta(),ba.allowIn=m,O(":"),m=ta(),c=(new F(f)).finishConditionalExpression(c,b,m));if(c===Wa.ArrowParameterPlaceHolder||N("\x3d\x3e"))if(ba.parenthesisCount===a||ba.parenthesisCount===a+1)if(c.type===da.Identifier?d=Ba([c]):c.type===da.AssignmentExpression?d=Ba([c]):c.type===da.SequenceExpression?d=
Ba(c.expressions):c===Wa.ArrowParameterPlaceHolder&&(d=Ba([])),d)return a=d,g=new F(g),O("\x3d\x3e"),d=qa,c=N("{")?Ca():ta(),qa&&a.firstRestricted&&K(a.firstRestricted,a.message),qa&&a.stricted&&U(a.stricted,a.message),qa=d,g.finishArrowFunctionExpression(a.params,a.defaults,c,c.type!==da.BlockStatement);X.type!==T.Punctuator?a=!1:(a=X.value,a="\x3d"===a||"*\x3d"===a||"/\x3d"===a||"%\x3d"===a||"+\x3d"===a||"-\x3d"===a||"\x3c\x3c\x3d"===a||"\x3e\x3e\x3d"===a||"\x3e\x3e\x3e\x3d"===a||"\x26\x3d"===a||
"^\x3d"===a||"|\x3d"===a);a&&(ha(c)||J(ka.InvalidLHSInAssignment),b=x(),a=ta(),c=(new F(g)).finishAssignmentExpression(b.value,c,a));return c}function oa(){var a,b=X;a=ta();if(N(",")){for(a=[a];H<pa&&N(",");)x(),a.push(ta());a=(new F(b)).finishSequenceExpression(a)}return a}function Da(){var a,b=new D;a=x();a.type!==T.Identifier&&K(a);return b.finishIdentifier(a.value)}function Oa(a){var b=null,c,d=new D;c=Da();"const"===a?(O("\x3d"),b=ta()):N("\x3d")&&(x(),b=ta());return d.finishVariableDeclarator(c,
b)}function Ma(a){var b=[];do{b.push(Oa(a));if(!N(","))break;x()}while(H<pa);return b}function Fa(a){var b=X.type,c,d;b===T.EOF&&K(X);if(b===T.Punctuator&&"{"===X.value){if(a){O("{");var g=X;a=H;c=ea;d=ga;x();b=N(":");X=g;H=a;ea=c;ga=d;if((X.type===T.Identifier||X.type===T.StringLiteral)&&b)return sa(!0);a=new D;for(c=[];H<pa&&!N("}");){d=Na();if("undefined"===typeof d)break;c.push(d)}O("}");return a.finishBlockStatement(c)}return sa()}a=new D;if(b===T.Punctuator)switch(X.value){case ";":return a=
new D,O(";"),a.finishEmptyStatement();case "(":return c=oa(),ca(),a.finishExpressionStatement(c)}else if(b===T.Keyword)switch(X.value.toLowerCase()){case "break":return c=null,Y("break"),59===R.charCodeAt(H)?(x(),ba.inIteration||ba.inSwitch||L(ka.IllegalBreak),a=a.finishBreakStatement(null)):I()?(ba.inIteration||ba.inSwitch||L(ka.IllegalBreak),a=a.finishBreakStatement(null)):(X.type===T.Identifier&&(c=Da(),d="$"+c.name,Object.prototype.hasOwnProperty.call(ba.labelSet,d)||L(ka.UnknownLabel,c.name)),
ca(),null!==c||ba.inIteration||ba.inSwitch||L(ka.IllegalBreak),a=a.finishBreakStatement(c)),a;case "continue":return c=null,Y("continue"),59===R.charCodeAt(H)?(x(),ba.inIteration||L(ka.IllegalContinue),a=a.finishContinueStatement(null)):I()?(ba.inIteration||L(ka.IllegalContinue),a=a.finishContinueStatement(null)):(X.type===T.Identifier&&(c=Da(),d="$"+c.name,Object.prototype.hasOwnProperty.call(ba.labelSet,d)||L(ka.UnknownLabel,c.name)),ca(),null!==c||ba.inIteration||L(ka.IllegalContinue),a=a.finishContinueStatement(c)),
a;case "for":var m,f,r;f=ba.allowIn;m=b=g=null;Y("for");O("(");if(N(";"))x();else{if(W("var")){ba.allowIn=!1;var t=new D;m=x();r=Ma();m=t.finishVariableDeclaration(r,m.value);ba.allowIn=f;1===m.declarations.length&&W("in")&&(x(),c=m,d=oa(),m=null)}else ba.allowIn=!1,m=oa(),ba.allowIn=f,W("in")&&(ha(m)||J(ka.InvalidLHSInForIn),x(),c=m,d=oa(),m=null);"undefined"===typeof c&&O(";")}"undefined"===typeof c&&(N(";")||(b=oa()),O(";"),N(")")||(g=oa()));O(")");r=ba.inIteration;ba.inIteration=!0;f=Fa(!0);ba.inIteration=
r;return"undefined"===typeof c?a.finishForStatement(m,b,g,f):a.finishForInStatement(c,d,f);case "function":return Va(a);case "if":return Y("if"),O("("),c=oa(),O(")"),d=Fa(!0),W("else")?(x(),b=Fa(!0)):b=null,a.finishIfStatement(c,d,b);case "return":return c=null,Y("return"),ba.inFunctionBody||J(ka.IllegalReturn),32===R.charCodeAt(H)&&h(R.charCodeAt(H+1))?(c=oa(),ca(),a=a.finishReturnStatement(c)):I()?a=a.finishReturnStatement(null):(N(";")||N("}")||X.type===T.EOF||(c=oa()),ca(),a=a.finishReturnStatement(c)),
a;case "var":return Y("var"),c=Ma(),ca(),a.finishVariableDeclaration(c,"var")}c=oa();if(c.type===da.Identifier&&N(":"))return x(),b="$"+c.name,Object.prototype.hasOwnProperty.call(ba.labelSet,b)&&L(ka.Redeclaration,"Label",c.name),ba.labelSet[b]=!0,d=Fa(!1),delete ba.labelSet[b],a.finishLabeledStatement(c,d);ca();return a.finishExpressionStatement(c)}function Ca(){var a,b=[],c,d,g,m,f,r=new D;for(O("{");H<pa&&X.type===T.StringLiteral;){c=X;a=Na();b.push(a);if(a.expression.type!==da.Literal)break;
a=R.slice(c.start+1,c.end-1);"use strict"===a?(qa=!0,d&&U(d,ka.StrictOctalLiteral)):!d&&c.octal&&(d=c)}c=ba.labelSet;d=ba.inIteration;g=ba.inSwitch;m=ba.inFunctionBody;f=ba.parenthesizedCount;ba.labelSet={};ba.inIteration=!1;ba.inSwitch=!1;ba.inFunctionBody=!0;for(ba.parenthesizedCount=0;H<pa&&!N("}");){a=Na();if("undefined"===typeof a)break;b.push(a)}O("}");ba.labelSet=c;ba.inIteration=d;ba.inSwitch=g;ba.inFunctionBody=m;ba.parenthesizedCount=f;return r.finishBlockStatement(b)}function Ja(a,b,c){c=
"$"+c;qa?Object.prototype.hasOwnProperty.call(a.paramSet,c)&&(a.stricted=b,a.message=ka.StrictParamDupe):!a.firstRestricted&&Object.prototype.hasOwnProperty.call(a.paramSet,c)&&(a.firstRestricted=b,a.message=ka.StrictParamDupe);a.paramSet[c]=!0}function Ka(a){a={params:[],defaultCount:0,defaults:[],firstRestricted:a};O("(");if(!N(")"))for(a.paramSet={};H<pa;){var b=a,c=void 0,d=void 0,g=void 0,c=X,d=Da();Ja(b,c,c.value);N("\x3d")&&(x(),g=ta(),++b.defaultCount);b.params.push(d);b.defaults.push(g);
if(N(")"))break;O(",")}O(")");0===a.defaultCount&&(a.defaults=[]);return{params:a.params,defaults:a.defaults,stricted:a.stricted,firstRestricted:a.firstRestricted,message:a.message}}function Va(){var a,b=[],c=[],d,g,m,f,r,h=new D;Y("function");a=Da();d=Ka(m);b=d.params;c=d.defaults;g=d.stricted;m=d.firstRestricted;d.message&&(f=d.message);r=qa;d=Ca();qa&&m&&K(m,f);qa&&g&&U(g,f);qa=r;return h.finishFunctionDeclaration(a,b,c,d)}function Na(){if(X.type===T.Keyword)return"function"===X.value.toLowerCase()?
Va():Fa(!1);if(X.type!==T.EOF)return Fa(!1)}function Qa(){var a,b,c,d=[];for(a=0;a<Q.tokens.length;++a)b=Q.tokens[a],c={type:b.type,value:b.value},b.regex&&(c.regex={pattern:b.regex.pattern,flags:b.regex.flags}),Q.range&&(c.range=b.range),Q.loc&&(c.loc=b.loc),d.push(c);Q.tokens=d}var T,La,xa,da,Wa,Sa,ka,gb,R,qa,H,ea,ga,pa,X,ba,Q;T={BooleanLiteral:1,EOF:2,Identifier:3,Keyword:4,NullLiteral:5,NumericLiteral:6,Punctuator:7,StringLiteral:8,RegularExpression:9};La={};La[T.BooleanLiteral]="Boolean";La[T.EOF]=
"\x3cend\x3e";La[T.Identifier]="Identifier";La[T.Keyword]="Keyword";La[T.NullLiteral]="Null";La[T.NumericLiteral]="Numeric";La[T.Punctuator]="Punctuator";La[T.StringLiteral]="String";La[T.RegularExpression]="RegularExpression";xa="( { [ in typeof instanceof new return case delete throw void \x3d +\x3d -\x3d *\x3d /\x3d %\x3d \x3c\x3c\x3d \x3e\x3e\x3d \x3e\x3e\x3e\x3d \x26\x3d |\x3d ^\x3d , + - * / % ++ -- \x3c\x3c \x3e\x3e \x3e\x3e\x3e \x26 | ^ ! ~ \x26\x26 || ? : \x3d\x3d\x3d \x3d\x3d \x3e\x3d \x3c\x3d \x3c \x3e !\x3d !\x3d\x3d".split(" ");
da={AssignmentExpression:"AssignmentExpression",ArrayExpression:"ArrayExpression",BlockStatement:"BlockStatement",BinaryExpression:"BinaryExpression",BreakStatement:"BreakStatement",CallExpression:"CallExpression",ConditionalExpression:"ConditionalExpression",ContinueStatement:"ContinueStatement",DoWhileStatement:"DoWhileStatement",EmptyStatement:"EmptyStatement",ExpressionStatement:"ExpressionStatement",ForStatement:"ForStatement",ForInStatement:"ForInStatement",FunctionDeclaration:"FunctionDeclaration",
FunctionExpression:"FunctionExpression",Identifier:"Identifier",IfStatement:"IfStatement",Literal:"Literal",LogicalExpression:"LogicalExpression",MemberExpression:"MemberExpression",ObjectExpression:"ObjectExpression",Program:"Program",Property:"Property",ReturnStatement:"ReturnStatement",UnaryExpression:"UnaryExpression",UpdateExpression:"UpdateExpression",VariableDeclaration:"VariableDeclaration",VariableDeclarator:"VariableDeclarator"};Wa={ArrowParameterPlaceHolder:{type:"ArrowParameterPlaceHolder"}};
Sa={Data:1,Get:2,Set:4};ka={UnexpectedToken:"Unexpected token %0",UnexpectedNumber:"Unexpected number",UnexpectedString:"Unexpected string",UnexpectedIdentifier:"Unexpected identifier",UnexpectedReserved:"Unexpected reserved word",UnexpectedEOS:"Unexpected end of input",NewlineAfterThrow:"Illegal newline after throw",InvalidRegExp:"Invalid regular expression",UnterminatedRegExp:"Invalid regular expression: missing /",InvalidLHSInAssignment:"Invalid left-hand side in assignment",InvalidLHSInForIn:"Invalid left-hand side in for-in",
MultipleDefaultsInSwitch:"More than one default clause in switch statement",NoCatchOrFinally:"Missing catch or finally after try",UnknownLabel:"Undefined label '%0'",Redeclaration:"%0 '%1' has already been declared",IllegalContinue:"Illegal continue statement",IllegalBreak:"Illegal break statement",IllegalReturn:"Illegal return statement",StrictModeWith:"Strict mode code may not include a with statement",StrictCatchVariable:"Catch variable may not be eval or arguments in strict mode",StrictVarName:"Variable name may not be eval or arguments in strict mode",
StrictParamName:"Parameter name eval or arguments is not allowed in strict mode",StrictParamDupe:"Strict mode function may not have duplicate parameter names",StrictFunctionName:"Function name may not be eval or arguments in strict mode",StrictOctalLiteral:"Octal literals are not allowed in strict mode.",StrictDelete:"Delete of an unqualified identifier in strict mode.",StrictDuplicateProperty:"Duplicate data property in object literal not allowed in strict mode",AccessorDataProperty:"Object literal may not have data and accessor property with the same name",
AccessorGetSet:"Object literal may not have multiple get/set accessors with the same name",StrictLHSAssignment:"Assignment to eval or arguments is not allowed in strict mode",StrictLHSPostfix:"Postfix increment/decrement may not have eval or arguments operand in strict mode",StrictLHSPrefix:"Prefix increment/decrement may not have eval or arguments operand in strict mode",StrictReservedWord:"Use of future reserved word in strict mode"};gb={NonAsciiIdentifierStart:/[\u00aa\u00b5\u00ba\u00c0-\u00d6\u00d8-\u00f6\u00f8-\u02c1\u02c6-\u02d1\u02e0-\u02e4\u02ec\u02ee\u0370-\u0374\u0376\u0377\u037a-\u037d\u037f\u0386\u0388-\u038a\u038c\u038e-\u03a1\u03a3-\u03f5\u03f7-\u0481\u048a-\u052f\u0531-\u0556\u0559\u0561-\u0587\u05d0-\u05ea\u05f0-\u05f2\u0620-\u064a\u066e\u066f\u0671-\u06d3\u06d5\u06e5\u06e6\u06ee\u06ef\u06fa-\u06fc\u06ff\u0710\u0712-\u072f\u074d-\u07a5\u07b1\u07ca-\u07ea\u07f4\u07f5\u07fa\u0800-\u0815\u081a\u0824\u0828\u0840-\u0858\u08a0-\u08b2\u0904-\u0939\u093d\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098c\u098f\u0990\u0993-\u09a8\u09aa-\u09b0\u09b2\u09b6-\u09b9\u09bd\u09ce\u09dc\u09dd\u09df-\u09e1\u09f0\u09f1\u0a05-\u0a0a\u0a0f\u0a10\u0a13-\u0a28\u0a2a-\u0a30\u0a32\u0a33\u0a35\u0a36\u0a38\u0a39\u0a59-\u0a5c\u0a5e\u0a72-\u0a74\u0a85-\u0a8d\u0a8f-\u0a91\u0a93-\u0aa8\u0aaa-\u0ab0\u0ab2\u0ab3\u0ab5-\u0ab9\u0abd\u0ad0\u0ae0\u0ae1\u0b05-\u0b0c\u0b0f\u0b10\u0b13-\u0b28\u0b2a-\u0b30\u0b32\u0b33\u0b35-\u0b39\u0b3d\u0b5c\u0b5d\u0b5f-\u0b61\u0b71\u0b83\u0b85-\u0b8a\u0b8e-\u0b90\u0b92-\u0b95\u0b99\u0b9a\u0b9c\u0b9e\u0b9f\u0ba3\u0ba4\u0ba8-\u0baa\u0bae-\u0bb9\u0bd0\u0c05-\u0c0c\u0c0e-\u0c10\u0c12-\u0c28\u0c2a-\u0c39\u0c3d\u0c58\u0c59\u0c60\u0c61\u0c85-\u0c8c\u0c8e-\u0c90\u0c92-\u0ca8\u0caa-\u0cb3\u0cb5-\u0cb9\u0cbd\u0cde\u0ce0\u0ce1\u0cf1\u0cf2\u0d05-\u0d0c\u0d0e-\u0d10\u0d12-\u0d3a\u0d3d\u0d4e\u0d60\u0d61\u0d7a-\u0d7f\u0d85-\u0d96\u0d9a-\u0db1\u0db3-\u0dbb\u0dbd\u0dc0-\u0dc6\u0e01-\u0e30\u0e32\u0e33\u0e40-\u0e46\u0e81\u0e82\u0e84\u0e87\u0e88\u0e8a\u0e8d\u0e94-\u0e97\u0e99-\u0e9f\u0ea1-\u0ea3\u0ea5\u0ea7\u0eaa\u0eab\u0ead-\u0eb0\u0eb2\u0eb3\u0ebd\u0ec0-\u0ec4\u0ec6\u0edc-\u0edf\u0f00\u0f40-\u0f47\u0f49-\u0f6c\u0f88-\u0f8c\u1000-\u102a\u103f\u1050-\u1055\u105a-\u105d\u1061\u1065\u1066\u106e-\u1070\u1075-\u1081\u108e\u10a0-\u10c5\u10c7\u10cd\u10d0-\u10fa\u10fc-\u1248\u124a-\u124d\u1250-\u1256\u1258\u125a-\u125d\u1260-\u1288\u128a-\u128d\u1290-\u12b0\u12b2-\u12b5\u12b8-\u12be\u12c0\u12c2-\u12c5\u12c8-\u12d6\u12d8-\u1310\u1312-\u1315\u1318-\u135a\u1380-\u138f\u13a0-\u13f4\u1401-\u166c\u166f-\u167f\u1681-\u169a\u16a0-\u16ea\u16ee-\u16f8\u1700-\u170c\u170e-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176c\u176e-\u1770\u1780-\u17b3\u17d7\u17dc\u1820-\u1877\u1880-\u18a8\u18aa\u18b0-\u18f5\u1900-\u191e\u1950-\u196d\u1970-\u1974\u1980-\u19ab\u19c1-\u19c7\u1a00-\u1a16\u1a20-\u1a54\u1aa7\u1b05-\u1b33\u1b45-\u1b4b\u1b83-\u1ba0\u1bae\u1baf\u1bba-\u1be5\u1c00-\u1c23\u1c4d-\u1c4f\u1c5a-\u1c7d\u1ce9-\u1cec\u1cee-\u1cf1\u1cf5\u1cf6\u1d00-\u1dbf\u1e00-\u1f15\u1f18-\u1f1d\u1f20-\u1f45\u1f48-\u1f4d\u1f50-\u1f57\u1f59\u1f5b\u1f5d\u1f5f-\u1f7d\u1f80-\u1fb4\u1fb6-\u1fbc\u1fbe\u1fc2-\u1fc4\u1fc6-\u1fcc\u1fd0-\u1fd3\u1fd6-\u1fdb\u1fe0-\u1fec\u1ff2-\u1ff4\u1ff6-\u1ffc\u2071\u207f\u2090-\u209c\u2102\u2107\u210a-\u2113\u2115\u2119-\u211d\u2124\u2126\u2128\u212a-\u212d\u212f-\u2139\u213c-\u213f\u2145-\u2149\u214e\u2160-\u2188\u2c00-\u2c2e\u2c30-\u2c5e\u2c60-\u2ce4\u2ceb-\u2cee\u2cf2\u2cf3\u2d00-\u2d25\u2d27\u2d2d\u2d30-\u2d67\u2d6f\u2d80-\u2d96\u2da0-\u2da6\u2da8-\u2dae\u2db0-\u2db6\u2db8-\u2dbe\u2dc0-\u2dc6\u2dc8-\u2dce\u2dd0-\u2dd6\u2dd8-\u2dde\u2e2f\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303c\u3041-\u3096\u309d-\u309f\u30a1-\u30fa\u30fc-\u30ff\u3105-\u312d\u3131-\u318e\u31a0-\u31ba\u31f0-\u31ff\u3400-\u4db5\u4e00-\u9fcc\ua000-\ua48c\ua4d0-\ua4fd\ua500-\ua60c\ua610-\ua61f\ua62a\ua62b\ua640-\ua66e\ua67f-\ua69d\ua6a0-\ua6ef\ua717-\ua71f\ua722-\ua788\ua78b-\ua78e\ua790-\ua7ad\ua7b0\ua7b1\ua7f7-\ua801\ua803-\ua805\ua807-\ua80a\ua80c-\ua822\ua840-\ua873\ua882-\ua8b3\ua8f2-\ua8f7\ua8fb\ua90a-\ua925\ua930-\ua946\ua960-\ua97c\ua984-\ua9b2\ua9cf\ua9e0-\ua9e4\ua9e6-\ua9ef\ua9fa-\ua9fe\uaa00-\uaa28\uaa40-\uaa42\uaa44-\uaa4b\uaa60-\uaa76\uaa7a\uaa7e-\uaaaf\uaab1\uaab5\uaab6\uaab9-\uaabd\uaac0\uaac2\uaadb-\uaadd\uaae0-\uaaea\uaaf2-\uaaf4\uab01-\uab06\uab09-\uab0e\uab11-\uab16\uab20-\uab26\uab28-\uab2e\uab30-\uab5a\uab5c-\uab5f\uab64\uab65\uabc0-\uabe2\uac00-\ud7a3\ud7b0-\ud7c6\ud7cb-\ud7fb\uf900-\ufa6d\ufa70-\ufad9\ufb00-\ufb06\ufb13-\ufb17\ufb1d\ufb1f-\ufb28\ufb2a-\ufb36\ufb38-\ufb3c\ufb3e\ufb40\ufb41\ufb43\ufb44\ufb46-\ufbb1\ufbd3-\ufd3d\ufd50-\ufd8f\ufd92-\ufdc7\ufdf0-\ufdfb\ufe70-\ufe74\ufe76-\ufefc\uff21-\uff3a\uff41-\uff5a\uff66-\uffbe\uffc2-\uffc7\uffca-\uffcf\uffd2-\uffd7\uffda-\uffdc]/,
NonAsciiIdentifierPart:/[\u00aa\u00b5\u00ba\u00c0-\u00d6\u00d8-\u00f6\u00f8-\u02c1\u02c6-\u02d1\u02e0-\u02e4\u02ec\u02ee\u0300-\u0374\u0376\u0377\u037a-\u037d\u037f\u0386\u0388-\u038a\u038c\u038e-\u03a1\u03a3-\u03f5\u03f7-\u0481\u0483-\u0487\u048a-\u052f\u0531-\u0556\u0559\u0561-\u0587\u0591-\u05bd\u05bf\u05c1\u05c2\u05c4\u05c5\u05c7\u05d0-\u05ea\u05f0-\u05f2\u0610-\u061a\u0620-\u0669\u066e-\u06d3\u06d5-\u06dc\u06df-\u06e8\u06ea-\u06fc\u06ff\u0710-\u074a\u074d-\u07b1\u07c0-\u07f5\u07fa\u0800-\u082d\u0840-\u085b\u08a0-\u08b2\u08e4-\u0963\u0966-\u096f\u0971-\u0983\u0985-\u098c\u098f\u0990\u0993-\u09a8\u09aa-\u09b0\u09b2\u09b6-\u09b9\u09bc-\u09c4\u09c7\u09c8\u09cb-\u09ce\u09d7\u09dc\u09dd\u09df-\u09e3\u09e6-\u09f1\u0a01-\u0a03\u0a05-\u0a0a\u0a0f\u0a10\u0a13-\u0a28\u0a2a-\u0a30\u0a32\u0a33\u0a35\u0a36\u0a38\u0a39\u0a3c\u0a3e-\u0a42\u0a47\u0a48\u0a4b-\u0a4d\u0a51\u0a59-\u0a5c\u0a5e\u0a66-\u0a75\u0a81-\u0a83\u0a85-\u0a8d\u0a8f-\u0a91\u0a93-\u0aa8\u0aaa-\u0ab0\u0ab2\u0ab3\u0ab5-\u0ab9\u0abc-\u0ac5\u0ac7-\u0ac9\u0acb-\u0acd\u0ad0\u0ae0-\u0ae3\u0ae6-\u0aef\u0b01-\u0b03\u0b05-\u0b0c\u0b0f\u0b10\u0b13-\u0b28\u0b2a-\u0b30\u0b32\u0b33\u0b35-\u0b39\u0b3c-\u0b44\u0b47\u0b48\u0b4b-\u0b4d\u0b56\u0b57\u0b5c\u0b5d\u0b5f-\u0b63\u0b66-\u0b6f\u0b71\u0b82\u0b83\u0b85-\u0b8a\u0b8e-\u0b90\u0b92-\u0b95\u0b99\u0b9a\u0b9c\u0b9e\u0b9f\u0ba3\u0ba4\u0ba8-\u0baa\u0bae-\u0bb9\u0bbe-\u0bc2\u0bc6-\u0bc8\u0bca-\u0bcd\u0bd0\u0bd7\u0be6-\u0bef\u0c00-\u0c03\u0c05-\u0c0c\u0c0e-\u0c10\u0c12-\u0c28\u0c2a-\u0c39\u0c3d-\u0c44\u0c46-\u0c48\u0c4a-\u0c4d\u0c55\u0c56\u0c58\u0c59\u0c60-\u0c63\u0c66-\u0c6f\u0c81-\u0c83\u0c85-\u0c8c\u0c8e-\u0c90\u0c92-\u0ca8\u0caa-\u0cb3\u0cb5-\u0cb9\u0cbc-\u0cc4\u0cc6-\u0cc8\u0cca-\u0ccd\u0cd5\u0cd6\u0cde\u0ce0-\u0ce3\u0ce6-\u0cef\u0cf1\u0cf2\u0d01-\u0d03\u0d05-\u0d0c\u0d0e-\u0d10\u0d12-\u0d3a\u0d3d-\u0d44\u0d46-\u0d48\u0d4a-\u0d4e\u0d57\u0d60-\u0d63\u0d66-\u0d6f\u0d7a-\u0d7f\u0d82\u0d83\u0d85-\u0d96\u0d9a-\u0db1\u0db3-\u0dbb\u0dbd\u0dc0-\u0dc6\u0dca\u0dcf-\u0dd4\u0dd6\u0dd8-\u0ddf\u0de6-\u0def\u0df2\u0df3\u0e01-\u0e3a\u0e40-\u0e4e\u0e50-\u0e59\u0e81\u0e82\u0e84\u0e87\u0e88\u0e8a\u0e8d\u0e94-\u0e97\u0e99-\u0e9f\u0ea1-\u0ea3\u0ea5\u0ea7\u0eaa\u0eab\u0ead-\u0eb9\u0ebb-\u0ebd\u0ec0-\u0ec4\u0ec6\u0ec8-\u0ecd\u0ed0-\u0ed9\u0edc-\u0edf\u0f00\u0f18\u0f19\u0f20-\u0f29\u0f35\u0f37\u0f39\u0f3e-\u0f47\u0f49-\u0f6c\u0f71-\u0f84\u0f86-\u0f97\u0f99-\u0fbc\u0fc6\u1000-\u1049\u1050-\u109d\u10a0-\u10c5\u10c7\u10cd\u10d0-\u10fa\u10fc-\u1248\u124a-\u124d\u1250-\u1256\u1258\u125a-\u125d\u1260-\u1288\u128a-\u128d\u1290-\u12b0\u12b2-\u12b5\u12b8-\u12be\u12c0\u12c2-\u12c5\u12c8-\u12d6\u12d8-\u1310\u1312-\u1315\u1318-\u135a\u135d-\u135f\u1380-\u138f\u13a0-\u13f4\u1401-\u166c\u166f-\u167f\u1681-\u169a\u16a0-\u16ea\u16ee-\u16f8\u1700-\u170c\u170e-\u1714\u1720-\u1734\u1740-\u1753\u1760-\u176c\u176e-\u1770\u1772\u1773\u1780-\u17d3\u17d7\u17dc\u17dd\u17e0-\u17e9\u180b-\u180d\u1810-\u1819\u1820-\u1877\u1880-\u18aa\u18b0-\u18f5\u1900-\u191e\u1920-\u192b\u1930-\u193b\u1946-\u196d\u1970-\u1974\u1980-\u19ab\u19b0-\u19c9\u19d0-\u19d9\u1a00-\u1a1b\u1a20-\u1a5e\u1a60-\u1a7c\u1a7f-\u1a89\u1a90-\u1a99\u1aa7\u1ab0-\u1abd\u1b00-\u1b4b\u1b50-\u1b59\u1b6b-\u1b73\u1b80-\u1bf3\u1c00-\u1c37\u1c40-\u1c49\u1c4d-\u1c7d\u1cd0-\u1cd2\u1cd4-\u1cf6\u1cf8\u1cf9\u1d00-\u1df5\u1dfc-\u1f15\u1f18-\u1f1d\u1f20-\u1f45\u1f48-\u1f4d\u1f50-\u1f57\u1f59\u1f5b\u1f5d\u1f5f-\u1f7d\u1f80-\u1fb4\u1fb6-\u1fbc\u1fbe\u1fc2-\u1fc4\u1fc6-\u1fcc\u1fd0-\u1fd3\u1fd6-\u1fdb\u1fe0-\u1fec\u1ff2-\u1ff4\u1ff6-\u1ffc\u200c\u200d\u203f\u2040\u2054\u2071\u207f\u2090-\u209c\u20d0-\u20dc\u20e1\u20e5-\u20f0\u2102\u2107\u210a-\u2113\u2115\u2119-\u211d\u2124\u2126\u2128\u212a-\u212d\u212f-\u2139\u213c-\u213f\u2145-\u2149\u214e\u2160-\u2188\u2c00-\u2c2e\u2c30-\u2c5e\u2c60-\u2ce4\u2ceb-\u2cf3\u2d00-\u2d25\u2d27\u2d2d\u2d30-\u2d67\u2d6f\u2d7f-\u2d96\u2da0-\u2da6\u2da8-\u2dae\u2db0-\u2db6\u2db8-\u2dbe\u2dc0-\u2dc6\u2dc8-\u2dce\u2dd0-\u2dd6\u2dd8-\u2dde\u2de0-\u2dff\u2e2f\u3005-\u3007\u3021-\u302f\u3031-\u3035\u3038-\u303c\u3041-\u3096\u3099\u309a\u309d-\u309f\u30a1-\u30fa\u30fc-\u30ff\u3105-\u312d\u3131-\u318e\u31a0-\u31ba\u31f0-\u31ff\u3400-\u4db5\u4e00-\u9fcc\ua000-\ua48c\ua4d0-\ua4fd\ua500-\ua60c\ua610-\ua62b\ua640-\ua66f\ua674-\ua67d\ua67f-\ua69d\ua69f-\ua6f1\ua717-\ua71f\ua722-\ua788\ua78b-\ua78e\ua790-\ua7ad\ua7b0\ua7b1\ua7f7-\ua827\ua840-\ua873\ua880-\ua8c4\ua8d0-\ua8d9\ua8e0-\ua8f7\ua8fb\ua900-\ua92d\ua930-\ua953\ua960-\ua97c\ua980-\ua9c0\ua9cf-\ua9d9\ua9e0-\ua9fe\uaa00-\uaa36\uaa40-\uaa4d\uaa50-\uaa59\uaa60-\uaa76\uaa7a-\uaac2\uaadb-\uaadd\uaae0-\uaaef\uaaf2-\uaaf6\uab01-\uab06\uab09-\uab0e\uab11-\uab16\uab20-\uab26\uab28-\uab2e\uab30-\uab5a\uab5c-\uab5f\uab64\uab65\uabc0-\uabea\uabec\uabed\uabf0-\uabf9\uac00-\ud7a3\ud7b0-\ud7c6\ud7cb-\ud7fb\uf900-\ufa6d\ufa70-\ufad9\ufb00-\ufb06\ufb13-\ufb17\ufb1d-\ufb28\ufb2a-\ufb36\ufb38-\ufb3c\ufb3e\ufb40\ufb41\ufb43\ufb44\ufb46-\ufbb1\ufbd3-\ufd3d\ufd50-\ufd8f\ufd92-\ufdc7\ufdf0-\ufdfb\ufe00-\ufe0f\ufe20-\ufe2d\ufe33\ufe34\ufe4d-\ufe4f\ufe70-\ufe74\ufe76-\ufefc\uff10-\uff19\uff21-\uff3a\uff3f\uff41-\uff5a\uff66-\uffbe\uffc2-\uffc7\uffca-\uffcf\uffd2-\uffd7\uffda-\uffdc]/};
F.prototype=D.prototype={processComment:function(){var a,b,c,d=Q.bottomRightStack,g,m,f=d[d.length-1];if(!(this.type===da.Program&&0<this.body.length)){if(0<Q.trailingComments.length){c=[];for(g=Q.trailingComments.length-1;0<=g;--g)m=Q.trailingComments[g],m.range[0]>=this.range[1]&&(c.unshift(m),Q.trailingComments.splice(g,1));Q.trailingComments=[]}else f&&f.trailingComments&&f.trailingComments[0].range[0]>=this.range[1]&&(c=f.trailingComments,delete f.trailingComments);if(f)for(;f&&f.range[0]>=this.range[0];)a=
f,f=d.pop();if(a)a.leadingComments&&a.leadingComments[a.leadingComments.length-1].range[1]<=this.range[0]&&(this.leadingComments=a.leadingComments,a.leadingComments=void 0);else if(0<Q.leadingComments.length)for(b=[],g=Q.leadingComments.length-1;0<=g;--g)m=Q.leadingComments[g],m.range[1]<=this.range[0]&&(b.unshift(m),Q.leadingComments.splice(g,1));b&&0<b.length&&(this.leadingComments=b);c&&0<c.length&&(this.trailingComments=c);d.push(this)}},finish:function(){Q.range&&(this.range[1]=H);Q.loc&&(this.loc.end=
new C,Q.source&&(this.loc.source=Q.source));Q.attachComment&&this.processComment()},finishArrayExpression:function(a){this.type=da.ArrayExpression;this.elements=a;this.finish();return this},finishAssignmentExpression:function(a,b,c){this.type=da.AssignmentExpression;this.operator=a;this.left=b;this.right=c;this.finish();return this},finishBinaryExpression:function(a,b,c){this.type="||"===a||"\x26\x26"===a?da.LogicalExpression:da.BinaryExpression;this.operator=a;this.left=b;this.right=c;this.finish();
return this},finishBlockStatement:function(a){this.type=da.BlockStatement;this.body=a;this.finish();return this},finishBreakStatement:function(a){this.type=da.BreakStatement;this.label=a;this.finish();return this},finishCallExpression:function(a,b){this.type=da.CallExpression;this.callee=a;this.arguments=b;this.finish();return this},finishConditionalExpression:function(a,b,c){this.type=da.ConditionalExpression;this.test=a;this.consequent=b;this.alternate=c;this.finish();return this},finishContinueStatement:function(a){this.type=
da.ContinueStatement;this.label=a;this.finish();return this},finishEmptyStatement:function(){this.type=da.EmptyStatement;this.finish();return this},finishExpressionStatement:function(a){this.type=da.ExpressionStatement;this.expression=a;this.finish();return this},finishForStatement:function(a,b,c,d){this.type=da.ForStatement;this.init=a;this.test=b;this.update=c;this.body=d;this.finish();return this},finishForInStatement:function(a,b,c){this.type=da.ForInStatement;this.left=a;this.right=b;this.body=
c;this.each=!1;this.finish();return this},finishFunctionDeclaration:function(a,b,c,d){this.type=da.FunctionDeclaration;this.id=a;this.params=b;this.defaults=c;this.body=d;this.rest=null;this.expression=this.generator=!1;this.finish();return this},finishFunctionExpression:function(a,b,c,d){this.type=da.FunctionExpression;this.id=a;this.params=b;this.defaults=c;this.body=d;this.rest=null;this.expression=this.generator=!1;this.finish();return this},finishIdentifier:function(a){this.type=da.Identifier;
this.name=a;this.finish();return this},finishIfStatement:function(a,b,c){this.type=da.IfStatement;this.test=a;this.consequent=b;this.alternate=c;this.finish();return this},finishLiteral:function(a){this.type=da.Literal;this.value=a.value;this.raw=R.slice(a.start,a.end);a.regex&&(this.regex=a.regex);this.finish();return this},finishMemberExpression:function(a,b,c){this.type=da.MemberExpression;this.computed="["===a;this.object=b;this.property=c;this.finish();return this},finishObjectExpression:function(a){this.type=
da.ObjectExpression;this.properties=a;this.finish();return this},finishPostfixExpression:function(a,b){this.type=da.UpdateExpression;this.operator=a;this.argument=b;this.prefix=!1;this.finish();return this},finishProgram:function(a){this.type=da.Program;this.body=a;this.finish();return this},finishProperty:function(a,b,c,d,g){this.type=da.Property;this.key=b;this.value=c;this.kind=a;this.method=d;this.shorthand=g;this.finish();return this},finishReturnStatement:function(a){this.type=da.ReturnStatement;
this.argument=a;this.finish();return this},finishUnaryExpression:function(a,b){this.type="++"===a||"--"===a?da.UpdateExpression:da.UnaryExpression;this.operator=a;this.argument=b;this.prefix=!0;this.finish();return this},finishVariableDeclaration:function(a,b){this.type=da.VariableDeclaration;this.declarations=a;this.kind=b;this.finish();return this},finishVariableDeclarator:function(a,b){this.type=da.VariableDeclarator;this.id=a;this.init=b;this.finish();return this}};k.version="2.0.0-dev";k.tokenize=
function(a,b){var c,d;c=String;"string"===typeof a||a instanceof String||(a=c(a));R=a;H=0;ea=0<R.length?1:0;ga=0;pa=R.length;X=null;ba={allowIn:!0,labelSet:{},inFunctionBody:!1,inIteration:!1,inSwitch:!1,lastCommentStart:-1};Q={};b=b||{};b.tokens=!0;Q.tokens=[];Q.tokenize=!0;Q.openParenToken=-1;Q.openCurlyToken=-1;Q.range="boolean"===typeof b.range&&b.range;Q.loc="boolean"===typeof b.loc&&b.loc;"boolean"===typeof b.comment&&b.comment&&(Q.comments=[]);"boolean"===typeof b.tolerant&&b.tolerant&&(Q.errors=
[]);try{A();if(X.type===T.EOF)return Q.tokens;for(x();X.type!==T.EOF;)try{x()}catch($a){if(Q.errors){Q.errors.push($a);break}else throw $a;}Qa();d=Q.tokens;"undefined"!==typeof Q.comments&&(d.comments=Q.comments);"undefined"!==typeof Q.errors&&(d.errors=Q.errors)}catch($a){throw $a;}finally{Q={}}return d};k.parse=function(a,c){var d,g;g=String;"string"===typeof a||a instanceof String||(a=g(a));R=a;H=0;ea=0<R.length?1:0;ga=0;pa=R.length;X=null;ba={allowIn:!0,labelSet:{},parenthesisCount:0,inFunctionBody:!1,
inIteration:!1,inSwitch:!1,lastCommentStart:-1};Q={};"undefined"!==typeof c&&(Q.range="boolean"===typeof c.range&&c.range,Q.loc="boolean"===typeof c.loc&&c.loc,Q.attachComment="boolean"===typeof c.attachComment&&c.attachComment,Q.loc&&null!==c.source&&void 0!==c.source&&(Q.source=g(c.source)),"boolean"===typeof c.tokens&&c.tokens&&(Q.tokens=[]),"boolean"===typeof c.comment&&c.comment&&(Q.comments=[]),"boolean"===typeof c.tolerant&&c.tolerant&&(Q.errors=[]),Q.attachComment&&(Q.range=!0,Q.comments=
[],Q.bottomRightStack=[],Q.trailingComments=[],Q.leadingComments=[]));try{var m;b();A();m=new D;qa=!1;var f;a=[];for(var r,h,t;H<pa;){r=X;if(r.type!==T.StringLiteral)break;f=Na();a.push(f);if(f.expression.type!==da.Literal)break;h=R.slice(r.start+1,r.end-1);"use strict"===h?(qa=!0,t&&U(t,ka.StrictOctalLiteral)):!t&&r.octal&&(t=r)}for(;H<pa;){f=Na();if("undefined"===typeof f)break;a.push(f)}d=m.finishProgram(a);"undefined"!==typeof Q.comments&&(d.comments=Q.comments);"undefined"!==typeof Q.tokens&&
(Qa(),d.tokens=Q.tokens);"undefined"!==typeof Q.errors&&(d.errors=Q.errors)}catch(Ua){throw Ua;}finally{Q={}}return d};k.Syntax=function(){var a,b={};"function"===typeof Object.create&&(b=Object.create(null));for(a in da)da.hasOwnProperty(a)&&(b[a]=da[a]);"function"===typeof Object.freeze&&Object.freeze(b);return b}()})},"esri/arcade/arcadeCompiler":function(){define("require exports ../geometry/Polygon ../geometry/Polyline ../geometry/Point ../geometry/Extent ../geometry/Multipoint ../SpatialReference ./languageUtils ./treeAnalysis ./Dictionary ./Feature ./functions/date ./functions/string ./functions/maths ./functions/geometry ./functions/geomsync ./functions/stats ./ImmutablePathArray ./ImmutablePointArray ../geometry/Geometry".split(" "),
function(k,e,p,q,n,l,h,f,d,c,a,b,g,u,m,r,t,v,y,w,z){function x(a,b,c){try{return c(a,null,b)}catch(sa){throw sa;}}function A(a,b){try{switch(b.type){case "EmptyStatement":return"lc.voidOperation";case "VariableDeclarator":return F(a,b);case "VariableDeclaration":for(var d=[],g=0;g<b.declarations.length;g++)d.push(A(a,b.declarations[g]));return d.join("\n")+" \n lastStatement\x3d  lc.voidOperation; \n";case "BlockStatement":return D(a,b);case "FunctionDeclaration":var g=b.id.name.toLowerCase(),m={applicationCache:void 0===
a.applicationCache?null:a.applicationCache,spatialReference:a.spatialReference,console:a.console,symbols:a.symbols,localScope:{_SymbolsMap:{}},depthCounter:a.depthCounter+1,globalScope:a.globalScope};if(64<m.depthCounter)throw Error("Exceeded maximum function depth");for(var f="new lc.SizzleFunction( lang.functionDepthchecker(function() { var lastStatement \x3d lc.voidOperation; var lscope \x3d [];\n ",r=0;r<b.params.length;r++){var h=b.params[r].name.toLowerCase(),t=U(h,a);m.localScope._SymbolsMap[h]=
t;f+="lscope['"+t+"']\x3darguments["+r.toString()+"];\n"}f+=D(m,b.body)+"\n return lastStatement; }, runtimeCtx))";f+="\n lastStatement \x3d lc.voidOperation; \n";void 0!==a.globalScope[g]?d="gscope['"+g+"']\x3d"+f:void 0!==a.globalScope._SymbolsMap[g]?d="gscope['"+a.globalScope._SymbolsMap[g]+"']\x3d"+f:(t=U(g,a),a.globalScope._SymbolsMap[g]=t,d="gscope['"+t+"']\x3d"+f);return d;case "ReturnStatement":var l;l=null===b.argument?"return lc.voidOperation;":"return "+A(a,b.argument)+";";return l;case "IfStatement":if("AssignmentExpression"===
b.test.type||"UpdateExpression"===b.test.type)throw Error(c.nodeErrorMessage(b.test,"RUNTIME","CANNOT_USE_ASSIGNMENT_IN_CONDITION"));var e=A(a,b.test),n=O(a),u="var "+n+" \x3d "+e+";\n if ("+n+" \x3d\x3d\x3d true) {\n"+E(a,b.consequent)+"\n }\n",u=null!==b.alternate?u+("else if ("+n+"\x3d\x3d\x3dfalse)   { \n"+E(a,b.alternate)+"}\n"):u+("else if ("+n+"\x3d\x3d\x3dfalse) { \n lastStatement \x3d lc.voidOperation;\n }\n");return u+="else { lang.error({type: '"+b.type+"'},'RUNTIME','CANNOT_USE_NONBOOLEAN_IN_CONDITION'); \n}\n";
case "ExpressionStatement":var k;k="AssignmentExpression"===b.expression.type?"lastStatement \x3d lc.voidOperation; "+A(a,b.expression)+" \n ":"lastStatement \x3d "+A(a,b.expression)+";";return k;case "AssignmentExpression":return B(a,b);case "UpdateExpression":return C(a,b);case "BreakStatement":return"break;";case "ContinueStatement":return"continue;";case "ForStatement":d="lastStatement \x3d lc.voidOperation; \n";null!==b.init&&(d+=A(a,b.init));var v=O(a),w=O(a),d=d+("var "+v+" \x3d true;")+"\n do { ";
null!==b.update&&(d+=" if ("+v+"\x3d\x3d\x3dfalse) {\n "+A(a,b.update)+"  \n}\n "+v+"\x3dfalse; \n");null!==b.test&&(d+="var "+w+" \x3d "+A(a,b.test)+";",d+="if ("+w+"\x3d\x3d\x3dfalse) { break; } else if ("+w+"!\x3d\x3dtrue) { lang.error({type: '"+b.type+"'},'RUNTIME','CANNOT_USE_NONBOOLEAN_IN_CONDITION');   }\n");d+=A(a,b.body);null!==b.update&&(d+="\n "+A(a,b.update));return d+("\n"+v+" \x3d true; \n} while(true);  lastStatement \x3d lc.voidOperation;");case "ForInStatement":var p=O(a),z=O(a),
q=O(a),y="var "+p+" \x3d "+A(a,b.right)+";\n";"VariableDeclaration"===b.left.type&&(y+=A(a,b.left));var x="VariableDeclaration"===b.left.type?b.left.declarations[0].id.name:b.left.name,x=x.toLowerCase(),d="";null!==a.localScope&&(void 0!==a.localScope[x]?d="lscope['"+x+"']":void 0!==a.localScope._SymbolsMap[x]&&(d="lscope['"+a.localScope._SymbolsMap[x]+"']"));""===d&&(void 0!==a.globalScope[x]?d="gscope['"+x+"']":void 0!==a.globalScope._SymbolsMap[x]&&(d="gscope['"+a.globalScope._SymbolsMap[x]+"']"));
y=y+("if ("+p+"\x3d\x3d\x3dnull) {  lastStatement \x3d lc.voidOperation; }\n ")+("else if (lc.isArray("+p+") || lc.isString("+p+")) {")+("var "+z+"\x3d"+p+".length; \n")+("for(var "+q+"\x3d0; "+q+"\x3c"+z+"; "+q+"++) {\n");y+=d+"\x3d"+q+";\n";y+=A(a,b.body);y+="\n}\n";y+=" lastStatement \x3d lc.voidOperation; \n";y+=" \n}\n";y+="else if (lc.isImmutableArray("+p+")) {";y=y+("var "+z+"\x3d"+p+".length(); \n")+("for(var "+q+"\x3d0; "+q+"\x3c"+z+"; "+q+"++) {\n");y+=d+"\x3d"+q+";\n";y+=A(a,b.body);y+=
"\n}\n";y+=" lastStatement \x3d lc.voidOperation; \n";y+=" \n}\n";y+="else if (( "+p+" instanceof lang.Dictionary) || ( "+p+" instanceof lang.Feature)) {";y=y+("var "+z+"\x3d"+p+".keys(); \n")+("for(var "+q+"\x3d0; "+q+"\x3c"+z+".length; "+q+"++) {\n");y+=d+"\x3d"+z+"["+q+"];\n";y+=A(a,b.body);y+="\n}\n";y+=" lastStatement \x3d lc.voidOperation; \n";y+=" \n}\n";return y+"else { lastStatement \x3d lc.voidOperation; } \n";case "Identifier":return M(a,b);case "MemberExpression":var I;try{d=void 0,d=
!0===b.computed?A(a,b.property):"'"+b.property.name+"'",I="lang.member("+A(a,b.object)+","+d+")"}catch(xa){throw xa;}return I;case "Literal":return null===b.value||void 0===b.value?"null":JSON.stringify(b.value);case "ThisExpression":throw Error(c.nodeErrorMessage(b,"RUNTIME","NOTSUPPORTED"));case "CallExpression":try{if("Identifier"!==b.callee.type)throw Error(c.nodeErrorMessage(b,"RUNTIME","ONLYNODESSUPPORTED"));var J=b.callee.name.toLowerCase(),d="";null!==a.localScope&&(void 0!==a.localScope[J]?
d="lscope['"+J+"']":void 0!==a.localScope._SymbolsMap[J]&&(d="lscope['"+a.localScope._SymbolsMap[J]+"']"));""===d&&(void 0!==a.globalScope[J]?d="gscope['"+J+"']":void 0!==a.globalScope._SymbolsMap[J]&&(d="gscope['"+a.globalScope._SymbolsMap[J]+"']"));if(""!==d)for(g="[",m=0;m<b.arguments.length;m++)0<m&&(g+=", "),g+=A(a,b.arguments[m]);else throw Error(c.nodeErrorMessage(b,"RUNTIME","NOTFOUND"));}catch(xa){throw xa;}return"lang.callfunc("+d+","+(g+"]")+",runtimeCtx)";case "UnaryExpression":var L;
try{L="lang.unary("+A(a,b.argument)+",'"+b.operator+"')"}catch(xa){throw xa;}return L;case "BinaryExpression":var P;try{P="lang.binary("+A(a,b.left)+","+A(a,b.right)+",'"+b.operator+"')"}catch(xa){throw xa;}return P;case "LogicalExpression":var K;try{if("AssignmentExpression"===b.left.type||"UpdateExpression"===b.left.type)throw Error(c.nodeErrorMessage(b.left,"RUNTIME","CANNOT_USE_ASSIGNMENT_IN_CONDITION"));if("AssignmentExpression"===b.right.type||"UpdateExpression"===b.right.type)throw Error(c.nodeErrorMessage(b.right,
"RUNTIME","CANNOT_USE_ASSIGNMENT_IN_CONDITION"));if("\x26\x26"===b.operator||"||"===b.operator)K="(lang.logicalCheck("+A(a,b.left)+") "+b.operator+" lang.logicalCheck("+A(a,b.right)+"))";else throw Error(c.nodeErrorMessage("LogicalExpression","RUNTIME","ONLYORORAND"));}catch(xa){throw xa;}return K;case "ConditionalExpression":throw Error(c.nodeErrorMessage(b,"RUNTIME","NOTSUPPORTED"));case "ArrayExpression":try{d=[];for(g=0;g<b.elements.length;g++)"Literal"===b.elements[g].type?d.push(A(a,b.elements[g])):
d.push("lang.aCheck("+A(a,b.elements[g])+",'ArrayExpression')");f="["+d.join(",")+"]"}catch(xa){throw xa;}return f;case "ObjectExpression":d="lang.dictionary([";for(g=0;g<b.properties.length;g++){var r=b.properties[g],Z="Identifier"===r.key.type?"'"+r.key.name+"'":A(a,r.key),G=A(a,r.value);0<g&&(d+=",");d+="lang.strCheck("+Z+",'ObjectExpression'),lang.aCheck("+G+", 'ObjectExpression')"}return d+"])";case "Property":throw Error("Should not get here");case "Array":throw Error(c.nodeErrorMessage(b,"RUNTIME",
"NOTSUPPORTED"));default:throw Error(c.nodeErrorMessage(b,"RUNTIME","UNREOGNISED"));}}catch(xa){throw xa;}}function C(a,b){var c=null,d="";if("MemberExpression"===b.argument.type)return c=A(a,b.argument.object),d=!0===b.argument.computed?A(a,b.argument.property):"'"+b.argument.property.name+"'","lang.memberupdate("+c+","+d+",'"+b.operator+"',"+b.prefix+")";c=b.argument.name.toLowerCase();if(null!==a.localScope){if(void 0!==a.localScope[c])return"lang.update(lscope, '"+c+"','"+b.operator+"',"+b.prefix+
")";if(void 0!==a.localScope._SymbolsMap[c])return"lang.update(lscope, '"+a.localScope._SymbolsMap[c]+"','"+b.operator+"',"+b.prefix+")"}if(void 0!==a.globalScope[c])return"lang.update(gscope, '"+c+"','"+b.operator+"',"+b.prefix+")";if(void 0!==a.globalScope._SymbolsMap[c])return"lang.update(gscope, '"+a.globalScope._SymbolsMap[c]+"','"+b.operator+"',"+b.prefix+")";throw Error("Variable not recognised");}function B(a,b){var c=A(a,b.right),d=null,g="";if("MemberExpression"===b.left.type)return d=A(a,
b.left.object),g=!0===b.left.computed?A(a,b.left.property):"'"+b.left.property.name+"'","lang.assignmember("+d+","+g+",'"+b.operator+"',"+c+");";d=b.left.name.toLowerCase();if(null!==a.localScope){if(void 0!==a.localScope[d])return"lscope['"+d+"']\x3dlang.assign("+c+",'"+b.operator+"', lscope['"+d+"']); ";if(void 0!==a.localScope._SymbolsMap[d])return"lscope['"+a.localScope._SymbolsMap[d]+"']\x3dlang.assign("+c+",'"+b.operator+"', lscope['"+a.localScope._SymbolsMap[d]+"']); "}if(void 0!==a.globalScope[d])return"gscope['"+
d+"']\x3dlang.assign("+c+",'"+b.operator+"', gscope['"+d+"']); ";if(void 0!==a.globalScope._SymbolsMap[d])return"gscope['"+a.globalScope._SymbolsMap[d]+"']\x3dlang.assign("+c+",'"+b.operator+"', gscope['"+a.globalScope._SymbolsMap[d]+"']); ";throw Error("Variable not recognised");}function E(a,b){return"BlockStatement"===b.type?A(a,b):"ReturnStatement"===b.type?A(a,b):"BreakStatement"===b.type?A(a,b):"ContinueStatement"===b.type?A(a,b):"UpdateExpression"===b.type?"lastStatement \x3d "+A(a,b)+";":
"ExpressionStatement"===b.type?A(a,b):"ObjectExpression"===b.type?"lastStatement \x3d "+A(a,b)+";":A(a,b)}function D(a,b){for(var c="",d=0;d<b.body.length;d++)c="ReturnStatement"===b.body[d].type?c+(A(a,b.body[d])+" \n"):"BreakStatement"===b.body[d].type?c+(A(a,b.body[d])+" \n"):"ContinueStatement"===b.body[d].type?c+(A(a,b.body[d])+" \n"):"UpdateExpression"===b.body[d].type?c+("lastStatement \x3d "+A(a,b.body[d])+"; \n"):"ObjectExpression"===b.body[d].type?c+("lastStatement \x3d "+A(a,b.body[d])+
"; \n"):c+(A(a,b.body[d])+" \n");return c}function F(a,b){var c=null===b.init?null:A(a,b.init);c===d.voidOperation&&(c=null);b=b.id.name.toLowerCase();if(null!==a.localScope){if(void 0!==a.localScope[b])return"lscope['"+b+"']\x3d"+c+";";if(void 0!==a.localScope._SymbolsMap[b])return"lscope['"+a.localScope._SymbolsMap[b]+"']\x3d"+c+";";var g=U(b,a);a.localScope._SymbolsMap[b]=g;return"lscope['"+g+"']\x3d"+c+";"}if(void 0!==a.globalScope[b])return"gscope['"+b+"']\x3d"+c+";";if(void 0!==a.globalScope._SymbolsMap[b])return"gscope['"+
a.globalScope._SymbolsMap[b]+"']\x3d"+c+";";g=U(b,a);a.globalScope._SymbolsMap[b]=g;return"gscope['"+g+"']\x3d"+c+";"}function I(b,g,m){g=g.toLowerCase();switch(g){case "hasz":return b=b.hasZ,void 0===b?!1:b;case "hasm":return b=b.hasM,void 0===b?!1:b;case "spatialreference":return g=b.spatialReference._arcadeCacheId,void 0===g&&(m=!0,Object.freeze&&Object.isFrozen(b.spatialReference)&&(m=!1),m&&(N++,g=b.spatialReference._arcadeCacheId=N)),b=new a({wkt:b.spatialReference.wkt,wkid:b.spatialReference.wkid}),
void 0!==g&&(b._arcadeCacheId="SPREF"+g.toString()),b}switch(b.type){case "extent":switch(g){case "xmin":case "xmax":case "ymin":case "ymax":case "zmin":case "zmax":case "mmin":case "mmax":return b=b[g],void 0!==b?b:null;case "type":return"Extent"}break;case "polygon":switch(g){case "rings":return g=d.isVersion4?b.cache._arcadeCacheId:b.getCacheValue("_arcadeCacheId"),void 0===g&&(N++,g=N,d.isVersion4?b.cache._arcadeCacheId=g:b.setCacheValue("_arcadeCacheId",g)),b=new y(b.rings,b.spatialReference,
!0===b.hasZ,!0===b.hasM,g);case "type":return"Polygon"}break;case "point":switch(g){case "x":case "y":case "z":case "m":return void 0!==b[g]?b[g]:null;case "type":return"Point"}break;case "polyline":switch(g){case "paths":return g=d.isVersion4?b.cache._arcadeCacheId:b.getCacheValue("_arcadeCacheId"),void 0===g&&(N++,g=N,d.isVersion4?b.cache._arcadeCacheId=g:b.setCacheValue("_arcadeCacheId",g)),b=new y(b.paths,b.spatialReference,!0===b.hasZ,!0===b.hasM,g);case "type":return"Polyline"}break;case "multipoint":switch(g){case "points":return g=
d.isVersion4?b.cache._arcadeCacheId:b.getCacheValue("_arcadeCacheId"),void 0===g&&(N++,g=N,d.isVersion4?b.cache._arcadeCacheId=g:b.setCacheValue("_arcadeCacheId",g)),b=new w(b.points,b.spatialReference,!0===b.hasZ,!0===b.hasM,g,1);case "type":return"Multipoint"}}throw Error(c.nodeErrorMessage(m,"RUNTIME","PROPERTYNOTFOUND"));}function M(a,b){try{var d=b.name.toLowerCase();if(null!==a.localScope){if(void 0!==a.localScope[d])return"lscope['"+d+"']";if(void 0!==a.localScope._SymbolsMap[d])return"lscope['"+
a.localScope._SymbolsMap[d]+"']"}if(void 0!==a.globalScope[d])return"gscope['"+d+"']";if(void 0!==a.globalScope._SymbolsMap[d])return"gscope['"+a.globalScope._SymbolsMap[d]+"']";throw Error(c.nodeErrorMessage(b,"RUNTIME","VARIABLENOTFOUND"));}catch(sa){throw sa;}}function L(c){return null===c?"":d.isArray(c)||d.isImmutableArray(c)?"Array":d.isDate(c)?"Date":d.isString(c)?"String":d.isBoolean(c)?"Boolean":d.isNumber(c)?"Number":c instanceof a?"Dictionary":c instanceof b?"Feature":c instanceof n?"Point":
c instanceof p?"Polygon":c instanceof q?"Polyline":c instanceof h?"Multipoint":c instanceof l?"Extent":d.isFunctionParameter(c)?"Function":c===d.voidOperation?"":"number"===typeof c&&isNaN(c)?"Number":"Unrecognised Type"}function J(a,b,c,g){try{if(d.equalityTest(b[c],g))return b[c+1];var m=b.length-c;return 1===m?b[c]:2===m?null:3===m?b[c+2]:J(a,b,c+2,g)}catch(ua){throw ua;}}function P(a,b,c,g){try{if(!0===g)return b[c+1];if(3===b.length-c)return b[c+2];var m=b[c+2];if(!1===d.isBoolean(m))throw Error("WHEN needs boolean test conditions");
return P(a,b,c+2,m)}catch(ua){throw ua;}}function K(a,b){var c=a.length,d=Math.floor(c/2);if(0===c)return[];if(1===c)return[a[0]];var g=K(a.slice(0,d),b);a=K(a.slice(d,c),b);for(c=[];0<g.length||0<a.length;)0<g.length&&0<a.length?(d=b(g[0],a[0]),isNaN(d)&&(d=0),0>=d?(c.push(g[0]),g=g.slice(1)):(c.push(a[0]),a=a.slice(1))):0<g.length?(c.push(g[0]),g=g.slice(1)):0<a.length&&(c.push(a[0]),a=a.slice(1));return c}function U(a,b){b.symbols.symbolCounter++;return"_T"+b.symbols.symbolCounter.toString()}function O(a){a.symbols.symbolCounter++;
return"_Tvar"+a.symbols.symbolCounter.toString()}function S(a,b,c){var d={};a||(a={});c||(c={});d._SymbolsMap={};d.textformatting=1;d.infinity=1;d.pi=1;for(var g in b)d[g]=1;for(g in c)d[g]=1;for(g in a)d[g]=1;return d}function Y(a){console.log(a)}Object.defineProperty(e,"__esModule",{value:!0});var N=0,W={};g.registerFunctions(W,x);u.registerFunctions(W,x);m.registerFunctions(W,x);r.registerFunctions(W,x);v.registerFunctions(W,x);t.registerFunctions(W,x);W["typeof"]=function(a,b){return x(a,b,function(a,
b,c){d.pcCheck(c,1,1);a=L(c[0]);if("Unrecognised Type"===a)throw Error("Unrecognised Type");return a})};W.iif=function(a,b){try{return x(a,b,function(a,b,c){d.pcCheck(c,3,3);if(!1===d.isBoolean(c[0]))throw Error("IF Function must have a boolean test condition");return c[0]?c[1]:c[2]})}catch(ia){throw ia;}};W.decode=function(a,b){try{return x(a,b,function(b,c,d){if(2>d.length)throw Error("Missing Parameters");if(2===d.length)return d[1];if(0===(d.length-1)%2)throw Error("Must have a default value result.");
return J(a,d,1,d[0])})}catch(ia){throw ia;}};W.when=function(a,b){try{return x(a,b,function(b,c,g){if(3>g.length)throw Error("Missing Parameters");if(0===g.length%2)throw Error("Must have a default value result.");b=g[0];if(!1===d.isBoolean(b))throw Error("WHEN needs boolean test conditions");return P(a,g,0,b)})}catch(ia){throw ia;}};W.top=function(a,b){return x(a,b,function(a,b,c){d.pcCheck(c,2,2);if(d.isArray(c[0]))return d.toNumber(c[1])>=c[0].length?c[0].slice(0):c[0].slice(0,d.toNumber(c[1]));
if(d.isImmutableArray(c[0]))return d.toNumber(c[1])>=c[0].length()?c[0].slice(0):c[0].slice(0,d.toNumber(c[1]));throw Error("Top cannot accept this parameter type");})};W.first=function(a,b){return x(a,b,function(a,b,c){d.pcCheck(c,1,1);return d.isArray(c[0])?0===c[0].length?null:c[0][0]:d.isImmutableArray(c[0])?0===c[0].length()?null:c[0].get(0):null})};W.sort=function(a,b){return x(a,b,function(a,b,c){d.pcCheck(c,1,2);b=c[0];d.isImmutableArray(b)&&(b=b.toArray());if(!1===d.isArray(b))throw Error("Illegal Argument");
if(1<c.length){if(!1===d.isFunctionParameter(c[1]))throw Error("Illegal Argument");b=K(b,function(b,d){return fa.callfunc(c[1],[b,d],a)})}else{if(0===b.length)return[];for(var g={},m=0;m<b.length;m++){var f=L(b[m]);""!==f&&(g[f]=!0)}if(!0===g.Array||!0===g.Dictionary||!0===g.Feature||!0===g.Point||!0===g.Polygon||!0===g.Polyline||!0===g.Multipoint||!0===g.Extent||!0===g.Function)return b.slice(0);var m=0,f="",r;for(r in g)m++,f=r;b=1<m||"String"===f?K(b,function(a,b){if(null===a||void 0===a||a===
d.voidOperation)return null===b||void 0===b||b===d.voidOperation?0:1;if(null===b||void 0===b||b===d.voidOperation)return-1;a=d.toString(a);b=d.toString(b);return a<b?-1:a===b?0:1}):"Number"===f?K(b,function(a,b){return a-b}):"Boolean"===f?K(b,function(a,b){return a===b?0:b?-1:1}):"Date"===f?K(b,function(a,b){return b-a}):b.slice(0)}return b})};for(var ca in W)W[ca]=new d.NativeFunction(W[ca]);var ha=function(){};ha.prototype=W;e.functionHelper={fixSpatialReference:d.fixSpatialReference,parseArguments:function(a,
b){for(var c=[],d=0;d<b.arguments.length;d++)c.push(A(a,b.arguments[d]));return c},standardFunction:x};e.extend=function(a){for(var b={mode:"sync",compiled:!0,functions:{},signatures:[],standardFunction:x},g=0;g<a.length;g++)a[g].registerFunctions(b);for(var m in b.functions)W[m]=new d.NativeFunction(b.functions[m]),ha.prototype[m]=W[m];for(g=0;g<b.signatures.length;g++)c.addFunctionDeclaration(b.signatures[g],"f")};e.executeScript=function(a,b,c){return a(b,c)};e.extractFieldLiterals=function(a,
b){void 0===b&&(b=!1);return c.findFieldLiterals(a,b)};e.validateScript=function(a,b){return c.validateScript(a,b,"simple")};e.referencesMember=function(a,b){return c.referencesMember(a,b)};e.referencesFunction=function(a,b){return c.referencesFunction(a,b)};var fa={error:function(a,b,d){throw Error(c.nodeErrorMessage(a,b,d));},functionDepthchecker:function(a,b){return function(){b.depthCounte++;if(64<b.depthCounter)throw Error("Exceeded maximum function depth");var c=a.apply(this,arguments);b.depthCounte--;
return c}},aCheck:function(a,b){if(d.isFunctionParameter(a))throw Error(c.nodeErrorMessage({type:b},"RUNTIME","FUNCTIONCONTEXTILLEGAL"));return a===d.voidOperation?null:a},Dictionary:a,Feature:b,dictionary:function(b){for(var c={},g=0;g<b.length;g+=2){if(d.isFunctionParameter(b[g+1]))throw Error("Illegal Argument");if(!1===d.isString(b[g]))throw Error("Illegal Argument");c[b[g].toString()]=b[g+1]===d.voidOperation?null:b[g+1]}b=new a(c);b.immutable=!1;return b},strCheck:function(a,b){if(!1===d.isString(a))throw Error("Illegal Argument");
return a},unary:function(a,b){if(d.isBoolean(a)){if("!"===b)return!a;if("-"===b)return-1*d.toNumber(a);if("+"===b)return 1*d.toNumber(a);throw Error(c.nodeErrorMessage({type:"UnaryExpression"},"RUNTIME","NOTSUPPORTEDUNARYOPERATOR"));}if("-"===b)return-1*d.toNumber(a);if("+"===b)return 1*d.toNumber(a);throw Error(c.nodeErrorMessage({type:"UnaryExpression"},"RUNTIME","NOTSUPPORTEDUNARYOPERATOR"));},logicalCheck:function(a){if(!1===d.isBoolean(a))throw Error(c.nodeErrorMessage("LogicalExpression","RUNTIME",
"ONLYORORAND"));return a},logical:function(a,b,g){if(d.isBoolean(a)&&d.isBoolean(b))switch(g){case "||":return a||b;case "\x26\x26":return a&&b;default:throw Error(c.nodeErrorMessage("LogicalExpression","RUNTIME","ONLYORORAND"));}else throw Error(c.nodeErrorMessage("LogicalExpression","RUNTIME","ONLYORORAND"));},binary:function(a,b,g){switch(g){case "\x3d\x3d":return d.equalityTest(a,b);case "\x3d":return d.equalityTest(a,b);case "!\x3d":return!d.equalityTest(a,b);case "\x3c":return d.greaterThanLessThan(a,
b,g);case "\x3e":return d.greaterThanLessThan(a,b,g);case "\x3c\x3d":return d.greaterThanLessThan(a,b,g);case "\x3e\x3d":return d.greaterThanLessThan(a,b,g);case "+":return d.isString(a)||d.isString(b)?d.toString(a)+d.toString(b):d.toNumber(a)+d.toNumber(b);case "-":return d.toNumber(a)-d.toNumber(b);case "*":return d.toNumber(a)*d.toNumber(b);case "/":return d.toNumber(a)/d.toNumber(b);case "%":return d.toNumber(a)%d.toNumber(b);default:throw Error(c.nodeErrorMessage({type:"BinaryExpression"},"RUNTIME",
"OPERATORNOTRECOGNISED"));}},assign:function(a,b,g){switch(b){case "\x3d":return a===d.voidOperation?null:a;case "/\x3d":return d.toNumber(g)/d.toNumber(a);case "*\x3d":return d.toNumber(g)*d.toNumber(a);case "-\x3d":return d.toNumber(g)-d.toNumber(a);case "+\x3d":return d.isString(g)||d.isString(a)?d.toString(g)+d.toString(a):d.toNumber(g)+d.toNumber(a);case "%\x3d":return d.toNumber(g)%d.toNumber(a);default:throw Error(c.nodeErrorMessage("AssignmentExpression","RUNTIME","OPERATORNOTRECOGNISED"));
}},update:function(a,b,c,g){var m=d.toNumber(a[b]);a[b]="++"===c?m+1:m-1;return!1===g?m:"++"===c?m+1:m-1},memberupdate:function(c,g,m,f){var r;if(d.isArray(c))if(d.isNumber(g)){0>g&&(g=c.length+g);if(0>g||g>=c.length)throw Error("Assignment outside of array bounds");r=d.toNumber(c[g]);c[g]="++"===m?r+1:r-1}else throw Error("Invalid Parameter");else if(c instanceof a){if(!1===d.isString(g))throw Error("Dictionary accessor must be a string");if(!0===c.hasField(g))r=d.toNumber(c.field(g)),c.setField(g,
"++"===m?r+1:r-1);else throw Error("Invalid Parameter");}else if(c instanceof b){if(!1===d.isString(g))throw Error("Feature accessor must be a string");if(!0===c.hasField(g))r=d.toNumber(c.field(g)),c.setField(g,"++"===m?r+1:r-1);else throw Error("Invalid Parameter");}else{if(d.isImmutableArray(c))throw Error("Array is Immutable");throw Error("Invalid Parameter");}return!1===f?r:"++"===m?r+1:r-1},assignmember:function(c,g,m,f){if(d.isArray(c))if(d.isNumber(g)){0>g&&(g=c.length+g);if(0>g||g>c.length)throw Error("Assignment outside of array bounds");
if(g===c.length&&"\x3d"!==m)throw Error("Invalid Parameter");c[g]=this.assign(f,m,c[g])}else throw Error("Invalid Parameter");else if(c instanceof a){if(!1===d.isString(g))throw Error("Dictionary accessor must be a string");if(!0===c.hasField(g))c.setField(g,this.assign(f,m,c.field(g)));else{if("\x3d"!==m)throw Error("Invalid Parameter");c.setField(g,this.assign(f,m,null))}}else if(c instanceof b){if(!1===d.isString(g))throw Error("Feature accessor must be a string");if(!0===c.hasField(g))c.setField(g,
this.assign(f,m,c.field(g)));else{if("\x3d"!==m)throw Error("Invalid Parameter");c.setField(g,this.assign(f,m,null))}}else{if(d.isImmutableArray(c))throw Error("Array is Immutable");throw Error("Invalid Parameter");}},member:function(g,m){if(null===g)throw Error(c.nodeErrorMessage("MemberExpression","RUNTIME","NOTFOUND"));if(g instanceof a||g instanceof b){if(d.isString(m))return g.field(m)}else if(g instanceof z){if(d.isString(m))return I(g,m,"MemberExpression")}else if(d.isArray(g)){if(d.isNumber(m)&&
isFinite(m)&&Math.floor(m)===m){0>m&&(m=g.length+m);if(m>=g.length||0>m)throw Error(c.nodeErrorMessage("MemberExpression","RUNTIME","OUTOFBOUNDS"));return g[m]}}else if(d.isString(g)){if(d.isNumber(m)&&isFinite(m)&&Math.floor(m)===m){0>m&&(m=g.length+m);if(m>=g.length||0>m)throw Error(c.nodeErrorMessage("MemberExpression","RUNTIME","OUTOFBOUNDS"));return g[m]}}else if(d.isImmutableArray(g)&&d.isNumber(m)&&isFinite(m)&&Math.floor(m)===m){0>m&&(m=g.length()+m);if(m>=g.length()||0>m)throw Error(c.nodeErrorMessage("MemberExpression",
"RUNTIME","OUTOFBOUNDS"));return g.get(m)}throw Error(c.nodeErrorMessage("MemberExpression","RUNTIME","INVALIDTYPE"));},callfunc:function(a,b,c){return a instanceof d.NativeFunction?a.fn(c,b):a instanceof d.SizzleFunction?a.fn.apply(this,b):a.apply(this,b)}};e.compileScript=function(c,g){void 0===g&&(g=null);null===g&&(g={vars:{},customfunctions:{}});g={globalScope:S(g.vars,W,g.customfunctions),localScope:null,console:Y,symbols:{symbolCounter:0}};c=A(g,c.body[0].body);""===c&&(c="lc.voidOperation;");
g={lc:d,lang:fa,postProcess:function(a){a instanceof d.ReturnResult&&(a=a.value);a instanceof d.ImplicitResult&&(a=a.value);a===d.voidOperation&&(a=null);if(a===d.breakResult)throw Error("Cannot return BREAK");if(a===d.continueResult)throw Error("Cannot return CONTINUE");if(d.isFunctionParameter(a))throw Error("Cannot return FUNCTION");return a},prepare:function(c,d){d||(d=new f({wkid:102100}));var g=c.vars,m=c.customfunctions,r=new ha;g||(g={});m||(m={});var h=new a({newline:"\n",tab:"\t",singlequote:"'",
doublequote:'"',forwardslash:"/",backwardslash:"\\"});h.immutable=!1;r._SymbolsMap={textformatting:1,infinity:1,pi:1};r.textformatting=h;r.infinity=Number.POSITIVE_INFINITY;r.pi=Math.PI;for(var t in m)r[t]=m[t],r._SymbolsMap[t]=1;for(t in g)r._SymbolsMap[t]=1,r[t]=g[t]&&"esri.Graphic"===g[t].declaredClass?new b(g[t]):g[t];return{spatialReference:d,globalScope:r,localScope:null,console:c.console?c.console:Y,symbols:{symbolCounter:0},depthCounter:1,applicationCache:void 0===c.applicationCache?null:
c.applicationCache}}};return(new Function("context","spatialReference","var runtimeCtx\x3dthis.prepare(context, spatialReference);\n var lc \x3d this.lc;  var lang \x3d this.lang; var gscope\x3druntimeCtx.globalScope; \n function mainBody() {\n var lastStatement\x3dlc.voidOperation;\n "+c+"\n return lastStatement; } \n return this.postProcess(mainBody());")).bind(g)}})},"esri/renderers/UniqueValueRenderer":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/has ../kernel ../lang ../symbols/jsonUtils ./Renderer ../support/expressionUtils".split(" "),
function(k,e,p,q,n,l,h,f,d){return k(f,{declaredClass:"esri.renderer.UniqueValueRenderer",constructor:function(c,a,b,d,f){this.values=[];this._symbols={};this.infos=[];c&&!c.declaredClass?(a=c,this.defaultSymbol=(c=a.defaultSymbol)&&(c.declaredClass?c:h.fromJson(c)),this.attributeField=a.field1,this.attributeField2=a.field2,this.attributeField3=a.field3,this.fieldDelimiter=a.fieldDelimiter,this.defaultLabel=a.defaultLabel,this.setValueExpression(a.valueExpression),this.valueExpressionTitle=a.valueExpressionTitle,
this.legendOptions=a.legendOptions,a.backgroundFillSymbol&&(this.backgroundFillSymbol=h.fromJson(a.backgroundFillSymbol)),e.forEach(a.uniqueValueInfos,this._addValueInfo,this)):(this.defaultSymbol=c,this.attributeField=a,this.attributeField2=b,this.attributeField3=d,this.fieldDelimiter=f);this._multiple=!!this.attributeField2},addValue:function(c,a){c=p.isObject(c)?c:{value:c,symbol:a};this._addValueInfo(c)},removeValue:function(c){var a=e.indexOf(this.values,c);-1!==a&&(this.values.splice(a,1),delete this._symbols[c],
this.infos.splice(a,1))},getUniqueValueInfo:function(c){var a=this.attributeField,b=c.attributes,d,f;this.valueExpression?a=this._getDataValue(c,this._uvInfo,null,this._cache.uvInfo):this._multiple?(c=this.attributeField2,d=this.attributeField3,f=[],a&&f.push(b[a]),c&&f.push(b[c]),d&&f.push(b[d]),a=f.join(this.fieldDelimiter||"")):a=p.isFunction(a)?a(c):b[a];return this._symbols[a]},setValueExpression:function(c){this.valueExpression=c;this._uvInfo={valueExpression:c};this._cache.uvInfo=this._createCache(this._uvInfo,
!0)},getFieldsUsedInExpressions:function(){var c=this.inherited(arguments);this.valueExpression&&(c=c.concat(d.extractFieldNames(this.valueExpression)));c.sort();return e.filter(c,function(a,b){return 0===b||c[b-1]!==a})},getSymbol:function(c){return(c=this.getUniqueValueInfo(c))&&c.symbol||this.defaultSymbol},_addValueInfo:function(c){var a=c.value;this.values.push(a);this.infos.push(c);var b=c.symbol;b&&!b.declaredClass&&(c.symbol=h.fromJson(b));this._symbols[a]=c},toJson:function(){var c=l.fixJson,
a;a={type:"uniqueValue",field1:this.attributeField,field2:this.attributeField2,field3:this.attributeField3,fieldDelimiter:this.fieldDelimiter,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,legendOptions:p.clone(this.legendOptions),defaultSymbol:this.defaultSymbol&&this.defaultSymbol.toJson(),defaultLabel:this.defaultLabel,uniqueValueInfos:e.map(this.infos||[],function(a){a=p.mixin({},a);a.symbol=a.symbol&&a.symbol.toJson();a.value+="";return c(a)})};this.backgroundFillSymbol&&
(a.backgroundFillSymbol=this.backgroundFillSymbol.toJson());a=p.mixin(this.inherited(arguments),a);return c(a)}})})},"esri/renderers/ClassBreaksRenderer":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/has ../kernel ../lang ../symbols/jsonUtils ./Renderer ../support/expressionUtils".split(" "),function(k,e,p,q,n,l,h,f,d){return k(f,{declaredClass:"esri.renderer.ClassBreaksRenderer",constructor:function(c,a){this.breaks=[];this._symbols={};this.infos=[];this.isMaxInclusive=
!0;if(c&&!c.declaredClass){a=c;this.attributeField=a.field;this.setValueExpression(a.valueExpression);this.valueExpressionTitle=a.valueExpressionTitle;this.legendOptions=a.legendOptions;this.defaultSymbol=(c=a.defaultSymbol)&&(c.declaredClass?c:h.fromJson(c));this.backgroundFillSymbol=(c=a.backgroundFillSymbol)&&(c.declaredClass?c:h.fromJson(c));this._copy(["defaultLabel","classificationMethod:rest","normalizationType:rest","normalizationField","normalizationTotal"],a,this);var b=a.minValue;(c=a.classBreakInfos)&&
c[0]&&l.isDefined(c[0].classMaxValue)&&e.forEach(c,function(a){var c=a.classMaxValue;a.minValue=b;b=a.maxValue=c},this);e.forEach(c,this._addBreakInfo,this)}else this.defaultSymbol=c,this.attributeField=a},addBreak:function(c,a,b){c=p.isObject(c)?c:{minValue:c,maxValue:a,symbol:b};this._addBreakInfo(c)},removeBreak:function(c,a){var b,d=this.breaks,f,m=d.length,r=this._symbols;for(f=0;f<m;f++)if(b=d[f],b[0]==c&&b[1]==a){d.splice(f,1);delete r[c+"-"+a];this.infos.splice(f,1);break}},clearBreaks:function(){this.breaks=
[];this._symbols={};this.infos=[]},getBreakIndex:function(c){var a=this.attributeField,b=c.attributes,d=this.breaks,f=d.length,m=this.isMaxInclusive;if(this.valueExpression)c=this._getDataValue(c,this._cbInfo,null,this._cache.cbInfo);else if(p.isFunction(a))c=a(c);else{c=parseFloat(b[a]);var a=this.normalizationType,r;if(a)if(r=parseFloat(this.normalizationTotal),b=parseFloat(b[this.normalizationField]),"log"===a)c=Math.log(c)*Math.LOG10E;else if("percent-of-total"===a&&!isNaN(r))c=c/r*100;else if("field"===
a){if(isNaN(c)||isNaN(b))return-1;c/=b}}if(null!=c&&!isNaN(c)&&"number"===typeof c)for(b=0;b<f;b++)if(a=d[b],a[0]<=c&&(m?c<=a[1]:c<a[1]))return b;return-1},getBreakInfo:function(c){c=this.getBreakIndex(c);return-1!==c?this.infos[c]:null},getSymbol:function(c){return(c=this.breaks[this.getBreakIndex(c)])?this._symbols[c[0]+"-"+c[1]]:this.defaultSymbol},setMaxInclusive:function(c){this.isMaxInclusive=c},setValueExpression:function(c){this.valueExpression=c;this._cbInfo={valueExpression:c};this._cache.cbInfo=
this._createCache(this._cbInfo)},getFieldsUsedInExpressions:function(){var c=this.inherited(arguments);this.valueExpression&&(c=c.concat(d.extractFieldNames(this.valueExpression)));c.sort();return e.filter(c,function(a,b){return 0===b||c[b-1]!==a})},isContinuousRenderer:function(){var c=!1;if(this.infos&&1===this.infos.length)var a=this.attributeField,b=this.normalizationField,d=this.valueExpression,c=this.getVisualVariablesForType("colorInfo",!1)||[],f=this.getVisualVariablesForType("sizeInfo",!1)||
[],m=this.getVisualVariablesForType("opacityInfo",!1)||[],c=c.concat(f).concat(m),c=e.some(c,function(c){return(c.field===a||c.valueExpression===d)&&c.normalizationField==b});return c},_normalizationTypeEnums:[["field","esriNormalizeByField"],["log","esriNormalizeByLog"],["percent-of-total","esriNormalizeByPercentOfTotal"]],_classificationMethodEnums:[["natural-breaks","esriClassifyNaturalBreaks"],["equal-interval","esriClassifyEqualInterval"],["quantile","esriClassifyQuantile"],["standard-deviation",
"esriClassifyStandardDeviation"],["geometrical-interval","esriClassifyGeometricalInterval"],["defined-interval","esriClassifyDefinedInterval"]],_copy:function(c,a,b){e.forEach(c,function(c){var d=c.split(":"),g,f,h;1<d.length&&(c=d[0],g=this["_"+c+"Enums"],"rest"===d[1]?(f="1",h="0"):"sdk"===d[1]&&(f="0",h="1"));d=a[c];if(void 0!==d&&(b[c]=d,g&&f)){var l,e=g.length;for(l=0;l<e;l++)if(g[l][f]===d){b[c]=g[l][h];break}}},this)},_addBreakInfo:function(c){var a=c.minValue,b=c.maxValue;this.breaks.push([a,
b]);this.infos.push(c);var d=c.symbol;d&&!d.declaredClass&&(c.symbol=h.fromJson(d));this._symbols[a+"-"+b]=c.symbol},toJson:function(){var c=this.infos||[],a=l.fixJson,b=c[0]&&c[0].minValue,d=this.backgroundFillSymbol,c=p.mixin(this.inherited(arguments),{type:"classBreaks",field:this.attributeField,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,legendOptions:p.clone(this.legendOptions),defaultSymbol:this.defaultSymbol&&this.defaultSymbol.toJson(),backgroundFillSymbol:d&&
d.toJson(),minValue:-Infinity===b?-Number.MAX_VALUE:b,classBreakInfos:e.map(c,function(b){b=p.mixin({},b);b.symbol=b.symbol&&b.symbol.toJson();b.classMaxValue=Infinity===b.maxValue?Number.MAX_VALUE:b.maxValue;delete b.minValue;delete b.maxValue;return a(b)})});this._copy(["defaultLabel","classificationMethod:sdk","normalizationType:sdk","normalizationField","normalizationTotal"],this,c);c.hasOwnProperty("normalizationType")&&!c.normalizationType&&delete c.normalizationType;c.hasOwnProperty("classificationMethod")&&
!c.classificationMethod&&delete c.classificationMethod;return a(c)}})})},"esri/renderers/VectorFieldRenderer":function(){define("dojo/_base/declare dojo/_base/lang dojo/has dojo/_base/array ../kernel ../lang ../Color ./Renderer ./ClassBreaksRenderer ../symbols/SimpleMarkerSymbol ../symbols/PictureMarkerSymbol ../symbols/SimpleLineSymbol ../symbols/jsonUtils require".split(" "),function(k,e,p,q,n,l,h,f,d,c,a,b,g,u){var m=k(f,{declaredClass:"esri.renderer.VectorFieldRenderer",iconFolderPath:"../images/symbol/sfs/",
constructor:function(a){l.isDefined(a)||(a={});a.attributeField=a.attributeField||"Magnitude";a.rotationInfo=a.rotationInfo||this._getRotationInfo(a);k.safeMixin(this,a);this.setRotationInfo(this.rotationInfo);this.style=this.style||m.STYLE_SINGLE_ARROW;this.singleArrowSymbol&&(this.singleArrowSymbol=this.singleArrowSymbol.declaredClass?this.singleArrowSymbol:g.fromJson(this.singleArrowSymbol));this.renderer=new d(this._getDefaultSymbol(),a.attributeField);this._updateRenderer(this.style);this.flowRepresentation=
this.flowRepresentation||this.FLOW_FROM},getSymbol:function(a){return this.renderer&&this.renderer.getSymbol(a)},setVisualVariables:function(a){a=q.filter(a,function(a){if("sizeInfo"===a.type)return l.isDefined(this._updateSizeInfo(a))},this);this.inherited(arguments);return this},setSizeInfo:function(a){this._updateSizeInfo(a);this.inherited(arguments);return this},setProportionalSymbolInfo:function(a){this.setSizeInfo(a);return this},setColorInfo:function(a){return this},_updateRenderer:function(a){return l.isDefined(this.renderer)?
a===m.STYLE_SINGLE_ARROW?this._createSingleArrowRenderer():a===m.STYLE_BEAUFORT_KN?this._createBeaufortKnotsRenderer():a===m.STYLE_BEAUFORT_METER?this._createBeaufortMeterRenderer():a===m.STYLE_BEAUFORT_FEET?this._createBeaufortFeetRenderer():a===m.STYLE_BEAUFORT_MILE?this._createBeaufortMilesRenderer():a===m.STYLE_BEAUFORT_KM?this._createBeaufortKilometersRenderer():a===m.STYLE_OCEAN_CURRENT_M?this._createCurrentMeterRenderer():a===m.STYLE_OCEAN_CURRENT_KN?this._createCurrentKnotsRenderer():a===
m.STYLE_SCALAR?this._createSimpleScalarRenderer():a===m.STYLE_WIND_BARBS?this._createWindBarbsRenderer():this._createClassifiedArrowRenderer():Error("Invalid Renderer!")},_updateSizeInfo:function(a){return a&&l.isDefined(a.minSize)&&l.isDefined(a.maxSize)&&l.isDefined(a.minDataValue)&&l.isDefined(a.maxDataValue)?(this.style===m.STYLE_WIND_BARBS&&(a.minSize=a.maxSize),a.field=a.field||"Magnitude",a.type="sizeInfo",a):null},_createClassifiedArrowRenderer:function(){this.renderer.defaultSymbol=this._getDefaultSymbol(new h([56,
168,0]));var a=[0,1E-6,3.5,7,10.5,14];if(l.isDefined(this.minDataValue)&&l.isDefined(this.maxDataValue)){var b=(this.maxDataValue-this.minDataValue)/5,a=[],c,d;d=this.minDataValue;for(c=0;6>c;c++)a[c]=d,d+=b}this._addBreaks(a,[[56,168,0],[139,309,0],[255,255,0],[255,128,0],[255,0,0]])},_createSingleArrowRenderer:function(){this.renderer.defaultSymbol=this.singleArrowSymbol||this._getDefaultSymbol()},_createBeaufortMeterRenderer:function(){this.renderer.defaultSymbol=this._getDefaultSymbol(new h([214,
47,39]));this._addBreaks([0,.2,1.8,3.3,5.4,8.5,11,14.1,17.2,20.8,24.4,28.6,32.7],[[69,117,181],[101,137,184],[132,158,186],[162,180,189],[192,204,190],[222,227,191],[255,255,191],[255,220,161],[250,185,132],[245,152,105],[237,117,81],[232,21,21]])},_createBeaufortKnotsRenderer:function(){this.renderer.defaultSymbol=this._getDefaultSymbol(new h([214,47,39]));this._addBreaks([0,1,3,6,10,16,21,27,33,40,47,55,63],[[40,146,199],[89,162,186],[129,179,171],[160,194,155],[191,212,138],[218,230,119],[250,
250,100],[252,213,83],[252,179,102],[250,141,52],[247,110,42],[240,71,29]])},_createBeaufortFeetRenderer:function(){var a=[0,.2,1.8,3.3,5.4,8.5,11,14.1,17.2,20.8,24.4,28.6,32.7];q.forEach(a,function(b,c){a[c]*=3.28084});this.renderer.defaultSymbol=this._getDefaultSymbol(new h([214,47,39]));this._addBreaks(a,[[69,117,181],[101,137,184],[132,158,186],[162,180,189],[192,204,190],[222,227,191],[255,255,191],[255,220,161],[250,185,132],[245,152,105],[237,117,81],[232,21,21]])},_createBeaufortMilesRenderer:function(){var a=
[0,.2,1.8,3.3,5.4,8.5,11,14.1,17.2,20.8,24.4,28.6,32.7];q.forEach(a,function(b,c){a[c]*=2.23694});this.renderer.defaultSymbol=this._getDefaultSymbol(new h([214,47,39]));this._addBreaks(a,[[69,117,181],[101,137,184],[132,158,186],[162,180,189],[192,204,190],[222,227,191],[255,255,191],[255,220,161],[250,185,132],[245,152,105],[237,117,81],[232,21,21]])},_createBeaufortKilometersRenderer:function(){var a=[0,.2,1.8,3.3,5.4,8.5,11,14.1,17.2,20.8,24.4,28.6,32.7];q.forEach(a,function(b,c){a[c]*=3.6});this.renderer.defaultSymbol=
this._getDefaultSymbol(new h([214,47,39]));this._addBreaks(a,[[69,117,181],[101,137,184],[132,158,186],[162,180,189],[192,204,190],[222,227,191],[255,255,191],[255,220,161],[250,185,132],[245,152,105],[237,117,81],[232,21,21]])},_createCurrentMeterRenderer:function(){this.renderer.defaultSymbol=this._getDefaultSymbol(new h([177,177,177]));this._addBreaks([0,.5,1,1.5,2],[[78,26,153],[179,27,26],[202,128,26],[177,177,177]])},_createCurrentKnotsRenderer:function(){this.renderer.defaultSymbol=this._getDefaultSymbol(new h([177,
177,177]));this._addBreaks([0,.25,.5,1,1.5,2,2.5,3,3.5,4],[[0,0,0],[0,37,100],[78,26,153],[151,0,100],[179,27,26],[177,78,26],[202,128,26],[177,179,52],[177,177,177]])},_createSimpleScalarRenderer:function(){this.renderer.defaultSymbol=new a({url:u.toUrl(this.iconFolderPath+"scalar.png"),height:20,width:20,type:"esriPMS",angle:0})},_createWindBarbsRenderer:function(){var d=[],g,m;for(g=0;150>=g;g+=5)d.push(g);m="M20 20 M5 20 A15 15 0 1 0 35 20 A15 15 0 1 0 5 20 M20 20 M10 20 A10 10 0 1 0 30 20 A10 10 0 1 0 10 20;M25 0 L25 40 M25 35 L17.5 37.5;M25 0 L25 40 L10 45 L25 40;M25 0 L25 40 L10 45 L25 40 M25 35 L17.5 37.5;M25 0 L25 40 L10 45 L25 40 M25 35 L10 40;M25 0 L25 40 L10 45 L25 40 M25 35 L10 40 L25 35 M25 30 L17.5 32.5;M25 0 L25 40 L10 45 L25 40 M25 35 L10 40 L25 35 M25 30 L10 35;M25 0 L25 40 L10 45 L25 40 M25 35 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L17.5 27.5;M25 0 L25 40 L10 45 L25 40 M25 35 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30;M25 0 L25 40 L10 45 L25 40 M25 35 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30 L25 25 M25 20 L17.5 22.5;M25 0 L25 40 L10 40 L25 35;M25 0 L25 40 L10 40 L25 35 M25 30 L17.5 32.5;M25 0 L25 40 L10 40 L25 35 M25 30 L10 35;M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L17.5 27.5;M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30;M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30 L25 25 M25 20 L17.5 22.5;M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30 L25 25 M25 20 L10 25;M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30 L25 25 M25 20 L10 25 L25 20 M25 15 L17.5 17.5;M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30 L25 25 M25 20 L10 25 L25 20 M25 15 L10 20;M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30 L25 25 M25 20 L10 25 L25 20 M25 15 L10 20 L25 15 M25 10 L17.5 12.5;M25 0 L25 40 L10 40 L25 35 L10 35 L25 30;M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L17.5 27.5;M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30;M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L17.5 22.5;M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L10 25;M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L10 25 M25 20 M25 15 L17.5 17.5;M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L10 25 M25 20 M25 15 L10 20;M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L10 25 M25 20 M25 15 L10 20 M25 15 M25 10 L17.5 12.5;M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L10 25 M25 20 M25 15 L10 20 M25 15 M25 10 L10 15;M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L10 25 M25 20 M25 15 L10 20 M25 15 M25 10 L10 15 M25 10 M25 5 L17.5 7.5".split(";");
var f=new a({url:u.toUrl(this.iconFolderPath+"windbarb.png"),height:20,width:20,type:"esriPMS",angle:0});this.renderer.defaultSymbol=f;for(g=0;g<d.length-1;g++)0===g?this.renderer.addBreak({minValue:d[g],maxValue:d[g+1],symbol:f}):this.renderer.addBreak({minValue:d[g],maxValue:d[g+1],symbol:(new c).setPath(m[g]).setOutline((new b).setWidth(1.5)).setSize(20).setColor(new h([0,0,0,255]))})},_getDefaultSymbol:function(a){return(new c).setPath("M14,32 14,18 9,23 16,3 22,23 17,18 17,32 z").setOutline((new b).setWidth(0)).setSize(20).setColor(a||
new h([0,92,230]))},_getRotationInfo:function(a){var b=a&&a.flowRepresentation||m.FLOW_FROM,c=a&&a.rotationField||"Direction",d=m.FLOW_FROM;return{field:function(a){a=a.attributes[c];return b===d?a:a+180},type:"geographic"}},_addBreaks:function(a,b){if(!l.isDefined(this.renderer))return Error("Invalid Renderer!");if(!(a&&b&&a.length&&b.length&&a.length>=b.length))return Error("AddBreaks: Input arguments break values and colors not valid");var c;for(c=0;c<b.length;c++)this.renderer.addBreak({minValue:a[c],
maxValue:a[c+1],symbol:this._getDefaultSymbol(new h(b[c]))})},toJson:function(){var a=e.mixin(this.inherited(arguments),{type:"vectorField",style:this.style,attributeField:this.attributeField,flowRepresentation:this.flowRepresentation});this.renderer&&this.renderer.defaultSymbol&&this.style===m.STYLE_SINGLE_ARROW&&(a.singleArrowSymbol=this.renderer.defaultSymbol.toJson());return l.fixJson(a)}});e.mixin(m,{STYLE_WIND_BARBS:"wind_speed",STYLE_SINGLE_ARROW:"single_arrow",STYLE_CLASSIFIED_ARROW:"classified_arrow",
STYLE_BEAUFORT_KN:"beaufort_kn",STYLE_BEAUFORT_METER:"beaufort_m",STYLE_BEAUFORT_MILE:"beaufort_mi",STYLE_BEAUFORT_FEET:"beaufort_ft",STYLE_BEAUFORT_KM:"beaufort_km",STYLE_OCEAN_CURRENT_M:"ocean_current_m",STYLE_OCEAN_CURRENT_KN:"ocean_current_kn",STYLE_SCALAR:"simple_scalar"},{FLOW_FROM:"flow_from",FLOW_TO:"flow_to"});return m})},"esri/renderers/DotDensityRenderer":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/dom-construct dojo/has dojox/gfx/_base ../kernel ../lang ../Color ./Renderer ../symbols/PictureFillSymbol ../geometry/ScreenPoint ../geometry/Point".split(" "),
function(k,e,p,q,n,l,h,f,d,c,a,b,g){return k(c,{declaredClass:"esri.renderer.DotDensityRenderer",constructor:function(a){this.dotSize=a.dotSize||3;this.dotValue=a.dotValue;this.fields=a.fields;this.outline=a.outline;this.backgroundColor=a.backgroundColor;this.exactCount=a.exactCount||!0;this.dotShape=a.dotShape||"square";this.legendOptions=a.legendOptions;this._exactCountMinArea=1E4;this._currentMapScale=this._map=this._canvas=null;this._symbolMap={};this._currentGraphic=this._currentResolution=this._objectIdField=
null;this._supportsCanvas=window.CanvasRenderingContext2D?!0:!1;window.CanvasRenderingContext2D||console.log("The DotDensityRenderer requires a Canvas enabled Browser.  IE8 and less does not support Canvas.")},getSymbol:function(b){var c,d;this._currentGraphic=b;if(!this._supportsCanvas)return null;this._map||(this._map=b.getLayer()._map,this._objectIdField=b.getLayer().objectIdField,this._currentMapScale=this._map.getScale(),this._currentResolution=this._map.extent.getWidth()/this._map.width,this._map.on("zoom-end",
e.hitch(this,function(a){this._currentMapScale=this._map.getScale();this._currentResolution=a.extent.getWidth()/this._map.width;this._symbolMap[this._currentMapScale]={}})));if(this._symbolMap[this._currentMapScale]&&this._symbolMap[this._currentMapScale][b.attributes[this._objectIdField]])return c=this._symbolMap[this._currentMapScale][b.attributes[this._objectIdField]],d=this._getShapeProperties(b),c.setOffset(d.dx,d.dy),c;c=this._generateFieldsCount(this.fields,b.attributes,this.dotValue);d=this._getShapeProperties(b);
if(!d.width||!d.height)return null;c=new a(this._generateImageSrc(d.width,d.height,c,d.minXY,d.maxXY),this.outline,d.width,d.height);c.setOffset(d.dx,d.dy);this._symbolMap[this._currentMapScale]||(this._symbolMap[this._currentMapScale]={});return this._symbolMap[this._currentMapScale][b.attributes[this._objectIdField]]=c},_generateFieldsCount:function(a,b,c){var d,g;for(g=a.length-1;0<=g;g--)d=b[a[g].name]/c,a[g].numPoints=Math.round(d);return a},_getShapeProperties:function(a){var b,c,d,f;b=a.geometry.getExtent();
b.contains(this._map.extent)&&(b=this._map.extent);d=Math.ceil(b.getWidth()/this._currentResolution);f=Math.ceil(b.getHeight()/this._currentResolution);c=this._map.toScreen(new g(b.xmin,b.ymin,b.spatialReference));b=this._map.toScreen(new g(b.xmax,b.ymax,b.spatialReference));a=a.getLayer().getNode().getCTM();return{minXY:c,maxXY:b,dx:(c.x-a.e)%d,dy:(b.y-a.f)%f,width:d,height:f}},_generateImageSrc:function(a,b,c,d,g,f){var m=this.dotSize,r,h,t;this._canvas?(this._canvas.width=a,this._canvas.height=
b):this._canvas=this._initCanvas(a,b);r=this._canvas.getContext("2d");if(f=f||this.backgroundColor)r.fillStyle=f.toCss(!0),r.fillRect(0,0,a,b),r.fill();for(f=c.length-1;0<=f;f--)for(r.fillStyle=c[f].color.toCss(!0),h=c[f].numPoints-1;0<=h;h--)t=this._getRandomPoint(a,b,d,g),"square"===this.dotShape?r.fillRect(t.x,t.y,m,m):"circle"===this.dotShape&&(r.beginPath(),r.arc(t.x,t.y,m/2,0,2*Math.PI,!0)),r.fill();return this._canvas.toDataURL()},_initCanvas:function(a,b){a=q.create("canvas",{id:"canvas",
width:a+"px",height:b+"px",style:"position: absolute; left: -10000px; top: 0px;"},null);document.body.appendChild(a);return a},_getRandomInt:function(a,b){return Math.floor(Math.random()*(b-a+1)+a)},_getRandomPoint:function(a,c,d,g){var m={},f=this.outline&&this.outline.width?this.outline.width:0;if(!0===this.exactCount&&a*c>this._exactCountMinArea){a=!1;do m.x=this._getRandomInt(d.x,g.x),m.y=this._getRandomInt(g.y,d.y),a=new b(m.x,m.y),a=this._checkPointShapeBounds(a,this.dotSize+f,this._currentGraphic.geometry),
!0===a&&(m.x-=d.x,m.y-=g.y);while(!1===a)}else m.x=this._getRandomInt(0,a),m.y=this._getRandomInt(0,c);return m},_checkPointShapeBounds:function(a,b,c){var d=null,d=!1,g=!0,m=0;do{switch(m){case 1:a.x+=b;break;case 2:a.y+=b;break;case 3:a.x-=b}d=this._map.toMap(a);d=c.contains(d);!1===d&&(g=!1);m+=1}while(3>=m&&!0===g);return d},setDotSize:function(a){0<a&&(this.dotSize=a)},setDotValue:function(a){0<a&&(this.dotValue=a)},setOutline:function(a){this.outline=a},setBackgroundColor:function(a){this.backgroundColor=
a},toJson:function(){var a=e.mixin(this.inherited(arguments),{type:"dotDensity",backgroundColor:d.toJsonColor(this.backgroundColor),dotShape:this.dotShape,dotSize:0<this.dotSize?l.px2pt(this.dotSize):0,dotValue:this.dotValue,fields:p.map(this.fields,function(a){return f.fixJson({color:d.toJsonColor(a.color),name:a.name})}),legendOptions:this.legendOptions&&f.fixJson({backgroundColor:d.toJsonColor(this.legendOptions.backgroundColor),dotCoverage:this.legendOptions.dotCoverage,outline:this.legendOptions.outline&&
this.legendOptions.outline.toJson(),valueUnit:this.legendOptions.valueUnit}),outline:this.outline&&this.outline.toJson()});return f.fixJson(a)}})})},"esri/renderers/ScaleDependentRenderer":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/has ../kernel ../lang ./Renderer".split(" "),function(k,e,p,q,n,l,h){return k(h,{declaredClass:"esri.renderer.ScaleDependentRenderer",constructor:function(f){this.setRendererInfos(f&&f.rendererInfos||[])},setRendererInfos:function(f){this.rendererInfos=
f;this._setRangeType();return this},getSymbol:function(f){var d=this.getRendererInfo(f);return d&&d.renderer&&d.renderer.getSymbol(f)},getRendererInfo:function(f){f=f.getLayer().getMap();return"zoom"===this.rangeType?this.getRendererInfoByZoom(f.getZoom()):this.getRendererInfoByScale(f.getScale())},getRendererInfoByZoom:function(f){var d,c=this.rendererInfos,a,b=0;do d=c[b],f>=d.minZoom&&f<=d.maxZoom&&(a=d),b++;while(!a&&b<c.length);return a},getRendererInfoByScale:function(f){var d,c=this.rendererInfos,
a,b=0,g,h,m,r;do d=c[b],g=d.minScale,h=d.maxScale,m=!g,r=!h,!m&&f<=g&&(m=!0),!r&&f>=h&&(r=!0),m&&r&&(a=d),b++;while(!a&&b<c.length);return a},addRendererInfo:function(f){var d,c=0,a,b=this.rendererInfos,g=f.hasOwnProperty("minZoom")?"minZoom":"minScale",h=b.length;do{a=b[c];if(h===c||f[g]<a[g])b.splice(c,0,f),this._setRangeType(),d=!0;c++}while(!d&&c<h);return this},_setRangeType:function(){var f=this.rendererInfos;if(f=f&&f[0])this.rangeType=f.hasOwnProperty("minZoom")?"zoom":f.hasOwnProperty("minScale")?
"scale":""},toJson:function(){if("zoom"===this.rangeType)return null;var f=this.rendererInfos||[],d=f[0]&&f[0].minScale,f=p.mixin(this.inherited(arguments),{type:"scaleDependent",minScale:0<d?d:0,rendererInfos:e.map(f,function(c){return l.fixJson({maxScale:0<c.maxScale?c.maxScale:0,renderer:c.renderer&&c.renderer.toJson()})})});return l.fixJson(f)}})})},"esri/renderers/TimeClassBreaksAger":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/has dojo/date ../kernel ../lang ../symbols/jsonUtils ../Color ./SymbolAger".split(" "),
function(k,e,p,q,n,l,h,f,d,c){var a=k(c,{declaredClass:"esri.renderer.TimeClassBreaksAger",constructor:function(a,c){this.infos=a;this.timeUnits=c||"day";a.sort(function(a,b){return a.minAge<b.minAge?-1:a.minAge>b.minAge?1:0})},getAgedSymbol:function(a,c){var b=c.getLayer();c=c.attributes;var d=h.isDefined;a=f.fromJson(a.toJson());var g=b._map.timeExtent.endTime;if(!g)return a;var t=n.difference(new Date(c[b._startTimeField]),g,this.timeUnits);e.some(this.infos,function(b){if(t>=b.minAge&&t<=b.maxAge){var c=
b.color,g=b.size;b=b.alpha;c&&a.setColor(c);d(g)&&this._setSymbolSize(a,g);d(b)&&a.color&&(a.color.a=b);return!0}},this);return a},toJson:function(){var a={agerClassBreakInfos:[]},c,f,m;a.timeUnits=this._getRestUnits(this.timeUnits);for(c=0;c<this.infos.length;c+=1)f=this.infos[c],m={},m.oldestAge=Infinity===f.maxAge?null:f.maxAge,m.size=f.size,f.color&&(m.color=d.toJsonColor(f.color)),f.alpha&&(m.alpha=Math.round(255*f.alpha)),a.agerClassBreakInfos[c]=m;return a},_getRestUnits:function(b){var c=
"esriTimeUnitsDays";switch(b){case a.UNIT_SECONDS:c="esriTimeUnitsSeconds";break;case a.UNIT_MILLISECONDS:c="esriTimeUnitsMilliseconds";break;case a.UNIT_HOURS:c="esriTimeUnitsHours";break;case a.UNIT_MINUTES:c="esriTimeUnitsMinutes";break;case a.UNIT_MONTHS:c="esriTimeUnitsMonths";break;case a.UNIT_WEEKS:c="esriTimeUnitsWeeks";break;case a.UNIT_YEARS:c="esriTimeUnitsYears"}return c}});p.mixin(a,{UNIT_DAYS:"day",UNIT_HOURS:"hour",UNIT_MILLISECONDS:"millisecond",UNIT_MINUTES:"minute",UNIT_MONTHS:"month",
UNIT_SECONDS:"second",UNIT_WEEKS:"week",UNIT_YEARS:"year"});return a})},"esri/renderers/SymbolAger":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel"],function(k,e,p,q){return k(null,{declaredClass:"esri.renderer.SymbolAger",getAgedSymbol:function(e,l){},_setSymbolSize:function(e,l){switch(e.type){case "simplemarkersymbol":e.setSize(l);break;case "picturemarkersymbol":e.setWidth(l);e.setHeight(l);break;case "simplelinesymbol":case "cartographiclinesymbol":e.setWidth(l);
break;case "simplefillsymbol":case "picturefillsymbol":e.outline&&e.outline.setWidth(l)}}})})},"esri/renderers/TimeRampAger":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/Color dojo/has ../kernel ../symbols/jsonUtils ../Color ./SymbolAger".split(" "),function(k,e,p,q,n,l,h,f){return k(f,{declaredClass:"esri.renderer.TimeRampAger",constructor:function(d,c,a){this.colorRange=d;this.sizeRange=c;this.alphaRange=a},getAgedSymbol:function(d,c){var a=c.getLayer(),b=c.attributes;d=l.fromJson(d.toJson());
var g=a._map.timeExtent;c=g.startTime;g=g.endTime;if(!c||!g)return d;c=c.getTime();g=g.getTime();a=new Date(b[a._startTimeField]);a=a.getTime();a<c&&(a=c);a=g===c?1:(a-c)/(g-c);if(c=this.sizeRange)b=c[0],g=c[1],c=Math.abs(g-b)*a,this._setSymbolSize(d,b<g?b+c:b-c);if(c=this.colorRange){var g=c[0],f=c[1],m=Math.round,b=new p,r=g.r,h=f.r;c=Math.abs(h-r)*a;b.r=m(r<h?r+c:r-c);r=g.g;h=f.g;c=Math.abs(h-r)*a;b.g=m(r<h?r+c:r-c);r=g.b;h=f.b;c=Math.abs(h-r)*a;b.b=m(r<h?r+c:r-c);g=g.a;f=f.a;c=Math.abs(f-g)*a;
b.a=g<f?g+c:g-c;d.setColor(b)}b=d.color;(c=this.alphaRange)&&b&&(g=c[0],f=c[1],c=Math.abs(f-g)*a,b.a=g<f?g+c:g-c);return d},toJson:function(){var d={};this.sizeRange&&(d.sizeRange=this.sizeRange);this.colorRange&&(d.colorRange=[h.toJsonColor(this.colorRange[0]),h.toJsonColor(this.colorRange[1])]);this.alphaRange&&(d.alphaRange=[Math.round(255*this.alphaRange[0]),Math.round(255*this.alphaRange[1])]);return d}})})},"esri/renderers/TemporalRenderer":function(){define(["dojo/_base/declare","dojo/_base/lang",
"dojo/has","../kernel","./Renderer"],function(k,e,p,q,n){return k(n,{declaredClass:"esri.renderer.TemporalRenderer",constructor:function(l,h,f,d){this.observationRenderer=l;this.latestObservationRenderer=h;this.trackRenderer=f;this.observationAger=d},getSymbol:function(l){var h=l.getLayer(),f=this.getObservationRenderer(l),d=f&&f.getSymbol(l),c=this.observationAger;h.timeInfo&&h._map.timeExtent&&f===this.observationRenderer&&c&&d&&(d=c.getAgedSymbol(d,l));return d},getObservationRenderer:function(l){return 0===
l.getLayer()._getKind(l)?this.observationRenderer:this.latestObservationRenderer||this.observationRenderer},toJson:function(){var l={type:"temporal"};l.observationRenderer=this.observationRenderer.toJson();this.latestObservationRenderer&&(l.latestObservationRenderer=this.latestObservationRenderer.toJson());this.trackRenderer&&(l.trackRenderer=this.trackRenderer.toJson());this.observationAger&&(l.observationAger=this.observationAger.toJson());return l}})})},"esri/renderers/HeatmapRenderer":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/dom-construct ../sniff ../kernel ../lang ../symbols/PictureMarkerSymbol ../Color ./Renderer".split(" "),
function(k,e,p,q,n,l,h,f,d,c){return k([c],{declaredClass:"esri.renderer.HeatmapRenderer",colors:null,blurRadius:10,maxPixelIntensity:100,minPixelIntensity:0,field:null,fieldOffset:null,colorStops:null,constructor:function(a){(this._supportsCanvas=window.CanvasRenderingContext2D?!0:!1)?("string"==typeof a&&(a=JSON.parse(a)),e.mixin(this,a),this._canvas=null,this.colors||this.colorStops||(this.colorStops=[{ratio:0,color:"rgba(255, 140, 0, 0)"},{ratio:.75,color:"rgba(255, 140, 0, 1)"},{ratio:.9,color:"rgba(255, 0,   0, 1)"}]),
this.gradient=this._generateGradient(this.colorStops||this.colors)):console.log("The HeatmapRenderer requires a Canvas enabled Browser.  IE8 and less does not support Canvas.")},getSymbol:function(a){if(!this._supportsCanvas)return!1;var b=a.attributes.imageData;a=a.attributes.size;if(!a)return null;var c=this._getContext(a[0],a[1]),d=c.getImageData(0,0,a[0],a[1]);window.ArrayBuffer&&b instanceof ArrayBuffer?b=window.Uint8ClampedArray?new Uint8ClampedArray(b):new Uint8Array(b):b.BYTES_PER_ELEMENT&&
1!==b.BYTES_PER_ELEMENT&&(b=window.Uint8ClampedArray?new Uint8ClampedArray(b.buffer):new Uint8Array(b.buffer));if(window.CanvasPixelArray&&d.data instanceof window.CanvasPixelArray)for(var m=d.data,r=m.length;r--;)m[r]=b[r];else d.data.set(b);c.putImageData(d,0,0);return new f(c.canvas.toDataURL(),a[0],a[1])},setColors:function(a){a&&(a instanceof Array||a.colors)&&(this.gradient=this._generateGradient(a.colors||a),this.colors=a);return this},setColorStops:function(a){a&&(a instanceof Array||a.colorStops)&&
(this.gradient=this._generateGradient(a.colorStops||a),this.colorStops=a);return this},setMaxPixelIntensity:function(a){this.maxPixelIntensity=a;return this},setMinPixelIntensity:function(a){this.minPixelIntensity=a;return this},setField:function(a){this.field=a;return this},setFieldOffset:function(a){this.fieldOffset=a;return this},setBlurRadius:function(a){this.blurRadius=a;return this},getStats:function(){},getHistogramData:function(){},toJson:function(){var a=e.mixin(this.inherited(arguments),
{type:"heatmap",blurRadius:this.blurRadius,colorStops:this._colorsToStops(this.colorStops||this.colors),maxPixelIntensity:this.maxPixelIntensity,minPixelIntensity:this.minPixelIntensity,field:this.field});null!=this.fieldOffset&&(a.fieldOffset=this.fieldOffset);p.forEach(a.colorStops,function(a){a.color=d.toJsonColor(a.color)});return h.fixJson(a)},_getContext:function(a,b){this._canvas?(this._canvas.width=a,this._canvas.height=b):this._canvas=this._initCanvas(a,b);return this._canvas.getContext("2d")},
_initCanvas:function(a,b){var c=q.create("canvas",{id:"hm_canvas-"+Math.floor(1E3*Math.random()),style:"position: absolute; left: 0px; top: -10000px;"},null);c.width=a;c.height=b;document.body.appendChild(c);return c},_generateGradient:function(a,b){b||(b=512);a=this._colorsToStops(a);for(var c=this._getContext(1,b||512),d=c.createLinearGradient(0,0,0,b),m=0,f;m<a.length;m++)f=a[m],d.addColorStop(f.ratio,f.color.toCss(!0));c.fillStyle=d;c.fillRect(0,0,1,b);return c.getImageData(0,0,1,b).data},_colorsToStops:function(a){var b=
[];if(!a[0])return b;if(null!=a[0].ratio)b=p.map(a,function(a){return{ratio:a.ratio,color:this._toColor(a.color)}},this);else if(null!=a[0].value){var c=Infinity,b=-Infinity,d=0,m;for(m=0;m<a.length;m++){var f=a[m].value;f<c&&(c=f);f>b&&(b=f)}d=b-c;this.maxPixelIntensity=b;this.minPixelIntensity=c;b=p.map(a,function(a){var b=a.value;a=this._toColor(a.color);return{value:b,ratio:(b-c)/d,color:a}},this)}else var h=a.length-1,b=p.map(a,function(a,b){return{color:this._toColor(a),ratio:b/h}},this);return b},
_toColor:function(a){a.toRgba||a.declaredClass||(a=new d(a));return a}})})},"esri/renderers/StretchRenderer":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/has ../kernel ../lang ../layers/RasterFunction ./colorRampUtils".split(" "),function(k,e,p,q,n,l,h,f){var d={TYPE_NONE:"none",TYPE_STANDARDDEVIATION:"standardDeviation",TYPE_HISTOGRAMEQUALIZATION:"histogramEqualization",TYPE_MINMAX:"minMax",TYPE_PERCENTCLIP:"percentClip",TYPE_SIGMOID:"sigmoid"};k=k(null,{declaredClass:"esri.renderer.StretchRenderer",
constructor:function(c){c=c||{};this.stretchType=d.TYPE_NONE;this.dra=!0;this.statistics=[];this.gamma=[];this.computeGamma=this.useGamma=!1;this.sigmoidStrengthLevel=this.numberOfStandardDeviations=this.minPercent=this.maxPercent=this.min=this.max=null;p.mixin(this,c);this.colorRamp=f.fromJson(c.colorRamp)},toJson:function(){var c={type:"rasterStretch",stretchType:this.stretchType,colorRamp:this.colorRamp&&this.colorRamp.toJson(),min:this.min,max:this.max,numberOfStandardDeviations:this.numberOfStandardDeviations,
statistics:p.clone(this.statistics),dra:this.dra,minPercent:this.minPercent,maxPercent:this.maxPercent,useGamma:this.useGamma,gamma:p.clone(this.gamma),computeGamma:this.computeGamma,sigmoidStrengthLevel:this.sigmoidStrengthLevel};return l.fixJson(c)},toRenderingRule:function(c){c=c||{};var a=new h;a.functionName="Stretch";var b=this._convertStretchTypeEnumToIndex(this.stretchType),d={StretchType:b,Statistics:this.statistics,DRA:this.dra,UseGamma:this.useGamma,Gamma:this.gamma,ComputeGamma:this.computeGamma};
l.isDefined(this.min)&&(d.Min=this.min);l.isDefined(this.min)&&(d.Max=this.max);3===b?(d.NumberOfStandardDeviations=this.numberOfStandardDeviations,a.outputPixelType="U8"):6===b?(d.MinPercent=parseFloat(this.minPercent),d.MaxPercent=parseFloat(this.maxPercent),a.outputPixelType="U8"):5===b?a.outputPixelType="U8":9===b&&(d.SigmoidStrengthLevel=this.sigmoidStrengthLevel);a.functionArguments=d;a.variableName="Raster";return this.colorRamp?(b=new h,d=f.getColorRampName(this.colorRamp),b.functionArguments=
d?{colorRamp:d}:c.convertToColormap?{Colormap:f.convertColorRampToColormap(this.colorRamp,256)}:{colorRamp:this.colorRamp.toJson()},b.variableName="Raster",b.functionName="Colormap",b.functionArguments.Raster=a,b):a},_convertStretchTypeEnumToIndex:function(c){var a=0;c===d.TYPE_STANDARDDEVIATION?a=3:c===d.TYPE_HISTOGRAMEQUALIZATION?a=4:c===d.TYPE_MINMAX?a=5:c===d.TYPE_PERCENTCLIP?a=6:c===d.TYPE_SIGMOID&&(a=9);return a},_convertStretchTypeIndexToEnum:function(c){var a=0;3===c?a=d.TYPE_STANDARDDEVIATION:
4===c?a=d.TYPE_HISTOGRAMEQUALIZATION:5===c?a=d.TYPE_MINMAX:6===c?a=d.TYPE_PERCENTCLIP:9===c&&(a=d.TYPE_SIGMOID);return a}});p.mixin(k,d);return k})},"esri/layers/RasterFunction":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel","../lang"],function(k,e,p,q,n){var l=k(null,{declaredClass:"esri.layers.RasterFunction",functionName:null,arguments:null,functionArguments:null,variableName:null,outputPixelType:null,constructor:function(h){if(e.isObject(h)){var f=0;this.functionName=
h.rasterFunction;this.functionArguments=e.clone(h.rasterFunctionArguments||h.arguments);e.mixin(this,h);if(h=this.functionArguments)if(h.Raster=this._toRasterFunction(h.Raster),h.Raster2=this._toRasterFunction(h.Raster2),h.DEM=this._toRasterFunction(h.DEM),h.FillRaster=this._toRasterFunction(h.FillRaster),h.Rasters&&h.Rasters.length)for(f=0;f<h.Rasters.length;f++)h.Rasters[f]=this._toRasterFunction(h.Rasters[f])}},_toRasterFunction:function(h){return h&&(h.rasterFunction||h.functionName)?new l(h):
h},_rfToJson:function(h){h&&"esri.layers.RasterFunction"===h.declaredClass&&(h=h.toJson());return h},toJson:function(){var h=e.clone(this.functionArguments||this.arguments);if(h&&(h.Raster=this._rfToJson(h.Raster),h.Raster2=this._rfToJson(h.Raster2),h.DEM=this._rfToJson(h.DEM),h.FillRaster=this._rfToJson(h.FillRaster),h.Rasters&&h.Rasters.length)){var f,d=[];for(f=0;f<h.Rasters.length;f++)d.push(this._rfToJson(h.Rasters[f]));h.Rasters=d}return n.filter({rasterFunction:this.functionName,rasterFunctionArguments:h,
variableName:this.variableName,outputPixelType:this.outputPixelType?this.outputPixelType:null},function(c){if(null!==c&&void 0!==c)return!0})}});return l})},"esri/renderers/colorRampUtils":function(){define("dojo/_base/lang dojo/_base/array dojo/store/Memory ../tasks/AlgorithmicColorRamp ../tasks/MultipartColorRamp ../Color ./colorUtils".split(" "),function(k,e,p,q,n,l,h){function f(a,b,d){if(a){b=b||g;d=d||u;var m=null,f=a.declaredClass,r,h;if((r="string"===typeof a?a:a.name)&&e.some(d,function(a){if(a.name===
r)return m=a.id,!0})&&m)return m;"esri.tasks.AlgorithmicColorRamp"===f?e.some(b,function(b){if(c(a.fromColor.toRgb(),b.fromColor)&&c(a.toColor.toRgb(),b.toColor))return m=b.id,!0},this):"esri.tasks.MultipartColorRamp"===f&&e.some(b,function(b){if(a.colorRamps&&b.colorRamps&&a.colorRamps.length===b.colorRamps.length&&(h=a.colorRamps,!e.some(b.colorRamps,function(a,b){if(!c(h[b].fromColor.toRgb(),a.fromColor)||!c(h[b].toColor.toRgb(),a.toColor))return!0},this))){if(m)return!0;m=b.id}},this);return m}}
function d(a){var b=new q,c=a.algorithm;b.fromColor=l.toDojoColor(a.fromColor);b.toColor=l.toDojoColor(a.toColor);"esriCIELabAlgorithm"===c?b.algorithm="cie-lab":"esriHSVAlgorithm"===c?b.algorithm="hsv":"esriLabLChAlgorithm"===c&&(b.algorithm="lab-lch");return b}function c(a,b){return a&&b&&a.length&&b.length&&a.length===b.length?!e.some(a,function(a,c){if(a>b[c]+2||a<b[c]-2)return!0}):!1}function a(a,b,c){a=h.toLAB(a);b=h.toLAB(b);return h.toRGB({l:a.l*(1-c)+c*b.l,a:a.a*(1-c)+c*b.a,b:a.b*(1-c)+c*
b.b})}var b={},g=[{id:"none",selected:!0},{id:"aspect_predefined",type:"multipart",colorRamps:[{fromColor:[190,190,190],toColor:[255,45,8]},{fromColor:[255,45,8],toColor:[255,181,61]},{fromColor:[255,181,61],toColor:[255,254,52]},{fromColor:[255,254,52],toColor:[0,251,50]},{fromColor:[0,251,50],toColor:[255,254,52]},{fromColor:[0,253,255],toColor:[0,181,255]},{fromColor:[0,181,255],toColor:[26,35,253]},{fromColor:[26,35,253],toColor:[255,57,251]},{fromColor:[255,57,251],toColor:[255,45,8]}]},{id:"blackToWhite_predefined",
fromColor:[0,0,0],toColor:[255,255,255]},{id:"blueBright_predefined",fromColor:[204,204,255],toColor:[0,0,224]},{id:"blueLightToDark_predefined",fromColor:[211,229,232],toColor:[46,100,140]},{id:"blueGreenBright_predefined",fromColor:[203,245,234],toColor:[48,207,146]},{id:"blueGreenLightToDark_predefined",fromColor:[216,242,237],toColor:[21,79,74]},{id:"brownLightToDark_predefined",fromColor:[240,236,170],toColor:[102,72,48]},{id:"brownToBlueGreenDivergingBright_predefined",type:"multipart",colorRamps:[{fromColor:[156,
85,31],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[33,130,145]}]},{id:"brownToBlueGreenDivergingDark_predefined",type:"multipart",colorRamps:[{fromColor:[110,70,45],toColor:[204,204,102]},{fromColor:[204,204,102],toColor:[48,100,102]}]},{id:"coefficientBias_predefined",fromColor:[214,214,255],toColor:[0,57,148]},{id:"coldToHotDiverging_predefined",type:"multipart",colorRamps:[{fromColor:[69,117,181],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[214,47,39]}]},{id:"conditionNumber_predefined",
type:"multipart",colorRamps:[{fromColor:[0,97,0],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[255,34,0]}]},{id:"cyanToPurple_predefined",type:"multipart",colorRamps:[{fromColor:[0,245,245],toColor:[0,0,245]},{fromColor:[0,0,245],toColor:[245,0,245]}]},{id:"cyanLightToBlueDark_predefined",type:"multipart",colorRamps:[{fromColor:[182,237,240],toColor:[31,131,224]},{fromColor:[31,131,224],toColor:[9,9,145]}]},{id:"distance_predefined",fromColor:[255,200,0],toColor:[0,0,255]},{id:"elevation1_predefined",
type:"multipart",colorRamps:[{fromColor:[175,240,233],toColor:[255,255,179]},{fromColor:[255,255,179],toColor:[0,128,64]},{fromColor:[0,128,64],toColor:[252,186,3]},{fromColor:[252,186,3],toColor:[128,0,0]},{fromColor:[120,0,0],toColor:[105,48,13]},{fromColor:[105,48,13],toColor:[171,171,171]},{fromColor:[171,171,171],toColor:[255,252,255]}]},{id:"elevation2_predefined",type:"multipart",colorRamps:[{fromColor:[118,219,211],toColor:[255,255,199]},{fromColor:[255,255,199],toColor:[255,255,128]},{fromColor:[255,
255,128],toColor:[217,194,121]},{fromColor:[217,194,121],toColor:[135,96,38]},{fromColor:[135,96,38],toColor:[150,150,181]},{fromColor:[150,150,181],toColor:[181,150,181]},{fromColor:[181,150,181],toColor:[255,252,255]}]},{id:"errors_predefined",fromColor:[255,235,214],toColor:[196,10,10]},{id:"grayLightToDark_predefined",fromColor:[219,219,219],toColor:[69,69,69]},{id:"greenBright_predefined",fromColor:[204,255,204],toColor:[14,204,14]},{id:"greenLightToDark_predefined",fromColor:[220,245,233],toColor:[34,
102,51]},{id:"greenToBlue_predefined",type:"multipart",colorRamps:[{fromColor:[32,204,16],toColor:[0,242,242]},{fromColor:[0,242,242],toColor:[2,33,227]}]},{id:"orangeBright_predefined",fromColor:[255,235,204],toColor:[240,118,5]},{id:"orangeLightToDark_predefined",fromColor:[250,233,212],toColor:[171,65,36]},{id:"partialSpectrum_predefined",type:"multipart",colorRamps:[{fromColor:[242,241,162],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[255,0,0]},{fromColor:[252,3,69],toColor:[176,7,237]},
{fromColor:[176,7,237],toColor:[2,29,173]}]},{id:"partialSpectrum1Diverging_predefined",type:"multipart",colorRamps:[{fromColor:[135,38,38],toColor:[240,149,12]},{fromColor:[240,149,12],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[74,80,181]},{fromColor:[74,80,181],toColor:[39,32,122]}]},{id:"partialSpectrum2Diverging_predefined",type:"multipart",colorRamps:[{fromColor:[115,77,42],toColor:[201,137,52]},{fromColor:[201,137,52],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[91,
63,176]},{fromColor:[91,63,176],toColor:[81,13,97]}]},{id:"pinkToYellowGreenDivergingBright_predefined",type:"multipart",colorRamps:[{fromColor:[158,30,113],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[99,110,45]}]},{id:"pinkToYellowGreenDivergingDark_predefined",type:"multipart",colorRamps:[{fromColor:[97,47,73],toColor:[204,204,102]},{fromColor:[204,204,102],toColor:[22,59,15]}]},{id:"precipitation_predefined",type:"multipart",colorRamps:[{fromColor:[194,82,60],toColor:[237,161,19]},
{fromColor:[237,161,19],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[0,219,0]},{fromColor:[0,219,0],toColor:[32,153,143]},{fromColor:[32,153,143],toColor:[11,44,122]}]},{id:"prediction_predefined",type:"multipart",colorRamps:[{fromColor:[40,146,199],toColor:[250,250,100]},{fromColor:[250,250,100],toColor:[232,16,20]}]},{id:"purpleBright_predefined",fromColor:[255,204,255],toColor:[199,0,199]},{id:"purpleToGreenDivergingBright_predefined",type:"multipart",colorRamps:[{fromColor:[77,32,150],
toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[20,122,11]}]},{id:"purpleToGreenDivergingDark_predefined",type:"multipart",colorRamps:[{fromColor:[67,14,89],toColor:[204,204,102]},{fromColor:[204,204,102],toColor:[24,79,15]}]},{id:"purpleBlueBright_predefined",fromColor:[223,184,230],toColor:[112,12,242]},{id:"purpleBlueLightToDark_predefined",fromColor:[229,213,242],toColor:[93,44,112]},{id:"purpleRedBright_predefined",fromColor:[255,204,225],toColor:[199,0,99]},{id:"purpleRedLightToDark_predefined",
fromColor:[250,215,246],toColor:[143,17,57]},{id:"redBright_predefined",fromColor:[255,204,204],toColor:[219,0,0]},{id:"redLightToDark_predefined",fromColor:[255,224,224],toColor:[143,10,10]},{id:"redToBlueDivergingBright_predefined",type:"multipart",colorRamps:[{fromColor:[196,69,57],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[48,95,207]}]},{id:"redToBlueDivergingDark_predefined",type:"multipart",colorRamps:[{fromColor:[107,13,13],toColor:[204,204,102]},{fromColor:[204,204,102],toColor:[13,
53,97]}]},{id:"redToGreen_predefined",type:"multipart",colorRamps:[{fromColor:[245,0,0],toColor:[245,245,0]},{fromColor:[245,245,0],toColor:[0,245,0]}]},{id:"redToGreenDivergingBright_predefined",type:"multipart",colorRamps:[{fromColor:[186,20,20],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[54,145,33]}]},{id:"redToGreenDivergingDark_predefined",type:"multipart",colorRamps:[{fromColor:[97,21,13],toColor:[204,204,102]},{fromColor:[204,204,102],toColor:[16,69,16]}]},{id:"slope_predefined",
type:"multipart",colorRamps:[{fromColor:[56,168,0],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[255,0,0]}]},{id:"spectrumFullBright_predefined",type:"multipart",colorRamps:[{fromColor:[255,0,0],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[0,255,255]},{fromColor:[0,255,255],toColor:[0,0,255]}]},{id:"spectrumFullDark_predefined",type:"multipart",colorRamps:[{fromColor:[153,0,0],toColor:[153,153,0]},{fromColor:[153,153,0],toColor:[0,153,153]},{fromColor:[0,153,153],toColor:[0,0,153]}]},
{id:"spectrumFullLight_predefined",type:"multipart",colorRamps:[{fromColor:[255,153,153],toColor:[255,255,153]},{fromColor:[255,255,153],toColor:[153,255,255]},{fromColor:[153,255,255],toColor:[153,153,255]}]},{id:"surface_predefined",type:"multipart",colorRamps:[{fromColor:[112,153,89],toColor:[242,238,162]},{fromColor:[242,238,162],toColor:[242,206,133]},{fromColor:[242,206,133],toColor:[194,140,124]},{fromColor:[194,140,124],toColor:[255,242,255]}]},{id:"temperature_predefined",type:"multipart",
colorRamps:[{fromColor:[255,252,255],toColor:[255,0,255]},{fromColor:[255,0,255],toColor:[0,0,255]},{fromColor:[0,0,255],toColor:[0,255,255]},{fromColor:[0,255,255],toColor:[0,255,0]},{fromColor:[0,255,0],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[255,128,0]},{fromColor:[255,128,0],toColor:[128,0,0]}]},{id:"whiteToBlack_predefined",fromColor:[255,255,255],toColor:[0,0,0]},{id:"yellowToDarkRed_predefined",type:"multipart",colorRamps:[{fromColor:[255,255,128],toColor:[242,167,46]},{fromColor:[242,
167,46],toColor:[107,0,0]}]},{id:"yellowToGreenToDarkBlue_predefined",type:"multipart",colorRamps:[{fromColor:[255,255,128],toColor:[56,224,9]},{fromColor:[56,224,9],toColor:[26,147,171]},{fromColor:[26,147,171],toColor:[12,16,120]}]},{id:"yellowToRed_predefined",fromColor:[245,245,0],toColor:[255,0,0]},{id:"yellowGreenBright_predefined",fromColor:[236,252,204],toColor:[157,204,16]},{id:"yellowGreenLightToDark_predefined",fromColor:[215,240,175],toColor:[96,107,45]}],u=[{name:"Aspect",id:"aspect_predefined"},
{name:"Black to White",id:"blackToWhite_predefined"},{name:"Blue Bright",id:"blueBright_predefined"},{name:"Blue Light to Dark",id:"blueLightToDark_predefined"},{name:"Blue-Green Bright",id:"blueGreenBright_predefined"},{name:"Blue-Green Light to Dark",id:"blueGreenLightToDark_predefined"},{name:"Brown Light to Dark",id:"brownLightToDark_predefined"},{name:"Brown to Blue Green Diverging, Bright",id:"brownToBlueGreenDivergingBright_predefined"},{name:"Brown to Blue Green Diverging, Dark",id:"brownToBlueGreenDivergingDark_predefined"},
{name:"Coefficient Bias",id:"coefficientBias_predefined"},{name:"Cold to Hot Diverging",id:"coldToHotDiverging_predefined"},{name:"Condition Number",id:"conditionNumber_predefined"},{name:"Cyan to Purple",id:"cyanToPurple_predefined"},{name:"Cyan-Light to Blue-Dark",id:"cyanLightToBlueDark_predefined"},{name:"Distance",id:"distance_predefined"},{id:"elevation1_predefined",name:"Elevation #1"},{id:"elevation2_predefined",name:"Elevation #2"},{id:"errors_predefined",name:"Errors"},{id:"grayLightToDark_predefined",
name:"Gray Light to Dark"},{id:"greenBright_predefined",name:"Green Bright"},{id:"greenLightToDark_predefined",name:"Green Light to Dark"},{name:"Green to Blue",id:"greenToBlue_predefined"},{name:"Orange Bright",id:"orangeBright_predefined"},{name:"Orange Light to Dark",id:"orangeLightToDark_predefined"},{id:"partialSpectrum_predefined",name:"Partial Spectrum"},{id:"partialSpectrum1Diverging_predefined",name:"Partial Spectrum 1 Diverging",type:"multipart"},{id:"partialSpectrum2Diverging_predefined",
name:"Partial Spectrum 2 Diverging"},{name:"Pink to YellowGreen Diverging, Bright",id:"pinkToYellowGreenDivergingBright_predefined"},{name:"Pink to YellowGreen Diverging, Dark",id:"pinkToYellowGreenDivergingDark_predefined"},{id:"precipitation_predefined",name:"Precipitation"},{id:"prediction_predefined",name:"Prediction"},{name:"Purple Bright",id:"purpleBright_predefined"},{id:"purpleToGreenDivergingBright_predefined",name:"Purple to Green Diverging, Bright"},{id:"purpleToGreenDivergingDark_predefined",
name:"Purple to Green Diverging, Dark"},{name:"Purple-Blue Bright",id:"purpleBlueBright_predefined"},{name:"Purple-Blue Light to Dark",id:"purpleBlueLightToDark_predefined"},{name:"Purple-Red Bright",id:"purpleRedBright_predefined"},{name:"Purple-Red Light to Dark",id:"purpleRedLightToDark_predefined"},{name:"Red Bright",id:"redBright_predefined"},{name:"Red Light to Dark",id:"redLightToDark_predefined"},{id:"redToBlueDivergingBright_predefined",name:"Red to Blue Diverging, Bright"},{id:"redToBlueDivergingDark_predefined",
name:"Red to Blue Diverging, Dark"},{id:"redToGreen_predefined",name:"Red to Green"},{id:"redToGreenDivergingBright_predefined",name:"Red to Green Diverging, Bright"},{id:"redToGreenDivergingDark_predefined",name:"Red to Green Diverging, Dark"},{name:"Slope",id:"slope_predefined"},{id:"spectrumFullBright_predefined",name:"Spectrum-Full Bright"},{id:"spectrumFullDark_predefined",name:"Spectrum-Full Dark"},{id:"spectrumFullLight_predefined",name:"Spectrum-Full Light"},{id:"surface_predefined",name:"Surface"},
{id:"temperature_predefined",name:"Temperature"},{name:"White to Black",id:"whiteToBlack_predefined"},{id:"yellowToDarkRed_predefined",name:"Yellow to Dark Red"},{id:"yellowToGreenToDarkBlue_predefined",name:"Yellow to Green to Dark Blue"},{name:"Yellow to Red",id:"yellowToRed_predefined"},{name:"Yellow-Green Bright",id:"yellowGreenBright_predefined"},{name:"Yellow-Green Light to Dark",id:"yellowGreenLightToDark_predefined"}],m=new p({data:u});k.mixin(b,{predefinedColorRamps:g,predefinedColorRampNameMap:u,
getColorRampName:function(a){return(a=f(a))?(a=m.query({id:a}),a[0]?a[0].name:null):null},fromJson:function(a){var b=null;if(!a)return b;"multipart"===a.type?(b=new n,b.colorRamps=e.map(a.colorRamps,function(a){return d(a)},this)):"algorithmic"===a.type&&(b=d(a));return b},colorsEqual:c,getColorRampId:f,convertColorRampToColormap:function(b,c){if(b&&c){for(var d=b.colorRamps?b.colorRamps.length:1,g=[],m=[],f,r,t,l,n,u=0,k=0,u=0;u<d;u++)g[u]={},g[u].start=k,g[u].end=k+1/d,k=g[u].end;for(u=0;u<c;u++)l=
(u+.5)/c,e.forEach(g,function(c,d){l>=c.start&&l<c.end&&(n=(l-c.start)/(c.end-c.start),1<g.length?(f=h.getDojoColor(b.colorRamps[d].fromColor),r=h.getDojoColor(b.colorRamps[d].toColor)):(f=h.getDojoColor(b.fromColor),r=h.getDojoColor(b.toColor)),t=a(f,r,n),m.push([u,t.r,t.g,t.b]))},this);return m}},interpolateLabColor:a});return b})},"dojo/store/Memory":function(){define(["../_base/declare","./util/QueryResults","./util/SimpleQueryEngine"],function(k,e,p){return k("dojo.store.Memory",null,{constructor:function(e){for(var n in e)this[n]=
e[n];this.setData(this.data||[])},data:null,idProperty:"id",index:null,queryEngine:p,get:function(e){return this.data[this.index[e]]},getIdentity:function(e){return e[this.idProperty]},put:function(e,n){var l=this.data,h=this.index,f=this.idProperty,f=e[f]=n&&"id"in n?n.id:f in e?e[f]:Math.random();if(f in h){if(n&&!1===n.overwrite)throw Error("Object already exists");l[h[f]]=e}else h[f]=l.push(e)-1;return f},add:function(e,n){(n=n||{}).overwrite=!1;return this.put(e,n)},remove:function(e){var n=
this.index,l=this.data;if(e in n)return l.splice(n[e],1),this.setData(l),!0},query:function(k,n){return e(this.queryEngine(k,n)(this.data))},setData:function(e){e.items?(this.idProperty=e.identifier||this.idProperty,e=this.data=e.items):this.data=e;this.index={};for(var n=0,l=e.length;n<l;n++)this.index[e[n][this.idProperty]]=n}})})},"dojo/store/util/QueryResults":function(){define(["../../_base/array","../../_base/lang","../../when"],function(k,e,p){var q=function(n){function l(f){n[f]=function(){var d=
arguments,c=p(n,function(a){Array.prototype.unshift.call(d,a);return q(k[f].apply(k,d))});if("forEach"!==f||h)return c}}if(!n)return n;var h=!!n.then;h&&(n=e.delegate(n));l("forEach");l("filter");l("map");null==n.total&&(n.total=p(n,function(f){return f.length}));return n};e.setObject("dojo.store.util.QueryResults",q);return q})},"dojo/store/util/SimpleQueryEngine":function(){define(["../../_base/array"],function(k){return function(e,p){function q(l){l=k.filter(l,e);var h=p&&p.sort;h&&l.sort("function"==
typeof h?h:function(d,c){for(var a,b=0;a=h[b];b++){var g=d[a.attribute],f=c[a.attribute],g=null!=g?g.valueOf():g,f=null!=f?f.valueOf():f;if(g!=f)return!!a.descending==(null==g||g>f)?-1:1}return 0});if(p&&(p.start||p.count)){var f=l.length;l=l.slice(p.start||0,(p.start||0)+(p.count||Infinity));l.total=f}return l}switch(typeof e){default:throw Error("Can not query with a "+typeof e);case "object":case "undefined":var n=e;e=function(l){for(var h in n){var f=n[h];if(f&&f.test){if(!f.test(l[h],l))return!1}else if(f!=
l[h])return!1}return!0};break;case "string":if(!this[e])throw Error("No filter function "+e+" was found in store");e=this[e];case "function":}q.matches=e;return q}})},"esri/tasks/AlgorithmicColorRamp":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../Color ./ColorRamp".split(" "),function(k,e,p,q,n,l){return k(l,{declaredClass:"esri.tasks.AlgorithmicColorRamp",type:"algorithmic",fromColor:null,toColor:null,algorithm:null,toJson:function(){var h;switch(this.algorithm&&this.algorithm.toLowerCase()){case "cie-lab":h=
"esriCIELabAlgorithm";break;case "hsv":h="esriHSVAlgorithm";break;case "lab-lch":h="esriLabLChAlgorithm"}h={type:"algorithmic",algorithm:h};h.fromColor=n.toJsonColor(this.fromColor);h.toColor=n.toJsonColor(this.toColor);return h}})})},"esri/tasks/ColorRamp":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel"],function(k,e,p,q){return k(null,{declaredClass:"esri.tasks.ColorRamp",type:null})})},"esri/tasks/MultipartColorRamp":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has ../kernel ../symbols/Symbol ./ColorRamp".split(" "),
function(k,e,p,q,n,l){return k(l,{declaredClass:"esri.tasks.MultipartColorRamp",type:"multipart",constructor:function(){this.colorRamps=[]},addColorRamp:function(h){this.colorRamps.push(h)},toJson:function(){return{type:"multipart",colorRamps:p.map(this.colorRamps,function(h){return h.toJson()})}}})})},"esri/renderers/colorUtils":function(){define(["dojo/_base/Color","dojo/_base/array"],function(k,e){var p={COEF_RGB2XYZ:[[.4124,.3576,.1805],[.2126,.7152,.0722],[.0193,.1192,.9505]],COEF_XYZ2RGB:[[3.2406,
-1.5372,-.4986],[-.9689,1.8758,.0415],[.0557,-.204,1.057]],matrixProduct:function(e,l){var h=[],f,d;if(e[0].length!==l.length)throw"dimensions do not match";var c=e.length,a=e[0].length,b=0;for(f=0;f<c;f++){for(d=b=0;d<a;d++)b+=e[f][d]*l[d];h.push(b)}return h},rgb2xyz:function(e){e=[e.r/255,e.g/255,e.b/255].map(function(e){return.04045>=e?e/12.92:Math.pow((e+.055)/1.055,2.4)});e=this.matrixProduct(this.COEF_RGB2XYZ,e);return{x:100*e[0],y:100*e[1],z:100*e[2]}},xyz2rgb:function(e){e=this.matrixProduct(this.COEF_XYZ2RGB,
[e.x/100,e.y/100,e.z/100]).map(function(e){return Math.min(1,Math.max(.0031308>=e?12.92*e:1.055*Math.pow(e,1/2.4)-.055,0))});return{r:Math.round(255*e[0]),g:Math.round(255*e[1]),b:Math.round(255*e[2])}},xyz2lab:function(e){e=[e.x/95.047,e.y/100,e.z/108.883].map(function(e){return e>Math.pow(6/29,3)?Math.pow(e,1/3):1/3*Math.pow(29/6,2)*e+4/29});return{l:116*e[1]-16,a:500*(e[0]-e[1]),b:200*(e[1]-e[2])}},lab2xyz:function(e){var l=e.l;e=[(l+16)/116+e.a/500,(l+16)/116,(l+16)/116-e.b/200].map(function(h){return h>
6/29?Math.pow(h,3):3*Math.pow(6/29,2)*(h-4/29)});return{x:95.047*e[0],y:100*e[1],z:108.883*e[2]}},lab2lch:function(e){var l=e.l,h=e.a,f=e.b;e=Math.sqrt(h*h+f*f);h=Math.atan2(f,h);h=0<h?h:h+2*Math.PI;return{l:l,c:e,h:h}},lch2lab:function(e){var l=e.c,h=e.h;return{l:e.l,a:l*Math.cos(h),b:l*Math.sin(h)}},rgb2lab:function(e){return this.xyz2lab(this.rgb2xyz(e))},lab2rgb:function(e){return this.xyz2rgb(this.lab2xyz(e))},rgb2lch:function(e){return this.lab2lch(this.xyz2lab(this.rgb2xyz(e)))},lch2rgb:function(e){return this.xyz2rgb(this.lab2xyz(this.lch2lab(e)))}},
q={rgb2hsv:function(e){var l=e.r,h=e.g;e=e.b;var f=Math.max(l,h,e),d=f-Math.min(l,h,e),c;0===d?c=0:f===l?c=(h-e)/d%6:f===h?c=(e-l)/d+2:f===e&&(c=(l-h)/d+4);0>c&&(c+=6);return{h:60*c,s:100*(0===d?0:d/f),v:100/255*f}},hsv2rgb:function(e){var l=(e.h+360)%360/60,h=e.v/100*255;e=e.s/100*h;var f=e*(1-Math.abs(l%2-1));switch(Math.floor(l)){case 0:l={r:e,g:f,b:0};break;case 1:l={r:f,g:e,b:0};break;case 2:l={r:0,g:e,b:f};break;case 3:l={r:0,g:f,b:e};break;case 4:l={r:f,g:0,b:e};break;case 5:case 6:l={r:e,
g:0,b:f};break;default:l={r:0,g:0,b:0}}l.r=Math.round(l.r+h-e);l.g=Math.round(l.g+h-e);l.b=Math.round(l.b+h-e);return l}};return{toRGB:function(e){var l;void 0!==e.r&&void 0!==e.g&&void 0!==e.b?l=e:void 0!==e.l&&void 0!==e.c&&void 0!==e.h?l=p.lch2rgb(e):void 0!==e.l&&void 0!==e.a&&void 0!==e.b?l=p.lab2rgb(e):void 0!==e.x&&void 0!==e.y&&void 0!==e.z?l=p.xyz2rgb(e):void 0!==e.h&&void 0!==e.s&&void 0!==e.v&&(l=q.hsv2rgb(e));return l},toHSV:function(e){if(void 0!==e.h&&void 0!==e.s&&void 0!==e.v)return e;
e=this.toRGB(e);return q.rgb2hsv(e)},toLAB:function(e){return void 0!==e.l&&void 0!==e.a&&void 0!==e.b?e:p.rgb2lab(this.toRGB(e))},toLCH:function(e){return void 0!==e.l&&void 0!==e.c&&void 0!==e.h?e:p.rgb2lch(this.toRGB(e))},toXYZ:function(e){return void 0!==e.x&&void 0!==e.y&&void 0!==e.z?e:p.rgb2xyz(this.toRGB(e))},getDojoColor:function(e){if(e){if(Array.isArray(e))return k.fromArray(e);if(void 0!==e.r&&void 0!==e.g&&void 0!==e.b)return e}},correctRGBLimits:function(n){var l=[n.r,n.g,n.b];e.forEach(l,
function(h,f){0>l[f]?l[f]=0:255<l[f]&&(l[f]=255);l[f]=Math.floor(l[f])});return{r:l[0],g:l[1],b:l[2],a:1}}}})},"esri/dijit/PopupTemplate":function(){define("dojo/_base/declare dojo/_base/lang dojo/has dojo/dom-construct ../kernel ../InfoTemplate ../PopupInfo ./PopupRenderer".split(" "),function(k,e,p,q,n,l,h,f){return k([l,h],{declaredClass:"esri.dijit.PopupTemplate","-chains-":{constructor:"manual"},chartTheme:null,constructor:function(d,c){e.mixin(this,c);this.initialize(d,c)},getTitle:function(d){var c;
this.info&&(c=this.titleHasRelatedFields?"":this._getPopupValues(d,null,!0).title);return c||""},getContent:function(d){return this.info?(new f({template:this,graphic:d,chartTheme:this.chartTheme},q.create("div"))).domNode:""}})})},"esri/PopupInfo":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/json dojo/i18n dojo/has dojo/Deferred dojo/sniff dojo/promise/all dojox/html/entities ./lang ./kernel ./request ./promiseList ./tasks/query ./tasks/QueryTask ./tasks/RelationshipQuery ./tasks/StatisticDefinition ./support/expressionUtils ./layers/support/attributeUtils dojo/i18n!dojo/cldr/nls/number".split(" "),
function(k,e,p,q,n,l,h,f,d,c,a,b,g,u,m,r,t,v,y,w,z){return k(null,{declaredClass:"esri.PopupInfo",_reExprField:/^\s*expression\//i,_exprPrefix:"expression/",_relatedFieldPrefix:"relationships/",initialize:function(a,b){if(a){e.mixin(this,b);this.info=a;this.title=this.getTitle;this.content=this.getContent;this._exprCache=this._compileExpressions(this.info.expressionInfos);var c=this._fieldLabels={},d=this._fieldsMap={};this.info.fieldInfos&&p.forEach(this.info.fieldInfos,function(a){var b=a.fieldName.toLowerCase(),
g=this._isExpressionField(b)?this.getExpressionInfo(b):null;c[b]=g?g.title:a.label;d[b]=a},this);this.titleHasRelatedFields=!(!this.info.title||-1===this.info.title.indexOf("{"+this._relatedFieldPrefix))}},toJson:function(){return q.fromJson(q.toJson(this.info))},getTitle:function(){},getContent:function(){},getFieldInfo:function(a){var b;p.some(this.info&&this.info.fieldInfos,function(c){c.fieldName===a&&(b=c);return!!b});return b},getExpressionInfo:function(a){if(this._isExpressionField(a)){a=a.replace(this._reExprField,
"");a=a.toLowerCase();var b;p.some(this.info.expressionInfos,function(c){c.name.toLowerCase()===a&&(b=c);return!!b});return b}},hasGeometryOperations:function(){return p.some(this.info.expressionInfos,function(a){return y.hasGeometryOperations(a.expression)})},getComponents:function(a){var b=this.info,c={};b.fieldInfos&&(b=p.filter(b.fieldInfos,function(a){return-1!==a.fieldName.indexOf(this._relatedFieldPrefix)},this))&&0<b.length&&(c.relatedInfo=this._getRelatedRecords({graphic:a,fieldsInfo:b}));
this._needFullResolutionFeature(a)&&(c.fullResolutionFeature=this._getFullResolutionFeature(a));return u(c).then(e.hitch(this,function(b){return this._getPopupValues(a,b.fullResolutionFeature)}))},getAttachments:function(a){var b=a.getSourceLayer();a=a.attributes;if(this.info.showAttachments&&b&&b.hasAttachments&&b.objectIdField&&(a=a&&a[b.objectIdField]))return b.queryAttachmentInfos(a)},_needFullResolutionFeature:function(a){return(a=a.getSourceLayer())?"esriGeometryPoint"!==a.geometryType&&"function"===
typeof a.getMaxAllowableOffset&&0<a.getMaxAllowableOffset()&&this.hasGeometryOperations():!1},_getFullResolutionFeature:function(a){var b=a.getSourceLayer(),c=b.objectIdField;a=(a=a.attributes)&&c&&a[c];if(null==a)return null;var d=new m;d.objectIds=[a];d.maxAllowableOffset=0;d.outFields=[c];return b.queryFeatures(d).then(function(a){return a.features&&a.features[0]})},_isExpressionField:function(a){return this._reExprField.test(a)},_compileExpressions:function(a){var b={};p.forEach(a,function(a){var c=
a.returnType&&a.returnType.toLowerCase();b[a.name]=w.createAttributeCache({valueExpression:a.expression},"number"!==c)});return b},_fetchAttributes:function(a,b){var d=e.clone(a.attributes)||{},g=b&&b.geometry,m=this._exprPrefix,f=this._exprCache;p.forEach(this.info.expressionInfos,function(b){var h=m+b.name;b=(b=f[b.name])?a._getDataValue(b.attributeInfo,b,y,null,g):null;"string"===typeof b&&(b=c.encode(b));d[h]=b});return d},_getPopupValues:function(b,c,d){var g=this.info,m=b.getSourceLayer(),f=
this._fetchAttributes(b,c),h=e.clone(f);c=g.fieldInfos;var r="",t="",l,n,u,k,w,v=m&&m._getDateOpts&&m._getDateOpts().properties,v=v&&v.slice(0),z={dateFormat:{properties:v,formatter:"DateFormat"+this._insertOffset(this._dateFormats.shortDateShortTime)}};if(this._relatedInfo)for(k in this._relatedInfo)if(this._relatedInfo.hasOwnProperty(k)){var q=this._relatedInfo[k],y=this._relatedLayersInfo[k];q&&(p.forEach(q.relatedFeatures,function(a){for(w in a.attributes)if(a.attributes.hasOwnProperty(w)&&"esriRelCardinalityOneToOne"===
y.relation.cardinality){var b=this._toRelatedFieldName([y.relation.id,w]);f[b]=h[b]=a.attributes[w]}},this),p.forEach(q.relatedStatsFeatures,function(a){for(w in a.attributes)if(a.attributes.hasOwnProperty(w)){var b=this._toRelatedFieldName([y.relation.id,w]);f[b]=h[b]=a.attributes[w]}},this))}c&&p.forEach(c,function(a){n=a.fieldName;var b=this._getLayerFieldInfo(m,n);b&&(n=a.fieldName=b.name);h[n]=this._formatValue(h[n],n,z);v&&a.format&&a.format.dateFormat&&(a=p.indexOf(v,n),-1<a&&v.splice(a,1))},
this);if(m){k=m.types;var x=(q=m.typeIdField)&&f[q];for(n in f)if(f.hasOwnProperty(n)&&-1===n.indexOf(this._relatedFieldPrefix)&&(u=f[n],a.isDefined(u))){var C=this._getDomainName(m,b,k,x,n,u);a.isDefined(C)?h[n]=C:n===q&&(C=this._getTypeName(m,b,u),a.isDefined(C)&&(h[n]=C))}}g.title&&(r=this._processFieldsInLinks(this._fixTokens(g.title,m),f),r=e.trim(a.substitute(h,r,z)||""));if(d)return{title:r};g.description&&(t=this._processFieldsInLinks(this._fixTokens(g.description,m),f),t=e.trim(a.substitute(h,
t,z)||""));c&&(l=[],p.forEach(c,function(b){(n=b.fieldName)&&b.visible&&l.push([this._fieldLabels[n.toLowerCase()]||n,a.substitute(h,"${"+n+"}",z)||""])},this));var A,fa;g.mediaInfos&&(A=[],p.forEach(g.mediaInfos,function(b){fa=0;u=b.value;switch(b.type){case "image":var c=u.sourceURL,c=c&&e.trim(a.substitute(f,this._fixTokens(c,m)));fa=!!c;break;case "piechart":case "linechart":case "columnchart":case "barchart":var d,c=u.normalizeField;u.fields=p.map(u.fields,function(a){return(d=this._getLayerFieldInfo(m,
a))?d.name:a},this);c&&(d=this._getLayerFieldInfo(m,c),u.normalizeField=d?d.name:c);fa=p.some(u.fields,function(b){return a.isDefined(f[b])||-1!==b.indexOf(this._relatedFieldPrefix)&&this._relatedInfo},this);break;default:return}if(fa){b=e.clone(b);u=b.value;var c=b.title?this._processFieldsInLinks(this._fixTokens(b.title,m),f):"",g=b.caption?this._processFieldsInLinks(this._fixTokens(b.caption,m),f):"";b.title=c?e.trim(a.substitute(h,c,z)||""):"";b.caption=g?e.trim(a.substitute(h,g,z)||""):"";if("image"===
b.type)u.sourceURL=a.substitute(f,this._fixTokens(u.sourceURL,m)),u.linkURL&&(u.linkURL=e.trim(a.substitute(f,this._fixTokens(u.linkURL,m))||""));else{var r,t;p.forEach(u.fields,function(a,b){if(-1!==a.indexOf(this._relatedFieldPrefix))t=this._getRelatedChartInfos(a,u,f,z),t instanceof Array?u.fields=t:u.fields[b]=t;else{var c=f[a],c=void 0===c?null:c;r=f[u.normalizeField]||0;c&&r&&(c/=r);u.fields[b]={y:c,tooltip:(this._fieldLabels[a.toLowerCase()]||a)+":\x3cbr/\x3e"+this._formatValue(c,a,z,!!r)}}},
this)}A.push(b)}},this));return{title:r,description:t,hasDescription:!!g.description,fields:l&&l.length?l:null,mediaInfos:A&&A.length?A:null,formatted:h,editSummary:m&&m.getEditSummary?m.getEditSummary(b):""}},_getRelatedChartInfos:function(b,c,d,g){var m,f,h,r,e,t;m=[];t=this._fromRelatedFieldName(b);e=t[0];f=this._relatedInfo[e];e=this._relatedLayersInfo[e];f&&p.forEach(f.relatedFeatures,function(f){f=f.attributes;var e,l;for(l in f)if(f.hasOwnProperty(l)&&l===t[1]){e={};r=f[l];c.normalizeField&&
(h=-1!==c.normalizeField.indexOf(this._relatedFieldPrefix)?f[this._fromRelatedFieldName(c.normalizeField)[1]]:d[c.normalizeField]);r&&h&&(r/=h);if(c.tooltipField)if(-1!==c.tooltipField.indexOf(this._relatedFieldPrefix)){var n=this._fromRelatedFieldName(c.tooltipField)[1],u=a.isDefined(f[n])?f[n]:n;e.tooltip=u+":\x3cbr/\x3e"+this._formatValue(r,n,g,!!h)}else e.tooltip=(this._fieldLabels[b.toLowerCase()]||b)+":\x3cbr/\x3e"+this._formatValue(r,c.tooltipField,g,!!h);else e.tooltip=r;e.y=r;m.push(e)}},
this);return"esriRelCardinalityOneToMany"===e.relation.cardinality||"esriRelCardinalityManyToMany"===e.relation.cardinality?m:m[0]},_dateFormats:{shortDate:"(datePattern: 'M/d/y', selector: 'date')",shortDateLE:"(datePattern: 'd/M/y', selector: 'date')",longMonthDayYear:"(datePattern: 'MMMM d, y', selector: 'date')",dayShortMonthYear:"(datePattern: 'd MMM y', selector: 'date')",longDate:"(datePattern: 'EEEE, MMMM d, y', selector: 'date')",shortDateShortTime:"(datePattern: 'M/d/y', timePattern: 'h:mm a', selector: 'date and time')",
shortDateLEShortTime:"(datePattern: 'd/M/y', timePattern: 'h:mm a', selector: 'date and time')",shortDateShortTime24:"(datePattern: 'M/d/y', timePattern: 'H:mm', selector: 'date and time')",shortDateLEShortTime24:"(datePattern: 'd/M/y', timePattern: 'H:mm', selector: 'date and time')",shortDateLongTime:"(datePattern: 'M/d/y', timePattern: 'h:mm:ss a', selector: 'date and time')",shortDateLELongTime:"(datePattern: 'd/M/y', timePattern: 'h:mm:ss a', selector: 'date and time')",shortDateLongTime24:"(datePattern: 'M/d/y', timePattern: 'H:mm:ss', selector: 'date and time')",
shortDateLELongTime24:"(datePattern: 'd/M/y', timePattern: 'H:mm:ss', selector: 'date and time')",longMonthYear:"(datePattern: 'MMMM y', selector: 'date')",shortMonthYear:"(datePattern: 'MMM y', selector: 'date')",year:"(datePattern: 'y', selector: 'date')"},_reHref:/href\s*=\s*\"([^\"]+)\"/ig,_reHrefApos:/href\s*=\s*\'([^\']+)\'/ig,_reEmptyHref:/^href\s*=\s*"\s*"$/i,_reEmptyHrefApos:/^href\s*=\s*'\s*'$/i,_fixTokens:function(a,b){var c=this;return a.replace(/(\{([^\{\r\n]+)\})/g,function(a,d,g){a=
c._getLayerFieldInfo(b,g);return"$"+(a?"{"+a.name+"}":d)})},_encodeAttributes:function(a){a=e.clone(a)||{};var b,c;for(b in a)(c=a[b])&&"string"===typeof c&&(c=encodeURIComponent(c).replace(/\'/g,"\x26apos;"),a[b]=c);return a},_processFieldsInLinks:function(a,b){var c=this._encodeAttributes(b);b=e.hitch(this,this._addValuesToHref,b,c);a&&(a=a.replace(this._reHref,b).replace(this._reHrefApos,b));return a},_addValuesToHref:function(b,c,d,g){g=g&&e.trim(g);d=a.substitute(g&&0===g.indexOf("${")?b:c,d);
this._reEmptyHref.test(d)?d='href\x3d"about:blank"':this._reEmptyHrefApos.test(d)&&(d="href\x3d'about:blank'");return d},_getLayerFieldInfo:function(a,b){return a&&a.getField?a.getField(b):null},_formatValue:function(b,c,d,g){var m=this._fieldsMap[c.toLowerCase()],f=m&&m.format;c=-1!==p.indexOf(d.dateFormat.properties,c);var h="number"===typeof b&&!c&&(!f||!f.dateFormat);if(!a.isDefined(b)||!m||!a.isDefined(f))return h?this._forceLTR(b):b;var r="",m=[],t=f.hasOwnProperty("places")||f.hasOwnProperty("digitSeparator"),
l=f.hasOwnProperty("digitSeparator")?f.digitSeparator:!0;if(t&&!c)r="NumberFormat",m.push("places: "+(a.isDefined(f.places)&&(!g||0<f.places)?Number(f.places):"Infinity")),m.length&&(r+="("+m.join(",")+")");else if(f.dateFormat)r="DateFormat"+this._insertOffset(this._dateFormats[f.dateFormat]||this._dateFormats.shortDateShortTime);else return h?this._forceLTR(b):b;var n=this._applyFormatting(b,r,d);t&&-1<b.constructor.toString().indexOf("Array")&&(n="",p.forEach(b,e.hitch(this,function(a,b){b&&(n+=
" ");n+=this._applyFormatting(a,r,d)})));t&&!l&&z.group&&(n=n.replace(new RegExp("\\"+z.group,"g"),""));c&&(n='\x3cspan class\x3d"esriDateValue"\x3e'+n+"\x3c/span\x3e");return h?this._forceLTR(n):n},_applyFormatting:function(b,c,d){return a.substitute({myKey:b},"${myKey:"+c+"}",d)||""},_forceLTR:function(a){var b=f("ie");return b&&10>=b?a:"\x3cspan class\x3d'esriNumericValue'\x3e"+a+"\x3c/span\x3e"},_insertOffset:function(b){b&&(b=a.isDefined(this.utcOffset)?b.replace(/\)\s*$/,", utcOffset:"+this.utcOffset+
")"):b);return b},_getDomainName:function(a,b,c,d,g,m){return(a=a.getDomain&&a.getDomain(g,{feature:b}))&&a.codedValues?a.getName(m):null},_getTypeName:function(a,b,c){return(a=a.getType&&a.getType(b))&&a.name},_getRelatedRecords:function(a){var b=a.graphic,c;this._relatedLayersInfoPromise||(this._relatedLayersInfoPromise=this._getRelatedLayersInfo(a).then(e.hitch(this,function(a){for(c in a)a.hasOwnProperty(c)&&a[c]&&(this._relatedLayersInfo[c].relatedLayerInfo=a[c])})));return this._relatedLayersInfoPromise.then(e.hitch(this,
function(){return this._queryRelatedLayers(b)})).then(e.hitch(this,function(a){this._setRelatedRecords(b,a);return a}))},_getRelatedLayersInfo:function(a){var b=a.fieldsInfo,c,m,f={};c=a.graphic.getSourceLayer();this._relatedLayersInfo||(this._relatedLayersInfo={});p.forEach(b,function(a){var b,d,g,m;b=this._fromRelatedFieldName(a.fieldName);d=b[0];b=b[1];d&&(!this._relatedLayersInfo[d]&&c&&c.relationships&&(p.some(c.relationships,function(a){if(a.id==d)return m=a,!0}),m&&(this._relatedLayersInfo[d]=
{relation:m,relatedFields:[],outStatistics:[]})),this._relatedLayersInfo[d]&&(this._relatedLayersInfo[d].relatedFields.push(b),a.statisticType&&(g=new v,g.statisticType=a.statisticType,g.onStatisticField=b,g.outStatisticFieldName=b,this._relatedLayersInfo[d].outStatistics.push(g))))},this);for(m in this._relatedLayersInfo)this._relatedLayersInfo.hasOwnProperty(m)&&this._relatedLayersInfo[m]&&(a=this._relatedLayersInfo[m].relation,a=c.url.replace(/[0-9]+$/,a.relatedTableId),this._relatedLayersInfo[m].relatedLayerUrl=
a,f[m]=g({url:a,content:{f:"json"},callbackParamName:"callback"}));return d(f)},_queryRelatedLayers:function(a){var b={},c;for(c in this._relatedLayersInfo)this._relatedLayersInfo.hasOwnProperty(c)&&(b[c]=this._queryRelatedLayer({graphic:a,relatedInfo:this._relatedLayersInfo[c]}));return d(b)},_queryRelatedLayer:function(a){var b,c,g,f,t,l,n,u,k,w,v,z,q;b=a.graphic;c=b.getSourceLayer();g=c.url.match(/[0-9]+$/g)[0];v=a.relatedInfo;w=v.relatedLayerInfo;z=v.relatedLayerUrl;a=v.relation;p.some(w.relationships,
function(a){if(a.relatedTableId===parseInt(g,10))return f=a,!0},this);f&&(t=new m,p.some(w.fields,function(a){if(a.name===f.keyField)return u=-1!==p.indexOf(["esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble"],a.type)?"number":"string",!0}),f.relationshipTableId&&f.keyFieldInRelationshipTable?(q=new h,this._queryRelatedRecords(b,f).then(e.hitch(this,function(a){var d;(d=a[b.attributes[c.objectIdField]])?(a=p.map(d.features,function(a){return a.attributes[w.objectIdField]},
this),v.outStatistics&&0<v.outStatistics.length&&w.supportsStatistics&&(k=new m,k.objectIds=a,k.outFields=t.outFields,k.outStatistics=v.outStatistics),k&&(l=new r(z),l.execute(k).then(e.hitch(this,function(a){var b=[];b.push(d);b.push(a);q.resolve(b)})))):q.resolve()}))):(n="string"===u?f.keyField+"\x3d'"+b.attributes[a.keyField]+"'":f.keyField+"\x3d"+b.attributes[a.keyField],t.where=n,t.outFields=v.relatedFields,v.outStatistics&&0<v.outStatistics.length&&w.supportsStatistics&&(k=new m,k.where=t.where,
k.outFields=t.outFields,k.outStatistics=v.outStatistics),l=new r(z),n=[],n.push(l.execute(t)),k&&n.push(l.execute(k))));return n?d(n):q?q.promise:void 0},_setRelatedRecords:function(b,c){this._relatedInfo=[];for(var d in c)c.hasOwnProperty(d)&&c[d]&&(b=c[d],this._relatedInfo[d]={},this._relatedInfo[d].relatedFeatures=b[0].features,a.isDefined(b[1])&&(this._relatedInfo[d].relatedStatsFeatures=b[1].features))},_handlerErrorResponse:function(a,b){a.reject(b)},_fromRelatedFieldName:function(a){var b=
[];-1!==a.indexOf(this._relatedFieldPrefix)&&(a=a.split("/"),b=a.slice(1));return b},_toRelatedFieldName:function(a){var b="";a&&0<a.length&&(b=this._relatedFieldPrefix+a[0]+"/"+a[1]);return b},_queryRelatedRecords:function(a,b){var c=a.getSourceLayer(),d=new t;d.outFields=["*"];d.relationshipId=b.id;d.objectIds=[a.attributes[c.objectIdField]];return c.queryRelatedFeatures(d)}})})},"dojox/html/entities":function(){define(["dojo/_base/lang"],function(k){var e=k.getObject("dojox.html.entities",!0),
p=function(e,l){var h,f;if(l._encCache&&l._encCache.regexp&&l._encCache.mapper&&l.length==l._encCache.length)h=l._encCache.mapper,f=l._encCache.regexp;else{h={};f=["["];var d;for(d=0;d<l.length;d++)h[l[d][0]]="\x26"+l[d][1]+";",f.push(l[d][0]);f.push("]");f=new RegExp(f.join(""),"g");l._encCache={mapper:h,regexp:f,length:l.length}}return e=e.replace(f,function(c){return h[c]})},q=function(e,l){var h,f;if(l._decCache&&l._decCache.regexp&&l._decCache.mapper&&l.length==l._decCache.length)h=l._decCache.mapper,
f=l._decCache.regexp;else{h={};f=["("];var d;for(d=0;d<l.length;d++){var c="\x26"+l[d][1]+";";d&&f.push("|");h[c]=l[d][0];f.push(c)}f.push(")");f=new RegExp(f.join(""),"g");l._decCache={mapper:h,regexp:f,length:l.length}}return e=e.replace(f,function(a){return h[a]})};e.html=[["\x26","amp"],['"',"quot"],["\x3c","lt"],["\x3e","gt"],["\u00a0","nbsp"]];e.latin=[["\u00a1","iexcl"],["\u00a2","cent"],["\u00a3","pound"],["\u20ac","euro"],["\u00a4","curren"],["\u00a5","yen"],["\u00a6","brvbar"],["\u00a7",
"sect"],["\u00a8","uml"],["\u00a9","copy"],["\u00aa","ordf"],["\u00ab","laquo"],["\u00ac","not"],["\u00ad","shy"],["\u00ae","reg"],["\u00af","macr"],["\u00b0","deg"],["\u00b1","plusmn"],["\u00b2","sup2"],["\u00b3","sup3"],["\u00b4","acute"],["\u00b5","micro"],["\u00b6","para"],["\u00b7","middot"],["\u00b8","cedil"],["\u00b9","sup1"],["\u00ba","ordm"],["\u00bb","raquo"],["\u00bc","frac14"],["\u00bd","frac12"],["\u00be","frac34"],["\u00bf","iquest"],["\u00c0","Agrave"],["\u00c1","Aacute"],["\u00c2",
"Acirc"],["\u00c3","Atilde"],["\u00c4","Auml"],["\u00c5","Aring"],["\u00c6","AElig"],["\u00c7","Ccedil"],["\u00c8","Egrave"],["\u00c9","Eacute"],["\u00ca","Ecirc"],["\u00cb","Euml"],["\u00cc","Igrave"],["\u00cd","Iacute"],["\u00ce","Icirc"],["\u00cf","Iuml"],["\u00d0","ETH"],["\u00d1","Ntilde"],["\u00d2","Ograve"],["\u00d3","Oacute"],["\u00d4","Ocirc"],["\u00d5","Otilde"],["\u00d6","Ouml"],["\u00d7","times"],["\u00d8","Oslash"],["\u00d9","Ugrave"],["\u00da","Uacute"],["\u00db","Ucirc"],["\u00dc",
"Uuml"],["\u00dd","Yacute"],["\u00de","THORN"],["\u00df","szlig"],["\u00e0","agrave"],["\u00e1","aacute"],["\u00e2","acirc"],["\u00e3","atilde"],["\u00e4","auml"],["\u00e5","aring"],["\u00e6","aelig"],["\u00e7","ccedil"],["\u00e8","egrave"],["\u00e9","eacute"],["\u00ea","ecirc"],["\u00eb","euml"],["\u00ec","igrave"],["\u00ed","iacute"],["\u00ee","icirc"],["\u00ef","iuml"],["\u00f0","eth"],["\u00f1","ntilde"],["\u00f2","ograve"],["\u00f3","oacute"],["\u00f4","ocirc"],["\u00f5","otilde"],["\u00f6",
"ouml"],["\u00f7","divide"],["\u00f8","oslash"],["\u00f9","ugrave"],["\u00fa","uacute"],["\u00fb","ucirc"],["\u00fc","uuml"],["\u00fd","yacute"],["\u00fe","thorn"],["\u00ff","yuml"],["\u0192","fnof"],["\u0391","Alpha"],["\u0392","Beta"],["\u0393","Gamma"],["\u0394","Delta"],["\u0395","Epsilon"],["\u0396","Zeta"],["\u0397","Eta"],["\u0398","Theta"],["\u0399","Iota"],["\u039a","Kappa"],["\u039b","Lambda"],["\u039c","Mu"],["\u039d","Nu"],["\u039e","Xi"],["\u039f","Omicron"],["\u03a0","Pi"],["\u03a1",
"Rho"],["\u03a3","Sigma"],["\u03a4","Tau"],["\u03a5","Upsilon"],["\u03a6","Phi"],["\u03a7","Chi"],["\u03a8","Psi"],["\u03a9","Omega"],["\u03b1","alpha"],["\u03b2","beta"],["\u03b3","gamma"],["\u03b4","delta"],["\u03b5","epsilon"],["\u03b6","zeta"],["\u03b7","eta"],["\u03b8","theta"],["\u03b9","iota"],["\u03ba","kappa"],["\u03bb","lambda"],["\u03bc","mu"],["\u03bd","nu"],["\u03be","xi"],["\u03bf","omicron"],["\u03c0","pi"],["\u03c1","rho"],["\u03c2","sigmaf"],["\u03c3","sigma"],["\u03c4","tau"],["\u03c5",
"upsilon"],["\u03c6","phi"],["\u03c7","chi"],["\u03c8","psi"],["\u03c9","omega"],["\u03d1","thetasym"],["\u03d2","upsih"],["\u03d6","piv"],["\u2022","bull"],["\u2026","hellip"],["\u2032","prime"],["\u2033","Prime"],["\u203e","oline"],["\u2044","frasl"],["\u2118","weierp"],["\u2111","image"],["\u211c","real"],["\u2122","trade"],["\u2135","alefsym"],["\u2190","larr"],["\u2191","uarr"],["\u2192","rarr"],["\u2193","darr"],["\u2194","harr"],["\u21b5","crarr"],["\u21d0","lArr"],["\u21d1","uArr"],["\u21d2",
"rArr"],["\u21d3","dArr"],["\u21d4","hArr"],["\u2200","forall"],["\u2202","part"],["\u2203","exist"],["\u2205","empty"],["\u2207","nabla"],["\u2208","isin"],["\u2209","notin"],["\u220b","ni"],["\u220f","prod"],["\u2211","sum"],["\u2212","minus"],["\u2217","lowast"],["\u221a","radic"],["\u221d","prop"],["\u221e","infin"],["\u2220","ang"],["\u2227","and"],["\u2228","or"],["\u2229","cap"],["\u222a","cup"],["\u222b","int"],["\u2234","there4"],["\u223c","sim"],["\u2245","cong"],["\u2248","asymp"],["\u2260",
"ne"],["\u2261","equiv"],["\u2264","le"],["\u2265","ge"],["\u2282","sub"],["\u2283","sup"],["\u2284","nsub"],["\u2286","sube"],["\u2287","supe"],["\u2295","oplus"],["\u2297","otimes"],["\u22a5","perp"],["\u22c5","sdot"],["\u2308","lceil"],["\u2309","rceil"],["\u230a","lfloor"],["\u230b","rfloor"],["\u2329","lang"],["\u232a","rang"],["\u25ca","loz"],["\u2660","spades"],["\u2663","clubs"],["\u2665","hearts"],["\u2666","diams"],["\u0152","OElig"],["\u0153","oelig"],["\u0160","Scaron"],["\u0161","scaron"],
["\u0178","Yuml"],["\u02c6","circ"],["\u02dc","tilde"],["\u2002","ensp"],["\u2003","emsp"],["\u2009","thinsp"],["\u200c","zwnj"],["\u200d","zwj"],["\u200e","lrm"],["\u200f","rlm"],["\u2013","ndash"],["\u2014","mdash"],["\u2018","lsquo"],["\u2019","rsquo"],["\u201a","sbquo"],["\u201c","ldquo"],["\u201d","rdquo"],["\u201e","bdquo"],["\u2020","dagger"],["\u2021","Dagger"],["\u2030","permil"],["\u2039","lsaquo"],["\u203a","rsaquo"]];e.encode=function(n,l){n&&(l?n=p(n,l):(n=p(n,e.html),n=p(n,e.latin)));
return n};e.decode=function(n,l){n&&(l?n=q(n,l):(n=q(n,e.html),n=q(n,e.latin)));return n};return e})},"esri/promiseList":function(){define(["dojo/_base/array","dojo/Deferred","dojo/when"],function(k,e,p){var q=k.forEach;return function(n){function l(a,c){d[c]=a;b.progress([a,c]);0===--g&&b.resolve(d)}var h,f;n instanceof Array?f=n:n&&"object"===typeof n&&(h=n);var d,c=[];if(h){f=[];for(var a in h)Object.hasOwnProperty.call(h,a)&&(c.push(a),f.push(h[a]));d={}}else f&&(d=[]);if(!f||!f.length)return(new e).resolve(d);
var b=new e;b.promise.always(function(){d=c=null});var g=f.length;q(f,function(a,d){h||c.push(d);p(a,function(a){b.isFulfilled()||l(a,c[d])},function(a){b.isFulfilled()||l(a,c[d])})});return b.promise}})},"esri/tasks/QueryTask":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/Deferred dojo/_base/json dojo/has ../kernel ../request ../deferredUtils ../geometry/Extent ../geometry/normalizeUtils ./Task ./FeatureSet".split(" "),function(k,e,p,q,n,l,h,f,d,c,a,b,g){k=k(b,
{declaredClass:"esri.tasks.QueryTask",_eventMap:{complete:["featureSet"],"execute-for-count-complete":["count"],"execute-for-ids-complete":["objectIds"],"execute-relationship-query-complete":["featureSets"]},constructor:function(a,b){this._handler=e.hitch(this,this._handler);this._relationshipQueryHandler=e.hitch(this,this._relationshipQueryHandler);this._executeForIdsHandler=e.hitch(this,this._executeForIdsHandler);this._countHandler=e.hitch(this,this._countHandler);this._extentHandler=e.hitch(this,
this._extentHandler);this.source=b&&b.source;this.gdbVersion=b&&b.gdbVersion;this.registerConnectEvents()},__msigns:[{n:"execute",c:4,a:[{i:0,p:["geometry"]}],e:2},{n:"executeForIds",c:3,a:[{i:0,p:["geometry"]}],e:2},{n:"executeForCount",c:3,a:[{i:0,p:["geometry"]}],e:2},{n:"executeForExtent",c:3,a:[{i:0,p:["geometry"]}],e:2}],onComplete:function(){},onExecuteRelationshipQueryComplete:function(){},onExecuteForIdsComplete:function(){},onExecuteForCountComplete:function(){},onExecuteForExtentComplete:function(){},
execute:function(a,b,c,d,g){d=g.assembly;a=this._encode(e.mixin({},this._url.query,{f:"json"},a.toJson(d&&d[0])));var m=this._handler,h=this._errorHandler;this.source&&(d={source:this.source.toJson()},a.layer=n.toJson(d));this.gdbVersion&&(a.gdbVersion=this.gdbVersion);return f({url:this._url.path+"/query",content:a,callbackParamName:"callback",load:function(a,d){m(a,d,b,c,g.dfd)},error:function(a){h(a,c,g.dfd)}},this.requestOptions)},executeRelationshipQuery:function(a,b,c){a=this._encode(e.mixin({},
this._url.query,{f:"json"},a.toJson()));var g=this._relationshipQueryHandler,m=this._errorHandler;this.gdbVersion&&(a.gdbVersion=this.gdbVersion);var h=new q(d._dfdCanceller);h._pendingDfd=f({url:this._url.path+"/queryRelatedRecords",content:a,callbackParamName:"callback",load:function(a,d){g(a,d,b,c,h)},error:function(a){m(a,c,h)}},this.requestOptions);return h},executeForIds:function(a,b,c,d){var g=d.assembly;a=this._encode(e.mixin({},this._url.query,{f:"json",returnIdsOnly:!0},a.toJson(g&&g[0])));
var m=this._executeForIdsHandler,h=this._errorHandler;this.source&&(g={source:this.source.toJson()},a.layer=n.toJson(g));this.gdbVersion&&(a.gdbVersion=this.gdbVersion);return f({url:this._url.path+"/query",content:a,callbackParamName:"callback",load:function(a,g){m(a,g,b,c,d.dfd)},error:function(a){h(a,c,d.dfd)}},this.requestOptions)},executeForCount:function(a,b,c,d){var g=d.assembly;a=this._encode(e.mixin({},this._url.query,{f:"json",returnIdsOnly:!0,returnCountOnly:!0},a.toJson(g&&g[0])));var m=
this._countHandler,h=this._errorHandler;this.source&&(g={source:this.source.toJson()},a.layer=n.toJson(g));this.gdbVersion&&(a.gdbVersion=this.gdbVersion);return f({url:this._url.path+"/query",content:a,callbackParamName:"callback",load:function(a,g){m(a,g,b,c,d.dfd)},error:function(a){h(a,c,d.dfd)}},this.requestOptions)},executeForExtent:function(a,b,c,d){var g=d.assembly;a=this._encode(e.mixin({},this._url.query,{f:"json",returnExtentOnly:!0,returnCountOnly:!0},a.toJson(g&&g[0])));var m=this._extentHandler,
h=this._errorHandler;this.source&&(g={source:this.source.toJson()},a.layer=n.toJson(g));this.gdbVersion&&(a.gdbVersion=this.gdbVersion);return f({url:this._url.path+"/query",content:a,callbackParamName:"callback",load:function(a,g){m(a,g,b,c,d.dfd)},error:function(a){h(a,c,d.dfd)}},this.requestOptions)},_handler:function(a,b,c,d,f){try{var m=new g(a);this._successHandler([m],"onComplete",c,f)}catch(w){this._errorHandler(w,d,f)}},_relationshipQueryHandler:function(a,b,c,d,f){try{var m=a.geometryType,
h=a.spatialReference,r={};p.forEach(a.relatedRecordGroups,function(a){var b={};b.geometryType=m;b.spatialReference=h;b.features=a.relatedRecords;b=new g(b);if(null!=a.objectId)r[a.objectId]=b;else for(var c in a)a.hasOwnProperty(c)&&"relatedRecords"!==c&&(r[a[c]]=b)});this._successHandler([r],"onExecuteRelationshipQueryComplete",c,f)}catch(x){this._errorHandler(x,d,f)}},_executeForIdsHandler:function(a,b,c,d,g){try{this._successHandler([a.objectIds],"onExecuteForIdsComplete",c,g)}catch(y){this._errorHandler(y,
d,g)}},_countHandler:function(a,b,c,d,g){try{var m,f=a.features,h=a.objectIds;if(h)m=h.length;else{if(f)throw Error("Unable to perform query. Please check your parameters.");m=a.count}this._successHandler([m],"onExecuteForCountComplete",c,g)}catch(x){this._errorHandler(x,d,g)}},_extentHandler:function(a,b,d,g,f){try{a.extent&&(a.extent=new c(a.extent)),this._successHandler([a],"onExecuteForExtentComplete",d,f)}catch(y){this._errorHandler(y,g,f)}}});a._createWrappers(k);return k})},"esri/tasks/Task":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/json dojo/has ../kernel ../deferredUtils ../urlUtils ../Evented".split(" "),
function(k,e,p,q,n,l,h,f){return k(f,{declaredClass:"esri.tasks._Task",_eventMap:{error:["error"],complete:["result"]},constructor:function(d,c){d&&e.isString(d)&&(this._url=h.urlToObject(this.url=d));c&&c.requestOptions&&(this.requestOptions=c.requestOptions);this.normalization=!0;this._errorHandler=e.hitch(this,this._errorHandler);this.registerConnectEvents()},_useSSL:function(){var d=this._url,c=/^http:/i;this.url&&(this.url=this.url.replace(c,"https:"));d&&d.path&&(d.path=d.path.replace(c,"https:"))},
_encode:function(d,c,a){var b,g,f={},m,h;for(m in d)if("declaredClass"!==m&&(b=d[m],g=typeof b,null!==b&&void 0!==b&&"function"!==g))if(e.isArray(b))for(f[m]=[],h=b.length,g=0;g<h;g++)f[m][g]=this._encode(b[g]);else"object"===g?b.toJson&&(g=b.toJson(a&&a[m]),"esri.tasks.FeatureSet"===b.declaredClass&&g.spatialReference&&(g.sr=g.spatialReference,delete g.spatialReference),f[m]=c?g:p.toJson(g)):f[m]=b;return f},_successHandler:function(d,c,a,b){c&&this[c].apply(this,d);a&&a.apply(null,d);b&&l._resDfd(b,
d)},_errorHandler:function(d,c,a){this.onError(d);c&&c(d);a&&a.errback(d)},setNormalization:function(d){this.normalization=d},onError:function(){}})})},"esri/tasks/FeatureSet":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has ../kernel ../lang ../graphic ../SpatialReference ../graphicsUtils ../geometry/jsonUtils ../symbols/jsonUtils".split(" "),function(k,e,p,q,n,l,h,f,d,c,a){return k(null,{declaredClass:"esri.tasks.FeatureSet",constructor:function(b){if(b){e.mixin(this,
b);var d=this.features,l=b.spatialReference,m=c.getGeometryType(b.geometryType),l=this.spatialReference=new f(l);this.geometryType=b.geometryType;b.fields&&(this.fields=b.fields);p.forEach(d,function(b,c){var g=b.geometry&&b.geometry.spatialReference;d[c]=new h(m&&b.geometry?new m(b.geometry):null,b.symbol&&a.fromJson(b.symbol),b.attributes);d[c].geometry&&!g&&d[c].geometry.setSpatialReference(l)});this._hydrate()}else this.features=[]},displayFieldName:null,geometryType:null,spatialReference:null,
fieldAliases:null,toJson:function(a){var b={};this.displayFieldName&&(b.displayFieldName=this.displayFieldName);this.fields&&(b.fields=this.fields);this.spatialReference?b.spatialReference=this.spatialReference.toJson():this.features[0]&&this.features[0].geometry&&(b.spatialReference=this.features[0].geometry.spatialReference.toJson());this.features[0]&&(this.features[0].geometry&&(b.geometryType=c.getJsonType(this.features[0].geometry)),b.features=d._encodeGraphics(this.features,a));b.geometryType=
b.geometryType||this.geometryType;b.exceededTransferLimit=this.exceededTransferLimit;b.transform=this.transform;return l.fixJson(b)},_hydrate:function(){var a=this.transform,c=this.geometryType;if(a&&c)for(var d=this.features,m=a.translate[0],f=a.translate[1],h=a.scale[0],e=a.scale[1],l=function(a,b,c){if("esriGeometryPoint"===a)return function(a){a.x=b(a.x);a.y=c(a.y)};if("esriGeometryPolyline"===a||"esriGeometryPolygon"===a)return function(a){a=a.rings||a.paths;var d,g,m,f,h,r,e,t;d=0;for(g=a.length;d<
g;d++)for(h=a[d],m=0,f=h.length;m<f;m++)r=h[m],0<m?(e+=r[0],t+=r[1]):(e=r[0],t=r[1]),r[0]=b(e),r[1]=c(t)};if("esriGeometryEnvelope"===a)return function(a){a.xmin=b(a.xmin);a.ymin=c(a.ymin);a.xmax=b(a.xmax);a.ymax=c(a.ymax)};if("esriGeometryMultipoint"===a)return function(a){a=a.points;var d,g,m,f,h;d=0;for(g=a.length;d<g;d++)m=a[d],0<d?(f+=m[0],h+=m[1]):(f=m[0],h=m[1]),m[0]=b(f),m[1]=c(h)}}(c,function(a){return a*h+m},function(a){return f-a*e}),a=0,c=d.length;a<c;a++)d[a].geometry&&l(d[a].geometry);
this.transform=null},quantize:function(a){if(!this.geometryType)return this.transform=null,this;var b=a.translate[0],c=a.translate[1],d=a.scale[0],f=a.scale[1],h=this.features,e=function(a,b,c){var d,g,m,f,h,r,e=[];d=0;for(g=a.length;d<g;d++)if(m=a[d],0<d){if(r=b(m[0]),m=c(m[1]),r!==f||m!==h)e.push([r-f,m-h]),f=r,h=m}else f=b(m[0]),h=c(m[1]),e.push([f,h]);return 0<e.length?e:null},l=function(a,b,c){if("esriGeometryPoint"===a)return function(a){a.x=b(a.x);a.y=c(a.y);return a};if("esriGeometryPolyline"===
a||"esriGeometryPolygon"===a)return function(a){var d,g,m,f,h;m=a.rings||a.paths;h=[];d=0;for(g=m.length;d<g;d++)f=m[d],(f=e(f,b,c))&&h.push(f);return 0<h.length?(a.rings?a.rings=h:a.paths=h,a):null};if("esriGeometryMultipoint"===a)return function(a){var d;d=e(a.points,b,c);return 0<d.length?(a.points=d,a):null};if("esriGeometryEnvelope"===a)return function(a){return a}}(this.geometryType,function(a){return Math.round((a-b)/d)},function(a){return Math.round((c-a)/f)}),n,k;n=0;for(k=h.length;n<k;n++)h[n].geometry&&
(l(h[n].geometry)||h[n].setGeometry(null));this.transform=a;return this}})})},"esri/graphicsUtils":function(){define(["dojo/_base/lang","dojo/_base/array","dojo/has","./kernel","./geometry/Extent"],function(k,e,p,q,n){return{graphicsExtent:function(e){if(!e||!e.length)return null;var h=e[0].geometry,f=h.getExtent(),d,c,a=e.length;null===f&&(f=new n(h.x,h.y,h.x,h.y,h.spatialReference));for(c=1;c<a;c++)d=(h=e[c].geometry).getExtent(),null===d&&(d=new n(h.x,h.y,h.x,h.y,h.spatialReference)),f=f.union(d);
return 0>f.getWidth()&&0>f.getHeight()?null:f},getGeometries:function(l){return e.map(l,function(h){return h.geometry})},_encodeGraphics:function(l,h){var f=[],d,c,a;e.forEach(l,function(b,g){d=b.toJson();c={};d.geometry&&(a=h&&h[g],c.geometry=a&&a.toJson()||d.geometry);d.attributes&&(c.attributes=d.attributes);f[g]=c});return f}}})},"esri/tasks/RelationshipQuery":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/_base/json","dojo/has","../kernel"],function(k,e,p,q,n){return k(null,
{declaredClass:"esri.tasks.RelationshipQuery",definitionExpression:"",relationshipId:null,returnGeometry:!1,objectIds:null,outSpatialReference:null,outFields:null,toJson:function(){var e={definitionExpression:this.definitionExpression,relationshipId:this.relationshipId,returnGeometry:this.returnGeometry,maxAllowableOffset:this.maxAllowableOffset,geometryPrecision:this.geometryPrecision},h=this.objectIds,f=this.outFields,d=this.outSpatialReference;h&&(e.objectIds=h.join(","));f&&(e.outFields=f.join(","));
d&&(e.outSR=d.wkid||p.toJson(d.toJson()));e._ts=this._ts;return e}})})},"esri/tasks/StatisticDefinition":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel"],function(k,e,p,q){return k(null,{declaredClass:"esri.tasks.StatisticDefinition",toJson:function(){return{statisticType:this.statisticType,onStatisticField:this.onStatisticField,outStatisticFieldName:this.outStatisticFieldName,maxPointCount:this.maxPointCount,maxRecordCount:this.maxRecordCount,maxVertexCount:this.maxVertexCount}}})})},
"esri/dijit/PopupRenderer":function(){define("require dojo/_base/declare dojo/_base/connect dojo/_base/lang dojo/_base/array dojo/_base/kernel dojo/sniff dojo/query dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/dom-style dojox/html/entities dijit/_Widget dijit/_Templated ../kernel ../lang ../urlUtils ./_EventedWidget dojo/i18n!../nls/jsapi dojo/NodeList-dom".split(" "),function(k,e,p,q,n,l,h,f,d,c,a,b,g,u,m,r,t,v,y,w,z){var x=0,A=z.widgets.popup,C=z.widgets.templatePicker;return e([w,
m,r],{declaredClass:"esri.dijit._PopupRenderer",constructor:function(){this._nls=q.mixin({},A)},templateString:"\x3cdiv class\x3d'esriViewPopup'\x3e\x3cdiv class\x3d'statusSection hidden' dojoAttachPoint\x3d'_status'\x3e\x3c/div\x3e\x3cdiv class\x3d'mainSection'\x3e\x3cdiv class\x3d'header' dojoAttachPoint\x3d'_title'\x3e\x3c/div\x3e\x3cdiv class\x3d'hzLine'\x3e\x3c/div\x3e\x3cdiv dojoAttachPoint\x3d'_description'\x3e\x3c/div\x3e\x3cdiv class\x3d'break'\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d'attachmentsSection hidden'\x3e\x3cdiv\x3e${_nls.NLS_attach}:\x3c/div\x3e\x3cul dojoAttachPoint\x3d'_attachmentsList'\x3e\x3c/ul\x3e\x3cdiv class\x3d'break'\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d'mediaSection hidden'\x3e\x3cdiv class\x3d'header' dojoAttachPoint\x3d'_mediaTitle'\x3e\x3c/div\x3e\x3cdiv class\x3d'hzLine'\x3e\x3c/div\x3e\x3cdiv class\x3d'caption' dojoAttachPoint\x3d'_mediaCaption'\x3e\x3c/div\x3e\x3cdiv class\x3d'gallery' dojoAttachPoint\x3d'_gallery'\x3e\x3cdiv class\x3d'mediaHandle prev' dojoAttachPoint\x3d'_prevMedia' dojoAttachEvent\x3d'onclick: _goToPrevMedia'\x3e\x3c/div\x3e\x3cdiv class\x3d'mediaHandle next' dojoAttachPoint\x3d'_nextMedia' dojoAttachEvent\x3d'onclick: _goToNextMedia'\x3e\x3c/div\x3e\x3cul class\x3d'summary'\x3e\x3cli class\x3d'image mediaCount hidden' dojoAttachPoint\x3d'_imageCount'\x3e0\x3c/li\x3e\x3cli class\x3d'image mediaIcon hidden'\x3e\x3c/li\x3e\x3cli class\x3d'chart mediaCount hidden' dojoAttachPoint\x3d'_chartCount'\x3e0\x3c/li\x3e\x3cli class\x3d'chart mediaIcon hidden'\x3e\x3c/li\x3e\x3c/ul\x3e\x3cdiv class\x3d'frame' dojoAttachPoint\x3d'_mediaFrame'\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d'editSummarySection hidden' dojoAttachPoint\x3d'_editSummarySection'\x3e\x3cdiv class\x3d'break'\x3e\x3c/div\x3e\x3cdiv class\x3d'break hidden' dojoAttachPoint\x3d'_mediaBreak'\x3e\x3c/div\x3e\x3cdiv class\x3d'editSummary' dojoAttachPoint\x3d'_editSummary'\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e",
showTitle:!0,startup:function(){this.inherited(arguments);this._showStatus(C.loading);this._contentDfd=this.template.getComponents(this.graphic).then(q.hitch(this,this._handleComponentsSuccess)).otherwise(q.hitch(this,this._handleComponentsError))},destroy:function(){this._contentDfd&&this._contentDfd.cancel();this._attachmentsDfd&&this._attachmentsDfd.cancel();this._destroyFrame();this.template=this.graphic=this._nls=this._mediaInfos=this._mediaPtr=this._contentDfd=this._attachmentsDfd=null;this.inherited(arguments)},
_goToPrevMedia:function(){0>this._mediaPtr-1||(this._mediaPtr--,this._updateUI(),this._displayMedia())},_goToNextMedia:function(){this._mediaPtr+1!==this._mediaInfos.length&&(this._mediaPtr++,this._updateUI(),this._displayMedia())},_updateUI:function(){var b=this._mediaInfos,d=b.length,g=this.domNode,m=this._prevMedia,f=this._nextMedia;if(1<d){var h=0,r=0;n.forEach(b,function(a){"image"===a.type?h++:-1!==a.type.indexOf("chart")&&r++});h&&(c.set(this._imageCount,"innerHTML",h),l.query(".summary .image",
g).removeClass("hidden"));r&&(c.set(this._chartCount,"innerHTML",r),l.query(".summary .chart",g).removeClass("hidden"))}else l.query(".summary",g).addClass("hidden"),a.add(m,"hidden"),a.add(f,"hidden");b=this._mediaPtr;0===b?a.add(m,"hidden"):a.remove(m,"hidden");b===d-1?a.add(f,"hidden"):a.remove(f,"hidden");this._destroyFrame()},_displayMedia:function(){var b=this._mediaInfos[this._mediaPtr],d=b.title,g=b.caption,m=l.query(".mediaSection .hzLine",this.domNode)[0];c.set(this._mediaTitle,"innerHTML",
d);a[d?"remove":"add"](this._mediaTitle,"hidden");c.set(this._mediaCaption,"innerHTML",g);a[g?"remove":"add"](this._mediaCaption,"hidden");a[d&&g?"remove":"add"](m,"hidden");this._rid=null;if("image"===b.type)this._showImage(b);else{var f=this,d=["dojox/charting/Chart2D","dojox/charting/action2d/Tooltip"],g=b.value.theme||this.chartTheme;q.isString(g)&&(g=g.replace(/\./gi,"/"),-1===g.indexOf("/")&&(g="dojox/charting/themes/"+g));g||(g="./Rainbow");d.push(g);try{var h=this._rid=x++;k(d,function(a,
c,d){h===f._rid&&(f._rid=null,f._showChart(b.type,b.value,a,c,d))})}catch(L){console.log("PopupRenderer: error loading modules")}}},_preventNewTab:function(a){return(a=a&&q.trim(a).toLowerCase())&&(0===a.indexOf("mailto:")||0===a.indexOf("tel:"))},_showImage:function(c){a.add(this._mediaFrame,"image");var d=g.get(this._gallery,"height"),m=c.value,f;m.linkURL&&(f=b.create("a",{href:m.linkURL,target:this._preventNewTab(m.linkURL)?"":"_blank"},this._mediaFrame));m=c.refreshInterval?this._addURLParameter(m.sourceURL,
"timestamp",Date.now()):m.sourceURL;b.create("img",{className:"esriPopupMediaImage",src:m},f||this._mediaFrame);var h=l.query(".esriPopupMediaImage",this._mediaFrame)[0];this._imageLoadHandle=p.connect(h,"onload",this,function(){this._clearImageHandles();this._imageLoaded(h,d);this._initImageRefresh(c)})},_addURLParameter:function(a,b,c){var d=-1===a.indexOf("?")?"?":"\x26";return a+d+b+"\x3d"+c},_initImageRefresh:function(a){if(a.refreshInterval){var b=6E4*a.refreshInterval;this._imageRefreshHandle=
setTimeout(q.hitch(this,function(){this._destroyFrame();this._showImage(a)}),b)}},_clearImageHandles:function(){p.disconnect(this._imageLoadHandle);this._imageLoadHandle=null;clearTimeout(this._imageRefreshHandle);this._imageRefreshHandle=null},_showChart:function(c,d,g,m,f){a.remove(this._mediaFrame,"image");g=this._chart=new g(b.create("div",{"class":"chart"},this._mediaFrame),{margins:{l:4,t:4,r:4,b:4}});f&&g.setTheme(f);switch(c){case "piechart":g.addPlot("default",{type:"Pie",labels:!1});g.addSeries("Series A",
d.fields);break;case "linechart":g.addPlot("default",{type:"Markers"});g.addAxis("x",{min:0,majorTicks:!1,minorTicks:!1,majorLabels:!1,minorLabels:!1});g.addAxis("y",{includeZero:!0,vertical:!0,fixUpper:"minor"});n.forEach(d.fields,function(a,b){a.x=b+1});g.addSeries("Series A",d.fields);break;case "columnchart":g.addPlot("default",{type:"Columns",gap:3});g.addAxis("y",{includeZero:!0,vertical:!0,fixUpper:"minor"});g.addSeries("Series A",d.fields);break;case "barchart":g.addPlot("default",{type:"Bars",
gap:3}),g.addAxis("x",{includeZero:!0,fixUpper:"minor",minorLabels:!1}),g.addAxis("y",{vertical:!0,majorTicks:!1,minorTicks:!1,majorLabels:!1,minorLabels:!1}),g.addSeries("Series A",d.fields)}this._action=new m(g);g.render()},_destroyFrame:function(){this._rid=null;this._clearImageHandles();this._chart&&(this._chart.destroy(),this._chart=null);this._action&&(this._action.destroy(),this._action=null);c.set(this._mediaFrame,"innerHTML","")},_imageLoaded:function(a,b){var c=a.height;c<b&&g.set(a,"marginTop",
Math.round((b-c)/2)+"px")},_attListHandler:function(a,b){if(a===this._attachmentsDfd){this._attachmentsDfd=null;var d="";b instanceof Error||!b||!b.length||n.forEach(b,function(a){d+="\x3cli\x3e";d+="\x3ca href\x3d'"+y.addProxy(a.url)+"' target\x3d'_blank'\x3e"+(a.name||"[No name]")+"\x3c/a\x3e";d+="\x3c/li\x3e"});c.set(this._attachmentsList,"innerHTML",d||"\x3cli\x3e"+this._nls.NLS_noAttach+"\x3c/li\x3e")}},_supportedURIInfos:[{pattern:/^\s*(https?:\/\/([^\s]+))\s*$/i,label:A.NLS_moreInfo},{pattern:/^\s*(tel:([^\s]+))\s*$/i,
label:"${hierPart}"},{pattern:/^\s*(mailto:([^\s]+))\s*$/i,label:"${hierPart}"},{pattern:/^\s*(arcgis-appstudio-player:\/\/([^\s]+))\s*$/i,appName:"App Studio Player",label:A.NLS_openLinkInApp},{pattern:/^\s*(arcgis-collector:\/\/([^\s]+))\s*$/i,appName:"Collector",label:A.NLS_openLinkInApp},{pattern:/^\s*(arcgis-explorer:\/\/([^\s]+))\s*$/i,appName:"Explorer",label:A.NLS_openLinkInApp},{pattern:/^\s*(arcgis-navigator:\/\/([^\s]+))\s*$/i,appName:"Navigator",label:A.NLS_openLinkInApp},{pattern:/^\s*(arcgis-survey123:\/\/([^\s]+))\s*$/i,
appName:"Survey123",label:A.NLS_openLinkInApp},{pattern:/^\s*(arcgis-trek2there:\/\/([^\s]+))\s*$/i,appName:"Trek2There",label:A.NLS_openLinkInApp},{pattern:/^\s*(arcgis-workforce:\/\/([^\s]+))\s*$/i,appName:"Workforce",label:A.NLS_openLinkInApp},{pattern:/^\s*(iform:\/\/([^\s]+))\s*$/i,appName:"iForm",label:A.NLS_openLinkInApp},{pattern:/^\s*(flow:\/\/([^\s]+))\s*$/i,appName:"FlowFinity",label:A.NLS_openLinkInApp},{pattern:/^\s*(lfmobile:\/\/([^\s]+))\s*$/i,appName:"Laserfische",label:A.NLS_openLinkInApp},
{pattern:/^\s*(mspbi:\/\/([^\s]+))\s*$/i,appName:"Microsoft Power BI",label:A.NLS_openLinkInApp}],_findURIInfo:function(a){var b;n.some(this._supportedURIInfos,function(c){c.pattern.test(a)&&(b=c);return!!b});return b},_createLinkIfURI:function(a){var b=this._findURIInfo(a);if(b){var c=a.match(b.pattern);return a.replace(b.pattern,"\x3ca target\x3d'_blank' href\x3d'$1' title\x3d'$1'\x3e"+v.substitute({appName:b.appName,hierPart:c&&c[2]},b.label)+"\x3c/a\x3e")}return a},_showStatus:function(b){c.set(this._status,
"innerHTML",b);a.remove(this._status,"hidden");l.query(".mainSection",this.domNode).addClass("hidden")},_hideStatus:function(){c.set(this._status,"innerHTML","");a.add(this._status,"hidden");l.query(".mainSection",this.domNode).removeClass("hidden")},_handleComponentsSuccess:function(b){if(b){this._hideStatus();var g=this.showTitle?b.title:"",m=b.description,f=b.fields,h=b.mediaInfos,r=this.domNode,e=this._nls,t=this,k=this.template,w=this.graphic;this._prevMedia.title=e.NLS_prevMedia;this._nextMedia.title=
e.NLS_nextMedia;c.set(this._title,"innerHTML",g);g||a.add(this._title,"hidden");!b.hasDescription&&f&&(m="",n.forEach(f,function(a){m+="\x3ctr valign\x3d'top'\x3e";m+="\x3ctd class\x3d'attrName'\x3e"+u.encode(a[0])+"\x3c/td\x3e";m+="\x3ctd class\x3d'attrValue'\x3e"+this._createLinkIfURI(a[1])+"\x3c/td\x3e";m+="\x3c/tr\x3e"},this),m&&(m="\x3ctable class\x3d'attrTable' cellpadding\x3d'0px' cellspacing\x3d'0px'\x3e"+m+"\x3c/table\x3e"));c.set(this._description,"innerHTML",m);m||a.add(this._description,
"hidden");l.query("a",this._description).forEach(function(a){t._preventNewTab(a.href)?"_blank"===a.target&&c.remove(a,"target"):c.set(a,"target","_blank")});g&&m?l.query(".mainSection .hzLine",r).removeClass("hidden"):g||m?l.query(".mainSection .hzLine",r).addClass("hidden"):l.query(".mainSection",r).addClass("hidden");if(g=this._attachmentsDfd=k.getAttachments(w))g.addBoth(q.hitch(this,this._attListHandler,g)),c.set(this._attachmentsList,"innerHTML","\x3cli\x3e"+e.NLS_searching+"...\x3c/li\x3e"),
l.query(".attachmentsSection",r).removeClass("hidden");h&&h.length&&(l.query(".mediaSection",r).removeClass("hidden"),d.setSelectable(this._mediaFrame,!1),this._mediaInfos=h,this._mediaPtr=0,this._updateUI(),this._displayMedia());b.editSummary&&(c.set(this._editSummary,"innerHTML",b.editSummary),h&&h.length&&a.remove(this._mediaBreak,"hidden"),a.remove(this._editSummarySection,"hidden"));this.emit("content-update")}else this._showStatus(A.NLS_noInfo)},_handleComponentsError:function(a){a&&"cancel"===
a.dojoType||(console.log("PopupRenderer: error loading template",a),this._showStatus(A.NLS_noInfo))}})})},"dijit/_Widget":function(){define("dojo/aspect dojo/_base/config dojo/_base/connect dojo/_base/declare dojo/has dojo/_base/kernel dojo/_base/lang dojo/query dojo/ready ./registry ./_WidgetBase ./_OnDijitClickMixin ./_FocusMixin dojo/uacss ./hccss".split(" "),function(k,e,p,q,n,l,h,f,d,c,a,b,g){function u(){}function m(a){return function(b,c,d,g){return b&&"string"==typeof c&&b[c]==u?b.on(c.substring(2).toLowerCase(),
h.hitch(d,g)):a.apply(p,arguments)}}k.around(p,"connect",m);l.connect&&k.around(l,"connect",m);k=q("dijit._Widget",[a,b,g],{onClick:u,onDblClick:u,onKeyDown:u,onKeyPress:u,onKeyUp:u,onMouseDown:u,onMouseMove:u,onMouseOut:u,onMouseOver:u,onMouseLeave:u,onMouseEnter:u,onMouseUp:u,constructor:function(a){this._toConnect={};for(var b in a)this[b]===u&&(this._toConnect[b.replace(/^on/,"").toLowerCase()]=a[b],delete a[b])},postCreate:function(){this.inherited(arguments);for(var a in this._toConnect)this.on(a,
this._toConnect[a]);delete this._toConnect},on:function(a,b){return this[this._onMap(a)]===u?p.connect(this.domNode,a.toLowerCase(),this,b):this.inherited(arguments)},_setFocusedAttr:function(a){this._focused=a;this._set("focused",a)},setAttribute:function(a,b){l.deprecated(this.declaredClass+"::setAttribute(attr, value) is deprecated. Use set() instead.","","2.0");this.set(a,b)},attr:function(a,b){return 2<=arguments.length||"object"===typeof a?this.set.apply(this,arguments):this.get(a)},getDescendants:function(){l.deprecated(this.declaredClass+
"::getDescendants() is deprecated. Use getChildren() instead.","","2.0");return this.containerNode?f("[widgetId]",this.containerNode).map(c.byNode):[]},_onShow:function(){this.onShow()},onShow:function(){},onHide:function(){},onClose:function(){return!0}});n("dijit-legacy-requires")&&d(0,function(){require(["dijit/_base"])});return k})},"dijit/_WidgetBase":function(){define("require dojo/_base/array dojo/aspect dojo/_base/config dojo/_base/connect dojo/_base/declare dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/dom-geometry dojo/dom-style dojo/has dojo/_base/kernel dojo/_base/lang dojo/on dojo/ready dojo/Stateful dojo/topic dojo/_base/window ./Destroyable dojo/has!dojo-bidi?./_BidiMixin ./registry".split(" "),
function(k,e,p,q,n,l,h,f,d,c,a,b,g,u,m,r,t,v,y,w,z,x,A){function C(a){return function(b){f[b?"set":"remove"](this.domNode,a,b);this._set(a,b)}}g.add("dijit-legacy-requires",!u.isAsync);g.add("dojo-bidi",!1);g("dijit-legacy-requires")&&t(0,function(){k(["dijit/_base/manager"])});var B={};q=l("dijit._WidgetBase",[v,z],{id:"",_setIdAttr:"domNode",lang:"",_setLangAttr:C("lang"),dir:"",_setDirAttr:C("dir"),"class":"",_setClassAttr:{node:"domNode",type:"class"},_setTypeAttr:null,style:"",title:"",tooltip:"",
baseClass:"",srcNodeRef:null,domNode:null,containerNode:null,ownerDocument:null,_setOwnerDocumentAttr:function(a){this._set("ownerDocument",a)},attributeMap:{},_blankGif:q.blankGif||k.toUrl("dojo/resources/blank.gif"),textDir:"",_introspect:function(){var a=this.constructor;if(!a._setterAttrs){var b=a.prototype,c=a._setterAttrs=[],a=a._onMap={},d;for(d in b.attributeMap)c.push(d);for(d in b)/^on/.test(d)&&(a[d.substring(2).toLowerCase()]=d),/^_set[A-Z](.*)Attr$/.test(d)&&(d=d.charAt(4).toLowerCase()+
d.substr(5,d.length-9),b.attributeMap&&d in b.attributeMap||c.push(d))}},postscript:function(a,b){this.create(a,b)},create:function(a,b){this._introspect();this.srcNodeRef=h.byId(b);this._connects=[];this._supportingWidgets=[];this.srcNodeRef&&this.srcNodeRef.id&&"string"==typeof this.srcNodeRef.id&&(this.id=this.srcNodeRef.id);a&&(this.params=a,m.mixin(this,a));this.postMixInProperties();this.id||(this.id=A.getUniqueId(this.declaredClass.replace(/\./g,"_")),this.params&&delete this.params.id);this.ownerDocument=
this.ownerDocument||(this.srcNodeRef?this.srcNodeRef.ownerDocument:document);this.ownerDocumentBody=w.body(this.ownerDocument);A.add(this);this.buildRendering();var c;this.domNode&&(this._applyAttributes(),(a=this.srcNodeRef)&&a.parentNode&&this.domNode!==a&&(a.parentNode.replaceChild(this.domNode,a),c=!0),this.domNode.setAttribute("widgetId",this.id));this.postCreate();c&&delete this.srcNodeRef;this._created=!0},_applyAttributes:function(){var a={},b;for(b in this.params||{})a[b]=this._get(b);e.forEach(this.constructor._setterAttrs,
function(b){if(!(b in a)){var c=this._get(b);c&&this.set(b,c)}},this);for(b in a)this.set(b,a[b])},postMixInProperties:function(){},buildRendering:function(){this.domNode||(this.domNode=this.srcNodeRef||this.ownerDocument.createElement("div"));if(this.baseClass){var a=this.baseClass.split(" ");this.isLeftToRight()||(a=a.concat(e.map(a,function(a){return a+"Rtl"})));d.add(this.domNode,a)}},postCreate:function(){},startup:function(){this._started||(this._started=!0,e.forEach(this.getChildren(),function(a){a._started||
a._destroyed||!m.isFunction(a.startup)||(a.startup(),a._started=!0)}))},destroyRecursive:function(a){this._beingDestroyed=!0;this.destroyDescendants(a);this.destroy(a)},destroy:function(a){function b(b){b.destroyRecursive?b.destroyRecursive(a):b.destroy&&b.destroy(a)}this._beingDestroyed=!0;this.uninitialize();e.forEach(this._connects,m.hitch(this,"disconnect"));e.forEach(this._supportingWidgets,b);this.domNode&&e.forEach(A.findWidgets(this.domNode,this.containerNode),b);this.destroyRendering(a);
A.remove(this.id);this._destroyed=!0},destroyRendering:function(a){this.bgIframe&&(this.bgIframe.destroy(a),delete this.bgIframe);this.domNode&&(a?f.remove(this.domNode,"widgetId"):c.destroy(this.domNode),delete this.domNode);this.srcNodeRef&&(a||c.destroy(this.srcNodeRef),delete this.srcNodeRef)},destroyDescendants:function(a){e.forEach(this.getChildren(),function(b){b.destroyRecursive&&b.destroyRecursive(a)})},uninitialize:function(){return!1},_setStyleAttr:function(a){var c=this.domNode;m.isObject(a)?
b.set(c,a):c.style.cssText=c.style.cssText?c.style.cssText+("; "+a):a;this._set("style",a)},_attrToDom:function(a,b,c){c=3<=arguments.length?c:this.attributeMap[a];e.forEach(m.isArray(c)?c:[c],function(c){var g=this[c.node||c||"domNode"];switch(c.type||"attribute"){case "attribute":m.isFunction(b)&&(b=m.hitch(this,b));c=c.attribute?c.attribute:/^on[A-Z][a-zA-Z]*$/.test(a)?a.toLowerCase():a;g.tagName?f.set(g,c,b):g.set(c,b);break;case "innerText":g.innerHTML="";g.appendChild(this.ownerDocument.createTextNode(b));
break;case "innerHTML":g.innerHTML=b;break;case "class":d.replace(g,b,this[a]);break;case "toggleClass":d.toggle(g,c.className||a,b)}},this)},get:function(a){var b=this._getAttrNames(a);return this[b.g]?this[b.g]():this._get(a)},set:function(a,b){if("object"===typeof a){for(var c in a)this.set(c,a[c]);return this}c=this._getAttrNames(a);var d=this[c.s];if(m.isFunction(d))var g=d.apply(this,Array.prototype.slice.call(arguments,1));else{var d=this.focusNode&&!m.isFunction(this.focusNode)?"focusNode":
"domNode",f=this[d]&&this[d].tagName,h;if((h=f)&&!(h=B[f])){h=this[d];var r={},e;for(e in h)r[e.toLowerCase()]=!0;h=B[f]=r}e=h;c=a in this.attributeMap?this.attributeMap[a]:c.s in this?this[c.s]:e&&c.l in e&&"function"!=typeof b||/^aria-|^data-|^role$/.test(a)?d:null;null!=c&&this._attrToDom(a,b,c);this._set(a,b)}return g||this},_attrPairNames:{},_getAttrNames:function(a){var b=this._attrPairNames;if(b[a])return b[a];var c=a.replace(/^[a-z]|-[a-zA-Z]/g,function(a){return a.charAt(a.length-1).toUpperCase()});
return b[a]={n:a+"Node",s:"_set"+c+"Attr",g:"_get"+c+"Attr",l:c.toLowerCase()}},_set:function(a,b){var c=this[a];this[a]=b;!this._created||c===b||c!==c&&b!==b||(this._watchCallbacks&&this._watchCallbacks(a,c,b),this.emit("attrmodified-"+a,{detail:{prevValue:c,newValue:b}}))},_get:function(a){return this[a]},emit:function(a,b,c){b=b||{};void 0===b.bubbles&&(b.bubbles=!0);void 0===b.cancelable&&(b.cancelable=!0);b.detail||(b.detail={});b.detail.widget=this;var d,g=this["on"+a];g&&(d=g.apply(this,c?
c:[b]));this._started&&!this._beingDestroyed&&r.emit(this.domNode,a.toLowerCase(),b);return d},on:function(a,b){var c=this._onMap(a);return c?p.after(this,c,b,!0):this.own(r(this.domNode,a,b))[0]},_onMap:function(a){var b=this.constructor,c=b._onMap;if(!c){var c=b._onMap={},d;for(d in b.prototype)/^on/.test(d)&&(c[d.replace(/^on/,"").toLowerCase()]=d)}return c["string"==typeof a&&a.toLowerCase()]},toString:function(){return"[Widget "+this.declaredClass+", "+(this.id||"NO ID")+"]"},getChildren:function(){return this.containerNode?
A.findWidgets(this.containerNode):[]},getParent:function(){return A.getEnclosingWidget(this.domNode.parentNode)},connect:function(a,b,c){return this.own(n.connect(a,b,this,c))[0]},disconnect:function(a){a.remove()},subscribe:function(a,b){return this.own(y.subscribe(a,m.hitch(this,b)))[0]},unsubscribe:function(a){a.remove()},isLeftToRight:function(){return this.dir?"ltr"==this.dir.toLowerCase():a.isBodyLtr(this.ownerDocument)},isFocusable:function(){return this.focus&&"none"!=b.get(this.domNode,"display")},
placeAt:function(a,b){var d=!a.tagName&&A.byId(a);!d||!d.addChild||b&&"number"!==typeof b?(a=d&&"domNode"in d?d.containerNode&&!/after|before|replace/.test(b||"")?d.containerNode:d.domNode:h.byId(a,this.ownerDocument),c.place(this.domNode,a,b),!this._started&&(this.getParent()||{})._started&&this.startup()):d.addChild(this,b);return this},defer:function(a,b){var c=setTimeout(m.hitch(this,function(){c&&(c=null,this._destroyed||m.hitch(this,a)())}),b||0);return{remove:function(){c&&(clearTimeout(c),
c=null);return null}}}});g("dojo-bidi")&&q.extend(x);return q})},"dijit/Destroyable":function(){define(["dojo/_base/array","dojo/aspect","dojo/_base/declare"],function(k,e,p){return p("dijit.Destroyable",null,{destroy:function(e){this._destroyed=!0},own:function(){var p=["destroyRecursive","destroy","remove"];k.forEach(arguments,function(n){function l(){f.remove();k.forEach(d,function(c){c.remove()})}var h,f=e.before(this,"destroy",function(c){n[h](c)}),d=[];n.then?(h="cancel",n.then(l,l)):k.forEach(p,
function(c){"function"===typeof n[c]&&(h||(h=c),d.push(e.after(n,c,l,!0)))})},this);return arguments}})})},"dijit/_OnDijitClickMixin":function(){define("dojo/on dojo/_base/array dojo/keys dojo/_base/declare dojo/has ./a11yclick".split(" "),function(k,e,p,q,n,l){k=q("dijit._OnDijitClickMixin",null,{connect:function(h,f,d){return this.inherited(arguments,[h,"ondijitclick"==f?l:f,d])}});k.a11yclick=l;return k})},"dijit/_FocusMixin":function(){define(["./focus","./_WidgetBase","dojo/_base/declare","dojo/_base/lang"],
function(k,e,p,q){q.extend(e,{focused:!1,onFocus:function(){},onBlur:function(){},_onFocus:function(){this.onFocus()},_onBlur:function(){this.onBlur()}});return p("dijit._FocusMixin",null,{_focusManager:k})})},"dijit/hccss":function(){define(["dojo/dom-class","dojo/hccss","dojo/domReady","dojo/_base/window"],function(k,e,p,q){p(function(){e("highcontrast")&&k.add(q.body(),"dijit_a11y")});return e})},"dojo/hccss":function(){define("require ./_base/config ./dom-class ./dom-style ./has ./domReady ./_base/window".split(" "),
function(k,e,p,q,n,l,h){n.add("highcontrast",function(){var f=h.doc.createElement("div");try{f.style.cssText='border: 1px solid; border-color:red green; position: absolute; height: 5px; top: -999px;background-image: url("'+(e.blankGif||k.toUrl("./resources/blank.gif"))+'");';h.body().appendChild(f);var d=q.getComputedStyle(f),c=d.backgroundImage;return d.borderTopColor==d.borderRightColor||c&&("none"==c||"url(invalid-url:)"==c)}catch(a){return console.warn("hccss: exception detecting high-contrast mode, document is likely hidden: "+
a.toString()),!1}finally{8>=n("ie")?f.outerHTML="":h.body().removeChild(f)}});l(function(){n("highcontrast")&&p.add(h.body(),"dj_a11y")});return n})},"dijit/_Templated":function(){define("./_WidgetBase ./_TemplatedMixin ./_WidgetsInTemplateMixin dojo/_base/array dojo/_base/declare dojo/_base/lang dojo/_base/kernel".split(" "),function(k,e,p,q,n,l,h){l.extend(k,{waiRole:"",waiState:""});return n("dijit._Templated",[e,p],{constructor:function(){h.deprecated(this.declaredClass+": dijit._Templated deprecated, use dijit._TemplatedMixin and if necessary dijit._WidgetsInTemplateMixin",
"","2.0")},_processNode:function(f,d){var c=this.inherited(arguments),a=d(f,"waiRole");a&&f.setAttribute("role",a);(a=d(f,"waiState"))&&q.forEach(a.split(/\s*,\s*/),function(a){-1!=a.indexOf("-")&&(a=a.split("-"),f.setAttribute("aria-"+a[0],a[1]))});return c}})})},"dijit/_TemplatedMixin":function(){define("dojo/cache dojo/_base/declare dojo/dom-construct dojo/_base/lang dojo/on dojo/sniff dojo/string ./_AttachMixin".split(" "),function(k,e,p,q,n,l,h,f){var d=e("dijit._TemplatedMixin",f,{templateString:null,
templatePath:null,_skipNodeCache:!1,searchContainerNode:!0,_stringRepl:function(c){var a=this.declaredClass,b=this;return h.substitute(c,this,function(c,d){"!"==d.charAt(0)&&(c=q.getObject(d.substr(1),!1,b));if("undefined"==typeof c)throw Error(a+" template:"+d);return null==c?"":"!"==d.charAt(0)?c:this._escapeValue(""+c)},this)},_escapeValue:function(c){return c.replace(/["'<>&]/g,function(a){return{"\x26":"\x26amp;","\x3c":"\x26lt;","\x3e":"\x26gt;",'"':"\x26quot;","'":"\x26#x27;"}[a]})},buildRendering:function(){if(!this._rendered){this.templateString||
(this.templateString=k(this.templatePath,{sanitize:!0}));var c=d.getCachedTemplate(this.templateString,this._skipNodeCache,this.ownerDocument),a;if(q.isString(c)){if(a=p.toDom(this._stringRepl(c),this.ownerDocument),1!=a.nodeType)throw Error("Invalid template: "+c);}else a=c.cloneNode(!0);this.domNode=a}this.inherited(arguments);this._rendered||this._fillContent(this.srcNodeRef);this._rendered=!0},_fillContent:function(c){var a=this.containerNode;if(c&&a)for(;c.hasChildNodes();)a.appendChild(c.firstChild)}});
d._templateCache={};d.getCachedTemplate=function(c,a,b){var g=d._templateCache,f=c,m=g[f];if(m){try{if(!m.ownerDocument||m.ownerDocument==(b||document))return m}catch(r){}p.destroy(m)}c=h.trim(c);if(a||c.match(/\$\{([^\}]+)\}/g))return g[f]=c;a=p.toDom(c,b);if(1!=a.nodeType)throw Error("Invalid template: "+c);return g[f]=a};l("ie")&&n(window,"unload",function(){var c=d._templateCache,a;for(a in c){var b=c[a];"object"==typeof b&&p.destroy(b);delete c[a]}});return d})},"dojo/cache":function(){define(["./_base/kernel",
"./text"],function(k){return k.cache})},"dijit/_AttachMixin":function(){define("require dojo/_base/array dojo/_base/connect dojo/_base/declare dojo/_base/lang dojo/mouse dojo/on dojo/touch ./_WidgetBase".split(" "),function(k,e,p,q,n,l,h,f,d){var c=n.delegate(f,{mouseenter:l.enter,mouseleave:l.leave,keypress:p._keypress}),a;p=q("dijit._AttachMixin",null,{constructor:function(){this._attachPoints=[];this._attachEvents=[]},buildRendering:function(){this.inherited(arguments);this._attachTemplateNodes(this.domNode);
this._beforeFillContent()},_beforeFillContent:function(){},_attachTemplateNodes:function(a){for(var b=a;;)if(1==b.nodeType&&(this._processTemplateNode(b,function(a,b){return a.getAttribute(b)},this._attach)||this.searchContainerNode)&&b.firstChild)b=b.firstChild;else{if(b==a)break;for(;!b.nextSibling;)if(b=b.parentNode,b==a)return;b=b.nextSibling}},_processTemplateNode:function(a,c,d){var b=!0,g=this.attachScope||this,f=c(a,"dojoAttachPoint")||c(a,"data-dojo-attach-point");if(f)for(var h=f.split(/\s*,\s*/);f=
h.shift();)n.isArray(g[f])?g[f].push(a):g[f]=a,b="containerNode"!=f,this._attachPoints.push(f);if(c=c(a,"dojoAttachEvent")||c(a,"data-dojo-attach-event"))for(f=c.split(/\s*,\s*/),h=n.trim;c=f.shift();)if(c){var e=null;-1!=c.indexOf(":")?(e=c.split(":"),c=h(e[0]),e=h(e[1])):c=h(c);e||(e=c);this._attachEvents.push(d(a,c,n.hitch(g,e)))}return b},_attach:function(b,d,f){d=d.replace(/^on/,"").toLowerCase();d="dijitclick"==d?a||(a=k("./a11yclick")):c[d]||d;return h(b,d,f)},_detachTemplateNodes:function(){var a=
this.attachScope||this;e.forEach(this._attachPoints,function(b){delete a[b]});this._attachPoints=[];e.forEach(this._attachEvents,function(a){a.remove()});this._attachEvents=[]},destroyRendering:function(){this._detachTemplateNodes();this.inherited(arguments)}});n.extend(d,{dojoAttachEvent:"",dojoAttachPoint:""});return p})},"dijit/_WidgetsInTemplateMixin":function(){define(["dojo/_base/array","dojo/aspect","dojo/_base/declare","dojo/_base/lang","dojo/parser"],function(k,e,p,q,n){return p("dijit._WidgetsInTemplateMixin",
null,{_earlyTemplatedStartup:!1,contextRequire:null,_beforeFillContent:function(){if(/dojoType|data-dojo-type/i.test(this.domNode.innerHTML)){var e=this.domNode;this.containerNode&&!this.searchContainerNode&&(this.containerNode.stopParser=!0);n.parse(e,{noStart:!this._earlyTemplatedStartup,template:!0,inherited:{dir:this.dir,lang:this.lang,textDir:this.textDir},propsThis:this,contextRequire:this.contextRequire,scope:"dojo"}).then(q.hitch(this,function(h){this._startupWidgets=h;for(var f=0;f<h.length;f++)this._processTemplateNode(h[f],
function(d,c){return d[c]},function(d,c,a){return c in d?d.connect(d,c,a):d.on(c,a,!0)});this.containerNode&&this.containerNode.stopParser&&delete this.containerNode.stopParser}));if(!this._startupWidgets)throw Error(this.declaredClass+": parser returned unfilled promise (probably waiting for module auto-load), unsupported by _WidgetsInTemplateMixin.   Must pre-load all supporting widgets before instantiation.");}},_processTemplateNode:function(e,h,f){return h(e,"dojoType")||h(e,"data-dojo-type")?
!0:this.inherited(arguments)},startup:function(){k.forEach(this._startupWidgets,function(e){e&&!e._started&&e.startup&&e.startup()});this._startupWidgets=null;this.inherited(arguments)}})})},"dojo/parser":function(){define("require ./_base/kernel ./_base/lang ./_base/array ./_base/config ./dom ./_base/window ./_base/url ./aspect ./promise/all ./date/stamp ./Deferred ./has ./query ./on ./ready".split(" "),function(k,e,p,q,n,l,h,f,d,c,a,b,g,u,m,r){function t(a){return eval("("+a+")")}function v(a){var b=
a._nameCaseMap,c=a.prototype;if(!b||b._extendCnt<w){var b=a._nameCaseMap={},d;for(d in c)"_"!==d.charAt(0)&&(b[d.toLowerCase()]=d);b._extendCnt=w}return b}function y(a,b){b||(b=k);var c=b._dojoParserCtorMap||(b._dojoParserCtorMap={}),d=a.join();if(!c[d]){for(var g=[],m=0,f=a.length;m<f;m++){var h=a[m];g[g.length]=c[h]=c[h]||p.getObject(h)||~h.indexOf("/")&&b(h)}a=g.shift();c[d]=g.length?a.createSubclass?a.createSubclass(g):a.extend.apply(a,g):a}return c[d]}new Date("X");var w=0;d.after(p,"extend",
function(){w++},!0);var z={_clearCache:function(){w++;_ctorMap={}},_functionFromScript:function(a,b){var c="",d="",g=a.getAttribute(b+"args")||a.getAttribute("args");b=a.getAttribute("with");g=(g||"").split(/\s*,\s*/);b&&b.length&&q.forEach(b.split(/\s*,\s*/),function(a){c+="with("+a+"){";d+="}"});return new Function(g,c+a.innerHTML+d)},instantiate:function(a,b,c){b=b||{};c=c||{};var d=(c.scope||e._scopeName)+"Type",g="data-"+(c.scope||e._scopeName)+"-",m=g+"type",f=g+"mixins",h=[];q.forEach(a,function(a){var c=
d in b?b[d]:a.getAttribute(m)||a.getAttribute(d);if(c){var g=a.getAttribute(f),c=g?[c].concat(g.split(/\s*,\s*/)):[c];h.push({node:a,types:c})}});return this._instantiate(h,b,c)},_instantiate:function(a,b,d,g){function m(a){b._started||d.noStart||q.forEach(a,function(a){"function"!==typeof a.startup||a._started||a.startup()});return a}a=q.map(a,function(a){var c=a.ctor||y(a.types,d.contextRequire);if(!c)throw Error("Unable to resolve constructor for: '"+a.types.join()+"'");return this.construct(c,
a.node,b,d,a.scripts,a.inherited)},this);return g?c(a).then(m):m(a)},construct:function(b,c,h,r,l,n){function k(a){D&&p.setObject(D,a);for(C=0;C<W.length;C++)d[W[C].advice||"after"](a,W[C].method,p.hitch(a,W[C].func),!0);for(C=0;C<ca.length;C++)ca[C].call(a);for(C=0;C<ha.length;C++)a.watch(ha[C].prop,ha[C].func);for(C=0;C<fa.length;C++)m(a,fa[C].event,fa[C].func);return a}var w=b&&b.prototype;r=r||{};var z={};r.defaults&&p.mixin(z,r.defaults);n&&p.mixin(z,n);var y;g("dom-attributes-explicit")?y=c.attributes:
g("dom-attributes-specified-flag")?y=q.filter(c.attributes,function(a){return a.specified}):(n=(/^input$|^img$/i.test(c.nodeName)?c:c.cloneNode(!1)).outerHTML.replace(/=[^\s"']+|="[^"]*"|='[^']*'/g,"").replace(/^\s*<[a-zA-Z0-9]*\s*/,"").replace(/\s*>.*$/,""),y=q.map(n.split(/\s+/),function(a){var b=a.toLowerCase();return{name:a,value:"LI"==c.nodeName&&"value"==a||"enctype"==b?c.getAttribute(b):c.getAttributeNode(b).value}}));var x=r.scope||e._scopeName;n="data-"+x+"-";var B={};"dojo"!==x&&(B[n+"props"]=
"data-dojo-props",B[n+"type"]="data-dojo-type",B[n+"mixins"]="data-dojo-mixins",B[x+"type"]="dojotype",B[n+"id"]="data-dojo-id");for(var C=0,A,x=[],D,E;A=y[C++];){var Y=A.name,N=Y.toLowerCase();A=A.value;switch(B[N]||N){case "data-dojo-type":case "dojotype":case "data-dojo-mixins":break;case "data-dojo-props":E=A;break;case "data-dojo-id":case "jsid":D=A;break;case "data-dojo-attach-point":case "dojoattachpoint":z.dojoAttachPoint=A;break;case "data-dojo-attach-event":case "dojoattachevent":z.dojoAttachEvent=
A;break;case "class":z["class"]=c.className;break;case "style":z.style=c.style&&c.style.cssText;break;default:if(Y in w||(Y=v(b)[N]||Y),Y in w)switch(typeof w[Y]){case "string":z[Y]=A;break;case "number":z[Y]=A.length?Number(A):NaN;break;case "boolean":z[Y]="false"!=A.toLowerCase();break;case "function":""===A||-1!=A.search(/[^\w\.]+/i)?z[Y]=new Function(A):z[Y]=p.getObject(A,!1)||new Function(A);x.push(Y);break;default:N=w[Y],z[Y]=N&&"length"in N?A?A.split(/\s*,\s*/):[]:N instanceof Date?""==A?new Date(""):
"now"==A?new Date:a.fromISOString(A):N instanceof f?e.baseUrl+A:t(A)}else z[Y]=A}}for(y=0;y<x.length;y++)B=x[y].toLowerCase(),c.removeAttribute(B),c[B]=null;if(E)try{E=t.call(r.propsThis,"{"+E+"}"),p.mixin(z,E)}catch(Z){throw Error(Z.toString()+" in data-dojo-props\x3d'"+E+"'");}p.mixin(z,h);l||(l=b&&(b._noScript||w._noScript)?[]:u("\x3e script[type^\x3d'dojo/']",c));var W=[],ca=[],ha=[],fa=[];if(l)for(C=0;C<l.length;C++)B=l[C],c.removeChild(B),h=B.getAttribute(n+"event")||B.getAttribute("event"),
r=B.getAttribute(n+"prop"),E=B.getAttribute(n+"method"),x=B.getAttribute(n+"advice"),y=B.getAttribute("type"),B=this._functionFromScript(B,n),h?"dojo/connect"==y?W.push({method:h,func:B}):"dojo/on"==y?fa.push({event:h,func:B}):z[h]=B:"dojo/aspect"==y?W.push({method:E,advice:x,func:B}):"dojo/watch"==y?ha.push({prop:r,func:B}):ca.push(B);b=(l=b.markupFactory||w.markupFactory)?l(z,c,b):new b(z,c);return b.then?b.then(k):k(b)},scan:function(a,c){function d(a){if(!a.inherited){a.inherited={};var b=a.node,
c=d(a.parent),b={dir:b.getAttribute("dir")||c.dir,lang:b.getAttribute("lang")||c.lang,textDir:b.getAttribute(l)||c.textDir},g;for(g in b)b[g]&&(a.inherited[g]=b[g])}return a.inherited}var g=[],m=[],f={},h=(c.scope||e._scopeName)+"Type",r="data-"+(c.scope||e._scopeName)+"-",t=r+"type",l=r+"textdir",r=r+"mixins",n=a.firstChild,u=c.inherited;if(!u){var w=function(a,b){return a.getAttribute&&a.getAttribute(b)||a.parentNode&&w(a.parentNode,b)},u={dir:w(a,"dir"),lang:w(a,"lang"),textDir:w(a,l)},v;for(v in u)u[v]||
delete u[v]}v={inherited:u};for(var p,z;;)if(n)if(1!=n.nodeType)n=n.nextSibling;else if(p&&"script"==n.nodeName.toLowerCase())(u=n.getAttribute("type"))&&/^dojo\/\w/i.test(u)&&p.push(n),n=n.nextSibling;else if(z)n=n.nextSibling;else if(u=n.getAttribute(t)||n.getAttribute(h),a=n.firstChild,u||a&&(3!=a.nodeType||a.nextSibling)){z=null;if(u){var x=n.getAttribute(r);p=x?[u].concat(x.split(/\s*,\s*/)):[u];try{z=y(p,c.contextRequire)}catch(W){}z||q.forEach(p,function(a){~a.indexOf("/")&&!f[a]&&(f[a]=!0,
m[m.length]=a)});x=z&&!z.prototype._noScript?[]:null;v={types:p,ctor:z,parent:v,node:n,scripts:x};v.inherited=d(v);g.push(v)}else v={node:n,scripts:p,parent:v};p=x;z=n.stopParser||z&&z.prototype.stopParser&&!c.template;n=a}else n=n.nextSibling;else{if(!v||!v.node)break;n=v.node.nextSibling;z=!1;v=v.parent;p=v.scripts}var A=new b;m.length?(c.contextRequire||k)(m,function(){A.resolve(q.filter(g,function(a){if(!a.ctor)try{a.ctor=y(a.types,c.contextRequire)}catch(fa){}for(var b=a.parent;b&&!b.types;)b=
b.parent;var d=a.ctor&&a.ctor.prototype;a.instantiateChildren=!(d&&d.stopParser&&!c.template);a.instantiate=!b||b.instantiate&&b.instantiateChildren;return a.instantiate}))}):A.resolve(g);return A.promise},_require:function(a,c){a=t("{"+a.innerHTML+"}");var d=[],g=[],m=new b;c=c&&c.contextRequire||k;for(var f in a)d.push(f),g.push(a[f]);c(g,function(){for(var a=0;a<d.length;a++)p.setObject(d[a],arguments[a]);m.resolve(arguments)});return m.promise},_scanAmd:function(a,c){var d=new b,g=d.promise;d.resolve(!0);
var m=this;u("script[type\x3d'dojo/require']",a).forEach(function(a){g=g.then(function(){return m._require(a,c)});a.parentNode.removeChild(a)});return g},parse:function(a,b){!a||"string"==typeof a||"nodeType"in a||(b=a,a=b.rootNode);var c=a?l.byId(a):h.body();b=b||{};var d=b.template?{template:!0}:{},g=[],m=this;a=this._scanAmd(c,b).then(function(){return m.scan(c,b)}).then(function(a){return m._instantiate(a,d,b,!0)}).then(function(a){return g=g.concat(a)}).otherwise(function(a){console.error("dojo/parser::parse() error",
a);throw a;});p.mixin(g,a);return g}};e.parser=z;n.parseOnLoad&&r(100,z,"parse");return z})},"dojo/date/stamp":function(){define(["../_base/lang","../_base/array"],function(k,e){var p={};k.setObject("dojo.date.stamp",p);p.fromISOString=function(k,n){p._isoRegExp||(p._isoRegExp=/^(?:(\d{4})(?:-(\d{2})(?:-(\d{2}))?)?)?(?:T(\d{2}):(\d{2})(?::(\d{2})(.\d+)?)?((?:[+-](\d{2}):(\d{2}))|Z)?)?$/);var l=p._isoRegExp.exec(k);k=null;if(l){l.shift();l[1]&&l[1]--;l[6]&&(l[6]*=1E3);n&&(n=new Date(n),e.forEach(e.map("FullYear Month Date Hours Minutes Seconds Milliseconds".split(" "),
function(d){return n["get"+d]()}),function(d,c){l[c]=l[c]||d}));k=new Date(l[0]||1970,l[1]||0,l[2]||1,l[3]||0,l[4]||0,l[5]||0,l[6]||0);100>l[0]&&k.setFullYear(l[0]||1970);var h=0,f=l[7]&&l[7].charAt(0);"Z"!=f&&(h=60*(l[8]||0)+(Number(l[9])||0),"-"!=f&&(h*=-1));f&&(h-=k.getTimezoneOffset());h&&k.setTime(k.getTime()+6E4*h)}return k};p.toISOString=function(e,n){var l=function(c){return 10>c?"0"+c:c};n=n||{};var h=[],f=n.zulu?"getUTC":"get",d="";"time"!=n.selector&&(d=e[f+"FullYear"](),d=["0000".substr((d+
"").length)+d,l(e[f+"Month"]()+1),l(e[f+"Date"]())].join("-"));h.push(d);"date"!=n.selector&&(d=[l(e[f+"Hours"]()),l(e[f+"Minutes"]()),l(e[f+"Seconds"]())].join(":"),f=e[f+"Milliseconds"](),n.milliseconds&&(d+="."+(100>f?"0":"")+l(f)),n.zulu?d+="Z":"time"!=n.selector&&(e=e.getTimezoneOffset(),n=Math.abs(e),d+=(0<e?"-":"+")+l(Math.floor(n/60))+":"+l(n%60)),h.push(d));return h.join("T")};return p})},"esri/dijit/_EventedWidget":function(){define("dojo/_base/declare dojo/_base/lang dojo/aspect dojo/on ../Evented dijit/_WidgetBase".split(" "),
function(k,e,p,q,n,l){return k([l,n],{_onMap:function(h){var f=this.constructor._onMap,d;f&&f.FINAL||(delete this.constructor._onMap,f=this.registerConnectEvents(),f.FINAL=!0);h=h.toLowerCase();f[h]?d=this[f[h].method]:(h=this._onCamelCase(h),this[h]&&(d=h));return d},on:function(h,f){var d=this._onMap(h),c=h.replace(/\-/g,""),a="on"+c in this.domNode;return d||!a?this.inherited(arguments):this.own(q(this.domNode,c,f))[0]},emit:function(h,f,d){var c,a,b,g=h.toLowerCase(),l=this.constructor._onMap||
this.registerConnectEvents();a=this[this._onMap(g)];f=f||{};f.target||(f.target=this);a&&l&&l[g]&&(this._onObj2Arr(function(){c=Array.prototype.slice.call(arguments)},l[g].argKeys)(f),b=e.mixin({},arguments),b[2]=c,b[0]=l[g].name.replace(/^on/,""));return this.inherited(b||arguments)}})})},"esri/tasks/GeometryService":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/json dojo/_base/Deferred dojo/has ../kernel ../request ../deferredUtils ./Task ../geometry/Extent ../geometry/Polyline ../geometry/Polygon ../geometry/Multipoint ../geometry/jsonUtils".split(" "),
function(k,e,p,q,n,l,h,f,d,c,a,b,g,u,m){k=k(c,{declaredClass:"esri.tasks.GeometryService",_eventMap:{"areas-and-lengths-complete":["result"],"auto-complete-complete":["geometries"],"buffer-complete":["geometries"],"convex-hull-complete":["geometry"],"cut-complete":["result"],"densify-complete":["geometries"],"difference-complete":["geometries"],"distance-complete":["distance"],"generalize-complete":["geometries"],"intersect-complete":["geometries"],"label-points-complete":["geometries"],"lengths-complete":["result"],
"offset-complete":["geometries"],"project-complete":["geometries"],"relation-complete":["relations"],"reshape-complete":["geometry"],"simplify-complete":["geometries"],"trim-extend-complete":["geometries"],"union-complete":["geometry"]},constructor:function(a){a=e.hitch;this._projectHandler=a(this,this._projectHandler);this._simplifyHandler=a(this,this._simplifyHandler);this._bufferHandler=a(this,this._bufferHandler);this._areasAndLengthsHandler=a(this,this._areasAndLengthsHandler);this._lengthsHandler=
a(this,this._lengthsHandler);this._labelPointsHandler=a(this,this._labelPointsHandler);this._relationHandler=a(this,this._relationHandler);this._convexHullHandler=a(this,this._convexHullHandler);this._unionHandler=a(this,this._unionHandler);this._autoCompleteHandler=a(this,this._autoCompleteHandler);this._reshapeHandler=a(this,this._reshapeHandler);this._cutHandler=a(this,this._cutHandler);this._intersectHandler=a(this,this._intersectHandler);this._differenceHandler=a(this,this._differenceHandler);
this._trimExtendHandler=a(this,this._trimExtendHandler);this._densifyHandler=a(this,this._densifyHandler);this._generalizeHandler=a(this,this._densifyHandler);this._offsetHandler=a(this,this._offsetHandler);this._distanceHandler=a(this,this._distanceHandler);this._toGeoCoordinateHandler=a(this,this._toGeoCoordinateHandler);this._fromGeoCoordinateHandler=a(this,this._fromGeoCoordinateHandler);this.registerConnectEvents()},_encodeGeometries:function(a){var b=[],c,d=a.length;for(c=0;c<d;c++)b.push(a[c].toJson());
return{geometryType:m.getJsonType(a[0]),geometries:b}},_decodeGeometries:function(a,b,c){var d=m.getGeometryType(b);a=a.geometries;var g=[],f={spatialReference:c.toJson()},h=e.mixin;p.forEach(a,function(a,b){g[b]=new d(h(a,f))});return g},_toProjectGeometry:function(c){var d=c.spatialReference.toJson();return c instanceof a?new g({rings:[[[c.xmin,c.ymin],[c.xmin,c.ymax],[c.xmax,c.ymax],[c.xmax,c.ymin],[c.xmin,c.ymin]]],spatialReference:d}):new b({paths:[[].concat(c.points)],spatialReference:d})},
_fromProjectedGeometry:function(b,c,d){return"esriGeometryEnvelope"===c?(b=b.rings[0],new a(b[0][0],b[0][1],b[2][0],b[2][1],d)):new u({points:b.paths[0],spatialReference:d.toJson()})},project:function(a,b,c,g){var h=e.mixin({},this._url.query,{f:"json"}),r;a.geometries?(g=c,c=b,b=a.outSR,r=a.geometries[0],h=e.mixin(h,a.toJson())):(r=a[0],h=e.mixin(h,{outSR:b.wkid||q.toJson(b.toJson()),inSR:r.spatialReference.wkid||q.toJson(r.spatialReference.toJson()),geometries:q.toJson(this._encodeGeometries(a))}));
var t=m.getJsonType(r),l=this._projectHandler,u=this._errorHandler,k=new n(d._dfdCanceller);k._pendingDfd=f({url:this._url.path+"/project",content:h,callbackParamName:"callback",load:function(a,d){l(a,d,t,b,c,g,k)},error:function(a){u(a,g,k)}});return k},_projectHandler:function(a,b,c,d,g,m,f){try{var h=this._decodeGeometries(a,c,d);this._successHandler([h],"onProjectComplete",g,f)}catch(C){this._errorHandler(C,m,f)}},onProjectComplete:function(){},simplify:function(a,b,c){var g=a[0].spatialReference,
h=e.mixin({},this._url.query,{f:"json",sr:g.wkid?g.wkid:q.toJson(g.toJson()),geometries:q.toJson(this._encodeGeometries(a))}),r=m.getJsonType(a[0]),t=this._simplifyHandler,l=this._errorHandler,u=new n(d._dfdCanceller);u._pendingDfd=f({url:this._url.path+"/simplify",content:h,callbackParamName:"callback",load:function(a,d){t(a,d,r,g,b,c,u)},error:function(a){l(a,c,u)}});return u},_simplifyHandler:function(a,b,c,d,g,m,f){try{var h=this._decodeGeometries(a,c,d);this._successHandler([h],"onSimplifyComplete",
g,f)}catch(C){this._errorHandler(C,m,f)}},onSimplifyComplete:function(){},convexHull:function(a,b,c){var g=a[0].spatialReference;a=e.mixin({},this._url.query,{f:"json",sr:q.toJson(g.toJson()),geometries:q.toJson(this._encodeGeometries(a))});var m=this._convexHullHandler,h=this._errorHandler,r=new n(d._dfdCanceller);r._pendingDfd=f({url:this._url.path+"/convexHull",content:a,callbackParamName:"callback",load:function(a,d){m(a,d,g,b,c,r)},error:function(a){h(a,c,r)}});return r},_convexHullHandler:function(a,
b,c,d,g,f){try{var h=m.fromJson(a.geometry).setSpatialReference(c);this._successHandler([h],"onConvexHullComplete",d,f)}catch(A){this._errorHandler(A,g,f)}},onConvexHullComplete:function(){},union:function(a,b,c){var g=a[0].spatialReference;a=e.mixin({},this._url.query,{f:"json",sr:q.toJson(g.toJson()),geometries:q.toJson(this._encodeGeometries(a))});var m=this._unionHandler,h=this._errorHandler,r=new n(d._dfdCanceller);r._pendingDfd=f({url:this._url.path+"/union",content:a,callbackParamName:"callback",
load:function(a,d){m(a,d,g,b,c,r)},error:function(a){h(a,c,r)}});return r},_unionHandler:function(a,b,c,d,g,f){try{var h=m.fromJson(a.geometry).setSpatialReference(c);this._successHandler([h],"onUnionComplete",d,f)}catch(A){this._errorHandler(A,g,f)}},onUnionComplete:function(){},autoComplete:function(a,b,c,g){var m=a[0].spatialReference;a=e.mixin({},this._url.query,{f:"json",sr:q.toJson(m.toJson()),polygons:q.toJson(this._encodeGeometries(a).geometries),polylines:q.toJson(this._encodeGeometries(b).geometries)});
var h=this._autoCompleteHandler,r=this._errorHandler,t=new n(d._dfdCanceller);t._pendingDfd=f({url:this._url.path+"/autoComplete",content:a,callbackParamName:"callback",load:function(a,b){h(a,b,m,c,g,t)},error:function(a){r(a,g,t)}});return t},_autoCompleteHandler:function(a,b,c,d,m,f){try{var h=a.geometries;a=[];var e,r=h.length;for(e=0;e<r;e++)a[e]=new g({spatialReference:c,rings:h[e].rings});this._successHandler([a],"onAutoCompleteComplete",d,f)}catch(B){this._errorHandler(B,m,f)}},onAutoCompleteComplete:function(){},
reshape:function(a,b,c,g){var h=a.spatialReference;a=e.mixin({},this._url.query,{f:"json",sr:q.toJson(h.toJson()),target:q.toJson({geometryType:m.getJsonType(a),geometry:a.toJson()}),reshaper:q.toJson(b.toJson())});var r=this._reshapeHandler,t=this._errorHandler,l=new n(d._dfdCanceller);l._pendingDfd=f({url:this._url.path+"/reshape",content:a,callbackParamName:"callback",load:function(a,b){r(a,b,h,c,g,l)},error:function(a){t(a,g,l)}});return l},_reshapeHandler:function(a,b,c,d,g,f){try{var h=m.fromJson(a.geometry).setSpatialReference(c);
this._successHandler([h],"onReshapeComplete",d,f)}catch(A){this._errorHandler(A,g,f)}},onReshapeComplete:function(){},cut:function(a,b,c,g){var h=a[0].spatialReference,r=p.map(a,function(a){return a.toJson()});a=e.mixin({},this._url.query,{f:"json",sr:q.toJson(h.toJson()),target:q.toJson({geometryType:m.getJsonType(a[0]),geometries:r}),cutter:q.toJson(b.toJson())});var t=this._cutHandler,l=this._errorHandler,u=new n(d._dfdCanceller);u._pendingDfd=f({url:this._url.path+"/cut",content:a,callbackParamName:"callback",
load:function(a,b){t(a,b,h,c,g,u)},error:function(a){l(a,g,u)}});return u},_cutHandler:function(a,b,c,d,g,f){try{var h=a.geometries,e={};e.cutIndexes=a.cutIndexes;e.geometries=[];p.forEach(h,function(a){e.geometries.push(m.fromJson(a).setSpatialReference(c))});this._successHandler([e],"onCutComplete",d,f)}catch(C){this._errorHandler(C,g,f)}},onCutComplete:function(){},intersect:function(a,b,c,g){var h=a[0].spatialReference;a=e.mixin({},this._url.query,{f:"json",sr:q.toJson(h.toJson()),geometries:q.toJson(this._encodeGeometries(a)),
geometry:q.toJson({geometryType:m.getJsonType(b),geometry:b.toJson()})});var r=this._intersectHandler,t=this._errorHandler,l=new n(d._dfdCanceller);l._pendingDfd=f({url:this._url.path+"/intersect",content:a,callbackParamName:"callback",load:function(a,b){r(a,b,h,c,g,l)},error:function(a){t(a,g,l)}});return l},_intersectHandler:function(a,b,c,d,g,f){try{var h=[];p.forEach(a.geometries,function(a){h.push(m.fromJson(a).setSpatialReference(c))});this._successHandler([h],"onIntersectComplete",d,f)}catch(A){this._errorHandler(A,
g,f)}},onIntersectComplete:function(){},difference:function(a,b,c,g){var h=a[0].spatialReference;a=e.mixin({},this._url.query,{f:"json",sr:q.toJson(h.toJson()),geometries:q.toJson(this._encodeGeometries(a)),geometry:q.toJson({geometryType:m.getJsonType(b),geometry:b.toJson()})});var r=this._differenceHandler,t=this._errorHandler,l=new n(d._dfdCanceller);l._pendingDfd=f({url:this._url.path+"/difference",content:a,callbackParamName:"callback",load:function(a,b){r(a,b,h,c,g,l)},error:function(a){t(a,
g,l)}});return l},_differenceHandler:function(a,b,c,d,g,f){try{var h=[];p.forEach(a.geometries,function(a){h.push(m.fromJson(a).setSpatialReference(c))});this._successHandler([h],"onDifferenceComplete",d,f)}catch(A){this._errorHandler(A,g,f)}},onDifferenceComplete:function(){},buffer:function(a,b,c){var g=e.mixin({},this._url.query,{f:"json"},a.toJson()),m=a.outSpatialReference||a.geometries[0].spatialReference,h=this._bufferHandler,r=this._errorHandler,t=new n(d._dfdCanceller);t._pendingDfd=f({url:this._url.path+
"/buffer",content:g,callbackParamName:"callback",load:function(a,d){h(a,d,m,b,c,t)},error:function(a){r(a,c,t)}});return t},_bufferHandler:function(a,b,c,d,m,f){try{var h=a.geometries;a=[];var e,r=h.length;for(e=0;e<r;e++)a[e]=new g({spatialReference:c,rings:h[e].rings});this._successHandler([a],"onBufferComplete",d,f)}catch(B){this._errorHandler(B,m,f)}},onBufferComplete:function(){},areasAndLengths:function(a,b,c){a=e.mixin({},this._url.query,{f:"json"},a.toJson());var g=this._areasAndLengthsHandler,
m=this._errorHandler,h=new n(d._dfdCanceller);h._pendingDfd=f({url:this._url.path+"/areasAndLengths",content:a,callbackParamName:"callback",load:function(a,d){g(a,d,b,c,h)},error:function(a){m(a,c,h)}});return h},_areasAndLengthsHandler:function(a,b,c,d,g){try{this._successHandler([a],"onAreasAndLengthsComplete",c,g)}catch(z){this._errorHandler(z,d,g)}},onAreasAndLengthsComplete:function(){},lengths:function(a,b,c){a=e.mixin({},this._url.query,{f:"json"},a.toJson());var g=this._lengthsHandler,m=this._errorHandler,
h=new n(d._dfdCanceller);h._pendingDfd=f({url:this._url.path+"/lengths",content:a,callbackParamName:"callback",load:function(a,d){g(a,d,b,c,h)},error:function(a){m(a,c,h)}});return h},_lengthsHandler:function(a,b,c,d,g){try{this._successHandler([a],"onLengthsComplete",c,g)}catch(z){this._errorHandler(z,d,g)}},onLengthsComplete:function(){},labelPoints:function(a,b,c){var g=p.map(a,function(a){return a.toJson()}),m=a[0].spatialReference,g=e.mixin({},this._url.query,{f:"json",sr:m.wkid?m.wkid:q.toJson(m.toJson()),
polygons:q.toJson(g)}),h=this._labelPointsHandler,r=this._errorHandler,l=new n(d._dfdCanceller);l._pendingDfd=f({url:this._url.path+"/labelPoints",content:g,callbackParamName:"callback",load:function(d,g){h(d,g,a,m,b,c,l)},error:function(a){r(a,c,l)}});return l},_labelPointsHandler:function(a,b,c,d,g,f,h){try{var e=[];p.forEach(a.labelPoints,function(a){e.push(m.fromJson(a).setSpatialReference(d))});this._successHandler([e],"onLabelPointsComplete",g,h)}catch(C){this._errorHandler(C,f,h)}},onLabelPointsComplete:function(){},
relation:function(a,b,c){a=e.mixin({},this._url.query,{f:"json"},a.toJson());var g=this._relationHandler,m=this._errorHandler,h=new n(d._dfdCanceller);h._pendingDfd=f({url:this._url.path+"/relation",content:a,callbackParamName:"callback",load:function(a,d){g(a,d,b,c,h)},error:function(a){m(a,c,h)}});return h},_relationHandler:function(a,b,c,d,g){try{this._successHandler([a.relations],"onRelationComplete",c,g)}catch(z){this._errorHandler(z,d,g)}},onRelationComplete:function(){},trimExtend:function(a,
b,c){var g=e.mixin({},this._url.query,{f:"json"},a.toJson()),m=a.sr,h=this._trimExtendHandler,r=this._errorHandler,l=new n(d._dfdCanceller);l._pendingDfd=f({url:this._url.path+"/trimExtend",content:g,callbackParamName:"callback",load:function(a,d){h(a,d,m,b,c,l)},error:function(a){r(a,c,l)}});return l},_trimExtendHandler:function(a,c,d,g,m,f){try{var h=a.geometries;a=[];var e,r=h.length;for(e=0;e<r;e++)a[e]=new b({spatialReference:d,paths:h[e].paths});this._successHandler([a],"onTrimExtendComplete",
g,f)}catch(B){this._errorHandler(B,m,f)}},onTrimExtendComplete:function(){},densify:function(a,b,c){var g=e.mixin({},this._url.query,{f:"json"},a.toJson()),m=a.geometries[0].spatialReference,h=this._densifyHandler,r=this._errorHandler,l=new n(d._dfdCanceller);l._pendingDfd=f({url:this._url.path+"/densify",content:g,callbackParamName:"callback",load:function(a,d){h(a,d,m,b,c,l)},error:function(a){r(a,c,l)}});return l},_densifyHandler:function(a,b,c,d,g,f){try{var h=[];p.forEach(a.geometries,function(a){h.push(m.fromJson(a).setSpatialReference(c))});
this._successHandler([h],"onDensifyComplete",d,f)}catch(A){this._errorHandler(A,g,f)}},onDensifyComplete:function(){},generalize:function(a,b,c){var g=e.mixin({},this._url.query,{f:"json"},a.toJson()),m=a.geometries[0].spatialReference,h=this._generalizeHandler,r=this._errorHandler,l=new n(d._dfdCanceller);l._pendingDfd=f({url:this._url.path+"/generalize",content:g,callbackParamName:"callback",load:function(a,d){h(a,d,m,b,c,l)},error:function(a){r(a,c,l)}});return l},_generalizeHandler:function(a,
b,c,d,g,f){try{var h=[];p.forEach(a.geometries,function(a){h.push(m.fromJson(a).setSpatialReference(c))});this._successHandler([h],"onGeneralizeComplete",d,f)}catch(A){this._errorHandler(A,g,f)}},onGeneralizeComplete:function(){},offset:function(a,b,c){var g=e.mixin({},this._url.query,{f:"json"},a.toJson()),m=a.geometries[0].spatialReference,h=this._offsetHandler,r=this._errorHandler,l=new n(d._dfdCanceller);l._pendingDfd=f({url:this._url.path+"/offset",content:g,callbackParamName:"callback",load:function(a,
d){h(a,d,m,b,c,l)},error:function(a){r(a,c,l)}});return l},_offsetHandler:function(a,b,c,d,g,f){try{var h=[];p.forEach(a.geometries,function(a){h.push(m.fromJson(a).setSpatialReference(c))});this._successHandler([h],"onOffsetComplete",d,f)}catch(A){this._errorHandler(A,g,f)}},onOffsetComplete:function(){},distance:function(a,b,c){var g=e.mixin({},this._url.query,{f:"json"},a.toJson()),m=a.geometry1.spatialReference,h=this._distanceHandler,r=this._errorHandler,l=new n(d._dfdCanceller);l._pendingDfd=
f({url:this._url.path+"/distance",content:g,callbackParamName:"callback",load:function(a,d){h(a,d,m,b,c,l)},error:function(a){r(a,c,l)}});return l},_distanceHandler:function(a,b,c,d,g,m){try{a=a&&a.distance,this._successHandler([a],"onDistanceComplete",d,m)}catch(x){this._errorHandler(x,g,m)}},onDistanceComplete:function(){},toGeoCoordinateString:function(a,b,c){var g={};e.isObject(a.sr)?g.sr=a.sr.wkid||q.toJson(a.sr.toJson()):g.sr=a.sr;g.coordinates=q.toJson(a.coordinates);g.conversionType=a.conversionType||
"MGRS";g.conversionMode=a.conversionMode;g.numOfDigits=a.numOfDigits;g.rounding=a.rounding;g.addSpaces=a.addSpaces;a=e.mixin({},this._url.query,{f:"json"},g);var m=this._toGeoCoordinateHandler,h=this._errorHandler,r=new n(d._dfdCanceller);r._pendingDfd=f({url:this._url.path+"/toGeoCoordinateString",content:a,callbackParamName:"callback",load:function(a,d){m(a,d,b,c,r)},error:function(a){h(a,c,r)}});return r},_toGeoCoordinateHandler:function(a,b,c,d,g){try{this._successHandler([a.strings],"onToGeoCoordinateStringComplete",
c,g)}catch(z){this._errorHandler(z,d,g)}},onToGeoCoordinateStringComplete:function(){},fromGeoCoordinateString:function(a,b,c){var g={};e.isObject(a.sr)?g.sr=a.sr.wkid||q.toJson(a.sr.toJson()):g.sr=a.sr;g.strings=q.toJson(a.strings);g.conversionType=a.conversionType||"MGRS";g.conversionMode=a.conversionMode;a=e.mixin({},this._url.query,{f:"json"},g);var m=this._fromGeoCoordinateHandler,h=this._errorHandler,r=new n(d._dfdCanceller);r._pendingDfd=f({url:this._url.path+"/fromGeoCoordinateString",content:a,
callbackParamName:"callback",load:function(a,d){m(a,d,b,c,r)},error:function(a){h(a,c,r)}});return r},_fromGeoCoordinateHandler:function(a,b,c,d,g){try{this._successHandler([a.coordinates],"onToGeoCoordinateStringComplete",c,g)}catch(z){this._errorHandler(z,d,g)}},onFromGeoCoordinateStringComplete:function(){}});e.mixin(k,{UNIT_METER:9001,UNIT_GERMAN_METER:9031,UNIT_FOOT:9002,UNIT_SURVEY_FOOT:9003,UNIT_CLARKE_FOOT:9005,UNIT_FATHOM:9014,UNIT_NAUTICAL_MILE:9030,UNIT_SURVEY_CHAIN:9033,UNIT_SURVEY_LINK:9034,
UNIT_SURVEY_MILE:9035,UNIT_KILOMETER:9036,UNIT_CLARKE_YARD:9037,UNIT_CLARKE_CHAIN:9038,UNIT_CLARKE_LINK:9039,UNIT_SEARS_YARD:9040,UNIT_SEARS_FOOT:9041,UNIT_SEARS_CHAIN:9042,UNIT_SEARS_LINK:9043,UNIT_BENOIT_1895A_YARD:9050,UNIT_BENOIT_1895A_FOOT:9051,UNIT_BENOIT_1895A_CHAIN:9052,UNIT_BENOIT_1895A_LINK:9053,UNIT_BENOIT_1895B_YARD:9060,UNIT_BENOIT_1895B_FOOT:9061,UNIT_BENOIT_1895B_CHAIN:9062,UNIT_BENOIT_1895B_LINK:9063,UNIT_INDIAN_FOOT:9080,UNIT_INDIAN_1937_FOOT:9081,UNIT_INDIAN_1962_FOOT:9082,UNIT_INDIAN_1975_FOOT:9083,
UNIT_INDIAN_YARD:9084,UNIT_INDIAN_1937_YARD:9085,UNIT_INDIAN_1962_YARD:9086,UNIT_INDIAN_1975_YARD:9087,UNIT_FOOT_1865:9070,UNIT_RADIAN:9101,UNIT_DEGREE:9102,UNIT_ARCMINUTE:9103,UNIT_ARCSECOND:9104,UNIT_GRAD:9105,UNIT_GON:9106,UNIT_MICRORADIAN:9109,UNIT_ARCMINUTE_CENTESIMAL:9112,UNIT_ARCSECOND_CENTESIMAL:9113,UNIT_MIL6400:9114,UNIT_BRITISH_1936_FOOT:9095,UNIT_GOLDCOAST_FOOT:9094,UNIT_INTERNATIONAL_CHAIN:109003,UNIT_INTERNATIONAL_LINK:109004,UNIT_INTERNATIONAL_YARD:109001,UNIT_STATUTE_MILE:9093,UNIT_SURVEY_YARD:109002,
UNIT_50KILOMETER_LENGTH:109030,UNIT_150KILOMETER_LENGTH:109031,UNIT_DECIMETER:109005,UNIT_CENTIMETER:109006,UNIT_MILLIMETER:109007,UNIT_INTERNATIONAL_INCH:109008,UNIT_US_SURVEY_INCH:109009,UNIT_INTERNATIONAL_ROD:109010,UNIT_US_SURVEY_ROD:109011,UNIT_US_NAUTICAL_MILE:109012,UNIT_UK_NAUTICAL_MILE:109013,UNIT_SQUARE_INCHES:"esriSquareInches",UNIT_SQUARE_FEET:"esriSquareFeet",UNIT_SQUARE_YARDS:"esriSquareYards",UNIT_ACRES:"esriAcres",UNIT_SQUARE_MILES:"esriSquareMiles",UNIT_SQUARE_MILLIMETERS:"esriSquareMillimeters",
UNIT_SQUARE_CENTIMETERS:"esriSquareCentimeters",UNIT_SQUARE_DECIMETERS:"esriSquareDecimeters",UNIT_SQUARE_METERS:"esriSquareMeters",UNIT_ARES:"esriAres",UNIT_HECTARES:"esriHectares",UNIT_SQUARE_KILOMETERS:"esriSquareKilometers"});return k})},"esri/layers/FeatureLayer":function(){define("require module dojo/_base/declare dojo/_base/connect dojo/_base/lang dojo/_base/array dojo/_base/json dojo/_base/Deferred dojo/date/locale dojo/sniff dojo/io-query dojo/dom-construct dojo/i18n dojo/when dojo/promise/all ../kernel ../lang ../request ../config ../deferredUtils ../promiseList ../SpatialReference ../symbols/SimpleMarkerSymbol ../symbols/SimpleLineSymbol ../symbols/SimpleFillSymbol ../symbols/jsonUtils ../renderers/SimpleRenderer ../renderers/UniqueValueRenderer ../renderers/jsonUtils ../support/expressionUtils ../tasks/QueryTask ../tasks/query ../tasks/FeatureSet ../tasks/StatisticDefinition ../geometry/Extent ../geometry/jsonUtils ../geometry/normalizeUtils ../geometry/scaleUtils ./GraphicsLayer ./Field ./TimeInfo ./FeatureType ./FeatureTemplate ./FeatureEditResult ./LabelClass ./SnapshotMode ./OnDemandMode ./SelectionMode ./StreamMode ./TrackManager ./HeatmapManager ./clustering/ClusterManager dojo/i18n!../nls/jsapi require".split(" "),
function(k,e,p,q,n,l,h,f,d,c,a,b,g,u,m,r,t,v,y,w,z,x,A,C,B,E,D,F,I,M,L,J,P,K,U,O,S,Y,N,W,ca,ha,fa,Z,G,ia,sa,wa,ua,ma,ja,va,la){var na=y.defaults,aa=p(N,{declaredClass:"esri.layers.FeatureLayer",invalidParams:"query contains one or more unsupported parameters",reHostedFS:/(https?:)?\/\/services.*\.arcgis\.com/i,maxPointCountForAuto:4E3,maxRecordCountForAuto:2E3,maxVertexCountForAuto:25E4,generalizeForScale:4E3,_eventMap:{"add-attachment-complete":["result"],"before-apply-edits":["adds","updates","deletes"],
"delete-attachments-complete":["results"],"edits-complete":["adds","updates","deletes"],"query-attachment-infos-complete":["results"],"query-count-complete":["count"],"query-features-complete":["featureSet"],"query-ids-complete":["objectIds"],"query-related-features-complete":["featureSets"],"selection-complete":["features","method"],"update-end":["error","info"]},constructor:function(a,b){this._preventInit||this._initFeatureLayer(a,b)},_initFeatureLayer:function(a,b){this.i18n=la;b=b||{};this._featureReduction=
this._featureReduction||b.featureReduction;this._featureReductionEnabled=null!=b.featureReductionEnabled?b.featureReductionEnabled:!0;this.showLabels=null!=b.showLabels?b.showLabels:!0;this._outFields=b.outFields;this._defnExpr=b.definitionExpression;this._loadCallback=b.loadCallback;this._trackIdField=b.trackIdField;this.objectIdField=b.objectIdField;this._maxOffset=null!=b.maxAllowableOffset?b.maxAllowableOffset:this.maxAllowableOffset;this.quantize=null!=b.quantize?b.quantize:!0;this._optEditable=
b.editable;this._optAutoGen=b.autoGeneralize;this.editSummaryCallback=b.editSummaryCallback;this.userId=b.userId;this.userIsAdmin=b.userIsAdmin;this.useMapTime=b.hasOwnProperty("useMapTime")?!!b.useMapTime:!0;this.source=b.source;this.gdbVersion=b.gdbVersion;this.orderByFields=b.orderByFields;this.maxPointCountForAuto=null!=b.maxPointCountForAuto?b.maxPointCountForAuto:this.maxPointCountForAuto;this.maxRecordCountForAuto=null!=b.maxRecordCountForAuto?b.maxRecordCountForAuto:this.maxRecordCountForAuto;
this.maxVertexCountForAuto=null!=b.maxVertexCountForAuto?b.maxVertexCountForAuto:this.maxVertexCountForAuto;this.generalizeForScale=null!=b.generalizeForScale?b.generalizeForScale:this.generalizeForScale;this.queryPagination=this._optQueryPagination=null!=b.queryPagination?b.queryPagination:!0;this.multipatchOption=b.multipatchOption;this._selectedFeatures={};this._selectedFeaturesArr=[];this._newFeatures=[];this._deletedFeatures={};this._ulid=this._getUniqueId();var c=t.isDefined(b.mode)?b.mode:
aa.MODE_ONDEMAND;this._isStream&&(c=aa.MODE_STREAM);this.mode=c;switch(c){case aa.MODE_SNAPSHOT:this.currentMode=aa.MODE_SNAPSHOT;this._mode=new ia(this);break;case aa.MODE_ONDEMAND:case aa.MODE_AUTO:this.currentMode=aa.MODE_ONDEMAND;this._tileWidth=b.tileWidth||512;this._tileHeight=b.tileHeight||512;this._mode=new sa(this);this.latticeTiling=b.latticeTiling;break;case aa.MODE_SELECTION:this.currentMode=aa.MODE_SELECTION;this._mode=new wa(this);this._isSelOnly=!0;break;case aa.MODE_STREAM:this.currentMode=
aa.MODE_STREAM,this._mode=new ua(this),this._isStream=!0}this._initLayer=n.hitch(this,this._initLayer);this._selectHandler=n.hitch(this,this._selectHandler);this._editable=!1;if(n.isObject(a)&&a.layerDefinition)return this._collection=!0,this.mode=this._isStream?aa.MODE_STREAM:aa.MODE_SNAPSHOT,this._isStream||this._outFields||(this._outFields=["*"]),this._initLayer(a),this;this._task=new L(this.url,{source:this.source,gdbVersion:this.gdbVersion});a=this._url.path;this._fserver=!1;-1!==a.search(/\/FeatureServer\//i)&&
(this._fserver=!0);this.mode===aa.MODE_AUTO&&this.reHostedFS.test(this.url)&&this._queryLimit();(b=b.resourceInfo)?this._initLayer(b):(this.source&&(b={source:this.source.toJson()},this._url.query=n.mixin(this._url.query,{layer:h.toJson(b)})),this.gdbVersion&&(this._url.query=n.mixin(this._url.query,{gdbVersion:this.gdbVersion})),v({url:a,content:n.mixin({f:"json"},this._url.query),callbackParamName:"callback",load:this._initLayer,error:this._errorHandler}));this.registerConnectEvents()},_initLayer:function(a,
b){if(a||b){this._json=a;this._findCredential();if(this.credential&&this.credential.ssl||a&&a._ssl)this._useSSL(),this._task._useSSL();this.version=a.currentVersion;this.version||(this.version="capabilities"in a||"drawingInfo"in a||"hasAttachments"in a||"htmlPopupType"in a||"relationships"in a||"timeInfo"in a||"typeIdField"in a||"types"in a?10:9.3);this._collection&&(this._isStream||(this.currentMode=aa.MODE_SNAPSHOT,this._mode=new ia(this)),this._featureSet=a.featureSet,this._nextId=a.nextObjectId,
a=a.layerDefinition);this.geometryType=a.geometryType;"string"!==typeof this.multipatchOption&&"esriGeometryMultiPatch"===this.geometryType&&(this.multipatchOption="xyFootprint");a.hasOwnProperty("capabilities")?(b=this.capabilities=a.capabilities)&&-1!==b.toLowerCase().indexOf("editing")?this._editable=!0:this._editable=!1:this._collection||(this._editable=this._fserver);t.isDefined(this._optEditable)?(this._editable=this._optEditable,delete this._optEditable):"esriGeometryMultiPatch"===this.geometryType&&
(this._editable=!1);this._json=h.toJson(this._json);this.isEditable()?this._setMaxOffset(null):this.mode===aa.MODE_SNAPSHOT||"esriGeometryPolyline"!==this.geometryType&&"esriGeometryPolygon"!==this.geometryType&&!this.hasXYFootprint()||(this._autoGeneralize=t.isDefined(this._optAutoGen)?this._optAutoGen:this.mode===aa.MODE_ONDEMAND||this.mode===aa.MODE_AUTO,delete this._optAutoGen);b=a.effectiveMinScale||a.minScale;var d=a.effectiveMaxScale||a.maxScale;!this._hasMin&&b&&this.setMinScale(b);!this._hasMax&&
d&&this.setMaxScale(d);this.layerId=a.id;this.name=a.name;this.description=a.description;this.copyright=a.copyrightText;this.type=a.type;this.displayField=a.displayField;this.defaultDefinitionExpression=a.definitionExpression||(a.isView?a.viewDefinitionQuery:a.definitionQuery);this.fullExtent=new U(a.extent);this.initialExtent=new U(this.fullExtent.toJson());this.fullExtent.spatialReference&&(this.spatialReference=new x(this.fullExtent.spatialReference.toJson()));this.defaultVisibility=a.defaultVisibility;
if("esriGeometryPoint"===this.geometryType||"esriGeometryMultipoint"===this.geometryType)this.latticeTiling=!1;this.hasM=a.hasM||!1;this.hasZ=a.hasZ||!1;this.indexedFields=a.indexedFields;this.maxRecordCount=a.maxRecordCount;this.canModifyLayer=a.canModifyLayer;this.supportsStatistics=a.supportsStatistics;this.supportsAdvancedQueries=this._collection?!1:a.supportsAdvancedQueries;this.supportsCalculate=a.supportsCalculate;this.supportsAttachmentsByUploadId=a.supportsAttachmentsByUploadId;this.supportsCoordinatesQuantization=
a.supportsCoordinatesQuantization;this.quantize=this.quantize&&this.supportsCoordinatesQuantization;this.hasLabels=a.hasLabels;this.canScaleSymbols=a.canScaleSymbols;this.supportsRollbackOnFailureParameter=this.supportsRollbackOnFailure=a.supportsRollbackOnFailure;this.syncCanReturnChanges=a.syncCanReturnChanges;this.isDataVersioned=a.isDataVersioned;this.editFieldsInfo=a.editFieldsInfo;this.ownershipBasedAccessControlForFeatures=a.ownershipBasedAccessControlForFeatures;this.editFieldsInfo&&this.ownershipBasedAccessControlForFeatures&&
(this.creatorField=this.editFieldsInfo.creatorField);this.relationships=a.relationships;this.allowGeometryUpdates=t.isDefined(a.allowGeometryUpdates)?a.allowGeometryUpdates:!0;this.allowUpdateWithoutMValues=!!a.allowUpdateWithoutMValues;this.enableZDefaults=!!a.enableZDefaults;this.zDefault=t.isDefined(a.zDefault)?a.zDefault:null;this.advancedQueryCapabilities=a.advancedQueryCapabilities||{supportsStatistics:this.supportsStatistics,supportsOrderBy:this.supportsAdvancedQueries,supportsDistinct:this.supportsAdvancedQueries};
this.url&&(this.advancedQueryCapabilities.supportsPagination=this.advancedQueryCapabilities.supportsPagination&&(this.reHostedFS.test(this.url)||10.3<this.version));this.queryPagination=this._optQueryPagination&&this.advancedQueryCapabilities.supportsPagination;this.useStandardizedQueries=a.useStandardizedQueries;this.tileMaxRecordCount=a.tileMaxRecordCount;this.standardMaxRecordCount=a.standardMaxRecordCount;this._setMaxOffset(this._maxOffset,!0);this._isTable="Table"===this.type;var g=this.fields=
[],d=a.fields;for(b=0;b<d.length;b++)g.push(new W(d[b]));if(!this.objectIdField){this.objectIdField=a.objectIdField;if(!this.objectIdField)for(d=a.fields,b=0;b<d.length;b++)if(g=d[b],"esriFieldTypeOID"===g.type){this.objectIdField=g.name;break}this.objectIdField||this._isStream||console.debug("esri.layers.FeatureLayer: "+t.substitute({url:this.url},"objectIdField is not set [url: ${url}]"))}if(!t.isDefined(this._nextId)){d=this.objectIdField;g=-1;if(this._collection&&d){var m=(b=this._featureSet)&&
b.features,f=m?m.length:0,e;for(b=0;b<f;b++)e=(e=m[b].attributes)&&e[d],e>g&&(g=e)}this._nextId=g+1}this.globalIdField=a.globalIdField;if(b=this.typeIdField=a.typeIdField)if(b=!this._getField(b)&&this._getField(b,!0))this.typeIdField=b.name;this.visibilityField=a.visibilityField;if(d=a.defaultSymbol)this.defaultSymbol=E.fromJson(d);var r=this.types=[],u=a.types,k,w,g=(b=this.editFieldsInfo)&&b.creatorField,m=b&&b.editorField;e=g||m;f=[];if(u)for(b=0;b<u.length;b++)k=new ha(u[b]),w=k.templates,e&&
w&&w.length&&(f=f.concat(w)),r.push(k);u=a.templates;k=this.templates=[];if(u)for(b=0;b<u.length;b++)r=new fa(u[b]),e&&f.push(r),k.push(r);for(b=0;b<f.length;b++)if(e=n.getObject("prototype.attributes",!1,f[b]))g&&delete e[g],m&&delete e[m];if(b=a.timeInfo)this.timeInfo=new ca(b),this._startTimeField=b.startTimeField,this._endTimeField=b.endTimeField,this._startTimeField&&this._endTimeField&&(this._twoTimeFields=!0),this._trackIdField?b.trackIdField=this._trackIdField:this._trackIdField=b.trackIdField;
this.hasAttachments=!this._collection&&a.hasAttachments?!0:!1;this.htmlPopupType=a.htmlPopupType;b=a.drawingInfo;var v;(g=b&&b.labelingInfo)&&!this.labelingInfo&&(this.labelingInfo=l.map(g,function(a){return new G(a)}),this._fixLabelExpr());if(!this.renderer)if(b&&b.renderer){if(v=b.renderer,this.setRenderer(I.fromJson(v)),"classBreaks"===v.type&&this.renderer.setMaxInclusive(!0),!this._collection){var p=v.type,d=[];v=this.renderer;switch(p){case "simple":d.push(v.symbol);break;case "uniqueValue":case "classBreaks":d.push(v.defaultSymbol),
d=d.concat(l.map(v.infos,function(a){return a.symbol}))}var d=l.filter(d,t.isDefined),q=this._url.path+"/images/",y=this._getToken();l.forEach(d,function(a){var b=a.url;b&&(-1===b.search(/https?\:/)&&-1===b.indexOf("data:")&&(a.url=q+b),y&&-1!==a.url.search(/https?\:/)&&(a.url+="?token\x3d"+y))})}}else if(d)u=this.types,0<u.length?(v=new F(this.defaultSymbol,this.typeIdField),l.forEach(u,function(a){v.addValue(a.id,a.symbol)})):v=new D(this.defaultSymbol),this.setRenderer(v);else if(!this._isTable){switch(this.geometryType){case "esriGeometryPoint":case "esriGeometryMultipoint":p=
new A;break;case "esriGeometryPolyline":p=new C;break;case "esriGeometryPolygon":p=new B;break;default:this.hasXYFootprint()&&(p=new B)}this.setRenderer(p?new D(p):null)}p=b&&b.transparency||0;!this.hasOwnProperty("opacity")&&0<p&&(this.opacity=1-p/100);(c("ie")||7<=c("trident")||c("safari"))&&this.isEditable()&&10.02>this.version&&(this._ts=!0);this.statistics=a.statistics;this._fixRendererFields();this._updateRequiredFieldsFromLabelingInfo();this._checkFields();this._updateCaps();var J=function(){null==
this._maxOffset||this._isFractionalOffsetAllowed()||this._setMaxOffset(this._maxOffset);this.loaded=!0;this.setFeatureReduction(this.getFeatureReduction());this.currentMode!==aa.MODE_SNAPSHOT&&(this.queryPagination=!1);this.onLoad(this);var a=this._loadCallback;a&&(delete this._loadCallback,a(this))};a=[];this._collection?(p=this._featureSet,this._featureSet=null,this._mode._drawFeatures(new P(p)),this._fcAdded=!0):(a.push(this._forceIdentity()),this._limitPromise&&a.push(this._limitPromise));a.push(this._evalGeometryOperations());
a.length?z(a).then(n.hitch(this,function(){J.call(this)})):J.call(this)}},setShowLabels:function(a){this.showLabels=a;this.onShowLabelsChange()},onShowLabelsChange:function(){},onRendererChange:function(a){this.inherited(arguments);var b=this._map;this._ager=!!(a&&a.observationAger&&a.observationRenderer);a&&"colors"in a&&"blurRadius"in a&&"maxPixelIntensity"in a?"esriGeometryPoint"==this.geometryType&&!this._heatmapManager&&b&&(this._heatmapManager=new ja(this),this._heatmapManager.initialize(b)):
this.renderer&&this.renderer.getRendererInfo?l.some(this.renderer.rendererInfos,function(a){return a.renderer&&"colors"in a.renderer&&"blurRadius"in a.renderer})||(this._heatmapManager=null):this._heatmapManager=null;this.timeInfo&&b&&(a&&(a.latestObservationRenderer||a.trackRenderer)?this._trackManager||(this._trackManager=new ma(this),this._trackManager.initialize(b),this._childLayer=this._trackManager.container,this._mode._applyTimeFilter()):this._trackManager&&!this._isStream&&(this._trackManager.destroy(),
this._trackManager=null));if(a){var c=[],b=l.filter([a,a.observationRenderer,a.latestObservationRenderer,a.trackRenderer],t.isDefined),d=function(a){return null!=a&&"function"!=typeof a&&a};l.forEach(b,function(a){var b=d(a.attributeField),g=d(a.attributeField2);a=d(a.attributeField3);!1!==b&&c.push(b);!1!==g&&c.push(g);!1!==a&&c.push(a)});this._requiredFields=c}else this._requiredFields=[];this.loaded&&(this._fixRendererFields(),this._checkFields(this._requiredFields),this._collection&&(this._typesDirty=
!0))},setFeatureReduction:function(a){a&&(a=n.mixin({},a),null!=a.clusterSize&&null==a.clusterRadius&&(a.clusterRadius=a.clusterSize),delete a.clusterSize);this.loaded?this._isFeatureReductionSupported(a)?this._featureReduction=a:(this._featureReduction=null,a&&console.log("Clustering is not supported for this layer: "+this.url)):this._featureReduction=a;this._evalFeatureReduction(this._featureReduction)},hasFeatureReduction:function(){return!!this._featureReduction},getFeatureReduction:function(){var a=
this._featureReduction;if(a){var a=n.mixin({},a),b=this._clusterManager;if(b=b&&b.aggregationInfo)a.clusterRadius=b.clusterRadius,a.infoTemplate=b.infoTemplate}return a},isFeatureReductionActive:function(){var a=this._clusterManager;return!!(a&&a.isClusteringEnabled()&&a.isClusteringActive())},isFeatureReductionEnabled:function(){return this._featureReductionEnabled},enableFeatureReduction:function(){this._featureReductionEnabled||(this._featureReductionEnabled=!0,this._evalFeatureReduction(this._featureReduction))},
disableFeatureReduction:function(){this._featureReductionEnabled&&(this._featureReductionEnabled=!1,this._evalFeatureReduction(this._featureReduction))},isFeatureReductionApplied:function(){return this.hasFeatureReduction()&&this.isFeatureReductionEnabled()&&this._canCluster(this.getFeatureReduction())},getAggregateGraphics:function(){return this._clusterManager?this._clusterManager.getAggregateGraphics():[]},getChildGraphics:function(a){return this._clusterManager?this._clusterManager.getFeaturesInCluster(a):
[]},getSingleGraphics:function(){return this._clusterManager?this._clusterManager.getSingleGraphics():[]},getFeatureReductionRenderer:function(){return this.isFeatureReductionActive()?this._clusterManager.getClusterRenderer():null},getFeatureReductionLayer:function(){return this._clusterManager?this._clusterManager.container:null},getFeatureReductionField:function(a){var b,c=this._clusterManager?this._clusterManager.getClusterFields():null;a=a?a.toLowerCase():"";l.some(c,function(c){a===c.name.toLowerCase()&&
(b=c);return!!b});return b},_isFeatureReductionSupported:function(a){return a&&"cluster"===a.type&&"esriGeometryPoint"===this.geometryType&&(this._collection||this._isStream||this._optQueryPagination&&this.advancedQueryCapabilities.supportsPagination)},_isReductionCompatibleRenderer:function(a){a=a&&a.declaredClass||"";a=a.toLowerCase();return-1<a.indexOf("simplerenderer")||-1<a.indexOf("classbreaksrenderer")||-1<a.indexOf("uniquevaluerenderer")},_evalFeatureReduction:function(a){this.loaded&&this.getMap()&&
(a=a||this.getFeatureReduction(),this._evalFetchMode(a),a&&this.isFeatureReductionEnabled()?this._canCluster(a)?this._clusterManager?this._updateClusterManager(a):(this._clusterManager=this._createClusterManager(a),this.onFeatureReductionChange()):(console.log("Clustering is supported only for point layers where map spatial reference is WGS84 or Web Mercator"),this._destroyClusterManager()):this._destroyClusterManager())},_canCluster:function(a){var b=this._map.spatialReference;return this._isFeatureReductionSupported(a)&&
this._isReductionCompatibleRenderer(this.renderer)&&(b.isWebMercator()||4326===b.wkid)},_createClusterManager:function(a){a=new va({layer:this,aggregationInfo:a});this._clusterHandles=[a.on("renderer-change",n.hitch(this,function(){this.onFeatureReductionRendererChange()}))];a.initialize(this._map);return a},_updateClusterManager:function(a){var b=this._clusterManager;b&&b.setAggregationInfo(a)},_destroyClusterManager:function(a){l.forEach(this._clusterHandles,function(a){a.remove()});this._clusterHandles=
null;this._clusterManager&&(this._clusterManager.destroy(a),this._clusterManager=null,this.onFeatureReductionChange())},redraw:function(){this.inherited(arguments);this._clusterManager&&this._clusterManager.redraw();this._trackManager&&this._trackManager.container&&this._trackManager.container.redraw()},_evalSDRenderer:function(a){this.inherited(arguments);var b=this._getRenderer();this._ager=!!(b&&b.observationAger&&b.observationRenderer);this._trackManager&&this._trackManager.container&&this._trackManager.container.setRenderer(b&&
b.trackRenderer);a&&this._evalFeatureReduction()},_setMap:function(a){var b=this.inherited(arguments),c=this._mode,d=this;c&&a.loaded&&c.initialize(a);this.geometryType&&this.attr("data-geometry-type",this.geometryType.replace(/esriGeometry/i,"").toLowerCase());this._addHandle=this.on("graphic-node-add",function(a){a=a.graphic.attributes;(a=d._selectedFeatures[a&&a[d.objectIdField]])&&a.attr("data-selected","")});return b},_unsetMap:function(a){var b=this._mode;b&&(b.suspend(),b.destroy());this._destroyClusterManager(!1);
this._trackManager&&(this._trackManager.destroy(),this._trackManager=null);q.disconnect(this._zoomConnect);q.disconnect(this._addHandle);this._zoomConnect=this._addHandle=null;this._toggleTime(!1);this.inherited("_unsetMap",arguments)},refresh:function(){this._needsRefresh=!1;var a=this._mode;a&&a.refresh()},hasXYFootprint:function(){return"esriGeometryMultiPatch"===this.geometryType&&"xyFootprint"===this.multipatchOption},getOutFields:function(){return l.filter(this._getOutFields(),function(a){return"*"===
a||!!this._getField(a)},this)},getField:function(a){return this._getField(a,!0)},isOutField:function(a){a=this.getField(a);if(!a)return!1;var b=this.getOutFields();return-1<l.indexOf(b,"*")||-1<l.indexOf(b,a.name)},getFieldLabel:function(a){var b=this.infoTemplate,b=b&&b.getFieldInfo&&b.getFieldInfo(a);a=n.isFunction(a)?null:this.getField(a);var c=b||a,d="";c&&(d=b&&b.label||a&&a.alias||c.name||c.fieldName);return d},getDomain:function(a,b){var c,d,g=(b=b&&b.feature)&&this.typeIdField&&b.attributes&&
b.attributes[this.typeIdField];null!=g&&l.some(this.types,function(b){return b.id==g?((c=b.domains&&b.domains[a])&&"inherited"===c.type&&(c=this._getLayerDomain(a),d=!0),!0):!1},this);d||c||(c=this._getLayerDomain(a));return c},_getLayerDomain:function(a){var b;l.some(this.fields,function(c){c.name===a&&(b=c.domain);return!!b});return b},getType:function(a){var b,c=a&&this.typeIdField&&a.attributes&&a.attributes[this.typeIdField];l.some(this.types,function(a){a.id==c&&(b=a);return!!b});return b},
setEditable:function(a){if(!this._collection)return console.log("FeatureLayer:setEditable - this functionality is not yet supported for layer in a feature service"),this;if(!this.loaded)return this._optEditable=a,this;var b=this._editable;this._editable=a;this._updateCaps();if(b!==a)this.onCapabilitiesChange();return this},getEditCapabilities:function(a){var b={canCreate:!1,canUpdate:!1,canDelete:!1,canUpdateGeometry:!1};if(!this.loaded||!this.isEditable())return b;var c=a&&a.feature;a=a&&a.userId||
this.getUserId();var d=l.map(this.capabilities?this.capabilities.toLowerCase().split(","):[],n.trim),g=(b=-1<l.indexOf(d,"editing"))&&-1<l.indexOf(d,"create"),m=b&&-1<l.indexOf(d,"update"),d=b&&-1<l.indexOf(d,"delete"),f=this.ownershipBasedAccessControlForFeatures,h=this.editFieldsInfo,e=h&&h.creatorField,h=h&&h.realm,c=(c=c&&c.attributes)&&e?c[e]:void 0,r=!!this.userIsAdmin,e=!f||r||!(!f.allowOthersToUpdate&&!f.allowUpdateToOthers),t=!f||r||!(!f.allowOthersToDelete&&!f.allowDeleteToOthers),u=!f||
r||!f.hasOwnProperty("allowAnonymousToUpdate")||f.allowAnonymousToUpdate,f=!f||r||!f.hasOwnProperty("allowAnonymousToDelete")||f.allowAnonymousToDelete;a&&h&&(a=a+"@"+h);if(r||b&&!(g||m||d))g=m=d=!0;b={canCreate:g,canUpdate:m,canDelete:d,canUpdateGeometry:r||this.allowGeometryUpdates};a||(b.canUpdate=b.canUpdate&&u,b.canDelete=b.canDelete&&f);null===c?(b.canUpdate=b.canUpdate&&e,b.canDelete=b.canDelete&&t):""!==c&&c&&a.toLowerCase()!==c.toLowerCase()&&(b.canUpdate=b.canUpdate&&e,b.canDelete=b.canDelete&&
t);return b},getUserId:function(){var a;this.loaded&&(a=this.credential&&this.credential.userId||this.userId||"");return a},setUserIsAdmin:function(a){this.userIsAdmin=a},setEditSummaryCallback:function(a){this.editSummaryCallback=a},getEditSummary:function(a,b,c){c=t.isDefined(c)?c:(new Date).getTime();var d="";c=this.getEditInfo(a,b,c);(b=b&&b.callback||this.editSummaryCallback)&&(c=b(a,c)||"");if(n.isString(c))d=c;else{if(c){a=c.action;b=c.userId;var g=c.timeValue,m=0;a&&m++;b&&m++;t.isDefined(g)&&
m++;1<m&&(d=("edit"===a?"edit":"create")+(b?"User":"")+(t.isDefined(g)?c.displayPattern:""))}d=d&&t.substitute(c,this.i18n.layers.FeatureLayer[d])}return d},getEditInfo:function(a,b,c){if(this.loaded){c=t.isDefined(c)?c:(new Date).getTime();b=b&&b.action||"last";var d=this.editFieldsInfo,g=d&&d.creatorField,m=d&&d.creationDateField,f=d&&d.editorField,d=d&&d.editDateField,f=(a=a&&a.attributes)&&f?a[f]:void 0,d=a&&d?a[d]:null,g=this._getEditData(a&&g?a[g]:void 0,a&&m?a[m]:null,c);c=this._getEditData(f,
d,c);var h;switch(b){case "creation":h=g;break;case "edit":h=c;break;case "last":h=c||g}h&&(h.action=h===c?"edit":"creation");return h}},_getEditData:function(a,b,c){var g,m,f;t.isDefined(b)&&(m=c-b,f=0>m?"Full":6E4>m?"Seconds":12E4>m?"Minute":36E5>m?"Minutes":72E5>m?"Hour":864E5>m?"Hours":6048E5>m?"WeekDay":"Full");if(void 0!==a||f)g=g||{},g.userId=a,f&&(a=d.format,c=new Date(b),g.minutes=Math.floor(m/6E4),g.hours=Math.floor(m/36E5),g.weekDay=a(c,{datePattern:"EEEE",selector:"date"}),g.formattedDate=
a(c,{selector:"date"}),g.formattedTime=a(c,{selector:"time"}),g.displayPattern=f,g.timeValue=b);return g},isEditable:function(){return!(!this._editable&&!this.userIsAdmin)},isQueryable:function(){var a=l.map(this.capabilities?this.capabilities.toLowerCase().split(","):[],n.trim);return this._isStream||this.userIsAdmin||this._collection||-1!==l.indexOf(a,"query")||-1!==l.indexOf(a,"catalog")},setMaxAllowableOffset:function(a){this.isEditable()||this._setMaxOffset(a,!0);return this},getMaxAllowableOffset:function(){var a=
this._quantizationParameters?this._quantizationParameters.tolerance:void 0;return null!=this._maxOffset?this._maxOffset:a},_setMaxOffset:function(a,b){if(null==a)return delete this._maxOffset,delete this._quantizationParameters,this;this.quantize&&this.supportsCoordinatesQuantization?("esriGeometryPolyline"===this.geometryType?this._maxOffset=a:delete this._maxOffset,this._quantizationParameters={mode:"view",originPosition:"upperLeft",tolerance:a,extent:this.fullExtent}):(this._isFractionalOffsetAllowed()&&
b||(a=Math.floor(a)),isNaN(a)||0===a?delete this._maxOffset:this._maxOffset=a,delete this._quantizationParameters);return this},_isFractionalOffsetAllowed:function(){return null==this.version||10.1<=this.version||navigator.languages&&this._isLangWithDot(navigator.languages[0])},_isLangWithDot:function(a){a=(a=a&&a.split("-"))&&a[0]&&a[0].toLowerCase();return-1!==l.indexOf(this._langsWithDot,a)},_langsWithDot:"ar en et fr he ja ko th vi zh".split(" "),setAutoGeneralize:function(a){this.loaded?this.isEditable()||
this.mode===aa.MODE_SNAPSHOT||"esriGeometryPolyline"!==this.geometryType&&"esriGeometryPolygon"!==this.geometryType&&!this.hasXYFootprint()||((this._autoGeneralize=a)?(this._autoSnapshot&&(this._prevScale=null),this._updateMaxOffset()):this._setMaxOffset(null)):this._optAutoGen=a;return this},setGDBVersion:function(a){this._collection||a===this.gdbVersion||!a&&!this.gdbVersion||(this.gdbVersion=a,this._task.gdbVersion=a,this._url.query=n.mixin(this._url.query,{gdbVersion:a}),this.loaded&&(this.clearSelection(),
this._map&&this.refresh()),this.onGDBVersionChange());return this},hasAllFeatures:function(){return this._mode?this._mode.hasAllFeatures():!0},setDefinitionExpression:function(a){this._defnExpr=a;(a=this._mode)&&a.propertyChangeHandler(1);return this},getDefinitionExpression:function(){return this._defnExpr},setTimeDefinition:function(a){this._isSnapshotMode()?(this._timeDefn=a,(a=this._mode)&&a.propertyChangeHandler(2)):console.log("FeatureLayer.setTimeDefinition: layer in on-demand or selection mode does not support time definitions. Layer id \x3d "+
this.id+", Layer URL \x3d "+this.url);return this},getTimeDefinition:function(){return this._timeDefn},setTimeOffset:function(a,b){this._timeOffset=a;this._timeOffsetUnits=b;(a=this._mode)&&a.propertyChangeHandler(0);return this},setUseMapTime:function(a){this.useMapTime=a;this._toggleTime(!this.suspended);(a=this._mode)&&a.propertyChangeHandler(0)},selectFeatures:function(a,b,c,d){b=b||aa.SELECTION_NEW;this._hasPartialSelectedFeatures=!1;a=this._getShallowClone(a);var g=this._map,m,h=this,e=w._fixDfd(new f(w._dfdCanceller));
a.outFields=this.getOutFields();a.returnGeometry=!0;a.multipatchOption=this.multipatchOption;g&&(a.outSpatialReference=new x(g.spatialReference.toJson()));if(!this._applyQueryFilters(a,!0))return m={features:[]},this._selectHandler(m,b,c,d,e),e;if(g=this._canDoClientSideQuery(a))e._pendingDfd=u(this._doQuery(a,g)),e._pendingDfd.then(function(a){m={features:a};h._selectHandler(m,b,c,d,e)});else{if(this._collection)return this._resolve([Error("FeatureLayer::selectFeatures - "+this.invalidParams)],null,
d,e,!0),e;if(this.loaded&&!this.isQueryable())return this._resolve([Error("Layer does not support query capability.")],null,d,e,!0),e;var r=this;this._ts&&(a._ts=(new Date).getTime());(e._pendingDfd=this._task.execute(a)).addCallbacks(function(a){r._selectHandler(a,b,c,d,e)},function(a){r._hasPartialSelectedFeatures=!0;r._resolve([a],null,d,e,!0)})}return e},getSelectedFeatures:function(){var a=this._selectedFeatures,b=[],c;for(c in a)a.hasOwnProperty(c)&&b.push(a[c]);return b},clearSelection:function(a){var b=
this._selectedFeatures,c=this._mode,d;for(d in b)b.hasOwnProperty(d)&&(this._unSelectFeatureIIf(d,c),c._removeFeatureIIf(d));this._selectedFeatures={};this._isSelOnly&&c._applyTimeFilter(!0);if(!a)this.onSelectionClear();return this},setSelectionSymbol:function(a){if(this._selectionSymbol=a){var b=this._selectedFeatures,c;for(c in b)b.hasOwnProperty(c)&&b[c].setSymbol(a)}return this},getSelectionSymbol:function(){return this._selectionSymbol},setLabelingInfo:function(a){a?(this.labelingInfo=a,this._fixLabelExpr()):
delete this.labelingInfo;this._collection&&(this._typesDirty=!0);this.onLabelingInfoChange()},_fixLabelExpr:function(){var a=/\[([^\[\]]+)\]/ig,b,c=this,d=function(a,b){a=c._getField(b,!0);return"["+(a&&a.name||b)+"]"};l.forEach(this.labelingInfo,function(c){if(b=c.labelExpression)c.labelExpression=b.replace(a,d)})},_updateRequiredFieldsFromLabelingInfo:function(){var a=[];l.forEach(this.labelingInfo,function(b){var c=b.labelExpressionInfo;if(b.labelExpression){var d=/[\[\]]/ig;b=b.labelExpression.match(/\[[^\[\]]+\]/ig);
(b=l.map(b,function(a){return a.replace(d,"")}))&&(a=a.concat(b))}if(c){if(c.value){var g=/[\{\}]/ig;b=c.value.match(/\{[^\{\}]+\}/ig);(b=l.map(b,function(a){return a.replace(g,"")}))&&(a=a.concat(b))}c.expression&&(a=a.concat(M.extractFieldNames(c.expression)))}});a=l.map(a,function(a){var b=this.getField(a);return b?b.name:a},this);this._requiredFields&&(this._requiredFields=this._requiredFields.concat(a))},__msigns:[{n:"applyEdits",c:5,a:[{i:0},{i:1}],e:4,f:1}],applyEdits:function(a,b,c,d,g,m){var f=
m.assembly,h=m.dfd;this._applyNormalized(a,f&&f[0]);this._applyNormalized(b,f&&f[1]);this.onBeforeApplyEdits(a,b,c);var e={},r=this.objectIdField,f={f:"json"},t=!1;if(this._collection)m={},m.addResults=a?l.map(a,function(){t=!0;return{objectId:this._nextId++,success:!0}},this):null,m.updateResults=b?l.map(b,function(a){t=!0;var b=a.attributes[r];e[b]=a;return{objectId:b,success:!0}},this):null,m.deleteResults=c?l.map(c,function(a){t=!0;return{objectId:a.attributes[r],success:!0}},this):null,t?this._editHandler(m,
a,e,d,g,h):this._resolve([m.addResults,m.updateResults,m.deleteResults],null,d,h);else{a&&0<a.length&&(f.adds=this._convertFeaturesToJson(a,0,1),t=!0);if(b&&0<b.length){for(m=0;m<b.length;m++){var u=b[m];e[u.attributes[r]]=u}f.updates=this._convertFeaturesToJson(b,0,0,1);t=!0}if(c&&0<c.length){b=[];for(m=0;m<c.length;m++)b.push(c[m].attributes[r]);f.deletes=b.join(",");t=!0}if(t){var k=this;return v({url:this._url.path+"/applyEdits",content:n.mixin(f,this._url.query),callbackParamName:"callback",
load:function(b){k._editHandler(b,a,e,d,g,h)},error:function(a){k._resolve([a],null,g,h,!0)}},{usePost:!0})}this._resolve([],null,d,h)}},queryFeatures:function(a,b,c){return this._query("execute","onQueryFeaturesComplete",a,b,c)},queryRelatedFeatures:function(a,b,c){return this._query("executeRelationshipQuery","onQueryRelatedFeaturesComplete",a,b,c)},queryIds:function(a,b,c){return this._query("executeForIds","onQueryIdsComplete",a,b,c)},queryCount:function(a,b,c){return this._query("executeForCount",
"onQueryCountComplete",a,b,c)},queryExtent:function(a,b,c){return this._query("executeForExtent","onQueryExtentComplete",a,b,c)},queryAttachmentInfos:function(b,c,d){var g=this._url.path+"/"+b+"/attachments",m=new f(w._dfdCanceller),h=this;m._pendingDfd=v({url:g,content:n.mixin({f:"json"},this._url.query),callbackParamName:"callback",load:function(d){d=d.attachmentInfos;var f;l.forEach(d,function(c){f=a.objectToQuery({gdbVersion:h._url.query&&h._url.query.gdbVersion,layer:h._url.query&&h._url.query.layer,
token:h._getToken()});c.url=g+"/"+c.id+(f?"?"+f:"");c.objectId=b});h._resolve([d],"onQueryAttachmentInfosComplete",c,m)},error:function(a){h._resolve([a],null,d,m,!0)}});return m},addAttachment:function(a,b,c,d){return this._sendAttachment("add",a,b,c,d)},updateAttachment:function(a,c,d,g,m){d.appendChild(b.create("input",{type:"hidden",name:"attachmentId",value:c}));return this._sendAttachment("update",a,d,g,m)},deleteAttachments:function(a,b,c,d){var g=this._url.path+"/"+a+"/deleteAttachments",
m=new f(w._dfdCanceller),h=this;b={f:"json",attachmentIds:b.join(",")};m._pendingDfd=v({url:g,content:n.mixin(b,this._url.query),callbackParamName:"callback",load:n.hitch(this,function(b){b=b.deleteAttachmentResults;b=l.map(b,function(b){b=new Z(b);b.attachmentId=b.objectId;b.objectId=a;return b});h._resolve([b],"onDeleteAttachmentsComplete",c,m)}),error:function(a){h._resolve([a],null,d,m,!0)}},{usePost:!0});return m},addType:function(a){var b=this.types;if(b){if(l.some(b,function(b){return b.id==
a.id?!0:!1}))return!1;b.push(a)}else this.types=[a];return this._typesDirty=!0},deleteType:function(a){if(this._collection){var b=this.types;if(b){var c=-1;l.some(b,function(b,d){return b.id==a?(c=d,!0):!1});if(-1<c)return this._typesDirty=!0,b.splice(c,1)[0]}}},toJson:function(){var a=this._json;if(a=n.isString(a)?h.fromJson(a):n.clone(a)){var a=a.layerDefinition?a:{layerDefinition:a},b=a.layerDefinition,c=this._collection;if(c&&this._typesDirty){b.types=l.map(this.types||[],function(a){return a.toJson()});
var d=this.renderer,g=this.labelingInfo,m=b.drawingInfo;!d&&!g||m||(m=b.drawingInfo={});m&&d&&-1===d.declaredClass.indexOf("TemporalRenderer")&&(m.renderer=d.toJson());g&&(m.labelingInfo=l.map(g,function(a){return a.toJson()}))}d=null;if(!c||this._fcAdded)d={geometryType:b.geometryType,features:this._convertFeaturesToJson(this.graphics,!0)};a.featureSet=n.mixin({},a.featureSet||{},d);a.featureSet.transform&&(g=a.featureSet.transform,delete a.featureSet.transform,d=new P(a.featureSet),d.quantize(g),
a.featureSet=d.toJson());c&&(a.nextObjectId=this._nextId,b.capabilities=this.capabilities);return a}},onSelectionComplete:function(){},onSelectionClear:function(){},onBeforeApplyEdits:function(){},onEditsComplete:function(){},onQueryFeaturesComplete:function(){},onQueryRelatedFeaturesComplete:function(){},onQueryIdsComplete:function(){},onQueryCountComplete:function(){},onQueryExtentComplete:function(){},onQueryAttachmentInfosComplete:function(){},onAddAttachmentComplete:function(){},onUpdateAttachmentComplete:function(){},
onDeleteAttachmentsComplete:function(){},onCapabilitiesChange:function(){},onGDBVersionChange:function(){},onQueryLimitExceeded:function(){},onLabelingInfoChange:function(){},onFeatureReductionRendererChange:function(){},onFeatureReductionChange:function(){},_evalGeometryOperations:function(){var a=new f;setTimeout(n.hitch(this,function(){this._isGeometryOperationsUsed()?M.enableGeometryOperations().always(function(){a.resolve()}):a.resolve()}),0);return a.promise},_isGeometryOperationsUsed:function(){var a=
this.infoTemplate,b=this.renderer,c=this.labelingInfo;return a&&a.hasGeometryOperations&&a.hasGeometryOperations()||b&&b.hasGeometryOperations&&b.hasGeometryOperations()||l.some(c,function(a){return M.hasGeometryOperations(a.labelExpressionInfo&&a.labelExpressionInfo.expression)})?!0:!1},_forceIdentity:function(){var a=new f,b=this,c,d=this._url&&this._url.path;c=d&&d.toLowerCase().indexOf("/rest/services");var g=this.editFieldsInfo,g=g&&(g.creatorField||g.editorField);(this.userIsAdmin||g)&&!this._getToken()&&
-1<c&&r.id?(c=d.substring(0,c)+"/rest/info",v({url:c,content:{f:"json"},handleAs:"json",callbackParamName:"callback"}).then(function(a){if(a.owningSystemUrl)return r.id.checkSignInStatus(a.owningSystemUrl+"/sharing")}).then(function(a){if(a)return r.id.getCredential(d)}).then(function(a){a&&b._findCredential()}).always(function(){a.resolve()})):a.resolve();return a.promise},_isSnapshotMode:function(){return this._mode?this._mode.isInstanceOf(ia):!1},_checkMode:function(a){var b=this.geometryType,
c=this.maxRecordCount;a=(a=a&&a.features&&a.features[0])&&a.attributes&&a.attributes.exceedslimit;this.mode===aa.MODE_AUTO&&!this.isEditable()&&0===a&&(this.queryPagination||("esriGeometryPolyline"===b||"esriGeometryPolygon"===b||"esriGeometryMultipoint"===b||this.hasXYFootprint())&&c>=this.maxRecordCountForAuto||"esriGeometryPoint"===b&&c>=this.maxPointCountForAuto)&&(this.currentMode=aa.MODE_SNAPSHOT,this._mode=new ia(this),this._autoSnapshot=!0)},_evalFetchMode:function(a){this.loaded&&(a&&this.isFeatureReductionEnabled()&&
this._canCluster(a)?this._switchToSnapshotMode():this._switchToNormalMode())},_switchToSnapshotMode:function(){if(null==this._savedMode){var a=this.currentMode;a!==aa.MODE_SNAPSHOT&&a!==aa.MODE_STREAM&&a!==aa.MODE_SELECTION&&(this._savedMode=this.mode,this._mode.suspend(),this._mode.destroy(),this.mode=this.currentMode=aa.MODE_SNAPSHOT,this._mode=new ia(this),this.queryPagination=this._optQueryPagination&&this.advancedQueryCapabilities.supportsPagination,this.clearSelection(),(a=this.getMap())&&a.loaded&&
(this._mode.initialize(a),this._mode.startup()))}},_switchToNormalMode:function(){if(null!=this._savedMode){this._mode.suspend();this._mode.destroy();this.mode=this._savedMode;this._savedMode=null;this.currentMode=aa.MODE_ONDEMAND;this._mode=new sa(this);this.queryPagination=!1;this.clearSelection();var a=this.getMap();a&&a.loaded&&(this._mode.initialize(a),this._mode.startup())}},_queryLimit:function(){var a=this,b=new f;this._limitPromise=b.promise;this._limitPromise.then(function(b){a._checkMode(b)});
this._limitPromise.always(function(){a._limitPromise=null});setTimeout(function(){var c=new J,d=new K;d.statisticType="exceedslimit";d.maxPointCount=a.maxPointCountForAuto;d.maxRecordCount=a.maxRecordCountForAuto;d.maxVertexCount=a.maxVertexCountForAuto;d.outStatisticFieldName="exceedslimit";c.outStatistics=[d];a.queryFeatures(c).promise.then(function(a){b.resolve(a)},function(a){b.reject(a)})},0)},_updateCaps:function(){var a=this._editable,b=n.trim(this.capabilities||""),c=l.map(b?b.split(","):
[],n.trim),d=l.map(b?b.toLowerCase().split(","):[],n.trim),b=l.indexOf(d,"editing"),g,d={Create:l.indexOf(d,"create"),Update:l.indexOf(d,"update"),Delete:l.indexOf(d,"delete")};if(a&&-1===b)c.push("Editing");else if(!a&&-1<b){a=[b];for(g in d)-1<d[g]&&a.push(d[g]);a.sort();for(g=a.length-1;0<=g;g--)c.splice(a[g],1)}this.capabilities=c.join(",")},_counter:{value:0},_getUniqueId:function(){return this._counter.value++},onSuspend:function(){this.inherited(arguments);this._toggleTime(!1);var a=this._mode;
a&&a.suspend()},onResume:function(a){this.inherited(arguments);this._toggleTime(!0);var b=this._map,c=this._getRenderer();if(a.firstOccurrence){if(this._fixRendererFields(),this._updateRequiredFieldsFromLabelingInfo(),this._checkFields(),this.clearSelection(),this._evalFeatureReduction(),this.timeInfo&&!this._trackManager&&(this._trackIdField||c&&(c.latestObservationRenderer||c.trackRenderer))&&(this._trackManager=new ma(this),this._trackManager.initialize(b),this._childLayer=this._trackManager.container),
c&&"colors"in c&&"blurRadius"in c&&"maxPixelIntensity"in c&&"esriGeometryPoint"==this.geometryType&&!this._heatmapManager&&(this._heatmapManager=new ja(this),this._heatmapManager.initialize(b)),this._autoSnapshot&&this._autoGeneralize&&("esriGeometryPolyline"===this.geometryType||"esriGeometryPolygon"===this.geometryType||this.hasXYFootprint())&&!this.isEditable()&&null==this.getMaxAllowableOffset()&&(c=this.generalizeForScale,this._calculatedScale=c=this.maxScale?this.maxScale:this.minScale?Math.min(c,
this.minScale):Math.min(c,Y.getScale(b,this.initialExtent)),this._calcMaxOffset=b.extent.getWidth()/b.width/b.getScale()*c),this._zoomConnect=q.connect(b,"onZoomEnd",this,this._zoomEndHandler),this._updateMaxOffset(),this._needsRefresh=!1,c=this._mode)c._init||c.initialize(b),c.startup()}else this._zoomEndHandler(),this._mode&&this._mode.resume()},_zoomEndHandler:function(){var a=this._map;this._updateMaxOffset();this._prevScale=a.getScale();!this.suspended&&this._needsRefresh&&this.refresh()},_updateMaxOffset:function(){var a=
this._map;a&&a.loaded&&this._autoGeneralize&&(this._autoSnapshot?(a=this.getMaxAllowableOffset(),this._setMaxOffset(this._getMaxOffsetForScale(),!0),this._needsRefresh||(this._needsRefresh=a!=this.getMaxAllowableOffset())):this._setMaxOffset(a.extent.getWidth()/a.width,!a.extent.spatialReference.isWebMercator()))},_getMaxOffsetForScale:function(){if(this._map){var a=this._map.getScale(),b=this._calculatedScale,c=this._calcMaxOffset,d=this._prevScale;return a>=b&&(null==d||d<b)?c:a<b&&(null==d||d>=
b)?null:this.getMaxAllowableOffset()}},_toggleTime:function(a){var b=this._map;a&&this.timeInfo&&this.useMapTime&&b?(this._mapTimeExtent=b.timeExtent,this._timeConnect||(this._timeConnect=q.connect(b,"onTimeExtentChange",this,this._timeChangeHandler))):(this._mapTimeExtent=null,q.disconnect(this._timeConnect),this._timeConnect=null)},_timeChangeHandler:function(a){this._mapTimeExtent=a;(a=this._mode)&&a.propertyChangeHandler(0)},_getOffsettedTE:function(a){var b=this._timeOffset,c=this._timeOffsetUnits;
return a&&b&&c?a.offset(-1*b,c):a},_getTimeOverlap:function(a,b){return a&&b?a.intersection(b):a||b},_getTimeFilter:function(a){var b=this.getTimeDefinition(),c;if(b&&(c=this._getTimeOverlap(b,null),!c))return[!1];if(a){if(a=c?this._getTimeOverlap(a,c):a,!a)return[!1]}else a=c;return[!0,a]},_getAttributeFilter:function(a){var b=this.getDefinitionExpression();return a?b?"("+b+") AND ("+a+")":a:b},_applyQueryFilters:function(a,b){a.where=this._getAttributeFilter(a.where);a.returnGeometry&&null==a.maxAllowableOffset&&
!a.quantizationParameters&&(a.maxAllowableOffset=this._maxOffset,a.quantizationParameters=this._quantizationParameters);b&&this.supportsAdvancedQueries&&(a.orderByFields=a.orderByFields||this.getOrderByFields());if(this.timeInfo)if(b=this._getTimeFilter(a.timeExtent),b[0])a.timeExtent=b[1];else return!1;return!0},_add:function(a){var b=this._selectionSymbol,c=a.attributes,d=this.visibilityField;b&&this._isSelOnly&&a.setSymbol(b);if(d&&c&&c.hasOwnProperty(d))a[c[d]?"show":"hide"]();return this.add.apply(this,
arguments)},_remove:function(){return this.remove.apply(this,arguments)},_canDoClientSideQuery:function(a){var b=[],c=this._map,d;if((this._collection||!this._isTable&&c)&&!(a.text||a.where&&a.where!==this.getDefinitionExpression()||a.orderByFields&&a.orderByFields.length&&(d=this.getOrderByFields()||[])&&a.orderByFields.join()!==d.join()||a.outStatistics||a.returnDistinctValues)){d=this._isSnapshotMode();var g=this._isSelOnly,m=a.geometry;if(m){if(g||a.spatialRelationship!==J.SPATIAL_REL_INTERSECTS||
"extent"!==m.type||!d&&!c.extent.contains(m))return;b.push(1)}if(c=a.objectIds)if(d)b.push(2);else{var m=c.length,f=this._mode,h=0,e;for(e=0;e<m;e++)f._getFeature(c[e])&&h++;if(h===m)b.push(2);else return}if(this.timeInfo)if(a=a.timeExtent,c=this._mapTimeExtent,d)a&&b.push(3);else if(g){if(a)return}else if(c)if(-1!==l.indexOf(b,2))a&&b.push(3);else if(-1!==l.indexOf(b,1))a==c&&b.push(3);else return;else if(0<b.length)a&&b.push(3);else if(a)return;return 0<b.length?b:null}},_getAbsMid:function(a){return k.toAbsMid?
k.toAbsMid(a):e.id.replace(/\/[^\/]*$/ig,"/")+a},_doQuery:function(a,b,c){var d=[],g=this.objectIdField,m=this,h=new f,e=new f,r=this.graphics;if(-1!==l.indexOf(b,1)){var t=this.spatialIndex||this._map&&this._map.spatialIndex,u,k=a.geometry._normalize(null,!0);null==t&&na.autoSpatialIndexing?u=(this._map||this).addPlugin(this._getAbsMid("../plugins/spatialIndex")).then(n.hitch(this,n.partial(this._getFromIndex,k,t)),function(a){e.resolve(n.hitch(this,n.partial(this._filterByExtent,r,k)))}):t&&(u=
this._getFromIndex(k,t));u?u.then(function(a){for(var b=0;b<a.length;b++)a[b].results&&(d=d.concat(a[b].results));e.resolve(d)}).otherwise(function(a){e.reject(a)}):e.resolve(this._filterByExtent(r,k))}else e.resolve(r);e.then(function(f){d=f;if(-1!==l.indexOf(b,2)){var e=a.objectIds;d=l.filter(d,function(a){return-1<l.indexOf(e,a.attributes[g])})}-1!==l.indexOf(b,3)&&m.timeInfo&&(f=a.timeExtent,d=m._filterByTime(d,f.startTime,f.endTime).match);c&&(d=l.map(d,function(a){return a.attributes[g]},this));
h.resolve(d)});return h},_getFromIndex:function(a,b){b=b||this.spatialIndex||this._map.spatialIndex;a instanceof Array||(a=[a]);var c=this.id;return m(l.map(a,function(a){return b.intersects(a,c)}))},_filterByExtent:function(a,b){for(var c=[],d=0,g=a.length;d<g;d++){var m=a[d],f=m.geometry;f&&(this.normalization&&b.length?(b[0].intersects(f)||b[1].intersects(f))&&c.push(m):b.intersects(f)&&c.push(m))}return c},_filterByTime:function(a,b,c){var d=this._startTimeField,g=this._endTimeField,m;this._twoTimeFields||
(m=d||g);var f=t.isDefined,h=[],e=[],r,l=a.length,n,u;b=b?b.getTime():-Infinity;c=c?c.getTime():Infinity;if(m)for(r=0;r<l;r++)n=a[r],u=n.attributes,d=u[m],d>=b&&d<=c?h.push(n):e.push(n);else for(r=0;r<l;r++)n=a[r],u=n.attributes,m=u[d],u=u[g],m=f(m)?m:-Infinity,u=f(u)?u:Infinity,m>=b&&m<=c||u>=b&&u<=c||b>=m&&c<=u?h.push(n):e.push(n);return{match:h,noMatch:e}},_getSizeVariables:function(a){return a&&l.filter(a.getVisualVariablesForType("sizeInfo",!1),function(a){return!(!a.field&&!a.valueExpression)})},
_needClientSideSorting:function(a){return this._collection?!(!a||!a.length):l.some(a,function(a){return!!a.valueExpression})},_sortFeatures:function(a){var b=this.renderer,c=this._getSizeVariables(b);if(a&&1<a.length&&this._needClientSideSorting(c)){var d=c[0],g=this;a.sort(function(a,c){a._layer||(a._layer=g);c._layer||(c._layer=g);a=b._getDataValue(a,d,"sizeInfo",null,g);c=b._getDataValue(c,d,"sizeInfo",null,g);return null==a?-1:null==c?1:c-a})}return a},_resolve:function(a,b,c,d,g){b&&this[b].apply(this,
a);c&&c.apply(null,a);d&&w._resDfd(d,a,g)},_getShallowClone:function(a){var b=new J,c;for(c in a)a.hasOwnProperty(c)&&(b[c]=a[c]);return b},_query:function(a,b,c,d,g){var m=this,h=this._map,e=new f(w._dfdCanceller),r=c,t,n,k;if("executeRelationshipQuery"!==a){var r=this._getShallowClone(c),v=this.getOutFields();r.outFields||(r.outFields=v);r.outFields&&r.outFields.length&&(n=-1<l.indexOf(v,"*")?!1:!l.every(r.outFields,function(a){return-1<l.indexOf(v,a)}));r.returnGeometry=c.hasOwnProperty("returnGeometry")?
c.returnGeometry:!c.outStatistics;r.returnGeometry&&(r.multipatchOption=this.multipatchOption,null!=r.maxAllowableOffset||r.quantizationParameters)&&(c=null!=r.maxAllowableOffset?r.maxAllowableOffset:r.quantizationParameters.tolerance,null!=c&&c!==this.getMaxAllowableOffset()&&(k=!0));var p;h&&(h=h&&h.spatialReference,(c=r.outSpatialReference)?t=!c.equals(h):r.outSpatialReference=new x(h.toJson()));if(!this._applyQueryFilters(r,"execute"===a&&!r.outStatistics)){switch(a){case "execute":p=new P({features:[]});
break;case "executeForIds":p=[];break;case "executeForCount":p=0;break;case "executeForExtent":p={}}this._resolve([p],b,d,e);return e}if(h="executeForExtent"!==a&&!t&&!n&&!k&&this._canDoClientSideQuery(r))return e._pendingDfd=u(this._doQuery(r,h,"executeForIds"===a||"executeForCount"===a)),e._pendingDfd.then(function(c){switch(a){case "execute":p=new P;p.features=c;break;case "executeForIds":p=c;break;case "executeForCount":p=c.length}m._resolve([p],b,d,e)}),e}if(this._collection)return this._resolve([Error("FeatureLayer::_query - "+
this.invalidParams)],null,g,e,!0),e;if(this.loaded&&!this.isQueryable())return this._resolve([Error("Layer does not support query capability.")],null,g,e,!0),e;this._ts&&(r._ts=(new Date).getTime());(e._pendingDfd=this._task[a](r)).addCallbacks(function(c){var g=!!r.outStatistics||t||n||k;if("execute"===a||"executeRelationshipQuery"===a){var f,h;if("execute"===a)for(f=c.features,h=f.length,--h;0<=h;h--){if(f[h]._layer=m,!g&&!m._isTable){var l=m._mode._getFeature(f[h].attributes[m.objectIdField]);
l&&f.splice(h,1,l)}}else for(l in c)if(c.hasOwnProperty(l))for(f=c[l].features,h=f.length,--h;0<=h;h--)f[h]._layer=m}m._resolve([c],b,d,e)},function(a){m._resolve([a],null,g,e,!0)});return e},_convertFeaturesToJson:function(a,b,c,d){var g=[],m=this._selectionSymbol,f=this.visibilityField,e,r=this.objectIdField;this.loaded&&(c||d)&&(e=l.filter(this.fields,function(a){return!1===a.editable&&(!d||a.name!==r)}));for(c=0;c<a.length;c++){var t=a[c],u={},k=t.geometry,w=t.attributes,v=t.symbol;!k||d&&this.loaded&&
!this.allowGeometryUpdates||(u.geometry=k.toJson());f?(u.attributes=w=n.mixin({},w),w[f]=t.visible?1:0):w&&(u.attributes=n.mixin({},w));u.attributes&&e&&e.length&&l.forEach(e,function(a){delete u.attributes[a.name]});v&&v!==m&&(u.symbol=v.toJson());g.push(u)}return b?g:h.toJson(g)},_selectHandler:function(a,b,c,d,g){var m;switch(b){case aa.SELECTION_NEW:this.clearSelection(!0);m=!0;break;case aa.SELECTION_ADD:m=!0;break;case aa.SELECTION_SUBTRACT:m=!1}d=a.features;var f=this._mode,h=[],e=this.objectIdField,
r,l;if(m)for(m=0;m<d.length;m++)r=d[m],l=r.attributes[e],r=f._addFeatureIIf(l,r),h.push(r),this._selectFeatureIIf(l,r,f);else for(m=0;m<d.length;m++)r=d[m],l=r.attributes[e],this._unSelectFeatureIIf(l,f),l=f._removeFeatureIIf(l),h.push(l||r);this._isSelOnly&&f._applyTimeFilter(!0);this._hasPartialSelectedFeatures=!!a.exceededTransferLimit;this._resolve([h,b,a.exceededTransferLimit?{queryLimitExceeded:!0}:null],"onSelectionComplete",c,g);if(a.exceededTransferLimit)this.onQueryLimitExceeded()},_selectFeatureIIf:function(a,
b,c){var d=this._selectedFeatures,g=d[a];g||(c._incRefCount(a),d[a]=b,this._isTable||(this._setSelectSymbol(b),b.attr("data-selected","")));return g||b},_unSelectFeatureIIf:function(a,b){var c=this._selectedFeatures[a];c&&(b._decRefCount(a),delete this._selectedFeatures[a],this._isTable||(this._setUnSelectSymbol(c),c.attr("data-selected")));return c},_isSelected:function(a){},_setSelectSymbol:function(a){var b=this._selectionSymbol;b&&!this._isSelOnly&&a.setSymbol(b)},_setUnSelectSymbol:function(a){var b=
this._selectionSymbol;b&&!this._isSelOnly&&b===a.symbol&&a.setSymbol(null,!0)},_getOutFields:function(){var a=[this.objectIdField,this.typeIdField,this.creatorField,this._startTimeField,this._endTimeField,this._trackIdField].concat(this._requiredFields).concat(this.dataAttributes),a=l.filter(a,function(a,b,c){return!!a&&l.indexOf(c,a)===b}),b=n.clone(this._outFields);if(b){if(-1!==l.indexOf(b,"*"))return b;l.forEach(a,function(a){-1===l.indexOf(b,a)&&b.push(a)});return b}return a},_checkFields:function(a){var b=
a||this._getOutFields();l.forEach(b,function(a){"*"!==a&&(this._getField(a)||console.debug("esri.layers.FeatureLayer: "+t.substitute({url:this.url,field:a},"unable to find '${field}' field in the layer 'fields' information [url: ${url}]")))},this);a||this._isTable||this._fserver||this._collection||this._isStream||l.some(this.fields,function(a){return a&&"esriFieldTypeGeometry"===a.type?!0:!1})||console.debug("esri.layers.FeatureLayer: "+t.substitute({url:this.url},"unable to find a field of type 'esriFieldTypeGeometry' in the layer 'fields' information. If you are using a map service layer, features will not have geometry [url: ${url}]"))},
_fixFieldCase:function(a,b,c){var d=a&&a[b],g;if(d&&!n.isFunction(d)){if(g=!this._getField(d)&&this._getField(d,!0))d=a[b]=g.name;c&&c.push(d)}return d},_fixRendererFields:function(){var a=this.renderer;this._orderBy=null;this._requiredFields=[];if(a&&0<this.fields.length){var b=[],c,a=l.filter([a,a.observationRenderer,a.latestObservationRenderer,a.trackRenderer],t.isDefined),d=[].concat(a);l.forEach(a,function(a){l.forEach(a.rendererInfos,function(a){a.renderer&&d.push(a.renderer)})});l.forEach(d,
function(a){this._fixFieldCase(a,"attributeField",b);this._fixFieldCase(a,"attributeField2",b);this._fixFieldCase(a,"attributeField3",b);this._fixFieldCase(a.rotationInfo,"field",b);(c=this._fixFieldCase(a.sizeInfo,"field",b))&&!this._orderBy&&(this._orderBy=[c+" DESC"]);this._fixFieldCase(a.sizeInfo,"normalizationField",b);this._fixFieldCase(a.colorInfo,"field",b);this._fixFieldCase(a.colorInfo,"normalizationField",b);this._fixFieldCase(a.field,"field",b);this._fixFieldCase(a.opacityInfo,"field",
b);this._fixFieldCase(a.opacityInfo,"normalizationField",b);l.forEach(a.visualVariables,function(a){c=this._fixFieldCase(a,"field",b);"sizeInfo"===a.type&&c&&!this._orderBy&&(this._orderBy=[c+" DESC"]);this._fixFieldCase(a,"normalizationField",b)},this);var d=l.map(a.getFieldsUsedInExpressions(),function(a){var b=this.getField(a);return b?b.name:a},this);b=b.concat(d);this._orderBy||!a.addBreak||n.isFunction(a.attributeField)||!a.backgroundFillSymbol&&!this._hasSizeDiff(a)||(this._orderBy=[a.attributeField+
" DESC"])},this);this._requiredFields=l.filter(b,t.isDefined)}},_hasSizeDiff:function(a){var b=Number.MAX_VALUE,c=-Number.MAX_VALUE,d,g;l.forEach(a.infos,function(a){if(g=a.symbol){d=0;switch(g.type){case "simplemarkersymbol":d=g.size;break;case "picturemarkersymbol":d=(g.width+g.height)/2;break;case "simplelinesymbol":case "cartographiclinesymbol":d=g.width;break;case "simplefillsymbol":case "picturefillsymbol":d=g.outline&&g.outline.width}d&&(b=Math.min(b,d),c=Math.max(c,d))}});return b!==Number.MAX_VALUE&&
c!==-Number.MAX_VALUE&&1<Math.abs(c-b)},getOrderByFields:function(){var a=this.orderByFields||this._orderBy;return this.supportsAdvancedQueries&&a?l.filter(a,function(a){a=a.split(" ")[0];return!!this._getField(a,!0)},this):null},_getField:function(a,b){var c=this.fields;if(!c||0===c.length)return null;var d;b&&(a=a.toLowerCase());l.some(c,function(c){var g=!1;(g=b?c&&c.name.toLowerCase()===a?!0:!1:c&&c.name===a?!0:!1)&&(d=c);return g});return d},_getDateOpts:function(){this._dtOpts||(this._dtOpts=
{properties:l.map(l.filter(this.fields,function(a){return!(!a||"esriFieldTypeDate"!==a.type)}),function(a){return a.name})});return this._dtOpts},_applyNormalized:function(a,b){a&&b&&l.forEach(a,function(a,c){a&&b[c]&&a.setGeometry(b[c])})},_editHandler:function(a,b,c,d,g,m){g=a.addResults;var f=a.updateResults;a=a.deleteResults;var h,e,r,t,u,k=this.objectIdField,w=this._mode,v=this._isTable;h=this.editFieldsInfo;t=this.getOutFields()||[];var p=h&&h.creatorField,q=h&&h.creationDateField,z=h&&h.editorField,
y=h&&h.editDateField;h=h&&h.realm;-1===l.indexOf(t,"*")&&(p&&-1===l.indexOf(t,p)&&(p=null),q&&-1===l.indexOf(t,q)&&(q=null),z&&-1===l.indexOf(t,z)&&(z=null),y&&-1===l.indexOf(t,y)&&(y=null));var x=q||y?(new Date).getTime():null,B=p||z?this.getUserId():void 0;B&&h&&(B=B+"@"+h);if(g){var C=this.globalIdField;for(h=0;h<g.length;h++)g[h]=new Z(g[h]),v||(e=g[h],e.success&&(r=e.objectId,t=b[h],(u=t._graphicsLayer)&&u!==this&&u.remove(t),u=t.attributes||{},u[k]=r,r=e.globalId,C&&r&&(u[C]=r),p&&(u[p]=B),
z&&(u[z]=B),q&&(u[q]=x),y&&(u[y]=x),t.setAttributes(u),w._init&&w.drawFeature(t)))}if(f)for(h=0;h<f.length;h++)if(f[h]=new Z(f[h]),!v&&(e=f[h],e.success)){r=e.objectId;t=c[r];if(b=w._getFeature(r))b.geometry!==t.geometry&&t.geometry&&b.setGeometry(O.fromJson(t.geometry.toJson())),b.attributes!==t.attributes&&t.attributes&&b.setAttributes(n.mixin(b.attributes,t.attributes)),this._repaint(b,r);t=b||t;u=t.attributes||{};z&&(u[z]=B);y&&(u[y]=x);t.setAttributes(u)}if(a){c=[];for(h=0;h<a.length;h++)if(a[h]=
new Z(a[h]),!v&&(e=a[h],e.success&&(r=e.objectId,t=w._getFeature(r))))this._unSelectFeatureIIf(r,w)&&c.push(t),t._count=0,w._removeFeatureIIf(r);if(0<c.length)this.onSelectionComplete(c,aa.SELECTION_SUBTRACT)}this._resolve([g,f,a],"onEditsComplete",d,m)},_sendAttachment:function(a,b,c,d,g){var m=this;return v({url:this._url.path+"/"+b+"/"+("add"===a?"addAttachment":"updateAttachment"),form:c,content:n.mixin(this._url.query,{f:"json",token:this._getToken()||void 0}),callbackParamName:"callback.html",
handleAs:"json"}).addCallback(function(c){var g="add"===a?"onAddAttachmentComplete":"onUpdateAttachmentComplete";c=new Z(c["add"===a?"addAttachmentResult":"updateAttachmentResult"]);c.attachmentId=c.objectId;c.objectId=b;m._resolve([c],g,d);return c}).addErrback(function(a){m._resolve([a],null,g,null,!0)})},_repaint:function(a,b,c){b=t.isDefined(b)?b:a.attributes[this.objectIdField];b in this._selectedFeatures&&this._selectionSymbol||a.setSymbol(a.symbol,c)},_getKind:function(a){var b=this._trackManager;
return b?b.isLatestObservation(a)?1:0:0}});n.mixin(aa,{MODE_SNAPSHOT:0,MODE_ONDEMAND:1,MODE_SELECTION:2,SELECTION_NEW:3,SELECTION_ADD:4,SELECTION_SUBTRACT:5,MODE_AUTO:6,MODE_STREAM:7,POPUP_NONE:"esriServerHTMLPopupTypeNone",POPUP_HTML_TEXT:"esriServerHTMLPopupTypeAsHTMLText",POPUP_URL:"esriServerHTMLPopupTypeAsURL"});S._createWrappers(aa);return aa})},"esri/layers/Field":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ./RangeDomain ./CodedValueDomain".split(" "),function(k,
e,p,q,n,l){return k(null,{declaredClass:"esri.layers.Field",constructor:function(h){if(h&&e.isObject(h)&&(this.name=h.name,this.type=h.type,this.alias=h.alias,this.length=h.length,this.editable=h.editable,this.nullable=h.nullable,(h=h.domain)&&e.isObject(h)))switch(h.type){case "range":this.domain=new n(h);break;case "codedValue":this.domain=new l(h)}}})})},"esri/layers/RangeDomain":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../lang ./Domain".split(" "),function(k,e,
p,q,n,l){return k([l],{declaredClass:"esri.layers.RangeDomain",constructor:function(h){h&&e.isObject(h)&&(this.minValue=h.range[0],this.maxValue=h.range[1])},toJson:function(){var h=this.inherited(arguments);h.range=[this.minValue,this.maxValue];return n.fixJson(h)}})})},"esri/layers/Domain":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel","../lang"],function(k,e,p,q,n){return k(null,{declaredClass:"esri.layers.Domain",constructor:function(l){l&&e.isObject(l)&&(this.name=
l.name,this.type=l.type)},toJson:function(){return n.fixJson({name:this.name,type:this.type})}})})},"esri/layers/CodedValueDomain":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has ../kernel ../lang ./Domain".split(" "),function(k,e,p,q,n,l,h){return k([h],{declaredClass:"esri.layers.CodedValueDomain",constructor:function(f){f&&e.isObject(f)&&(this.codedValues=f.codedValues)},getName:function(f){var d;p.some(this.codedValues,function(c){c.code==f&&(d=c.name);return!!d});
return d},toJson:function(){var f=this.inherited(arguments);f.codedValues=e.clone(this.codedValues);return l.fixJson(f)}})})},"esri/layers/FeatureType":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has ../kernel ../lang ../symbols/jsonUtils ./RangeDomain ./CodedValueDomain ./InheritedDomain ./FeatureTemplate".split(" "),function(k,e,p,q,n,l,h,f,d,c,a){return k(null,{declaredClass:"esri.layers.FeatureType",constructor:function(b){if(b&&e.isObject(b)){this.id=b.id;this.name=
b.name;var g=b.symbol;g&&(this.symbol=h.fromJson(g));var g=b.domains,l,m=this.domains={};for(l in g)if(g.hasOwnProperty(l)){var r=g[l];switch(r.type){case "range":m[l]=new f(r);break;case "codedValue":m[l]=new d(r);break;case "inherited":m[l]=new c(r)}}if(l=b.templates)for(g=this.templates=[],b=0;b<l.length;b++)g.push(new a(l[b]))}},toJson:function(){var a={id:this.id,name:this.name,symbol:this.symbol&&this.symbol.toJson()},c,d=this.domains,m=this.templates,f=l.fixJson;if(d){var h=a.domains={};for(c in d)d.hasOwnProperty(c)&&
(h[c]=d[c]&&d[c].toJson());f(h)}m&&(a.templates=p.map(m,function(a){return a.toJson()}));return f(a)}})})},"esri/layers/InheritedDomain":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel","./Domain"],function(k,e,p,q,n){return k([n],{declaredClass:"esri.layers.InheritedDomain"})})},"esri/layers/FeatureTemplate":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../lang ../graphic".split(" "),function(k,e,p,q,n,l){k=k(null,{declaredClass:"esri.layers.FeatureTemplate",
constructor:function(h){h&&e.isObject(h)&&(this.name=h.name,this.description=h.description,this.drawingTool=h.drawingTool,this.thumbnail=h.thumbnail,h=h.prototype,this.prototype=new l(h.geometry,null,h.attributes))},toJson:function(){return n.fixJson({name:this.name,description:this.description,drawingTool:this.drawingTool,thumbnail:n.fixJson(e.clone(this.thumbnail)),prototype:this.prototype&&this.prototype.toJson()})}});e.mixin(k,{TOOL_AUTO_COMPLETE_POLYGON:"esriFeatureEditToolAutoCompletePolygon",
TOOL_CIRCLE:"esriFeatureEditToolCircle",TOOL_ELLIPSE:"esriFeatureEditToolEllipse",TOOL_FREEHAND:"esriFeatureEditToolFreehand",TOOL_LINE:"esriFeatureEditToolLine",TOOL_NONE:"esriFeatureEditToolNone",TOOL_POINT:"esriFeatureEditToolPoint",TOOL_POLYGON:"esriFeatureEditToolPolygon",TOOL_RECTANGLE:"esriFeatureEditToolRectangle",TOOL_ARROW:"esriFeatureEditToolArrow",TOOL_TRIANGLE:"esriFeatureEditToolTriangle",TOOL_LEFT_ARROW:"esriFeatureEditToolLeftArrow",TOOL_RIGHT_ARROW:"esriFeatureEditToolRightArrow",
TOOL_UP_ARROW:"esriFeatureEditToolUpArrow",TOOL_DOWN_ARROW:"esriFeatureEditToolDownArrow"});return k})},"esri/layers/FeatureEditResult":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel"],function(k,e,p,q){return k(null,{declaredClass:"esri.layers.FeatureEditResult",constructor:function(n){n&&e.isObject(n)&&(this.objectId=n.objectId,this.globalId=n.globalId,this.success=n.success,n.success||(n=n.error,this.error=Error(),this.error.code=n.code,this.error.message=n.description))}})})},
"esri/layers/LabelClass":function(){define("dojo/_base/declare dojo/_base/lang dojo/has dojox/gfx/_base ../kernel ../lang ../symbols/TextSymbol ../symbols/ShieldLabelSymbol".split(" "),function(k,e,p,q,n,l,h,f){var d=/__begin__/ig,c=/__end__/ig,a=/^__begin__/i,b=/__end__$/i;return k(null,{declaredClass:"esri.layers.LabelClass",labelPlacement:null,labelExpression:null,format:null,fieldInfos:null,useCodedValues:null,symbol:null,maxScale:0,minScale:0,where:null,sizeInfo:null,_labelPlacementLookup:{"above-center":"esriServerPointLabelPlacementAboveCenter",
"above-left":"esriServerPointLabelPlacementAboveLeft","above-right":"esriServerPointLabelPlacementAboveRight","below-center":"esriServerPointLabelPlacementBelowCenter","below-left":"esriServerPointLabelPlacementBelowLeft","below-right":"esriServerPointLabelPlacementBelowRight","center-center":"esriServerPointLabelPlacementCenterCenter","center-left":"esriServerPointLabelPlacementCenterLeft","center-right":"esriServerPointLabelPlacementCenterRight","above-after":"esriServerLinePlacementAboveAfter",
"above-along":"esriServerLinePlacementAboveAlong","above-before":"esriServerLinePlacementAboveBefore","above-start":"esriServerLinePlacementAboveStart","above-end":"esriServerLinePlacementAboveEnd","below-after":"esriServerLinePlacementBelowAfter","below-along":"esriServerLinePlacementBelowAlong","below-before":"esriServerLinePlacementBelowBefore","below-start":"esriServerLinePlacementBelowStart","below-end":"esriServerLinePlacementBelowEnd","center-after":"esriServerLinePlacementCenterAfter","center-along":"esriServerLinePlacementCenterAlong",
"center-before":"esriServerLinePlacementCenterBefore","center-start":"esriServerLinePlacementCenterStart","center-end":"esriServerLinePlacementCenterEnd","always-horizontal":"esriServerPolygonPlacementAlwaysHorizontal"},constructor:function(a){a&&(e.mixin(this,a),this._labelPlacementLookup.hasOwnProperty(this.labelPlacement)||(this.labelPlacement=l.valueOf(this._labelPlacementLookup,a.labelPlacement)),a.format&&(this.format=a.format),a.fieldInfos&&(this.fieldInfos=a.fieldInfos),a.symbol&&(this.symbol=
"esriSHD"===a.symbol.type?new f(a.symbol):new h(a.symbol)),a=this.sizeInfo)&&(a.minSize&&(a.minSize=q.pt2px(a.minSize)),a.maxSize&&(a.maxSize=q.pt2px(a.maxSize)))},getSymbol:function(){return this.symbol},toJson:function(){var a=this.sizeInfo;a&&(a=e.mixin({},a),a.minSize&&(a.minSize=q.px2pt(a.minSize)),a.maxSize&&(a.maxSize=q.px2pt(a.maxSize)));var b=l.fixJson(this.labelExpressionInfo&&e.clone(this.labelExpressionInfo));this._processLabelExpressionInfo(b);a={name:this.name,labelExpression:this.labelExpression,
labelExpressionInfo:b,format:this.format||void 0,fieldInfos:this.fieldInfos||void 0,useCodedValues:this.useCodedValues,maxScale:this.maxScale,minScale:this.minScale,where:this.where,sizeInfo:a||void 0,labelPlacement:this._labelPlacementLookup.hasOwnProperty(this.labelPlacement)?this._labelPlacementLookup[this.labelPlacement]:this.labelPlacement,symbol:this.symbol&&this.symbol.toJson()};return l.fixJson(a)},_processLabelExpressionInfo:function(a){a&&a.value&&(a.expression=this._convertTemplatedStringToArcade(a.value))},
_convertTemplatedStringToArcade:function(g){var f;g&&(f=e.replace(g,function(a,b){return'__begin__$feature["'+b+'"]__end__'}),f=a.test(f)?f.replace(a,""):'"'+f,f=b.test(f)?f.replace(b,""):f+'"',f=f.replace(d,'" + ').replace(c,' + "'));return f}})})},"esri/symbols/ShieldLabelSymbol":function(){define("dojo/_base/declare dojo/_base/lang dojo/sniff dojox/gfx/_base ../kernel ../lang ../urlUtils ./MarkerSymbol ./Font".split(" "),function(k,e,p,q,n,l,h,f,d){var c={url:"",width:12,height:12,angle:0,xoffset:0,
yoffset:0};k=k(f,{declaredClass:"esri.symbol.ShieldLabelSymbol",type:"shieldlabelsymbol",color:[255,255,255,1],width:32,height:32,font:q.defaultFont,constructor:function(a,b,d,f,m){a?e.isString(a)?(this.url=a,b&&(this.color=b),d&&(this.width=d),f&&(this.height=f),void 0!==m&&(this.font=m)):(this.width=q.pt2px(a.width),this.height=q.pt2px(a.height),b=a.imageData,9>p("ie")||!b||(d=this.url,this.url="data:"+(a.contentType||"image")+";base64,"+b,this.imageData=d)):e.mixin(this,c)},getStroke:function(){return null},
getFill:function(){return this.color},setWidth:function(a){this.width=a;return this},setHeight:function(a){this.height=a;return this},setUrl:function(a){a!==this.url&&(delete this.imageData,delete this.contentType);this.url=a;return this},setFont:function(a){this.font=a;return this},setText:function(a){this.text=a;return this},getWidth:function(){return this.width},getHeight:function(){return this.height},getShapeDescriptors:function(){return{defaultShape:{type:"image",x:-Math.round(this.width/2),
y:-Math.round(this.height/2),width:this.width,height:this.height,src:this.url||""},fill:null,stroke:null}},toJson:function(){var a=this.url,b=this.imageData;if(0===a.indexOf("data:"))var c=a,a=b,b=c.indexOf(";base64,")+8,b=c.substr(b);var a=h.getAbsoluteUrl(a),c=q.px2pt(this.width),c=isNaN(c)?void 0:c,f=q.px2pt(this.height),f=isNaN(f)?void 0:f,a=l.fixJson(e.mixin(this.inherited("toJson",arguments),{type:"esriSHD",url:a,imageData:b,contentType:this.contentType,width:c,height:f}));this.font?(b=new d(this.font),
a.font=b.toJson()):a.font=null;delete a.size;a.imageData||delete a.imageData;return a}});k.defaultProps=c;return k})},"esri/layers/SnapshotMode":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../SpatialReference ../srUtils ../tasks/query ./RenderMode ./support/ParallelSnapshot".split(" "),function(k,e,p,q,n,l,h,f,d){return k([f],{declaredClass:"esri.layers._SnapshotMode",maxFeatures:5E4,constructor:function(c){this.featureLayer=c;this._featureMap={};this._hasPartialFeatures=
!1;this._drawFeatures=e.hitch(this,this._drawFeatures);this._queryErrorHandler=e.hitch(this,this._queryErrorHandler);this._handleSuccess=e.hitch(this,this._handleSuccess);this._handleError=e.hitch(this,this._handleError);this._handleProgress=e.hitch(this,this._handleProgress)},startup:function(){if(!this._started){this.inherited(arguments);var c=this.featureLayer,a=c.advancedQueryCapabilities,b=c.reHostedFS.test(c.url);this.pagination=c.queryPagination&&null!=c.maxRecordCount;this._tileQueriesAllowed=
b&&a&&a.supportsQueryWithResultType&&c.isFeatureReductionApplied();b&&this.pagination&&(this._parallelSnapshot=new d({layer:c,mode:this,queryTask:c._task}));c._collection?this._applyTimeFilter():this._fetchAll()}},propertyChangeHandler:function(c){this._init&&(c?this.featureLayer._collection?console.log("FeatureLayer: layer created by value (from a feature collection) does not support definition expressions and time definitions. Layer id \x3d "+this.featureLayer.id):this._fetchAll():this._applyTimeFilter())},
destroy:function(){this._cancelPendingRequest(this._pendingRequest);this._parallelSnapshot&&this._parallelSnapshot.destroy();this.inherited(arguments)},drawFeature:function(c){var a=c.attributes[this.featureLayer.objectIdField];this._addFeatureIIf(a,c);this._incRefCount(a)},resume:function(){this.propertyChangeHandler(0)},refresh:function(){var c=this.featureLayer;c._collection?(c._fireUpdateStart(),c._refresh(!0),c._fireUpdateEnd()):this._fetchAll()},hasAllFeatures:function(){return!this._hasPartialFeatures},
_fetchAll:function(){var c=this.featureLayer;c._collection||c.suspended||!c.isQueryable()||(c._fireUpdateStart(),this._clearIIf(),this._hasPartialFeatures=!1,this._parallelSnapshot?this._parallelSnapshot.fetch(this._createQuery()).then(this._handleSuccess,this._handleError,this._handleProgress):this._sendRequest())},_handleSuccess:function(c){this._hasPartialFeatures=c.hasPartialFeatures;this.featureLayer._fireUpdateEnd(null)},_handleError:function(c){this._queryErrorHandler(c)},_handleProgress:function(c){c.isError?
this.featureLayer._errorHandler(c.error):this._addFeatures(c.features)},_sendRequest:function(c){var a=this.featureLayer,b=this._createQuery();this.pagination&&(this._start=b.start=null==c?0:c,b.num=a.maxRecordCount);this._pendingRequest&&this._cancelPendingRequest(this._pendingRequest);this._pendingRequest=a._task.execute(b,this._drawFeatures,this._queryErrorHandler)},_drawFeatures:function(c){this._pendingRequest=null;var a=this.featureLayer,b=c.exceededTransferLimit,d=b&&!a._collection;c=this._checkMaxLimit(c.features);
var f=c.maxLimitReached;this._addFeatures(c.features);this.pagination&&d&&!f||(this._hasPartialFeatures=!!b,a._fireUpdateEnd(null,b?{queryLimitExceeded:!0}:null));d&&(this.pagination&&!f&&this._sendRequest(this._start+a.maxRecordCount),a.onQueryLimitExceeded())},_queryErrorHandler:function(c){this._pendingRequest=null;this._hasPartialFeatures=!0;var a=this.featureLayer;a._errorHandler(c);a._fireUpdateEnd(c)},_checkMaxLimit:function(c){var a=c?c.length:0,b=this.featureLayer.graphics.length+a,d=b>=
this.maxFeatures;if(d){var f=b-this.maxFeatures;f&&c.splice(a-f,f)}return{maxLimitReached:d,featuresDiscarded:b>this.maxFeatures,features:c}},_createQuery:function(){var c=this.featureLayer,a=new h;a.outFields=c.getOutFields();a.where=c.getDefinitionExpression()||"1\x3d1";a.returnGeometry=!0;a.outSpatialReference=l.createSpatialReference(this.map.spatialReference.toJson());a.timeExtent=c.getTimeDefinition();a.maxAllowableOffset=c._maxOffset;a.quantizationParameters=c._quantizationParameters;a.orderByFields=
c.supportsAdvancedQueries?c.getOrderByFields():null;a.multipatchOption=c.multipatchOption;c._ts&&(a._ts=(new Date).getTime());this._tileQueriesAllowed&&(a.resultType="tile");return a},_addFeatures:function(c){var a=this.featureLayer,b=a.objectIdField,d=c.length,f=a._selectedFeatures,m=a.mode===a.constructor.MODE_AUTO,h,e,l;a._fireUpdateStart();a._sortFeatures(c);for(a=0;a<d;a++)e=c[a],l=e.attributes[b],h=this._addFeatureIIf(l,e),this._incRefCount(l),m&&h!==e&&f[l]&&(h.setGeometry(e.geometry),h.setAttributes(e.attributes));
this._applyTimeFilter(!0)}})})},"esri/layers/RenderMode":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/_base/array","dojo/has","../kernel"],function(k,e,p,q,n){return k(null,{declaredClass:"esri.layers._RenderMode",initialize:function(e){this.map=e;this._init=!0},startup:function(){this._started=!0},propertyChangeHandler:function(e){},destroy:function(){this._init=this._started=!1},drawFeature:function(e){},suspend:function(){},resume:function(){},refresh:function(){},hasAllFeatures:function(){return!0},
_incRefCount:function(e){(e=this._featureMap[e])&&e._count++},_decRefCount:function(e){(e=this._featureMap[e])&&e._count--},_getFeature:function(e){return this._featureMap[e]},_addFeatureIIf:function(e,h){var f=this._featureMap,d=f[e],c=this.featureLayer;d||(f[e]=h,c._add(h),h._count=0);return d||h},_removeFeatureIIf:function(e){var h=this._featureMap[e],f=this.featureLayer;if(h){if(h._count)return;delete this._featureMap[e];f._remove(h)}return h},_clearIIf:function(){var e;e=this.featureLayer;var h=
e.graphics,f=e._selectedFeatures,d=e.getSelectedFeatures().length,c=e.objectIdField;if(d)for(e=h.length-1;0<=e;e--){var d=h[e],a=d.attributes[c];a in f?d._count=1:(d._count=0,this._removeFeatureIIf(a))}else e.clear(),this._featureMap={}},_cancelPendingRequest:function(e){if(e)try{e.cancel()}catch(h){}},_toggleVisibility:function(e){var h=this.featureLayer,f=h.graphics,d=e?"show":"hide",c,a=f.length;e=e&&h._ager;for(c=0;c<a;c++){var b=f[c];b[d]();e&&h._repaint(b)}},_applyTimeFilter:function(e){var h=
this.featureLayer;if(h.timeInfo&&!h.suspended){e||h._fireUpdateStart();var f=h._trackManager;f&&f.clearTracks();var d=h.getTimeDefinition(),c=h._getOffsettedTE(h._mapTimeExtent);c?(c=h._getTimeOverlap(d,c))?(d=h._filterByTime(h.graphics,c.startTime,c.endTime),f&&f.addFeatures(d.match),p.forEach(d.match,function(a){var b=a._shape;a.visible||(a.show(),(b=a._shape)&&b._moveToFront());h._ager&&b&&h._repaint(a)}),p.forEach(d.noMatch,function(a){a.visible&&a.hide()})):this._toggleVisibility(!1):(f&&f.addFeatures(h.graphics),
this._toggleVisibility(!0));f&&(f.moveLatestToFront(),f.drawTracks());e||h._fireUpdateEnd()}}})})},"esri/layers/support/ParallelSnapshot":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has dojo/Deferred ../../kernel".split(" "),function(k,e,p,q,n,l){return k(null,{declaredClass:"esri.layers.support.ParallelSnapshot",layer:null,mode:null,queryTask:null,batchSize:5,_query:null,_fetchDfd:null,_startPage:null,_lastPage:null,_maxPage:null,_requests:null,constructor:function(h){e.mixin(this,
h);this._requests={};this._maxPage=Math.ceil(this.mode.maxFeatures/this.layer.maxRecordCount)},destroy:function(){this.cancel()},fetch:function(h){var f=new n;this.cancel(!0);this._query=h;this._fetchDfd=f;this._sendRequests();return f.promise},cancel:function(h){this._cancelPendingRequests(h);this._reset()},_reset:function(){this._startPage=this._lastPage=null;this._requests={}},_sendRequests:function(h){var f=this._query,d=this.queryTask,c=this._requests,a=this.layer.maxRecordCount,b;h=null==h?
1:h;b=h+this.batchSize-1;b>this._maxPage&&(b=this._maxPage);if(!(h>b))for(this._startPage=h,this._lastPage=b;h<=b;h++)f.start=(h-1)*a,f.num=a,c[h]=d.execute(f),c[h].then(e.hitch(this,this._handleSuccess,h)).otherwise(e.hitch(this,this._handleError,h))},_evalNextBatch:function(h){h===this._lastPage&&this._sendRequests(this._lastPage+1)},_handleSuccess:function(h,f){f.exceededTransferLimit||this._cancelLaterRequests(h,!0);var d=this.mode._checkMaxLimit(f.features);this._fetchDfd.progress({features:d.features,
isError:!1});d.maxLimitReached?((h=d.featuresDiscarded||this._hasRejectedRequests())||(h=!!this._getResult(this._getLastSuccessfulRequest()).exceededTransferLimit),this._resolveFetch(h)):(f.exceededTransferLimit&&this._evalNextBatch(h),this._evalResolution())},_handleError:function(h,f){var d=this._requests;d&&d[h]&&(1===h?this._rejectFetch(f):(this._evalNextBatch(h),this._fetchDfd.progress({error:f,isError:!0}),this._evalResolution()))},_evalResolution:function(){this._hasPendingRequests()||this._resolveFetch(this._hasRejectedRequests())},
_resolveFetch:function(h){this.cancel(!0);this._fetchDfd.resolve({hasPartialFeatures:h})},_rejectFetch:function(h){this.cancel(!0);this._fetchDfd.reject(h)},_getResult:function(h){return h&&h.dfd.results[0]},_hasPendingRequests:function(){return!!this._getPendingRequests().length},_getPendingRequests:function(){var h=this._requests,f,d=[];for(f in h){var c=h[f];c.isFulfilled()||d.push({pageId:Number(f),dfd:c})}return d},_getLastSuccessfulRequest:function(){var h=this._getResolvedRequests(),f=-Infinity,
d,h=p.filter(h,function(c){return!!this._getResult(c).features.length||1===c.pageId},this);p.forEach(h,function(c){c.pageId>f&&(f=c.pageId,d=c)});return d},_getResolvedRequests:function(){var h=this._requests,f,d=[];for(f in h){var c=h[f];c.isResolved()&&d.push({pageId:Number(f),dfd:c})}return d},_hasRejectedRequests:function(){var h=this._getRejectedRequests(),f=this._getLastSuccessfulRequest(),d=this._getResult(f);d&&!d.exceededTransferLimit&&(h=p.filter(h,function(c){return c.pageId<=f.pageId}));
return!!h.length},_getRejectedRequests:function(){var h=this._requests,f,d=[];for(f in h){var c=h[f];c.isRejected()&&d.push({pageId:Number(f),dfd:c})}return d},_cancelPendingRequests:function(h){this._cancelRequests(this._getPendingRequests(),h)},_cancelLaterRequests:function(h,f){var d=p.filter(this._getPendingRequests(),function(c){return c.pageId>h});this._cancelRequests(d,f)},_cancelRequests:function(h,f){var d=this.mode,c=this._requests;p.forEach(h,function(a){f&&delete c[a.pageId];d._cancelPendingRequest(a.dfd)})}})})},
"esri/layers/OnDemandMode":function(){define("dojo/_base/declare dojo/_base/connect dojo/_base/lang dojo/_base/array dojo/has ../kernel ../geometry/Point ../tasks/query ./RenderMode ./GridLayout".split(" "),function(k,e,p,q,n,l,h,f,d,c){return k([d],{declaredClass:"esri.layers._OnDemandMode",constructor:function(a){this.featureLayer=a;this._featureMap={};this._hasPartialFeatures=!1;this._queryErrorHandler=p.hitch(this,this._queryErrorHandler)},initialize:function(a){this.inherited(arguments);var b=
this.featureLayer,d=b._srInfo;this._gridLayer=new c(new h(d?d.valid[0]:a.extent.xmin,d?d.valid[1]:a.extent.ymax,a.spatialReference),{width:b._tileWidth,height:b._tileHeight},{width:a.width,height:a.height},d);this._cellMap={};this._gridLayer.setResolution(a.extent)},startup:function(){this._started||(this.inherited(arguments),this._ioQueue=[],this.featureLayer.suspended||(this._zoomHandler(),this._enableConnectors()))},propertyChangeHandler:function(a){this._init&&(2>a?this._zoomHandler():console.log("FeatureLayer: layer in on-demand mode does not support time definitions. Layer id \x3d "+
this.featureLayer.id+", Layer URL \x3d "+this.featureLayer.url))},destroy:function(){this._disableConnectors();this._processIOQueue(!0);this.inherited(arguments)},drawFeature:function(a){var b=a.geometry,c=[];if(b){var c=this._gridLayer.getCellsInExtent("point"===b.type?{xmin:b.x,ymin:b.y,xmax:b.x,ymax:b.y}:b.getExtent(),!1).cells,b=this._cellMap,d,m,f=a.attributes[this.featureLayer.objectIdField],h,e,l;for(d=0;d<c.length;d++)m=c[d],h=m.latticeID,e=m.row,l=m.col,h?m=b[h]=b[h]||m:(b[e]=b[e]||{},m=
b[e][l]=b[e][l]||m),m.features=m.features||[],m.features.push(a),this._addFeatureIIf(f,a),this._incRefCount(f)}},suspend:function(){this._init&&this._disableConnectors()},resume:function(){this._init&&(this._enableConnectors(),this._zoomHandler())},refresh:function(){this._zoomHandler()},hasAllFeatures:function(){if(this._hasPartialFeatures)return!1;var a=!1,b=this._getCurrentCells(),c;for(c=0;c<b.length;c++)if(b[c].hasPartialFeatures){a=!0;break}return!a},_enableConnectors:function(){var a=this.map;
this._zoomConnect=e.connect(a,"onZoomEnd",this,this._zoomHandler);this._panConnect=e.connect(a,"onPanEnd",this,this._panHandler);this._resizeConnect=e.connect(a,"onResize",this,this._panHandler)},_disableConnectors:function(){e.disconnect(this._zoomConnect);e.disconnect(this._panConnect);e.disconnect(this._resizeConnect)},_zoomHandler:function(){this._processIOQueue(!0);var a=this.featureLayer,b=this.map;!a.suspended&&a.isQueryable()&&(a._fireUpdateStart(),this._clearIIf(),this._hasPartialFeatures=
!1,(a=a._trackManager)&&a.clearTracks(),this._cellMap={},this._gridLayer.setResolution(b.extent),this._sendRequest())},_panHandler:function(a){if(this.featureLayer.isQueryable()){this.featureLayer._fireUpdateStart();var b=this.featureLayer._resized;a=b?a:null;b&&this._gridLayer.setMapState(a,this.map.width,this.map.height);this._sendRequest(a)}},_sendRequest:function(a){this._exceeds=!1;var b=this.featureLayer,c=this.map;a=a||c.extent;c=this._gridLayer.getCellsInExtent(a,b.latticeTiling).cells;if(!b.isEditable())var d=
this._cellMap,c=q.filter(c,function(a){if(a.lattice){if(d[a.latticeID])return!1}else if(d[a.row]&&d[a.row][a.col])return!1;return!0});var m=b.getOutFields(),h=b.getDefinitionExpression(),e=b._getOffsettedTE(b._mapTimeExtent),l=b.supportsAdvancedQueries?b.getOrderByFields():null,n=this._ioQueue,k,p=this,x=this._drawFeatures,A,C;this._pending=this._pending||0;for(k=0;k<c.length;k++){A=c[k];C=new f;C.geometry=A.extent||A.lattice;C.outFields=m;C.where=h;b.latticeTiling&&A.extent&&(C.spatialRelationship=
f.SPATIAL_REL_CONTAINS);C.returnGeometry=!0;C.timeExtent=e;b._ts&&(C._ts=(new Date).getTime());C.orderByFields=l;C.multipatchOption=b.multipatchOption;C.maxAllowableOffset=b._maxOffset;C.quantizationParameters=b._quantizationParameters;var B=b.advancedQueryCapabilities;B&&B.supportsQueryWithResultType&&(C.resultType="tile");this._pending++;n.push(b._task.execute(C,function(){var a=A;return function(b){x.apply(p,[b,a])}}.call(this),this._queryErrorHandler))}this._removeOldCells(a);this._endCheck()},
_drawFeatures:function(a,b){b.hasPartialFeatures=!!a.exceededTransferLimit;this._exceeds=this._exceeds||a.exceededTransferLimit;this._finalizeIO();var c=this.featureLayer,d=this.map.extent,m=b.extent,f=b.row,h=b.col,e=c.objectIdField;a=a.features;var l=this._gridLayer,n=this._cellMap,k=b.latticeID,p=k?n[k]:n[f]&&n[f][h];if(b.resolution==l._resolution&&(k?k===l.getLatticeID(d):l.intersects(m,d)))if(p)c._sortFeatures(a),this._updateCell(p,a);else for(c._sortFeatures(a),b.features=a,k?n[k]=b:(n[f]=n[f]||
{},n[f][h]=b),c=a.length,b=0;b<c;b++)d=a[b],m=d.attributes[e],this._addFeatureIIf(m,d),this._incRefCount(m);else p&&this._removeCell(f,h,k);this._endCheck()},_queryErrorHandler:function(a){this._finalizeIO();this._hasPartialFeatures=!0;this.featureLayer._errorHandler(a);this._endCheck(!0)},_finalizeIO:function(){this._pending--},_endCheck:function(a){if(0===this._pending){this._processIOQueue();var b=this.featureLayer,c=b._trackManager;c&&(c.clearTracks(),c.addFeatures(b.graphics),b._ager&&q.forEach(b.graphics,
function(a){a._shape&&b._repaint(a)}),c.moveLatestToFront(),c.drawTracks());this.featureLayer._fireUpdateEnd(a&&Error("FeatureLayer: an error occurred while updating the layer"),this._exceeds?{queryLimitExceeded:!0}:null);if(this._exceeds)b.onQueryLimitExceeded()}},_processIOQueue:function(a){this._ioQueue=q.filter(this._ioQueue,function(a){return-1<a.fired?!1:!0});a&&q.forEach(this._ioQueue,this._cancelPendingRequest)},_getCurrentCells:function(a){var b=[];a=a||this._cellMap;for(var c in a)if(a.hasOwnProperty(c)){var d=
a[c];d&&(d.hasOwnProperty("row")||d.hasOwnProperty("latticeID")?b.push(d):"object"===typeof d&&b.push.apply(b,this._getCurrentCells(d)))}return b},_removeOldCells:function(a){var b=this._cellMap,c=this._gridLayer,d,m;for(d in b)if(b[d]){var f=b[d],h=f.latticeID,e=0,l=0;if(h)e++,h!==c.getLatticeID(a)&&(this._removeCell(null,null,h),l++);else for(m in f)f[m]&&(e++,c.intersects(f[m].extent,a)||(this._removeCell(d,m),l++));l===e&&delete b[d]}},_updateCell:function(a,b){var c=this.featureLayer,d=c.objectIdField,
c=c._selectedFeatures,m,f=b.length;a.features=a.features||[];for(m=0;m<f;m++){var h=b[m],e=h.attributes[d],l=this._addFeatureIIf(e,h);l===h?(this._incRefCount(e),a.features.push(l)):e in c||(l.setGeometry(h.geometry),l.setAttributes(h.attributes))}},_removeCell:function(a,b,c){var d=this._cellMap,g=this.featureLayer,f=g.objectIdField,h=c?d[c]:d[a]&&d[a][b];if(h)for(c?delete d[c]:delete d[a][b],a=h.features,b=0;b<a.length;b++)c=a[b].attributes[f],this._decRefCount(c),c in g._selectedFeatures||this._removeFeatureIIf(c)}})})},
"esri/layers/GridLayout":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has ../kernel ../SpatialReference ../geometry/Extent ../geometry/Polyline ../srUtils".split(" "),function(k,e,p,q,n,l,h,f,d){return k(null,{declaredClass:"esri.layers._GridLayout",constructor:function(c,a,b,d){this.origin=c;this.cellWidth=a.width;this.cellHeight=a.height;this.mapWidth=b.width;this.mapHeight=b.height;this.srInfo=d},setResolution:function(c){this._resolution=(c.xmax-c.xmin)/this.mapWidth;
this.srInfo&&(c=Math.round(Math.round(2*this.srInfo.valid[1]/this._resolution)/this.cellWidth),this._frameStats=[c,0,c-1])},setMapState:function(c,a,b){this.mapWidth=a;this.mapHeight=b;this.setResolution(c)},getCellCoordinates:function(c){var a=this._resolution,b=this.origin;return{row:Math.floor((b.y-c.y)/(this.cellHeight*a)),col:Math.floor((c.x-b.x)/(this.cellWidth*a))}},normalize:function(c){var a=this._frameStats;if(a){var b=a[0],d=a[1],a=a[2];c<d?(c%=b,c=c<d?c+b:c):c>a&&(c%=b)}return c},intersects:function(c,
a){var b=this.srInfo;return b?p.some(a._getParts(b),function(a){return c.intersects(a.extent)}):c.intersects(a)},getCellExtent:function(c,a){var b=this._resolution,g=this.origin,f=this.cellWidth,m=this.cellHeight;return new h(a*f*b+g.x,g.y-(c+1)*m*b,(a+1)*f*b+g.x,g.y-c*m*b,d.createSpatialReference(g.spatialReference.toJson()))},getLatticeID:function(c){var a=this.getCellCoordinates({x:c.xmin,y:c.ymax}),b=this.getCellCoordinates({x:c.xmax,y:c.ymin});c=a.row;var d=b.row,a=this.normalize(a.col),b=this.normalize(b.col);
return c+"_"+d+"_"+a+"_"+b},sorter:function(c,a){return c<a?-1:1},getCellsInExtent:function(c,a){var b=this.getCellCoordinates({x:c.xmin,y:c.ymax}),d=this.getCellCoordinates({x:c.xmax,y:c.ymin}),h=b.row,m=d.row,b=b.col,d=d.col,e=[],l,n,k,w=[],q=[],x,A,C=[];for(l=h;l<=m;l++)for(n=b;n<=d;n++)k=this.normalize(n),c=this.getCellExtent(l,k),p.some(e,function(a){return a.row===l&&a.col===k})||e.push({row:l,col:k,extent:c,resolution:this._resolution}),a&&(w.push(c.xmin,c.xmax),q.push(c.ymin,c.ymax));b=this.normalize(b);
d=this.normalize(d);w.sort(this.sorter);q.sort(this.sorter);a=w.length;for(l=a-1;0<=l;l--)l<a-1&&w[l]===w[l+1]&&w.splice(l,1);a=q.length;for(l=a-1;0<=l;l--)l<a-1&&q[l]===q[l+1]&&q.splice(l,1);if(w.length&&q.length){c=w[0];n=w[w.length-1];x=q[0];A=q[q.length-1];a=w.length;for(l=0;l<a;l++)C.push([[w[l],A],[w[l],x]]);a=q.length;for(l=0;l<a;l++)C.push([[c,q[l]],[n,q[l]]]);w=new f({paths:C,spatialReference:this.origin.spatialReference.toJson()});e.push({latticeID:h+"_"+m+"_"+b+"_"+d,lattice:w,resolution:this._resolution})}return{minRow:h,
maxRow:m,minCol:b,maxCol:d,cells:e}}})})},"esri/layers/SelectionMode":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel","./RenderMode"],function(k,e,p,q,n){return k([n],{declaredClass:"esri.layers._SelectionMode",constructor:function(e){this.featureLayer=e;this._featureMap={}},propertyChangeHandler:function(e){this._init&&0===e&&this._applyTimeFilter()},resume:function(){this.propertyChangeHandler(0)},hasAllFeatures:function(){return!this.featureLayer._hasPartialSelectedFeatures}})})},
"esri/layers/StreamMode":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/Deferred dojo/has ../kernel ../SpatialReference ../tasks/query ../tasks/QueryTask ../geometry/jsonUtils ./RenderMode".split(" "),function(k,e,p,q,n,l,h,f,d,c,a){return k([a],{declaredClass:"esri.layers._StreamMode",constructor:function(a,c){this.featureLayer=a;this._featureMap={};this._setRefreshRate();this._drawBuffer={adds:[],updates:[]};this._timeoutId=null;this._flushDrawBuffer=e.hitch(this,this._flushDrawBuffer);
this._featuresByTime={};this._lastEndTimeCheck=null;this._maxFeatureAge=0;a.purgeOptions&&a.purgeOptions.age&&"number"===typeof a.purgeOptions.age&&(this._maxFeatureAge=1E3*Math.ceil(60*a.purgeOptions.age));this._drawFeatures=e.hitch(this,this._drawFeatures);this._queryErrorHandler=e.hitch(this,this._queryErrorHandler)},startup:function(){this._started||this.inherited(arguments)},propertyChangeHandler:function(a){this._init&&(0===a?this._applyTimeFilter():3===a?this._redrawAllTracks():console.debug("StreamLayer: Stream Layer only supports changing map time or maximumTrackPoints. Layer id \x3d "+
this.featureLayer.id))},destroy:function(){this.inherited(arguments);clearTimeout(this._timeoutId);this._featuresByTime=this._drawBuffer=this._featureMap=null},drawFeature:function(a){var b=this.featureLayer,c=b.objectIdField;this._timeoutId||(this._timeoutId=setTimeout(this._flushDrawBuffer,this._refreshRate));b._joinField&&this._getFeature(a.attributes[c])?this._drawBuffer.updates.push({oid:a.attributes[c],updates:a}):this._drawBuffer.adds.push(a)},resume:function(){this.propertyChangeHandler(0)},
refresh:function(){this._pendingRequest&&this._cancelPendingRequest(this._pendingRequest);var a=this.featureLayer;a&&(a._relatedUrl||a._keepLatestUrl?(a._fireUpdateStart(),a._refreshing=!0,a.disconnect(),a.clear(),a._relatedQueried=!1,a._keepLatestQueried=!1,a.connect()):(a._fireUpdateStart(),a.clear(),a._fireUpdateEnd()))},_drawFeatures:function(a,c){var b=this.featureLayer;b._create(a.features||[]);b._fireUpdateEnd(null,c)},_applyTimeFilter:function(a){this.inherited(arguments);this._redrawAllTracks()},
_removeFeatures:function(a){var b=this.featureLayer,c=b.objectIdField;a&&p.forEach(a,function(a){a=a.attributes[c];b._unSelectFeatureIIf(a,this);this._decRefCount(a);this._removeFeatureIIf(a)},this)},_addFeatures:function(a){var b=this.featureLayer,c=b._endTimeField,d=b._startTimeField,f,h,e,l=[],n=[],k=[];f=b._trackManager;h=b.objectIdField;if(f)for(e in a=f.addFeatures(a),a)a.hasOwnProperty(e)&&(l.push(e),a[e].adds&&(n=n.concat(a[e].adds)),a[e].deletes&&(k=k.concat(a[e].deletes)));else n=a;p.forEach(n,
function(a){var b=a.attributes[h],g;g=c&&a.attributes[c];!g&&this._maxFeatureAge&&(g=d&&a.attributes[d]?a.attributes[d]+this._maxFeatureAge:Date.now()+this._maxFeatureAge);g&&(g=1E3*Math.ceil(g/1E3),this._featuresByTime[g]?this._featuresByTime[g].push(b):this._featuresByTime[g]=[b]);this._addFeatureIIf(b,a);this._incRefCount(b)},this);k.length&&this._removeFeatures(k);f&&f.refreshTracks(l)},_updateFeatures:function(a){var b=this.featureLayer,c,d,f=[];c=b._trackManager;d=b._trackIdField;p.forEach(a,
function(a){var g=a.updates;a=this._getFeature(a.oid);var m;if(a){g.geometry&&a.setGeometry(g.geometry);g=g.attributes||{};for(m in g)g.hasOwnProperty(m)&&(a.attributes[m]=g[m]);a.setAttributes(a.attributes);a.visible=this._checkFeatureTimeIntersects(a);c&&a.attributes[d]?f.push(a.attributes[d]):b._repaint(a,null,!0)}},this);f.length&&c.refreshTracks(f)},_redrawAllTracks:function(){var a=this.featureLayer._trackManager,c;a&&(c=a.trimTracks())&&0<c.length&&(this._removeFeatures(c),a.refreshTracks())},
_flushDrawBuffer:function(){clearTimeout(this._timeoutId);var a=this._drawBuffer,c=a.adds.splice(0,a.adds.length),d=a.updates.splice(0,a.updates.length),a=this.featureLayer;if(!a)return!1;a.updating||a._fireUpdateStart();this._addFeatures(c);this._updateFeatures(d);(c=this._getExpiredFeatures())&&c.length&&(this._removeFeatures(c),a._trackManager&&a._trackManager.removeFeatures(c));a._purge();a._fireUpdateEnd();this._timeoutId=null},_clearDrawBuffer:function(){var a=this._timeoutId,c=this._drawBuffer,
d=c.adds,c=c.updates;a&&clearTimeout(a);d.splice(0,d.length);c.splice(0,c.length);this._timeoutId=null},_clearTimeBin:function(){this._featuresByTime={};this._lastEndTimeCheck=1E3*Math.ceil(Date.now()/1E3)},_clearFeatureMap:function(){this._featureMap={}},_setRefreshRate:function(a){a=a||0===a?a:200;0>a&&(a=200);this._refreshRate=a},_checkFeatureTimeIntersects:function(a){var b=this.featureLayer,c=b.getMap();return(c=c?c.timeExtent:null)&&b.timeInfo&&(b.timeInfo.startTimeField||b.timeInfo.endTimeField)?
0<b._filterByTime([a],c.startTime,c.endTime).match.length:!0},_fetchArchive:function(a){var b=new q,e=this.featureLayer,m,r,l,n,k;this._pendingRequest&&this._cancelPendingRequest(this._pendingRequest);e._fireUpdateStart();a&&this.map?(a=new d(a),m=new f,r=this.map,l=e.getFilter()||{},n=l.where||"1\x3d1",k=l.geometry?c.fromJson(l.geometry):null,l=l.outFields?l.outFields.split(","):["*"],m.geometry=k,m.where=n,m.outFields=l,m.returnGeometry=!0,m.outSpatialReference=new h(r.spatialReference.toJson()),
this._pendingRequest=a.execute(m).then(function(a){this._pendingRequest=null;var c=this._fixFieldNameCasing(e,a);a.features=c;this._drawFeatures(a);e._fireUpdateEnd();b.resolve()}.bind(this)).otherwise(function(a){this._pendingRequest=null;e._errorHandler(a);e._fireUpdateEnd(a);b.reject(a)}.bind(this))):b.resolve();return b.promise},_queryErrorHandler:function(a){var b=this.featureLayer;b._errorHandler(a);b._fireUpdateEnd(a)},_fixFieldNameCasing:function(a,c){var b=c.features||[],d=c.fields;if(!d||
!b.length)return b;a=this._mapFieldNameDifferences(a.fields,d);for(var d=[],g,f=0,h=c.features.length;f<h;f++)c=b[f],g=this._swizzleResponseAttributes(c.attributes,a),d.push({geometry:c.geometry,attributes:g});return d},_mapFieldNameDifferences:function(a,c){var b=[],d={},g,f;g=0;for(f=c.length;g<f;g++)b.push(c[g].name);g=0;for(f=a.length;g<f;g++){c=a[g].name;var h=this._checkForStreamFieldName(c,b);h&&(d[h]=c)}return d},_checkForStreamFieldName:function(a,c){a=a.toLowerCase();for(var b,d=0,g=c.length;d<
g;d++)if(c[d].toLowerCase()===a){b=c[d];break}return b},_swizzleResponseAttributes:function(a,c){var b={},d;for(d in a)if(a.hasOwnProperty(d)){var g=a[d];c.hasOwnProperty(d)?b[c[d]]=g:b[d]=g}return b},_getExpiredFeatures:function(){var a,c,d,m=[],f=[];if(!this.featureLayer._endTimeField&&!this._maxFeatureAge)return f;a=1E3*Math.floor(this._lastEndTimeCheck/1E3);this._lastEndTimeCheck=c=1E3*Math.ceil(Date.now()/1E3);if(a&&a!==c)for(d=this._featuresByTime;a<=c;a+=1E3)d[a]&&(m=m.concat(d[a]),delete d[a]);
p.forEach(m,function(a){(a=this._getFeature(a))&&f.push(a)},this);return f}})})},"esri/layers/TrackManager":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has dojo/dom-construct dojox/gfx ../kernel ../graphic ../geometry/Polyline ./GraphicsLayer".split(" "),function(k,e,p,q,n,l,h,f,d,c){var a=-1!==l.renderer.toLowerCase().indexOf("canvas");return k(null,{declaredClass:"esri.layers._TrackManager",constructor:function(a){this.layer=a;this.trackMap={};this.trackLineMap={}},
initialize:function(b){this.map=b;var d=this.layer,f=d._getRenderer(),f=f&&f.trackRenderer;if("esriGeometryPoint"===d.geometryType){var m=this.container=new c._GraphicsLayer({id:d.id+"_tracks",_child:!0,visible:d.visible,minScale:d.minScale,maxScale:d.maxScale});m.loaded=!0;m.onLoad(m);m._setMap(b,d._div);if(!a){b=m._div.getNode();var h=d._div.getNode();b&&h&&n.place(b,h,"first")}m.setRenderer(f);d.on("visibility-change",e.hitch(this,function(a){this.container.setVisibility(a.visible);this.container.evaluateSuspension()}));
d.on("scale-range-change",e.hitch(this,function(){this.container.setScaleRange(this.layer.minScale,this.layer.maxScale)}))}},addFeatures:function(a){var b=this.trackMap,c=this.layer,d=c._trackIdField,f=[];p.forEach(a,function(a){var c=a.attributes[d];(b[c]=b[c]||[]).push(a);-1===p.indexOf(f,c)&&f.push(c)});var h=c._startTimeField,e=c.objectIdField,l=function(a,b){var c=a.attributes[h],d=b.attributes[h];return c===d?a.attributes[e]<b.attributes[e]?-1:1:c<d?-1:1};p.forEach(f,function(a){b[a].sort(l)})},
trimTracks:function(a){function b(a){for(a=c[a]||[];a.length>d;)f.push(a.shift())}var c=this.trackMap,d=this.layer.maximumTrackPoints||0,f=[],h;if(!d)return f;if(a)p.forEach(a,function(a){b(a)});else for(h in c)c.hasOwnProperty(h)&&b(h);return f},drawTracks:function(a){function b(a){var b=h[a],g,r,t;r=c.trackLineMap[a];m.remove(r);delete c.trackLineMap[a];r=null;if(!b||2>b.length)return!1;r=[];for(g=b.length-1;0<=g;g--)(t=b[g].geometry)&&r.push([t.x,t.y]);b={};b[l]=a;1<r.length&&(r=new f(new d({paths:[r],
spatialReference:e}),null,b),m.add(r),c.trackLineMap[a]=r)}var c=this,m=this.container,h,e,l,n;if(m)if(h=this.trackMap,e=this.map.spatialReference,l=this.layer._trackIdField,a)p.forEach(a,function(a){b(a)});else for(n in h)h.hasOwnProperty(n)&&b(n)},refreshTracks:function(a){function b(a){var b,g;c.drawTracks([a]);if(h&&h.latestObservationRenderer)for(a=d[a]||[],b=a.length,g=0;g<b;g++)f._repaint(a[g],null,!0)}var c=this,d=this.trackMap,f=this.layer,h=f._getRenderer(),e;if(a)p.forEach(a,function(a){b(a)});
else for(e in d)d.hasOwnProperty(e)&&b(e);this.moveLatestToFront()},moveLatestToFront:function(a){p.forEach(this.getLatestObservations(a),function(a){var b=a._shape;b&&b._moveToFront();this._repaint(a,null,!0)},this.layer)},getLatestObservations:function(a){function b(a){a=f[a];return a[a.length-1]}var c=[],d=this.layer._getRenderer(),f=this.trackMap,h;if(!d.latestObservationRenderer)return c;if(a)p.forEach(a,function(a){c.push(b(a))});else for(h in f)f.hasOwnProperty(h)&&c.push(b(h));return c},clearTracks:function(a){var b=
this.getLatestObservations(a),c=this.container,d;a?p.forEach(a,function(a){delete this.trackMap[a];c&&(d=this.trackLineMap[a],c.remove(d),delete this.trackLineMap[a])},this):(this.trackMap={},this.trackLineMap={},c&&c.clear());p.forEach(b,function(a){this._repaint(a,null,!0)},this.layer)},isLatestObservation:function(a){var b=this.trackMap[a.attributes[this.layer._trackIdField]];return b?b[b.length-1]===a:!1},destroy:function(){var a=this.container;a&&(a.clear(),a._unsetMap(this.map,this.layer._div));
this.map=this.layer=this.trackMap=this.container=null}})})},"esri/layers/HeatmapManager":function(){define("dojo/_base/declare dojo/_base/lang dojo/aspect dojo/_base/array require ../kernel ../sniff ../geometry/Point ../geometry/webMercatorUtils ./MapImage ../renderers/HeatmapRenderer ../tasks/query dojo/_base/fx".split(" "),function(k,e,p,q,n,l,h,f,d,c,a,b,g){function u(){}function m(a){var b=a.layer;return{geometry:a.geometry,attributes:a.attributes,getLayer:function(){return b}}}return k(null,
{declaredClass:"esri.layers.HeatmapManager",heatmapRenderer:null,sourceLayer:null,imageLayer:null,useTiles:!0,useWorker:!1,map:null,constructor:function(a){this.sourceLayer=a;this._hndls=[]},initialize:function(b){this.map=b;var c=this.sourceLayer,d=c.renderer;c.setDrawMode(!1);this.imageLayer=b._getMapImageLyr();var g=this;this.heatmapRenderer=d instanceof a?d:(d.getRendererInfoByZoom(b.getZoom())||d.getRendererInfoByScale(b.getScale())).renderer;this._setupDraw=this._setupDraw.bind(this);this.recalculateHeatmap=
this.recalculateHeatmap.bind(this);this._removeRenderer=this._removeRenderer.bind(this);this._handleRendererChange=this._handleRendererChange.bind(this);this._rendererChangeHandle=this.sourceLayer.on("renderer-change",this._handleRendererChange);this._handleOpacityChange=this._handleOpacityChange.bind(this);this._reprojectFeature=this._reprojectFeature.bind(this);n(["../workers/heatmapCalculator"],function(a){g._calculator=new a(e.mixin({width:g.map.width,height:g.map.height},g._getOptions()));g._setupRenderer();
g.heatmapRenderer.getStats=a.calculateStats;g.heatmapRenderer.getHistogramData=a.getHistogramData})},destroy:function(){this._removeHandlers();this._rendererChangeHandle&&this._rendererChangeHandle.remove();this._rendererChangeHandle=this.sourceLayer=this.imageLayer=this.map=this.heatmapRenderer=this._hndls=null},_handleRendererChange:function(b){var c=b.renderer,d=c instanceof a;this.heatmapRenderer?d?this.heatmapRenderer=c:this._removeRenderer(b):d&&(this.heatmapRenderer=c,this.sourceLayer&&this.map&&
this._setupRenderer())},_handleOpacityChange:function(a){a=a.opacity;var b=this._getImageBySourceId(this.sourceLayer.id);b&&b.setOpacity(a)},_setupRenderer:function(){var a=this._hndls,b=this.sourceLayer,c=this.map,d=this;b._originalDraw=b._draw;b._draw=u;b._div.clear();clearTimeout(this._resetTimer);this._resetTimer=setTimeout(this._resetGraphics.bind(this),250);a.push(b.on("update-end",this._setupDraw));a.push(b.on("suspend",function(a){(a=d._getImageBySourceId(d.sourceLayer.id))&&a.hide()}));a.push(b.on("resume",
function(a){(a=d._getImageBySourceId(d.sourceLayer.id))&&a.show()}));a.push(p.after(b,"redraw",this._setupDraw));a.push(c.on("layer-remove",function(a){a.layer==b&&((a=d._getImageBySourceId(d.sourceLayer.id))&&d.imageLayer.removeImage(a),d._removeRenderer({target:b}))}));b._collection&&a.push(b.on("graphic-add",function(a){d._reprojectFeature(a.graphic);d._setupDraw()}));1!==b.mode&&(a.push(c.on("resize, pan-end",this._setupDraw)),a.push(c.on("zoom-end",this._setupDraw)));a.push(b.on("opacity-change",
this._handleOpacityChange));this.imageLayer.suspended&&this.imageLayer.resume();b.graphics&&b.graphics.length&&(b.graphics[0].geometry&&!c.spatialReference.equals(b.graphics[0].geometry.spatialReference)&&q.forEach(b.graphics,function(a){this._reprojectFeature(a)}.bind(this)),this._setupDraw())},_setupDraw:function(){if(!this._drawTimer){var b=this;this._drawTimer=setTimeout(function(){clearTimeout(b._drawTimer);b._drawTimer=null;b.sourceLayer._getRenderer().isInstanceOf(a)&&b.recalculateHeatmap()},
16)}},_removeRenderer:function(a){var b=a.target;b._draw=b._originalDraw;delete b._originalDraw;b.setDrawMode(!0);this._removeHandlers();this._hndls=[];var c=this._getImageBySourceId(this.sourceLayer.id);c&&this.imageLayer.removeImage(c);clearTimeout(this._drawTimer);clearTimeout(this._resetTimer);this._drawTimer=this._resetTimer=null;b.renderer!=a.renderer&&b.renderer.getRendererInfo?this.heatmapRenderer=null:(b.redraw(),this.destroy())},recalculateHeatmap:function(){this._calculator?this._doMainCalculation():
this._calculatorClient&&this._doWorkerCalculation()},_reprojectFeature:function(a){if(a&&a.geometry){var b=a.geometry,c=this.map.spatialReference;c.equals(b.spatialReference)||(b=d.project(b,c),null==b?console.log("Unable to reproject features to map's spatial reference. Please convert feature geometry before adding to layer"):a.geometry=b)}},_doWorkerCalculation:function(){},_doMainCalculation:function(){var a=this.sourceLayer,d=this.map,g=this.heatmapRenderer,f=this.map.extent,h=this.map.width,
l=this.map.height,n=this._calculator,k=this,u=function(b){b=k._getScreenPoints(b.features,d,a);b=n.calculateImageData(e.mixin({screenPoints:b,mapinfo:{extent:[f.xmin,f.ymin,f.xmax,f.ymax],resolution:d.getResolution()},width:h,height:l},k._getOptions()));b=g.getSymbol(m({geometry:d.extent,attributes:{size:[h,l],imageData:b},layer:a}));b=new c({extent:d.extent,href:b.url,opacity:0,sourceId:a.id});k._swapMapImages(b,k._getImageBySourceId(a.id));a.suspended&&b.hide()},p={geometry:d.extent,timeExtent:a.useMapTime?
d.timeExtent:void 0,spatialRelationship:b.SPATIAL_REL_INTERSECTS};null!=a._canDoClientSideQuery(p)?a.queryFeatures(p,u):u({features:a.graphics})},_getScreenPoints:function(a,b,c){var d=[],g=a.length,m=0,h=0,e,l=new f(b.extent.xmin,b.extent.ymax,b.spatialReference),r=b.toScreen(l),t=r.x,r=r.y,n=b.getResolution(),k;for((h=b.extent.getCacheValue("_parts"))&&(k=q.map(h,function(a){return c._intersects(b,a.extent)[0]}));g--;)h=a[g],h.geometry&&(e={x:Math.ceil((h.geometry.x-l.x)/n+t),y:Math.floor((l.y-
h.geometry.y)/n-r),attributes:h.attributes},k&&(h=1<k.length&&e.x<-k[0]?k[1]:k[0],e.x+=h),d[m++]=e);return d},_getImageBySourceId:function(a){var b=this.imageLayer.getImages(),b=q.filter(b,function(b){return b.sourceId==a});if(b.length)return b[b.length-1]},_swapMapImages:function(a,b){function c(){d.removeImage(b)}var d=this.imageLayer,m=this.sourceLayer.opacity;d.addImage(a);g.anim(a._node,{opacity:m},null,null,function(){a.opacity=m});null!=b&&g.anim(b._node,{opacity:0},null,null,c)},_removeHandlers:function(){if(null!=
this._hndls)for(var a=this._hndls.length;a--;)this._hndls[a].remove()},_getOptions:function(){var a=this.heatmapRenderer;return{blurRadius:a.blurRadius,gradient:a.gradient,maxPixelIntensity:a.maxPixelIntensity,minPixelIntensity:a.minPixelIntensity,field:a.field,fieldOffset:a.fieldOffset}},_resetGraphics:function(){clearTimeout(this._resetTimer);this._resetTimer=null;for(var a=this.sourceLayer.graphics,b=a.length,c;b--;)c=a[b],c._shape=c._offsets=void 0}})})},"esri/layers/MapImage":function(){define("dojo/_base/declare dojo/_base/lang dojo/dom-style dojo/has ../kernel ../domUtils ../geometry/Extent".split(" "),
function(k,e,p,q,n,l,h){return k(null,{declaredClass:"esri.layers.MapImage",constructor:function(f){e.mixin(this,f);this.extent=new h(this.extent)},visible:!0,opacity:1,getLayer:function(){return this._layer},getNode:function(){return this._node},show:function(){if(!this.visible){this.visible=!0;var f=this._node,d=this._layer,c;if(f){if(c=d&&d._div)d.suspended||d._setPos(f,c._left,c._top),(d._active||c).appendChild(f);l.show(f)}}},hide:function(){if(this.visible){this.visible=!1;var f=this._node;
f&&(l.hide(f),f.parentNode&&f.parentNode.removeChild(f))}},setOpacity:function(f){var d=this._node;this.opacity=f;d&&p.set(d,"opacity",f)}})})},"esri/layers/clustering/ClusterManager":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has ../../kernel ../../Evented ../../graphic ../../lang ../../Color ../../graphicsUtils ../../dijit/PopupTemplate ../../dijit/Legend/utils ../../renderers/ClassBreaksRenderer ../../symbols/SimpleMarkerSymbol ../GraphicsLayer ../Field ./GeohashAggregation ./statUtils dojo/i18n!../../nls/jsapi".split(" "),
function(k,e,p,q,n,l,h,f,d,c,a,b,g,u,m,r,t,v,y){var w=y.layers.clusters,z=y.widgets.popup,x=w.numFeatures,A=Math.pow(2,53)-1;return k(l,{declaredClass:"esri.layers.clustering.ClusterManager",layer:null,aggregationInfo:null,container:null,defaults:{clusterRadius:80,markerSymbol:{color:[77,77,77,255],size:6,angle:0,xoffset:0,yoffset:0,type:"esriSMS",style:"esriSMSCircle",outline:{color:[255,255,255,255],width:.75,type:"esriSLS",style:"esriSLSSolid"}}},_initialized:!1,_map:null,_eventHandles:null,_clusterRadius:null,
_renderer:null,_statisticInfos:null,_fields:null,_infoTemplate:null,_clusterGenerator:null,_singleGraphics:null,constructor:function(a){this._eventHandles=[];this.layer=a.layer;this.setAggregationInfo(a.aggregationInfo)},initialize:function(a){this._initialized=!0;this._map=a;this.container=this._createContainer();this._clusterGenerator=this._createClusterGenerator();this._initClusterGenerator();this._createLayerEventListeners();this._createMapEventListeners();this._createPopupEventListeners()},destroy:function(a){this._clearSingleGraphics();
this._removeClusterBoundary();this._destroyEventListeners();this._removeFromPopup(this.container);this._removeFromPopup(this.layer);this._resetClusterNav();this._destroyClusterGenerator(a);this._destroyContainer();this.layer=this.aggregationInfo=this._map=null},setAggregationInfo:function(a){this.aggregationInfo=a?e.mixin({},a):null;this._applyAggregationInfo()},getClusterRenderer:function(){return this._renderer},getClusterFields:function(){return this._fields||[]},getFeaturesInCluster:function(a){a=
a&&a.getAggregationInfo();return this._clusterGenerator?this._clusterGenerator.getFeaturesInCluster(a):[]},getAggregateGraphics:function(){return this.container?this.container.graphics.slice(0):[]},getSingleGraphics:function(){return this._singleGraphics?this._singleGraphics.slice(0):[]},redraw:function(){this.container&&this.container.redraw()},isClusteringEnabled:function(){return!(!this._clusterGenerator||!this._clusterGenerator.clustersEnabled)},isClusteringActive:function(){return!!(this._clusterGenerator&&
0<this._clusterGenerator.getNumFeatures())},_createContainer:function(){var a=this.layer,b=new m._GraphicsLayer({_child:!0,id:a.id+"_clusters",visible:a.visible,minScale:a.minScale,maxScale:a.maxScale,infoTemplate:this._infoTemplate});b.fields=this._fields;b.setRenderer(this._renderer);b.loaded=!0;b.onLoad(b);b._setMap(this._map,a._div);return a._childLayer=b},_destroyContainer:function(){var a=this.container;a&&(a.clear(),a._unsetMap(this._map,this.layer._div),this.layer._childLayer=null);this.container=
null},_createClusterGenerator:function(){return new t({map:this._map,layer:this.layer,clusterRadius:this._clusterRadius,statisticInfos:this._statisticInfos})},_initClusterGenerator:function(){var a=this._clusterGenerator;a.loaded?(this._applyRenderer(),this._initClusterUpdates()):this._eventHandles.push(a.on("load",e.hitch(this,function(){this._applyRenderer();this._initClusterUpdates()})),a.on("load-error",e.hitch(this,function(a){console.log(a.error)})))},_destroyClusterGenerator:function(a){this._clusterGenerator&&
this._clusterGenerator.destroy(a);this._clusterGenerator=null},_applyAggregationInfo:function(){this._applyClusterRadius();this._applyRenderer();this._clusterGenerator&&!this._clusterGenerator.isUpdateScheduled()&&this.redraw()},_applyClusterRadius:function(){var a=this.aggregationInfo;this._clusterRadius=a&&a.clusterRadius||this.defaults.clusterRadius;this._clusterGenerator&&this._clusterGenerator.setClusterRadius(this._clusterRadius);this._computeClusterRadius()},_computeClusterRadius:function(){var a=
this.aggregationInfo||{};a.clusterRadius=this._clusterRadius;this.aggregationInfo=a},_applyRenderer:function(){var a=this.container,b=this._getClusterRendererInfo(),c=this._compareStatInfos(this._statisticInfos,b.statisticInfos);c&&(this._statisticInfos=b.statisticInfos,this._clusterGenerator&&(this._clusterGenerator.setStatisticInfos(p.map(this._statisticInfos,function(a){return{attributeInfo:a.attributeInfo,statisticType:a.statisticType}})),a&&p.forEach(a.graphics,function(a){this._applyClusterAttributes(a,
a.getAggregationInfo())},this)));this._renderer=b.renderer;this._applyFields();this._applyInfoTemplate(!!c&&this._initialized);a&&(a.setRenderer(this._renderer),this.emit("renderer-change"))},_applyFields:function(){this._fields=this._getFields(this._statisticInfos);this.container&&(this.container.fields=this._fields)},_applyInfoTemplate:function(a){if(this.layer.infoTemplate){var b=this.aggregationInfo,b=b&&b.infoTemplate||this._infoTemplate;a=a||!b?this._createInfoTemplate():this._updateInfoTemplate(b)}else a=
null;this._infoTemplate=a;this.container&&this.container.setInfoTemplate(this._infoTemplate);this._computeInfoTemplate()},_computeInfoTemplate:function(){var a=this.aggregationInfo||{};a.infoTemplate=this._infoTemplate;this.aggregationInfo=a},_getClusterRendererInfo:function(){var a=this.layer&&this.layer.renderer;return a?this._createClusterRenderer(a):this._getDefaultClusterRenderer()},_getDefaultClusterRenderer:function(){var a=this._createContinuousCountRenderer();this._addSizeByCountVariable(a);
return{renderer:a,statisticInfos:[]}},_createContinuousCountRenderer:function(a){var b=new g(null,"cluster_count");b.addBreak({minValue:-A,maxValue:A,symbol:a?new a.constructor(a.toJson()):new u(e.clone(this.defaults.markerSymbol))});return b},_createClusterRenderer:function(a){if(!this._isSupportedRenderer(a))return this._getDefaultClusterRenderer();var b,c=[];if(this._isSimpleRenderer(a))b=this._createContinuousCountRenderer(a.symbol);else{b=new a.constructor(a.toJson());var d=this._getRendererAttributeInfo(a),
g;this._isCBRenderer(b)?(g=v.getClusterField(d,"avg"),c.push(this._getStatInfo(d,"avg")),b.normalizationType=null,b.normalizationField=null,b.normalizationTotal=null):this._isUVRenderer(b)&&(g=v.getClusterField(d,"type"),c.push(this._getStatInfo(d,"type")));b.attributeField=g;b.setValueExpression(null);b.valueExpressionTitle=null;b.setVisualVariables(null);this._setRendererTitle(b,a)}a=this._getSupportedVariables(a);d=this._createClusterVariables(a.allVars,c);b.setVisualVariables(d);a.sizeVars.length||
this._isCBSizeRenderer(b)||this._addSizeByCountVariable(b);return{renderer:b,statisticInfos:c}},_isSupportedRenderer:function(a){if(this._isSimpleRenderer(a))return!0;if(this._isCBRenderer(a)){var b=a.normalizationType;return"function"===typeof a.attributeField||b&&"field"!==b?!1:!0}return this._isUVRenderer(a)?"function"===typeof a.attributeField||a.attributeField2?!1:!0:!1},_isSimpleRenderer:function(a){return-1<a.declaredClass.toLowerCase().indexOf("simplerenderer")},_isCBRenderer:function(a){return-1<
a.declaredClass.toLowerCase().indexOf("classbreaksrenderer")},_isUVRenderer:function(a){return-1<a.declaredClass.toLowerCase().indexOf("uniquevaluerenderer")},_isCBSizeRenderer:function(a){var b=a.infos;if(!this._isCBRenderer(a)||!b||2>b.length)return!1;var c=Infinity,d=-Infinity;p.forEach(b,function(a){if(a=a.symbol){var b=0;switch(a.type){case "simplemarkersymbol":b=a.size;break;case "picturemarkersymbol":b=(a.width+a.height)/2}c=Math.min(c,b);d=Math.max(d,b)}});return Infinity!==c&&-Infinity!==
d&&c!==d},_getRendererAttributeInfo:function(a){var b=a.attributeField,c=b?this.layer.getField(b):null;return{field:b,attributeType:c&&"esriFieldTypeDate"===c.type?"date":null,rotationType:null,valueExpression:a.valueExpression,valueExpressionTitle:a.valueExpressionTitle,normalizationField:a.normalizationField}},_setRendererTitle:function(a,c){a.legendOptions=e.clone(c.legendOptions);a.legendOptions&&a.legendOptions.title||(a.legendOptions=a.legendOptions||{},a.legendOptions.title=b.getRendererTitle(c,
this.layer))},_getSupportedVariables:function(a){var b=a.getVisualVariablesForType("colorInfo",!1)||[],c=a.getVisualVariablesForType("sizeInfo",!1)||[],d=a.getVisualVariablesForType("opacityInfo",!1)||[];a=a.getVisualVariablesForType("rotationInfo",!1)||[];b=p.filter(b,this._variableFilter);c=p.filter(c,this._variableFilter);d=p.filter(d,this._variableFilter);a=p.filter(a,this._variableFilter);return{sizeVars:c,allVars:b.concat(c).concat(d).concat(a)}},_variableFilter:function(a){return"function"!==
typeof a.field},_createClusterVariables:function(a,b){return p.map(a,function(a){return this._createVarForAvg(a,b)},this)},_createVarForAvg:function(a,b){var c=e.clone(a),d=this._getVariableAttributeInfo(a);c.field=v.getClusterField(d,"avg");c.normalizationField=null;c.valueExpression=null;c.valueExpressionTitle=null;d=this._getStatInfo(d,"avg");this._addStatInfo(b,d);this._setVariableTitle(c,a);return c},_getVariableAttributeInfo:function(a){var b="rotationInfo"===a.type,c=b?"angle":null,b=b?a.rotationType:
null,d=a.legendOptions&&a.legendOptions.title,g=a.field,m=g?this.layer.getField(g):null;m&&"esriFieldTypeDate"===m.type&&(c="date");return{field:g,attributeType:c,rotationType:b,valueExpression:a.valueExpression,valueExpressionTitle:a.valueExpressionTitle||a.valueExpression&&d,normalizationField:a.normalizationField}},_setVariableTitle:function(a,c){a.legendOptions&&a.legendOptions.title||(a.legendOptions=a.legendOptions||{},a.legendOptions.title=b.getVisualVariableTitle(c,this.layer))},_getStatInfo:function(a,
b){return{statisticHash:v.getStatisticHash(a,b),attributeInfo:a,statisticType:b}},_addStatInfo:function(a,b){var c=this._findStatInfo(a,b);c?c.attributeInfo.valueExpressionTitle||(c.attributeInfo.valueExpressionTitle=b.attributeInfo.valueExpressionTitle):a.push(b)},_findStatInfo:function(a,b){var c;p.some(a,function(a){a.statisticHash===b.statisticHash&&(c=a);return!!c});return c},_compareStatInfos:function(a,b){var c=p.filter(a,function(a){return!this._findStatInfo(b,a)},this),d=p.filter(b,function(b){return!this._findStatInfo(a,
b)},this);return d.length||c.length?{added:d,removed:c}:null},_addSizeByCountVariable:function(a){var b=this._createSizeByCountVariable();b&&this._addVariable(a,b)},_getSizeByCountVariable:function(a){a=a.getVisualVariablesForType("sizeInfo",!1)||[];return p.filter(a,function(a){return"cluster_count"===a.field})[0]},_updateSizeByCountVariable:function(){var a=this._renderer,b=this._getSizeByCountVariable(a);if(b){var c=this._createSizeByCountVariable();c&&this._replaceVariable(a,b,c)}},_createSizeByCountVariable:function(){var a=
this._clusterGenerator,b;if(a){b=a.getCurrentLodStats();var c=a.getNumFeatures(),a=a.clusters,d=b.min,g=b.max;1===b.count&&d===c||1===a.length&&a[0].count===c?(d=1,g=c):d&&d===g&&(g=2*d);b={type:"sizeInfo",field:"cluster_count",valueUnit:"unknown",minSize:12,maxSize:50,minDataValue:d,maxDataValue:g,legendOptions:{title:x}}}return b},_addVariable:function(a,b){var c=a.visualVariables||[];c.push(b);a.setVisualVariables(c)},_replaceVariable:function(a,b,c){var d=a.visualVariables;b=p.indexOf(d,b);-1<
b&&d.splice(b,1);d.push(c);a.setVisualVariables(d)},_getFields:function(a){var b=[new r({name:"cluster_count",type:"esriFieldTypeInteger"})];p.forEach(a,function(a){var c=a.statisticType;a=a.attributeInfo;var d;"avg"===c?d="date"===a.attributeType?"esriFieldTypeDate":"esriFieldTypeDouble":"type"===c&&(d=a.field?this.layer.getField(a.field).type:"esriFieldTypeString");b.push(new r({name:v.getClusterField(a,c),type:d}))},this);return b},_createInfoTemplate:function(){var b=this._statisticInfos,c=this._renderer,
d=[{fieldName:"cluster_count",label:x,visible:!0,format:{digitSeparator:!0,places:0}}],g=[],m=[f.substitute({count:"{cluster_count}"},w.countSummary)],h=this._isUVRenderer(c)?c.infos:[];p.forEach(b,function(a){var b,c,f=a.statisticType,e=a.attributeInfo,l=v.getClusterField(e,f),r=this._getFieldLabel(a);"avg"===f?(b={fieldName:l,label:r,visible:!0,format:"date"===e.attributeType?{dateFormat:"shortDateShortTime"}:{digitSeparator:!0,places:1}},c=this._getFieldSummary(a,l)):"type"===f&&(c="expression/"+
l,b={fieldName:c,visible:!0},g.push({name:l,title:r,returnType:"string",expression:this._getExpression(h,l)}),c=this._getFieldSummary(a,c));b&&d.push(b);c&&m.push(c)},this);return new a({fieldInfos:d,expressionInfos:g,description:m.join("\x3cbr/\x3e\x3cbr/\x3e")})},_updateInfoTemplate:function(b){var c=b.toJson(),d=this._isUVRenderer(this._renderer)?this._renderer.infos:[];p.forEach(this._statisticInfos,function(a){var b=a.statisticType;a=v.getClusterField(a.attributeInfo,b);"type"===b&&(b=this._findExpressionInfo(a,
c))&&(b.expression=this._getExpression(d,a))},this);return new a(c)},_findExpressionInfo:function(a,b){var c;p.some(b.expressionInfos,function(b){b.name===a&&(c=b);return!!c});return c},_escapeDoubleQuotes:function(a){return a?a.replace(/"/g,'\\"'):""},_getExpression:function(a,b){return["var uvInfos \x3d ["+this._getObjects(a).join(", ")+"];",'var predominantType \x3d Text($feature["'+b+'"]);','var label \x3d "'+this._escapeDoubleQuotes(w.predominantNoneValue)+'";',"for (var i \x3d 0; i \x3c Count(uvInfos); i++) {\nif (uvInfos[i].value \x3d\x3d predominantType) {\nlabel \x3d uvInfos[i].label;\nbreak;\n}\n}\nreturn label;"].join("\n")},
_getObjects:function(a){return p.map(a,function(a){return'{"value": "'+String(a.value)+'","label": "'+this._escapeDoubleQuotes(String(a.label))+'"}'},this)},_getFieldLabel:function(a){var b=a.statisticType,c=a.attributeInfo,d=c.field;a=c.normalizationField;var g="",m;"avg"===b?m=a?w.avgNormFieldLabel:w.avgFieldLabel:"type"===b&&(m=w.predominantFieldLabel);m&&(b=c.valueExpression?c.valueExpressionTitle:this.layer.getFieldLabel(d),a=a&&this.layer.getFieldLabel(a),g=f.substitute({fieldLabel:b||"",normFieldLabel:a||
""},m));return g},_getFieldSummary:function(a,b){var c=a.statisticType,d=a.attributeInfo,g=d.field;a=d.normalizationField;var m="",h;"avg"===c?h=a?w.avgNormFieldSummary:w.avgFieldSummary:"type"===c&&(h=w.predominantFieldSummary);h&&(c=d.valueExpression?d.valueExpressionTitle:this.layer.getFieldLabel(g),a=a&&this.layer.getFieldLabel(a),m=f.substitute({fieldLabel:c||"",normFieldLabel:a||"",fieldValue:"{"+b+"}"},h));return m},_removeFromPopup:function(a){var b=this._map.infoWindow,c=b.features;if(c&&
c.length){var d=p.filter(c,function(b){return b.getLayer()!==a});d.length<c.length&&(d.length?b.setFeatures(d):(b.clearFeatures(),b.hide()))}},_resetClusterNav:function(){this._resetClusterNavPartial();this._popupClusterGraphic=null},_resetClusterNavPartial:function(){this._map.infoWindow.removeActions(this._popupActions);this._hideSingleGraphic(this._popupSingleGraphic);this._popupSingleGraphic=null},_addClusterBoundary:function(a,b){(b=b.clusterFillSymbol)&&(b=new b.constructor(b.toJson()));a=new h(a,
b);this._map.graphics.add(a);this._clusterBoundary=a},_removeClusterBoundary:function(){this._map.graphics.remove(this._clusterBoundary);this._clusterBoundary=null},_createBrowseFeaturesAction:function(){return this._map.infoWindow.addActions([{title:z.NLS_browseFeatures,className:"browseFeatures",callback:e.hitch(this,function(a){a.preventDefault();a=this._map.infoWindow;var b=a.getSelectedFeature(),d=b.getChildGraphics(),g=a.getCurrentAnchor();a.setFeatures(d,{anchor:g});if(d=c.graphicsExtent(d))this._addClusterBoundary(d,
a),a.show(this._getPopupLocation(d,g));this._popupClusterGraphic=b})}])[0]},_getPopupLocation:function(a,b){var c=a.getCenter();b=b.toLowerCase();-1<b.indexOf("top")?c.update(c.x,a.ymax):-1<b.indexOf("bottom")?c.update(c.x,a.ymin):-1<b.indexOf("left")?c.update(a.xmin,c.y):c.update(a.xmax,c.y);return c},_createViewSummaryAction:function(){return this._map.infoWindow.addActions([{title:z.NLS_viewSummary,className:"viewSummary",callback:e.hitch(this,function(a){a.preventDefault();a=this._popupClusterGraphic;
var b=this._map.infoWindow;b.setFeatures([a]);b.show(a.geometry);this._popupClusterGraphic=null})}])[0]},_initClusterUpdates:function(){this._updateSizeVariable();this._updateClusterGraphics();this._eventHandles.push(this._clusterGenerator.on("update-end",e.hitch(this,function(a){a.mapLevelChange&&this._updateSizeVariable();this._updateClusterGraphics()})),this._clusterGenerator.on("index-complete",e.hitch(this,function(){this._updateSizeVariable()})))},_updateClusterGraphics:function(){this._hideSingleGraphics();
var a=[],b=[];p.forEach(this._clusterGenerator.clusters,function(c){var d=new h(c.centroid);d.setAggregationSourceLayer(this.layer);d.setAggregationInfo(c);this._applyClusterAttributes(d,c);1===c.count?(c=this._getSingleGraphic(d),b.push(c)):a.push(d)},this);this._showSingleGraphics(b);this._addGraphics(a)},_addGraphics:function(a){var b=this.container;b.clear();p.forEach(a,function(a){b.add(a)})},_getSingleGraphic:function(a){var b=this._clusterGenerator.getCell(a.getAggregationInfo().primary).features[0],
c=this.layer.renderer,c=c&&c.getSymbol(b),d=this._getSizeByCountVariable(this._renderer);c&&d&&(a=d?this._renderer.getSize(a,{sizeInfo:d,shape:c.style,resolution:this._map.getResolutionInMeters(),scale:this._map.getScale()}):null,b.setSize(a));return b},_showSingleGraphics:function(a){p.forEach(a,this._showSingleGraphic);this._singleGraphics=a},_hideSingleGraphics:function(){p.forEach(this._singleGraphics,function(a){a.setSize(null);this._hideSingleGraphic(a)},this);this._singleGraphics=null},_clearSingleGraphics:function(){p.forEach(this._singleGraphics,
function(a){a.setSize(null)});this._singleGraphics=null},_showSingleGraphic:function(a){a&&(a._suspended=!1,a.draw())},_hideSingleGraphic:function(a){a&&(a._suspended=!0,a.show(),a.draw())},_updateSizeVariable:function(){this.isClusteringEnabled()&&(this._updateSizeByCountVariable(),this.emit("renderer-change"))},_applyClusterAttributes:function(a,b){a.setAttributes(b.attributes)},_createLayerEventListeners:function(){var a=this.layer;this._eventHandles.push(a.on("visibility-change",e.hitch(this,
function(a){this.container.setVisibility(a.visible)})),a.on("scale-range-change",e.hitch(this,function(){this.container.setScaleRange(this.layer.minScale,this.layer.maxScale)})),a.on("renderer-change",e.hitch(this,function(){this._applyRenderer()})),a.on("info-template-change",e.hitch(this,function(){this._applyInfoTemplate()})))},_createMapEventListeners:function(){this._eventHandles.push(this._map.on("zoom-start",e.hitch(this,function(){this._removeClusterBoundary();this._removeFromPopup(this.container);
this._removeFromPopup(this.layer);this._resetClusterNav();this.container.clear();this._hideSingleGraphics()})))},_createPopupEventListeners:function(){var a=this._map.infoWindow;this._eventHandles.push(a.on("selection-change",e.hitch(this,function(){this._resetClusterNavPartial();var a=this._map.infoWindow.getSelectedFeature(),b=a&&a.getLayer();if(b){var c;b===this.container?(this._removeClusterBoundary(),c=this._createBrowseFeaturesAction()):b===this.layer&&a._suspended?(c=this._createViewSummaryAction(),
this._popupSingleGraphic=a,this._showSingleGraphic(a)):this._removeClusterBoundary();this._popupActions=c?[c]:null}})),a.on("clear-features",e.hitch(this,function(a){this._resetClusterNav();a.isIntermediate||this._removeClusterBoundary()})),a.on("hide",e.hitch(this,function(){this._popupSingleGraphic&&this._popupSingleGraphic.hide();this._clusterBoundary&&this._clusterBoundary.hide()})),a.on("show",e.hitch(this,function(){this._popupSingleGraphic&&this._popupSingleGraphic.show();this._clusterBoundary&&
this._clusterBoundary.show()})))},_destroyEventListeners:function(){p.forEach(this._eventHandles,function(a){a.remove()})}})})},"esri/dijit/Legend/utils":function(){define(["dojo/_base/lang","../../lang","dojo/i18n!../../nls/jsapi"],function(k,e,p){var q=p.widgets.legend;return{getVisualVariableTitle:function(n,l){var h,f=n.field,d=n.normalizationField,c=!1,a=!1,b=!1,f=k.isFunction(f)?null:f,d=k.isFunction(d)?null:d;if(n.legendOptions&&n.legendOptions.title)h=n.legendOptions.title;else if(n.valueExpressionTitle)h=
n.valueExpressionTitle;else{if(l.renderer&&l.renderer.authoringInfo&&l.renderer.authoringInfo.visualVariables){var g=l.renderer.authoringInfo.visualVariables;for(n=0;n<g.length;n++){var u=g[n];if("colorInfo"===u.type&&"ratio"===u.style){c=!0;break}else if("colorInfo"===u.type&&"percent"===u.style){a=!0;break}else if("colorInfo"===u.type&&"percentTotal"===u.style){b=!0;break}}}(c=b&&"showRatioPercentTotal"||a&&"showRatioPercent"||c&&"showRatio"||d&&"showNormField"||f&&"showField"||null)&&(h=e.substitute({field:f&&
l.getFieldLabel(f),normField:d&&l.getFieldLabel(d)},q[c]))}return h},getRendererTitle:function(n,l){var h;if(n){var f,d,c;"esri.renderer.ClassBreaksRenderer"===n.declaredClass&&(f=n.attributeField,d=n.normalizationField,c="percent-of-total"===n.normalizationType);f=k.isFunction(f)?null:f;d=k.isFunction(d)?null:d;n.legendOptions&&n.legendOptions.title?h=n.legendOptions.title:n.valueExpressionTitle?h=n.valueExpressionTitle:(n=d&&"showNormField"||(c?"showNormPct":null)||f&&"showField"||null)&&(h=e.substitute({field:f&&
l.getFieldLabel(f),normField:d&&l.getFieldLabel(d)},q[n]))}return h}}})},"esri/layers/clustering/GeohashAggregation":function(){define("dojo/has dojo/_base/declare dojo/_base/lang dojo/_base/array ../../kernel ../../Evented ../../geometry/Point ../../geometry/Extent ../../geometry/mathUtils ../../support/expressionUtils ../../core/timerUtils ../support/attributeUtils ./geohashUtils ./statUtils".split(" "),function(k,e,p,q,n,l,h,f,d,c,a,b,g,u){return e(l,{loaded:!1,map:null,layer:null,lod:null,tolerance:null,
clusterMode:null,clusterRadius:null,sortEnabled:!0,filterEnabled:!0,bufferEnabled:!0,updateEnabled:!0,clusters:null,clustersEnabled:!0,statisticInfos:null,defaults:{lod:1,tolerance:0,clusterMode:"auto",clusterRadius:80,sortEnabled:!0,filterEnabled:!0,bufferEnabled:!0,updateEnabled:!0},_eventHandles:null,_updateHandle:null,_cellIndex:null,_globalIndex:null,_perfProfile:null,_cellSizeScaleFactor:1.5,_extentScaleFactor:1.25,_maxGeohashLength:12,_minClusterRadius:15,_levelChange:!0,_clusterFieldPrefix:"cluster_",
_mapLevelChange:!1,constructor:function(a){this._update=p.hitch(this,this._update);this._eventHandles=[];this._globalIndex={numFeatures:null,fullExtent:null,lodStats:null};this._perfProfile={lastIndex:{total:null,numFeatures:0},lastUpdate:{cells:null,clusters:null,total:null}};this.clusters=[];this.map=a.map;this.layer=a.layer;this.setLod(a.lod);this.setTolerance(a.tolerance);this.setClusterMode(a.clusterMode);this.setClusterRadius(a.clusterRadius);this.setSortEnabled(a.sortEnabled);this.setFilterEnabled(a.filterEnabled);
this.setBufferEnabled(a.bufferEnabled);this.setUpdateEnabled(a.updateEnabled);this.setStatisticInfos(a.statisticInfos);this._load();this.loaded?this._startup():this._eventHandles.push(this.on("load",p.hitch(this,this._startup)))},destroy:function(b){this._displayFeatures(!0,b);q.forEach(this._eventHandles,function(a){a.remove()});a.clearTimeout(this._updateHandle);this._cellIndex=this._globalIndex=this._eventHandles=this._updateHandle=this.map=this.layer=this.clusters=null},setLod:function(a){var b=
this.lod;this.lod=a||this.defaults.lod;b!==this.lod&&this.update()},setTolerance:function(a){var b=this.tolerance;this.tolerance=a||this.defaults.tolerance;b!==this.tolerance&&this.update()},setClusterMode:function(a){var b=this.clusterMode;this.clusterMode=a||this.defaults.clusterMode;this._evalClusterParams();b!==this.clusterMode&&this.update()},setClusterRadius:function(a){var b=this.clusterRadius;this.clusterRadius=null!=a?a:this.defaults.clusterRadius;this._evalClusterParams();b!==this.clusterRadius&&
this.update()},setSortEnabled:function(a){var b=this.sortEnabled;this.sortEnabled=null!=a?!!a:this.defaults.sortEnabled;b!==this.sortEnabled&&this.update()},setFilterEnabled:function(a){var b=this.filterEnabled;this.filterEnabled=null!=a?!!a:this.defaults.filterEnabled;b!==this.filterEnabled&&this.update()},setBufferEnabled:function(a){var b=this.bufferEnabled;this.bufferEnabled=null!=a?!!a:this.defaults.bufferEnabled;b!==this.bufferEnabled&&this.update()},setUpdateEnabled:function(a){var b=this.updateEnabled;
(this.updateEnabled=null!=a?!!a:this.defaults.updateEnabled)&&b!==this.updateEnabled&&(this._mapLevelChange=!0,this.update())},setStatisticInfos:function(a){this.statisticInfos=a||[];this.loaded&&this._applyStatInfos(this.statisticInfos)},update:function(){this.loaded&&null==this._updateHandle&&(this._updateHandle=a.setTimeout(this._update,a.priority.HIGH))},isUpdateScheduled:function(){return null!=this._updateHandle},getCell:function(a){return this._cellIndex[a.length][a]},getCluster:function(a){var b;
q.some(this.clusters,function(c){-1<q.indexOf(c.geohashes,a)&&(b=c);return!!b});return b},getCellsInCluster:function(a){var b=[];q.forEach(a&&a.geohashes,function(a){(a=this.getCell(a))&&b.push(a)},this);return b},getFeaturesInCluster:function(a){var b=[];a=this.getCellsInCluster(a);q.forEach(a,function(a){Array.prototype.push.apply(b,a.features)});return b},getCurrentLodStats:function(){var a=this._globalIndex.lodStats;return a&&a[this.lod]},getNumFeatures:function(){return this._globalIndex.numFeatures},
getFullExtent:function(){var a=this._globalIndex.fullExtent;return a&&Infinity!==a.xmin?new f(a):null},_load:function(){this._displayFeatures(!1);this._checkLoadStatus();this.map.loaded||this._eventHandles.push(this.map.on("load",p.hitch(this,this._checkLoadStatus)));this.layer.loaded||this._eventHandles.push(this.layer.on("load",p.hitch(this,this._checkLoadStatus)))},_checkLoadStatus:function(){if(this.map.loaded&&this.layer.loaded){var a;if("esriGeometryPoint"!==this.layer.geometryType)a=Error("GeohashAggregation is supported only for points");
else{var b=this.map.spatialReference;b.isWebMercator()||4326===b.wkid||(a=Error("GeohashAggregation is supported only when map spatial reference is WGS84 or WebMercator"))}a?(this.loadError=a,this.emit("load-error",{error:a})):(this.loaded=!0,this.emit("load"))}},_startup:function(){this._evalUpdateStatus();this._processFeatures();this._processExtentChange();this._eventHandles.push(this.layer.on("update-end",p.hitch(this,this._processFeatures)),this.layer.on("edits-complete",p.hitch(this,this._processFeatures)),
this.layer.on("graphics-clear",p.hitch(this,this._processFeatures)),this.layer.on("suspend",p.hitch(this,this._evalUpdateStatus)),this.layer.on("resume",p.hitch(this,this._evalUpdateStatus)),this.map.on("extent-change",p.hitch(this,this._processExtentChange)))},_processFeatures:function(){this._indexFeatures();this.update()},_evalUpdateStatus:function(){this.setUpdateEnabled(!this.layer.suspended)},_processExtentChange:function(a){this._mapLevelChange=!(!a||!a.levelChange);this._evalClusterParams();
this.update()},_update:function(){this._updateHandle=null;if(this.updateEnabled){this.emit("update-start");if(this.clustersEnabled){var a=this.map.geographicExtent;if(a){var b=this._getIntersectingCells(a),a=this._getClusters(b.cells,a);this.clusters=a.clusters;this._applyStatInfosToClusters();var b=b.profile,a=a.profile,c=b.total+a.total;b.total=this._getElapsedTime(b.total);a.total=this._getElapsedTime(a.total);var d=this._perfProfile.lastUpdate={};d.cells=b;d.clusters=a;d.total=this._getElapsedTime(c)}}else this.clusters=
[],this._perfProfile.lastUpdate=null;b=this._mapLevelChange;this._mapLevelChange=!1;this.emit("update-end",{levelChange:this._levelChange,mapLevelChange:b})}},_displayFeatures:function(a,b){var c=this.layer;a=!a;c.suspendGraphics(a);!1!==b&&(a?c.clearNodes():c.redraw())},_indexFeatures:function(){var a=this._getTime();this._initializeIndexing();var b=0,c=this._globalIndex.fullExtent;q.forEach(this.layer.graphics,function(a){if(a.visible){var d=a.geometry,f=this._getLngLat(d),m;f&&(m=d.getCacheValue("_geohash"),
void 0===m&&(m=g.pointToGeohash(f),d.setCacheValue("_geohash",m||null)));m&&(this._addGeohashToIndex(m,a,f),b++,this._updateExtent(c,f))}},this);this._applyStatInfosToIndex();this._globalIndex.numFeatures=b;for(var d=this._globalIndex.lodStats,f=1;f<=this._maxGeohashLength;f++)d[f]=this._getLODStats(f,b);this._perfProfile.lastIndex.total=this._getElapsedTime(a,this._getTime());this._perfProfile.lastIndex.numFeatures=b;this.emit("index-complete")},_initializeIndexing:function(){this._globalIndex={numFeatures:0,
fullExtent:{xmin:Infinity,ymin:Infinity,xmax:-Infinity,ymax:-Infinity},lodStats:{}};for(var a=this._cellIndex=[],b=1;b<=this._maxGeohashLength;b++)a[b]={}},_getLngLat:function(a){if(a){var b=a.getLongitude();a=a.getLatitude();a=null!=b&&null!=a?{x:b,y:a}:null}return a},_addGeohashToIndex:function(a,b,c){for(var d=this._cellIndex,g="",f=0;f<this._maxGeohashLength;f++){var g=g+a[f],m=d[g.length],h=m[g];h||(h=m[g]={count:0,centroid:{x:null,y:null},extent:{xmin:Infinity,ymin:Infinity,xmax:-Infinity,ymax:-Infinity},
features:[],geohash:g,statistics:null});this._updateItem(h,1,c,!0);h.features.push(b)}},_getLODStats:function(a,b){var c=this._cellIndex[a],d=0,g=Infinity,f=-Infinity,m=null,h;for(h in c){var e=c[h];d++;e.count<g&&(g=e.count);e.count>f&&(f=e.count)}0<d&&(m=Number((b/d).toFixed(2)));return{lod:a,count:d,min:Infinity===g?null:g,max:-Infinity===f?null:f,avg:m}},_evalClusterParams:function(){if(this.loaded&&"auto"===this.clusterMode){var a=this._getClusterParams(this.map.getResolutionInMeters(),this.clusterRadius,
this._minClusterRadius);this._levelChange=this.lod!==a.lod;this.lod=a.lod;this.tolerance=a.tolerance}},_getClusterParams:function(a,b,c){b<c&&(b=c);a=Math.ceil(a*b);b=this._getClosestLODRange(a).max;do c=this._getCellSize(b),(c=a>=this._cellSizeScaleFactor*c||1===c)||(b+=1);while(!c);c=a/this._getCellSize(b);return{lod:b,tolerance:a,multiplier:Number(c.toFixed(2))}},_getClosestLODRange:function(a){for(var b,c=this._maxGeohashLength;1<=c;c--)if(this._getCellSize(c)>=a){b=c;break}null==b&&(b=1);a=b+
1;a>this._maxGeohashLength&&(a=this._maxGeohashLength);return{min:b,max:a}},_getCellSize:function(a){a=g.getCellSizeInMeters(a);return Math.ceil(Math.min(a.width,a.height))},_sorter:function(a,b){var c=a.centroid,d=b.centroid;return a.count>b.count?-1:a.count<b.count?1:c.x>d.x?-1:c.x<d.x?1:0},_getIntersectingCells:function(a){var b=this._getTime();a=a.expand(this._extentScaleFactor);var c=g.getIntersecting(a,this.lod,this.bufferEnabled?this.tolerance:0);a=this._getTime();var d=[],f=this.tolerance,
m=this.sortEnabled;q.forEach(c,function(a){(a=this.getCell(a))&&d.push(a)},this);f&&m&&d.sort(this._sorter);c=this._getTime();return{cells:d,profile:{findCells:this._getElapsedTime(b,a),scanAndSortCells:this._getElapsedTime(a,c),total:c-b}}},_getClusters:function(a,b){var c=this._getTime(),d=[],g={},f={findCells:0};q.forEach(a,function(a,b){(a=this._createCluster(a,g,f))&&d.push(a)},this);this._markIntersecting(d,b);this.filterEnabled&&(d=this._getIntersectingClusters(d));a=this._getTime();return{clusters:d,
profile:{findCellsInCluster:this._getElapsedTime(f.findCells),total:a-c}}},_markIntersecting:function(a,b){var c=b.normalize();q.forEach(a,function(a){var b=a.centroid.x,d=a.centroid.y;a.isIntersecting=q.some(c,function(a){return b>=a.xmin&&b<=a.xmax&&d>=a.ymin&&d<=a.ymax})})},_getIntersectingClusters:function(a){return q.filter(a,function(a){return a.isIntersecting})},_createCluster:function(a,b,c){if(!b[a.geohash]){var d=[{cell:a,distance:0}];if(this.tolerance){var f=this._getTime(),m=g.getNeighborsWithinDistance(a.centroid,
this.lod,this.tolerance);c.findCells+=this._getTime()-f;q.forEach(m,function(b){if(b!==a.geohash&&(b=this.getCell(b))){var c=this._calculateDistance(a.centroid,b.centroid);c<=this.tolerance&&d.push({cell:b,distance:c})}},this)}return this._mergeCells(d,b)}},_calculateDistance:function(a,b){return d.getLength(g.geographicToWebMercator(a),g.geographicToWebMercator(b))},_mergeCells:function(a,b){var c=this._initializeCluster({},a[0].cell.geohash);q.forEach(a,function(a){var d=a.cell,g=d.geohash;a=a.distance;
var f=b[g];if(f)if(a<f.distance)this._removeCellFromCluster(g,b);else return;b[g]={cluster:c,distance:a};this._updateItem(c,d.count,d.centroid);c.geohashes.push(g)},this);return c},_removeCellFromCluster:function(a,b){var c=b[a].cluster;delete b[a];a=q.indexOf(c.geohashes,a);-1<a&&c.geohashes.splice(a,1);this._reevaluateCluster(c)},_reevaluateCluster:function(a){var b=a.geohashes;a=this._initializeCluster(a,a.primary);q.forEach(b,function(b){var c=this.getCell(b);c&&(this._updateItem(a,c.count,c.centroid),
a.geohashes.push(b))},this)},_initializeCluster:function(a,b){a.count=0;a.centroid=new h(null,null);a.geohashes=[];a.primary=b;a.statistics=null;return a},_applyStatInfos:function(a){a=this._getValidStatInfos(a);this._applyStatInfosToIndex(a);this._applyStatInfosToClusters(a)},_getValidStatInfos:function(a){var c=[];q.forEach(a,function(a){var d=a.attributeInfo;a=a.statisticType;var g="angle"===d.attributeType;if(u.isSupportedStatisticType(a)&&(!g||"avg"===a)){var f="arithmetic"===d.rotationType;
c.push({attributeCache:b.createAttributeCache(d,"type"===a),identifier:u.getStatisticId(d,a),statFunctions:u.getStatisticFunctions(a),isAngular:g,isDate:"date"===d.attributeType,isArithmetic:f})}});return c},_applyStatInfosToIndex:function(a){a=a||this._getValidStatInfos(this.statisticInfos);var b=this._cellIndex;if(b)for(var c=1;c<=this._maxGeohashLength;c++){var d=b[c],g;for(g in d)this._applyStatInfosToCell(d[g],a)}},_applyStatInfosToCell:function(a,b){var c=this._initializeStats(a,b);q.forEach(a.features,
function(a){this._calcFeatureStats(a,b,c)},this);this._summarizeStats(a,c,b)},_calcFeatureStats:function(a,b,d){a.attributes&&q.forEach(b,function(b){var g=d[b.identifier],f=b.attributeCache,f=f?a._getDataValue(f.attributeInfo,f,c):null;b.statFunctions.updateCellStat(g,f,b)})},_applyStatInfosToClusters:function(a){a=a||this._getValidStatInfos(this.statisticInfos);var b=this._clusterFieldPrefix;q.forEach(this.clusters,function(c){var d=this._initializeStats(c,a);q.forEach(this.getCellsInCluster(c),
function(b){this._calcCellStats(b,a,d)},this);this._summarizeStats(c,d,a,b);c.attributes[b+"id"]=c.primary},this)},_calcCellStats:function(a,b,c){var d=a.statistics;q.forEach(b,function(a){var b=a.identifier;a.statFunctions.updateClusterStat(c[b],d[b],a)})},_initializeStats:function(a,b){var c=a.statistics={};q.forEach(b,function(a){c[a.identifier]=a.statFunctions.initialize(a)});return c},_summarizeStats:function(a,b,c,d){var g=a.attributes={};d=d||"";g[d+"count"]=a.count;q.forEach(c,function(a){var c=
this._getStatFieldName(a,d);g[c]=a.statFunctions.summarize(b[a.identifier],a)},this)},_getStatFieldName:function(a,b){return(b||"")+a.identifier},_updateItem:function(a,b,c,d){var g=c.y,f=a.centroid,m=a.count;f.x=(m*f.x+b*c.x)/(m+b);f.y=(m*f.y+b*g)/(m+b);a.count+=b;d&&this._updateExtent(a.extent,c)},_updateExtent:function(a,b){var c=b.x;b=b.y;c<a.xmin&&(a.xmin=c);c>a.xmax&&(a.xmax=c);b<a.ymin&&(a.ymin=b);b>a.ymax&&(a.ymax=b)},_getTime:function(){return window.performance?window.performance.now():
(new Date).getTime()},_getElapsedTime:function(a,b){var c;a=null!=a&&null!=b?b-a:a;null!=a&&(c="millisecond",1E3<=a&&(a/=1E3,c="second",60<=a&&(a/=60,c="minute")),c={value:Number(a.toFixed(2)),unit:c});return c}})})},"esri/core/timerUtils":function(){define([],function(){function k(e){var h,f=e.length;for(h=0;h<f;h++)e[h]()}var e={LOW:1,HIGH:2},p,q={};q[e.LOW]=[];q[e.HIGH]=[];var n=function(){clearTimeout(p);p=null;var l=q[e.HIGH];q[e.HIGH]=[];k(l);l=q[e.LOW];q[e.LOW]=[];k(l)};return{priority:e,callbackQueue:q,
setTimeout:function(e,h){e=[h,q[h].push(e)-1];p||(p=setTimeout(n,0));return e},clearTimeout:function(e){e&&q[e[0]].splice(e[1],1)}}})},"esri/layers/clustering/geohashUtils":function(){define("dojo/has dojo/string dojo/_base/lang dojo/_base/array ../../kernel ../../geometry/Point ../../geometry/Extent ../../SpatialReference ../../geometry/webMercatorUtils".split(" "),function(k,e,p,q,n,l,h,f,d){function c(a){var b=a.spatialReference;if(!b)return{x:a.x,y:a.y};var c=b.isWebMercator(),d;4326===b.wkid?
d={x:a.x,y:a.y}:c&&(d={x:a.getLongitude(),y:a.getLatitude()});return d}function a(a){var b=a.spatialReference,c=!(!b||!b.isWebMercator()),g;b&&4326===b.wkid?g=new h(a.toJson()):c&&(g=d.webMercatorToGeographic(a,!0));return g}function b(a,b){b.x=l.prototype._normalizeX(a.x,f.prototype._info[4326]);b.y=a.y;return b}function g(a){a=F.decimals[a].toString(2);return e.pad(a,F.bitsPerBase32Char,"0")}function u(a,b){var c;b=b.slice();b.splice(1,0,0);for(var d=b[0],g=b[2],f=0;f<a.length;f++)Number(a[f])?
b[0]=b[1]:b[2]=b[1],c=b[1]=(b[0]+b[2])/2,d=b[0],g=b[2];return{value:c,min:d,max:g}}function m(a,b,c){var d=[];b=b.slice();b.splice(1,0,0);for(var g=b[0],f=b[2],m=0;m<c;m++)a>=b[1]?(b[0]=b[1],g=1):(b[2]=b[1],g=0),b[1]=(b[0]+b[2])/2,d.push(g),g=b[0],f=b[2];return{value:d.join(""),min:g,max:f}}function r(a){var b=a*F.bitsPerBase32Char;0===b%2?a=b/=2:(a=(b+1)/2,b-=a);return{lon:a,lat:b}}function t(a){var b=0;a=a.split("").reverse().join("");for(var c=0;c<a.length;c++)b+=Number(a[c])*Math.pow(2,c);return F.base32[b]}
function v(a,b){var c={x:a.xmin,y:a.ymax},d={x:a.xmax,y:a.ymin},g={x:a.xmax,y:a.ymax};return{sw:I.pointToGeohash({x:a.xmin,y:a.ymin},b),nw:I.pointToGeohash(c,b),se:I.pointToGeohash(d,b),ne:I.pointToGeohash(g,b)}}function y(a,b,c,d,g){var f=a;do g[f]||(g[f]=!0,d.push(f)),(a=f===b)||(f=D(f,c));while(!a)}function w(a,b,c,d){var g=v(a,b);a=[];y(g.sw,g.nw,"n",a,{});b=[];y(g.se,g.ne,"n",b,{});for(g=0;g<a.length;g++)y(a[g],b[g],"e",c,d)}function z(a){return q.filter(a,function(a){return 180===a.xmax?!0:
!1})[0]}function x(a){return q.filter(a,function(a){return-180===a.xmin?!0:!1})[0]}function A(a,b,c,d){var g=I.geographicToWebMercator(a);a={x:g.x-b,y:g.y-b};b=I.webMercatorToGeographic({x:g.x+b,y:g.y+b},!0);a=I.webMercatorToGeographic(a,!0);return new h(null!=c?c:a.x,a.y,null!=d?d:b.x,b.y)}function C(a,b,c,d){var g;a=v(a,b);var f,m;"min"===d?m=180:"max"===d&&(f=-180);var e=f;d=m;g=I.geohashToCell(a.sw).extent;b=I.geohashToCell(a.ne).extent;a=null!=e?e:g.xmin;g=g.ymin;d=null!=d?d:b.xmax;b=b.ymax;
a=A({x:a,y:g},c,f,m);c=A({x:d,y:b},c,f,m);return new h(a.xmin,a.ymin,c.xmax,c.ymax)}function B(a,b,c){var d=a,g=0;do g++,(a=d===b)||(d=D(d,c));while(!a);return g}function E(a,b){a=v(a,b);b=B(a.nw,a.ne,"e");return{rows:B(a.nw,a.sw,"s"),cols:b}}function D(a,b){var c=a.length%2,d=a.slice(-1),g=F.decimals[d];a=a.slice(0,-1);-1!=F.borders[b][c].indexOf(d)&&a&&(a=D(a,b));return a+F.neighbors[b][c][g]}var F={base32:"0123456789bcdefghjkmnpqrstuvwxyz",decimals:function(){for(var a={},b=0;32>b;b++)a["0123456789bcdefghjkmnpqrstuvwxyz"[b]]=
b;return a}(),neighbors:{n:[null,"238967debc01fg45kmstqrwxuvhjyznp"],s:[null,"bc01fg45238967deuvhjyznpkmstqrwx"],e:[null,"14365h7k9dcfesgujnmqp0r2twvyx8zb"],w:[null,"p0r21436x8zb9dcf5h7kjnmqesgutwvy"]},borders:{n:[null,"bcfguvyz"],s:[null,"0145hjnp"],e:[null,"prxz"],w:[null,"028b"]},bitsPerBase32Char:5,maxGeohashLength:12,longitudeRange:[-180,180],latitudeRange:[-90,90]};F.neighbors.n[0]="14365h7k9dcfesgujnmqp0r2twvyx8zb";F.neighbors.s[0]="p0r21436x8zb9dcf5h7kjnmqesgutwvy";F.neighbors.e[0]="238967debc01fg45kmstqrwxuvhjyznp";
F.neighbors.w[0]="bc01fg45238967deuvhjyznpkmstqrwx";F.borders.n[0]="prxz";F.borders.s[0]="028b";F.borders.e[0]="bcfguvyz";F.borders.w[0]="0145hjnp";var I={geographicToWebMercator:function(a){a=l.lngLatToXY(a.x,a.y);return{x:a[0],y:a[1]}},webMercatorToGeographic:function(a,b){a=l.xyToLngLat(a.x,a.y,b);return{x:a[0],y:a[1]}},geohashToCell:function(a){for(var b=[],c=0;c<a.length;c++)b.push(g(a[c]));for(var b=b.join(""),c=[],d=[],f=0;f<b.length;f++)0===f%2?c.push(b[f]):d.push(b[f]);c=c.join("");d=d.join("");
c=[c,d];b=u(c[0],F.longitudeRange);c=u(c[1],F.latitudeRange);return{point:{x:b.value,y:c.value},extent:{xmin:b.min,xmax:b.max,ymin:c.min,ymax:c.max},geohash:a}},pointToCell:function(a,d){var g,f;d=d||F.maxGeohashLength;if(a=c(a)){a=b(a,a);g=r(d);d=m(a.x,F.longitudeRange,g.lon);var h=m(a.y,F.latitudeRange,g.lat);g=d.value;f=h.value;d={xmin:d.min,xmax:d.max,ymin:h.min,ymax:h.max};for(var h=[],e=Math.ceil((g.length+f.length)/F.bitsPerBase32Char),l=0,n=0,k=0;k<e*F.bitsPerBase32Char;k++){var u=0===k%2?
g[l++]:f[n++];null==u&&(u=0);h.push(u)}g=h.join("");f=F.bitsPerBase32Char;h=g.length/f;e=[];for(l=0;l<h;l++)n=g.substr(l*f,f),e.push(t(n));g=e.join("");return{point:a,extent:d,geohash:g}}},geohashToPoint:function(a){return I.geohashToCell(a).point},pointToGeohash:function(a,b){return(a=I.pointToCell(a,b))&&a.geohash},getCells:function(a){return q.map(a,function(a){return I.geohashToCell(a)})},getCellSize:function(a){var b=F.longitudeRange,c=F.latitudeRange,b=Math.abs(b[1]-b[0]),c=Math.abs(c[1]-c[0]);
a=r(a||1);return{width:b/Math.pow(2,a.lon),height:c/Math.pow(2,a.lat)}},getCellSizeInMeters:function(a){a=I.getCellSize(a);var b=d.metersPerDegree;a.width*=b;a.height*=b;return a},getIntersecting:function(b,c,d){c=c||1;d=d||0;var g=[],f=a(b);if(f){d&&(f=I.expandExtent(b,c,d));b=f.normalize();var m={};q.forEach(b,function(a){w(a,c,g,m)})}return g},countIntersecting:function(c,d,g){d=d||1;g=g||0;var f=0,m=a(c);if(m){g&&(m=I.expandExtent(c,d,g));c=m.normalize();if(2===c.length){f=z(c);m=x(c);g=E(f,d);
var h=E(m,d);c=g.rows;g=g.cols+h.cols;f={x:f.xmin,y:f.ymax};m={x:m.xmax,y:m.ymax};f=b(f,{});m=b(m,{});f=I.pointToGeohash(f,d);d=I.pointToGeohash(m,d);f===d&&g--;d={rows:c,cols:g}}else d=E(c[0],d);f=d.cols*d.rows}return f},getChildren:function(a){a=a||"";var b=[],c;for(c in F.decimals)b.push(a+c);return b},getNeighbors:function(a){var b=D(a,"n"),c=D(a,"s");return[b,D(b,"e"),D(b,"w"),c,D(c,"e"),D(c,"w"),D(a,"e"),D(a,"w")]},getExtentFromDistance:function(a,b){b=b||1E3;var d;(a=c(a))&&(d=A(a,b));return d},
expandExtent:function(b,c,d){c=c||1;d=d||0;if(b=a(b)){if(d){b=b.normalize();if(2===b.length){var g=d;d=z(b);b=x(b);d=C(d,c,g,"min");b=C(b,c,g,"max");360<=d.getWidth()+b.getWidth()?(c=-180,b=180):(c=d.xmin,b=b.xmax);return new h(c,d.ymin,b,d.ymax)}return C(b[0],c,d)}return b}},getNeighborsWithinDistance:function(a,b,d){d=d||1E3;b=b||1;var g=[];if(a=c(a)){d=A(a,d).normalize();var f={};q.forEach(d,function(a){w(a,b,g,f)})}return g}};return I})},"esri/layers/clustering/statUtils":function(){define(["dojo/_base/lang",
"../support/attributeUtils"],function(k,e){function p(e){return"number"===typeof e&&!isNaN(e)&&Infinity!==e&&-Infinity!==e}var q={sum:{initialize:function(){return{count:0,sum:null}},updateCellStat:function(e,h){p(h)&&(e.count++,e.sum+=h)},updateClusterStat:function(e,h){h.count&&(e.count+=h.count,e.sum+=h.sum)},summarize:function(e){return e.sum}},avg:{initialize:function(e){return{count:0,sum:null,avg:null,sum_cosine:null,sum_sine:null}},updateCellStat:function(e,h,f){p(h)&&(e.count++,f.isAngular?
(f.isArithmetic||(h=-1*h+90),e.sum_cosine+=Math.cos(h*Math.PI/180),e.sum_sine+=Math.sin(h*Math.PI/180)):e.sum+=h)},updateClusterStat:function(e,h,f){h.count&&(e.count+=h.count,f.isAngular?(e.sum_cosine+=h.sum_cosine,e.sum_sine+=h.sum_sine):e.sum+=h.sum)},summarize:function(e,h){if(0<e.count){var f=e.count;h.isAngular?(f=180*Math.atan2(e.sum_sine/f,e.sum_cosine/f)/Math.PI,h.isArithmetic||(f=-1*(f-90)),e.avg=0>f?f+360:f):(e.avg=e.sum/f,h.isDate&&(e.avg=Math.ceil(e.avg)))}return e.avg}},type:{initialize:function(){return{uvInfos:{}}},
updateCellStat:function(e,h){if(null==h||""===h||"string"===typeof h&&""===k.trim(h))h=null;e=e.uvInfos;null==e[h]?e[h]={count:1,value:h}:e[h].count++},updateClusterStat:function(e,h){e=e.uvInfos;h=h.uvInfos;for(var f in h){var d=h[f];null==e[f]?e[f]={count:d.count,value:d.value}:e[f].count+=d.count}},summarize:function(e){e=e.uvInfos;var h,f=-Infinity,d;for(h in e){var c=e[h];c.count>f?(f=c.count,d=c.value):c.count===f&&(d=null)}return d}}},n={isSupportedStatisticType:function(e){return q.hasOwnProperty(e)},
getStatisticFunctions:function(e){return q[e]},getStatisticId:function(l,h){var f=e.getAttributeIdSource(l);l=f&&e.getAttributeId(f)||l.field;return h+"_"+l},getClusterField:function(e,h){return"cluster_"+n.getStatisticId(e,h)},getStatisticHash:function(e,h){h=[n.getStatisticId(e,h)];e.attributeType&&h.push(e.attributeType.toLowerCase());e.rotationType&&h.push(e.rotationType.toLowerCase());return h.join("_")}};return n})},"esri/tasks/ProjectParameters":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/json dojo/has ../kernel ../lang ../geometry/jsonUtils".split(" "),
function(k,e,p,q,n,l,h,f){return k(null,{declaredClass:"esri.tasks.ProjectParameters",geometries:null,outSR:null,transformation:null,transformForward:null,toJson:function(){var d=p.map(this.geometries,function(a){return a.toJson()}),c={};c.outSR=this.outSR.wkid||q.toJson(this.outSR.toJson());c.inSR=this.geometries[0].spatialReference.wkid||q.toJson(this.geometries[0].spatialReference.toJson());c.geometries=q.toJson({geometryType:f.getJsonType(this.geometries[0]),geometries:d});this.transformation&&
(c.transformation=this.transformation.wkid||q.toJson(this.transformation));h.isDefined(this.transformForward)&&(c.transformForward=this.transformForward);return c}})})},"jimu/portalUrlUtils":function(){define(["dojo/_base/lang","jimu/shared/basePortalUrlUtils"],function(k,e){var p=k.clone(e);p.declaredClass="jimu.portalUrlUtils";p.getPortalUrlFromLocation=function(){return p.getPortalServerFromLocation()+p.getDeployContextFromLocation()};p.getPortalSignInUrlFromLocation=function(){var e=p.getPortalUrlFromLocation();
return p.setHttpsProtocol(e+"home/signin.html")};p.getPortalServerFromLocation=function(){return window.location.protocol+"//"+window.location.host};p.getDeployContextFromLocation=function(){var e=window.location.href.split("?")[0],n=e.indexOf("/home");0>n&&(n=e.indexOf("/apps"));e=e.substring(e.indexOf(window.location.host)+window.location.host.length+1,n);"/"!==e&&(e="/"+e+"/");return e};p.getRestBaseUrlFromLocation=function(){return window.location.protocol+"//"+window.location.host+p.getDeployContextFromLocation()+
"sharing/rest/"};return p})},"jimu/shared/basePortalUrlUtils":function(){define(function(){var k={declaredClass:"jimu.shared.basePortalUrlUtils"};"function"!==typeof String.prototype.trim&&(String.prototype.trim=function(){return this.replace(/^\s*/gi,"").replace(/\s*$/gi,"")});"function"!==typeof String.prototype.startWith&&(String.prototype.startWith=function(e){return this.substr(0,e.length)===e});"function"!==typeof String.prototype.endWith&&(String.prototype.endWith=function(e){return this.substr(this.length-
e.length,e.length)===e});k.getServerByUrl=function(e){e=(e||"").trim();e=e.replace(/^(http(s?):?)\/\//gi,"");0===e.indexOf("//")&&(e=e.slice(2));return e.split("/")[0]};k.getServerWithProtocol=function(e){var p="";if(e=(e||"").trim()){var q=k.getServerByUrl(e);if(!q)return p;var n=k.getProtocol(e);n?p=n+"://"+q:0===e.indexOf("//")&&(p="//"+q)}return p};k.isSameServer=function(e,p){e=k.getServerByUrl(e)||"";p=k.getServerByUrl(p)||"";return e.toLowerCase()===p.toLowerCase()};k.getDomain=function(e){var p=
"";if(e=k.getServerByUrl(e))e=e.replace(/:\d+$/,""),e=e.match(/[^.]\w+\.\w+$/),null!==e&&(p=e[0],/^\d+\.\d+$/.test(p)&&(p=""));return p};k.isSameDomain=function(e,p){e=k.getDomain(e);p=k.getDomain(p);return""!==e&&e===p};k.isOrgOnline=function(e){return 0<=k.getServerByUrl(e).toLowerCase().indexOf(".maps.arcgis.com")};k.isOnline=function(e){return 0<=k.getServerByUrl(e).toLowerCase().indexOf(".arcgis.com")};k.isArcGIScom=function(e){e=k.getServerByUrl(e).toLowerCase();return"www.arcgis.com"===e||
"arcgis.com"===e};k.getStandardPortalUrl=function(e){var p=k.getServerByUrl(e);if(""===p)return"";k.isOnline(p)?(k.isArcGIScom(p)&&(p="www.arcgis.com"),e=k.addProtocol(e),e=k.getProtocol(e)+"://"+p):(e=(e||"").trim().replace(/sharing(.*)/gi,"").replace(/\/*$/g,""),e=k.addProtocol(e),e.replace(new RegExp("http(s?)://"+p,"g"),"")||(e+="/arcgis"));return e};k.isSamePortalUrl=function(e,p){var q=/^http(s?):\/\//gi,n=/^\/\//gi;e=k.getStandardPortalUrl(e).toLowerCase().replace(q,"").replace(n,"");p=k.getStandardPortalUrl(p).toLowerCase().replace(q,
"").replace(n,"");return e===p};k.addProtocol=function(e){if(-1>=e.toLowerCase().indexOf("http://")&&-1>=e.toLowerCase().indexOf("https://")){var k="";"undefined"!==typeof window&&window.location?(k=window.location.protocol,e=e.startWith("//")?k+e:e.startWith("/")?k+"//"+window.location.host+e:k+"//"+e):(k="http:",e=e.startWith("//")?k+e:k+"//"+e)}return e};k.getProtocol=function(e){var k="";e=e.toLowerCase();0===e.indexOf("https://")?k="https":0===e.indexOf("http://")&&(k="http");return k};k.updateUrlProtocolByOtherUrl=
function(e,p){p=p.toLowerCase();0===p.indexOf("https://")?e=k.setHttpsProtocol(e):0===p.indexOf("http://")&&(e=k.setHttpProtocol(e));return e};k.removeProtocol=function(e){return e.replace(/^http(s?):\/\//i,"//")};k.setHttpProtocol=function(e){e=k.addProtocol(e);return e.replace(/^https:\/\//,"http://")};k.setHttpsProtocol=function(e){e=k.addProtocol(e);return e.replace(/^http:\/\//,"https://")};k.setProtocol=function(e,p){return 0<=p.indexOf("https")?k.setHttpsProtocol(e):0<=p.indexOf("http")?k.setHttpProtocol(e):
e};k.getSharingUrl=function(e){var p="";(e=k.getStandardPortalUrl(e))&&(p=e+"/sharing/rest");return p};k.getOAuth2Url=function(e){var p="";(e=k.getStandardPortalUrl(e))&&(p=e+"/sharing/rest/oauth2");return p};k.getAppIdUrl=function(e,p){var q="";(e=k.getStandardPortalUrl(e))&&(q=e+"/sharing/rest/oauth2/apps/"+p);return q};k.getSignInUrl=function(e){var p="";(e=k.getStandardPortalUrl(e))&&(p=e+"/home/signin.html");return p};k.getBaseSearchUrl=function(e){var p="";e=k.getStandardPortalUrl(e);(e=e.replace(/\/*$/g,
""))&&(p=e+"/sharing/rest/search");return p};k.getBaseItemUrl=function(e){var p="";(e=k.getStandardPortalUrl(e))&&(p=e+"/sharing/rest/content/items");return p};k.getItemUrl=function(e,p){var q="";(e=k.getBaseItemUrl(e))&&p&&(q=e+"/"+p);return q};k.getItemDataUrl=function(e,p){var q="";(e=k.getItemUrl(e,p))&&(q=e+"/data");return q};k.getItemGroupsUrl=function(e,p){var q="";(e=k.getItemUrl(e,p))&&(q=e+"/groups");return q};k.getGenerateTokenUrl=function(e){var p="";(e=k.getStandardPortalUrl(e))&&(p=
e+"/sharing/generateToken");return p};k.getItemDetailsPageUrl=function(e,p){var q="";e&&p&&(e=k.getStandardPortalUrl(e),q=e+"/home/item.html?id\x3d"+p);return q};k.getUserProfilePageUrl=function(e,p){var q="";e&&p&&(e=k.getStandardPortalUrl(e),q=e+"/home/user.html?user\x3d"+p);return q};k.getBaseGroupUrl=function(e){var p="";(e=k.getStandardPortalUrl(e))&&(p=e+"/sharing/rest/community/groups");return p};k.getPortalSelfInfoUrl=function(e){var p="";(e=k.getStandardPortalUrl(e||""))&&(p=e+"/sharing/rest/portals/self");
return p};k.getCommunitySelfUrl=function(e){var p="";(e=k.getStandardPortalUrl(e||""))&&(p=e+"/sharing/rest/community/self");return p};k.getBaseUserUrl=function(e){var p="";(e=k.getStandardPortalUrl(e))&&(p=e+"/sharing/rest/community/users");return p};k.getUserUrl=function(e,p){var q="",n=k.getBaseUserUrl(e);e&&p&&(q=n+"/"+p);return q};k.getUserTagsUrl=function(e,p){var q="",n=k.getUserUrl(e,p);e&&p&&(q=n+"/tags");return q};k.getUserThumbnailUrl=function(e,p,q){var n="";(e=k.getUserUrl(e,p))&&q&&
(n=e+"/info/"+q);return n};k.getContentUrl=function(e){var p="";e&&(e=k.getStandardPortalUrl(e),p=e+"/sharing/rest/content");return p};k.getUserContentUrl=function(e,p,q){var n="",n="";e&&p&&(n=k.getContentUrl(e),n=q?n+"/users/"+p+"/"+q:n+"/users/"+p);return n};k.getUserContentItemUrl=function(e,p,q){var n="",n="";e&&p&&q&&(n=k.getUserContentUrl(e,p),n=n+"/items/"+q);return n};k.getItemResourceUrl=function(e,p,q){var n="",n="";e&&p&&(n=k.getContentUrl(e),n=q?n+"/items/"+p+"/resources/"+q:n+"/items/"+
p+"/resources");return n};k.getAddItemUrl=function(e,p,q){var n="",n="";e&&p&&(n=k.getUserContentUrl(e,p,q),n+="/addItem");return n};k.getDeleteItemUrl=function(e,p,q){var n="";(e=k.getUserItemsUrl(e,p))&&(n=e+"/"+q+"/delete");return n};k.getUserItemsUrl=function(e,p,q){var n="",n="";e&&p&&(n=k.getUserContentUrl(e,p,q),n+="/items");return n};k.getUpdateItemUrl=function(e,p,q,n){var l="",l="";e&&p&&(l=k.getUserItemsUrl(e,p,n),l=l+"/"+q+"/update");return l};k.shareItemUrl=function(e,p,q,n){var l="",
l="";e&&p&&(l=k.getUserItemsUrl(e,p,n),l=l+"/"+q+"/share");return l};k.getHomeIndexUrl=function(e){var p="";(e=k.getStandardPortalUrl(e))&&(p=e+"/home/index.html");return p};k.getHomeMapViewerUrl=function(e,p){var q="";if(e=k.getStandardPortalUrl(e))q=e+"/home/webmap/viewer.html",q=p?q+("?webmap\x3d"+p):q+"?useExisting\x3d1";return q};k.getHomeSceneViewerUrl=function(e,p){var q="";if(e=k.getStandardPortalUrl(e))q=e+"/home/webscene/viewer.html",p&&(q+="?webscene\x3d"+p);return q};k.getHomeGalleryUrl=
function(e){var p="";(e=k.getStandardPortalUrl(e))&&(p=e+"/home/gallery.html");return p};k.getHomeGroupsUrl=function(e){var p="";(e=k.getStandardPortalUrl(e))&&(p=e+"/home/groups.html");return p};k.getHomeMyContentUrl=function(e){var p="";(e=k.getStandardPortalUrl(e))&&(p=e+"/home/content.html");return p};k.getHomeMyOrganizationUrl=function(e){var p="";(e=k.getStandardPortalUrl(e))&&(p=e+"/home/organization.html");return p};k.getHomeUserUrl=function(e){var p="";(e=k.getStandardPortalUrl(e))&&(p=e+
"/home/user.html");return p};k.getPortalHelpUrl=function(e,p){var q="";(e=k.getStandardPortalUrl(e))&&(q=e+"/portalhelp/"+(p||"en")+"/website/help/");return q};k.getPortalAdminHelpUrl=function(e,p){var q="";(e=k.getStandardPortalUrl(e))&&(q=e+"/portalhelp/"+(p||"en")+"/admin/help/");return q};k.getPortalProxyUrl=function(e){var p="";(e=k.getStandardPortalUrl(e))&&(p=e+"/sharing/proxy");return p};k.getOAuth2SignOutUrl=function(e){var p="";(e=k.getStandardPortalUrl(e))&&(p=e+"/sharing/rest/oauth2/signout");
return p};k.getNewPrintUrl=function(e){var p="";if(e=k.getStandardPortalUrl(e))e=k.setHttpProtocol(e),p=e+"/sharing/tools/newPrint";return p};k.getSwitchAccoutnsUrl=function(e,p,q){var n="";if(e=k.getStandardPortalUrl(e))n=e+"/home/pages/Account/manage_accounts.html#client_id\x3d"+p,q&&(n+="\x26redirect_uri\x3d"+q);n&&(n=k.setHttpsProtocol(n));return n};return k})},"jimu/shared/utils":function(){define(["./basePortalUrlUtils"],function(k){function e(e,l){function h(f,d){var c,a,b,g,h="widgetOnScreen"===
f;if(e[f]){if(e[f].groups)for(c=0;c<e[f].groups.length;c++)if(b=e[f].groups[c],d(b,{index:c,isWidget:!1,groupId:b.id,isThemeWidget:!1,isOnScreen:h}),e[f].groups[c].widgets)for(a=0;a<e[f].groups[c].widgets.length;a++)g=e[f].groups[c].widgets[a],d(g,{index:a,isWidget:!0,groupId:b.id,isThemeWidget:g.uri&&-1<g.uri.indexOf("themes/"+e.theme.name),isOnScreen:h});if(e[f].widgets)for(c=0;c<e[f].widgets.length;c++)g=e[f].widgets[c],d(e[f].widgets[c],{index:c,isWidget:!0,groupId:f,isThemeWidget:g.uri&&-1<g.uri.indexOf("themes/"+
e.theme.name),isOnScreen:h})}}h("widgetOnScreen",l);h("widgetPool",l)}var p={},q="inPanel hasLocale hasStyle hasConfig hasUIFile hasSettingPage hasSettingUIFile hasSettingLocale hasSettingStyle keepConfigAfterMapSwitched isController hasVersionManager isThemeWidget supportMultiInstance".split(" ");p.visitElement=e;p.getConfigElementById=function(n,l){var h;if("map"===l)return n.map;e(n,function(f){if(f.id===l)return h=f,!0});return h};p.getConfigElementByLabel=function(n,l){var h;if("map"===l)return n.map;
e(n,function(f){if(f.label||f.name===l)return h=f,!0});return h};p.getConfigElementsByName=function(n,l){var h=[];if("map"===l)return[n.map];e(n,function(f){f.name===l&&h.push(f)});return h};p.getWidgetNameFromUri=function(e){e=e.split("/");e.pop();return e.pop()};p.getAmdFolderFromUri=function(e){e=e.split("/");e.pop();return e.join("/")+"/"};p.widgetProperties=q;p.processWidgetProperties=function(e){"undefined"===typeof e.properties.isController&&(e.properties.isController=!1);"undefined"===typeof e.properties.isThemeWidget&&
(e.properties.isThemeWidget=!1);"undefined"===typeof e.properties.hasVersionManager&&(e.properties.hasVersionManager=!1);q.forEach(function(l){"undefined"===typeof e.properties[l]&&(e.properties[l]=!0)})};p.getControllerWidgets=function(e){var l=[];e.visitElement(function(h){h.isController&&l.push(h)});return l};p.addI18NLabelToManifest=function(e,l,h){function f(a,b){b[d]&&(e.i18nLabels[a]=b[d]);"theme"===e.category&&(e.layouts&&e.layouts.forEach(function(c){e["i18nLabels_layout_"+c.name]||(e["i18nLabels_layout_"+
c.name]={});e["i18nLabels_layout_"+c.name][a]=b["_layout_"+c.name]}),e.styles&&e.styles.forEach(function(c){e["i18nLabels_style_"+c.name]||(e["i18nLabels_style_"+c.name]={});e["i18nLabels_style_"+c.name][a]=b["_style_"+c.name]}));"widget"===e.category&&e.featureActions&&e.featureActions.forEach(function(c){e["i18nLabels_featureAction_"+c.name]||(e["i18nLabels_featureAction_"+c.name]={});e["i18nLabels_featureAction_"+c.name][a]=b["_featureAction_"+c.name]})}e.i18nLabels={};var d="widget"===e.category?
"_widgetLabel":"_themeLabel";l&&l.root&&l.root[d]&&(e.i18nLabels.defaultLabel=l.root[d],"theme"===e.category&&(e.layouts&&e.layouts.forEach(function(a){e["i18nLabels_layout_"+a.name]={};e["i18nLabels_layout_"+a.name].defaultLabel=l.root["_layout_"+a.name]}),e.styles&&e.styles.forEach(function(a){e["i18nLabels_style_"+a.name]={};e["i18nLabels_style_"+a.name].defaultLabel=l.root["_style_"+a.name]})),"widget"===e.category&&e.featureActions&&e.featureActions.forEach(function(a){e["i18nLabels_featureAction_"+
a.name]={};e["i18nLabels_featureAction_"+a.name].defaultLabel=l.root["_featureAction_"+a.name]}));for(var c in h)f(c,h[c])};p.isHostedService=function(e){var l=k.getServerByUrl(e);return(new RegExp(l+"/[^/]+/[^/]+/rest/services","gi")).test(e)};return p})},"jimu/portalUtils":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/config dojo/Deferred dojo/topic dojo/json dojo/request/xhr esri/request ./Role ./utils ./portalUrlUtils ./tokenUtils ./ServiceDefinitionManager".split(" "),
function(k,e,p,q,n,l,h,f,d,c,a,b,g,u){var m=k([],{declaredClass:"jimu.Portal",selfUrl:null,user:null,selfInfo:null,portalUrl:null,credential:null,constructor:function(a){this.portalUrl=b.getStandardPortalUrl(a);this.selfUrl=b.getPortalSelfInfoUrl(a)},loadSelfInfo:function(){var a=this.selfUrl;this.isValidCredential()&&(a=-1<a.indexOf("?")?a+("\x26token\x3d"+this.credential.token):a+("?token\x3d"+this.credential.token));return u.getInstance().getServiceDefinition(a).then(e.hitch(this,function(a){var b=
a.user;delete a.user;e.mixin(this,a);a.user=b;return a}))},_checkCredential:function(){var a=g.isValidCredential(this.credential);a||this.clearCredentialAndUser();return a},isValidCredential:function(){this.updateCredential();return this._checkCredential()},updateCredential:function(){this._checkCredential()||(this.credential=g.getPortalCredential(this.portalUrl))},signIn:function(){var a=new n;this.updateCredential();this.isValidCredential()?setTimeout(e.hitch(this,function(){a.resolve(this.credential)}),
0):a=g.signInPortal(this.portalUrl);return a},haveSignIn:function(){return g.userHaveSignInPortal(this.portalUrl)},clearCredentialAndUser:function(){this.user=this.credential=null},getUser:function(){this.updateCredential();var a=new n;this.user&&"jimu.PortalUser"===this.user.declaredClass?setTimeout(e.hitch(this,function(){this.user.updateCredential();a.resolve(this.user)}),0):this.isValidCredential()?this.credential.userId?this._getUser(this.credential.userId).then(e.hitch(this,function(b){this.user=
b;a.resolve(this.user)}),e.hitch(this,function(b){console.error(b);a.reject(b)})):g.getUserIdByToken(this.credential.token,this.portalUrl).then(e.hitch(this,function(b){this.credential.userId=b;this._getUser(this.credential.userId).then(e.hitch(this,function(b){this.user=b;a.resolve(this.user)}),e.hitch(this,function(b){console.error(b);a.reject(b)}))}),e.hitch(this,function(b){console.error(b);a.reject(b)})):setTimeout(e.hitch(this,function(){a.reject("credential is null.")}),0);return a},queryItems:function(a){this.updateCredential();
var c=new n,g=b.getBaseSearchUrl(this.portalUrl),f={f:"json"};a&&(f=e.mixin(f,a));this.isValidCredential()&&(f.token=this.credential.token);f.sortField||f.sortOrder||(f.sortField="title",f.sortOrder="asc");d({url:g,handleAs:"json",content:f,callbackParamName:"callback"}).then(e.hitch(this,function(a){a.results=p.map(a.results,e.hitch(this,function(a){a.portalUrl=this.portalUrl;a.credential=this.credential;a.portal=this;return new v(a)}));c.resolve(a)}),e.hitch(this,function(a){console.error(a);c.reject(a)}));
return c},getItemData:function(a){this.updateCredential();a={url:b.getItemDataUrl(this.portalUrl,a),handleAs:"json",content:{f:"json"},callbackParamName:"callback"};return d(a)},_getItemById:function(a,c){a={url:b.getItemUrl(this.portalUrl,a),handleAs:"json",content:{f:"json"},callbackParamName:"callback"};c&&(a.content.token=c);return d(a).then(e.hitch(this,function(a){a.portalUrl=this.portalUrl;a.credential=this.credential;a.portal=this;return new v(a)}))},getItemById:function(a,b){this.updateCredential();
return this._getItemById(a).then(e.hitch(this,function(c){return b&&c.owner&&this.isValidCredential()&&this.credential&&this.credential.userId===c.owner?this._getItemById(a,this.credential.token):c}))},getAppById:function(a){var c=new n;this.updateCredential();this.isValidCredential()?(a=b.getAppIdUrl(this.portalUrl,a),c=d({url:a,handleAs:"json",content:{f:"json",token:this.credential.token}})):setTimeout(e.hitch(this,function(){c.reject("token is null.")}),0);return c},queryGroups:function(a){this.updateCredential();
var c=new n,g=b.getBaseGroupUrl(this.portalUrl),f={f:"json"};a&&(f=e.mixin(f,a));this.isValidCredential()&&(f.token=this.credential.token);d({url:g,handleAs:"json",content:f,callbackParamName:"callback"}).then(e.hitch(this,function(a){a.results=p.map(a.results,e.hitch(this,function(a){a.portalUrl=this.portalUrl;a.credential=this.credential;a.portal=this;return new t(a)}));c.resolve(a)}),e.hitch(this,function(a){console.error(a);c.reject(a)}));return c},registerApp:function(a,c,g){var f=new n;this.updateCredential();
if(this.isValidCredential())var m=this.credential&&this.credential.token,l=b.getOAuth2Url(this.portalUrl),f=d({url:l+"/registerApp",content:{itemId:a,appType:c,redirect_uris:h.stringify(g),token:m,f:"json"},handleAs:"json"},{usePost:!0});else setTimeout(e.hitch(this,function(){f.reject("token is null.")}),0);return f},createAndRegisterApp:function(a){var b=new n;this.updateCredential();this.isValidCredential()?this.getUser().then(e.hitch(this,function(c){c.addItem({title:"Web AppBuilder for ArcGIS",
type:"Web Mapping Application",text:"",snippet:"",tags:"Registered App for OAuth"},"").then(e.hitch(this,function(c){c.success?this.registerApp(c.id,"browser",a).then(e.hitch(this,function(a){b.resolve(a)}),e.hitch(this,function(a){console.error(a);b.reject(a)})):b.reject("create app failed")}),e.hitch(this,function(a){console.error(a);b.reject(a)}))}),e.hitch(this,function(a){console.error(a);b.reject(a)})):setTimeout(e.hitch(this,function(){b.reject("token is null.")}),0);return b},_getUser:function(a){this.updateCredential();
var c=new n;a={url:b.getUserUrl(this.portalUrl,a),content:{f:"json"},handleAs:"json",callbackParamName:"callback"};this.isValidCredential()&&(a.content.token=this.credential&&this.credential.token);d(a).then(e.hitch(this,function(a){a.portalUrl=this.portalUrl;a.credential=this.credential;a.portal=this;this.user=new r(a);c.resolve(this.user)}),e.hitch(this,function(a){console.error(a);c.reject(a)}));return c}}),r=k([],{declaredClass:"jimu.PortalUser",portalUrl:null,credential:null,portal:null,constructor:function(a){a&&
e.mixin(this,a)},_checkCredential:function(){var a=g.isValidCredential(this.credential);a||(this.credential=null);return a},isValidCredential:function(){this.updateCredential();return this._checkCredential()},updateCredential:function(){this._checkCredential()||(this.portal.updateCredential(),this.credential=this.portal.credential)},canCreateItem:function(){var a=new c({id:this.roleId?this.roleId:this.role,role:this.role});this.privileges&&a.setPrivileges(this.privileges);return a.canCreateItem()},
getGroups:function(){var a=[];this.groups&&(a=p.map(this.groups,e.hitch(this,function(a){a.portalUrl=this.portalUrl;a.credential=this.credential;a.portal=this.portal;return new t(a)})));return a},getItemsByKeywords:function(a,b){return this.portal.queryItems({start:b||1,num:100,q:"owner:"+this.username+' AND typekeywords:"'+a+'"'})},getContent:function(){this.updateCredential();var a={url:b.getUserContentUrl(this.portalUrl,this.username),handleAs:"json",content:{f:"json"},callbackParamName:"callback"};
this.isValidCredential&&(a.content.token=this.credential.token);return d(a)},getTags:function(){this.updateCredential();var a={url:b.getUserTagsUrl(this.portalUrl,this.username),handleAs:"json",content:{f:"json"},callbackParamName:"callback"};this.isValidCredential()&&(a.content.token=this.credential.token);return d(a)},addItem:function(a,c){this.updateCredential();var g=new n;if(this.isValidCredential()){var f={f:"json",token:this.credential.token};a&&(f=e.mixin(f,a));d({url:b.getAddItemUrl(this.portalUrl,
this.username,c),handleAs:"json",callbackParamName:"callback",content:f},{usePost:!0}).then(e.hitch(this,function(a){g.resolve(a)}),e.hitch(this,function(a){console.error(a);g.reject(a)}))}else setTimeout(e.hitch(this,function(){g.reject("token is null.")}),0);return g},deleteItem:function(a){this.updateCredential();var c=new n;this.isValidCredential()?(a=b.getDeleteItemUrl(this.portalUrl,this.username,a),c=d({url:a,content:{token:this.credential.token,f:"json"},handleAs:"json"},{usePost:!0})):setTimeout(e.hitch(this,
function(){c.reject("token is null.")}),0);return c},getItemById:function(a,c){this.updateCredential();var g=new n;a={url:b.getUserItemsUrl(this.portalUrl,this.username,c)+"/"+a,handleAs:"json",content:{f:"json"},callbackParamName:"callback"};d(a).then(e.hitch(this,function(a){a.portalUrl=this.portalUrl;a.credential=this.credential;a.portal=this;a=new v(a);g.resolve(a)}),e.hitch(this,function(a){console.error(a);g.reject(a)}));return g},shareItem:function(a,c,g){this.updateCredential();var f=new n;
this.isValidCredential()?(c={url:b.shareItemUrl(this.portalUrl,this.username,c,g),handleAs:"json",callbackParamName:"callback",content:{f:"json",token:this.credential.token}},a&&(c.content=e.mixin(c.content,a)),d(c,{usePost:!0}).then(e.hitch(this,function(a){f.resolve(a)}),e.hitch(this,function(a){console.error(a);f.reject(a)}))):setTimeout(e.hitch(this,function(){f.reject("token is null.")}),0);return f},updateItem:function(a,c){this.updateCredential();var g=new n;this.isValidCredential()?this.portal.getItemById(a).then(e.hitch(this,
function(f){var m={f:"json",token:this.credential.token};c&&(m=e.mixin(m,c));d({url:b.getUpdateItemUrl(this.portalUrl,f.owner,a,f.ownerFolder),handleAs:"json",callbackParamName:"callback",timeout:1E5,content:m},{usePost:!0}).then(e.hitch(this,function(a){g.resolve(a)}),e.hitch(this,function(a){console.error(a);g.reject(a)}))}),e.hitch(this,function(a){console.error(a);g.reject(a)})):setTimeout(e.hitch(this,function(){g.reject("token is null.")}),0);return g},isAdminRole:function(){return"org_admin"===
this.role||"account_admin"===this.role},isPublisherRole:function(){return"org_publisher"===this.role||"account_publisher"===this.role},isUserRole:function(){return"org_user"===this.role||"account_user"===this.role},getRegisteredAppInfo:function(a,c){var g=new n;this.updateCredential();c=b.getUserItemsUrl(this.portalUrl,this.username,c);return g=d({url:c+"/"+a+"/registeredAppInfo",content:{token:this.credential.token,f:"json"},handleAs:"json"},{usePost:!0})},getRegisteredAppInfoWithXhr:function(a,
c){var d=new n;this.updateCredential();c=b.getUserItemsUrl(this.portalUrl,this.username,c);return d=f(c+"/"+a+"/registeredAppInfo",{data:{token:this.credential.token,f:"json"},method:"POST",handleAs:"json"})}}),t=k([],{declaredClass:"jimu.PortalGroup",portalUrl:null,credential:null,portal:null,constructor:function(a){a&&e.mixin(this,a)},_checkCredential:function(){var a=g.isValidCredential(this.credential);a||(this.credential=null);return a},isValidCredential:function(){this.updateCredential();return this._checkCredential()},
updateCredential:function(){this._checkCredential()||(this.portal.updateCredential(),this.credential=this.portal.credential)},queryItems:function(a){a.q="group:"+this.id+" AND "+a.q;return this.portal.queryItems(a)}}),v=k([],{declaredClass:"jimu.PortalItem",itemUrl:null,detailsPageUrl:null,ownerPageUrl:null,portalUrl:null,credential:null,portal:null,token:null,constructor:function(a){a&&e.mixin(this,a);this.itemUrl=b.getItemUrl(this.portalUrl,this.id);!this.thumbnailUrl&&this.thumbnail&&this.itemUrl&&
(this.thumbnailUrl=this.itemUrl+"/info/"+this.thumbnail);this.token=this.credential&&this.credential.token;this.thumbnailUrl&&this.token&&(this.thumbnailUrl+="?token\x3d"+this.token);this.portalUrl&&this.id&&(this.detailsPageUrl=b.getItemDetailsPageUrl(this.portalUrl,this.id));this.portalUrl&&this.owner&&(this.ownerPageUrl=b.getUserProfilePageUrl(this.portalUrl,this.owner))},_checkCredential:function(){var a=g.isValidCredential(this.credential);a||(this.credential=null);return a},isValidCredential:function(){this.updateCredential();
return this._checkCredential()},updateCredential:function(){this._checkCredential()||(this.portal.updateCredential(),this.credential=this.portal.credential)},getItemData:function(){return this.portal.getItemData(this.id)},getItemGroups:function(){this.updateCredential();var a={url:b.getItemGroupsUrl(this.portalUrl,this.id),handleAs:"json",content:{f:"json"},callbackParamName:"callback"};this.isValidCredential()&&(a.content.token=this.credential.token);return d(a)}}),y={portals:[],webMapQueryStr:" "+
a.getItemQueryStringByTypes(["Web Map"])+" ",webSceneQueryStr:" "+a.getItemQueryStringByTypes(["Web Scene"])+" ",_findPortal:function(a){for(var c=0;c<this.portals.length;c++){var d=this.portals[c];if(b.isSamePortalUrl(a,d.portalUrl))return d.updateCredential(),d}return null},getPortal:function(a){if(!a||"string"!==typeof a||!e.trim(a))return null;a=b.getStandardPortalUrl(a);var c=this._findPortal(a);c||(c=new m(a),c.credential=g.getPortalCredential(c.portalUrl),c.updateCredential(),this.portals.push(c));
return c},getPortalSelfInfo:function(a){return this.getPortal(a).loadSelfInfo()},getBasemapGalleryGroup:function(a){return this._getPortalSelfGroup(a,"basemapGalleryGroupQuery")},getTemplatesGroup:function(a){return this._getPortalSelfGroup(a,"templatesGroupQuery")},getUnits:function(a){var b="english",c="",d=new n;this.getPortal(a).getUser().then(e.hitch(this,function(a){a&&a.units?b=a.units:(c=q.locale,b=c.startWith("en")?"english":"metric");d.resolve(b)}),e.hitch(this,function(g){console.warn(g);
this.getPortalSelfInfo(a).then(e.hitch(this,function(a){var b=null;a&&a.units?b=a.units:(c=a&&a.culture||q.locale,b=c.startWith("en")?"english":"metric");d.resolve(b)}),e.hitch(this,function(a){console.warn(a);c=q.locale;b=c.startWith("en")?"english":"metric";d.resolve(b)}))}));return d.promise},_getPortalSelfGroup:function(a,b){var c=new n,d=this.getPortal(a);d||setTimeout(e.hitch(this,function(){c.reject()}),0);this.getPortalSelfInfo(a).then(e.hitch(this,function(a){d.queryGroups({f:"json",q:a[b]}).then(e.hitch(this,
function(a){0<a.results.length?(a=a.results[0],a.portalUrl=d.portalUrl,a.credential=d.credential,a.portal=d,a=new t(a),c.resolve(a)):c.reject("Can't find portal self group.")}),e.hitch(this,function(a){console.error(a);c.reject(a)}))}),e.hitch(this,function(a){console.error(a);c.reject(a)}));return c},getWebMapsFromBasemapGalleryGroup:function(a){var b=new n;this.getBasemapGalleryGroup(a).then(e.hitch(this,function(a){a?a.queryItems({start:1,num:100,f:"json",q:this.webMapQueryStr}).then(e.hitch(this,
function(a){b.resolve(a)}),e.hitch(this,function(a){console.error(a);b.reject(a)})):b.reject()}),e.hitch(this,function(a){console.error(a);b.reject(a)}));return b},getDefaultWebScene:function(a){var c=b.getStandardPortalUrl(a);return this._searchWABDefaultWebScene(c).then(e.hitch(this,function(a){return a?a:this._createWABDefaultWebScene(c).then(e.hitch(this,function(a){return this.getPortal(c).getUser().then(e.hitch(this,function(b){var c=!1;b&&b.privileges&&0<b.privileges.length&&(c=p.some(b.privileges,
function(a){return 0<=a.indexOf("shareToPublic")}));return c?b.shareItem({everyone:!0},a).then(e.hitch(this,function(){return a}),e.hitch(this,function(){return a})):a}),e.hitch(this,function(b){console.error(b);return a}))}))}))},_searchWABDefaultWebScene:function(a){var c=new n;a=b.getStandardPortalUrl(a);a=this.getPortal(a);a.queryItems({q:'typekeywords:"WABDefaultWebScene" orgid:'+a.user.orgId+" access:public "+this.webSceneQueryStr}).then(e.hitch(this,function(a){a&&a.results&&0<a.results.length?
c.resolve(a.results[0].id):c.resolve(null)}),e.hitch(this,function(a){console.error("_searchWABDefaultWebScene error:",a);c.reject(a)}));return c},_createWABDefaultWebScene:function(a){var c=new n;a=b.getStandardPortalUrl(a);this.getPortal(a).getUser().then(e.hitch(this,function(a){var b={title:"Default Web Scene",type:"Web Scene",typeKeywords:"WABDefaultWebScene",tags:"default",text:h.stringify({operationalLayers:[],baseMap:{id:"151b431fe65-basemap-0",title:"Topographic",baseMapLayers:[{id:"defaultBasemap",
url:"http://services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer",layerType:"ArcGISTiledMapServiceLayer"}],elevationLayers:[{id:"globalElevation",url:"http://elevation3d.arcgis.com/arcgis/rest/services/WorldElevation3D/Terrain3D/ImageServer",layerType:"ArcGISTiledElevationServiceLayer"}]},version:"1.3",authoringApp:"WebSceneViewer",authoringAppVersion:"3.10.0.0",spatialReference:{wkid:102100,latestWkid:3857},viewingMode:"global",initialState:{viewpoint:{scale:4.5188197847224146E7,
rotation:0,targetGeometry:{x:144770.99872895706,y:3232837.215000455,spatialReference:{wkid:102100,latestWkid:3857},z:-127.7412482528016},camera:{position:{x:144770.99767624016,y:3182557.105058348,spatialReference:{wkid:102100,latestWkid:3857},z:2.551254800000001E7},heading:0,tilt:.0999986601088944}},environment:{lighting:{datetime:1426420488E3,displayUTCOffset:0}}},presentation:{slides:[]}}),snippet:""};a.addItem(b,"").then(e.hitch(this,function(a){a.success?c.resolve(a.id):(console.error("Can't create default web scene:",
a),c.reject())}))}),e.hitch(this,function(a){console.error("Can't create default web scene");c.reject(a)}));return c},getDefaultWebMap:function(a){var b=new n;this.getPortalSelfInfo(a).then(e.hitch(this,function(c){var d=c.defaultBasemap&&c.defaultBasemap.id;d?b.resolve(d):this._getDefaultWebMapByBasemapGallery(a,c).then(e.hitch(this,function(c){c?b.resolve(c):this._getMostNumViewsWebMap(a).then(e.hitch(this,function(a){a?b.resolve(a):b.reject()}),e.hitch(this,function(a){console.error(a);b.reject(a)}))}),
e.hitch(this,function(a){console.error(a);b.reject(a)}))}),e.hitch(this,function(a){console.error(a);b.reject(a)}));return b},_getDefaultWebMapByBasemapGallery:function(a,b){var c=new n,d=this.getPortal(a),g=b.defaultBasemap&&b.defaultBasemap.title;d.queryGroups({f:"json",q:b.basemapGalleryGroupQuery}).then(e.hitch(this,function(a){a=a.results;0<a.length?d.queryItems({start:1,num:1,f:"json",q:this.webMapQueryStr+" AND group:"+a[0].id+" AND title:"+g}).then(e.hitch(this,function(a){a=a.results;a=p.filter(a,
e.hitch(this,function(a){return a.type&&"web map"===a.type.toLowerCase()}));0<a.length?c.resolve(a[0].id):(console.log("Can't find web map under basemapGalleryGroupQuery."),d.queryItems({start:1,num:1,f:"json",q:this.webMapQueryStr+" AND title:"+g}).then(e.hitch(this,function(a){a=a.results;a=p.filter(a,e.hitch(this,function(a){return a.type&&"web map"===a.type.toLowerCase()}));if(0<a.length){var b=a[0];d.getItemData(b.id).then(e.hitch(this,function(a){a&&(a.operationalLayers||a.baseMap||a.version)?
c.resolve(b.id):c.resolve(null)}),e.hitch(this,function(){c.resolve(null)}))}else console.log("Can't find web map by defaultBasemap.title."),c.resolve(null)}),e.hitch(this,function(a){console.error(a);c.reject(a)})))}),e.hitch(this,function(a){console.error(a);c.reject(a)})):(console.log("Can't find group by basemapGalleryGroupQuery."),c.resolve(null))}),e.hitch(this,function(a){console.error(a);c.reject(a)}));return c},_getMostNumViewsWebMap:function(a){var b=new n;this.getPortal(a).queryItems({start:1,
num:1,f:"json",q:this.webMapQueryStr+" AND access:public AND owner:esri_en",sortField:"numViews",sortOrder:"desc"}).then(e.hitch(this,function(a){a=a.results;a=p.filter(a,e.hitch(this,function(a){return a.type&&"web map"===a.type.toLowerCase()}));0<a.length?b.resolve(a[0].id):b.reject("Can't find most-num-views web map.")}),e.hitch(this,function(a){console.error(a);b.reject(a)}));return b},comparePortalVersion:function(a,b){var c=a.split(".");a=parseInt(c[0],10);var c=1<c.length?parseInt(c[1],10):
0,d=b.split(".");b=parseInt(d[0],10);d=1<d.length?parseInt(d[1],10):0;return a>b?1:a<b?-1:c>d?1:c<d?-1:0},getItemResources:function(a,c,g){g||(g=100);a=b.getStandardPortalUrl(a);a=b.getItemResourceUrl(a,c);return d({url:a,content:{f:"json",num:g}}).then(function(a){if(a&&a.resources)return a.resources})},addResource:function(a,c,g,f,m){a=b.getStandardPortalUrl(a);var h=this.getPortal(a),e=new FormData;e.append("file",g,f);e.append("fileName",f);e.append("f","json");var l="";m?(e.append("resourcesPrefix",
m),l=m+"/"+f):l=f;return h.getItemById(c,!0).then(function(g){g=b.getUserContentItemUrl(a,g.owner,c);return d({url:g+"/addResources",form:e}).then(function(c){var d="";c&&c.success&&(d=b.getItemResourceUrl(a,"${itemId}",l));return d},function(a){console.error(a.message||a);return a})})},removeResources:function(a,c,g,f){var m={resource:f?f+"/"+g:g,f:"json"};a=b.getStandardPortalUrl(a);return this.getPortal(a).getItemById(c,!0).then(function(g){g=b.getUserContentItemUrl(a,g.owner,c);return d({url:g+
"/removeResources",content:m},{usePost:!0}).then(function(a){return a},function(a){console.error(a.message||a);return a})})}};l.subscribe("userSignOut",function(a){(a=y._findPortal(a))&&a.clearCredentialAndUser()});return y})},"jimu/Role":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/_base/array","dojo/json","esri/lang"],function(k,e,p,q,n){return k(null,{id:null,baseRole:null,name:null,description:null,privileges:[],privilegeObj:null,constructor:function(e){e=e||{};this.id=e.id;
this.baseRole=e.role;this.name=e.name;this.description=e.description},_initPrivilegesObject:function(){this.privilegeObj={portal:{admin:{inviteUsers:!1,disableUsers:!1,viewUsers:!1,updateUsers:!1,deleteUsers:!1,changeUserRoles:!1,viewGroups:!1,updateGroups:!1,deleteGroups:!1,reassignGroups:!1,assignToGroups:!1,manageEnterpriseGroups:!1,viewItems:!1,updateItems:!1,deleteItems:!1,reassignItems:!1,manageLicenses:!1},publisher:{publishFeatures:!1,publishTiles:!1,publishScenes:!1},user:{createGroup:!1,
joinGroup:!1,joinNonOrgGroup:!1,createItem:!1,shareToGroup:!1,shareToOrg:!1,shareToPublic:!1,shareGroupToOrg:!1,shareGroupToPublic:!1}},features:{user:{edit:!1,fullEdit:!1}},opendata:{user:{openDataAdmin:!1,designateGroup:!1}},premium:{user:{geocode:!1,networkanalysis:!1,spatialanalysis:!1,geoenrichment:!1,demographics:!1,elevation:!1}},marketplace:{admin:{manage:!1,purchase:!1,startTrial:!1}}}},_readPrivileges:function(l){n.isDefined(l)&&l instanceof Array&&p.forEach(l,e.hitch(this,function(h){this._readPrivilege(h)}))},
_readPrivilege:function(e){this._applyEffectToAction(!0,e)},_applyEffectToAction:function(e,h){switch(h){case "portal:admin:inviteUsers":this.privilegeObj.portal.admin.inviteUsers=e;break;case "portal:admin:disableUsers":this.privilegeObj.portal.admin.disableUsers=e;break;case "portal:admin:viewUsers":this.privilegeObj.portal.admin.viewUsers=e;break;case "portal:admin:updateUsers":this.privilegeObj.portal.admin.updateUsers=e;break;case "portal:admin:deleteUsers":this.privilegeObj.portal.admin.deleteUsers=
e;break;case "portal:admin:changeUserRoles":this.privilegeObj.portal.admin.changeUserRoles=e;break;case "portal:admin:viewGroups":this.privilegeObj.portal.admin.viewGroups=e;break;case "portal:admin:updateGroups":this.privilegeObj.portal.admin.updateGroups=e;break;case "portal:admin:deleteGroups":this.privilegeObj.portal.admin.deleteGroups=e;break;case "portal:admin:reassignGroups":this.privilegeObj.portal.admin.reassignGroups=e;break;case "portal:admin:assignToGroups":this.privilegeObj.portal.admin.assignToGroups=
e;break;case "portal:admin:manageEnterpriseGroups":this.privilegeObj.portal.admin.manageEnterpriseGroups=e;break;case "portal:admin:viewItems":this.privilegeObj.portal.admin.viewItems=e;break;case "portal:admin:updateItems":this.privilegeObj.portal.admin.updateItems=e;break;case "portal:admin:deleteItems":this.privilegeObj.portal.admin.deleteItems=e;break;case "portal:admin:reassignItems":this.privilegeObj.portal.admin.reassignItems=e;break;case "portal:admin:manageLicenses":this.privilegeObj.portal.admin.manageLicenses=
e;break;case "portal:publisher:publishFeatures":this.privilegeObj.portal.publisher.publishFeatures=e;break;case "portal:publisher:publishTiles":this.privilegeObj.portal.publisher.publishTiles=e;break;case "portal:publisher:publishScenes":this.privilegeObj.portal.publisher.publishScenes=e;break;case "portal:user:createGroup":this.privilegeObj.portal.user.createGroup=e;break;case "portal:user:joinGroup":this.privilegeObj.portal.user.joinGroup=e;break;case "portal:user:joinNonOrgGroup":this.privilegeObj.portal.user.joinNonOrgGroup=
e;break;case "portal:user:createItem":this.privilegeObj.portal.user.createItem=e;break;case "portal:user:shareToGroup":this.privilegeObj.portal.user.shareToGroup=e;break;case "portal:user:shareToOrg":this.privilegeObj.portal.user.shareToOrg=e;break;case "portal:user:shareToPublic":this.privilegeObj.portal.user.shareToPublic=e;break;case "portal:user:shareGroupToOrg":this.privilegeObj.portal.user.shareGroupToOrg=e;break;case "portal:user:shareGroupToPublic":this.privilegeObj.portal.user.shareGroupToPublic=
e;break;case "features:user:edit":this.privilegeObj.features.user.edit=e;break;case "features:user:fullEdit":this.privilegeObj.features.user.fullEdit=e;break;case "opendata:user:openDataAdmin":this.privilegeObj.opendata.user.openDataAdmin=e;break;case "opendata:user:designateGroup":this.privilegeObj.opendata.user.designateGroup=e;break;case "premium:user:geocode":this.privilegeObj.premium.user.geocode=e;break;case "premium:user:networkanalysis":this.privilegeObj.premium.user.networkanalysis=e;break;
case "premium:user:spatialanalysis":this.privilegeObj.premium.user.spatialanalysis=e;break;case "premium:user:geoenrichment":this.privilegeObj.premium.user.geoenrichment=e;break;case "premium:user:demographics":this.privilegeObj.premium.user.demographics=e;break;case "premium:user:elevation":this.privilegeObj.premium.user.elevation=e;break;case "marketplace:admin:purchase":this.privilegeObj.marketplace.admin.purchase=e;break;case "marketplace:admin:manage":this.privilegeObj.marketplace.admin.manage=
e;break;case "marketplace:admin:startTrial":this.privilegeObj.marketplace.admin.startTrial=e}},_applyToAll:function(e){this.privilegeObj.portal.admin.inviteUsers=e;this.privilegeObj.portal.admin.disableUsers=e;this.privilegeObj.portal.admin.viewUsers=e;this.privilegeObj.portal.admin.updateUsers=e;this.privilegeObj.portal.admin.deleteUsers=e;this.privilegeObj.portal.admin.changeUserRoles=e;this.privilegeObj.portal.admin.viewGroups=e;this.privilegeObj.portal.admin.updateGroups=e;this.privilegeObj.portal.admin.deleteGroups=
e;this.privilegeObj.portal.admin.reassignGroups=e;this.privilegeObj.portal.admin.assignToGroups=e;this.privilegeObj.portal.admin.manageEnterpriseGroups=e;this.privilegeObj.portal.admin.viewItems=e;this.privilegeObj.portal.admin.updateItems=e;this.privilegeObj.portal.admin.deleteItems=e;this.privilegeObj.portal.admin.reassignItems=e;this.privilegeObj.portal.admin.manageLicenses=e;this.privilegeObj.portal.publisher.publishFeatures=e;this.privilegeObj.portal.publisher.publishTiles=e;this.privilegeObj.portal.publisher.publishScenes=
e;this.privilegeObj.portal.user.createGroup=e;this.privilegeObj.portal.user.joinGroup=e;this.privilegeObj.portal.user.joinNonOrgGroup=e;this.privilegeObj.portal.user.createItem=e;this.privilegeObj.portal.user.shareToGroup=e;this.privilegeObj.portal.user.shareToOrg=e;this.privilegeObj.portal.user.shareToPublic=e;this.privilegeObj.portal.user.shareGroupToOrg=e;this.privilegeObj.portal.user.shareGroupToPublic=e;this.privilegeObj.features.user.edit=e;this.privilegeObj.opendata.user.openDataAdmin=e;this.privilegeObj.opendata.user.designateGroup=
e;this.privilegeObj.premium.user.geocode=e;this.privilegeObj.premium.user.networkanalysis=e;this.privilegeObj.premium.user.spatialanalysis=e;this.privilegeObj.premium.user.geoenrichment=e;this.privilegeObj.premium.user.demographics=e;this.privilegeObj.premium.user.elevation=e;this.privilegeObj.marketplace.admin.purchase=e;this.privilegeObj.marketplace.admin.manage=e;this.privilegeObj.marketplace.admin.startTrial=e},_buildPrivilegesArray:function(){var e=[];!0===this.privilegeObj.portal.admin.inviteUsers&&
e.push("portal:admin:inviteUsers");!0===this.privilegeObj.portal.admin.disableUsers&&e.push("portal:admin:disableUsers");!0===this.privilegeObj.portal.admin.viewUsers&&e.push("portal:admin:viewUsers");!0===this.privilegeObj.portal.admin.updateUsers&&e.push("portal:admin:updateUsers");!0===this.privilegeObj.portal.admin.deleteUsers&&e.push("portal:admin:deleteUsers");!0===this.privilegeObj.portal.admin.changeUserRoles&&e.push("portal:admin:changeUserRoles");!0===this.privilegeObj.portal.admin.viewGroups&&
e.push("portal:admin:viewGroups");!0===this.privilegeObj.portal.admin.updateGroups&&e.push("portal:admin:updateGroups");!0===this.privilegeObj.portal.admin.deleteGroups&&e.push("portal:admin:deleteGroups");!0===this.privilegeObj.portal.admin.reassignGroups&&e.push("portal:admin:reassignGroups");!0===this.privilegeObj.portal.admin.assignToGroups&&e.push("portal:admin:assignToGroups");!0===this.privilegeObj.portal.admin.manageEnterpriseGroups&&e.push("portal:admin:manageEnterpriseGroups");!0===this.privilegeObj.portal.admin.viewItems&&
e.push("portal:admin:viewItems");!0===this.privilegeObj.portal.admin.updateItems&&e.push("portal:admin:updateItems");!0===this.privilegeObj.portal.admin.deleteItems&&e.push("portal:admin:deleteItems");!0===this.privilegeObj.portal.admin.reassignItems&&e.push("portal:admin:reassignItems");!0===this.privilegeObj.portal.admin.manageLicenses&&e.push("portal:admin:manageLicenses");!0===this.privilegeObj.portal.publisher.publishFeatures&&e.push("portal:publisher:publishFeatures");!0===this.privilegeObj.portal.publisher.publishTiles&&
e.push("portal:publisher:publishTiles");!0===this.privilegeObj.portal.publisher.publishScenes&&e.push("portal:publisher:publishScenes");!0===this.privilegeObj.portal.user.createGroup&&e.push("portal:user:createGroup");!0===this.privilegeObj.portal.user.joinGroup&&e.push("portal:user:joinGroup");!0===this.privilegeObj.portal.user.joinNonOrgGroup&&e.push("portal:user:joinNonOrgGroup");!0===this.privilegeObj.portal.user.createItem&&e.push("portal:user:createItem");!0===this.privilegeObj.portal.user.shareToGroup&&
e.push("portal:user:shareToGroup");!0===this.privilegeObj.portal.user.shareToOrg&&e.push("portal:user:shareToOrg");!0===this.privilegeObj.portal.user.shareToPublic&&e.push("portal:user:shareToPublic");!0===this.privilegeObj.portal.user.shareGroupToOrg&&e.push("portal:user:shareGroupToOrg");!0===this.privilegeObj.portal.user.shareGroupToPublic&&e.push("portal:user:shareGroupToPublic");!0===this.privilegeObj.features.user.edit&&e.push("features:user:edit");!0===this.privilegeObj.features.user.fullEdit&&
e.push("features:user:fullEdit");!0===this.privilegeObj.opendata.user.openDataAdmin&&e.push("opendata:user:openDataAdmin");!0===this.privilegeObj.opendata.user.designateGroup&&e.push("opendata:user:designateGroup");!0===this.privilegeObj.premium.user.geocode&&e.push("premium:user:geocode");!0===this.privilegeObj.premium.user.networkanalysis&&e.push("premium:user:networkanalysis");!0===this.privilegeObj.premium.user.spatialanalysis&&e.push("premium:user:spatialanalysis");!0===this.privilegeObj.premium.user.geoenrichment&&
e.push("premium:user:geoenrichment");!0===this.privilegeObj.premium.user.demographics&&e.push("premium:user:demographics");!0===this.privilegeObj.premium.user.elevation&&e.push("premium:user:elevation");!0===this.privilegeObj.marketplace.admin.purchase&&e.push("marketplace:admin:purchase");!0===this.privilegeObj.marketplace.admin.manage&&e.push("marketplace:admin:manage");!0===this.privilegeObj.marketplace.admin.startTrial&&e.push("marketplace:admin:startTrial");return e},isUser:function(){return n.isDefined(this.id)&&
("org_user"===this.id||"account_user"===this.id)},isPublisher:function(){return n.isDefined(this.id)&&("org_publisher"===this.id||"account_publisher"===this.id)},isAdmin:function(){return n.isDefined(this.id)&&("org_admin"===this.id||"account_admin"===this.id)},isBasedOnUser:function(){return this.isUser()||n.isDefined(this.baseRole)&&("org_user"===this.baseRole||"account_user"===this.baseRole)},isBasedOnPublisher:function(){return this.isPublisher()||n.isDefined(this.baseRole)&&("org_publisher"===
this.baseRole||"account_publisher"===this.baseRole)},isBasedOnAdmin:function(){return this.isAdmin()||n.isDefined(this.baseRole)&&("org_admin"===this.baseRole||"account_admin"===this.baseRole)},isCustom:function(){return!this.isUser()&&!this.isPublisher()&&!this.isAdmin()&&n.isDefined(this.id)&&0<this.id.length},canInviteUsers:function(){return this.privilegeObj&&this.privilegeObj.portal.admin.inviteUsers},canDisableUsers:function(){return this.privilegeObj&&this.privilegeObj.portal.admin.disableUsers},
canViewUsers:function(){return this.privilegeObj&&this.privilegeObj.portal.admin.viewUsers},canUpdateUsers:function(){return this.privilegeObj&&this.privilegeObj.portal.admin.updateUsers},canDeleteUsers:function(){return this.privilegeObj&&this.privilegeObj.portal.admin.deleteUsers},canChangeUserRoles:function(){return this.privilegeObj&&this.privilegeObj.portal.admin.changeUserRoles},canViewOrgGroups:function(){return this.privilegeObj&&this.privilegeObj.portal.admin.viewGroups},canUpdateOrgGroups:function(){return this.privilegeObj&&
this.privilegeObj.portal.admin.updateGroups},canDeleteOrgGroups:function(){return this.privilegeObj&&this.privilegeObj.portal.admin.deleteGroups},canReassignOrgGroups:function(){return this.privilegeObj&&this.privilegeObj.portal.admin.reassignGroups},canAssignUsersToOrgGroups:function(){return this.privilegeObj&&this.privilegeObj.portal.admin.assignToGroups},canManageEnterpriseGroups:function(){return this.privilegeObj&&this.privilegeObj.portal.admin.manageEnterpriseGroups},canViewOrgItems:function(){return this.privilegeObj&&
this.privilegeObj.portal.admin.viewItems},canUpdateOrgItems:function(){return this.privilegeObj&&this.privilegeObj.portal.admin.updateItems},canDeleteOrgItems:function(){return this.privilegeObj&&this.privilegeObj.portal.admin.deleteItems},canReassignOrgItems:function(){return this.privilegeObj&&this.privilegeObj.portal.admin.reassignItems},canManageLicenses:function(){return this.privilegeObj&&this.privilegeObj.portal.admin.manageLicenses},canCreateGroup:function(){return this.privilegeObj&&this.privilegeObj.portal.user.createGroup},
canJoinOrgGroup:function(){return this.privilegeObj&&this.privilegeObj.portal.user.joinGroup},canJoinNonOrgGroup:function(){return this.privilegeObj&&this.privilegeObj.portal.user.joinNonOrgGroup},canPublishFeatures:function(){return this.privilegeObj&&this.privilegeObj.portal.publisher.publishFeatures},canPublishTiles:function(){return this.privilegeObj&&this.privilegeObj.portal.publisher.publishTiles},canPublishScenes:function(){return this.privilegeObj&&this.privilegeObj.portal.publisher.publishScenes},
canCreateItem:function(){return this.privilegeObj&&this.privilegeObj.portal.user.createItem},canShareItemToGroup:function(){return this.privilegeObj&&this.privilegeObj.portal.user.shareToGroup},canShareItemToOrg:function(){return this.privilegeObj&&this.privilegeObj.portal.user.shareToOrg},canShareItemToPublic:function(){return this.privilegeObj&&this.privilegeObj.portal.user.shareToPublic},canShareGroupToOrg:function(){return this.privilegeObj&&this.privilegeObj.portal.user.shareGroupToOrg},canShareGroupToPublic:function(){return this.privilegeObj&&
this.privilegeObj.portal.user.shareGroupToPublic},canEditFeatures:function(){return this.privilegeObj&&this.privilegeObj.features.user.edit},canEditFeaturesFullControl:function(){return this.privilegeObj&&this.privilegeObj.features.user.fullEdit},canManageOpenData:function(){return this.privilegeObj&&this.privilegeObj.opendata.user.openDataAdmin},canDesignateOpenDataGroups:function(){return this.privilegeObj&&this.privilegeObj.opendata.user.designateGroup},canUseGeocode:function(){return this.privilegeObj&&
this.privilegeObj.premium.user.geocode},canUseNetworkAnalysis:function(){return this.privilegeObj&&this.privilegeObj.premium.user.networkanalysis},canUseSpatialAnalysis:function(){return this.privilegeObj&&this.privilegeObj.premium.user.spatialanalysis},canUseGeoenrichment:function(){return this.privilegeObj&&this.privilegeObj.premium.user.geoenrichment},canUseDemographics:function(){return this.privilegeObj&&this.privilegeObj.premium.user.demographics},canUseElevation:function(){return this.privilegeObj&&
this.privilegeObj.premium.user.elevation},canPurchaseMarketplace:function(){return this.privilegeObj&&this.privilegeObj.marketplace.admin.purchase},canManageMarketplace:function(){return this.privilegeObj&&this.privilegeObj.marketplace.admin.manage},canTrialMarketplace:function(){return this.privilegeObj&&this.privilegeObj.marketplace.admin.startTrial},setPrivileges:function(e){this.privileges=e;this._initPrivilegesObject();n.isDefined(e)&&this._readPrivileges(e)},stringify:function(){return q.stringify({id:this.id,
name:this.name,description:this.description,privileges:this._buildPrivilegesArray()})},stringifyRole:function(){return q.stringify({id:this.id,name:this.name,description:this.description})},stringifyPrivileges:function(){return q.stringify({privileges:this._buildPrivilegesArray()})},stringifyPretty:function(){return q.stringify({id:this.id,name:this.name,description:this.description,privileges:this._buildPrivilegesArray()},null,"  ")}})})},"jimu/tokenUtils":function(){define("dojo/_base/lang dojo/_base/array dojo/aspect dojo/Deferred dojo/cookie dojo/json dojo/topic dojo/request/script esri/kernel esri/config esri/request esri/urlUtils esri/IdentityManager esri/arcgis/OAuthInfo jimu/portalUrlUtils jimu/utils esri/layers/vectorTiles/kernel".split(" "),
function(k,e,p,q,n,l,h,f,d,c,a,b,g,u,m,r,t){"function"!==typeof n.getAll&&(n.getAll=function(a){var b=[];(a=n(a))&&b.push(a);return b});g={portalUrl:null,cookiePath:"/",_started:!1,webTierPortalUrls:[],isInBuilderWindow:function(){return!!window.isBuilder},isInConfigOrPreviewWindow:function(){return r.isInConfigOrPreviewWindow()},isStringStartWith:function(a,b){return a.substr(0,b.length)===b},getCookiePath:function(){return this.cookiePath},setPortalUrl:function(a){(a=m.getStandardPortalUrl(a))&&
(a+="/");this.portalUrl=a},getPortalUrl:function(){return this.portalUrl},isWebTierPortal:function(a){var g=new q,e=m.getStandardPortalUrl(a);a=e+"/sharing";var h=m.setHttpsProtocol(e+"/sharing/generateToken?f\x3djson"),l=m.setHttpsProtocol(a);f.get(h,{jsonp:"callback"}).then(k.hitch(this,function(a){a.token?(this.webTierPortalUrls.push(e),this.removeWabAuthCookie(),d.id.getCredential(l).then(k.hitch(this,function(d){function l(a){var b=a.creationTime||(new Date).getTime(),c=a.expires;0<b&&0<c&&c>
b&&setTimeout(function(){f.get(h,{jsonp:"callback"}).then(function(b){b.token&&(a.token=b.token,a.expires=b.expires,a.creationTime=(new Date).getTime(),a.refreshServerTokens(),l(a))},function(a){console.error(a)})},.8*(c-b))}d.token||(d.token=a.token);d.expires||(d.expires=a.expires);var r=b.canUseXhr(d.server,!0);-1<r&&c.defaults.io.corsEnabledServers.splice(r,1);this._pushCorsEnabledServerInfo({host:m.getServerByUrl(e),withCredentials:!0});g.resolve(!0);l(d)}),k.hitch(this,function(){g.resolve(!0)}))):
g.resolve(!1)}),k.hitch(this,function(a){console.error(a);g.reject(a)}));return g},addAuthorizedCrossOriginDomains:function(a){if(a&&0<a.length)for(var b=0;b<a.length;b++)this.addWithCredentialDomain(a[b])},addWithCredentialDomain:function(a){if(a&&"string"===typeof a){var d=c.defaults.io.corsEnabledServers,g=m.getServerByUrl(a);(a=m.getServerWithProtocol(a))||(a="http://"+g);a=b.canUseXhr(a,!0);-1<a&&d.splice(a,1);this._pushCorsEnabledServerInfo({host:g,withCredentials:!0})}},_pushCorsEnabledServerInfo:function(a){if(a){var b=
c.defaults.io.corsEnabledServers,d="charAt charCodeAt concat endsWith indexOf lastIndexOf localeCompare match replace search slice split startsWith substr substring toLocaleLowerCase toLocaleUpperCase toLowerCase toString toUpperCase trim trimLeft trimRight valueOf".split(" ");if("object"===typeof a&&"string"===typeof a.host){for(var g in a.host)a[g]="function"===typeof a.host[g]?function(){return a.host[g].apply(a.host,arguments)}:a.host[g];a.length=a.host.length;e.forEach(d,function(b){"function"===
typeof a.host[b]&&(a[b]=function(){return a.host[b].apply(a.host,arguments)})})}b.push(a)}},tryRegisterCredential:function(a){return this.isValidCredential(a)?e.some(d.id.credentials,k.hitch(this,function(b){return a.token===b.token}))?!1:(d.id.credentials.push(a),!0):!1},registerToken:function(a){var b=m.getSharingUrl(this.portalUrl);d.id.findCredential(b)&&e.some(d.id.credentials,k.hitch(this,function(a,b){if(this.isValidPortalCredentialOfPortalUrl(this.portalUrl,a))return d.id.credentials.splice(b,
1),!0}));return this._getTokenInfo(a).then(function(a){a&&d.id.registerToken(a)})},_getTokenInfo:function(a){var b=m.getPortalSelfInfoUrl(this.portalUrl);return f.get(b+("?f\x3djson\x26token\x3d"+a),{jsonp:"callback"}).then(k.hitch(this,function(b){return b.user?{server:m.getSharingUrl(this.portalUrl),ssl:b.allSSL,token:a,userId:b.user.username}:null}),function(a){console.error(a);throw Error(window.jimuNls.urlParams.validateTokenError);})},_isInvalidPortalUrl:function(a){return a&&"string"===typeof a&&
k.trim(a)},signInPortal:function(a){var b=new q;if(this._isInvalidPortalUrl(a)){a=m.getStandardPortalUrl(a);var c=m.getSharingUrl(a),g=this.getPortalCredential(a);g?setTimeout(k.hitch(this,function(){b.resolve(g)}),0):b=d.id.getCredential(c)}else setTimeout(k.hitch(this,function(){b.reject("Invalid portalurl.")}),0);return b},_loadPortalSelfInfo:function(b){b=m.getPortalSelfInfoUrl(b);return a({url:b,handleAs:"json",content:{f:"json"},callbackParamName:"callback"})},registerOAuthInfo:function(a,b){if(!a||
"string"!==typeof a||!b||"string"!==typeof b)return null;var c=d.id.findOAuthInfo(a);c||(c=window.location.protocol+"//"+window.location.host+require.toUrl("jimu")+"/oauth-callback.html",c=new u({appId:b,expiration:20159,portalUrl:a,authNamespace:"/",popup:!0,popupCallbackUrl:c}),d.id.registerOAuthInfos([c]));c.appId=b;return c},signOutAll:function(){var a=m.getStandardPortalUrl(this.portalUrl),b=!!d.id.findCredential(a+"/sharing/rest");window.appInfo.isRunInPortal?this.removeEsriAuthCookieStorage():
this.removeWabAuthCookie();d.id.destroyCredentials();d.id._oAuthHash=null;b&&this._publishCurrentPortalUserSignOut(a)},userHaveSignInPortal:function(a){return!!this.getPortalCredential(k.trim(a||""))},isValidCredential:function(a){var b=!1;if(a){var b=a.token,c=a.server,d=a.scope,b=b&&"string"===typeof b&&k.trim(b),c=c&&"string"===typeof c&&k.trim(c),d="portal"===d||"server"===d,g=!0;a.expires&&(a=parseInt(a.expires,10),g=(new Date).getTime(),g=a>g);b=b&&c&&d&&g}return b},isValidPortalCredentialOfPortalUrl:function(a,
b){var c=!1;this.isValidCredential(b)&&(c="portal"===b.scope,a=m.isSameServer(a,b.server),c=c&&a);return c},getPortalCredential:function(a){var b=null;a=k.trim(a||"");if(!a)return null;a=m.getStandardPortalUrl(a);(b=this._filterPortalCredential(a,d.id.credentials))||this._tryConvertArcGIScomCrendentialToOrgCredential();return b},_tryConvertArcGIScomCrendentialToOrgCredential:function(){var a=this.portalUrl;if(a&&(a=m.getStandardPortalUrl(a),m.isOrgOnline(a)&&!this._filterPortalCredential(a,d.id.credentials))){var b=
this._filterPortalCredential("http://www.arcgis.com",d.id.credentials);b&&d.id.registerToken({token:b.token,scope:"portal",userId:b.userId,server:a+"/sharing/rest",expires:b.expires})}},saveAndRegisterCookieToCredential:function(a){a=k.clone(a);a.referer=window.location.host;a.scope="portal";a.isAdmin=!!a.isAdmin;this.saveWabCookie(a);var b=a.server+"/sharing/rest";a.server=b;d.id.registerToken(a);return d.id.findCredential(b,a.userId)},registerAuth2Hash:function(a){a=k.clone(a);var b=1E3*parseInt(a.expires_in,
10),b=(new Date).getTime()+b,c=m.getStandardPortalUrl(a.state.portalUrl);return this.saveAndRegisterCookieToCredential({referer:window.location.host,server:c,token:a.access_token,expires:b,userId:a.username,scope:"portal",isAdmin:!!a.isAdmin})},saveWabCookie:function(a){this.removeCookie("wab_auth");n("wab_auth",l.stringify(a),{expires:new Date(a.expires),path:"/"})},removeWabAuthCookie:function(){this.removeCookie("wab_auth")},removeEsriAuthCookieStorage:function(){this.removeCookie("esri_auth");
window.localStorage&&window.localStorage.removeItem("esriJSAPIOAuth");window.sessionStorage&&window.sessionStorage.removeItem("esriJSAPIOAuth")},_filterPortalCredential:function(a,b){var c=null;a=m.getStandardPortalUrl(a);b&&0<b.length&&(b=e.filter(b,k.hitch(this,function(b){return this.isValidPortalCredentialOfPortalUrl(a,b)})),0<b.length&&(c=b[b.length-1]));return c},_removePortalCredential:function(a){var b=k.trim(a||"");if(b){b=m.getStandardPortalUrl(b);for(a=e.filter(d.id.credentials,k.hitch(this,
function(a){return this.isValidPortalCredentialOfPortalUrl(b,a)}));0<a.length;)a[0].destroy(),a.splice(0,1);d.id.credentials=e.filter(d.id.credentials,k.hitch(this,function(a){return!this.isValidPortalCredentialOfPortalUrl(b,a)}))}},getUserIdByToken:function(b,c){var g=new q;if(b&&"string"===typeof b&&c&&"string"===typeof c){var f=m.getStandardPortalUrl(c);c=e.filter(d.id.credentials,k.hitch(this,function(a){var c=a.token===b&&a.userId;a=m.isSameServer(f,a.server);return c&&a}));if(0<c.length){var h=
c[0];setTimeout(k.hitch(this,function(){g.resolve(h.userId)}),0);return g}c=m.getCommunitySelfUrl(f);a({url:c,handleAs:"json",content:{f:"json"},callbackParamName:"callback"}).then(k.hitch(this,function(a){g.resolve(a&&a.username||"")}),k.hitch(this,function(a){console.error(a);g.reject("fail to get userId by token")}))}else setTimeout(k.hitch(this,function(){g.reject("invalid parameters")}),0);return g},xtGetCredentialFromCookie:function(a){var b=n("wab_auth"),c=null;if(b)try{c=l.parse(b)}catch(z){console.error(z)}if(!c||
"object"!==typeof c||!m.isSameServer(a,c.server)||window.location.host!==c.referer)return null;c.expires=parseInt(c.expires,10);b=(new Date).getTime();if(!(c.expires>b))return this.removeCookie("wab_auth"),null;a+="/sharing/rest";c.server=a;(b=d.id.findCredential(a))||d.id.registerToken(c);return b=d.id.findCredential(a)},removeCookie:function(a){var b=this.getCookiePath();r.removeCookie(a,b)},_getDomainsByServerName:function(a){var b=a.split("."),c=b.length;return e.map(b,k.hitch(this,function(a,
d){a=b.slice(d,c);var g="",f=a.length-1;e.forEach(a,k.hitch(this,function(a,b){g+=a;b!==f&&(g+=".")}));return g}))},_publishCurrentPortalUserSignIn:function(a){if(this.isValidCredential(a))try{h.publish("userSignIn",a)}catch(y){console.error(y)}},_publishAnyUserSignIn:function(a){if(this.isValidCredential(a))try{h.publish("anyUserSignIn",a)}catch(y){console.error(y)}},_publishCurrentPortalUserSignOut:function(a){try{h.publish("userSignOut",a)}catch(y){console.error(y)}},_signInSuccess:function(a){try{this.isValidPortalCredentialOfPortalUrl(this.portalUrl,
a)&&this._publishCurrentPortalUserSignIn(a),this._publishAnyUserSignIn(a)}catch(y){console.error(y)}},_bindEvents:function(){p.after(d.id,"signIn",k.hitch(this,function(a,b){console.log(b[1]);p.after(a,"callback",k.hitch(this,function(a,b){this._signInSuccess(b[0],!1)}));return a}))},isStart:function(){return this._started},startup:function(){if(!this._started){if(this.isInConfigOrPreviewWindow()){var a=window.parent;if(a){var b=a.esri&&a.esri.id;b._wab="builder";if(b){d.id=b;var c=window.esriConfig.defaults.io,
a=a.esriConfig.defaults.io;c.corsEnabledServers=a.corsEnabledServers;c.webTierAuthServers=a.webTierAuthServers;c._processedCorsServers=a._processedCorsServers;c.corsStatus=a.corsStatus;Object.defineProperty(t,"id",{get:function(){return b},enumerable:!0,configurable:!0})}}}this._bindEvents();this._started=!0}}};g.startup();return g})},"esri/IdentityManager":function(){define(["./IdentityManagerDialog","./kernel","./OAuthSignInHandler","dojo/_base/declare"],function(k,e,p,q){k=new k;e.id=q.safeMixin(k,
p);return e.id})},"esri/IdentityManagerDialog":function(){define("dojo/_base/kernel dojo/_base/declare dojo/_base/config dojo/_base/Deferred dojo/_base/lang dojo/has dojo/dom-attr dojo/keys dijit/registry dijit/Dialog ./kernel ./lang ./domUtils ./Credential ./IdentityManagerBase dojo/i18n!./nls/jsapi dojo/query dijit/form/Button dijit/form/Form dijit/form/ValidationTextBox".split(" "),function(k,e,p,q,n,l,h,f,d,c,a,b,g,u,m,r){return e([m],{declaredClass:"esri.IdentityManager",_eventMap:{"dialog-cancel":["info"]},
constructor:function(a){n.mixin(this,a);this.registerConnectEvents()},_dialogContent:"\x3cdiv data-dojo-type\x3d'dijit.form.Form' data-dojo-props\x3d'\"class\":\"esriIdForm\"'\x3e\x3cdiv class\x3d'dijitDialogPaneContentArea'\x3e\x3cdiv style\x3d'padding-bottom: 5px; word-wrap: break-word;'\x3e${info}\x3c/div\x3e\x3cdiv style\x3d'margin: 0px; padding: 0px; height: 10px;'\x3e\x3c/div\x3e\x3cdiv class\x3d'esriErrorMsg' style\x3d'display: none; color: white; background-color: #D46464; text-align: center; padding-top: 3px; padding-bottom: 3px;'\x3e${invalidUser}\x3c/div\x3e\x3cdiv style\x3d'margin: 0px; padding: 0px; height: 10px;'\x3e\x3c/div\x3e\x3ctable style\x3d'width: 100%;'\x3e\x3ctr\x3e\x3ctd\x3e\x3clabel\x3e${lblUser}\x3c/label\x3e\x3cbr/\x3e\x3cinput data-dojo-type\x3d'dijit.form.ValidationTextBox' data-dojo-props\x3d'type:\"text\", \"class\":\"esriIdUser\", required:true, trim:true, style:\"width: 100%;\", autocapitalize:\"none\", autocorrect:\"off\", spellcheck:false' /\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd\x3e\x3clabel\x3e${lblPwd}\x3c/label\x3e\x3cbr/\x3e\x3cinput data-dojo-type\x3d'dijit.form.ValidationTextBox' data-dojo-props\x3d'type:\"password\", \"class\":\"esriIdPwd\", required:true, style:\"width: 100%;\"' /\x3e\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e\x3c/div\x3e\x3cdiv class\x3d'dijitDialogPaneActionBar'\x3e\x3cbutton data-dojo-type\x3d'dijit.form.Button' data-dojo-props\x3d'type:\"button\", \"class\":\"esriIdSubmit\"'\x3e${lblOk}\x3c/button\x3e\x3cbutton data-dojo-type\x3d'dijit.form.Button' data-dojo-props\x3d'type:\"button\", \"class\":\"esriIdCancel\"'\x3e${lblCancel}\x3c/button\x3e\x3c/div\x3e\x3c/div\x3e",
onDialogCreate:function(){},onDialogCancel:function(){},signIn:function(a,b,c){this._nls||(this._nls=r.identity);this._loginDialog||(this._loginDialog=this.dialog=this._createLoginDialog(),this.onDialogCreate());var d=this._loginDialog,f=c&&c.error,m=c&&c.token,e=new q(function(){d.onCancel()});if(d.open)return a=Error("BUSY"),a.code="IdentityManager.1",a.log=!!p.isDebug,e.errback(a),e;g.hide(d.errMsg_);f&&403==f.code&&m&&(h.set(d.errMsg_,"innerHTML",this._nls.forbidden),g.show(d.errMsg_));d.dfd_=
e;d.serverInfo_=b;d.resUrl_=a;d.admin_=c&&c.isAdmin;h.set(d.resLink_,{title:a,innerHTML:"("+(this.getResourceName(a)||this._nls.lblItem)+")"});h.set(d.serverLink_,{title:b.server,innerHTML:(-1!==b.server.toLowerCase().indexOf("arcgis.com")?"ArcGIS Online":b.server)+" "});d.txtPwd_.set("value","");d.show();return e},_createLoginDialog:function(){var m=this._nls,e=b.substitute(m,this._dialogContent),e=b.substitute({resource:"\x3cspan class\x3d'resLink' style\x3d'word-wrap: break-word;'\x3e\x3c/span\x3e",
server:"\x3cspan class\x3d'serverLink' style\x3d'word-wrap: break-word;'\x3e\x3c/span\x3e"},e),l=new c({title:m.title,content:e,"class":"esriSignInDialog",style:"width: 18em;",esriIdMgr_:this,keypressed_:function(a){a.charOrCode===f.ENTER&&this.execute_()},execute_:function(){var d=this.txtUser_.get("value"),f=this.txtPwd_.get("value"),e=this.dfd_,l=this;if(this.form_.validate()&&d&&f){this.btnSubmit_.set("label",m.lblSigning);var r=a.id.findCredential(l.resUrl_,d),n=function(a){l.btnSubmit_.set("label",
m.lblOk);l.btnSubmit_.set("disabled",!1);g.hide(l.errMsg_);l.hide();c._DialogLevelManager.hide(l);var f=l.serverInfo_;l.dfd_=l.serverInfo_=l.generateDfd_=l.resUrl_=null;var h,n,t=r,k;a&&(h=a.token,n=b.isDefined(a.expires)?Number(a.expires):null,k=!!a.ssl,t?(t.userId=d,t.token=h,t.expires=n,t.validity=a.validity,t.ssl=k,t.creationTime=(new Date).getTime()):t=new u({userId:d,server:f.server,token:h,expires:n,ssl:k,isAdmin:l.admin_,validity:a.validity}));e.callback(t)};r&&!r._enqueued?n():(l.btnSubmit_.set("disabled",
!0),l.generateDfd_=a.id.generateToken(this.serverInfo_,{username:d,password:f},{isAdmin:this.admin_}).addCallback(n).addErrback(function(a){l.btnSubmit_.set("disabled",!1);l.generateDfd_=null;l.btnSubmit_.set("label",m.lblOk);h.set(l.errMsg_,"innerHTML",a&&a.code?m.invalidUser:m.noAuthService);g.show(l.errMsg_)}))}},cancel_:function(){l.generateDfd_&&l.generateDfd_.cancel();var a=l.dfd_,b=l.resUrl_,d=l.serverInfo_;l.btnSubmit_.set("disabled",!1);l.dfd_=l.serverInfo_=l.generateDfd_=l.resUrl_=null;
g.hide(l.errMsg_);c._DialogLevelManager.hide(l);l.esriIdMgr_.onDialogCancel({resourceUrl:b,serverInfo:d});b=Error("ABORTED");b.code="IdentityManager.2";b.log=!!p.isDebug;a.errback(b)}}),e=l.domNode;l.form_=d.byNode(k.query(".esriIdForm",e)[0]);l.txtUser_=d.byNode(k.query(".esriIdUser",e)[0]);l.txtPwd_=d.byNode(k.query(".esriIdPwd",e)[0]);l.btnSubmit_=d.byNode(k.query(".esriIdSubmit",e)[0]);l.btnCancel_=d.byNode(k.query(".esriIdCancel",e)[0]);l.resLink_=k.query(".resLink",e)[0];l.serverLink_=k.query(".serverLink",
e)[0];l.errMsg_=k.query(".esriErrorMsg",e)[0];l.connect(l.txtUser_,"onKeyPress",l.keypressed_);l.connect(l.txtPwd_,"onKeyPress",l.keypressed_);l.connect(l.btnSubmit_,"onClick",l.execute_);l.connect(l.btnCancel_,"onClick",l.onCancel);l.connect(l,"onCancel",l.cancel_);return l}})})},"dijit/Dialog":function(){define("require dojo/_base/array dojo/aspect dojo/_base/declare dojo/Deferred dojo/dom dojo/dom-class dojo/dom-geometry dojo/dom-style dojo/_base/fx dojo/i18n dojo/keys dojo/_base/lang dojo/on dojo/ready dojo/sniff dojo/touch dojo/window dojo/dnd/Moveable dojo/dnd/TimedMoveable ./focus ./_base/manager ./_Widget ./_TemplatedMixin ./_CssStateMixin ./form/_FormMixin ./_DialogMixin ./DialogUnderlay ./layout/ContentPane ./layout/utils dojo/text!./templates/Dialog.html ./a11yclick dojo/i18n!./nls/common".split(" "),
function(k,e,p,q,n,l,h,f,d,c,a,b,g,u,m,r,t,v,y,w,z,x,A,C,B,E,D,F,I,M,L){function J(){}var P=new n;P.resolve(!0);x=q("dijit._DialogBase"+(r("dojo-bidi")?"_NoBidi":""),[C,E,D,B],{templateString:L,baseClass:"dijitDialog",cssStateNodes:{closeButtonNode:"dijitDialogCloseIcon"},_setTitleAttr:{node:"titleNode",type:"innerHTML"},open:!1,duration:x.defaultDuration,refocus:!0,autofocus:!0,_firstFocusItem:null,_lastFocusItem:null,draggable:!0,_setDraggableAttr:function(a){this._set("draggable",a)},maxRatio:.9,
closable:!0,_setClosableAttr:function(a){this.closeButtonNode.style.display=a?"":"none";this._set("closable",a)},postMixInProperties:function(){var b=a.getLocalization("dijit","common");g.mixin(this,b);this.inherited(arguments)},postCreate:function(){d.set(this.domNode,{display:"none",position:"absolute"});this.ownerDocumentBody.appendChild(this.domNode);this.inherited(arguments);p.after(this,"onExecute",g.hitch(this,"hide"),!0);p.after(this,"onCancel",g.hitch(this,"hide"),!0);u(this.closeButtonNode,
t.press,function(a){a.stopPropagation()});this._modalconnects=[]},onLoad:function(){this.resize();this._position();this.autofocus&&U.isTop(this)&&(this._getFocusItems(),z.focus(this._firstFocusItem));this.inherited(arguments)},focus:function(){this._getFocusItems();z.focus(this._firstFocusItem)},_endDrag:function(){var a=f.position(this.domNode),b=v.getBox(this.ownerDocument);a.y=Math.min(Math.max(a.y,0),b.h-a.h);a.x=Math.min(Math.max(a.x,0),b.w-a.w);this._relativePosition=a;this._position()},_setup:function(){var a=
this.domNode;this.titleBar&&this.draggable?(this._moveable=new (6==r("ie")?w:y)(a,{handle:this.titleBar}),p.after(this._moveable,"onMoveStop",g.hitch(this,"_endDrag"),!0)):h.add(a,"dijitDialogFixed");this.underlayAttrs={dialogId:this.id,"class":e.map(this["class"].split(/\s/),function(a){return a+"_underlay"}).join(" "),_onKeyDown:g.hitch(this,"_onKey"),ownerDocument:this.ownerDocument}},_size:function(){this.resize()},_position:function(){if(!h.contains(this.ownerDocumentBody,"dojoMove")){var a=
this.domNode,b=v.getBox(this.ownerDocument),c=this._relativePosition,g=f.position(a);d.set(a,{left:Math.floor(b.l+(c?Math.min(c.x,b.w-g.w):(b.w-g.w)/2))+"px",top:Math.floor(b.t+(c?Math.min(c.y,b.h-g.h):(b.h-g.h)/2))+"px"})}},_onKey:function(a){if(a.keyCode==b.TAB){this._getFocusItems();var c=a.target;this._firstFocusItem==this._lastFocusItem?(a.stopPropagation(),a.preventDefault()):c==this._firstFocusItem&&a.shiftKey?(z.focus(this._lastFocusItem),a.stopPropagation(),a.preventDefault()):c!=this._lastFocusItem||
a.shiftKey||(z.focus(this._firstFocusItem),a.stopPropagation(),a.preventDefault())}else this.closable&&a.keyCode==b.ESCAPE&&(this.onCancel(),a.stopPropagation(),a.preventDefault())},show:function(){if(this.open)return P.promise;this._started||this.startup();this._alreadyInitialized||(this._setup(),this._alreadyInitialized=!0);this._fadeOutDeferred&&(this._fadeOutDeferred.cancel(),U.hide(this));var a=v.get(this.ownerDocument);this._modalconnects.push(u(a,"scroll",g.hitch(this,"resize",null)));this._modalconnects.push(u(this.domNode,
"keydown",g.hitch(this,"_onKey")));d.set(this.domNode,{opacity:0,display:""});this._set("open",!0);this._onShow();this.resize();this._position();var b;this._fadeInDeferred=new n(g.hitch(this,function(){b.stop();delete this._fadeInDeferred}));this._fadeInDeferred.then(void 0,J);a=this._fadeInDeferred.promise;b=c.fadeIn({node:this.domNode,duration:this.duration,beforeBegin:g.hitch(this,function(){U.show(this,this.underlayAttrs)}),onEnd:g.hitch(this,function(){this.autofocus&&U.isTop(this)&&(this._getFocusItems(),
z.focus(this._firstFocusItem));this._fadeInDeferred.resolve(!0);delete this._fadeInDeferred})}).play();return a},hide:function(){if(!this._alreadyInitialized||!this.open)return P.promise;this._fadeInDeferred&&this._fadeInDeferred.cancel();var a;this._fadeOutDeferred=new n(g.hitch(this,function(){a.stop();delete this._fadeOutDeferred}));this._fadeOutDeferred.then(void 0,J);this._fadeOutDeferred.then(g.hitch(this,"onHide"));var b=this._fadeOutDeferred.promise;a=c.fadeOut({node:this.domNode,duration:this.duration,
onEnd:g.hitch(this,function(){this.domNode.style.display="none";U.hide(this);this._fadeOutDeferred.resolve(!0);delete this._fadeOutDeferred})}).play();this._scrollConnected&&(this._scrollConnected=!1);for(var d;d=this._modalconnects.pop();)d.remove();this._relativePosition&&delete this._relativePosition;this._set("open",!1);return b},resize:function(a){if("none"!=this.domNode.style.display){this._checkIfSingleChild();if(!a){this._shrunk&&(this._singleChild&&"undefined"!=typeof this._singleChildOriginalStyle&&
(this._singleChild.domNode.style.cssText=this._singleChildOriginalStyle,delete this._singleChildOriginalStyle),e.forEach([this.domNode,this.containerNode,this.titleBar,this.actionBarNode],function(a){a&&d.set(a,{position:"static",width:"auto",height:"auto"})}),this.domNode.style.position="absolute");var b=v.getBox(this.ownerDocument);b.w*=this.maxRatio;b.h*=this.maxRatio;var c=f.position(this.domNode);c.w>=b.w||c.h>=b.h?(a={w:Math.min(c.w,b.w),h:Math.min(c.h,b.h)},this._shrunk=!0):this._shrunk=!1}if(a){f.setMarginBox(this.domNode,
a);b=[];this.titleBar&&b.push({domNode:this.titleBar,region:"top"});this.actionBarNode&&b.push({domNode:this.actionBarNode,region:"bottom"});c={domNode:this.containerNode,region:"center"};b.push(c);var g=M.marginBox2contentBox(this.domNode,a);M.layoutChildren(this.domNode,g,b);this._singleChild?(b=M.marginBox2contentBox(this.containerNode,c),this._singleChild.resize({w:b.w,h:b.h})):(this.containerNode.style.overflow="auto",this._layoutChildren())}else this._layoutChildren();r("touch")||a||this._position()}},
_layoutChildren:function(){e.forEach(this.getChildren(),function(a){a.resize&&a.resize()})},destroy:function(){this._fadeInDeferred&&this._fadeInDeferred.cancel();this._fadeOutDeferred&&this._fadeOutDeferred.cancel();this._moveable&&this._moveable.destroy();for(var a;a=this._modalconnects.pop();)a.remove();U.hide(this);this.inherited(arguments)}});r("dojo-bidi")&&(x=q("dijit._DialogBase",x,{_setTitleAttr:function(a){this._set("title",a);this.titleNode.innerHTML=a;this.applyTextDir(this.titleNode)},
_setTextDirAttr:function(a){this._created&&this.textDir!=a&&(this._set("textDir",a),this.set("title",this.title))}}));var K=q("dijit.Dialog",[I,x],{});K._DialogBase=x;var U=K._DialogLevelManager={_beginZIndex:950,show:function(a,b){O[O.length-1].focus=z.curNode;var c=O[O.length-1].dialog?O[O.length-1].zIndex+2:K._DialogLevelManager._beginZIndex;d.set(a.domNode,"zIndex",c);F.show(b,c-1);O.push({dialog:a,underlayAttrs:b,zIndex:c})},hide:function(a){if(O[O.length-1].dialog==a){O.pop();var b=O[O.length-
1];1==O.length?F.hide():F.show(b.underlayAttrs,b.zIndex-1);if(a.refocus&&(a=b.focus,!b.dialog||a&&l.isDescendant(a,b.dialog.domNode)||(b.dialog._getFocusItems(),a=b.dialog._firstFocusItem),a))try{a.focus()}catch(N){}}else b=e.indexOf(e.map(O,function(a){return a.dialog}),a),-1!=b&&O.splice(b,1)},isTop:function(a){return O[O.length-1].dialog==a}},O=K._dialogStack=[{dialog:null,focus:null,underlayAttrs:null}];z.watch("curNode",function(a,b,c){a=O[O.length-1].dialog;if(c&&a&&!a._fadeOutDeferred&&c.ownerDocument==
a.ownerDocument){do if(c==a.domNode||h.contains(c,"dijitPopup"))return;while(c=c.parentNode);a.focus()}});r("dijit-legacy-requires")&&m(0,function(){k(["dijit/TooltipDialog"])});return K})},"dojo/dnd/Moveable":function(){define("../_base/array ../_base/declare ../_base/lang ../dom ../dom-class ../Evented ../has ../on ../topic ../touch ./common ./Mover ../_base/window".split(" "),function(k,e,p,q,n,l,h,f,d,c,a,b,g){function u(a,b){"touchAction"in document.body.style?m="touchAction":"msTouchAction"in
document.body.style&&(m="msTouchAction");r=function(a,b){a.style[m]=b};r(a,b)}var m,r=function(){};h("touch-action")&&(r=u);return e("dojo.dnd.Moveable",[l],{handle:"",delay:0,skip:!1,constructor:function(a,d){this.node=q.byId(a);r(this.node,"none");d||(d={});this.handle=d.handle?q.byId(d.handle):null;this.handle||(this.handle=this.node);this.delay=0<d.delay?d.delay:0;this.skip=d.skip;this.mover=d.mover?d.mover:b;this.events=[f(this.handle,c.press,p.hitch(this,"onMouseDown")),f(this.handle,"dragstart",
p.hitch(this,"onSelectStart")),f(this.handle,"selectstart",p.hitch(this,"onSelectStart"))]},markupFactory:function(a,b,c){return new c(b,a)},destroy:function(){k.forEach(this.events,function(a){a.remove()});r(this.node,"");this.events=this.node=this.handle=null},onMouseDown:function(b){if(!this.skip||!a.isFormElement(b)){if(this.delay)this.events.push(f(this.handle,c.move,p.hitch(this,"onMouseMove")),f(this.handle.ownerDocument,c.release,p.hitch(this,"onMouseUp"))),this._lastX=b.pageX,this._lastY=
b.pageY;else this.onDragDetected(b);b.stopPropagation();b.preventDefault()}},onMouseMove:function(a){if(Math.abs(a.pageX-this._lastX)>this.delay||Math.abs(a.pageY-this._lastY)>this.delay)this.onMouseUp(a),this.onDragDetected(a);a.stopPropagation();a.preventDefault()},onMouseUp:function(a){for(var b=0;2>b;++b)this.events.pop().remove();a.stopPropagation();a.preventDefault()},onSelectStart:function(b){this.skip&&a.isFormElement(b)||(b.stopPropagation(),b.preventDefault())},onDragDetected:function(a){new this.mover(this.node,
a,this)},onMoveStart:function(a){d.publish("/dnd/move/start",a);n.add(g.body(),"dojoMove");n.add(this.node,"dojoMoveItem")},onMoveStop:function(a){d.publish("/dnd/move/stop",a);n.remove(g.body(),"dojoMove");n.remove(this.node,"dojoMoveItem")},onFirstMove:function(){},onMove:function(a,b){this.onMoving(a,b);var c=a.node.style;c.left=b.l+"px";c.top=b.t+"px";this.onMoved(a,b)},onMoving:function(){},onMoved:function(){}})})},"dojo/dnd/common":function(){define(["../sniff","../_base/kernel","../_base/lang",
"../dom"],function(k,e,p,q){var n=p.getObject("dojo.dnd",!0);n.getCopyKeyState=function(e){return e[k("mac")?"metaKey":"ctrlKey"]};n._uniqueId=0;n.getUniqueId=function(){var l;do l=e._scopeName+"Unique"+ ++n._uniqueId;while(q.byId(l));return l};n._empty={};n.isFormElement=function(e){e=e.target;3==e.nodeType&&(e=e.parentNode);return 0<=" a button textarea input select option ".indexOf(" "+e.tagName.toLowerCase()+" ")};return n})},"dojo/dnd/Mover":function(){define("../_base/array ../_base/declare ../_base/lang ../sniff ../_base/window ../dom ../dom-geometry ../dom-style ../Evented ../on ../touch ./common ./autoscroll".split(" "),
function(k,e,p,q,n,l,h,f,d,c,a,b,g){return e("dojo.dnd.Mover",[d],{constructor:function(b,d,f){function m(a){a.preventDefault();a.stopPropagation()}this.node=l.byId(b);this.marginBox={l:d.pageX,t:d.pageY};this.mouseButton=d.button;d=this.host=f;b=b.ownerDocument;this.events=[c(b,a.move,p.hitch(this,"onFirstMove")),c(b,a.move,p.hitch(this,"onMouseMove")),c(b,a.release,p.hitch(this,"onMouseUp")),c(b,"dragstart",m),c(b.body,"selectstart",m)];g.autoScrollStart(b);if(d&&d.onMoveStart)d.onMoveStart(this)},
onMouseMove:function(a){g.autoScroll(a);var b=this.marginBox;this.host.onMove(this,{l:b.l+a.pageX,t:b.t+a.pageY},a);a.preventDefault();a.stopPropagation()},onMouseUp:function(a){(q("webkit")&&q("mac")&&2==this.mouseButton?0==a.button:this.mouseButton==a.button)&&this.destroy();a.preventDefault();a.stopPropagation()},onFirstMove:function(a){var b=this.node.style,c,d=this.host;switch(b.position){case "relative":case "absolute":c=Math.round(parseFloat(b.left))||0;b=Math.round(parseFloat(b.top))||0;break;
default:b.position="absolute";b=h.getMarginBox(this.node);c=n.doc.body;var g=f.getComputedStyle(c),e=h.getMarginBox(c,g),g=h.getContentBox(c,g);c=b.l-(g.l-e.l);b=b.t-(g.t-e.t)}this.marginBox.l=c-this.marginBox.l;this.marginBox.t=b-this.marginBox.t;if(d&&d.onFirstMove)d.onFirstMove(this,a);this.events.shift().remove()},destroy:function(){k.forEach(this.events,function(a){a.remove()});var a=this.host;if(a&&a.onMoveStop)a.onMoveStop(this);this.events=this.node=this.host=null}})})},"dojo/dnd/autoscroll":function(){define("../_base/lang ../sniff ../_base/window ../dom-geometry ../dom-style ../window".split(" "),
function(k,e,p,q,n,l){var h={};k.setObject("dojo.dnd.autoscroll",h);h.getViewport=l.getBox;h.V_TRIGGER_AUTOSCROLL=32;h.H_TRIGGER_AUTOSCROLL=32;h.V_AUTOSCROLL_VALUE=16;h.H_AUTOSCROLL_VALUE=16;var f,d=p.doc,c=Infinity,a=Infinity;h.autoScrollStart=function(b){d=b;f=l.getBox(d);b=p.body(d).parentNode;c=Math.max(b.scrollHeight-f.h,0);a=Math.max(b.scrollWidth-f.w,0)};h.autoScroll=function(b){var g=f||l.getBox(d),e=p.body(d).parentNode,m=0,r=0;b.clientX<h.H_TRIGGER_AUTOSCROLL?m=-h.H_AUTOSCROLL_VALUE:b.clientX>
g.w-h.H_TRIGGER_AUTOSCROLL&&(m=Math.min(h.H_AUTOSCROLL_VALUE,a-e.scrollLeft));b.clientY<h.V_TRIGGER_AUTOSCROLL?r=-h.V_AUTOSCROLL_VALUE:b.clientY>g.h-h.V_TRIGGER_AUTOSCROLL&&(r=Math.min(h.V_AUTOSCROLL_VALUE,c-e.scrollTop));window.scrollBy(m,r)};h._validNodes={div:1,p:1,td:1};h._validOverflow={auto:1,scroll:1};h.autoScrollNodes=function(a){for(var b,c,d,f,l,k=0,y=0,w=a.target;w;){if(1==w.nodeType&&w.tagName.toLowerCase()in h._validNodes){d=n.getComputedStyle(w);l=d.overflowX.toLowerCase()in h._validOverflow;
f=d.overflowY.toLowerCase()in h._validOverflow;if(l||f)b=q.getContentBox(w,d),c=q.position(w,!0);if(l){d=Math.min(h.H_TRIGGER_AUTOSCROLL,b.w/2);l=a.pageX-c.x;if(e("webkit")||e("opera"))l+=p.body().scrollLeft;k=0;0<l&&l<b.w&&(l<d?k=-d:l>b.w-d&&(k=d),w.scrollLeft+=k)}if(f){f=Math.min(h.V_TRIGGER_AUTOSCROLL,b.h/2);d=a.pageY-c.y;if(e("webkit")||e("opera"))d+=p.body().scrollTop;y=0;0<d&&d<b.h&&(d<f?y=-f:d>b.h-f&&(y=f),w.scrollTop+=y)}if(k||y)return}try{w=w.parentNode}catch(z){w=null}}h.autoScroll(a)};
return h})},"dojo/dnd/TimedMoveable":function(){define(["../_base/declare","./Moveable"],function(k,e){var p=e.prototype.onMove;return k("dojo.dnd.TimedMoveable",e,{timeout:40,constructor:function(e,n){n||(n={});n.timeout&&"number"==typeof n.timeout&&0<=n.timeout&&(this.timeout=n.timeout)},onMoveStop:function(k){k._timer&&(clearTimeout(k._timer),p.call(this,k,k._leftTop));e.prototype.onMoveStop.apply(this,arguments)},onMove:function(e,n){e._leftTop=n;if(!e._timer){var l=this;e._timer=setTimeout(function(){e._timer=
null;p.call(l,e,e._leftTop)},this.timeout)}}})})},"dijit/_base/manager":function(){define(["dojo/_base/array","dojo/_base/config","dojo/_base/lang","../registry","../main"],function(k,e,p,q,n){var l={};k.forEach("byId getUniqueId findWidgets _destroyAll byNode getEnclosingWidget".split(" "),function(e){l[e]=q[e]});p.mixin(l,{defaultDuration:e.defaultDuration||200});p.mixin(n,l);return n})},"dijit/_CssStateMixin":function(){define("dojo/_base/array dojo/_base/declare dojo/dom dojo/dom-class dojo/has dojo/_base/lang dojo/on dojo/domReady dojo/touch dojo/_base/window ./a11yclick ./registry".split(" "),
function(k,e,p,q,n,l,h,f,d,c,a,b){e=e("dijit._CssStateMixin",[],{hovering:!1,active:!1,_applyAttributes:function(){this.inherited(arguments);k.forEach("disabled readOnly checked selected focused state hovering active _opened".split(" "),function(a){this.watch(a,l.hitch(this,"_setStateClass"))},this);for(var a in this.cssStateNodes||{})this._trackMouseState(this[a],this.cssStateNodes[a]);this._trackMouseState(this.domNode,this.baseClass);this._setStateClass()},_cssMouseEvent:function(a){if(!this.disabled)switch(a.type){case "mouseover":case "MSPointerOver":case "pointerover":this._set("hovering",
!0);this._set("active",this._mouseDown);break;case "mouseout":case "MSPointerOut":case "pointerout":this._set("hovering",!1);this._set("active",!1);break;case "mousedown":case "touchstart":case "MSPointerDown":case "pointerdown":case "keydown":this._set("active",!0);break;case "mouseup":case "dojotouchend":case "MSPointerUp":case "pointerup":case "keyup":this._set("active",!1)}},_setStateClass:function(){function a(a){b=b.concat(k.map(b,function(b){return b+a}),"dijit"+a)}var b=this.baseClass.split(" ");
this.isLeftToRight()||a("Rtl");var c="mixed"==this.checked?"Mixed":this.checked?"Checked":"";this.checked&&a(c);this.state&&a(this.state);this.selected&&a("Selected");this._opened&&a("Opened");this.disabled?a("Disabled"):this.readOnly?a("ReadOnly"):this.active?a("Active"):this.hovering&&a("Hover");this.focused&&a("Focused");var c=this.stateNode||this.domNode,d={};k.forEach(c.className.split(" "),function(a){d[a]=!0});"_stateClasses"in this&&k.forEach(this._stateClasses,function(a){delete d[a]});k.forEach(b,
function(a){d[a]=!0});var f=[],e;for(e in d)f.push(e);c.className=f.join(" ");this._stateClasses=b},_subnodeCssMouseEvent:function(a,b,c){function d(c){q.toggle(a,b+"Active",c)}if(!this.disabled&&!this.readOnly)switch(c.type){case "mouseover":case "MSPointerOver":case "pointerover":q.toggle(a,b+"Hover",!0);break;case "mouseout":case "MSPointerOut":case "pointerout":q.toggle(a,b+"Hover",!1);d(!1);break;case "mousedown":case "touchstart":case "MSPointerDown":case "pointerdown":case "keydown":d(!0);
break;case "mouseup":case "MSPointerUp":case "pointerup":case "dojotouchend":case "keyup":d(!1);break;case "focus":case "focusin":q.toggle(a,b+"Focused",!0);break;case "blur":case "focusout":q.toggle(a,b+"Focused",!1)}},_trackMouseState:function(a,b){a._cssState=b}});f(function(){function g(a,c,d){if(!d||!p.isDescendant(d,c))for(;c&&c!=d;c=c.parentNode)if(c._cssState){var g=b.getEnclosingWidget(c);g&&(c==g.domNode?g._cssMouseEvent(a):g._subnodeCssMouseEvent(c,c._cssState,a))}}var f=c.body(),m;h(f,
d.over,function(a){g(a,a.target,a.relatedTarget)});h(f,d.out,function(a){g(a,a.target,a.relatedTarget)});h(f,a.press,function(a){m=a.target;g(a,m)});h(f,a.release,function(a){g(a,m);m=null});h(f,"focusin, focusout",function(a){var c=a.target;if(c._cssState&&!c.getAttribute("widgetId")){var d=b.getEnclosingWidget(c);d&&d._subnodeCssMouseEvent(c,c._cssState,a)}})});return e})},"dijit/form/_FormMixin":function(){define("dojo/_base/array dojo/_base/declare dojo/_base/kernel dojo/_base/lang dojo/on dojo/window".split(" "),
function(k,e,p,q,n,l){return e("dijit.form._FormMixin",null,{state:"",_getDescendantFormWidgets:function(e){var f=[];k.forEach(e||this.getChildren(),function(d){"value"in d?f.push(d):f=f.concat(this._getDescendantFormWidgets(d.getChildren()))},this);return f},reset:function(){k.forEach(this._getDescendantFormWidgets(),function(e){e.reset&&e.reset()})},validate:function(){var e=!1;return k.every(k.map(this._getDescendantFormWidgets(),function(f){f._hasBeenBlurred=!0;var d=f.disabled||!f.validate||
f.validate();d||e||(l.scrollIntoView(f.containerNode||f.domNode),f.focus(),e=!0);return d}),function(f){return f})},setValues:function(e){p.deprecated(this.declaredClass+"::setValues() is deprecated. Use set('value', val) instead.","","2.0");return this.set("value",e)},_setValueAttr:function(e){var f={};k.forEach(this._getDescendantFormWidgets(),function(a){a.name&&(f[a.name]||(f[a.name]=[])).push(a)});for(var d in f)if(f.hasOwnProperty(d)){var c=f[d],a=q.getObject(d,!1,e);void 0!==a&&(a=[].concat(a),
"boolean"==typeof c[0].checked?k.forEach(c,function(b){b.set("value",-1!=k.indexOf(a,b._get("value")))}):c[0].multiple?c[0].set("value",a):k.forEach(c,function(b,c){b.set("value",a[c])}))}},getValues:function(){p.deprecated(this.declaredClass+"::getValues() is deprecated. Use get('value') instead.","","2.0");return this.get("value")},_getValueAttr:function(){var e={};k.forEach(this._getDescendantFormWidgets(),function(f){var d=f.name;if(d&&!f.disabled){var c=f.get("value");"boolean"==typeof f.checked?
/Radio/.test(f.declaredClass)?!1!==c?q.setObject(d,c,e):(c=q.getObject(d,!1,e),void 0===c&&q.setObject(d,null,e)):(f=q.getObject(d,!1,e),f||(f=[],q.setObject(d,f,e)),!1!==c&&f.push(c)):(f=q.getObject(d,!1,e),"undefined"!=typeof f?q.isArray(f)?f.push(c):q.setObject(d,[f,c],e):q.setObject(d,c,e))}});return e},isValid:function(){return""==this.state},onValidStateChange:function(){},_getState:function(){var e=k.map(this._descendants,function(f){return f.get("state")||""});return 0<=k.indexOf(e,"Error")?
"Error":0<=k.indexOf(e,"Incomplete")?"Incomplete":""},disconnectChildren:function(){},connectChildren:function(e){this._descendants=this._getDescendantFormWidgets();k.forEach(this._descendants,function(f){f._started||f.startup()});e||this._onChildChange()},_onChildChange:function(e){e&&"state"!=e&&"disabled"!=e||this._set("state",this._getState());e&&"value"!=e&&"disabled"!=e&&"checked"!=e||(this._onChangeDelayTimer&&this._onChangeDelayTimer.remove(),this._onChangeDelayTimer=this.defer(function(){delete this._onChangeDelayTimer;
this._set("value",this.get("value"))},10))},startup:function(){this.inherited(arguments);this._descendants=this._getDescendantFormWidgets();this.value=this.get("value");this.state=this._getState();var e=this;this.own(n(this.containerNode,"attrmodified-state, attrmodified-disabled, attrmodified-value, attrmodified-checked",function(f){f.target!=e.domNode&&e._onChildChange(f.type.replace("attrmodified-",""))}));this.watch("state",function(f,d,c){this.onValidStateChange(""==c)})},destroy:function(){this.inherited(arguments)}})})},
"dijit/_DialogMixin":function(){define(["dojo/_base/declare","./a11y"],function(k,e){return k("dijit._DialogMixin",null,{actionBarTemplate:"",execute:function(){},onCancel:function(){},onExecute:function(){},_onSubmit:function(){this.onExecute();this.execute(this.get("value"))},_getFocusItems:function(){var k=e._getTabNavigable(this.domNode);this._firstFocusItem=k.lowest||k.first||this.closeButtonNode||this.domNode;this._lastFocusItem=k.last||k.highest||this._firstFocusItem}})})},"dijit/DialogUnderlay":function(){define("dojo/_base/declare dojo/_base/lang dojo/aspect dojo/dom-attr dojo/dom-style dojo/on dojo/window ./_Widget ./_TemplatedMixin ./BackgroundIframe ./Viewport ./main".split(" "),
function(k,e,p,q,n,l,h,f,d,c,a,b){var g=k("dijit.DialogUnderlay",[f,d],{templateString:"\x3cdiv class\x3d'dijitDialogUnderlayWrapper'\x3e\x3cdiv class\x3d'dijitDialogUnderlay' tabIndex\x3d'-1' data-dojo-attach-point\x3d'node'\x3e\x3c/div\x3e\x3c/div\x3e",dialogId:"","class":"",_modalConnects:[],_setDialogIdAttr:function(a){q.set(this.node,"id",a+"_underlay");this._set("dialogId",a)},_setClassAttr:function(a){this.node.className="dijitDialogUnderlay "+a;this._set("class",a)},postCreate:function(){this.ownerDocumentBody.appendChild(this.domNode);
this.own(l(this.domNode,"keydown",e.hitch(this,"_onKeyDown")));this.inherited(arguments)},layout:function(){var a=this.node.style,b=this.domNode.style;b.display="none";var c=h.getBox(this.ownerDocument);b.top=c.t+"px";b.left=c.l+"px";a.width=c.w+"px";a.height=c.h+"px";b.display="block"},show:function(){this.domNode.style.display="block";this.open=!0;this.layout();this.bgIframe=new c(this.domNode);var b=h.get(this.ownerDocument);this._modalConnects=[a.on("resize",e.hitch(this,"layout")),l(b,"scroll",
e.hitch(this,"layout"))]},hide:function(){this.bgIframe.destroy();delete this.bgIframe;for(this.domNode.style.display="none";this._modalConnects.length;)this._modalConnects.pop().remove();this.open=!1},destroy:function(){for(;this._modalConnects.length;)this._modalConnects.pop().remove();this.inherited(arguments)},_onKeyDown:function(){}});g.show=function(a,c){var d=g._singleton;!d||d._destroyed?d=b._underlay=g._singleton=new g(a):a&&d.set(a);n.set(d.domNode,"zIndex",c);d.open||d.show()};g.hide=function(){var a=
g._singleton;a&&!a._destroyed&&a.hide()};return g})},"dijit/BackgroundIframe":function(){define("require ./main dojo/_base/config dojo/dom-construct dojo/dom-style dojo/_base/lang dojo/on dojo/sniff".split(" "),function(k,e,p,q,n,l,h,f){f.add("config-bgIframe",(f("ie")||f("trident"))&&!/IEMobile\/10\.0/.test(navigator.userAgent));var d=new function(){var c=[];this.pop=function(){var a;c.length?(a=c.pop(),a.style.display=""):(9>f("ie")?(a=p.dojoBlankHtmlUrl||k.toUrl("dojo/resources/blank.html")||'javascript:""',
a=document.createElement("\x3ciframe src\x3d'"+a+"' role\x3d'presentation' style\x3d'position: absolute; left: 0px; top: 0px;z-index: -1; filter:Alpha(Opacity\x3d\"0\");'\x3e")):(a=q.create("iframe"),a.src='javascript:""',a.className="dijitBackgroundIframe",a.setAttribute("role","presentation"),n.set(a,"opacity",.1)),a.tabIndex=-1);return a};this.push=function(a){a.style.display="none";c.push(a)}};e.BackgroundIframe=function(c){if(!c.id)throw Error("no id");if(f("config-bgIframe")){var a=this.iframe=
d.pop();c.appendChild(a);7>f("ie")||f("quirks")?(this.resize(c),this._conn=h(c,"resize",l.hitch(this,"resize",c))):n.set(a,{width:"100%",height:"100%"})}};l.extend(e.BackgroundIframe,{resize:function(c){this.iframe&&n.set(this.iframe,{width:c.offsetWidth+"px",height:c.offsetHeight+"px"})},destroy:function(){this._conn&&(this._conn.remove(),this._conn=null);this.iframe&&(this.iframe.parentNode.removeChild(this.iframe),d.push(this.iframe),delete this.iframe)}});return e.BackgroundIframe})},"dijit/Viewport":function(){define(["dojo/Evented",
"dojo/on","dojo/domReady","dojo/sniff","dojo/window"],function(k,e,p,q,n){var l=new k,h;p(function(){var f=n.getBox();l._rlh=e(window,"resize",function(){var c=n.getBox();if(f.h!=c.h||f.w!=c.w)f=c,l.emit("resize")});if(8==q("ie")){var d=screen.deviceXDPI;setInterval(function(){screen.deviceXDPI!=d&&(d=screen.deviceXDPI,l.emit("resize"))},500)}q("ios")&&(e(document,"focusin",function(c){h=c.target}),e(document,"focusout",function(c){h=null}))});l.getEffectiveBox=function(f){f=n.getBox(f);var d=h&&
h.tagName&&h.tagName.toLowerCase();q("ios")&&h&&!h.readOnly&&("textarea"==d||"input"==d&&/^(color|email|number|password|search|tel|text|url)$/.test(h.type))&&(f.h*=0==orientation||180==orientation?.66:.4,d=h.getBoundingClientRect(),f.h=Math.max(f.h,d.top+d.height));return f};return l})},"dijit/layout/ContentPane":function(){define("dojo/_base/kernel dojo/_base/lang ../_Widget ../_Container ./_ContentPaneResizeMixin dojo/string dojo/html dojo/_base/array dojo/_base/declare dojo/_base/Deferred dojo/dom dojo/dom-attr dojo/dom-construct dojo/_base/xhr dojo/i18n dojo/when dojo/i18n!../nls/loading".split(" "),
function(k,e,p,q,n,l,h,f,d,c,a,b,g,u,m,r){return d("dijit.layout.ContentPane",[p,q,n],{href:"",content:"",extractContent:!1,parseOnLoad:!0,parserScope:k._scopeName,preventCache:!1,preload:!1,refreshOnShow:!1,loadingMessage:"\x3cspan class\x3d'dijitContentPaneLoading'\x3e\x3cspan class\x3d'dijitInline dijitIconLoading'\x3e\x3c/span\x3e${loadingState}\x3c/span\x3e",errorMessage:"\x3cspan class\x3d'dijitContentPaneError'\x3e\x3cspan class\x3d'dijitInline dijitIconError'\x3e\x3c/span\x3e${errorState}\x3c/span\x3e",
isLoaded:!1,baseClass:"dijitContentPane",ioArgs:{},onLoadDeferred:null,_setTitleAttr:null,stopParser:!0,template:!1,markupFactory:function(a,b,c){var d=new c(a,b);return!d.href&&d._contentSetter&&d._contentSetter.parseDeferred&&!d._contentSetter.parseDeferred.isFulfilled()?d._contentSetter.parseDeferred.then(function(){return d}):d},create:function(b,c){if(!(b&&b.template||!c||"href"in b||"content"in b)){c=a.byId(c);for(var d=c.ownerDocument.createDocumentFragment();c.firstChild;)d.appendChild(c.firstChild);
b=e.delegate(b,{content:d})}this.inherited(arguments,[b,c])},postMixInProperties:function(){this.inherited(arguments);var a=m.getLocalization("dijit","loading",this.lang);this.loadingMessage=l.substitute(this.loadingMessage,a);this.errorMessage=l.substitute(this.errorMessage,a)},buildRendering:function(){this.inherited(arguments);this.containerNode||(this.containerNode=this.domNode);this.domNode.removeAttribute("title")},startup:function(){this.inherited(arguments);this._contentSetter&&f.forEach(this._contentSetter.parseResults,
function(a){a._started||a._destroyed||!e.isFunction(a.startup)||(a.startup(),a._started=!0)},this)},_startChildren:function(){f.forEach(this.getChildren(),function(a){a._started||a._destroyed||!e.isFunction(a.startup)||(a.startup(),a._started=!0)});this._contentSetter&&f.forEach(this._contentSetter.parseResults,function(a){a._started||a._destroyed||!e.isFunction(a.startup)||(a.startup(),a._started=!0)},this)},setHref:function(a){k.deprecated("dijit.layout.ContentPane.setHref() is deprecated. Use set('href', ...) instead.",
"","2.0");return this.set("href",a)},_setHrefAttr:function(a){this.cancel();this.onLoadDeferred=new c(e.hitch(this,"cancel"));this.onLoadDeferred.then(e.hitch(this,"onLoad"));this._set("href",a);this.preload||this._created&&this._isShown()?this._load():this._hrefChanged=!0;return this.onLoadDeferred},setContent:function(a){k.deprecated("dijit.layout.ContentPane.setContent() is deprecated.  Use set('content', ...) instead.","","2.0");this.set("content",a)},_setContentAttr:function(a){this._set("href",
"");this.cancel();this.onLoadDeferred=new c(e.hitch(this,"cancel"));this._created&&this.onLoadDeferred.then(e.hitch(this,"onLoad"));this._setContent(a||"");this._isDownloaded=!1;return this.onLoadDeferred},_getContentAttr:function(){return this.containerNode.innerHTML},cancel:function(){this._xhrDfd&&-1==this._xhrDfd.fired&&this._xhrDfd.cancel();delete this._xhrDfd;this.onLoadDeferred=null},destroy:function(){this.cancel();this.inherited(arguments)},destroyRecursive:function(a){this._beingDestroyed||
this.inherited(arguments)},_onShow:function(){this.inherited(arguments);if(this.href&&!this._xhrDfd&&(!this.isLoaded||this._hrefChanged||this.refreshOnShow))return this.refresh()},refresh:function(){this.cancel();this.onLoadDeferred=new c(e.hitch(this,"cancel"));this.onLoadDeferred.then(e.hitch(this,"onLoad"));this._load();return this.onLoadDeferred},_load:function(){this._setContent(this.onDownloadStart(),!0);var a=this,b={preventCache:this.preventCache||this.refreshOnShow,url:this.href,handleAs:"text"};
e.isObject(this.ioArgs)&&e.mixin(b,this.ioArgs);var c=this._xhrDfd=(this.ioMethod||u.get)(b),d;c.then(function(b){d=b;try{return a._isDownloaded=!0,a._setContent(b,!1)}catch(x){a._onError("Content",x)}},function(b){c.canceled||a._onError("Download",b);delete a._xhrDfd;return b}).then(function(){a.onDownloadEnd();delete a._xhrDfd;return d});delete this._hrefChanged},_onLoadHandler:function(a){this._set("isLoaded",!0);try{this.onLoadDeferred.resolve(a)}catch(v){console.error("Error "+this.widgetId+
" running custom onLoad code: "+v.message)}},_onUnloadHandler:function(){this._set("isLoaded",!1);try{this.onUnload()}catch(t){console.error("Error "+this.widgetId+" running custom onUnload code: "+t.message)}},destroyDescendants:function(a){this.isLoaded&&this._onUnloadHandler();var b=this._contentSetter;f.forEach(this.getChildren(),function(b){b.destroyRecursive?b.destroyRecursive(a):b.destroy&&b.destroy(a);b._destroyed=!0});b&&(f.forEach(b.parseResults,function(b){b._destroyed||(b.destroyRecursive?
b.destroyRecursive(a):b.destroy&&b.destroy(a),b._destroyed=!0)}),delete b.parseResults);a||g.empty(this.containerNode);delete this._singleChild},_setContent:function(a,b){a=this.preprocessContent(a);this.destroyDescendants();var c=this._contentSetter;c&&c instanceof h._ContentSetter||(c=this._contentSetter=new h._ContentSetter({node:this.containerNode,_onError:e.hitch(this,this._onError),onContentError:e.hitch(this,function(a){a=this.onContentError(a);try{this.containerNode.innerHTML=a}catch(A){console.error("Fatal "+
this.id+" could not change content due to "+A.message,A)}})}));var d=e.mixin({cleanContent:this.cleanContent,extractContent:this.extractContent,parseContent:!a.domNode&&this.parseOnLoad,parserScope:this.parserScope,startup:!1,dir:this.dir,lang:this.lang,textDir:this.textDir},this._contentSetterParams||{}),d=c.set(e.isObject(a)&&a.domNode?a.domNode:a,d),g=this;return r(d&&d.then?d:c.parseDeferred,function(){delete g._contentSetterParams;b||(g._started&&(g._startChildren(),g._scheduleLayout()),g._onLoadHandler(a))})},
preprocessContent:function(a){return a},_onError:function(a,b,c){this.onLoadDeferred.reject(b);a=this["on"+a+"Error"].call(this,b);c?console.error(c,b):a&&this._setContent(a,!0)},onLoad:function(){},onUnload:function(){},onDownloadStart:function(){return this.loadingMessage},onContentError:function(){},onDownloadError:function(){return this.errorMessage},onDownloadEnd:function(){}})})},"dijit/_Container":function(){define(["dojo/_base/array","dojo/_base/declare","dojo/dom-construct","dojo/_base/kernel"],
function(k,e,p,q){return e("dijit._Container",null,{buildRendering:function(){this.inherited(arguments);this.containerNode||(this.containerNode=this.domNode)},addChild:function(e,l){var h=this.containerNode;if(0<l){for(h=h.firstChild;0<l;)1==h.nodeType&&l--,h=h.nextSibling;h?l="before":(h=this.containerNode,l="last")}p.place(e.domNode,h,l);this._started&&!e._started&&e.startup()},removeChild:function(e){"number"==typeof e&&(e=this.getChildren()[e]);e&&(e=e.domNode)&&e.parentNode&&e.parentNode.removeChild(e)},
hasChildren:function(){return 0<this.getChildren().length},_getSiblingOfChild:function(e,l){var h=this.getChildren();e=k.indexOf(h,e);return h[e+l]},getIndexOfChild:function(e){return k.indexOf(this.getChildren(),e)}})})},"dijit/layout/_ContentPaneResizeMixin":function(){define("dojo/_base/array dojo/_base/declare dojo/dom-class dojo/dom-geometry dojo/dom-style dojo/_base/lang dojo/query ../registry ../Viewport ./utils".split(" "),function(k,e,p,q,n,l,h,f,d,c){return e("dijit.layout._ContentPaneResizeMixin",
null,{doLayout:!0,isLayoutContainer:!0,startup:function(){if(!this._started){var a=this.getParent();this._childOfLayoutWidget=a&&a.isLayoutContainer;this._needLayout=!this._childOfLayoutWidget;this.inherited(arguments);this._isShown()&&this._onShow();this._childOfLayoutWidget||this.own(d.on("resize",l.hitch(this,"resize")))}},_checkIfSingleChild:function(){if(this.doLayout){var a=[],b=!1;h("\x3e *",this.containerNode).some(function(c){var d=f.byNode(c);d&&d.resize?a.push(d):!/script|link|style/i.test(c.nodeName)&&
c.offsetHeight&&(b=!0)});this._singleChild=1!=a.length||b?null:a[0];p.toggle(this.containerNode,this.baseClass+"SingleChild",!!this._singleChild)}},resize:function(a,b){this._resizeCalled=!0;this._scheduleLayout(a,b)},_scheduleLayout:function(a,b){this._isShown()?this._layout(a,b):(this._needLayout=!0,this._changeSize=a,this._resultSize=b)},_layout:function(a,b){delete this._needLayout;this._wasShown||!1===this.open||this._onShow();a&&q.setMarginBox(this.domNode,a);var d=this.containerNode;d===this.domNode?
(b=b||{},l.mixin(b,a||{}),"h"in b&&"w"in b||(b=l.mixin(q.getMarginBox(d),b)),this._contentBox=c.marginBox2contentBox(d,b)):this._contentBox=q.getContentBox(d);this._layoutChildren()},_layoutChildren:function(){this._checkIfSingleChild();if(this._singleChild&&this._singleChild.resize){var a=this._contentBox||q.getContentBox(this.containerNode);this._singleChild.resize({w:a.w,h:a.h})}else for(var a=this.getChildren(),b,c=0;b=a[c++];)b.resize&&b.resize()},_isShown:function(){if(this._childOfLayoutWidget)return this._resizeCalled&&
"open"in this?this.open:this._resizeCalled;if("open"in this)return this.open;var a=this.domNode,b=this.domNode.parentNode;return"none"!=a.style.display&&"hidden"!=a.style.visibility&&!p.contains(a,"dijitHidden")&&b&&b.style&&"none"!=b.style.display},_onShow:function(){this._wasShown=!0;this._needLayout&&this._layout(this._changeSize,this._resultSize);this.inherited(arguments)}})})},"dijit/layout/utils":function(){define(["dojo/_base/array","dojo/dom-class","dojo/dom-geometry","dojo/dom-style","dojo/_base/lang"],
function(k,e,p,q,n){function l(d){return d.substring(0,1).toUpperCase()+d.substring(1)}function h(d,c){var a=d.resize?d.resize(c):p.setMarginBox(d.domNode,c);a?n.mixin(d,a):(n.mixin(d,p.getMarginBox(d.domNode)),n.mixin(d,c))}var f={marginBox2contentBox:function(d,c){var a=q.getComputedStyle(d),b=p.getMarginExtents(d,a),g=p.getPadBorderExtents(d,a);return{l:q.toPixelValue(d,a.paddingLeft),t:q.toPixelValue(d,a.paddingTop),w:c.w-(b.w+g.w),h:c.h-(b.h+g.h)}},layoutChildren:function(d,c,a,b,g){c=n.mixin({},
c);e.add(d,"dijitLayoutContainer");a=k.filter(a,function(a){return"center"!=a.region&&"client"!=a.layoutAlign}).concat(k.filter(a,function(a){return"center"==a.region||"client"==a.layoutAlign}));k.forEach(a,function(a){var d=a.domNode,f=a.region||a.layoutAlign;if(!f)throw Error("No region setting for "+a.id);var n=d.style;n.left=c.l+"px";n.top=c.t+"px";n.position="absolute";e.add(d,"dijitAlign"+l(f));d={};b&&b==a.id&&(d["top"==a.region||"bottom"==a.region?"h":"w"]=g);"leading"==f&&(f=a.isLeftToRight()?
"left":"right");"trailing"==f&&(f=a.isLeftToRight()?"right":"left");"top"==f||"bottom"==f?(d.w=c.w,h(a,d),c.h-=a.h,"top"==f?c.t+=a.h:n.top=c.t+c.h+"px"):"left"==f||"right"==f?(d.h=c.h,h(a,d),c.w-=a.w,"left"==f?c.l+=a.w:n.left=c.l+c.w+"px"):"client"!=f&&"center"!=f||h(a,c)})}};n.setObject("dijit.layout.utils",f);return f})},"dojo/html":function(){define("./_base/kernel ./_base/lang ./_base/array ./_base/declare ./dom ./dom-construct ./parser".split(" "),function(k,e,p,q,n,l,h){var f=0,d={_secureForInnerHtml:function(c){return c.replace(/(?:\s*<!DOCTYPE\s[^>]+>|<title[^>]*>[\s\S]*?<\/title>)/ig,
"")},_emptyNode:l.empty,_setNodeContent:function(c,a){l.empty(c);if(a)if("number"==typeof a&&(a=a.toString()),"string"==typeof a&&(a=l.toDom(a,c.ownerDocument)),!a.nodeType&&e.isArrayLike(a))for(var b=a.length,d=0;d<a.length;d=b==a.length?d+1:0)l.place(a[d],c,"last");else l.place(a,c,"last");return c},_ContentSetter:q("dojo.html._ContentSetter",null,{node:"",content:"",id:"",cleanContent:!1,extractContent:!1,parseContent:!1,parserScope:k._scopeName,startup:!0,constructor:function(c,a){e.mixin(this,
c||{});a=this.node=n.byId(this.node||a);this.id||(this.id=["Setter",a?a.id||a.tagName:"",f++].join("_"))},set:function(c,a){void 0!==c&&(this.content=c);"number"==typeof c&&(c=c.toString());a&&this._mixin(a);this.onBegin();this.setContent();return(c=this.onEnd())&&c.then?c:this.node},setContent:function(){var c=this.node;if(!c)throw Error(this.declaredClass+": setContent given no node");try{c=d._setNodeContent(c,this.content)}catch(b){var a=this.onContentError(b);try{c.innerHTML=a}catch(g){console.error("Fatal "+
this.declaredClass+".setContent could not change content due to "+g.message,g)}}this.node=c},empty:function(){this.parseDeferred&&(this.parseDeferred.isResolved()||this.parseDeferred.cancel(),delete this.parseDeferred);this.parseResults&&this.parseResults.length&&(p.forEach(this.parseResults,function(c){c.destroy&&c.destroy()}),delete this.parseResults);l.empty(this.node)},onBegin:function(){var c=this.content;if(e.isString(c)&&(this.cleanContent&&(c=d._secureForInnerHtml(c)),this.extractContent)){var a=
c.match(/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im);a&&(c=a[1])}this.empty();this.content=c;return this.node},onEnd:function(){this.parseContent&&this._parse();return this.node},tearDown:function(){delete this.parseResults;delete this.parseDeferred;delete this.node;delete this.content},onContentError:function(c){return"Error occurred setting content: "+c},onExecError:function(c){return"Error occurred executing scripts: "+c},_mixin:function(c){var a={},b;for(b in c)b in a||(this[b]=c[b])},_parse:function(){var c=
this.node;try{var a={};p.forEach(["dir","lang","textDir"],function(b){this[b]&&(a[b]=this[b])},this);var b=this;this.parseDeferred=h.parse({rootNode:c,noStart:!this.startup,inherited:a,scope:this.parserScope}).then(function(a){return b.parseResults=a},function(a){b._onError("Content",a,"Error parsing in _ContentSetter#"+this.id)})}catch(g){this._onError("Content",g,"Error parsing in _ContentSetter#"+this.id)}},_onError:function(c,a,b){c=this["on"+c+"Error"].call(this,a);b?console.error(b,a):c&&d._setNodeContent(this.node,
c,!0)}}),set:function(c,a,b){void 0==a&&(console.warn("dojo.html.set: no cont argument provided, using empty string"),a="");"number"==typeof a&&(a=a.toString());return b?(new d._ContentSetter(e.mixin(b,{content:a,node:c}))).set():d._setNodeContent(c,a,!0)}};e.setObject("dojo.html",d);return d})},"esri/Credential":function(){define(["dojo/_base/declare","dojo/has","./kernel","./IdentityManagerBase"],function(k,e,p,q){return k(q.Credential,{})})},"esri/IdentityManagerBase":function(){define("dojo/_base/declare dojo/_base/config dojo/_base/lang dojo/_base/array dojo/_base/Deferred dojo/_base/json dojo/_base/url dojo/sniff dojo/cookie dojo/io-query dojo/regexp ./kernel ./config ./lang ./ServerInfo ./urlUtils ./deferredUtils ./request ./Evented ./OAuthCredential ./arcgis/OAuthInfo".split(" "),
function(k,e,p,q,n,l,h,f,d,c,a,b,g,u,m,r,t,v,y,w,z){var x={},A=function(a){var b=(new h(a.owningSystemUrl)).host;a=(new h(a.server)).host;var c=/.+\.arcgis\.com$/i;return c.test(b)&&c.test(a)},C=function(a,b){return!!(A(a)&&b&&q.some(b,function(b){return b.test(a.server)}))},B,E=k(y,{declaredClass:"esri.IdentityManagerBase",constructor:function(){this._portalConfig=p.getObject("esriGeowConfig");this.serverInfos=[];this.oAuthInfos=[];this.credentials=[];this._soReqs=[];this._xoReqs=[];this._portals=
[];this._getOAuthHash()},defaultOAuthInfo:null,defaultTokenValidity:60,tokenValidity:null,signInPage:null,useSignInPage:!0,normalizeWebTierAuth:!1,_busy:null,_oAuthHash:null,_gwTokenUrl:"/sharing/generateToken",_agsRest:"/rest/services",_agsPortal:/\/sharing(\/|$)/i,_agsAdmin:/https?:\/\/[^\/]+\/[^\/]+\/admin\/?(\/.*)?$/i,_adminSvcs:/\/admin\/services(\/|$)/i,_agolSuffix:".arcgis.com",_gwDomains:[{regex:/https?:\/\/www\.arcgis\.com/i,tokenServiceUrl:"https://www.arcgis.com/sharing/generateToken"},
{regex:/https?:\/\/dev\.arcgis\.com/i,tokenServiceUrl:"https://dev.arcgis.com/sharing/generateToken"},{regex:/https?:\/\/.*dev[^.]*\.arcgis\.com/i,tokenServiceUrl:"https://devext.arcgis.com/sharing/generateToken"},{regex:/https?:\/\/.*qa[^.]*\.arcgis\.com/i,tokenServiceUrl:"https://qaext.arcgis.com/sharing/generateToken"},{regex:/https?:\/\/.*.arcgis\.com/i,tokenServiceUrl:"https://www.arcgis.com/sharing/generateToken"}],_legacyFed:[],_regexSDirUrl:/http.+\/rest\/services\/?/ig,_regexServerType:/(\/(MapServer|GeocodeServer|GPServer|GeometryServer|ImageServer|NAServer|FeatureServer|GeoDataServer|GlobeServer|MobileServer|GeoenrichmentServer|VectorTileServer)).*/ig,
_gwUser:/http.+\/users\/([^\/]+)\/?.*/i,_gwItem:/http.+\/items\/([^\/]+)\/?.*/i,_gwGroup:/http.+\/groups\/([^\/]+)\/?.*/i,_errorCodes:[499,498,403,401],_rePortalTokenSvc:/\/sharing(\/rest)?\/generatetoken/i,_publicUrls:[/\/arcgis\/tokens/i,/\/sharing(\/rest)?\/generatetoken/i,/\/rest\/info/i],_createDefaultOAuthInfo:!0,_hasTestedIfAppIsOnPortal:!1,registerServers:function(a){var b=this.serverInfos;b?(a=q.filter(a,function(a){return!this.findServerInfo(a.server)},this),this.serverInfos=b.concat(a)):
this.serverInfos=a;q.forEach(a,function(a){a.owningSystemUrl&&this._portals.push(a.owningSystemUrl);if(a.hasPortal){this._portals.push(a.server);var b=g.defaults.io.corsEnabledServers,c=this._getOrigin(a.tokenServiceUrl);r.canUseXhr(a.server)||b.push(a.server.replace(/^https?:\/\//i,""));r.canUseXhr(c)||b.push(c.replace(/^https?:\/\//i,""))}},this)},registerOAuthInfos:function(a){var b=this.oAuthInfos;b?(a=q.filter(a,function(a){return!this.findOAuthInfo(a.portalUrl)},this),this.oAuthInfos=b.concat(a)):
this.oAuthInfos=a},registerToken:function(a){var b=this._sanitizeUrl(a.server),c=this.findServerInfo(b),d=!0,g;c||(c=new m,c.server=this._getServerInstanceRoot(b),c.tokenServiceUrl=this._getTokenSvcUrl(b),c.hasPortal=!0,this.registerServers([c]));(g=this.findCredential(b,a.userId))?(p.mixin(g,a),d=!1):(g=new B({userId:a.userId,server:c.server,token:a.token,expires:a.expires,ssl:a.ssl,scope:this._isServerRsrc(b)?"server":"portal"}),g.resources=[b],this.credentials.push(g));g.onTokenChange(!1);d||g.refreshServerTokens()},
toJson:function(){return u.fixJson({serverInfos:q.map(this.serverInfos,function(a){return a.toJson()}),oAuthInfos:q.map(this.oAuthInfos,function(a){return a.toJson()}),credentials:q.map(this.credentials,function(a){return a.toJson()})})},initialize:function(a){if(a){p.isString(a)&&(a=l.fromJson(a));var b=a.serverInfos,c=a.oAuthInfos;a=a.credentials;if(b){var d=[];q.forEach(b,function(a){a.server&&a.tokenServiceUrl&&d.push(a.declaredClass?a:new m(a))});d.length&&this.registerServers(d)}if(c){var g=
[];q.forEach(c,function(a){a.appId&&g.push(a.declaredClass?a:new z(a))});g.length&&this.registerOAuthInfos(g)}a&&q.forEach(a,function(a){a.userId&&a.server&&a.token&&a.expires&&a.expires>(new Date).getTime()&&(a=a.declaredClass?a:new B(a),a.onTokenChange(),this.credentials.push(a))},this)}},findServerInfo:function(a){var b;a=this._sanitizeUrl(a);q.some(this.serverInfos,function(c){this._hasSameServerInstance(c.server,a)&&(b=c);return!!b},this);return b},findOAuthInfo:function(a){var b;a=this._sanitizeUrl(a);
q.some(this.oAuthInfos,function(c){this._hasSameServerInstance(c.portalUrl,a)&&(b=c);return!!b},this);return b},findCredential:function(a,b){var c,d;a=this._sanitizeUrl(a);d=this._isServerRsrc(a)?"server":"portal";b?q.some(this.credentials,function(g){this._hasSameServerInstance(g.server,a)&&b===g.userId&&g.scope===d&&(c=g);return!!c},this):q.some(this.credentials,function(b){this._hasSameServerInstance(b.server,a)&&-1!==this._getIdenticalSvcIdx(a,b)&&b.scope===d&&(c=b);return!!c},this);return c},
getCredential:function(a,b){var c,g,f=!0;u.isDefined(b)&&(p.isObject(b)?(c=!!b.token,g=b.error,f=!1!==b.prompt):c=b);a=this._sanitizeUrl(a);var h=new n(t._dfdCanceller),l=this._isAdminResource(a),r=c&&this._doPortalSignIn(a)?this._getEsriAuthCookie():null;if((c=c?this.findCredential(a):null)&&g&&498===g.code)c.destroy(),r&&r.token===b.token&&d("esri_auth",null,{expires:-1,path:"/",domain:document.domain});else if(r||c)return a=Error("You are currently signed in as: '"+(r&&r.email||c&&c.userId)+"'. You do not have access to this resource: "+
a),a.code="IdentityManagerBase.1",a.httpCode=g&&g.httpCode,a.messageCode=g?g.messageCode:null,a.subcode=g?g.subcode:null,a.details=g?g.details:null,a.log=!!e.isDebug,h.errback(a),h;if(g=this._findCredential(a,b))return h.callback(g),h;g=this.findServerInfo(a);if(g)!g.hasServer&&this._isServerRsrc(a)&&(g._restInfoDfd=this._getTokenSvcUrl(a,!0),g.hasServer=!0);else{r=this._getTokenSvcUrl(a);if(!r)return a=Error("Unknown resource - could not find token service endpoint."),a.code="IdentityManagerBase.2",
a.log=!!e.isDebug,h.errback(a),h;g=new m;g.server=this._getServerInstanceRoot(a);p.isString(r)?(g.tokenServiceUrl=r,g.hasPortal=!0):(g._restInfoDfd=r,g.hasServer=!0);this.registerServers([g])}f&&g.hasPortal&&void 0===g._selfReq&&!this._findOAuthInfo(a)&&(g._selfReq={owningTenant:b&&b.owningTenant,selfDfd:this._getPortalSelf(g.tokenServiceUrl.replace(this._rePortalTokenSvc,"/sharing/rest/portals/self"),a)});return this._enqueue(a,g,b,h,l)},getResourceName:function(a){return this._isRESTService(a)?
a.replace(this._regexSDirUrl,"").replace(this._regexServerType,"")||"":this._gwUser.test(a)&&a.replace(this._gwUser,"$1")||this._gwItem.test(a)&&a.replace(this._gwItem,"$1")||this._gwGroup.test(a)&&a.replace(this._gwGroup,"$1")||""},generateToken:function(a,c,d){var g,f,m,l,n,t,k=this._rePortalTokenSvc.test(a.tokenServiceUrl),u=new h(window.location.href.toLowerCase()),w=this._getEsriAuthCookie(),q,z=!c;l=a.shortLivedTokenValidity;var y;c&&(y=b.id.tokenValidity||l||b.id.defaultTokenValidity,y>l&&
(y=l));d&&(g=d.isAdmin,f=d.serverUrl,m=d.token,t=d.ssl,a.customParameters=d.customParameters);g?l=a.adminTokenServiceUrl:(l=a.tokenServiceUrl,n=new h(l.toLowerCase()),w&&(q=(q=w.auth_tier)&&q.toLowerCase()),("web"===q||a.webTierAuth)&&d&&d.serverUrl&&!t&&"http"===u.scheme&&(r.hasSameOrigin(u.uri,l,!0)||"https"===n.scheme&&u.host===n.host&&"7080"===u.port&&"7443"===n.port)&&(l=l.replace(/^https:/i,"http:").replace(/:7443/i,":7080")),z&&k&&(l=l.replace(/\/rest/i,"")));g=p.mixin({url:l,content:p.mixin({request:"getToken",
username:c&&c.username,password:c&&c.password,serverUrl:f,token:m,expiration:y,referer:g||k?window.location.host:null,client:g?"referer":null,f:"json"},a.customParameters),handleAs:"json",callbackParamName:z?"callback":void 0},d&&d.ioArgs);d={usePost:!z,disableIdentityLookup:!0,useProxy:this._useProxy(a,d)};k||(g.withCredentials=!1);k=v(g,d);k.addCallback(function(b){if(!b||!b.token)return b=Error("Unable to generate token"),b.code="IdentityManagerBase.3",b.log=!!e.isDebug,b;var d=a.server;x[d]||
(x[d]={});c&&(x[d][c.username]=c.password);b.validity=y;return b});k.addErrback(function(a){});return k},isBusy:function(){return!!this._busy},checkSignInStatus:function(a){var b=new n;this.getCredential(a,{prompt:!1}).then(function(a){return a.token?v({url:a.server+("portal"===a.scope?"/sharing/rest":"/rest/services"),content:{f:"json",token:a.token},callbackParamName:"callback"},{disableIdentityLookup:!0}).then(function(){return a}).otherwise(function(b){if(498===b.code)throw a.destroy(),b=Error("User is not signed in."),
b.code="IdentityManagerBase.6",b.log=!!e.isDebug,b;return a}):a}).then(function(a){b.resolve(a)}).otherwise(function(a){b.reject(a)});return b},setRedirectionHandler:function(a){this._redirectFunc=a},setProtocolErrorHandler:function(a){this._protocolFunc=a},signIn:function(){},oAuthSignIn:function(){},onCredentialCreate:function(){},onCredentialsDestroy:function(){},destroyCredentials:function(){if(this.credentials){var a=this.credentials.slice();q.forEach(a,function(a){a.destroy()})}this.onCredentialsDestroy()},
_getOAuthHash:function(){var a=window.location.hash;if(a){"#"===a.charAt(0)&&(a=a.substring(1));var a=c.queryToObject(a),b=!1;a.access_token&&a.expires_in&&a.state&&a.hasOwnProperty("username")?(a.state=l.fromJson(a.state),this._oAuthHash=a,b=!0):a.error&&a.error_description&&(console.log("IdentityManager OAuth Error: ",a.error," - ",a.error_description),"access_denied"===a.error&&(b=!0));b&&(!f("ie")||8<f("ie"))&&(window.location.hash="")}},_findCredential:function(a,b){var c=-1,d,g,f,m=b&&b.token;
b=b&&b.resource;var e=this._isServerRsrc(a)?"server":"portal",h=q.filter(this.credentials,function(b){return this._hasSameServerInstance(b.server,a)&&b.scope===e},this);a=b||a;if(h.length)if(1===h.length)if(b=h[0],g=(d=(f=this.findServerInfo(b.server))&&f.owningSystemUrl)&&this.findCredential(d,b.userId),c=this._getIdenticalSvcIdx(a,b),m)-1!==c&&(b.resources.splice(c,1),this._removeResource(a,g));else return-1===c&&b.resources.push(a),this._addResource(a,g),b;else{var l,r;q.some(h,function(b){r=this._getIdenticalSvcIdx(a,
b);return-1!==r?(l=b,g=(d=(f=this.findServerInfo(l.server))&&f.owningSystemUrl)&&this.findCredential(d,l.userId),c=r,!0):!1},this);if(m)l&&(l.resources.splice(c,1),this._removeResource(a,g));else if(l)return this._addResource(a,g),l}},_findOAuthInfo:function(a){var b=this.findOAuthInfo(a);b||q.some(this.oAuthInfos,function(c){this._isIdProvider(c.portalUrl,a)&&(b=c);return!!b},this);return b},_addResource:function(a,b){b&&-1===this._getIdenticalSvcIdx(a,b)&&b.resources.push(a)},_removeResource:function(a,
b){var c=-1;b&&(c=this._getIdenticalSvcIdx(a,b),-1<c&&b.resources.splice(c,1))},_useProxy:function(a,b){return b&&b.isAdmin&&!r.hasSameOrigin(a.adminTokenServiceUrl,window.location.href)||!this._isPortalDomain(a.tokenServiceUrl)&&10.1==a.currentVersion&&!r.hasSameOrigin(a.tokenServiceUrl,window.location.href)},_getOrigin:function(a){a=new h(a);return a.scheme+"://"+a.host+(u.isDefined(a.port)?":"+a.port:"")},_getServerInstanceRoot:function(a){var b=a.toLowerCase(),c=b.indexOf(this._agsRest);-1===
c&&this._isAdminResource(a)&&(c=b.indexOf("/admin"));-1===c&&(c=b.indexOf("/sharing"));-1===c&&"/"===b.substr(-1)&&(c=b.length-1);return-1<c?a.substring(0,c):a},_hasSameServerInstance:function(a,b){"/"===a.substr(-1)&&(a=a.slice(0,-1));a=a.toLowerCase();b=this._getServerInstanceRoot(b).toLowerCase();a=a.substr(a.indexOf(":"));b=b.substr(b.indexOf(":"));return a===b},_sanitizeUrl:function(a){a=r.fixUrl(p.trim(a));var b=(g.defaults.io.proxyUrl||"").toLowerCase(),c=b?a.toLowerCase().indexOf(b+"?"):-1;
-1!==c&&(a=a.substring(c+b.length+1));return r.urlToObject(a).path},_isRESTService:function(a){return-1<a.indexOf(this._agsRest)},_isAdminResource:function(a){return this._agsAdmin.test(a)||this._adminSvcs.test(a)},_isServerRsrc:function(a){return this._isRESTService(a)||this._isAdminResource(a)},_isIdenticalService:function(a,b){var c;this._isRESTService(a)&&this._isRESTService(b)?(a=this._getSuffix(a).toLowerCase(),b=this._getSuffix(b).toLowerCase(),c=a===b,c||(c=/(.*)\/(MapServer|FeatureServer).*/ig,
c=a.replace(c,"$1")===b.replace(c,"$1"))):this._isAdminResource(a)&&this._isAdminResource(b)?c=!0:this._isServerRsrc(a)||this._isServerRsrc(b)||!this._isPortalDomain(a)||(c=!0);return c},_isPortalDomain:function(a){a=a.toLowerCase();var b=(new h(a)).authority,c=this._portalConfig,d=-1!==b.indexOf(this._agolSuffix);!d&&c&&(d=this._hasSameServerInstance(this._getServerInstanceRoot(c.restBaseUrl),a));d||(!this._arcgisUrl&&(c=p.getObject("esri.arcgis.utils.arcgisUrl"))&&(this._arcgisUrl=(new h(c)).authority),
this._arcgisUrl&&(d=this._arcgisUrl.toLowerCase()===b));d||(d=q.some(this._portals,function(b){return this._hasSameServerInstance(b,a)},this));return d=d||this._agsPortal.test(a)},_isIdProvider:function(a,b){var c=-1,d=-1;q.forEach(this._gwDomains,function(g,f){-1===c&&g.regex.test(a)&&(c=f);-1===d&&g.regex.test(b)&&(d=f)});var g=!1;if(-1<c&&-1<d)if(0===c||4===c){if(0===d||4===d)g=!0}else if(1===c){if(1===d||2===d)g=!0}else 2===c?2===d&&(g=!0):3===c&&3===d&&(g=!0);if(!g){var f=this.findServerInfo(b),
m=f&&f.owningSystemUrl;m&&A(f)&&this._isPortalDomain(m)&&this._isIdProvider(a,m)&&(g=!0)}return g},_isPublic:function(a){a=this._sanitizeUrl(a);return q.some(this._publicUrls,function(b){return b.test(a)})},_getIdenticalSvcIdx:function(a,b){var c=-1;q.some(b.resources,function(b,d){return this._isIdenticalService(a,b)?(c=d,!0):!1},this);return c},_getSuffix:function(a){return a.replace(this._regexSDirUrl,"").replace(this._regexServerType,"$1")},_getTokenSvcUrl:function(a){var b,c;if((b=this._isRESTService(a))||
this._isAdminResource(a))return c=a.toLowerCase().indexOf(b?this._agsRest:"/admin/"),b=a.substring(0,c)+"/admin/generateToken",a=a.substring(0,c)+"/rest/info",c=v({url:a,content:{f:"json"},handleAs:"json",callbackParamName:"callback"}),c.adminUrl_=b,c;if(this._isPortalDomain(a)){var d="";q.some(this._gwDomains,function(b){b.regex.test(a)&&(d=b.tokenServiceUrl);return!!d});d||q.some(this._portals,function(b){this._hasSameServerInstance(b,a)&&(d=b+this._gwTokenUrl);return!!d},this);d||(c=a.toLowerCase().indexOf("/sharing"),
-1!==c&&(d=a.substring(0,c)+this._gwTokenUrl));d||(d=this._getOrigin(a)+this._gwTokenUrl);d&&(b=(new h(a)).port,/^http:\/\//i.test(a)&&"7080"===b&&(d=d.replace(/:7080/i,":7443")),d=d.replace(/http:/i,"https:"));return d}if(-1!==a.toLowerCase().indexOf("premium.arcgisonline.com"))return"https://premium.arcgisonline.com/server/tokens"},_getPortalSelf:function(a,b){"https:"===window.location.protocol?a=a.replace(/^http:/i,"https:").replace(/:7080/i,":7443"):/^http:/i.test(b)&&(a=a.replace(/^https:/i,
"http:").replace(/:7443/i,":7080"));return v({url:a,content:{f:"json"},handleAs:"json",callbackParamName:"callback"},{crossOrigin:!1,disableIdentityLookup:!0})},_hasPortalSession:function(){return!!this._getEsriAuthCookie()},_getEsriAuthCookie:function(){var a=null;if(d.isSupported()){var b=this._getAllCookies("esri_auth"),c;for(c=0;c<b.length;c++){var g=l.fromJson(b[c]);if(g.portalApp){a=g;break}}}a&&(b=null,a.expires&&("number"===typeof a.expires?b=a.expires:"string"===typeof a.expires&&(b=Date.parse(a.expires)),
isNaN(b)&&(b=null),a.expires=b),b&&b<(new Date).getTime()&&(a=null));return a},_getAllCookies:function(b){var c=[],d=document.cookie.match(new RegExp("(?:^|; )"+a.escapeString(b)+"\x3d([^;]*)","g"));if(d)for(b=0;b<d.length;b++){var g=d[b],f=g.indexOf("\x3d");-1<f&&(g=g.substring(f+1),c.push(decodeURIComponent(g)))}return c},_doPortalSignIn:function(a){if(d.isSupported()){var b=this._getEsriAuthCookie(),c=this._portalConfig,g=window.location.href,f=this.findServerInfo(a);if(this.useSignInPage&&(c||
this._isPortalDomain(g)||b)&&(f?f.hasPortal||f.owningSystemUrl&&this._isPortalDomain(f.owningSystemUrl):this._isPortalDomain(a))&&(this._isIdProvider(g,a)||c&&(this._hasSameServerInstance(this._getServerInstanceRoot(c.restBaseUrl),a)||this._isIdProvider(c.restBaseUrl,a))||r.hasSameOrigin(g,a,!0)))return!0}return!1},_checkProtocol:function(a,b,c,d){var f=!0;d=d?b.adminTokenServiceUrl:b.tokenServiceUrl;0!==p.trim(d).toLowerCase().indexOf("https:")||0===window.location.href.toLowerCase().indexOf("https:")||
g.defaults.io.useCors&&(r.canUseXhr(d)||r.canUseXhr(r.getProxyUrl(!0).path))||(f=this._protocolFunc?!!this._protocolFunc({resourceUrl:a,serverInfo:b}):!1,f||(a=Error("Aborted the Sign-In process to avoid sending password over insecure connection."),a.code="IdentityManagerBase.4",a.log=!!e.isDebug,console.log(a.message),c(a)));return f},_enqueue:function(a,b,c,d,g,f){d||(d=new n(t._dfdCanceller));d.resUrl_=a;d.sinfo_=b;d.options_=c;d.admin_=g;d.refresh_=f;this._busy?this._hasSameServerInstance(this._getServerInstanceRoot(a),
this._busy.resUrl_)?(this._oAuthDfd&&this._oAuthDfd.oAuthWin_&&this._oAuthDfd.oAuthWin_.focus(),this._soReqs.push(d)):this._xoReqs.push(d):this._doSignIn(d);return d},_doSignIn:function(a){this._busy=a;var b=this,c=function(c){var d=a.options_&&a.options_.resource,g=a.resUrl_,f=a.refresh_,m=!1;-1===q.indexOf(b.credentials,c)&&(f&&-1!==q.indexOf(b.credentials,f)?(f.userId=c.userId,f.token=c.token,f.expires=c.expires,f.validity=c.validity,f.ssl=c.ssl,f.creationTime=c.creationTime,m=!0,c=f):b.credentials.push(c));
c.resources||(c.resources=[]);c.resources.push(d||g);c.scope=b._isServerRsrc(g)?"server":"portal";c.onTokenChange();var d=b._soReqs,e={};b._soReqs=[];q.forEach(d,function(a){if(!this._isIdenticalService(g,a.resUrl_)){var b=this._getSuffix(a.resUrl_);e[b]||(e[b]=!0,c.resources.push(a.resUrl_))}},b);a.callback(c);q.forEach(d,function(a){this._hasSameServerInstance(this._getServerInstanceRoot(g),a.resUrl_)?a.callback(c):this._soReqs.push(a)},b);b._busy=a.resUrl_=a.sinfo_=a.refresh_=null;if(!m)b.onCredentialCreate({credential:c});
b._soReqs.length?b._doSignIn(b._soReqs.shift()):b._xoReqs.length&&b._doSignIn(b._xoReqs.shift())},d=function(c){a.errback(c);b._busy=a.resUrl_=a.sinfo_=a.refresh_=null;b._soReqs.length?b._doSignIn(b._soReqs.shift()):b._xoReqs.length&&b._doSignIn(b._xoReqs.shift())},g=function(g,f,m,h){var l=a.sinfo_,r=!a.options_||!1!==a.options_.prompt,n=l.hasPortal&&b._findOAuthInfo(a.resUrl_);b._doPortalSignIn(a.resUrl_)?(g=b._getEsriAuthCookie(),n=b._portalConfig,g?c(new B({userId:g.email,server:l.server,token:g.token,
expires:g.expires})):r?(r="",g=window.location.href,r=b.signInPage?b.signInPage:n?n.baseUrl+n.signin:b._isIdProvider(g,a.resUrl_)?b._getOrigin(g)+"/home/signin.html":l.tokenServiceUrl.replace(b._rePortalTokenSvc,"")+"/home/signin.html",r=r.replace(/http:/i,"https:"),n&&!1===n.useSSL&&(r=r.replace(/https:/i,"http:")),0===g.toLowerCase().replace("https","http").indexOf(r.toLowerCase().replace("https","http"))?(l=Error("Cannot redirect to Sign-In page from within Sign-In page. URL of the resource that triggered this workflow: "+
a.resUrl_),l.code="IdentityManagerBase.5",l.log=!!e.isDebug,d(l)):b._redirectFunc?b._redirectFunc({signInPage:r,returnUrlParamName:"returnUrl",returnUrl:g,resourceUrl:a.resUrl_,serverInfo:l}):window.location=r+"?returnUrl\x3d"+window.escape(g)):(l=Error("User is not signed in."),l.code="IdentityManagerBase.6",l.log=!!e.isDebug,d(l))):g?c(new B({userId:g,server:l.server,token:m,expires:u.isDefined(h)?Number(h):null,ssl:!!f})):n?(g=n._oAuthCred,g||(f=new w(n,window.localStorage),m=new w(n,window.sessionStorage),
f.isValid()&&m.isValid()?f.expires>m.expires?(g=f,m.destroy()):(g=m,f.destroy()):g=f.isValid()?f:m,n._oAuthCred=g),g.isValid()?c(new B({userId:g.userId,server:l.server,token:g.token,expires:g.expires,ssl:g.ssl,_oAuthCred:g})):b._oAuthHash&&b._oAuthHash.state.portalUrl===n.portalUrl?(r=b._oAuthHash,l=new B({userId:r.username,server:l.server,token:r.access_token,expires:(new Date).getTime()+1E3*Number(r.expires_in),ssl:"true"===r.ssl,oAuthState:r.state,_oAuthCred:g}),g.storage=r.persist?window.localStorage:
window.sessionStorage,g.token=l.token,g.expires=l.expires,g.userId=l.userId,g.ssl=l.ssl,g.save(),b._oAuthHash=null,c(l)):r?a._pendingDfd=b.oAuthSignIn(a.resUrl_,l,n,a.options_).addCallbacks(c,d):(l=Error("User is not signed in."),l.code="IdentityManagerBase.6",l.log=!!e.isDebug,d(l))):r?b._checkProtocol(a.resUrl_,l,d,a.admin_)&&(r=a.options_,a.admin_&&(r=r||{},r.isAdmin=!0),a._pendingDfd=b.signIn(a.resUrl_,l,r).addCallbacks(c,d)):(l=Error("User is not signed in."),l.code="IdentityManagerBase.6",l.log=
!!e.isDebug,d(l))},f=function(){var g=a.sinfo_,f=g.owningSystemUrl,m=a.options_,e,h,l,r;m&&(e=m.token,h=m.error,l=m.prompt);r=b._findCredential(f,{token:e,resource:a.resUrl_});!r&&A(g)&&q.some(b.credentials,function(a){this._isIdProvider(f,a.server)&&(r=a);return!!r},b);r?(m=b.findCredential(a.resUrl_,r.userId))?c(m):C(g,b._legacyFed)?(m=r.toJson(),m.server=g.server,m.resources=null,c(new B(m))):(a._pendingDfd=b.generateToken(b.findServerInfo(r.server),null,{serverUrl:a.resUrl_,token:r.token,ssl:r.ssl})).addCallbacks(function(b){c(new B({userId:r.userId,
server:g.server,token:b.token,expires:u.isDefined(b.expires)?Number(b.expires):null,ssl:!!b.ssl,isAdmin:a.admin_,validity:b.validity}))},d):(b._busy=null,e&&(a.options_.token=null),(a._pendingDfd=b.getCredential(f.replace(/\/?$/,"/sharing"),{resource:a.resUrl_,owningTenant:g.owningTenant,token:e,error:h,prompt:l})).addCallbacks(function(c){b._enqueue(a.resUrl_,a.sinfo_,a.options_,a,a.admin_)},function(a){d(a)}))},m=a.sinfo_.owningSystemUrl,h=this._isServerRsrc(a.resUrl_),l=a.sinfo_._restInfoDfd;l?
l.addCallbacks(function(c){var d=a.sinfo_;d.adminTokenServiceUrl=d._restInfoDfd.adminUrl_;d._restInfoDfd=null;d.tokenServiceUrl=p.getObject("authInfo.tokenServicesUrl",!1,c)||p.getObject("authInfo.tokenServiceUrl",!1,c)||p.getObject("tokenServiceUrl",!1,c);d.shortLivedTokenValidity=p.getObject("authInfo.shortLivedTokenValidity",!1,c);d.currentVersion=c.currentVersion;d.owningTenant=c.owningTenant;(c=d.owningSystemUrl=c.owningSystemUrl)&&b._portals.push(c);h&&c?f():g()},function(){a.sinfo_._restInfoDfd=
null;var b=Error("Unknown resource - could not find token service endpoint.");b.code="IdentityManagerBase.2";b.log=!!e.isDebug;d(b)}):h&&m?f():a.sinfo_._selfReq?a.sinfo_._selfReq.selfDfd.then(function(c){var d={},g,f,m,e;c&&(g=c.user&&c.user.username,d.username=g,d.allSSL=c.allSSL,f=c.supportsOAuth,m=c.currentVersion,"multitenant"===c.portalMode&&(e=c.customBaseUrl));a.sinfo_.webTierAuth=!!g;return g&&b.normalizeWebTierAuth?b.generateToken(a.sinfo_,null,{ssl:d.allSSL}).addBoth(function(a){d.portalToken=
a&&a.token;d.tokenExpiration=a&&a.expires;return d}):!g&&f&&4.4<=parseFloat(m)&&!b._doPortalSignIn(a.resUrl_)?b._generateOAuthInfo({portalUrl:a.sinfo_.server,customBaseUrl:e,owningTenant:a.sinfo_._selfReq.owningTenant}).always(function(){return d}):d}).always(function(b){a.sinfo_._selfReq=null;b?g(b.username,b.allSSL,b.portalToken,b.tokenExpiration):g()}):g()},_generateOAuthInfo:function(a){var b=this,c,d=a.portalUrl,g=a.customBaseUrl,f=a.owningTenant;if(a=!this.defaultOAuthInfo&&this._createDefaultOAuthInfo&&
!this._hasTestedIfAppIsOnPortal){c=window.location.href;var m=c.indexOf("?");-1<m&&(c=c.slice(0,m));m=c.search(/\/(apps|home)\//);c=-1<m?c.slice(0,m):null}a&&c?(this._hasTestedIfAppIsOnPortal=!0,a=v({url:c+"/sharing/rest",content:{f:"json"},handleAs:"json"}).then(function(){b.defaultOAuthInfo=new z({appId:"arcgisonline",popup:!0,popupCallbackUrl:c+"/home/oauth-callback.html"})})):(a=new n,a.resolve(),a=a.promise);return a.then(function(){if(b.defaultOAuthInfo)return d=d.replace(/^http:/i,"https:"),
v({url:d+"/sharing/rest/oauth2/validateRedirectUri",content:{accountId:f,client_id:b.defaultOAuthInfo.appId,redirect_uri:r.getAbsoluteUrl(b.defaultOAuthInfo.popupCallbackUrl),f:"json"},handleAs:"json",callbackParamName:"callback"}).then(function(a){if(a.valid){var c=b.defaultOAuthInfo.clone();c.portalUrl=a.urlKey&&g?"https://"+a.urlKey+"."+g:d;b.oAuthInfos.push(c)}})})}});B=k(y,{declaredClass:"esri.Credential",tokenRefreshBuffer:2,constructor:function(a){p.mixin(this,a);this.resources=this.resources||
[];u.isDefined(this.creationTime)||(this.creationTime=(new Date).getTime())},_oAuthCred:null,refreshToken:function(){var a=this,c=this.resources&&this.resources[0],d=b.id.findServerInfo(this.server),g=d&&d.owningSystemUrl,f=!!g&&"server"===this.scope,m=f&&C(d,b.id._legacyFed),e=f&&b.id.findServerInfo(g),h,l=(h=d.webTierAuth)&&b.id.normalizeWebTierAuth,r=x[this.server],r=r&&r[this.userId],n={username:this.userId,password:r},t;if(!h||l)if(f&&!e&&q.some(b.id.serverInfos,function(a){b.id._isIdProvider(g,
a.server)&&(e=a);return!!e}),h=e&&b.id.findCredential(e.server,this.userId),!f||h)if(m)h.refreshToken();else{if(f)t={serverUrl:c,token:h&&h.token,ssl:h&&h.ssl};else if(l)n=null,t={ssl:this.ssl};else if(r)this.isAdmin&&(t={isAdmin:!0});else{var k;c&&(c=b.id._sanitizeUrl(c),this._enqueued=1,k=b.id._enqueue(c,d,null,null,this.isAdmin,this),k.addCallback(function(){a._enqueued=0;a.refreshServerTokens()}).addErrback(function(){a._enqueued=0}));return k}return b.id.generateToken(f?e:d,f?null:n,t).addCallback(function(b){a.token=
b.token;a.expires=u.isDefined(b.expires)?Number(b.expires):null;a.creationTime=(new Date).getTime();a.validity=b.validity;a.onTokenChange();a.refreshServerTokens()}).addErrback(function(){})}},refreshServerTokens:function(){"portal"===this.scope&&q.forEach(b.id.credentials,function(a){var c=b.id.findServerInfo(a.server),d=c&&c.owningSystemUrl;a!==this&&a.userId===this.userId&&d&&"server"===a.scope&&(b.id._hasSameServerInstance(this.server,d)||b.id._isIdProvider(d,this.server))&&(C(c,b.id._legacyFed)?
(a.token=this.token,a.expires=this.expires,a.creationTime=this.creationTime,a.validity=this.validity,a.onTokenChange()):a.refreshToken())},this)},onTokenChange:function(a){clearTimeout(this._refreshTimer);var c=this.server&&b.id.findServerInfo(this.server),d=(c=c&&c.owningSystemUrl)&&b.id.findServerInfo(c);!1!==a&&(!c||"portal"===this.scope||d&&d.webTierAuth&&!b.id.normalizeWebTierAuth)&&(u.isDefined(this.expires)||u.isDefined(this.validity))&&this._startRefreshTimer()},onDestroy:function(){},destroy:function(){this.userId=
this.server=this.token=this.expires=this.validity=this.resources=this.creationTime=null;this._oAuthCred&&(this._oAuthCred.destroy(),this._oAuthCred=null);var a=q.indexOf(b.id.credentials,this);-1<a&&b.id.credentials.splice(a,1);this.onTokenChange();this.onDestroy()},toJson:function(){return this._toJson()},_toJson:function(){var a=u.fixJson({userId:this.userId,server:this.server,token:this.token,expires:this.expires,validity:this.validity,ssl:this.ssl,isAdmin:this.isAdmin,creationTime:this.creationTime,
scope:this.scope}),b=this.resources;b&&0<b.length&&(a.resources=b.slice());return a},_startRefreshTimer:function(){clearTimeout(this._refreshTimer);var a=6E4*this.tokenRefreshBuffer,b=(this.validity?this.creationTime+6E4*this.validity:this.expires)-(new Date).getTime();0>b&&(b=0);this._refreshTimer=setTimeout(p.hitch(this,this.refreshToken),b>a?b-a:b)}});E.Credential=B;return E})},"esri/ServerInfo":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","./kernel","./lang"],function(k,
e,p,q,n){return k(null,{declaredClass:"esri.ServerInfo",constructor:function(l){e.mixin(this,l)},toJson:function(){return n.fixJson({server:this.server,tokenServiceUrl:this.tokenServiceUrl,adminTokenServiceUrl:this.adminTokenServiceUrl,shortLivedTokenValidity:this.shortLivedTokenValidity,owningSystemUrl:this.owningSystemUrl,owningTenant:this.owningTenant,currentVersion:this.currentVersion,hasPortal:this.hasPortal,hasServer:this.hasServer,webTierAuth:this.webTierAuth})}})})},"esri/OAuthCredential":function(){define(["./kernel",
"dojo/_base/declare","dojo/has","dojo/json"],function(k,e,p,q){return e(null,{declaredClass:"esri.OAuthCredential",oAuthInfo:null,storage:null,expires:null,ssl:null,token:null,userId:null,constructor:function(e,l){this.oAuthInfo=e;this.storage=l;this._init()},isValid:function(){var e=!1;if(this.oAuthInfo&&this.token&&this.userId){var l=(new Date).getTime();this.expires>l&&(this.expires-l)/1E3>60*this.oAuthInfo.minTimeUntilExpiration&&(e=!0)}return e},save:function(){if(this.storage){var e=this._load(),
l=this.oAuthInfo;if(l&&l.authNamespace&&l.portalUrl){var h=e[l.authNamespace];h||(h=e[l.authNamespace]={});h[l.portalUrl]={expires:this.expires,ssl:this.ssl,token:this.token,userId:this.userId};try{this.storage.setItem("esriJSAPIOAuth",q.stringify(e))}catch(f){console.log(f)}}}},destroy:function(){var e=this._load(),l=this.oAuthInfo;if(l&&l.authNamespace&&l.portalUrl&&this.storage){var h=e[l.authNamespace];if(h){delete h[l.portalUrl];try{this.storage.setItem("esriJSAPIOAuth",q.stringify(e))}catch(f){console.log(f)}}}l&&
(this.oAuthInfo=l._oAuthCred=null)},_init:function(){var e=this._load(),l=this.oAuthInfo;l&&l.authNamespace&&l.portalUrl&&(e=e[l.authNamespace])&&(e=e[l.portalUrl])&&(this.expires=e.expires,this.ssl=e.ssl,this.token=e.token,this.userId=e.userId)},_load:function(){var e={};if(this.storage){var l=this.storage.getItem("esriJSAPIOAuth");if(l)try{e=q.parse(l)}catch(h){console.log(h)}}return e}})})},"esri/arcgis/OAuthInfo":function(){define(["../kernel","../lang","dojo/_base/declare","dojo/_base/lang",
"dojo/has"],function(k,e,p,q,n){var l=p(null,{declaredClass:"esri.arcgis.OAuthInfo",constructor:function(e){q.mixin(this,{expiration:20160,minTimeUntilExpiration:30,portalUrl:"https://www.arcgis.com",authNamespace:"/",forceLogin:!1,popup:!1,popupCallbackUrl:"oauth-callback.html",popupWindowFeatures:"height\x3d490,width\x3d800,resizable,scrollbars,status"},e)},_oAuthCred:null,toJson:function(){return e.fixJson({appId:this.appId,expiration:this.expiration,locale:this.locale,minTimeUntilExpiration:this.minTimeUntilExpiration,
portalUrl:this.portalUrl,authNamespace:this.authNamespace,forceLogin:this.forceLogin,popup:this.popup,popupCallbackUrl:this.popupCallbackUrl,popupWindowFeatures:this.popupWindowFeatures})},clone:function(){return new l(this.toJson())}});return l})},"dijit/form/Button":function(){define("require dojo/_base/declare dojo/dom-class dojo/has dojo/_base/kernel dojo/_base/lang dojo/ready ./_FormWidget ./_ButtonMixin dojo/text!./templates/Button.html ../a11yclick".split(" "),function(k,e,p,q,n,l,h,f,d,c){q("dijit-legacy-requires")&&
h(0,function(){k(["dijit/form/DropDownButton","dijit/form/ComboButton","dijit/form/ToggleButton"])});h=e("dijit.form.Button"+(q("dojo-bidi")?"_NoBidi":""),[f,d],{showLabel:!0,iconClass:"dijitNoIcon",_setIconClassAttr:{node:"iconNode",type:"class"},baseClass:"dijitButton",templateString:c,_setValueAttr:"valueNode",_setNameAttr:function(a){this.valueNode&&this.valueNode.setAttribute("name",a)},postCreate:function(){this.inherited(arguments);this._setLabelFromContainer()},_setLabelFromContainer:function(){this.containerNode&&
!this.label&&(this.label=l.trim(this.containerNode.innerHTML),this.onLabelSet())},_setShowLabelAttr:function(a){this.containerNode&&p.toggle(this.containerNode,"dijitDisplayNone",!a);this._set("showLabel",a)},setLabel:function(a){n.deprecated("dijit.form.Button.setLabel() is deprecated.  Use set('label', ...) instead.","","2.0");this.set("label",a)},onLabelSet:function(){this.inherited(arguments);this.showLabel||"title"in this.params||(this.titleNode.title=l.trim(this.containerNode.innerText||this.containerNode.textContent||
""))}});q("dojo-bidi")&&(h=e("dijit.form.Button",h,{onLabelSet:function(){this.inherited(arguments);this.titleNode.title&&this.applyTextDir(this.titleNode,this.titleNode.title)},_setTextDirAttr:function(a){this._created&&this.textDir!=a&&(this._set("textDir",a),this._setLabelAttr(this.label))}}));return h})},"dijit/form/_FormWidget":function(){define("dojo/_base/declare dojo/sniff dojo/_base/kernel dojo/ready ../_Widget ../_CssStateMixin ../_TemplatedMixin ./_FormWidgetMixin".split(" "),function(k,
e,p,q,n,l,h,f){e("dijit-legacy-requires")&&q(0,function(){require(["dijit/form/_FormValueWidget"])});return k("dijit.form._FormWidget",[n,h,l,f],{setDisabled:function(d){p.deprecated("setDisabled("+d+") is deprecated. Use set('disabled',"+d+") instead.","","2.0");this.set("disabled",d)},setValue:function(d){p.deprecated("dijit.form._FormWidget:setValue("+d+") is deprecated.  Use set('value',"+d+") instead.","","2.0");this.set("value",d)},getValue:function(){p.deprecated(this.declaredClass+"::getValue() is deprecated. Use get('value') instead.",
"","2.0");return this.get("value")},postMixInProperties:function(){this.nameAttrSetting=this.name&&!e("msapp")?'name\x3d"'+this.name.replace(/"/g,"\x26quot;")+'"':"";this.inherited(arguments)}})})},"dijit/form/_FormWidgetMixin":function(){define("dojo/_base/array dojo/_base/declare dojo/dom-attr dojo/dom-style dojo/_base/lang dojo/mouse dojo/on dojo/sniff dojo/window ../a11y".split(" "),function(k,e,p,q,n,l,h,f,d,c){return e("dijit.form._FormWidgetMixin",null,{name:"",alt:"",value:"",type:"text",
"aria-label":"focusNode",tabIndex:"0",_setTabIndexAttr:"focusNode",disabled:!1,intermediateChanges:!1,scrollOnFocus:!0,_setIdAttr:"focusNode",_setDisabledAttr:function(a){this._set("disabled",a);/^(button|input|select|textarea|optgroup|option|fieldset)$/i.test(this.focusNode.tagName)?p.set(this.focusNode,"disabled",a):this.focusNode.setAttribute("aria-disabled",a?"true":"false");this.valueNode&&p.set(this.valueNode,"disabled",a);a?(this._set("hovering",!1),this._set("active",!1),a="tabIndex"in this.attributeMap?
this.attributeMap.tabIndex:"_setTabIndexAttr"in this?this._setTabIndexAttr:"focusNode",k.forEach(n.isArray(a)?a:[a],function(a){a=this[a];f("webkit")||c.hasDefaultTabStop(a)?a.setAttribute("tabIndex","-1"):a.removeAttribute("tabIndex")},this)):""!=this.tabIndex&&this.set("tabIndex",this.tabIndex)},_onFocus:function(a){if("mouse"==a&&this.isFocusable())var b=this.own(h(this.focusNode,"focus",function(){e.remove();b.remove()}))[0],c=f("pointer-events")?"pointerup":f("MSPointer")?"MSPointerUp":f("touch-events")?
"touchend, mouseup":"mouseup",e=this.own(h(this.ownerDocumentBody,c,n.hitch(this,function(a){e.remove();b.remove();this.focused&&("touchend"==a.type?this.defer("focus"):this.focus())})))[0];this.scrollOnFocus&&this.defer(function(){d.scrollIntoView(this.domNode)});this.inherited(arguments)},isFocusable:function(){return!this.disabled&&this.focusNode&&"none"!=q.get(this.domNode,"display")},focus:function(){if(!this.disabled&&this.focusNode.focus)try{this.focusNode.focus()}catch(a){}},compare:function(a,
b){return"number"==typeof a&&"number"==typeof b?isNaN(a)&&isNaN(b)?0:a-b:a>b?1:a<b?-1:0},onChange:function(){},_onChangeActive:!1,_handleOnChange:function(a,b){void 0!=this._lastValueReported||null!==b&&this._onChangeActive||(this._resetValue=this._lastValueReported=a);this._pendingOnChange=this._pendingOnChange||typeof a!=typeof this._lastValueReported||0!=this.compare(a,this._lastValueReported);(this.intermediateChanges||b||void 0===b)&&this._pendingOnChange&&(this._lastValueReported=a,this._pendingOnChange=
!1,this._onChangeActive&&(this._onChangeHandle&&this._onChangeHandle.remove(),this._onChangeHandle=this.defer(function(){this._onChangeHandle=null;this.onChange(a)})))},create:function(){this.inherited(arguments);this._onChangeActive=!0},destroy:function(){this._onChangeHandle&&(this._onChangeHandle.remove(),this.onChange(this._lastValueReported));this.inherited(arguments)}})})},"dijit/form/_ButtonMixin":function(){define(["dojo/_base/declare","dojo/dom","dojo/has","../registry"],function(k,e,p,q){var n=
k("dijit.form._ButtonMixin"+(p("dojo-bidi")?"_NoBidi":""),null,{label:"",type:"button",__onClick:function(e){e.stopPropagation();e.preventDefault();this.disabled||this.valueNode.click(e);return!1},_onClick:function(e){if(this.disabled)return e.stopPropagation(),e.preventDefault(),!1;!1===this.onClick(e)&&e.preventDefault();var h=e.defaultPrevented;if(!h&&"submit"==this.type&&!(this.valueNode||this.focusNode).form)for(var f=this.domNode;f.parentNode;f=f.parentNode){var d=q.byNode(f);if(d&&"function"==
typeof d._onSubmit){d._onSubmit(e);e.preventDefault();h=!0;break}}return!h},postCreate:function(){this.inherited(arguments);e.setSelectable(this.focusNode,!1)},onClick:function(){return!0},_setLabelAttr:function(e){this._set("label",e);(this.containerNode||this.focusNode).innerHTML=e;this.onLabelSet()},onLabelSet:function(){}});p("dojo-bidi")&&(n=k("dijit.form._ButtonMixin",n,{onLabelSet:function(){this.inherited(arguments);this.applyTextDir(this.containerNode||this.focusNode)}}));return n})},"dijit/form/Form":function(){define("dojo/_base/declare dojo/dom-attr dojo/_base/kernel dojo/sniff ../_Widget ../_TemplatedMixin ./_FormMixin ../layout/_ContentPaneResizeMixin".split(" "),
function(k,e,p,q,n,l,h,f){return k("dijit.form.Form",[n,l,h,f],{name:"",action:"",method:"",encType:"","accept-charset":"",accept:"",target:"",templateString:"\x3cform data-dojo-attach-point\x3d'containerNode' data-dojo-attach-event\x3d'onreset:_onReset,onsubmit:_onSubmit' ${!nameAttrSetting}\x3e\x3c/form\x3e",postMixInProperties:function(){this.nameAttrSetting=this.name?"name\x3d'"+this.name+"'":"";this.inherited(arguments)},execute:function(){},onExecute:function(){},_setEncTypeAttr:function(d){e.set(this.domNode,
"encType",d);q("ie")&&(this.domNode.encoding=d);this._set("encType",d)},reset:function(d){var c={returnValue:!0,preventDefault:function(){this.returnValue=!1},stopPropagation:function(){},currentTarget:d?d.target:this.domNode,target:d?d.target:this.domNode};!1!==this.onReset(c)&&c.returnValue&&this.inherited(arguments,[])},onReset:function(){return!0},_onReset:function(d){this.reset(d);d.stopPropagation();d.preventDefault();return!1},_onSubmit:function(d){var c=this.constructor.prototype;if(this.execute!=
c.execute||this.onExecute!=c.onExecute)p.deprecated("dijit.form.Form:execute()/onExecute() are deprecated. Use onSubmit() instead.","","2.0"),this.onExecute(),this.execute(this.getValues());!1===this.onSubmit(d)&&(d.stopPropagation(),d.preventDefault())},onSubmit:function(){return this.isValid()},submit:function(){!1!==this.onSubmit()&&this.containerNode.submit()}})})},"dijit/form/ValidationTextBox":function(){define("dojo/_base/declare dojo/_base/kernel dojo/_base/lang dojo/i18n ./TextBox ../Tooltip dojo/text!./templates/ValidationTextBox.html dojo/i18n!./nls/validate".split(" "),
function(k,e,p,q,n,l,h){var f=k("dijit.form.ValidationTextBox",n,{templateString:h,required:!1,promptMessage:"",invalidMessage:"$_unset_$",missingMessage:"$_unset_$",message:"",constraints:{},pattern:".*",regExp:"",regExpGen:function(){},state:"",tooltipPosition:[],_deprecateRegExp:function(d,c){c!=f.prototype[d]&&(e.deprecated("ValidationTextBox id\x3d"+this.id+", set('"+d+"', ...) is deprecated.  Use set('pattern', ...) instead.","","2.0"),this.set("pattern",c))},_setRegExpGenAttr:function(d){this._deprecateRegExp("regExpGen",
d);this._set("regExpGen",this._computeRegexp)},_setRegExpAttr:function(d){this._deprecateRegExp("regExp",d)},_setValueAttr:function(){this.inherited(arguments);this._refreshState()},validator:function(d,c){return(new RegExp("^(?:"+this._computeRegexp(c)+")"+(this.required?"":"?")+"$")).test(d)&&(!this.required||!this._isEmpty(d))&&(this._isEmpty(d)||void 0!==this.parse(d,c))},_isValidSubset:function(){return 0==this.textbox.value.search(this._partialre)},isValid:function(){return this.validator(this.textbox.value,
this.get("constraints"))},_isEmpty:function(d){return(this.trim?/^\s*$/:/^$/).test(d)},getErrorMessage:function(){var d="$_unset_$"==this.invalidMessage?this.messages.invalidMessage:this.invalidMessage?this.invalidMessage:this.promptMessage,c="$_unset_$"==this.missingMessage?this.messages.missingMessage:this.missingMessage?this.missingMessage:d;return this.required&&this._isEmpty(this.textbox.value)?c:d},getPromptMessage:function(){return this.promptMessage},_maskValidSubsetError:!0,validate:function(d){var c=
"",a=this.disabled||this.isValid(d);a&&(this._maskValidSubsetError=!0);var b=this._isEmpty(this.textbox.value),g=!a&&d&&this._isValidSubset();this._set("state",a?"":((!this._hasBeenBlurred||d)&&b||g)&&(this._maskValidSubsetError||g&&!this._hasBeenBlurred&&d)?"Incomplete":"Error");this.focusNode.setAttribute("aria-invalid","Error"==this.state?"true":"false");"Error"==this.state?(this._maskValidSubsetError=d&&g,c=this.getErrorMessage(d)):"Incomplete"==this.state?(c=this.getPromptMessage(d),this._maskValidSubsetError=
!this._hasBeenBlurred||d):b&&(c=this.getPromptMessage(d));this.set("message",c);return a},displayMessage:function(d){d&&this.focused?l.show(d,this.domNode,this.tooltipPosition,!this.isLeftToRight()):l.hide(this.domNode)},_refreshState:function(){this._created&&this.validate(this.focused);this.inherited(arguments)},constructor:function(d){this.constraints=p.clone(this.constraints);this.baseClass+=" dijitValidationTextBox"},startup:function(){this.inherited(arguments);this._refreshState()},_setConstraintsAttr:function(d){!d.locale&&
this.lang&&(d.locale=this.lang);this._set("constraints",d);this._refreshState()},_setPatternAttr:function(d){this._set("pattern",d);this._refreshState()},_computeRegexp:function(d){var c=this.pattern;"function"==typeof c&&(c=c.call(this,d));if(c!=this._lastRegExp){var a="";this._lastRegExp=c;".*"!=c&&c.replace(/\\.|\[\]|\[.*?[^\\]{1}\]|\{.*?\}|\(\?[=:!]|./g,function(b){switch(b.charAt(0)){case "{":case "+":case "?":case "*":case "^":case "$":case "|":case "(":a+=b;break;case ")":a+="|$)";break;default:a+=
"(?:"+b+"|$)"}});try{"".search(a)}catch(b){a=this.pattern,console.warn("RegExp error in "+this.declaredClass+": "+this.pattern)}this._partialre="^(?:"+a+")$"}return c},postMixInProperties:function(){this.inherited(arguments);this.messages=q.getLocalization("dijit.form","validate",this.lang);this._setConstraintsAttr(this.constraints)},_setDisabledAttr:function(d){this.inherited(arguments);this._refreshState()},_setRequiredAttr:function(d){this._set("required",d);this.focusNode.setAttribute("aria-required",
d);this._refreshState()},_setMessageAttr:function(d){this._set("message",d);this.displayMessage(d)},reset:function(){this._maskValidSubsetError=!0;this.inherited(arguments)},_onBlur:function(){this.displayMessage("");this.inherited(arguments)},destroy:function(){l.hide(this.domNode);this.inherited(arguments)}});return f})},"dijit/form/TextBox":function(){define("dojo/_base/declare dojo/dom-construct dojo/dom-style dojo/_base/kernel dojo/_base/lang dojo/on dojo/sniff ./_FormValueWidget ./_TextBoxMixin dojo/text!./templates/TextBox.html ../main".split(" "),
function(k,e,p,q,n,l,h,f,d,c,a){f=k("dijit.form.TextBox"+(h("dojo-bidi")?"_NoBidi":""),[f,d],{templateString:c,_singleNodeTemplate:'\x3cinput class\x3d"dijit dijitReset dijitLeft dijitInputField" data-dojo-attach-point\x3d"textbox,focusNode" autocomplete\x3d"off" type\x3d"${type}" ${!nameAttrSetting} /\x3e',_buttonInputDisabled:h("ie")?"disabled":"",baseClass:"dijitTextBox",postMixInProperties:function(){var a=this.type.toLowerCase();if(this.templateString&&"input"==this.templateString.toLowerCase()||
("hidden"==a||"file"==a)&&this.templateString==this.constructor.prototype.templateString)this.templateString=this._singleNodeTemplate;this.inherited(arguments)},postCreate:function(){this.inherited(arguments);9>h("ie")&&this.defer(function(){try{var a=p.getComputedStyle(this.domNode);if(a){var c=a.fontFamily;if(c){var d=this.domNode.getElementsByTagName("INPUT");if(d)for(a=0;a<d.length;a++)d[a].style.fontFamily=c}}}catch(m){}})},_setPlaceHolderAttr:function(a){this._set("placeHolder",a);this._phspan||
(this._attachPoints.push("_phspan"),this._phspan=e.create("span",{className:"dijitPlaceHolder dijitInputField"},this.textbox,"after"),this.own(l(this._phspan,"mousedown",function(a){a.preventDefault()}),l(this._phspan,"touchend, pointerup, MSPointerUp",n.hitch(this,function(){this.focus()}))));this._phspan.innerHTML="";this._phspan.appendChild(this._phspan.ownerDocument.createTextNode(a));this._updatePlaceHolder()},_onInput:function(a){this.inherited(arguments);this._updatePlaceHolder()},_updatePlaceHolder:function(){this._phspan&&
(this._phspan.style.display=this.placeHolder&&!this.textbox.value?"":"none")},_setValueAttr:function(a,c,d){this.inherited(arguments);this._updatePlaceHolder()},getDisplayedValue:function(){q.deprecated(this.declaredClass+"::getDisplayedValue() is deprecated. Use get('displayedValue') instead.","","2.0");return this.get("displayedValue")},setDisplayedValue:function(a){q.deprecated(this.declaredClass+"::setDisplayedValue() is deprecated. Use set('displayedValue', ...) instead.","","2.0");this.set("displayedValue",
a)},_onBlur:function(a){this.disabled||(this.inherited(arguments),this._updatePlaceHolder(),h("mozilla")&&this.selectOnClick&&(this.textbox.selectionStart=this.textbox.selectionEnd=void 0))},_onFocus:function(a){this.disabled||this.readOnly||(this.inherited(arguments),this._updatePlaceHolder())}});9>h("ie")&&(f.prototype._isTextSelected=function(){var a=this.ownerDocument.selection.createRange();return a.parentElement()==this.textbox&&0<a.text.length},a._setSelectionRange=d._setSelectionRange=function(a,
c,d){a.createTextRange&&(a=a.createTextRange(),a.collapse(!0),a.moveStart("character",-99999),a.moveStart("character",c),a.moveEnd("character",d-c),a.select())});h("dojo-bidi")&&(f=k("dijit.form.TextBox",f,{_setPlaceHolderAttr:function(a){this.inherited(arguments);this.applyTextDir(this._phspan)}}));return f})},"dijit/form/_FormValueWidget":function(){define(["dojo/_base/declare","dojo/sniff","./_FormWidget","./_FormValueMixin"],function(k,e,p,q){return k("dijit.form._FormValueWidget",[p,q],{_layoutHackIE7:function(){if(7==
e("ie"))for(var n=this.domNode,l=n.parentNode,h=n.firstChild||n,f=h.style.filter,d=this;l&&0==l.clientHeight;)(function(){var c=d.connect(l,"onscroll",function(){d.disconnect(c);h.style.filter=(new Date).getMilliseconds();d.defer(function(){h.style.filter=f})})})(),l=l.parentNode}})})},"dijit/form/_FormValueMixin":function(){define("dojo/_base/declare dojo/dom-attr dojo/keys dojo/_base/lang dojo/on ./_FormWidgetMixin".split(" "),function(k,e,p,q,n,l){return k("dijit.form._FormValueMixin",l,{readOnly:!1,
_setReadOnlyAttr:function(h){e.set(this.focusNode,"readOnly",h);this._set("readOnly",h)},postCreate:function(){this.inherited(arguments);void 0===this._resetValue&&(this._lastValueReported=this._resetValue=this.value)},_setValueAttr:function(e,f){this._handleOnChange(e,f)},_handleOnChange:function(e,f){this._set("value",e);this.inherited(arguments)},undo:function(){this._setValueAttr(this._lastValueReported,!1)},reset:function(){this._hasBeenBlurred=!1;this._setValueAttr(this._resetValue,!0)}})})},
"dijit/form/_TextBoxMixin":function(){define("dojo/_base/array dojo/_base/declare dojo/dom dojo/sniff dojo/keys dojo/_base/lang dojo/on ../main".split(" "),function(k,e,p,q,n,l,h,f){var d=e("dijit.form._TextBoxMixin"+(q("dojo-bidi")?"_NoBidi":""),null,{trim:!1,uppercase:!1,lowercase:!1,propercase:!1,maxLength:"",selectOnClick:!1,placeHolder:"",_getValueAttr:function(){return this.parse(this.get("displayedValue"),this.constraints)},_setValueAttr:function(c,a,b){var d;void 0!==c&&(d=this.filter(c),
"string"!=typeof b&&(b=null===d||"number"==typeof d&&isNaN(d)?"":this.filter(this.format(d,this.constraints)),0!=this.compare(d,this.filter(this.parse(b,this.constraints)))&&(b=null)));null==b||"number"==typeof b&&isNaN(b)||this.textbox.value==b||(this.textbox.value=b,this._set("displayedValue",this.get("displayedValue")));this.inherited(arguments,[d,a])},displayedValue:"",_getDisplayedValueAttr:function(){return this.filter(this.textbox.value)},_setDisplayedValueAttr:function(c){null==c?c="":"string"!=
typeof c&&(c=String(c));this.textbox.value=c;this._setValueAttr(this.get("value"),void 0);this._set("displayedValue",this.get("displayedValue"))},format:function(c){return null==c?"":c.toString?c.toString():c},parse:function(c){return c},_refreshState:function(){},onInput:function(){},_onInput:function(c){this._lastInputEventValue=this.textbox.value;this._processInput(this._lastInputProducingEvent||c);delete this._lastInputProducingEvent;this.intermediateChanges&&this._handleOnChange(this.get("value"),
!1)},_processInput:function(){this._refreshState();this._set("displayedValue",this.get("displayedValue"))},postCreate:function(){this.textbox.setAttribute("value",this.textbox.value);this.inherited(arguments);this.own(h(this.textbox,"keydown, keypress, paste, cut, compositionend",l.hitch(this,function(c){var a;if("keydown"==c.type&&229!=c.keyCode){a=c.keyCode;switch(a){case n.SHIFT:case n.ALT:case n.CTRL:case n.META:case n.CAPS_LOCK:case n.NUM_LOCK:case n.SCROLL_LOCK:return}if(!c.ctrlKey&&!c.metaKey&&
!c.altKey){switch(a){case n.NUMPAD_0:case n.NUMPAD_1:case n.NUMPAD_2:case n.NUMPAD_3:case n.NUMPAD_4:case n.NUMPAD_5:case n.NUMPAD_6:case n.NUMPAD_7:case n.NUMPAD_8:case n.NUMPAD_9:case n.NUMPAD_MULTIPLY:case n.NUMPAD_PLUS:case n.NUMPAD_ENTER:case n.NUMPAD_MINUS:case n.NUMPAD_PERIOD:case n.NUMPAD_DIVIDE:return}if(65<=a&&90>=a||48<=a&&57>=a||a==n.SPACE)return;a=!1;for(var b in n)if(n[b]===c.keyCode){a=!0;break}if(!a)return}}(a=32<=c.charCode?String.fromCharCode(c.charCode):c.charCode)||(a=65<=c.keyCode&&
90>=c.keyCode||48<=c.keyCode&&57>=c.keyCode||c.keyCode==n.SPACE?String.fromCharCode(c.keyCode):c.keyCode);a||(a=229);if("keypress"==c.type){if("string"!=typeof a)return;if("a"<=a&&"z">=a||"A"<=a&&"Z">=a||"0"<=a&&"9">=a||" "===a)if(c.ctrlKey||c.metaKey||c.altKey)return}var d={faux:!0},f;for(f in c)/^(layer[XY]|returnValue|keyLocation)$/.test(f)||(b=c[f],"function"!=typeof b&&"undefined"!=typeof b&&(d[f]=b));l.mixin(d,{charOrCode:a,_wasConsumed:!1,preventDefault:function(){d._wasConsumed=!0;c.preventDefault()},
stopPropagation:function(){c.stopPropagation()}});this._lastInputProducingEvent=d;!1===this.onInput(d)&&(d.preventDefault(),d.stopPropagation());if(!d._wasConsumed&&9>=q("ie"))switch(c.keyCode){case n.TAB:case n.ESCAPE:case n.DOWN_ARROW:case n.UP_ARROW:case n.LEFT_ARROW:case n.RIGHT_ARROW:break;default:c.keyCode==n.ENTER&&"textarea"!=this.textbox.tagName.toLowerCase()||this.defer(function(){this.textbox.value!==this._lastInputEventValue&&h.emit(this.textbox,"input",{bubbles:!0})})}})),h(this.textbox,
"input",l.hitch(this,"_onInput")),h(this.domNode,"keypress",function(c){c.stopPropagation()}))},_blankValue:"",filter:function(c){if(null===c)return this._blankValue;if("string"!=typeof c)return c;this.trim&&(c=l.trim(c));this.uppercase&&(c=c.toUpperCase());this.lowercase&&(c=c.toLowerCase());this.propercase&&(c=c.replace(/[^\s]+/g,function(a){return a.substring(0,1).toUpperCase()+a.substring(1)}));return c},_setBlurValue:function(){this._setValueAttr(this.get("value"),!0)},_onBlur:function(c){this.disabled||
(this._setBlurValue(),this.inherited(arguments))},_isTextSelected:function(){return this.textbox.selectionStart!=this.textbox.selectionEnd},_onFocus:function(c){this.disabled||this.readOnly||(this.selectOnClick&&"mouse"==c&&(this._selectOnClickHandle=h.once(this.domNode,"mouseup, touchend",l.hitch(this,function(a){this._isTextSelected()||d.selectInputText(this.textbox)})),this.own(this._selectOnClickHandle),this.defer(function(){this._selectOnClickHandle&&(this._selectOnClickHandle.remove(),this._selectOnClickHandle=
null)},500)),this.inherited(arguments),this._refreshState())},reset:function(){this.textbox.value="";this.inherited(arguments)}});q("dojo-bidi")&&(d=e("dijit.form._TextBoxMixin",d,{_setValueAttr:function(){this.inherited(arguments);this.applyTextDir(this.focusNode)},_setDisplayedValueAttr:function(){this.inherited(arguments);this.applyTextDir(this.focusNode)},_onInput:function(){this.applyTextDir(this.focusNode);this.inherited(arguments)}}));d._setSelectionRange=f._setSelectionRange=function(c,a,
b){c.setSelectionRange&&c.setSelectionRange(a,b)};d.selectInputText=f.selectInputText=function(c,a,b){c=p.byId(c);isNaN(a)&&(a=0);isNaN(b)&&(b=c.value?c.value.length:0);try{c.focus(),d._setSelectionRange(c,a,b)}catch(g){}};return d})},"dijit/Tooltip":function(){define("dojo/_base/array dojo/_base/declare dojo/_base/fx dojo/dom dojo/dom-class dojo/dom-geometry dojo/dom-style dojo/_base/lang dojo/mouse dojo/on dojo/sniff ./_base/manager ./place ./_Widget ./_TemplatedMixin ./BackgroundIframe dojo/text!./templates/Tooltip.html ./main".split(" "),
function(k,e,p,q,n,l,h,f,d,c,a,b,g,u,m,r,t,v){function y(){}var w=e("dijit._MasterTooltip",[u,m],{duration:b.defaultDuration,templateString:t,postCreate:function(){this.ownerDocumentBody.appendChild(this.domNode);this.bgIframe=new r(this.domNode);this.fadeIn=p.fadeIn({node:this.domNode,duration:this.duration,onEnd:f.hitch(this,"_onShow")});this.fadeOut=p.fadeOut({node:this.domNode,duration:this.duration,onEnd:f.hitch(this,"_onHide")})},show:function(a,b,c,d,m,e,l){if(!this.aroundNode||this.aroundNode!==
b||this.containerNode.innerHTML!=a)if("playing"==this.fadeOut.status())this._onDeck=arguments;else{this.containerNode.innerHTML=a;m&&this.set("textDir",m);this.containerNode.align=d?"right":"left";var r=g.around(this.domNode,b,c&&c.length?c:z.defaultPosition,!d,f.hitch(this,"orient")),n=r.aroundNodePos;"M"==r.corner.charAt(0)&&"M"==r.aroundCorner.charAt(0)?(this.connectorNode.style.top=n.y+(n.h-this.connectorNode.offsetHeight>>1)-r.y+"px",this.connectorNode.style.left=""):"M"==r.corner.charAt(1)&&
"M"==r.aroundCorner.charAt(1)?this.connectorNode.style.left=n.x+(n.w-this.connectorNode.offsetWidth>>1)-r.x+"px":(this.connectorNode.style.left="",this.connectorNode.style.top="");h.set(this.domNode,"opacity",0);this.fadeIn.play();this.isShowingNow=!0;this.aroundNode=b;this.onMouseEnter=e||y;this.onMouseLeave=l||y}},orient:function(b,c,d,g,f){this.connectorNode.style.top="";var m=g.h;g=g.w;b.className="dijitTooltip "+{"MR-ML":"dijitTooltipRight","ML-MR":"dijitTooltipLeft","TM-BM":"dijitTooltipAbove",
"BM-TM":"dijitTooltipBelow","BL-TL":"dijitTooltipBelow dijitTooltipABLeft","TL-BL":"dijitTooltipAbove dijitTooltipABLeft","BR-TR":"dijitTooltipBelow dijitTooltipABRight","TR-BR":"dijitTooltipAbove dijitTooltipABRight","BR-BL":"dijitTooltipRight","BL-BR":"dijitTooltipLeft"}[c+"-"+d];this.domNode.style.width="auto";var e=l.position(this.domNode);if(a("ie")||a("trident"))e.w+=2;l.setMarginBox(this.domNode,{w:Math.min(Math.max(g,1),e.w)});"B"==d.charAt(0)&&"B"==c.charAt(0)?(b=l.position(b),c=this.connectorNode.offsetHeight,
b.h>m?(this.connectorNode.style.top=m-(f.h+c>>1)+"px",this.connectorNode.style.bottom=""):(this.connectorNode.style.bottom=Math.min(Math.max(f.h/2-c/2,0),b.h-c)+"px",this.connectorNode.style.top="")):(this.connectorNode.style.top="",this.connectorNode.style.bottom="");return Math.max(0,e.w-g)},_onShow:function(){a("ie")&&(this.domNode.style.filter="")},hide:function(a){this._onDeck&&this._onDeck[1]==a?this._onDeck=null:this.aroundNode===a&&(this.fadeIn.stop(),this.isShowingNow=!1,this.aroundNode=
null,this.fadeOut.play());this.onMouseEnter=this.onMouseLeave=y},_onHide:function(){this.domNode.style.cssText="";this.containerNode.innerHTML="";this._onDeck&&(this.show.apply(this,this._onDeck),this._onDeck=null)}});a("dojo-bidi")&&w.extend({_setAutoTextDir:function(a){this.applyTextDir(a);k.forEach(a.children,function(a){this._setAutoTextDir(a)},this)},_setTextDirAttr:function(a){this._set("textDir",a);"auto"==a?this._setAutoTextDir(this.containerNode):this.containerNode.dir=this.textDir}});v.showTooltip=
function(a,b,c,d,g,f,m){c&&(c=k.map(c,function(a){return{after:"after-centered",before:"before-centered"}[a]||a}));z._masterTT||(v._masterTT=z._masterTT=new w);return z._masterTT.show(a,b,c,d,g,f,m)};v.hideTooltip=function(a){return z._masterTT&&z._masterTT.hide(a)};var z=e("dijit.Tooltip",u,{label:"",showDelay:400,hideDelay:400,connectId:[],position:[],selector:"",_setConnectIdAttr:function(a){k.forEach(this._connections||[],function(a){k.forEach(a,function(a){a.remove()})},this);this._connectIds=
k.filter(f.isArrayLike(a)?a:a?[a]:[],function(a){return q.byId(a,this.ownerDocument)},this);this._connections=k.map(this._connectIds,function(a){a=q.byId(a,this.ownerDocument);var b=this.selector,g=b?function(a){return c.selector(b,a)}:function(a){return a},m=this;return[c(a,g(d.enter),function(){m._onHover(this)}),c(a,g("focusin"),function(){m._onHover(this)}),c(a,g(d.leave),f.hitch(m,"_onUnHover")),c(a,g("focusout"),f.hitch(m,"set","state","DORMANT"))]},this);this._set("connectId",a)},addTarget:function(a){a=
a.id||a;-1==k.indexOf(this._connectIds,a)&&this.set("connectId",this._connectIds.concat(a))},removeTarget:function(a){a=k.indexOf(this._connectIds,a.id||a);0<=a&&(this._connectIds.splice(a,1),this.set("connectId",this._connectIds))},buildRendering:function(){this.inherited(arguments);n.add(this.domNode,"dijitTooltipData")},startup:function(){this.inherited(arguments);var a=this.connectId;k.forEach(f.isArrayLike(a)?a:[a],this.addTarget,this)},getContent:function(a){return this.label||this.domNode.innerHTML},
state:"DORMANT",_setStateAttr:function(a){if(!(this.state==a||"SHOW TIMER"==a&&"SHOWING"==this.state||"HIDE TIMER"==a&&"DORMANT"==this.state)){this._hideTimer&&(this._hideTimer.remove(),delete this._hideTimer);this._showTimer&&(this._showTimer.remove(),delete this._showTimer);switch(a){case "DORMANT":this._connectNode&&(z.hide(this._connectNode),delete this._connectNode,this.onHide());break;case "SHOW TIMER":"SHOWING"!=this.state&&(this._showTimer=this.defer(function(){this.set("state","SHOWING")},
this.showDelay));break;case "SHOWING":var b=this.getContent(this._connectNode);if(!b){this.set("state","DORMANT");return}z.show(b,this._connectNode,this.position,!this.isLeftToRight(),this.textDir,f.hitch(this,"set","state","SHOWING"),f.hitch(this,"set","state","HIDE TIMER"));this.onShow(this._connectNode,this.position);break;case "HIDE TIMER":this._hideTimer=this.defer(function(){this.set("state","DORMANT")},this.hideDelay)}this._set("state",a)}},_onHover:function(a){this._connectNode&&a!=this._connectNode&&
this.set("state","DORMANT");this._connectNode=a;this.set("state","SHOW TIMER")},_onUnHover:function(a){this.set("state","HIDE TIMER")},open:function(a){this.set("state","DORMANT");this._connectNode=a;this.set("state","SHOWING")},close:function(){this.set("state","DORMANT")},onShow:function(){},onHide:function(){},destroy:function(){this.set("state","DORMANT");k.forEach(this._connections||[],function(a){k.forEach(a,function(a){a.remove()})},this);this.inherited(arguments)}});z._MasterTooltip=w;z.show=
v.showTooltip;z.hide=v.hideTooltip;z.defaultPosition=["after-centered","before-centered"];return z})},"dijit/place":function(){define("dojo/_base/array dojo/dom-geometry dojo/dom-style dojo/_base/kernel dojo/_base/window ./Viewport ./main".split(" "),function(k,e,p,q,n,l,h){function f(c,a,b,d){var g=l.getEffectiveBox(c.ownerDocument);c.parentNode&&"body"==String(c.parentNode.tagName).toLowerCase()||n.body(c.ownerDocument).appendChild(c);var f=null;k.some(a,function(a){var m=a.corner,h=a.pos,l=0,r=
{w:{L:g.l+g.w-h.x,R:h.x-g.l,M:g.w}[m.charAt(1)],h:{T:g.t+g.h-h.y,B:h.y-g.t,M:g.h}[m.charAt(0)]},n=c.style;n.left=n.right="auto";b&&(l=b(c,a.aroundCorner,m,r,d),l="undefined"==typeof l?0:l);var t=c.style,k=t.display,u=t.visibility;"none"==t.display&&(t.visibility="hidden",t.display="");n=e.position(c);t.display=k;t.visibility=u;k={L:h.x,R:h.x-n.w,M:Math.max(g.l,Math.min(g.l+g.w,h.x+(n.w>>1))-n.w)}[m.charAt(1)];u={T:h.y,B:h.y-n.h,M:Math.max(g.t,Math.min(g.t+g.h,h.y+(n.h>>1))-n.h)}[m.charAt(0)];h=Math.max(g.l,
k);t=Math.max(g.t,u);k=Math.min(g.l+g.w,k+n.w)-h;u=Math.min(g.t+g.h,u+n.h)-t;l+=n.w-k+(n.h-u);if(null==f||l<f.overflow)f={corner:m,aroundCorner:a.aroundCorner,x:h,y:t,w:k,h:u,overflow:l,spaceAvailable:r};return!l});f.overflow&&b&&b(c,f.aroundCorner,f.corner,f.spaceAvailable,d);a=f.y;var h=f.x,t=n.body(c.ownerDocument);/relative|absolute/.test(p.get(t,"position"))&&(a-=p.get(t,"marginTop"),h-=p.get(t,"marginLeft"));t=c.style;t.top=a+"px";t.left=h+"px";t.right="auto";return f}var d={TL:"BR",TR:"BL",
BL:"TR",BR:"TL"};return h.place={at:function(c,a,b,g,e){b=k.map(b,function(b){var c={corner:b,aroundCorner:d[b],pos:{x:a.x,y:a.y}};g&&(c.pos.x+="L"==b.charAt(1)?g.x:-g.x,c.pos.y+="T"==b.charAt(0)?g.y:-g.y);return c});return f(c,b,e)},around:function(c,a,b,d,h){function g(a,b){E.push({aroundCorner:a,corner:b,pos:{x:{L:x,R:x+C,M:x+(C>>1)}[a.charAt(1)],y:{T:A,B:A+B,M:A+(B>>1)}[a.charAt(0)]}})}var l;if("string"==typeof a||"offsetWidth"in a||"ownerSVGElement"in a){if(l=e.position(a,!0),/^(above|below)/.test(b[0])){var n=
e.getBorderExtents(a),u=a.firstChild?e.getBorderExtents(a.firstChild):{t:0,l:0,b:0,r:0},y=e.getBorderExtents(c),w=c.firstChild?e.getBorderExtents(c.firstChild):{t:0,l:0,b:0,r:0};l.y+=Math.min(n.t+u.t,y.t+w.t);l.h-=Math.min(n.t+u.t,y.t+w.t)+Math.min(n.b+u.b,y.b+w.b)}}else l=a;if(a.parentNode)for(n="absolute"==p.getComputedStyle(a).position,a=a.parentNode;a&&1==a.nodeType&&"BODY"!=a.nodeName;){u=e.position(a,!0);y=p.getComputedStyle(a);/relative|absolute/.test(y.position)&&(n=!1);if(!n&&/hidden|auto|scroll/.test(y.overflow)){var w=
Math.min(l.y+l.h,u.y+u.h),z=Math.min(l.x+l.w,u.x+u.w);l.x=Math.max(l.x,u.x);l.y=Math.max(l.y,u.y);l.h=w-l.y;l.w=z-l.x}"absolute"==y.position&&(n=!0);a=a.parentNode}var x=l.x,A=l.y,C="w"in l?l.w:l.w=l.width,B="h"in l?l.h:(q.deprecated("place.around: dijit/place.__Rectangle: { x:"+x+", y:"+A+", height:"+l.height+", width:"+C+" } has been deprecated.  Please use { x:"+x+", y:"+A+", h:"+l.height+", w:"+C+" }","","2.0"),l.h=l.height),E=[];k.forEach(b,function(a){var b=d;switch(a){case "above-centered":g("TM",
"BM");break;case "below-centered":g("BM","TM");break;case "after-centered":b=!b;case "before-centered":g(b?"ML":"MR",b?"MR":"ML");break;case "after":b=!b;case "before":g(b?"TL":"TR",b?"TR":"TL");g(b?"BL":"BR",b?"BR":"BL");break;case "below-alt":b=!b;case "below":g(b?"BL":"BR",b?"TL":"TR");g(b?"BR":"BL",b?"TR":"TL");break;case "above-alt":b=!b;case "above":g(b?"TL":"TR",b?"BL":"BR");g(b?"TR":"TL",b?"BR":"BL");break;default:g(a.aroundCorner,a.corner)}});c=f(c,E,h,{w:C,h:B});c.aroundNodePos=l;return c}}})},
"esri/OAuthSignInHandler":function(){define("./Credential ./domUtils ./lang ./urlUtils dijit/Dialog dijit/registry dojo/_base/config dojo/_base/Deferred dojo/_base/kernel dojo/dom-attr dojo/i18n!./nls/jsapi dojo/io-query dojo/sniff dojo/json dijit/form/Button dojo/query".split(" "),function(k,e,p,q,n,l,h,f,d,c,a,b,g,u){return{_oAuthDfd:null,_oAuthIntervalId:0,_oAuthDialogContent:"\x3cdiv class\x3d'dijitDialogPaneContentArea'\x3e\x3cdiv style\x3d'padding-bottom: 5px; word-wrap: break-word;'\x3e${oAuthInfo}\x3c/div\x3e\x3cdiv style\x3d'margin: 0px; padding: 0px; height: 10px;'\x3e\x3c/div\x3e\x3cdiv class\x3d'esriErrorMsg' style\x3d'display: none; color: white; background-color: #D46464; text-align: center; padding-top: 3px; padding-bottom: 3px;'\x3e${invalidUser}\x3c/div\x3e\x3cdiv style\x3d'margin: 0px; padding: 0px; height: 10px;'\x3e\x3c/div\x3e\x3cdiv class\x3d'dijitDialogPaneActionBar'\x3e\x3cbutton data-dojo-type\x3d'dijit.form.Button' data-dojo-props\x3d'type:\"button\", \"class\":\"esriIdSubmit\"'\x3e${lblOk}\x3c/button\x3e\x3cbutton data-dojo-type\x3d'dijit.form.Button' data-dojo-props\x3d'type:\"button\", \"class\":\"esriIdCancel\"'\x3e${lblCancel}\x3c/button\x3e\x3c/div\x3e",
setOAuthRedirectionHandler:function(a){this._oAuthRedirectFunc=a},oAuthSignIn:function(b,d,g,h){var m=this._oAuthDfd=new f;m.resUrl_=b;m.sinfo_=d;m.oinfo_=g;var l=!h||!1!==h.oAuthPopupConfirmation;if(!g.popup||!l)return this._doOAuthSignIn(b,d,g),m;this._nls||(this._nls=a.identity);this.oAuthDialog||(this.oAuthDialog=this._createOAuthDialog());b=this.oAuthDialog;d=h&&h.error;h=h&&h.token;e.hide(b.errMsg_);d&&403==d.code&&h&&(c.set(b.errMsg_,"innerHTML",this._nls.forbidden),e.show(b.errMsg_));b.show();
return m},setOAuthResponseHash:function(a){var c=this._oAuthDfd;this._oAuthDfd=null;if(c&&a)if(clearInterval(this._oAuthIntervalId),"#"===a.charAt(0)&&(a=a.substring(1)),a=b.queryToObject(a),a.error)a=Error("access_denied"===a.error?"ABORTED":"OAuth: "+a.error+" - "+a.error_description),a.code="IdentityManagerBase.2",a.log=!!h.isDebug,c.errback(a);else{var d=c.oinfo_._oAuthCred,g=new k({userId:a.username,server:c.sinfo_.server,token:a.access_token,expires:(new Date).getTime()+1E3*Number(a.expires_in),
ssl:"true"===a.ssl,_oAuthCred:d});d.storage=a.persist?window.localStorage:window.sessionStorage;d.token=g.token;d.expires=g.expires;d.userId=g.userId;d.ssl=g.ssl;d.save();c.callback(g)}},_createOAuthDialog:function(){var a=this._nls,b=p.substitute(a,this._oAuthDialogContent),c=new n({title:a.title,content:b,"class":"esriOAuthSignInDialog",style:"min-width: 18em;",esriIdMgr_:this,execute_:function(){var a=c.esriIdMgr_._oAuthDfd;c.hide_();c.esriIdMgr_._doOAuthSignIn(a.resUrl_,a.sinfo_,a.oinfo_)},cancel_:function(){var a=
c.esriIdMgr_._oAuthDfd;c.esriIdMgr_._oAuthDfd=null;c.hide_();var b=Error("ABORTED");b.code="IdentityManager.2";b.log=!!h.isDebug;a.errback(b)},hide_:function(){e.hide(c.errMsg_);c.hide();n._DialogLevelManager.hide(c)}}),a=c.domNode;c.btnSubmit_=l.byNode(d.query(".esriIdSubmit",a)[0]);c.btnCancel_=l.byNode(d.query(".esriIdCancel",a)[0]);c.errMsg_=d.query(".esriErrorMsg",a)[0];c.connect(c.btnSubmit_,"onClick",c.execute_);c.connect(c.btnCancel_,"onClick",c.onCancel);c.connect(c,"onCancel",c.cancel_);
return c},_doOAuthSignIn:function(a,c,d){var f=this,m={client_id:d.appId,response_type:"token",state:u.stringify({portalUrl:d.portalUrl}),expiration:d.expiration,locale:d.locale,redirect_uri:d.popup?q.getAbsoluteUrl(d.popupCallbackUrl):window.location.href.replace(/#.*$/,"")};d.forceLogin&&(m.force_login=!0);var e=d.portalUrl.replace(/^http:/i,"https:")+"/sharing/oauth2/authorize",l=e+"?"+b.objectToQuery(m);if(d.popup){var r;7===g("ie")?(r=window.open(d.popupCallbackUrl,"esriJSAPIOAuth",d.popupWindowFeatures),
r.location=l):r=window.open(l,"esriJSAPIOAuth",d.popupWindowFeatures);r?(r.focus(),this._oAuthDfd.oAuthWin_=r,this._oAuthIntervalId=setInterval(function(){if(r.closed){clearInterval(f._oAuthIntervalId);var a=f._oAuthDfd;if(a){var b=Error("ABORTED");b.code="IdentityManager.2";b.log=!!h.isDebug;a.errback(b)}}},500)):(a=Error("ABORTED"),a.code="IdentityManager.2",a.log=!!h.isDebug,this._oAuthDfd.errback(a))}else this._oAuthRedirectFunc?this._oAuthRedirectFunc({authorizeParams:m,authorizeUrl:e,resourceUrl:a,
serverInfo:c,oAuthInfo:d}):window.location=l}}})},"esri/layers/vectorTiles/kernel":function(){define(["require","exports","esri/kernel","./identity/IdentityManager"],function(k,e,p,q){return function(){function e(){}Object.defineProperty(e,"id",{get:function(){return p.id?q:null},enumerable:!0,configurable:!0});e.workerMessages={};return e}()})},"esri/layers/vectorTiles/identity/IdentityManager":function(){define(["require","exports","esri/IdentityManager"],function(k,e,p){Object.defineProperty(e,
"__esModule",{value:!0});e.findCredential=function(e){return p.findCredential(e)}})},"jimu/ServiceDefinitionManager":function(){define(["dojo/_base/declare","esri/request"],function(k,e){var p=null,q=k(null,{cache:{},getServiceDefinition:function(n,l){l||(l="json");var h=this.cache[n];0>=this._getDefStatus(h)&&(h=e({url:n,handleAs:l,content:{f:l},callbackParamName:"callback"}),this.cache[n]=h);return h},_getDefStatus:function(e){return e?e.isFulfilled()?e.isResolved()?2:-1:1:0}});q.getInstance=function(){p||
(p=new q,window._serviceDefinitionManager=p);return p};return q})},"jimu/dijit/Message":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/keys dojo/on jimu/dijit/Popup".split(" "),function(k,e,p,q,n,l){return k(l,{baseClass:"jimu-popup jimu-message",declaredClass:"jimu.dijit.Message",type:"message",message:"",autoHeight:!0,maxWidth:350,maxHeight:180,postMixInProperties:function(){this.content=this.message},_createTitleNode:function(){this.titleLabel&&(this.titleNode=p.create("div",
{"class":"title"},this.domNode),this.titleLabeNode=p.create("span",{"class":"title-label jimu-float-leading",innerHTML:this.titleLabel||"\x26nbsp"},this.titleNode),this.closeBtnNode=p.create("div",{"class":"close-btn jimu-float-trailing"},this.titleNode),this.own(n(this.closeBtnNode,"click",e.hitch(this,this.close))))},_preProcessing:function(){0===this.buttons.length&&this.buttons.push({label:window.jimuNls.common.ok,key:q.ENTER,onClick:e.hitch(this,this.close)})},_increaseZIndex:function(){p.setStyle(this.domNode,
"zIndex",501);p.setStyle(this.overlayNode,"zIndex",500)}})})},"jimu/dijit/Popup":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/html dojo/_base/fx dojo/on dojo/sniff dojo/touch dojo/query dojo/dnd/move dijit/_WidgetBase jimu/utils".split(" "),function(k,e,p,q,n,l,h,f,d,c,a,b){var g=0;return k(a,{declaredClass:"jimu.dijit.Popup",baseClass:"jimu-popup",titleLabel:"",content:null,container:null,buttons:[],enabledButtons:[],disabledButtons:[],onClose:null,_fixedHeight:!1,
autoHeight:!1,maxHeight:800,maxWidth:1024,constructor:function(){this.buttons=[];this.enabledButtons=[];this.disabledButtons=[];this.pauseKeyHandles=[];this.container=jimuConfig.layoutId},postCreate:function(){this._preProcessing();this.inherited(arguments);this._initDomNode();this._positioning();q.place(this.domNode,this.container);setTimeout(e.hitch(this,function(){this._moveToMiddle()}),50);this.own(l(window,"resize",e.hitch(this,function(){this._fixedHeight||this.autoHeight?(this._calculatePosition(),
this._moveToMiddle()):this._positioning()})));this.overlayNode=q.create("div",{"class":"jimu-overlay"},this.container);this._increaseZIndex();n.animateProperty({node:this.domNode,properties:{opacity:1},duration:200}).play();this.domNode.focus()},_preProcessing:function(){"number"===typeof this.height&&(this._fixedHeight=!0,this.autoHeight=!1);this.autoHeight&&(this.maxHeight=598)},_createTitleNode:function(){this.titleNode=q.create("div",{"class":"title"},this.domNode);this.titleLabeNode=q.create("span",
{"class":"title-label jimu-float-leading",innerHTML:this.titleLabel||"\x26nbsp"},this.titleNode);this.closeBtnNode=q.create("div",{"class":"close-btn jimu-icon jimu-icon-close jimu-float-trailing"},this.titleNode);var a=null,a="ontouchstart"in document?f.press:"click";this.own(l(this.closeBtnNode,a,e.hitch(this,this.close)))},_initDomNode:function(){this._createTitleNode();this.contentContainerNode=q.create("div",{"class":"content"},this.domNode);this.content&&("string"===typeof this.content?this.contentContainerNode.innerHTML=
this.content:this.content.domNode?(this.content.placeAt(this.contentContainerNode),this.content.popup=this):1===this.content.nodeType&&q.place(this.content,this.contentContainerNode));this.buttonContainer=q.create("div",{"class":"button-container"},this.domNode);0===this.buttons.length&&q.setStyle(this.buttonContainer,"display","none");for(var a=this.buttons.length-1;-1<a;a--)this._createButton(this.buttons[a]),this.buttons[a].disable&&this.disableButton(a)},_limitButtonsMaxWidth:function(){var a=
this.enabledButtons.length;if(0!==a){var b=q.getContentBox(this.buttonContainer),c=q.getMarginExtents(this.enabledButtons[0]),d=q.getPadBorderExtents(this.enabledButtons[0]),g=0,d=8===h("ie")?d.l+d.r:0,g=(b.w-(c.l+c.r+d)*a)/a;0<g&&(p.forEach(this.enabledButtons,e.hitch(this,function(a){q.setStyle(a,"maxWidth",g+"px")})),p.forEach(this.disabledButtons,e.hitch(this,function(a){q.setStyle(a,"maxWidth",g+"px")})))}},_moveableNode:function(a,b){this.moveable&&(this.moveable.destroy(),this.moveable=null);
var d=q.getMarginBox(this.container);d.l=d.l-a+b;d.w+=2*(a-b);this.moveable=new c.boxConstrainedMoveable(this.domNode,{box:d,handle:this.titleNode||this.contentContainerNode,within:!0});this.own(l(this.moveable,"Moving",e.hitch(this,this.onMoving)));this.own(l(this.moveable,"MoveStop",e.hitch(this,this.onMoveStop)))},_getHeaderBox:function(){return 0===d("#header").length?{t:0,l:0,w:0,h:0}:q.getMarginBox("header")},_getFooterBox:function(){return 0===d(".footer",this.container).length?{t:0,l:0,w:0,
h:0}:q.getMarginBox(d(".footer",this.container)[0])},_calculatePosition:function(){var a=q.getContentBox(this.container),b=this._getHeaderBox(),c=this._getFooterBox(),c=a.h-b.h-c.h-40,d=0;d=this._fixedHeight?this.height:this.autoHeight?c-200:this.height=c>this.maxHeight?this.maxHeight:c;c=(c-d)/2+b.h+20;c=c<b.h?b.h:c;this.width=this.width||this.maxWidth;q.setStyle(this.domNode,{left:(a.w-this.width)/2+"px",top:c+"px",width:this.width+"px"})},_calculateHeight:function(){this.autoHeight?(q.setStyle(this.domNode,
"height","auto"),q.addClass(this.contentContainerNode,"content-static"),0===this.buttons.length&&q.setStyle(this.contentContainerNode,{marginBottom:"15px"})):(q.setStyle(this.domNode,"height",this.height+"px"),q.addClass(this.contentContainerNode,"content-absolute"),q.addClass(this.buttonContainer,"button-container-absolute"),0===this.buttons.length&&q.setStyle(this.contentContainerNode,{bottom:"15px"}));this._moveableNode(this.width,100)},_moveToMiddle:function(){if(this.autoHeight){var a=q.getMarginBox(this.domNode),
b=q.getContentBox(this.container),c=this._getHeaderBox(),d=this._getFooterBox(),d=b.h-c.h-d.h-40,g=0,g=a.h||d-200,a=(d-g)/2+c.h+20,a=a<c.h?c.h:a;q.setStyle(this.domNode,{left:(b.w-this.width)/2+"px",top:a+"px",width:this.width+"px"})}},_positioning:function(){this._calculatePosition();this._calculateHeight()},_increaseZIndex:function(){q.setStyle(this.domNode,"zIndex",g+200+1);q.setStyle(this.overlayNode,"zIndex",g+200);g++},setTitleLabel:function(a){this.titleNode.innerHTML=b.stripHTML(a)},onMoving:function(a){q.setStyle(a.node,
"opacity",.9)},onMoveStop:function(a){q.setStyle(a.node,"opacity",1)},close:function(){if(!this.onClose||!1!==this.onClose()){var a=this.domNode.parentNode,b=e.clone(this.domNode);q.setStyle(this.domNode,"display","none");q.destroy(this.overlayNode);this.destroy();this.moveable.destroy();q.place(b,a);n.animateProperty({node:b,properties:{opacity:0},duration:200,onEnd:function(){q.destroy(b)}}).play()}},addButton:function(a){this._createButton(a)},_createButton:function(a){var b=" ";a.classNames&&
0<a.classNames.length&&"function"===typeof a.classNames.join&&(b+=a.classNames.join(" "));var c=q.create("div",{"class":"jimu-btn jimu-popup-action-btn jimu-float-trailing jimu-trailing-margin1 "+b,innerHTML:a.label,title:a.title||a.label},this.buttonContainer);this.enabledButtons.unshift(c);b=q.create("div",{"class":"jimu-btn jimu-state-disabled jimu-float-trailing jimu-trailing-margin1 "+b,title:a.title||a.label,innerHTML:a.label,style:{display:"none"}},this.buttonContainer);this.disabledButtons.unshift(b);
this.own(l(c,"click",e.hitch(this,function(b){if(a.onClick)a.onClick(b);else this.close()})))},setButtonProps:function(a,b){"number"===typeof a&&isFinite(a)||(b=a,a=0);if(b&&0!==this.enabledButtons.length)for(var c in b)"title"===c?(q.setAttr(this.enabledButtons[a],"title",b[c]),q.setAttr(this.disabledButtons[a],"title",b[c])):"label"===c&&(q.setProp(this.enabledButtons[a],"innerHTML",b[c]),q.setProp(this.disabledButtons[a],"innerHTML",b[c]))},enableButton:function(a){"number"===typeof a&&isFinite(a)&&
a<this.enabledButtons.length?(q.setStyle(this.enabledButtons[a],"display","inline-block"),q.setStyle(this.disabledButtons[a],"display","none")):(p.forEach(this.enabledButtons[a],e.hitch(this,function(a){q.setStyle(a,"display","inline-block")})),p.forEach(this.disabledButtons[a],e.hitch(this,function(a){q.setStyle(a,"display","none")})))},disableButton:function(a){"number"===typeof a&&isFinite(a)&&a<this.disabledButtons.length?(q.setStyle(this.disabledButtons[a],"display","inline-block"),q.setStyle(this.enabledButtons[a],
"display","none")):(p.forEach(this.disabledButtons,e.hitch(this,function(a){q.setStyle(a,"display","inline-block")})),p.forEach(this.enabledButtons,e.hitch(this,function(a){q.setStyle(a,"display","none")})))},showButton:function(a){this.enableButton(a)},hideButton:function(a){"number"===typeof a&&isFinite(a)&&a<this.disabledButtons.length?(q.setStyle(this.disabledButtons[a],"display","none"),q.setStyle(this.enabledButtons[a],"display","none")):(p.forEach(this.disabledButtons,e.hitch(this,function(a){q.setStyle(a,
"display","none")})),p.forEach(this.enabledButtons,e.hitch(this,function(a){q.setStyle(a,"display","none")})))},resize:function(a){a&&(this.width=a.w,this.height=a.h);this._positioning();this.content&&this.content.domNode&&this.content.resize&&this.content.resize()}})})},"dojo/dnd/move":function(){define("../_base/declare ../dom-geometry ../dom-style ./common ./Mover ./Moveable".split(" "),function(k,e,p,q,n,l){q=k("dojo.dnd.move.constrainedMoveable",l,{constraints:function(){},within:!1,constructor:function(e,
f){f||(f={});this.constraints=f.constraints;this.within=f.within},onFirstMove:function(h){var f=this.constraintBox=this.constraints.call(this,h);f.r=f.l+f.w;f.b=f.t+f.h;this.within&&(h=e.getMarginSize(h.node),f.r-=h.w,f.b-=h.h)},onMove:function(e,f){var d=this.constraintBox,c=e.node.style;this.onMoving(e,f);f.l=f.l<d.l?d.l:d.r<f.l?d.r:f.l;f.t=f.t<d.t?d.t:d.b<f.t?d.b:f.t;c.left=f.l+"px";c.top=f.t+"px";this.onMoved(e,f)}});n=k("dojo.dnd.move.boxConstrainedMoveable",q,{box:{},constructor:function(e,
f){var d=f&&f.box;this.constraints=function(){return d}}});k=k("dojo.dnd.move.parentConstrainedMoveable",q,{area:"content",constructor:function(h,f){var d=f&&f.area;this.constraints=function(){var c=this.node.parentNode,a=p.getComputedStyle(c),b=e.getMarginBox(c,a);if("margin"==d)return b;var g=e.getMarginExtents(c,a);b.l+=g.l;b.t+=g.t;b.w-=g.w;b.h-=g.h;if("border"==d)return b;g=e.getBorderExtents(c,a);b.l+=g.l;b.t+=g.t;b.w-=g.w;b.h-=g.h;if("padding"==d)return b;g=e.getPadExtents(c,a);b.l+=g.l;b.t+=
g.t;b.w-=g.w;b.h-=g.h;return b}}});return{constrainedMoveable:q,boxConstrainedMoveable:n,parentConstrainedMoveable:k}})},"jimu/DataSourceManager":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/topic dojo/Evented dojo/when ./utils jimu/LayerInfos/LayerInfos jimu/portalUtils jimu/portalUrlUtils jimu/filterUtils esri/tasks/query esri/tasks/QueryTask esri/tasks/StatisticDefinition ./Query".split(" "),function(k,e,p,q,n,l,h,f,d,c,a,b,g,u,m){var r=null,t=k(n,{constructor:function(){this._listeners=
[];this._refreshTimers=[];this._dataStore={};this._jimuQueryObject={};this._dataSourceUsage={};this._itemsFilter={};this.filterUtils=new a;window.isBuilder?(q.subscribe("app/mapLoaded",e.hitch(this,this._onMapLoaded)),q.subscribe("app/mapChanged",e.hitch(this,this._onMapChanged))):(q.subscribe("mapLoaded",e.hitch(this,this._onMapLoaded)),q.subscribe("mapChanged",e.hitch(this,this._onMapChanged)));window.isBuilder?(q.subscribe("app/appConfigLoaded",e.hitch(this,this._onAppConfigLoaded)),q.subscribe("app/appConfigChanged",
e.hitch(this,this._onAppConfigChanged))):(q.subscribe("appConfigLoaded",e.hitch(this,this._onAppConfigLoaded)),q.subscribe("appConfigChanged",e.hitch(this,this._onAppConfigChanged)));q.subscribe("updateDataSourceData",e.hitch(this,this._onUpdataDataSourceData));window.isBuilder&&q.subscribe("app/dataSourceDataUpdated",e.hitch(this,this._onDataSourceDataUpdatedInApp))},getData:function(a){return this._dataStore[a]},getDataSourceConfig:function(a){return this.appConfig.dataSource.dataSources[a]},parseDataSourceId:function(a){var b=
a.split("~"),c={};if(2>b.length)return console.error("Bad data source id:",a),c;switch(b[0]){case "map":return b=a.lastIndexOf("~"),c={from:"map",layerId:a.substring(4,b)};case "widget":return c={from:"widget",widgetId:b[1]};case "external":return c={from:"external"};default:console.error("Bad data source id:",a)}},addDataSourceUsage:function(a,b){this._dataSourceUsage[a]?(0>this._dataSourceUsage[a].indexOf(b)&&this._dataSourceUsage[a].push(b),1===this._dataSourceUsage[a].length&&this._startOneDataSource(this.appConfig.dataSource.dataSources[a])):
(this._dataSourceUsage[a]=[b],this._startOneDataSource(this.appConfig.dataSource.dataSources[a]))},removeDataSourceUsage:function(a,b){this._dataSourceUsage[a]&&0<=this._dataSourceUsage[a].indexOf(b)&&(this._dataSourceUsage[a]=p.filter(this._dataSourceUsage[a],function(a){return a!==b}))},_onUpdataDataSourceData:function(a,b){this.appConfig.dataSource.dataSources[a]?"widget"!==this.parseDataSourceId(a).from?console.error("Please update data source from widget only.",a):this._updateDataSourceData(a,
b):console.error("Not found data source id:",a)},_updateDataSourceData:function(a,b){this._dataStore[a]=b;q.publish("dataSourceDataUpdated",a,b);this.emit("update",a,b)},_onDataSourceDataUpdatedInApp:function(a,b){this._updateDataSourceData(a,b)},_onMapLoaded:function(a){this.map=a;window.isBuilder||this._handleDataSourceConfigChange(this.appConfig,this.appConfig,"mapLoaded")},_onMapChanged:function(a){this.map=a;window.isBuilder||this._handleDataSourceConfigChange(this.appConfig,this.appConfig,"mapChanged")},
_onAppConfigLoaded:function(a){this.appConfig=e.clone(a)},_onAppConfigChanged:function(a,b){a=e.clone(a);window.isBuilder||("dataSourceChange"===b?this._handleDataSourceConfigChange(this.appConfig,a,b):"mapChange"===b&&this._cleanForConfigChangedDataSource(this.appConfig,a));this.appConfig=a},_handleDataSourceConfigChange:function(a,b,c){a&&(this._removeListeners(),this._removeTimers(),this._cleanForConfigChangedDataSource(a,b));p.forEach(Object.keys(b.dataSource.dataSources),function(a){b.dataSource.dataSources[a].idObj=
this.parseDataSourceId(a)},this);this._listenDataSourceChange(b.dataSource.dataSources);this._startRefreshTimer(b.dataSource,c);this._initStaticDataSource(b.dataSource)},_cleanForConfigChangedDataSource:function(a,b){var c=a.dataSource.dataSources,d=b.dataSource.dataSources;p.forEach(Object.keys(c),function(a){if(!d[a]||d[a]&&!h.isEqual(d[a],c[a]))delete this._jimuQueryObject[a],this._updateDataSourceData(a,{features:[]}),delete this._dataStore[a]},this)},_isGlobalRefresh:function(a){return a.unifiedRefreshInterval&&
0<a.unifiedRefreshInterval},_startOneDataSource:function(a){var b;b=this._isGlobalRefresh(this.appConfig.dataSource.settings)?this.appConfig.dataSource.settings.unifiedRefreshInterval:a.refreshInterval;if("map"===a.idObj.from)this._listenMapDataSourceChange(a);else if("external"===a.idObj.from&&a.filterByExtent){var c={};c.handle=this.map.on("extent-change",e.hitch(this,this._onLayerDataChange,a));c.dsId=a.id;this._listeners.push(c)}if("map"===a.idObj.from||"external"===a.idObj.from)this._refeshDataSource(a),
a.isDynamic&&(c={},c.handle=setInterval(e.hitch(this,this._refeshDataSource,a),6E4*b),c.dsId=a.id,this._refreshTimers.push(c))},_stopAndCleanOneDataSource:function(a){this._listeners=p.filter(this._listeners,function(b){return b.dsId===a.id?(b.handle.remove(),!1):!0},this);this._refreshTimers=p.filter(this._refreshTimers,function(b){return b.dsId===a.id?(clearInterval(b.handle),!1):!0},this);this._updateDataSourceData(a.id,{features:[]})},_listenDataSourceChange:function(a){p.forEach(Object.keys(a),
function(b){b=a[b];if("map"===b.idObj.from)this._listenMapDataSourceChange(b);else if("external"===b.idObj.from&&b.filterByExtent){var c={};c.handle=this.map.on("extent-change",e.hitch(this,this._onLayerDataChange,b));c.dsId=b.id;this._listeners.push(c)}},this)},_listenMapDataSourceChange:function(a){this._getLayerObject(a.idObj.layerId).then(e.hitch(this,function(b){if(b){var c={};c.handle=b.on("edits-complete",e.hitch(this,this._onLayerDataChange,a));c.dsId=a.id;this._listeners.push(c);c={};c.handle=
this._getLayerInfo(a.idObj.layerId).on("filterChanged",e.hitch(this,this._onLayerDataChange,a));c.dsId=a.id;this._listeners.push(c);a.filterByExtent&&(c={},c.handle=this.map.on("extent-change",e.hitch(this,this._onLayerDataChange,a)),c.dsId=a.id,this._listeners.push(c))}else console.error("Can not find layer that data source depends on.",a.id)}))},_onLayerDataChange:function(a){this._doQueryForDataSource(a)},_doQueryForDataSource:function(a){("config"===this.appConfig.mode||this._dataSourceUsage[a.id]&&
0!==this._dataSourceUsage[a.id].length)&&this.doQuery(a).then(e.hitch(this,function(b){this._updateDataSourceData(a.id,{features:b.features})}))},_getLayerObject:function(a){return(a=f.getInstanceSync().getLayerOrTableInfoById(a))?a.getLayerObject():l(null)},_getLayerInfo:function(a){return f.getInstanceSync().getLayerOrTableInfoById(a)},_startRefreshTimer:function(a,b){var c=a.dataSources,d=a.settings;p.forEach(Object.keys(c),function(g){g=c[g];if("widget"!==g.idObj.from&&g.isDynamic&&g.url){var f;
f=this._isGlobalRefresh(d)?d.unifiedRefreshInterval:g.refreshInterval;"dataSourceChange"===b?"external"!==g.idObj.from&&"map"!==g.idObj.from||this._refeshDataSource(g):"external"===g.idObj.from&&this._refeshDataSource(g);g={handle:setInterval(e.hitch(this,this._refeshDataSource,g),6E4*f),dsId:a.id};this._refreshTimers.push(g)}},this)},_initStaticDataSource:function(a){p.forEach(Object.keys(a.dataSources),function(b){b=a.dataSources[b];"widget"!==b.idObj.from&&!b.isDynamic&&b.url&&this._doQueryForDataSource(b)},
this)},_refeshDataSource:function(a){this._doQueryForDataSource(a)},_getDataSourceFilter:function(a){if("map"===a.idObj.from){var b=f.getInstanceSync().getLayerOrTableInfoById(a.idObj.layerId),c;b&&(c=b.getFilter());var b=a.filter?this._getFilterExpr(a.filter,a.url):"1\x3d1",d;d=c?"("+c+") and ("+b+")":b;return l(d)}return"external"===a.idObj.from?a.portalUrl&&a.itemId?this._getFilterFromItem(a.portalUrl,a.itemId,a.url).then(e.hitch(this,function(b){var c=a.filter?this._getFilterExpr(a.filter,a.url):
"1\x3d1";return d=b?"("+b+") and ("+c+")":c})):l(a.filter?this._getFilterExpr(a.filter,a.url):"1\x3d1"):l(a.filter?this._getFilterExpr(a.filter,a.url):"1\x3d1")},_getFilterExpr:function(a,b){return this.filterUtils.hasVirtualDate(a)?(this.filterUtils.isHosted=h.isHostedService(b),this.filterUtils.getExprByFilterObj(a)):a.expr},_getFilterFromItem:function(a,b,g){var f=c.getItemUrl(a,b);if(this._itemsFilter[f])return l(this._itemsFilter[f]);var m=d.getPortal(a);return m.getItemById(b).then(e.hitch(this,
function(a){return"Feature Service"!==a.type?this._itemsFilter[f]=null:m.getItemData(b).then(e.hitch(this,function(a){var b=g.split("/"),c=b.pop();c||(c=b.pop());if(!a.layers)return this._itemsFilter[f]=null;a=a.layers.filter(function(a){return a.id+""===c})[0];return a&&a.layerDefinition?this._itemsFilter[f]=a.layerDefinition.definitionExpression:this._itemsFilter[f]=null}))}))},doQuery:function(a){a.idObj||(a.idObj=this.parseDataSourceId(a.id));return this._getQueryObjectFromDataSource(a).then(e.hitch(this,
function(c){var d,f;if("Features"===a.type){if("serviceLimitation"===a.resultRecordType)return d=c,f=new g(a.url),f.execute(d);var l=this._jimuQueryObject[a.id];!l||l.url===a.url&&h.isEqual(l.query.toJson(),c.toJson())||(delete this._jimuQueryObject[a.id],l=null);l||(l={},l.url=a.url,l.query=c,"all"!==a.resultRecordType&&(l.pageSize=a.resultRecordCount),l=new m(l),this._jimuQueryObject[a.id]=l);return"all"===a.resultRecordType?l.getAllFeatures():l.queryByPage(1)}f=new g(a.url);d=new b;return this._getDataSourceFilter(a).then(e.hitch(this,
function(b){d.where=b;a.dataSchema.groupByFields&&0<a.dataSchema.groupByFields.length&&(d.groupByFieldsForStatistics=a.dataSchema.groupByFields);a.dataSchema.orderByFields&&0<a.dataSchema.orderByFields.length&&(d.orderByFields=a.dataSchema.orderByFields);d.outStatistics=a.dataSchema.statistics.map(function(a){var b=new u;b.statisticType=a.statisticType;b.onStatisticField=a.onStatisticField;b.outStatisticFieldName=a.outStatisticFieldName;return b});return f.execute(d)}))}))},_getQueryObjectFromDataSource:function(a){return this._getDataSourceFilter(a).then(e.hitch(this,
function(c){var d=new b;d.where=c;a.filterByExtent&&(d.geometry=this.map.extent);d.outFields=a.dataSchema.fields.map(function(a){return a.name});a.dataSchema.orderByFields&&0<a.dataSchema.orderByFields.length&&(d.orderByFields=a.dataSchema.orderByFields);d.returnGeometry=!0;d.outSpatialReference=this.map.spatialReference;return l(d)}))},_removeListeners:function(){this._listeners.forEach(e.hitch(this,function(a){a.handle.remove()}));this._listeners=[]},_removeTimers:function(){this._refreshTimers.forEach(e.hitch(this,
function(a){clearInterval(a.handle)}));this._refreshTimers=[]}});t.getInstance=function(){null===r&&(r=new t,window._datasourceManager=r);return r};return t})},"jimu/LayerInfos/LayerInfos":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/Deferred dojo/on dojo/topic dojo/Evented dojo/promise/all ./LayerInfoFactory".split(" "),function(k,e,p,q,n,l,h,f,d){var c=k([h],{declaredClass:"jimu.LayerInfos",map:null,_operLayers:null,_layerInfos:null,_finalLayerInfos:null,_tableInfos:null,
_basemapLayers:null,_unreachableLayersTitleOfWebmap:null,_objectId:null,_layerInfoFactory:null,constructor:function(a,b){this._objectId=Math.random();this._unreachableLayersTitleOfWebmap=[];this._basemapLayers=b.baseMap.baseMapLayers;this._operLayers=b.operationalLayers;this._tables=b.tables;this._layerInfoFactory=new d(a,this);this.map=a;this._initLayerInfos();this._initTablesInfos();this.update();this._bindEvents()},update:function(){this._extraSetLayerInfos();this._clearAddedFlag(this._finalLayerInfos);
this._initFinalLayerInfos();this._markFirstOrLastNode()},getLayerInfoArrayOfWebmap:function(){var a=[];e.forEach(this.getLayerInfoArray(),function(b){for(var c=0;c<this._operLayers.length;c++)if(b.id===this._operLayers[c].id){a.push(b);break}c===this._operLayers.length&&0<=this._removedLayerInfoIdsFromFeatureCollection.indexOf(b.id)&&a.push(b)},this);return a},getTableInfoArrayOfWebmap:function(){var a=[];e.forEach(this.getTableInfoArray(),function(b){for(var c=0;c<this._tables.length;c++)if(b.id===
this._tables[c].id){a.push(b);break}},this);return a},getLayerInfoArray:function(){return e.filter(this._finalLayerInfos,function(a){p.getObject("_wabProperties.isTemporaryLayer",!1,a.layerObject)&&(a._flag._isTemporaryLayerInfo=!0);return!a._flag._isTemporaryLayerInfo})},getTableInfoArray:function(){return this._tableInfos},addFeatureCollection:function(a,b){var c=this._getUniqueTopLayerInfoId(b),d={layers:[]};e.forEach(a,function(a,b){a.id=c+"_"+b;d.layers.push({id:a.id,layerObject:a})},this);this.map.addLayers(a);
var g;try{g=this._layerInfoFactory.create({featureCollection:d,title:b||c,id:c},this.map),g.init()}catch(v){console.warn(v.message),g=null}g&&(g._extraOfWebmapLayerInfo=!0,this._layerInfos.push(g),this.update(),this._onLayersUpdated(g,g.getRootLayerInfo()))},addTable:function(a){a=this._addTables([a],this._tableInfos);return a[0]?a[0]:null},removeTable:function(a){var b=-1;e.forEach(this._tableInfos,function(c,d){a.id===c.id&&(b=d)});if(0<=b){var d=this._tableInfos[b];this._tableInfos.splice(b,1);
d.destroy();this._onTableChange([a],c.REMOVED)}},_addTables:function(a,b){var d=[],g=[];e.forEach(a,function(a){var c;try{a.layerObject={url:a.url,featureCollectionData:a.featureCollectionData,empty:!0},a.id=this._getUniqueTableId(a.id),a.selfType="table",c=this._layerInfoFactory.create(a),c.init()}catch(y){console.warn(y.message),c=null}c&&(d.push(c),b.push(c),g.push(c.getLayerObject()))},this);f(g).then(p.hitch(this,function(a){var b=[];e.forEach(a,function(a,c){c=d[c];a?b.push(c):(this.removeTable(c),
c.destroy())},this);this._onTableChange(b,c.ADDED)}));return d},_getUniqueTableId:function(a){var b=this._tableInfos.concat(this._tableInfos||[]);return this._getUniqueLayerOrTableId(a,b)},_getUniqueTopLayerInfoId:function(a){return this._getUniqueLayerOrTableId(a,this._finalLayerInfos)},_getUniqueLayerOrTableId:function(a,b){var c=1,d;a||(a="table");for(d=a;;){for(var g=0;g<b.length&&b[g].id!==d;g++);if(g===b.length)return d;d=a+"_"+c.toString();c++}},_traversal:function(a,b){for(var c=0;c<b.length;c++)if(b[c].traversal(a))return!0;
return!1},traversal:function(a){var b=this.getLayerInfoArray();return this._traversal(a,b)},traversalLayerInfosOfWebmap:function(a){var b=this.getLayerInfoArrayOfWebmap();return this._traversal(a,b)},traversalAll:function(a){var b=this.getLayerInfoArray(),c=this.getTableInfoArray();return this._traversal(a,b.concat(c))},_traversalAllWithSpecialLayerInfo:function(a){return this._traversal(a,this._finalLayerInfos.concat(this._tableInfos))},getLayerInfoById:function(a){return this._findLayerInfoById(a)},
getTableInfoById:function(a){var b=null;e.some(this.getTableInfoArray(),function(c){if(c.id===a)return b=c,!0});return b},getLayerOrTableInfoById:function(a){var b=null;this.traversalAll(function(c){if(c.id===a)return b=c,!0});return b},getLayerInfoByTopLayerId:function(a){return this._findTopLayerInfoById(a)},moveUpLayer:function(a,b){var c=null;b=b?b:1;a=this._getTopLayerInfoIndexById(a.id);0<=a-b&&(c=this._finalLayerInfos[a-b].obtainLayerIndexesInMap().length,this._finalLayerInfos[a].moveLayerByIndex(this._finalLayerInfos[a-
b].obtainLayerIndexesInMap()[c-1].index),c=this._finalLayerInfos[a-b],l.publish("layerInfos/layerReorder",a,b,"moveup"));return c},_reorderLayerInfosArray:function(a,b,c){"moveup"===c?(c=this._finalLayerInfos[a],this._finalLayerInfos.splice(a,1),this._finalLayerInfos.splice(a-b,0,c)):(c=this._finalLayerInfos[a],this._finalLayerInfos.splice(a+b+1,0,c),this._finalLayerInfos.splice(a,1));this._markFirstOrLastNode();return c},moveDownLayer:function(a,b){var c=null;b=b?b:1;a=this._getTopLayerInfoIndexById(a.id);
a+b<=this._finalLayerInfos.length-1&&(this._finalLayerInfos[a].moveLayerByIndex(this._finalLayerInfos[a+b].obtainLayerIndexesInMap()[0].index),c=this._finalLayerInfos[a+b],l.publish("layerInfos/layerReorder",a,b,"movedown"));return c},getBasemapLayers:function(){var a=[];e.forEach(this.map.layerIds.concat(this.map.graphicsLayerIds||[]),function(b){b=this.map.getLayer(b);"basemap"!==b._basemapGalleryLayerType&&"reference"!==b._basemapGalleryLayerType||a.push(b)},this);0===a.length&&(a=this._basemapLayers);
return a},getMapNotesLayerInfoArray:function(){return e.filter(this.getLayerInfoArray(),function(a){return a.isMapNotesLayerInfo()},this)},restoreState:function(a){var b=a&&a.layerOptions?a.layerOptions:null;e.forEach(this._finalLayerInfos,function(a){a.resetLayerObjectVisibility(b)},this)},getUnreachableLayersTitle:function(){return this._unreachableLayersTitleOfWebmap},getObjectId:function(){return this._objectId},_initLayerInfos:function(){var a;this._layerInfos=[];e.forEach(this._operLayers,function(b){try{a=
this._layerInfoFactory.create(b),a.init()}catch(m){console.warn(m.message),a=null,this._unreachableLayersTitleOfWebmap.push(b.title)}a&&this._layerInfos.push(a)},this)},_extraSetLayerInfos:function(){this._removedLayerInfoIdsFromFeatureCollection=[];e.forEach(this._finalLayerInfos||this._layerInfos,function(a,b){var c;if(a._needToRenew()){try{c=this._layerInfoFactory.create(a.originOperLayer),c.init()}catch(t){console.warn(t.message),c=null}c&&(a.destroy(),this._finalLayerInfos[b]=c)}else if(a.originOperLayer.featureCollection){var d=
[];e.forEach(a.getSubLayers(),function(a){d.push(a.id)});e.forEach(d,function(b){this.map.getLayer(b)||a.removeSubLayerById(b)},this);1===a.getSubLayers().length&&(b=a.getSubLayers()[0],this.map.getLayer(b.id).title=a.title,a.removeSubLayerById(b.id),this._removedLayerInfoIdsFromFeatureCollection.push(b.id),a.id+="_logically_removed")}},this)},_refineFinalLayerInfos:function(){this._finalLayerInfos&&(this._finalLayerInfos=e.filter(this._finalLayerInfos,function(a){return!a._flag._invalid}))},_initFinalLayerInfos:function(){var a,
b,c=this._finalLayerInfos||this._layerInfos;this._finalLayerInfos=[];for(a=this.map.graphicsLayerIds.length-1;0<=a;a--)b=this.map.graphicsLayerIds[a],this._isBasemap(b)||this._addToFinalLayerInfos(this._findLayerInfoByIdAndReturnTopLayer(b,c),b,!0);for(a=this.map.layerIds.length-1;0<=a;a--)b=this.map.layerIds[a],this._isBasemap(b)||this._addToFinalLayerInfos(this._findLayerInfoByIdAndReturnTopLayer(b,c),b,!1);this._refineFinalLayerInfos()},_initTablesInfos:function(){this._tableInfos=[];var a=this._tables&&
this._tables.reverse();a&&this._addTables(a,this._tableInfos)},_isBasemap:function(a){for(var b=!1,c=this.getBasemapLayers(),d=0;d<c.length;d++)c[d].id===a&&(b=!0);return b},_addToFinalLayerInfos:function(a,b,c){var d;if(a)a._addedFlag||a.isGraphicLayer()!==c||(this._finalLayerInfos.push(a),a._addedFlag=!0);else{a=this.map.getLayer(b);if("esri.layers.GraphicsLayer"!==a.declaredClass&&"esri.layers.LabelLayer"!==a.declaredClass){try{var g={layerObject:a,title:this._getLayerTitle(a),id:a.id||" "};p.mixin(g,
p.getObject("_wabProperties.originOperLayer",!1,a));d=this._layerInfoFactory.create(g,this.map);d.init()}catch(v){console.warn(v.message),d=null}d&&(p.getObject("_wabProperties.isTemporaryLayer",!1,a)&&(d._flag._isTemporaryLayerInfo=!0),this._finalLayerInfos.push(d))}("esri.layers.ArcGISDynamicMapServiceLayer"===a.declaredClass||"esri.layers.ArcGISTiledMapServiceLayer"===a.declaredClass)&&d&&d._getServiceDefinition().then(p.hitch(this,function(a){var b=[];e.forEach(a.tables,function(a){a.url=d.getUrl()+
"/"+a.id;a.id=d.id+"_"+a.id;a.title=this._getLayerTitle(a);b.push(a)},this);this._addTables(b,this._tableInfos)}))}},_getLayerTitle:function(a){if(a.title)return a.title;if(p.getObject("_wabProperties.originalLayerName",!1,a))return a.name||a.id;var b=a.label||a.name||"";if(a.url){var c;c=a.url.indexOf("/FeatureServer");-1===c&&(c=a.url.indexOf("/MapServer"));-1===c&&(c=a.url.indexOf("/service"));-1<c&&(c=a.url.substring(0,c),c=c.substring(c.lastIndexOf("/")+1,c.length),b=b?c+" - "+b:c)}return b||
a.id},_findLayerInfoByIdAndReturnTopLayer:function(a,b){var c,d=null;b||(b=this._finalLayerInfos);for(c=0;c<b.length;c++)if(d=b[c].findLayerInfoById(a)){d=b[c];break}return d},_findLayerInfoById:function(a,b){var c,d=null;b||(b=this._finalLayerInfos);for(c=0;c<b.length&&!(d=b[c].findLayerInfoById(a));c++);return d},_findTopLayerInfoById:function(a){var b,c=null,d=this._finalLayerInfos.concat(this._tableInfos);for(b=0;b<d.length;b++)if(d[b].id===a){c=d[b];break}return c},_getTopLayerInfoIndexById:function(a){var b,
c=-1;for(b=0;b<this._finalLayerInfos.length;b++)if(this._finalLayerInfos[b].id===a){c=b;break}return c},_clearAddedFlag:function(a){e.forEach(a,function(a){a._addedFlag=!1})},_markFirstOrLastNode:function(){var a;if(this._finalLayerInfos.length){for(a=0;a<this._finalLayerInfos.length;a++)this._finalLayerInfos[a].isFirst=!1,this._finalLayerInfos[a].isLast=!1;this._finalLayerInfos[0].isFirst=!0;this._finalLayerInfos[this._finalLayerInfos.length-1].isLast=!0;for(a=0;a<this._finalLayerInfos.length;a++)if(!this._finalLayerInfos[a].isGraphicLayer()){a&&
(this._finalLayerInfos[a-1].isLast=!0);this._finalLayerInfos[a].isFirst=!0;break}}},_onReceiveBasemapGalleryeData:function(a,b,c){"BasemapGallery"===a&&(this._basemapLayers.length=0,e.forEach(c,p.hitch(this,function(a){this._basemapLayers.push({layerObject:a,id:a.id})}),this),this.update(),this.emit("layerInfosChanged"))},_onBasemapChange:function(a){var b;for(b=this._basemapLayers.length=0;b<a.layers.length;b++)this._basemapLayers.push({layerObject:a.layer[b],id:a.layers[b].id})},_destroyLayerInfos:function(){e.forEach(this._finalLayerInfos,
p.hitch(this,function(a){a.destroy()}))},_bindEvents:function(){var a,b,d,f,e,h,k,w,q;a=n(this.map,"layer-add-result",p.hitch(this,this._onLayersChange,c.ADDED));b=n(this.map,"layer-remove",p.hitch(this,this._onLayersChange,c.REMOVED));k=l.subscribe("layerInfos/layerReorder",p.hitch(this,this._onLayerReorder));f=l.subscribe("layerInfos/layerInfo/isShowInMapChanged",p.hitch(this,this._onShowInMapChanged));e=l.subscribe("layerInfos/layerInfo/visibleChanged",p.hitch(this,this._onVisibleChanged));h=l.subscribe("layerInfos/layerInfo/filterChanged",
p.hitch(this,this._onFilterChanged));w=l.subscribe("layerInfos/layerInfo/rendererChanged",p.hitch(this,this._onRendererChanged));q=l.subscribe("layerInfos/layerInfo/opacityChanged",p.hitch(this,this._onOpacityChanged));d=n(this.map,"before-unload",p.hitch(this,function(){a.remove();b.remove();k.remove();f.remove();e.remove();h.remove();w.remove();d.remove();q.remove();this._destroyLayerInfos()}))},_emitEvent:function(){try{this.emit.apply(this,arguments)}catch(g){console.warn(g)}},_emitEventForEveryLayerInfo:function(a,
b){try{e.forEach(b,function(b){b.emitEvent(a)},this)}catch(m){console.warn(m)}},_onLayersChange:function(a,b){var d=null;b.error||"esri.layers.GraphicsLayer"===b.layer.declaredClass||"esri.layers.LabelLayer"===b.layer.declaredClass||b.layer._basemapGalleryLayerType||(a===c.ADDED?(this.update(),d=a=this._findLayerInfoById(b.layer.id),b=c.ADDED,a&&!a.isRootLayer()&&(d=a.getRootLayerInfo(),b=c.SUBLAYER_ADDED)):(d=a=this._findLayerInfoById(b.layer.id),b=c.REMOVED,a&&!a.isRootLayer()&&(d=a.getRootLayerInfo(),
b=c.SUBLAYER_REMOVED),a&&a.destroy(),this.update()),d&&this._emitEvent("layerInfosChanged",d,b,a))},_onTableChange:function(a,b){this._emitEvent("tableInfosChanged",a,b,a)},_onLayersUpdated:function(a,b){a.isTable?this._emitEvent("tableInfosChanged",[a],c.UPDATED,[b]):this._emitEvent("layerInfosChanged",a,c.UPDATED,b)},_onShowInMapChanged:function(a){this._emitEvent("layerInfosIsShowInMapChanged",a);this._emitEventForEveryLayerInfo("isShowInMapChanged",a)},_onVisibleChanged:function(a){this._emitEvent("layerInfosIsVisibleChanged",
a);this._emitEventForEveryLayerInfo("isVisibleChanged",a)},_onFilterChanged:function(a){this._emitEvent("layerInfosFilterChanged",a);this._emitEventForEveryLayerInfo("filterChanged",a)},_onLayerReorder:function(a,b,d){a=this._reorderLayerInfosArray(a,b,d);this._emitEvent("layerInfosReorder",a,c.REORDERED,a)},_onRendererChanged:function(a){this._emitEvent("layerInfosRendererChanged",a);this._emitEventForEveryLayerInfo("rendererChanged",a)},_onOpacityChanged:function(a){this._emitEvent("layerInfosOpacityChanged",
a);this._emitEventForEveryLayerInfo("opacityChanged",a)}});c.getLayerInfoArrayByType=function(a,b){var d=new q,g=[],h=[];c.getInstance(a,a.iteminfo).then(function(a){a.traversal(function(a){var b=a.getLayerType();b.layerInfo=a;g.push(b)});f(g).then(function(a){e.forEach(a,function(a,c){b===a&&h.push(g[c].layerInfo)});d.resolve(h)})});return d};var a=null,b=null;c.getInstance=function(a,b){var d=new q;d.resolve(c.getInstanceSyncForInit(a,b));return d};c.getInstanceSyncForInit=function(d,f){a&&a!==
d&&(b=a=null);b||(b=new c(d,f.itemData),a=d);return b};c.getInstanceSync=function(){return b};c.setInstance=function(c,d){a=c;b=d};c.createInstance=function(a){var b=null;return b=new c(a,a.itemInfo.itemData)};p.mixin(c,{ADDED:"added",REMOVED:"removed",SUBLAYER_ADDED:"subLayerAdded",SUBLAYER_REMOVED:"subLayerRemoved",UPDATED:"updated",REORDERED:"reordered"});return c})},"jimu/LayerInfos/LayerInfoFactory":function(){define("dojo/_base/declare jimu/LayerInfos/LayerInfoForCollection jimu/LayerInfos/LayerInfoForMapService jimu/LayerInfos/LayerInfoForKML jimu/LayerInfos/LayerInfoForGeoRSS jimu/LayerInfos/LayerInfoForDefault jimu/LayerInfos/LayerInfoForWMS jimu/LayerInfos/LayerInfoForDefaultDynamic jimu/LayerInfos/LayerInfoForDefaultTile jimu/LayerInfos/LayerInfoForDefaultWMS jimu/LayerInfos/LayerInfoForDefaultTable jimu/LayerInfos/LayerInfoForDefaultImage jimu/LayerInfos/LayerInfoForDefaultStream jimu/LayerInfos/LayerInfoForDefaultKML".split(" "),
function(k,e,p,q,n,l,h,f,d,c,a,b,g,u){return k(null,{constructor:function(a,b){this.map=a;this.layerInfos=b},create:function(m){var r=null;if(m.featureCollection)r=new e(m,this.map,this,this.layerInfos);else if("esri.layers.KMLLayer"===m.layerObject.declaredClass)r=new q(m,this.map,this,this.layerInfos);else if("esri.layers.GeoRSSLayer"===m.layerObject.declaredClass)r=new n(m,this.map,this,this.layerInfos);else if("esri.layers.WMSLayer"!==m.layerObject.declaredClass||m.selfType)if("esri.layers.ArcGISDynamicMapServiceLayer"===
m.layerObject.declaredClass||"esri.layers.ArcGISTiledMapServiceLayer"===m.layerObject.declaredClass)r=new p(m,this.map,this,this.layerInfos);else if("esri.layers.ArcGISImageServiceLayer"===m.layerObject.declaredClass||"esri.layers.ArcGISImageServiceVectorLayer"===m.layerObject.declaredClass)r=new b(m,this.map,this,this.layerInfos);else if("esri.layers.StreamLayer"===m.layerObject.declaredClass)r=new g(m,this.map,this,this.layerInfos);else switch("Table"===m.layerObject.type&&(m.selfType="table"),
m.selfType){case "mapservice_dynamic_group":case "mapservice_dynamic":r=new f(m,this.map,this,this.layerInfos);break;case "mapservice_tiled_group":case "mapservice_tiled":r=new d(m,this.map,this,this.layerInfos);break;case "wms":r=new c(m,this.map,this,this.layerInfos);break;case "kml":r=new u(m,this.map,this,this.layerInfos);break;case "table":r=new a(m,this.map,this,this.layerInfos);break;default:r=new l(m,this.map,this,this.layerInfos)}else r=new h(m,this.map,this,this.layerInfos);return r}})})},
"jimu/LayerInfos/LayerInfoForCollection":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang esri/graphicsUtils ./LayerInfo esri/lang".split(" "),function(k,e,p,q,n,l){return k(n,{constructor:function(){this.layerObject={declaredClass:"esri.layers.FeatureCollection",type:"FeatureCollection",empty:!0}},getExtent:function(){var h=[],f;e.forEach(this.originOperLayer.featureCollection.layers,function(d){h=h.concat(d.layerObject.graphics)});0===h.length?f=null:(f=1===h.length?h[0].getLayer().fullExtent:
q.graphicsExtent(h),f=this._convertGeometryToMapSpatialRef(f));return f},_resetLayerObjectVisiblity:function(e){var f=e?e[this.id]:null;if(f){var d={},c;for(c in e)e.hasOwnProperty(c)&&"function"!==typeof e[c]&&(d[c]=e[c].visible);this._setSubLayerVisibleByCheckedInfo(d);this._setTopLayerVisible(f.visible)}},_setSubLayerVisibleByCheckedInfo:function(h){e.forEach(this.newSubLayers,function(f){l.isDefined(h[f.id])&&f.layerObject.setVisibility(h[f.id])},this)},_initVisible:function(){var e=!1,f;for(f=
0;f<this.newSubLayers.length;f++)e=e||this.newSubLayers[f].layerObject.visible;e&&(this._visible=!0)},_setTopLayerVisible:function(h){this._visible=h?!0:!1;e.forEach(this.newSubLayers,function(f){f.setLayerVisiblefromTopLayer()},this);this._onVisibilityChanged()},obtainNewSubLayers:function(){var h=[];e.forEach(this.originOperLayer.featureCollection.layers,function(f){this._getLayerIndexesInMapByLayerId(f.layerObject.id)&&(p.setObject("_wabProperties.originOperLayer.showLegend",this.originOperLayer.featureCollection.showLegend,
f.layerObject),f=this._layerInfoFactory.create({layerObject:f.layerObject,title:f.layerObject.label||f.layerObject.title||f.layerObject.name||f.layerObject.id||" ",id:f.id||"-",subId:f.id||"-",collection:{layerInfo:this},selfType:"collection",showLegend:!0,parentLayerInfo:this}),h.push(f),f.init())},this);h.reverse();return h},_obtainLayerIndexesInMap:function(){var e=[],f,d;for(d=0;d<this.newSubLayers.length;d++)(f=this._getLayerIndexesInMapByLayerId(this.newSubLayers[d].layerObject.id))&&e.push(f);
return e},moveLeftOfIndex:function(e){var f;for(f=this.newSubLayers.length-1;0<=f;f--)this.map.reorderLayer(this.newSubLayers[f].layerObject,e)},moveRightOfIndex:function(e){var f;for(f=0;f<this.newSubLayers.length;f++)this.map.reorderLayer(this.newSubLayers[f].layerObject,e)},_getShowLegendOfWebmap:function(){return void 0!==this.originOperLayer.featureCollection.showLegend?this.originOperLayer.featureCollection.showLegend:!0},getScaleRange:function(){var e=this.getSubLayers();return e[0]?e[0].getScaleRange():
{minScale:0,maxScale:0}}})})},"jimu/LayerInfos/LayerInfo":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/Deferred dojo/promise/all dojo/dom-construct dojo/topic dojo/aspect dojo/Evented jimu/portalUrlUtils jimu/portalUtils jimu/LayerNode ./RequestBuffer esri/request esri/config esri/tasks/ProjectParameters esri/SpatialReference esri/geometry/webMercatorUtils".split(" "),function(k,e,p,q,n,l,h,f,d,c,a,b,g,u,m,r,t,v){var y=k([d],{declaredClass:"jimu.LayerInfo",originOperLayer:null,
layerObject:null,map:null,title:null,id:null,subId:null,newSubLayers:null,parentLayerInfo:null,isTable:null,isTiled:null,_oldIsShowInMap:null,_oldFilter:null,_eventHandles:null,_subLayerInfoIndex:null,_serviceDefinitionBuffer:null,_flag:null,_objectId:null,_itemInfo:null,_adaptor:null,constructor:function(a,c,d,g){this.originOperLayer=a;this.layerObject=a.layerObject;this.map=c;this.title=this.originOperLayer.title;this.id=this.originOperLayer.id;this.subId=void 0!==this.originOperLayer.subId?this.originOperLayer.subId:
this.id;this.parentLayerInfo=a.parentLayerInfo?a.parentLayerInfo:null;this.isTiled=this.isTable=!1;this._eventHandles=[];this._layerInfoFactory=d;this._layerInfos=g;this._flag={};this._objectId=Math.random();this._adaptor=new b(this)},init:function(){this.newSubLayers=this.obtainNewSubLayers();this._initSubLayerInfoIndex();this._initVisible();this.originOperLayer.popupInfo&&(this.popupVisible=!0);this._oldIsShowInMap=this.isShowInMap();this._initOldFilter();this._initServiceDefinitionBuffer();this._bindEvent()},
_initOldFilter:function(){this._oldFilter=null},_initServiceDefinitionBuffer:function(){this._serviceDefinitionBuffer=new g(p.hitch(this,this._serviceDefinitionRequest))},isGraphicLayer:function(){var a=this._obtainLayerIndexesInMap();return a.length?a[0].isGraphicLayer:!1},obtainLayerIndexesInMap:function(){return this._obtainLayerIndexesInMap()},getObjectId:function(){return this._objectId},getExtent:function(){},getOpacity:function(){var a,b=0;for(a=0;a<this.newSubLayers.length;a++)if(this.newSubLayers[a].layerObject.opacity)b=
this.newSubLayers[a].layerObject.opacity>b?this.newSubLayers[a].layerObject.opacity:b;else return 1;return b},setOpacity:function(a){e.forEach(this.newSubLayers,function(b){b.layerObject.setOpacity&&b.layerObject.setOpacity(a)})},moveLayerByIndex:function(a){this.map.reorderLayer(this.layerObject,a)},traversal:function(a){if(a(this))return!0;for(var b=this.getSubLayers(),c=0;c<b.length;c++)if(b[c].traversal(a))return!0},findLayerInfoById:function(a){var b=null,c=0;if(this.id&&this.id===a)return this;
for(c=0;c<this.newSubLayers.length&&!(b=this.newSubLayers[c].findLayerInfoById(a));c++);return b},setTopLayerVisible:function(a){this._setTopLayerVisible(a)},_setTopLayerVisible:function(a){},_setSubLayerVisible:function(a,b){},setLayerVisiblefromTopLayer:function(){},_resetLayerObjectVisiblity:function(){},resetLayerObjectVisibility:function(a){var b=a?a[this.id]:null;this.isRootLayer()&&b&&this._resetLayerObjectVisiblity(a)},_initVisible:function(){},isVisible:function(){return this._visible?!0:
!1},show:function(){this._setTopLayerVisible(!0)},hide:function(){this._setTopLayerVisible(!1)},_obtainLayerIndexesInMap:function(){var a=[],b;(b=this._getLayerIndexesInMapByLayerId(this.id))&&a.push(b);return a},_getLayerIndexesInMapByLayerId:function(a){var b;for(b=0;b<this.map.graphicsLayerIds.length;b++)if(this.map.graphicsLayerIds[b]===a)return{isGraphicLayer:!0,index:b};for(b=0;b<this.map.layerIds.length;b++)if(this.map.layerIds[b]===a)return{isGraphicLayer:!1,index:b};return null},_convertGeometryToMapSpatialRef:function(a){var b=
new q;if(this.map.spatialReference.equals(a.spatialReference))return b.resolve([a]),b;if(this.map.spatialReference.isWebMercator()&&a.spatialReference.equals(new t(4326)))return b.resolve([v.geographicToWebMercator(a)]),b;if(this.map.spatialReference.equals(new t(4326))&&a.spatialReference.isWebMercator())return b.resolve([v.webMercatorToGeographic(a)]),b;b=new r;b.geometries=[a];b.outSR=this.map.spatialReference;return m.defaults.geometryService.project(b)},_isShowInMapChanged:function(){var a=!1,
b=this.isShowInMap();!1===b&&this.map.infoWindow.hide();this._oldIsShowInMap!==b&&(this._oldIsShowInMap=b,a=!0);return a},_isShowInMapChanged2:function(){var a=[];this.traversal(function(b){b._isShowInMapChanged()&&a.push(b)});h.publish("layerInfos/layerInfo/isShowInMapChanged",a)},_visibleChanged:function(){h.publish("layerInfos/layerInfo/visibleChanged",[this])},_initSubLayerInfoIndex:function(){var a={};this.isRootLayer()&&this.traversal(function(b){b.isRootLayer()||(a[b.subId]=b)});this._subLayerInfoIndex=
a},_getLayerInfosObj:function(){return this._layerInfos},obtainNewSubLayers:function(){return[]},createLegendsNode:function(){return l.create("div",{"class":"legends-div"})},drawLegends:function(a,b){},_getLayerTypesOfSupportTable:function(){return"FeatureLayer,CSVLayer,Table,ArcGISImageServiceLayer,StreamLayer,ArcGISImageServiceVectorLayer"},_getShowLegendOfWebmap:function(){return void 0!==this.originOperLayer.showLegend?this.originOperLayer.showLegend:!0},_needToRenew:function(){return!1},_getServiceDefinition:function(){var a=
new q;a.resolve(null);return a},_serviceDefinitionRequest:function(a){return this._normalRequest(a,{f:"json"},"json")},getServiceDefinition:function(){return this._getServiceDefinition()},_normalRequest:function(a,b,c){return u({url:a,content:b,handleAs:c,callbackParamName:"callback"})},getLayerObject:function(){var a=new q;this.layerObject?a.resolve(this.layerObject):a.resolve(null);return a},getLayerObjectTryUsingFeatureService:function(){return this.getLayerObject()},getSubLayers:function(){return this.newSubLayers},
isLeaf:function(){return 0===this.getSubLayers().length?!0:!1},isRootLayer:function(){return this.parentLayerInfo?!1:!0},getLayerLevel:function(){for(var a=0,b=this;b.parentLayerInfo;)a++,b=b.parentLayerInfo;return a},getRootLayerInfo:function(){for(var a=this;a.parentLayerInfo;)a=a.parentLayerInfo;return a},isShowInMap:function(){for(var a=!0,b=this;b;)a=a&&b.isVisible(),b=b.parentLayerInfo;return a},getLayerType:function(){var a=[null],b=new q;this.layerObject.declaredClass&&(a=this.layerObject.declaredClass.split("."));
b.resolve(a[a.length-1]);return b},getPopupInfo:function(){return this.originOperLayer.popupInfo},getPopupInfoFromLayerObject:function(){var a=this.getInfoTemplate(),b=null;a&&(b=a.info);return b},loadPopupInfo:function(){var a=new q;this.loadInfoTemplate().then(p.hitch(this,function(b){var c=null;b&&(c=b.info);a.resolve(c)}));return a},loadInfoTemplate:function(){var a=new q;a.resolve(null);return a},getInfoTemplate:function(){return null},getFilterOfWebmap:function(){return this.originOperLayer.layerDefinition?
this.originOperLayer.layerDefinition.definitionExpression:null},getFilter:function(){return null},setFilter:function(){},getShowLegendOfWebmap:function(){for(var a=this,b=!0;a;)b=b&&a._getShowLegendOfWebmap(),a=a.parentLayerInfo;return b},getUrl:function(){return this.layerObject.url||this.layerObject._url},hasLayerTypes:function(a){},getSupportTableInfo:function(){var a=new q,b={isSupportedLayer:!1,isSupportQuery:!1,layerType:null},c=this.getLayerType(),d=this.getLayerObject();n({type:c,layerObject:d}).then(p.hitch(this,
function(c){var d=c.type;c=c.layerObject;b.layerType=d;0<=this._getLayerTypesOfSupportTable().indexOf(d)&&(b.isSupportedLayer=!0);if(!c)b.isSupportQuery=!1;else if(this.parentLayerInfo&&this.parentLayerInfo.isMapNotesLayerInfo())b.isSupportQuery=!1;else if(!c.url||c.capabilities&&0<=c.capabilities.indexOf("Query"))b.isSupportQuery=!0;a.resolve(b)}),function(){a.resolve(b)});return a},getRelatedTableInfoArray:function(a){a=new q;a.resolve([]);return a},removeSubLayerById:function(a){var b=[];e.forEach(this.newSubLayers,
function(c){c.id!==a?b.push(c):c.destroy()});this.newSubLayers=b},releaseResource:function(){e.forEach(this._eventHandles,function(a){a.remove()});this.destroyLabelLayer();this._adaptor&&this._adaptor.destroy()},destroy:function(){e.forEach(this.newSubLayers,function(a){a.destroy()});this.releaseResource();this.inherited(arguments)},update:function(){e.forEach(this.newSubLayers,function(a){a.destroy()});this.releaseResource();this.init()},isMapNotesLayerInfo:function(){return this.originOperLayer.featureCollection&&
0===this.id.indexOf("mapNotes_")&&"ArcGISFeatureLayer"===this.originOperLayer.layerType&&!this.map.getLayer(this.id)?!0:!1},getScaleRange:function(){return this.layerObject&&0<=this.layerObject.minScale&&0<=this.layerObject.maxScale?{minScale:this.layerObject.minScale,maxScale:this.layerObject.maxScale}:{minScale:0,maxScale:0}},isCurrentScaleInTheScaleRange:function(){var a=this.getScaleRange(),b=this.map.getScale();return 0===a.minScale&&0===a.maxScale?!0:(0===a.minScale||a.minScale>b)&&(0===a.maxScale||
b>a.maxScale)?!0:!1},isInScale:function(){for(var a=!0,b=this;b&&(a=b.isCurrentScaleInTheScaleRange(),b=b.parentLayerInfo,a););return a},enablePopup:function(){},disablePopup:function(){},isPopupEnabled:function(){return!1},getCapabilitiesOfWebMap:function(){return this.originOperLayer.capabilities},isItemLayer:function(){return this._getBasicItemInfo()},_getBasicItemInfo:function(){var a=null,b=this.getRootLayerInfo(),d=window.appConfig||window.getAppConfig(),g=p.getObject("_wabProperties.itemLayerInfo",
!1,b.layerObject);b.originOperLayer.itemId?(a={},a.itemId=b.originOperLayer.itemId,a.portalUrl=c.getStandardPortalUrl(d.map.portalUrl||d.portalUrl)):g&&g.portalUrl&&g.itemId&&(a={},a.itemId=g.itemId,a.portalUrl=c.getStandardPortalUrl(g.portalUrl));return a},getItemInfo:function(){var a=new q,b=this.getRootLayerInfo();b.isItemLayer()?(b._itemInfo||(b._itemInfo=new y.ItemInfo(this,b)),b._itemInfo.onLoad().then(p.hitch(this,function(){a.resolve(b._itemInfo)}),p.hitch(this,function(){a.resolve(null)}))):
a.resolve(null);return a},isHostedService:function(){var a=new q;this._getServiceDefinition().then(p.hitch(this,function(b){a.resolve(b&&b.serviceItemId?!0:!1)}));return a},isHostedLayer:function(){var a;this.isItemLayer()?a=this.isHostedService():(a=new q,a.resolve(!1));return a},obtainLabelControl:function(){},restoreLabelControl:function(){},destroyRealtedLabelLayer:function(){},destroyLabelLayer:function(){},canShowLabel:function(){},isShowLabels:function(){},showLabels:function(){},hideLabels:function(){},
emitEvent:function(){try{this.emit.apply(this,arguments),this._adaptor&&this._adaptor.emitEvent.apply(this._adaptor,arguments)}catch(w){console.error(w)}},_bindEvent:function(){var a;this.layerObject&&!this.layerObject.empty&&(a=this.layerObject.on("visibility-change",p.hitch(this,this._onVisibilityChanged)),this._eventHandles.push(a),a=f.after(this.layerObject,"setDefinitionExpression",p.hitch(this,this._onFilterChanged)),this._eventHandles.push(a),a=f.after(this.layerObject,"setRenderer",p.hitch(this,
this._onRendererChanged)),this._eventHandles.push(a),this.isRootLayer()&&(a=this.layerObject.on("opacity-change",p.hitch(this,this._onOpacityChanged)),this._eventHandles.push(a)))},_onVisibilityChanged:function(){this._initVisible();this._visibleChanged();this._isShowInMapChanged2()},_onFilterChanged:function(){var a=this._oldFilter?this._oldFilter:null,b=this.layerObject.getDefinitionExpression(),b=b?b:null;a!==b&&(h.publish("layerInfos/layerInfo/filterChanged",[this]),this._oldFilter=b)},_onRendererChanged:function(){h.publish("layerInfos/layerInfo/rendererChanged",
[this])},_onOpacityChanged:function(){h.publish("layerInfos/layerInfo/opacityChanged",[this])}});y.ItemInfo=k(null,{_currentLayerInfo:null,_rootLayerInfo:null,_portalUrl:null,_itemId:null,_item:null,_itemData:null,_serviceDefinition:null,_itemInfoLoadedDef:null,constructor:function(a,b){this._currentLayerInfo=a;this._rootLayerInfo=b;this._loadResource()},_loadResource:function(){this._itemInfoLoadedDef=new q;var b=this._rootLayerInfo.isItemLayer();if(b){this._portalUrl=b.portalUrl;this._itemId=b.itemId;
var c=a.getPortal(this._portalUrl),b=c.getItemById(this._itemId),c=c.getItemData(this._itemId),d=this._currentLayerInfo._getServiceDefinition();n({item:b,itemData:c,serviceDefinition:d}).then(p.hitch(this,function(a){this._item=a.item;this._itemData=a.itemData;this._serviceDefinition=a.serviceDefinition;this._itemInfoLoadedDef.resolve(this)}),p.hitch(this,function(a){a&&a.message&&console.log(a.message);this._itemInfoLoadedDef.reject()}))}else this._itemInfoLoadedDef.reject()},onLoad:function(){return this._itemInfoLoadedDef},
getPortalUrl:function(){return this._portalUrl},getItemId:function(){return this._itemId},getItem:function(){return this._item},getItemData:function(){return this._itemData},isHostedLayer:function(){return this._serviceDefinition&&this._serviceDefinition.serviceItemId?!0:!1}});return y})},"jimu/LayerNode":function(){define(["dojo/_base/declare","dojo/_base/array","dojo/_base/lang","dojo/Deferred","dojo/Evented"],function(k,e,p,q,n){var l=k([n],{declaredClass:"jimu.LayerNode",_layerInfo:null,map:null,
title:null,id:null,subId:null,layerObject:null,constructor:function(e){this._layerInfo=e;this.map=e.map;this.title=e.title;this.id=e.id;this.subId=e.subId},isLeaf:function(){return this._layerInfo.isLeaf()},isRoot:function(){return this._layerInfo.isRootLayer()},toggle:function(){this._layerInfo.setTopLayerVisible(!this.isToggledOn())},isToggledOn:function(){return this._layerInfo.isVisible()},show:function(){this._layerInfo.show()},hide:function(){this._layerInfo.hide()},isVisible:function(){return this._layerInfo.isShowInMap()},
traversal:function(e){return this._layerInfo.traversal(function(f){return e(f._adaptor)})},getNodeById:function(e){var f=null;if(e=this._layerInfo.findLayerInfoById(e))f=e._adaptor;return f},getExtent:function(){return this._layerInfo.getExtent()},getOpacity:function(){return this._layerInfo.getOpacity()},setOpacity:function(e){this._layerInfo.setOpacity(e)},getServiceDefinition:function(){return this._layerInfo.getServiceDefinition()},getLayerObject:function(){return this._layerInfo.getLayerObject()},
getRootNode:function(){return this._layerInfo.getRootLayerInfo()._adaptor},getParentNode:function(){var e=this._layerInfo.parentLayerInfo;return e?e._adaptor:null},getSubNodes:function(){return this._getNodesArrayFromInfosArray(this._layerInfo.getSubLayers())},getNodeLevel:function(){return this._layerInfo.getLayerLevel()},getLayerType:function(){return this._layerInfo.getLayerType()},getPopupInfoFromWebmap:function(){return this._layerInfo.getPopupInfo()},getPopupInfo:function(){return this._layerInfo.getPopupInfoFromLayerObject()},
loadPopupInfo:function(){return this._layerInfo.loadPopupInfo()},getInfoTemplate:function(){return this._layerInfo.getInfoTemplate()},loadInfoTemplate:function(){return this._layerInfo.loadInfoTemplate()},getFilterFromWebmap:function(){return this._layerInfo.getFilterOfWebmap()},getFilter:function(){return this._layerInfo.getFilter()},setFilter:function(e){this._layerInfo.setFilter(e)},isShowLegend:function(){return this.isShowLegendFromWebmap()},isShowLegendFromWebmap:function(){return this._layerInfo.getShowLegendOfWebmap()},
isToggledOnLegendFromWebMap:function(){return this._layerInfo._getShowLegendOfWebmap()},getUrl:function(){return this._layerInfo.getUrl()},getRelatedNodes:function(){var e=new q;this._layerInfo.getRelatedTableInfoArray().then(p.hitch(this,function(f){e.resolve(this._getNodesArrayFromInfosArray(f))}));return e},isVisibleAtMapScale:function(){return this._layerInfo.isInScale()},enablePopup:function(){return this._layerInfo.enablePopup()},disablePopup:function(){return this._layerInfo.disablePopup()},
isPopupEnabled:function(){return this._layerInfo.isPopupEnabled()},isItemLayer:function(){return this._layerInfo.isItemLayer()},getItemInfo:function(){return this._layerInfo.getItemInfo()},isHostedService:function(){return this._layerInfo.isHostedService()},isHostedLayer:function(){return this._layerInfo.isHostedLayer()},canShowLabel:function(){return this._layerInfo.canShowLabel()},isLabelVisble:function(){return this._layerInfo.isShowLabels()},showLabel:function(){this._layerInfo.showLabels()},
hideLabel:function(){this._layerInfo.hideLabels()},isTable:function(){return!!this._layerInfo.isTable},isTiled:function(){return!!this._layerInfo.isTiled},emitEvent:function(e){try{var f=null;switch(e){case "isVisibleChanged":f=l.EVENT_TOOGLE_CHANGE;break;case "isShowInMapChanged":f=l.EVENT_VISIBILITY_CHANGE;break;case "filterChanged":f=l.EVENT_FILTER_CHANGE;break;case "rendererChanged":f=l.EVENT_RENDERER_CHANGE;break;case "opacityChanged":f=l.EVENT_OPACITY_CHANGE}f&&this.emit(f)}catch(d){console.error(d)}},
destroy:function(){this.inherited(arguments)},_getNodesArrayFromInfosArray:function(h){var f=[];e.forEach(h,function(d){f.push(d._adaptor)},this);return f}});p.mixin(l,{EVENT_TOOGLE_CHANGE:"toggle-change",EVENT_VISIBILITY_CHANGE:"visibility-change",EVENT_FILTER_CHANGE:"filter-change",EVENT_RENDERER_CHANGE:"renderer-change",EVENT_OPACITY_CHANGE:"opacity-change"});return l})},"jimu/LayerInfos/RequestBuffer":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/Deferred"],function(k,e,p){var q=
k(null,{_realRequest:null,_buffer:null,constructor:function(e){this._buffer={};this._realRequest=e?e:function(){return new p}},getRequest:function(e){this._buffer[e]||(this._buffer[e]=new q.RequestProxy(this._realRequest,e));return this._buffer[e]},request:function(e){var l=Array.prototype.slice.apply(arguments);l.splice(0,1);var h=this.getRequest(e);return h.request.apply(h,l)},setResponse:function(e,l){this.getRequest(e).setResponse(l)},isResolved:function(e){return this.getRequest(e).isResolved()}});
q.RequestProxy=k(null,{_key:null,_deferred:null,_realRequest:null,constructor:function(e,l){this._realRequest=e;this._key=l},request:function(){this._deferred||(this._deferred=new p,this._realRequest.apply(null,arguments).then(e.hitch(this,function(e){this._deferred.resolve(e)}),e.hitch(this,function(e){e&&console.warn(e.message||e);e=this._deferred;this._deferred=null;e.resolve(null)})));return this._deferred},fakeRequest:function(){this._deferred||(this._deferred=new p);return this._deferred},setResponse:function(e){this._deferred||
(this._deferred=new p);null===e||void 0===e?(this._deferred.resolve(null),this._deferred=null):this._deferred.resolve(e)},isResolved:function(){return this._deferred&&this._deferred.isResolved()}});return q})},"jimu/LayerInfos/LayerInfoForMapService":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/Deferred dojo/json dojo/aspect dojo/topic ./LayerInfo esri/request esri/lang".split(" "),function(k,e,p,q,n,l,h,f,d,c){return k(f,{_legendInfo:null,_sublayerIdent:null,controlPopupInfo:null,
_jsapiLayerInfos:null,_oldFilter:null,_subLayerVisible:null,constructor:function(){},init:function(){this._initJsapiLayerInfos();this._initSubLayerVisible();this._initSubLayerIdent();this._initControlPopup();this.inherited(arguments);this._needToRefresh().then(p.hitch(this,function(a){a&&(this.update(),this._getLayerInfosObj()._onLayersUpdated(this,this))}))},_needToRefresh:function(){var a=new q;this.layerObject.dynamicLayerInfos&&this.isRootLayer()&&this.isItemLayer()&&!this.originOperLayer.thematicGroup?
this.getItemInfo().then(p.hitch(this,function(b){(b=(b=b.getItemData())&&b.thematicGroup)?(this.originOperLayer.thematicGroup=b,a.resolve(!0)):a.resolve(!1)})):a.resolve(!1);return a},_initOldFilter:function(){this._oldFilter=this.layerObject&&this.layerObject.layerDefinitions?this.layerObject.layerDefinitions:[]},_initJsapiLayerInfos:function(){var a=e.filter(this.originOperLayer.layers,function(a){return c.isDefined(a.id)&&c.isDefined(a.name)&&c.isDefined(a.minScale)&&c.isDefined(a.maxScale)&&c.isDefined(a.parentLayerId)&&
c.isDefined(a.defaultVisibility)});this._jsapiLayerInfos=this.layerObject.dynamicLayerInfos?this.originOperLayer.thematicGroup&&this.originOperLayer.thematicGroup.layerIds&&0<=this.originOperLayer.thematicGroup.layerIds.length?e.filter(this.layerObject.dynamicLayerInfos,function(a){return-1<this.originOperLayer.thematicGroup.layerIds.indexOf(a.id)?!0:!1},this):this.layerObject.dynamicLayerInfos:0<a.length?a:this.layerObject.layerInfos},_initControlPopup:function(){this.controlPopupInfo={enablePopup:void 0,
infoTemplates:p.clone(this.layerObject.infoTemplates)};this.layerObject._infoTemplates=p.clone(this.layerObject.infoTemplates);l.after(this.layerObject,"setInfoTemplates",p.hitch(this,function(){this.layerObject._infoTemplates=p.clone(this.layerObject.infoTemplates);this.controlPopupInfo.infoTemplates=p.clone(this.layerObject.infoTemplates);this.traversal(function(a){a._afterSetInfoTemplates&&a._afterSetInfoTemplates()})}))},_initSubLayerIdent:function(){this._sublayerIdent={definitions:{},empty:!0,
defLoad:new q}},_initSubLayerVisible:function(a){this._subLayerVisible={};for(var b=0;b<this._jsapiLayerInfos.length;b++)this._subLayerVisible[this._jsapiLayerInfos[b].id]=!1;a?e.forEach(a,function(a){this._subLayerVisible[a]=!0},this):this.originOperLayer.visibleLayers?e.forEach(this.originOperLayer.visibleLayers,function(a){this._subLayerVisible[a]=!0},this):e.forEach(this._jsapiLayerInfos,function(a){a.defaultVisibility&&(this._subLayerVisible[a.id]=!0)},this)},_initVisible:function(){this._visible=
this.originOperLayer.layerObject.visible},_setTopLayerVisible:function(a){this.originOperLayer.layerObject.setVisibility(a);this._visible=a},_setSubLayerVisible:function(a){var b=[-1,-1,-1],c,d=[],f=e.filter(this.originOperLayer.layerObject.visibleLayers,function(a){return-1!==a});e.forEach(f,function(a){if(!this._isGroupLayerBySubId(a)){var b=this._subLayerInfoIndex[a];b&&b._isAllSubLayerVisibleOnPath()&&d.push(a)}},this);var f=d,h;for(h in a)if(a.hasOwnProperty(h)&&"function"!==typeof a[h]){var l=
Number(h);a[h]?(c=e.indexOf(f,l),0>c&&f.push(l)):(c=e.indexOf(f,l),0<=c&&f.splice(c,1))}b=b.concat(f);this.originOperLayer.layerObject.setVisibleLayers(b)},_resetLayerObjectVisiblity:function(a){var b=a?a[this.id]:null,c=!1;if(a&&(b&&this.layerObject.setVisibility(b.visible),"esri.layers.ArcGISDynamicMapServiceLayer"===this.layerObject.declaredClass)){var b={},d;for(d in a)a.hasOwnProperty(d)&&"function"!==typeof a[d]&&(c=!0,b[d]=a[d].visible);c&&this._setSubLayerVisibleByCheckedInfo(b)}},_setSubLayerVisibleByCheckedInfo:function(a){var b=
[];e.forEach(this._jsapiLayerInfos,function(d){var g=this.id+"_"+d.id;c.isDefined(a[g])?a[g]&&b.push(d.id):this._subLayerVisible[d.id]&&b.push(d.id)},this);this._initSubLayerVisible(b);this.traversal(function(a){a._initVisible()});var d={};this.traversal(function(a){0===a.getSubLayers().length&&(d[a.originOperLayer.mapService.subId]=a._isAllSubLayerVisibleOnPath())});this._setSubLayerVisible(d)},_subLayerVisibleChanged:function(){var a=[];this.traversal(function(b){a.push(b)});h.publish("layerInfos/layerInfo/visibleChanged",
a)},obtainNewSubLayers:function(){var a=[],b=this.originOperLayer.layerObject,c=null,c="esri.layers.ArcGISDynamicMapServiceLayer"===b.declaredClass?"dynamic":"tiled";e.forEach(this._jsapiLayerInfos,function(d){var g=null,g=b.url+"/"+d.id,f=b.id+"_"+d.id;d.subLayerIds&&0<d.subLayerIds.length?(g={url:g,empty:!0},this._addNewSubLayer(a,g,f,d,c+"_group")):(g={url:g,empty:!0},this._addNewSubLayer(a,g,f,d,c))},this);var d=[];e.forEach(this._jsapiLayerInfos,function(b,c){b=b.parentLayerId;if(-1!==b){for(var d=
null,g=0;g<a.length;g++)if(a[g].mapService.subId===b){d=a[g];break}(b=d)&&b.subLayers.push(a[c])}},this);e.forEach(this._jsapiLayerInfos,function(b,c){-1===b.parentLayerId&&(b=this._layerInfoFactory.create(a[c]),d.push(b),b.init())},this);return d},_addNewSubLayer:function(a,b,c,d,f){var g=d.source&&d.source.mapLayerId;if(void 0===g||null===g)g=d.id;a.push({layerObject:b,title:d.name||d.id||" ",id:c||"-",subId:d.id,subLayers:[],mapService:{layerInfo:this,subId:d.id,mapServiceSubId:g},selfType:"mapservice_"+
f,parentLayerInfo:this})},_handleErrorSubLayer:function(a,b,c,d,f,e){a[b]={layerObject:null,title:e.name||e.id||" ",id:c||" ",subLayers:[],mapService:{layerInfo:this,subId:d}}},getExtent:function(){return this._convertGeometryToMapSpatialRef(this.originOperLayer.layerObject.fullExtent||this.originOperLayer.layerObject.initialExtent)},getOpacity:function(){return this.layerObject.opacity?this.layerObject.opacity:1},setOpacity:function(a){this.layerObject.setOpacity&&this.layerObject.setOpacity(a)},
getLegendInfo:function(a){var b=new q;this._legendInfo?b.resolve(this._legendInfo):this._legendRequest(a).then(p.hitch(this,function(a){this._legendInfo=a.layers;b.resolve(this._legendInfo)}),function(){b.reject()});return b},_legendRequest:function(a){return 10.01<=this.layerObject.version?this._legendRequestServer():this._legendRequestTools(a)},_legendRequestServer:function(){var a=this.layerObject.url+"/legend",b={f:"json"};this.layerObject._params.dynamicLayers&&(b.dynamicLayers=n.stringify(this._createDynamicLayers(this.layerObject)),
"[{}]"===b.dynamicLayers&&(b.dynamicLayers="[]"));return d({url:a,content:b,handleAs:"json",callbackParamName:"callback"})},_legendRequestTools:function(a){return d({url:a+"sharing/tools/legend?soapUrl\x3d"+this.layerObject.url,content:{f:"json"},handleAs:"json",callbackParamName:"callback"})},_createDynamicLayers:function(a){var b=[],c;e.forEach(a.dynamicLayerInfos||a.layerInfos,function(d){c={id:d.id};c.source=d.source&&d.source.toJson();var g;a.layerDefinitions&&a.layerDefinitions[d.id]&&(g=a.layerDefinitions[d.id]);
g&&(c.definitionExpression=g);var f;a.layerDrawingOptions&&a.layerDrawingOptions[d.id]&&(f=a.layerDrawingOptions[d.id]);f&&(c.drawingInfo=f.toJson());c.minScale=d.minScale||0;c.maxScale=d.maxScale||0;b.push(c)});return b},_getServiceDefinition:function(){var a=this.getUrl();return this._serviceDefinitionBuffer.getRequest(this.subId).request(a)},_getSubserviceDefinition:function(a){return 10.11<=this.layerObject.version?this._getAllLayerAndTable(a):this._getLayerAndTable(a)},_getAllLayerAndTable:function(a){var b=
this.layerObject.url+"/layers",c=this._serviceDefinitionBuffer.getRequest("_all_layer_and_table_request");c.isResolved()||c.request(b).then(p.hitch(this,function(a){null===a?this.traversal(p.hitch(this,function(a){a.isRootLayer()||this._serviceDefinitionBuffer.getRequest(a.mapServiceSubId).setResponse(null)})):e.forEach(a.layers,function(a){this._serviceDefinitionBuffer.getRequest(a.id).setResponse(a)},this)}));return this._serviceDefinitionBuffer.getRequest(a).fakeRequest()},_getLayerAndTable:function(a){var b=
this.layerObject.url+"/"+a;return this._serviceDefinitionBuffer.getRequest(a).request(b)},_getSublayerSettingOfWebmap:function(a){var b=e.filter(this.originOperLayer.layers,function(b){return b.id===a});return 1===b.length?b[0]:null},_getSublayerShowLegendOfWebmap:function(a){return(a=this._getSublayerSettingOfWebmap(a))?void 0!==a.showLegend?a.showLegend:!0:!0},_idIsInJsapiLayerInfos:function(a){return null===this._getJsapiLayerInfoById(a)?!1:!0},_getJsapiLayerInfoById:function(a){for(var b=null,
c=0;c<this._jsapiLayerInfos.length;c++)if(this._jsapiLayerInfos[c].id===a){b=this._jsapiLayerInfos[c];break}return b},_isGroupLayerBySubId:function(a){return(a=this._getJsapiLayerInfoById(a))&&a.subLayerIds&&0<a.subLayerIds.length?!0:!1},_bindEvent:function(){var a;this.inherited(arguments);this.layerObject&&!this.layerObject.empty&&(a=this.layerObject.on("visible-layers-change",p.hitch(this,this._onVisibleLayersChanged)),this._eventHandles.push(a),a=l.after(this.layerObject,"setLayerDefinitions",
p.hitch(this,this._onFilterChanged)),this._eventHandles.push(a))},_onVisibleLayersChanged:function(a){var b=a.visibleLayers;if(-1===b[0]&&-1===b[1]&&-1===b[2])this._subLayerVisibleChanged(),this._isShowInMapChanged2();else{a=[];var c=[-1,-1,-1],b=this._converVisibleLayers(b);a=b.visibleLayersForUpdateSubLayerVisible;c=c.concat(b.visibleLayersForSetVisibleLayers);this._initSubLayerVisible(a);this.traversal(function(a){a._initVisible()});this.layerObject.setVisibleLayers(c)}},_converVisibleLayers:function(a){var b=
{visibleLayersForUpdateSubLayerVisible:[],visibleLayersForSetVisibleLayers:[]};e.forEach(a,function(b){var c=this.findLayerInfoById(this.id+"_"+b);if(this._isGroupLayerBySubId(b))c.traversal(function(b){a.push(b.originOperLayer.mapService.subId)});else for(;c&&c.originOperLayer.mapService;)a.push(c.originOperLayer.mapService.subId),c=c.parentLayerInfo},this);e.forEach(a,function(a){0<=a&&0>b.visibleLayersForUpdateSubLayerVisible.indexOf(a)&&b.visibleLayersForUpdateSubLayerVisible.push(a)},this);e.forEach(b.visibleLayersForUpdateSubLayerVisible,
function(a){this._isGroupLayerBySubId(a)||b.visibleLayersForSetVisibleLayers.push(a)},this);return b},_onFilterChanged:function(){for(var a,b=[],c=this.layerObject.layerDefinitions,d=c.length>this._oldFilter.length?c.length:this._oldFilter.length,f=0;f<d;f++)(c[f]?c[f]:null)!==(this._oldFilter[f]?this._oldFilter[f]:null)&&(a=this.findLayerInfoById(this.id+"_"+f))&&a.isLeaf()&&b.push(a);0<b.length&&(h.publish("layerInfos/layerInfo/filterChanged",b),this._oldFilter=c)}})})},"jimu/LayerInfos/LayerInfoForKML":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang esri/graphicsUtils dojo/aspect dojo/topic ./LayerInfo ./LayerInfoForDefault dojo/Deferred esri/lang".split(" "),
function(k,e,p,q,n,l,h,f,d,c){return k(h,{constructor:function(){},getExtent:function(){var a=this.originOperLayer.layerObject.getLayers(),b=null,c;e.forEach(a,function(a){c=this._convertGeometryToMapSpatialRef(a.initialExtent);b=b?b.union(c):c},this);return b},_resetLayerObjectVisiblity:function(a){var b=a?a[this.id]:null;if(b){var c={},d;for(d in a)a.hasOwnProperty(d)&&"function"!==typeof a[d]&&(c[d]=a[d].visible);this._setSubLayerVisibleByCheckedInfo(c);this._setTopLayerVisible(b.visible)}},_setSubLayerVisibleByCheckedInfo:function(a){this.traversal(p.hitch(this,
function(b){c.isDefined(a[b.id])&&b._setTopLayerVisible(a[b.id])}))},_initVisible:function(){this._visible=this.originOperLayer.layerObject.visible},_setTopLayerVisible:function(a){a?this.layerObject.show():this.layerObject.hide()},obtainNewSubLayers:function(){var a=[];e.forEach(this._getOperLayerByParentFolderId(-1,this),function(b){b=this._layerInfoFactory.create(b);a.push(b);b.init()},this);return a},_getOperLayerByParentFolderId:function(a,b){var c=[],d=this.layerObject.getLayers()||[],f=e.filter(this.layerObject.folders||
[],function(b){return b.parentFolderId===a?!0:!1}),h=[],h=0===f.length?e.filter(d,function(a){return this._flag.kmzSubLayersWereHandled?!1:!0},this):f;e.forEach(h,function(a){var d;"esri.layers.KMLFolder"===a.declaredClass?d={layerObject:a,title:a.label||a.title||a.name||"\x26lt;no name\x26gt;",id:this._getSubLayerInfoIdForSubFolder(a),subId:a.id,kml:{layerInfo:this,currentFolder:a},selfType:"kml",parentLayerInfo:b}:"esri.layers.KMLLayer"===a.declaredClass?(d=p.getObject("linkInfo.name",!1,a),d={layerObject:a,
title:a.label||a.title||d||a.name||a.id||" ",id:a.id||"-",subId:a.id||"-",kml:{layerInfo:this,currentFolder:null},selfType:"kml",parentLayerInfo:b},p.setObject("_wabProperties.kmllayerWasHandled",!0,a),this._flag.kmzSubLayersWereHandled=!0):(p.setObject("_wabProperties.kmllayerWasHandled",!0,a),p.setObject("_wabProperties.isTemporaryLayer",!0,a));d&&c.push(d)},this);return c},_getAllSubLayerObject:function(){var a=[];this.traversal(p.hitch(this,function(b){b.layerObject&&b.layerObject.getLayers&&
(a=a.concat(b.layerObject.getLayers()))}));return a},_getSubLayerInfoIdForSubFolder:function(a){return this.id+"_folder_"+a.id},_needToRenew:function(){return e.some(this._getAllSubLayerObject(),function(a){if(!p.getObject("_wabProperties.kmllayerWasHandled",!1,a))return!0},this)},_bindEvent:function(){var a;this.inherited(arguments);this.layerObject&&!this.layerObject.empty&&(a=n.after(this.layerObject,"setFolderVisibility",p.hitch(this,this._onSubFolderVisibleChanged),!0),this._eventHandles.push(a))},
_onSubFolderVisibleChanged:function(a){a=this._getSubLayerInfoIdForSubFolder(a);(a=this.findLayerInfoById(a))&&l.publish("layerInfos/layerInfo/visibleChanged",[a])}})})},"jimu/LayerInfos/LayerInfoForDefault":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/Deferred ./LayerInfo dojox/gfx dojo/dom-construct dojo/dom-attr dojo/dom-class dojo/aspect jimu/portalUrlUtils jimu/portalUtils jimu/utils esri/symbols/jsonUtils esri/layers/LabelLayer esri/layers/LabelClass esri/dijit/PopupTemplate esri/dijit/Legend".split(" "),
function(k,e,p,q,n,l,h,f,d,c,a,b,g,u,m,r,t,v){return k(n,{_legendsNode:null,controlPopupInfo:null,constructor:function(){this._initControlPopup();this._updateLayerObjectName();try{this._initToShowLabels()}catch(y){console.warn(y.message)}},_updateLayerObjectName:function(){this.layerObject&&!this.layerObject.empty&&this.layerObject.name&&!p.getObject("_wabProperties.originalLayerName",!1,this.layerObject)&&(p.setObject("_wabProperties.originalLayerName",this.layerObject.name,this.layerObject),this.layerObject.name=
this.title)},_initToShowLabels:function(){var a=p.getObject("_wabProperties.itemLayerInfo",!1,this.layerObject);a&&!this.layerObject.empty&&b.getPortal(a.portalUrl).getItemData(a.itemId).then(p.hitch(this,function(a){var b;a&&a.layers&&(e.some(a.layers,function(a){return a.id===this.layerObject.layerId?(b=a,!0):!1},this),b&&b.showLabels&&((a=p.getObject("layerDefinition.drawingInfo.labelingInfo",!1,b))&&!this.layerObject.labelingInfo&&this.layerObject.setLabelingInfo&&(a=e.map(a,function(a){return new r(a)},
this),this.layerObject.setLabelingInfo(a)),this.showLabels()))}),p.hitch(this,function(a){a&&a.message&&console.log(a.message)}))},_initOldFilter:function(){this._oldFilter=this.layerObject&&!this.layerObject.empty&&this.layerObject.getDefinitionExpression?this.layerObject.getDefinitionExpression():null},_getLayerOptionsForCreateLayerObject:function(){var a={};a.id=this.id;var b=[],c=this.getInfoTemplate();c&&c.info&&c.info.fieldInfos?e.forEach(c.info.fieldInfos,function(a){a.visible&&b.push(a.fieldName)},
this):b=["*"];a.outFields=b;return a},getExtent:function(){var a=this.originOperLayer.layerObject.fullExtent||this.originOperLayer.layerObject.initialExtent;if(a)return this._convertGeometryToMapSpatialRef(a);a=new q;a.resolve(null);return a},_resetLayerObjectVisiblity:function(a){a=a?a[this.id]:null;!this.originOperLayer.collection&&a&&(this.layerObject.setVisibility(a.visible),this._visible=this.layerObject.visible)},_initVisible:function(){var a=!1;if(this.originOperLayer.collection&&this._notFirstInitVisilbeFlag){var a=
this.originOperLayer.collection.layerInfo,b=this.layerObject.visible;if(a._oldIsShowInMap!==a.isShowInMap())return;this._visible=b?!0:!1;a._onVisibilityChanged()}else this._visible=a=this.originOperLayer.layerObject.visible;this._notFirstInitVisilbeFlag=!0},_setTopLayerVisible:function(a){this.originOperLayer.collection?this.originOperLayer.collection.layerInfo._visible?a?(this.layerObject.show(),this._visible=!0):(this.layerObject.hide(),this._visible=!1):a?(this.layerObject.hide(),this._visible=
!0):(this.layerObject.hide(),this._visible=!1):(a?this.layerObject.show():this.layerObject.hide(),this._visible=a)},setLayerVisiblefromTopLayer:function(){this.originOperLayer.collection.layerInfo._visible?this._visible&&this.layerObject.show():this.layerObject.hide()},_prepareCheckedInfoForShowOrHide:function(a){for(var b={},c=this;c.parentLayerInfo;)b[c.id]=a,c=c.parentLayerInfo;return b},show:function(){if(this.isRootLayer())this._setTopLayerVisible(!0);else{var a=this.getRootLayerInfo();if(a._setSubLayerVisibleByCheckedInfo){var b=
this._prepareCheckedInfoForShowOrHide(!0);a._setSubLayerVisibleByCheckedInfo(b);a.show()}}},_initControlPopup:function(){this.controlPopupInfo={enablePopup:this.layerObject.infoTemplate?!0:!1,infoTemplate:this.layerObject.infoTemplate};this.layerObject._infoTemplate=this.layerObject.infoTemplate;var a=c.after(this.layerObject,"setInfoTemplate",p.hitch(this,function(){this.layerObject._infoTemplate=this.layerObject.infoTemplate;this.controlPopupInfo.infoTemplate=this.layerObject.infoTemplate;this.controlPopupInfo.enablePopup||
(this.layerObject.infoTemplate=null)}));this._eventHandles.push(a)},_getServiceDefinition:function(){var a;(a=this.getUrl())&&this.isRootLayer()&&"esri.layers.FeatureLayer"===this.layerObject.declaredClass?a=this._serviceDefinitionBuffer.getRequest(this.subId).request(a):(a=new q,a.resolve(null));return a},createLegendsNode:function(){var a=h.create("div",{"class":"legends-div jimu-legends-div-flag jimu-leading-margin1",legendsDivId:this.id},document.body);h.create("img",{"class":"legends-loading-img",
src:require.toUrl("jimu")+"/images/loading.gif"},a);return a},drawLegends:function(a){this._initLegendsNodeByLegendDijit(a)},_initLegendsNodeByLegendDijit:function(a){if(this.layerObject&&!this.layerObject.empty&&(!this.originOperLayer.subLayer||0===this.originOperLayer.subLayers.length)&&this.layerObject.loaded){h.empty(a);d.remove(a,"jimu-legends-div-flag");var b=new v({map:this.map,layerInfos:[{layer:this.layerObject}],arrangement:v.ALIGN_LEFT,respectCurrentMapScale:!1,respectVisibility:!1},h.create("div",
{},a));b.startup();a._legendDijit=b}},_initLegendsNode:function(a){var b=[],c=this.layerObject;!this.layerObject||this.layerObject.empty||this.originOperLayer.subLayer&&0!==this.originOperLayer.subLayers.length||(h.empty(a),c.renderer&&(c.renderer.infos?b=p.clone(c.renderer.infos):b.push({label:c.renderer.label,symbol:c.renderer.symbol}),c.renderer&&c.renderer.defaultSymbol&&0<b.length&&b.push({label:c.renderer.defaultLabel||"others",symbol:c.renderer.defaultSymbol}),e.forEach(b,function(b){b.legendDiv=
h.create("div",{"class":"legend-div"},a);b.symbolDiv=h.create("div",{"class":"legend-symbol jimu-float-leading"},b.legendDiv);b.labelDiv=h.create("div",{"class":"legend-label jimu-float-leading",innerHTML:b.label||" "},b.legendDiv);if("textsymbol"===b.symbol.type)f.set(b.symbolDiv,"innerHTML",b.symbol.text);else{var c=l.createSurface(b.symbolDiv,50,50);b=u.getShapeDescriptors(b.symbol);c.createShape(b.defaultShape).setFill(b.fill).setStroke(b.stroke).setTransform(l.matrix.translate(25,25))}},this)))},
obtainNewSubLayers:function(){var a=[];e.forEach(this.originOperLayer.subLayers,function(b){b.parentLayerInfo=this;b=this._layerInfoFactory.create(b);a.push(b);b.init()},this);return a},_isAllSubLayerVisibleOnPath:function(){for(var a=!0,b=this;!b.isRootLayer();)a=a&&b.isVisible(),b=b.parentLayerInfo;return a},getOpacity:function(){return this.layerObject.opacity?this.layerObject.opacity:1},setOpacity:function(a){this.layerObject.setOpacity&&this.layerObject.setOpacity(a)},_getCustomPopupInfo:function(a,
b){var c=null;a&&a.fields&&(c={title:a.name,fieldInfos:[],description:null,showAttachments:!0,mediaInfos:[]},e.forEach(a.fields,function(a){var d=!1;b?e.some(b,p.hitch(this,function(b){return b&&a.name.toLowerCase()===b.toLowerCase()}))&&(d=!0):d=!0;d&&(d=g.getDefaultPortalFieldInfo(a),d.visible=!0,d.isEditable=a.editable,c.fieldInfos.push(d))},this));return c},_getDefaultPopupInfo:function(a){var b=this._getCustomPopupInfo(a);b&&(b.fieldInfos=e.filter(b.fieldInfos,p.hitch(this,function(b){return b.fieldName.toLowerCase()!==
a.objectIdField.toLowerCase()&&"globalid"!==b.fieldName.toLowerCase()&&"shape"!==b.fieldName.toLowerCase()?!0:!1})));return b},_getDefaultPopupTemplate:function(a){var b=null;(a=this.getPopupInfo()||this._getDefaultPopupInfo(a))&&(b=new t(a));return b},enablePopup:function(){return this.loadInfoTemplate().then(p.hitch(this,function(){return this.controlPopupInfo.infoTemplate?(this.controlPopupInfo.enablePopup=!0,this.layerObject.infoTemplate=this.controlPopupInfo.infoTemplate,!0):!1}))},disablePopup:function(){this.controlPopupInfo.enablePopup=
!1;this.layerObject.infoTemplate=null},isPopupEnabled:function(){return this.controlPopupInfo&&this.controlPopupInfo.enablePopup?!0:!1},loadInfoTemplate:function(){var a=new q;this.controlPopupInfo.infoTemplate?a.resolve(this.controlPopupInfo.infoTemplate):this.getLayerObject().then(p.hitch(this,function(){this.controlPopupInfo.infoTemplate=this._getDefaultPopupTemplate(this.layerObject);a.resolve(this.controlPopupInfo.infoTemplate)}),p.hitch(this,function(){a.resolve(null)}));return a},getInfoTemplate:function(){return this.controlPopupInfo.infoTemplate},
_getRelatedUrls:function(a,b){var c=[];if(!a||!a.url||!a.relationships)return c;var d=a.url.lastIndexOf("/"),g=a.url.slice(0,d);e.forEach(a.relationships,function(a){b&&a.role&&b!==a.role||c.push(g+"/"+a.relatedTableId.toString())},this);return c},getRelatedTableInfoArray:function(b){var c=[],d=new q;this.getLayerObject().then(p.hitch(this,function(g){var f=this._getRelatedUrls(g,b);0!==f.length&&this._getLayerInfosObj().traversalAll(p.hitch(this,function(b){var d=-1;if(0===f.length)return!0;e.forEach(f,
function(g,f){p.getObject("layerObject.url",!1,b)&&a.removeProtocol(g.toString().toLowerCase()).replace(/\/+/g,"/")===a.removeProtocol(b.layerObject.url.toString().toLowerCase()).replace(/\/+/g,"/")&&(c.push(b),d=f)},this);0<=d&&f.splice(d,1);return!1}));d.resolve(c)}),p.hitch(this,function(){d.resolve(c)}));return d},getFilter:function(){return this.layerObject&&!this.layerObject.empty&&this.layerObject.getDefinitionExpression?this.layerObject.getDefinitionExpression():null},setFilter:function(a){this.layerObject&&
!this.layerObject.empty&&this.layerObject.setDefinitionExpression&&this.layerObject.setDefinitionExpression(a)},_isAlreadyInLabelLayerOfMap:function(a){var b=!1;a&&(b=e.some(a.getFeatureLayers(),function(a){return this.id===a.id},this));return b},_addToLabelLayerOfMap:function(){var a=this.getLabelLayerOfMap();a&&!this._isAlreadyInLabelLayerOfMap(a)&&(a.addFeatureLayer(this.layerObject),this.map.removeLayer(a),this.map.addLayer(a))},_removeFromLabelLayerOfMap:function(){this.getLabelLayerOfMap().removeFeatureLayer(this.id)},
_isSupportLabelControl:function(){return this.isRootLayer()&&!this.layerObject.empty&&"esri.layers.FeatureLayer"===this.layerObject.declaredClass&&this.layerObject.labelingInfo&&0<this.layerObject.labelingInfo.length?!0:!1},getLabelLayerOfMap:function(){var a;this.map._labels?a=this.map._labels:(a=this.map.getLayer("labels"),a||(a=new m({id:"labels"}),this.map.addLayer(a)));return a},obtainLabelControl:function(){var a=this.id+"_labelLayer",b=this.map.getLayer(a);if(!b&&this._isSupportLabelControl()){var c=
this.getLabelLayerOfMap();c&&this._isAlreadyInLabelLayerOfMap(c)&&(b=new m({id:a}),b.addFeatureLayer(this.layerObject),this.map.addLayer(b),this._removeFromLabelLayerOfMap())}return b?b:null},restoreLabelControl:function(){this._isSupportLabelControl()&&(this.destroyRealtedLabelLayer(),this._addToLabelLayerOfMap())},destroyRealtedLabelLayer:function(){var a=this.map.getLayer(this.id+"_labelLayer");a&&this.map.removeLayer(a)},destroyLabelLayer:function(){this.map.getLayer(this.id)||(this._removeFromLabelLayerOfMap(),
this.destroyRealtedLabelLayer())},canShowLabel:function(){return this._isSupportLabelControl()},isShowLabels:function(){var a=this.map.getLayer(this.id+"_labelLayer"),b=this.getLabelLayerOfMap();return this._isSupportLabelControl()&&(a||b&&this._isAlreadyInLabelLayerOfMap(b))?this.layerObject.showLabels:!1},showLabels:function(){this._isSupportLabelControl()&&this.layerObject.setShowLabels&&(this.map.getLayer(this.id+"_labelLayer")||this._addToLabelLayerOfMap(),this.layerObject.setShowLabels(!0))},
hideLabels:function(){this._isSupportLabelControl()&&this.layerObject.setShowLabels&&this.layerObject.setShowLabels(!1)}})})},"esri/layers/LabelLayer":function(){define("require dojo/_base/declare dojo/_base/lang dojo/number dojo/i18n!dojo/cldr/nls/number dojo/_base/array dojo/_base/connect dojo/has dojox/gfx/_base ../kernel ../lang ../graphic ../PopupInfo ../core/timerUtils ./labelLayerUtils/DynamicLabelClass ./labelLayerUtils/StaticLabelClass ./support/attributeUtils ../symbols/TextSymbol ../symbols/ShieldLabelSymbol ../geometry/Extent ../geometry/Point ../geometry/webMercatorUtils ./GraphicsLayer ./LabelClass ../renderers/SimpleRenderer ../support/expressionUtils".split(" "),
function(k,e,p,q,n,l,h,f,d,c,a,b,g,u,m,r,t,v,y,w,z,x,A,C,B,E){function D(a){return"sizeInfo"===a.type}return e(A,{declaredClass:"esri.layers.LabelLayer",constructor:function(a){this._refreshLabels=p.hitch(this,this._refreshLabels);this.id="labels";this.featureLayers=[];this._featureLayerInfos=[];this._preparedLabels=[];this._engineType="STATIC";this._mapEventHandlers=[];a&&(a.id&&(this.id=a.id),a.mode&&(this._engineType="DYNAMIC"===a.mode.toUpperCase()?"DYNAMIC":"STATIC"))},_setMap:function(a){this._mapEventHandlers.push(a.on("extent-change",
p.hitch(this,"_handleLevelChange")));var b=this.inherited(arguments);this.refresh();return b},_unsetMap:function(){var a;for(a=0;a<this._mapEventHandlers.length;a++)h.disconnect(this._mapEventHandlers[a]);this.refresh();u.clearTimeout(this._refreshHandle);this._refreshHandle=null;this.inherited(arguments)},setAlgorithmType:function(a){this._engineType=a&&"DYNAMIC"===a.toUpperCase()?"DYNAMIC":"STATIC";this.refresh()},addFeatureLayer:function(a,b,c,d){if(!this.getFeatureLayer(a.layerId)){var g=[];g.push(a.on("update-end",
p.hitch(this,"refresh")));g.push(a.on("suspend",p.hitch(this,"refresh")));g.push(a.on("resume",p.hitch(this,"refresh")));g.push(a.on("edits-complete",p.hitch(this,"refresh")));g.push(a.on("labeling-info-change",p.hitch(this,"refresh")));g.push(a.on("time-extent-change",p.hitch(this,"refresh")));g.push(a.on("show-labels-change",p.hitch(this,"refresh")));g.push(a.on("feature-reduction-change",p.hitch(this,"refresh")));this._featureLayerInfos.push({FeatureLayer:a,LabelExpressionInfo:c,LabelingOptions:d,
LabelRenderer:b,EventHandlers:g});this.featureLayers.push(a);this.refresh()}},getFeatureLayer:function(a){var b,c;for(b=0;b<this.featureLayers.length;b++)if(c=this.featureLayers[b],void 0!==c&&c.id==a)return c;return null},removeFeatureLayer:function(a){var b;a=this.getFeatureLayer(a);if(void 0!==a&&(b=l.indexOf(this.featureLayers,a),-1<b)){this.featureLayers.splice(b,1);for(a=0;a<this._featureLayerInfos[b].EventHandlers.length;a++)h.disconnect(this._featureLayerInfos[b].EventHandlers[a]);this._featureLayerInfos.splice(b,
1);this.refresh()}},removeAllFeatureLayers:function(){var a;for(a=0;a<this.featureLayers.length;a++){for(var b=0;b<this._featureLayerInfos[a].EventHandlers.length;b++)h.disconnect(this._featureLayerInfos[a].EventHandlers[b]);this.featureLayers=[];this._featureLayerInfos=[]}this.refresh()},getFeatureLayers:function(){return this.featureLayers},getFeatureLayerInfo:function(a){var b,c;for(b=0;b<this.featureLayers.length;b++)if(c=this.featureLayers[b],void 0!==c&&c.id==a)return this._featureLayerInfos[b];
return null},refresh:function(){null==this._refreshHandle&&(this._refreshHandle=u.setTimeout(this._refreshLabels,u.priority.LOW))},_handleLevelChange:function(a){a.levelChange&&this.clear();this.refresh()},_refreshLabels:function(a){this._refreshHandle=null;var b,c,d,g,f,e=[],h,l="DYNAMIC"===this._engineType?new m:new r;if(this._map){l.setMap(this._map,this);this._preparedLabels=[];for(a=0;a<this.featureLayers.length;a++)if(c=this.featureLayers[a],c.visible&&c.showLabels&&c.visibleAtMapScale&&!c._suspended)if(b=
this._featureLayerInfos[a],f=this._convertOptions(null),b.LabelRenderer){if(e=c.labelingInfo)if(h=e[0])g=this._getLabelExpression(h),f=this._convertOptions(h);d=b.LabelRenderer;b.LabelExpressionInfo&&(g=b.LabelExpressionInfo);b.LabelingOptions&&(f=this._convertOptions(null),void 0!==b.LabelingOptions.pointPriorities&&(e=b.LabelingOptions.pointPriorities,f.pointPriorities="above-center"==e||"AboveCenter"==e||"esriServerPointLabelPlacementAboveCenter"==e?"AboveCenter":"above-left"==e||"AboveLeft"==
e||"esriServerPointLabelPlacementAboveLeft"==e?"AboveLeft":"above-right"==e||"AboveRight"==e||"esriServerPointLabelPlacementAboveRight"==e?"AboveRight":"below-center"==e||"BelowCenter"==e||"esriServerPointLabelPlacementBelowCenter"==e?"BelowCenter":"below-left"==e||"BelowLeft"==e||"esriServerPointLabelPlacementBelowLeft"==e?"BelowLeft":"below-right"==e||"BelowRight"==e||"esriServerPointLabelPlacementBelowRight"==e?"BelowRight":"center-center"==e||"CenterCenter"==e||"esriServerPointLabelPlacementCenterCenter"==
e?"CenterCenter":"center-left"==e||"CenterLeft"==e||"esriServerPointLabelPlacementCenterLeft"==e?"CenterLeft":"center-right"==e||"CenterRight"==e||"esriServerPointLabelPlacementCenterRight"==e?"CenterRight":"AboveRight"),void 0!==b.LabelingOptions.lineLabelPlacement&&(f.lineLabelPlacement=b.LabelingOptions.lineLabelPlacement),void 0!==b.LabelingOptions.lineLabelPosition&&(f.lineLabelPosition=b.LabelingOptions.lineLabelPosition),void 0!==b.LabelingOptions.labelRotation&&(f.labelRotation=b.LabelingOptions.labelRotation),
void 0!==b.LabelingOptions.howManyLabels&&(f.howManyLabels=b.LabelingOptions.howManyLabels));d instanceof C&&(g=this._getLabelExpression(d),d=new B(d.symbol),f=this._convertOptions(d));this._addLabels(c,d,g,f)}else if(e=c.labelingInfo)for(b=e.length-1;0<=b;b--)if(h=e[b])d=new C(h instanceof C?h.toJson():h),g=this._getLabelExpression(h),f=this._convertOptions(h),this._addLabels(c,d,g,f);g=l._process(this._preparedLabels);this.clear();this.drawLabels(this._map,g)}},drawLabels:function(a,c){this._scale=
(a.extent.xmax-a.extent.xmin)/a.width;var d;for(d=0;d<c.length;d++){var g=c[d],f=g.x,m=g.y,e=g.text,h=g.angle,l=g.layer.labelSymbol;"polyline"==g.layer.geometry.type&&g.layer.options.labelRotation&&l.setAngle(180/Math.PI*h);l.setText(e);g=f;l instanceof v&&(f=l.getHeight(),g-=.25*f*this._scale*Math.sin(h),m-=.33*f*this._scale);h=new b(new z(g,m,a.extent.spatialReference));h.setSymbol(l);this.add(h)}},_addLabels:function(a,b,c,d){var g,f,m,e;if(this._isWithinScaleRange(b.minScale,b.maxScale)&&c&&""!==
c){var h=this._map,l=!a.url&&!h.spatialReference.equals(a.spatialReference);for(g=0;g<a.graphics.length;g++)if(f=a.graphics[g],!1!==f.visible&&!f._suspended){m=f.geometry;if(l){if(!x.canProject(m,h))continue;m=x.project(m,h)}m&&this._isWhere(b.where,f.attributes)&&this._isWithinScreenArea(m)&&(e=this._buildLabelText(c,f,a.fields,d),this._addLabel(e,b,a.renderer,f,d,m,h))}}},_isWithinScreenArea:function(a){a="point"===a.type?new w(a.x,a.y,a.x,a.y,a.spatialReference):a.getExtent();if(void 0===a)return!1;
a=this._intersects(this._map,a);return null===a||0===a.length?!1:!0},_isWithinScaleRange:function(a,b){var c=this._map.getScale();return 0<a&&c>=a||0<b&&c<=b?!1:!0},_isWhere:function(a,b){try{if(!a)return!0;if(a){var c=a.split(" ");if(3===c.length)return this._sqlEquation(b[this._removeQuotes(c[0])],c[1],this._removeQuotes(c[2]));if(7===c.length){var d=this._sqlEquation(b[this._removeQuotes(c[0])],c[1],this._removeQuotes(c[2])),g=c[3],f=this._sqlEquation(b[this._removeQuotes(c[4])],c[5],this._removeQuotes(c[6]));
switch(g){case "AND":return d&&f;case "OR":return d||f}}}return!1}catch(K){console.log("Error.: can't parse \x3d "+a)}},_sqlEquation:function(a,b,c){switch(b){case "\x3d":return a==c?!0:!1;case "\x3c\x3e":return a!=c?!0:!1;case "\x3e":return a>c?!0:!1;case "\x3e\x3d":return a>=c?!0:!1;case "\x3c":return a<c?!0:!1;case "\x3c\x3d":return a<=c?!0:!1}return!1},_removeQuotes:function(a){var b=a.indexOf('"'),c=a.lastIndexOf('"');if(-1!=b&&-1!=c)return a.substr(1,a.length-2);b=a.indexOf("'");c=a.lastIndexOf("'");
return-1!=b&&-1!=c?a.substr(1,a.length-2):a},_getSizeInfo:function(a){return a?a.sizeInfo||l.filter(a.visualVariables,D)[0]:null},_addLabel:function(a,b,c,g,f,m,e){var h,l,n,r;if(a&&""!==p.trim(a)&&b){a=a.replace(/\s+/g," ");h=b.getSymbol(g);h instanceof v?(h=new v(h.toJson()),h.setVerticalAlignment("baseline"),h.setHorizontalAlignment("center")):h=h instanceof y?new y(h.toJson()):new v;h.setText(a);b.symbol=h;if(n=this._getProportionalSize(b.sizeInfo,g.attributes))h instanceof v?h.setSize(n):h instanceof
y&&(h.setWidth(n),h.setHeight(n));r=n=0;if(c){l=c.getSymbol(g);var k=this._getSizeInfo(c);if((c=k?c.getSize(g,{sizeInfo:k,resolution:e.getResolutionInMeters()}):g.size)&&null!==c)n=r=c;else if(l)if("simplemarkersymbol"==l.type)r=n=l.size;else if("picturemarkersymbol"==l.type)n=l.width,r=l.height;else if("simplelinesymbol"==l.type||"cartographiclinesymbol"==l.type)n=l.width}c={};c.graphic=g;c.options=f;c.geometry=m;c.labelRenderer=b;c.labelSymbol=h;c.labelWidth=h.getWidth()/2;c.labelHeight=h.getHeight()/
2;c.symbolWidth=d.normalizedLength(n)/2;c.symbolHeight=d.normalizedLength(r)/2;c.text=a;c.angle=h.angle;this._preparedLabels.push(c)}},_buildLabelText:function(b,c,d,f){if(f.hasExpression)return b=f.arcadeCache,c=c._getDataValue(b.attributeInfo,b,E),a.isDefined(c)?""+c:"";var m=c.attributes;return b.replace(/{[^}]*}/g,function(b){var c,e=b;for(c=0;c<d.length;c++)if("{"+d[c].name+"}"==b){var e=m[d[c].name],h=d[c].domain;if(h&&p.isObject(h)){if("codedValue"==h.type&&f.useCodedValues)for(c=e,b=0;b<h.codedValues.length;b++){if(h.codedValues[b].code==
c){e=h.codedValues[b].name;break}}else"range"==h.type&&h.minValue<=e&&e<=h.maxValue&&(e=h.name);break}h=d[c].type;if(f.fieldInfos){var l=f.fieldInfos;for(c=0;c<l.length;c++)if("{"+l[c].fieldName+"}"==b){b=l[c].format;"esriFieldTypeDate"==h?(b="DateFormat"+g.prototype._dateFormats[b.dateFormat?b.dateFormat:"shortDate"])&&(e=a.substitute({myKey:e},"${myKey:"+b+"}")):"esriFieldTypeInteger"!=h&&"esriFieldTypeSingle"!=h&&"esriFieldTypeSmallInteger"!=h&&"esriFieldTypeLong"!=h&&"esriFieldTypeDouble"!=h||
!b||(e=q.format(e,{places:b.places}),b.digitSeparator||n.group&&(e=e.replace(new RegExp("\\"+n.group,"g"),"")));break}}break}else e="";return null==e?"":e})},_getLabelExpression:function(a){var b="";a.labelExpressionInfo?b=a.labelExpressionInfo.value||a.labelExpressionInfo.expression:this._validSyntax(a.labelExpression)&&(b=this._convertLabelExpression(a.labelExpression));return b},_validSyntax:function(a){return/^(\s*\[[^\]]+\]\s*)+$/i.test(a)},_convertLabelExpression:function(a){return a.replace(/\[/g,
"{").replace(/\]/g,"}")},_getProportionalSize:function(b,c){if(!b)return null;c=a.substitute(c,"${"+b.field+"}",{first:!0});return!(b.minSize&&b.maxSize&&b.minDataValue&&b.maxDataValue&&c)||0>=b.maxDataValue-b.minDataValue?null:(b.maxSize-b.minSize)/(b.maxDataValue-b.minDataValue)*(c-b.minDataValue)+b.minSize},_convertOptions:function(a){var b=!0,c="shortDate",d=null,g=null,f="",m=!0,e,h;if(a&&(a.format&&(c=a.format.dateFormat,d={places:a.format.places,digitSeparator:a.format.digitSeparator}),g=a.fieldInfos,
f=a.labelPlacement,null!=a.useCodedValues&&(b=a.useCodedValues),a=a.labelExpressionInfo)){var l=a.expression;l&&!a.value&&(h=!0,e=t.createAttributeCache({valueExpression:l},!0))}if("always-horizontal"==f||"esriServerPolygonPlacementAlwaysHorizontal"==f)m=!1;return{useCodedValues:b,dateFormat:c,numberFormat:d,fieldInfos:g,pointPriorities:"above-center"==f||"esriServerPointLabelPlacementAboveCenter"==f?"AboveCenter":"above-left"==f||"esriServerPointLabelPlacementAboveLeft"==f?"AboveLeft":"above-right"==
f||"esriServerPointLabelPlacementAboveRight"==f?"AboveRight":"below-center"==f||"esriServerPointLabelPlacementBelowCenter"==f?"BelowCenter":"below-left"==f||"esriServerPointLabelPlacementBelowLeft"==f?"BelowLeft":"below-right"==f||"esriServerPointLabelPlacementBelowRight"==f?"BelowRight":"center-center"==f||"esriServerPointLabelPlacementCenterCenter"==f?"CenterCenter":"center-left"==f||"esriServerPointLabelPlacementCenterLeft"==f?"CenterLeft":"center-right"==f||"esriServerPointLabelPlacementCenterRight"==
f?"CenterRight":"AboveRight",lineLabelPlacement:"above-start"==f||"below-start"==f||"center-start"==f?"PlaceAtStart":"above-end"==f||"below-end"==f||"center-end"==f?"PlaceAtEnd":"PlaceAtCenter",lineLabelPosition:"above-after"==f||"esriServerLinePlacementAboveAfter"==f||"above-along"==f||"esriServerLinePlacementAboveAlong"==f||"above-before"==f||"esriServerLinePlacementAboveBefore"==f||"above-start"==f||"esriServerLinePlacementAboveStart"==f||"above-end"==f||"esriServerLinePlacementAboveEnd"==f?"Above":
"below-after"==f||"esriServerLinePlacementBelowAfter"==f||"below-along"==f||"esriServerLinePlacementBelowAlong"==f||"below-before"==f||"esriServerLinePlacementBelowBefore"==f||"below-start"==f||"esriServerLinePlacementBelowStart"==f||"below-end"==f||"esriServerLinePlacementBelowEnd"==f?"Below":"center-after"==f||"esriServerLinePlacementCenterAfter"==f||"center-along"==f||"esriServerLinePlacementCenterAlong"==f||"center-before"==f||"esriServerLinePlacementCenterBefore"==f||"center-start"==f||"esriServerLinePlacementCenterStart"==
f||"center-end"==f||"esriServerLinePlacementCenterEnd"==f?"OnLine":"Above",labelRotation:m,howManyLabels:"OneLabel",hasExpression:h,arcadeCache:e}}})})},"esri/layers/labelLayerUtils/DynamicLabelClass":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../../kernel ../../geometry/Extent ../../geometry/Polygon".split(" "),function(k,e,p,q,n,l){return k(null,{declaredClass:"esri.layers.labelLayerUtils.DynamicLabelClass",constructor:function(){this._preparedLabels=[];this._placedLabels=[];
this._extent=null;this._y1=this._x1=this._y0=this._x0=this._ymax=this._ymin=this._xmax=this._xmin=0;this._scale=1},setMap:function(e,f){this._labelLayer=f;this._xmin=e.extent.xmin;this._xmax=e.extent.xmax;this._ymin=e.extent.ymin;this._ymax=e.extent.ymax;this._scale=(this._xmax-this._xmin)/e.width},_process:function(e){this._preparedLabels=e;this._placedLabels=[];var f;for(e=this._preparedLabels.length-1;0<=e;e--){var d=this._preparedLabels[e],c=Math.min(d.labelWidth,d.labelHeight),a=d.labelWidth+
0*c,c=d.labelHeight+0*c,b=(f=d.options)&&void 0!==f.lineLabelPlacement?f.lineLabelPlacement:"PlaceAtCenter",g=f&&void 0!==f.lineLabelPosition?f.lineLabelPosition:"Above",h=f&&void 0!==f.pointPriorities?f.pointPriorities:"AboveRight",m=[2,2,1,3,0,2,3,3,2];"AboveLeft"==h?m=[1,2,2,2,0,3,2,3,3]:"AboveCenter"==h?m=[2,1,2,2,0,2,3,3,3]:"AboveRight"==h?m=[2,2,1,3,0,2,3,3,2]:"CenterLeft"==h?m=[2,2,3,1,0,3,2,2,3]:"CenterCenter"==h?m=[0,0,0,0,1,0,0,0,0]:"CenterRight"==h?m=[3,2,2,3,0,1,3,2,2]:"BelowLeft"==h?
m=[2,3,3,2,0,3,1,2,2]:"BelowCenter"==h?m=[3,3,3,2,0,2,2,1,2]:"BelowRight"==h&&(m=[3,3,2,3,0,2,2,2,1]);var l=f&&void 0!==f.labelRotation?f.labelRotation:!0,h=Math.PI/180*d.angle;f=f&&void 0!==f.howManyLabels?f.howManyLabels:"OneLabel";if("point"==d.geometry.type)this._generatePointPositions(d,d.geometry.x,d.geometry.y,d.text,h,a,c,d.symbolWidth,d.symbolHeight,m);else if("multipoint"==d.geometry.type)for(b=d.geometry,g=0;g<b.points.length;g++)this._generatePointPositions(d,b.points[g][0],b.points[g][1],
d.text,h,a,c,d.symbolWidth,d.symbolHeight,m);else"polyline"==d.geometry.type?this._generateLinePositions(d,d.geometry,d.text,a,c,2*d.symbolHeight+c,b,g,l):"polygon"==d.geometry.type&&this._generatePolygonPositions(d,f,d.geometry,d.text,h,a,c)}return this._placedLabels},_generatePointPositions:function(e,f,d,c,a,b,g,l,m,n){l=(l+b)*this._scale;m=(m+g)*this._scale;var h,r;for(h=1;3>=h;h++)for(r=1;9>=r;r++)if(n[r-1]==h)switch(r){case 1:if(this._findPlace(e,c,f-l,d+m,a,b,g))return;break;case 2:if(this._findPlace(e,
c,f,d+m,a,b,g))return;break;case 3:if(this._findPlace(e,c,f+l,d+m,a,b,g))return;break;case 4:if(this._findPlace(e,c,f-l,d,a,b,g))return;break;case 5:if(this._findPlace(e,c,f,d,a,b,g))return;break;case 6:if(this._findPlace(e,c,f+l,d,a,b,g))return;break;case 7:if(this._findPlace(e,c,f-l,d-m,a,b,g))return;break;case 8:if(this._findPlace(e,c,f,d-m,a,b,g))return;break;case 9:if(this._findPlace(e,c,f+l,d-m,a,b,g))return}},_generateLinePositions:function(e,f,d,c,a,b,g,l,m){var h=c*this._scale*c*this._scale,
n,k,u;for(n=0;n<f.paths.length;n++){var p=f.paths[n],q=p.length,x=Math.floor((q-1)/2),A=0!==(q-1)%2?1:-1;"PlaceAtStart"==g&&(x=0,A=1);"PlaceAtEnd"==g&&(x=q-2,A=-1);for(;0<=x&&x<q-1;){for(k=x;k<q;k++){var C=p[x][0],B=p[x][1],E=p[k][0]-C,D=p[k][1]-B;if(E*E+D*D>h){for(var F=Math.atan2(D,E);F>Math.PI/2;)F-=Math.PI;for(;F<-(Math.PI/2);)F+=Math.PI;var I=Math.sin(F),M=Math.cos(F),L=0,J=0;"Above"==l&&(L=b*I*this._scale,J=b*M*this._scale);"Below"==l&&(L=-b*I*this._scale,J=-b*M*this._scale);if(1==k-x){if(this._clipLine(C,
B,p[k][0],p[k][1])&&(C=this._x1-this._x0,u=this._y1-this._y0,C*C+u*u>h&&(k=Math.atan2(u,C),E=c/2+2*a,B=E*this._scale*Math.cos(k),E=E*this._scale*Math.sin(k),"PlaceAtStart"==g?(C=this._x0+B,u=this._y0+E):"PlaceAtEnd"==g?(C=this._x1-B,u=this._y1-E):(C=this._x0+C/2,u=this._y0+u/2),this._findPlace(e,d,C-L,u+J,m?-k:0,c,a))))return}else{var P=0;for(u=x;u<=k;u++)P=Math.max(P,Math.abs((p[u][1]-B)*M-(p[u][0]-C)*I));if(P<a&&this._findPlace(e,d,C+E/2-L,B+D/2+J,m?-F:0,c,a))return}break}}x+=A}}},_generatePolygonPositions:function(e,
f,d,c,a,b,g){var h;if("ManyLabels"==f)for(f=0;f<d.rings.length;f++)h=d.rings[f],l.prototype.isClockwise(h)&&(h=this._findCentroid(h,this._xmin,this._ymin,this._xmax,this._ymax),this._findPlace(e,c,h[0],h[1],a,b,g));else{h=this._findCentroidForFeature(d,this._xmin,this._ymin,this._xmax,this._ymax);var m=h[1],n=0;for(f=0;10>f;f++){n+=g/4;h=this._findCentroidForFeature(d,this._xmin,m+(n-g/4),this._xmax,m+(n+g/4));if(this._findPlace(e,c,h[0],h[1],a,b,g))break;h=this._findCentroidForFeature(d,this._xmin,
m-(n+g/4),this._xmax,m-(n-g/4));if(this._findPlace(e,c,h[0],h[1],a,b,g))break}}},_findCentroid:function(e,f,d,c,a){var b=e.length,g=[0,0],h=0,m=e[0][0],l=e[0][1];m>c&&(m=c);m<f&&(m=f);l>a&&(l=a);l<d&&(l=d);for(var n=1;n<b-1;n++){var k=e[n][0],p=e[n][1],q=e[n+1][0],z=e[n+1][1];k>c&&(k=c);k<f&&(k=f);p>a&&(p=a);p<d&&(p=d);q>c&&(q=c);q<f&&(q=f);z>a&&(z=a);z<d&&(z=d);var x=(k-m)*(z-l)-(q-m)*(p-l);g[0]+=x*(m+k+q);g[1]+=x*(l+p+z);h+=x}g[0]/=3*h;g[1]/=3*h;if(isNaN(g[0])||isNaN(g[1]))return g;d=[];this._fillBuffer(e,
d,g);g[0]=this._sortBuffer(d,g[0],f,c);return g},_findCentroidForFeature:function(e,f,d,c,a){for(var b,g=0,h=[0,0],m=0;m<e.rings.length;m++){var l=e.rings[m],n=l.length,k=l[0][0],p=l[0][1];k>c&&(k=c);k<f&&(k=f);p>a&&(p=a);p<d&&(p=d);for(b=1;b<n-1;b++){var q=l[b][0],z=l[b][1],x=l[b+1][0],A=l[b+1][1];q>c&&(q=c);q<f&&(q=f);z>a&&(z=a);z<d&&(z=d);x>c&&(x=c);x<f&&(x=f);A>a&&(A=a);A<d&&(A=d);var C=(q-k)*(A-p)-(x-k)*(z-p);h[0]+=C*(k+q+x);h[1]+=C*(p+z+A);g+=C}}h[0]/=3*g;h[1]/=3*g;if(isNaN(h[0])||isNaN(h[1]))return h;
d=[];for(b=0;b<e.rings.length;b++)this._fillBuffer(e.rings[b],d,h);h[0]=this._sortBuffer(d,h[0],f,c);return h},_fillBuffer:function(e,f,d){for(var c=e.length-1,a=e[0][1]>=e[c][1]?1:-1,b=0;b<=c;b++){var g=b,h=b+1;b==c&&(h=0);var m=e[g][0],g=e[g][1],l=e[h][0],h=e[h][1],n=h>=g?1:-1;if(g<=d[1]&&d[1]<=h||h<=d[1]&&d[1]<=g)d[1]!=g&&d[1]!=h?(f.push((d[1]-g)*(l-m)/(h-g)+m),a=n):d[1]==g&&d[1]!=h?(a!=n&&f.push(m),a=n):d[1]!=g&&d[1]==h?(f.push(l),a=n):d[1]==g&&d[1]==h&&(1==a&&f.push(m),f.push(l),a=n)}},_sortBuffer:function(e,
f,d,c){var a=e.length;e.sort();if(0<a){for(var b=0,g=f=0;g<a-1;g+=2){var h=Math.abs(e[g+1]-e[g]);!(e[g]<=d&&e[g+1]<=d||e[g]>=c&&e[g+1]>=c)&&h>b&&(b=h,f=g)}a=e[f];e=e[f+1];a>c&&(a=c);a<d&&(a=d);e>c&&(e=c);e<d&&(e=d);f=(a+e)/2}return f},_findPlace:function(e,f,d,c,a,b,g){if(isNaN(d)||isNaN(c))return!1;for(var h=0;h<this._placedLabels.length;h++){var m=this._placedLabels[h].angle,r=this._placedLabels[h].width*this._scale,k=this._placedLabels[h].height*this._scale,p=this._placedLabels[h].x-d,q=this._placedLabels[h].y-
c;if(0===a&&0===m){if(this._findPlace2(-b*this._scale,-g*this._scale,b*this._scale,g*this._scale,p-r,q-k,p+r,q+k))return!1}else{var w=new n(-b*this._scale,-g*this._scale,b*this._scale,g*this._scale,null),z=0,x=1;0!==a&&(z=Math.sin(a),x=Math.cos(a));var A=p*x-q*z,p=p*z+q*x,m=m-a,z=Math.sin(m),x=Math.cos(m),C=-r*x- -k*z,q=-r*z+-k*x,m=+r*x- -k*z,B=+r*z+-k*x,r=A+C,k=p-q,z=A+m,x=p-B,C=A-C,q=p+q,A=A-m,p=p+B,m=new l;m.addRing([[r,k],[z,x],[C,q],[A,p],[r,k]]);if(w.intersects(m))return!1}}for(;a>Math.PI/2;)a-=
Math.PI;for(;a<-(Math.PI/2);)a+=Math.PI;h={};h.layer=e;h.text=f;h.angle=a;h.x=d;h.y=c;h.width=b;h.height=g;this._placedLabels.push(h);return!0},_findPlace2:function(e,f,d,c,a,b,g,l){return(e>=a&&e<=g||d>=a&&d<=g||e<=a&&d>=g)&&(f>=b&&f<=l||c>=b&&c<=l||f<=b&&c>=l)?!0:!1},_clipLine:function(e,f,d,c){for(var a=this._code(e,f),b=this._code(d,c);0!==a||0!==b;){if(0!==(a&b))return!1;var g=d-e,h=c-f;0!==a?(e<this._xmin?(f+=h*(this._xmin-e)/g,e=this._xmin):e>this._xmax?(f+=h*(this._xmax-e)/g,e=this._xmax):
f<this._ymin?(e+=g*(this._ymin-f)/h,f=this._ymin):f>this._ymax&&(e+=g*(this._ymax-f)/h,f=this._ymax),a=this._code(e,f)):(d<this._xmin?(c+=h*(this._xmin-d)/g,d=this._xmin):d>this._xmax?(c+=h*(this._xmax-d)/g,d=this._xmax):c<this._ymin?(d+=g*(this._ymin-c)/h,c=this._ymin):c>this._ymax&&(d+=g*(this._ymax-c)/h,c=this._ymax),b=this._code(d,c))}this._x0=e;this._y0=f;this._x1=d;this._y1=c;return!0},_code:function(e,f){var d=0;e<this._xmin&&(d+=8);e>this._xmax&&(d+=4);f<this._ymin&&(d+=2);f>this._ymax&&(d+=
1);return d}})})},"esri/layers/labelLayerUtils/StaticLabelClass":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../../kernel ../../geometry/Extent ../../geometry/Point ../../geometry/Polygon".split(" "),function(k,e,p,q,n,l,h){return k(null,{declaredClass:"esri.layers.labelLayerUtils.StaticLabel",constructor:function(){this._preparedLabels=[];this._placedLabels=[];this._extent=null;this._ymax=this._ymin=this._xmax=this._xmin=0;this._scale=1;this._LINE_STEP_CONST=1.5;this._POLYGON_X_STEP_CONST=
1;this._POLYGON_Y_STEP_CONST=.75;this._OVERRUN=2},setMap:function(f,d){this._labelLayer=d;this._map=f;this._xmin=f.extent.xmin;this._xmax=f.extent.xmax;this._ymin=f.extent.ymin;this._ymax=f.extent.ymax;this._scale=(this._xmax-this._xmin)/f.width},_process:function(f){var d,c,a,b,g,e,m,n,k;this._preparedLabels=f;this._placedLabels=[];for(f=this._preparedLabels.length-1;0<=f;f--){d=this._preparedLabels[f];g=d.labelWidth;e=d.labelHeight;n=(m=d.options)&&m.lineLabelPlacement?m.lineLabelPlacement:"PlaceAtCenter";
k=m&&m.lineLabelPosition?m.lineLabelPosition:"Above";c=m&&m.labelRotation?m.labelRotation:!0;a=Math.PI/180*d.angle;b=m&&m.howManyLabels?m.howManyLabels:"OneLabel";var p=[];if("point"===d.geometry.type)this._generatePointPositions(d.geometry.x,d.geometry.y,d.text,a,g,e,d.symbolWidth,d.symbolHeight,m,p);else if("multipoint"===d.geometry.type)for(c=0;c<d.geometry.points.length;c++)this._generatePointPositions(d.geometry.points[c][0],d.geometry.points[c][1],d.text,a,g,e,d.symbolWidth,d.symbolHeight,m,
p);else if("polyline"===d.geometry.type)if("PlaceAtStart"===n)this._generateLinePositionsPlaceAtStart(d.geometry,!0,d.text,g,e,2*d.symbolHeight+e,n,k,c,p);else if("PlaceAtEnd"===n)this._generateLinePositionsPlaceAtEnd(d.geometry,!0,d.text,g,e,2*d.symbolHeight+e,n,k,c,p);else{m=[];var q=d.geometry.getExtent(),w=this._map.extent;if(q.getWidth()<g*this._scale/this._OVERRUN&&q.getHeight()<g*this._scale/this._OVERRUN)continue;else.5*q.getWidth()<w.getWidth()&&.5*q.getHeight()<w.getHeight()?this._generateLinePositionsPlaceAtCenter(d.geometry,
!1,.1*Math.min(this._map.width,this._map.height)*this._scale,d.text,g,e,2*d.symbolHeight+e,n,k,c,m):this._generateLinePositionsPlaceAtCenter(d.geometry,!0,.2*Math.min(this._map.width,this._map.height)*this._scale,d.text,g,e,2*d.symbolHeight+e,n,k,c,m);this._postSorting(w,m,p)}else if("polygon"===d.geometry.type){n=[];for(c=0;c<d.geometry.rings.length;c++)k=d.geometry.rings[c],1<d.geometry.rings.length&&!h.prototype.isClockwise(k)||(m=this._calcRingExtent(k),m.xmax-m.xmin<4*g*this._scale/this._OVERRUN&&
m.ymax-m.ymin<4*e*this._scale/this._OVERRUN||n.push(k));n.sort(function(a,b){return b.length-a.length});for(c=0;c<n.length;c++)this._generatePolygonPositionsForManyLabels(n[c],d.geometry.spatialReference,d.text,a,g,e,p)}for(c=0;c<p.length&&(n=p[c].x,k=p[c].y,void 0!==p[c].angle&&(a=p[c].angle),m=this._findPlace(d,d.text,n,k,a,g,e),"OneLabel"!==b||!m||!this._labelLayer._isWithinScreenArea(new l(n,k,d.geometry.spatialReference)));c++);}return this._placedLabels},_generatePointPositions:function(f,d,
c,a,b,g,e,m,h,l){c=h&&h.pointPriorities?h.pointPriorities:"AboveRight";b=(e+b)*this._scale;g=(m+g)*this._scale;switch(c.toLowerCase()){case "aboveleft":f-=b;d+=g;break;case "abovecenter":d+=g;break;case "aboveright":f+=b;d+=g;break;case "centerleft":f-=b;break;case "centercenter":break;case "centerright":f+=b;break;case "belowleft":f-=b;d-=g;break;case "belowcenter":d-=g;break;case "belowright":f+=b;d-=g;break;default:return}l.push({x:f,y:d})},_generateLinePositionsPlaceAtStart:function(f,d,c,a,b,
g,e,m,h,l){e=a*this._scale;var n=this._LINE_STEP_CONST*Math.min(this._map.width,this._map.height)*this._scale,r,k,t,p,u,q,B,E;for(r=0;r<f.paths.length;r++){var D=f.paths[r],F=e,I=0;for(k=0;k<D.length-1;k++)t=D[k][0],p=D[k][1],u=D[k+1][0],q=D[k+1][1],B=u-t,E=q-p,B=Math.sqrt(B*B+E*E),I+B>F?(I=this._generatePositionsOnLine(f.spatialReference,d,F,n,I,t,p,u,q,c,a,b,g,m,h,l),F=n):I+=B}},_generateLinePositionsPlaceAtEnd:function(f,d,c,a,b,g,e,m,h,l){e=a*this._scale;var n=this._LINE_STEP_CONST*Math.min(this._map.width,
this._map.height)*this._scale,r,k,t,p,u,q,B,E;for(r=0;r<f.paths.length;r++){var D=f.paths[r],F=e,I=0;for(k=D.length-2;0<=k;k--)t=D[k+1][0],p=D[k+1][1],u=D[k][0],q=D[k][1],B=u-t,E=q-p,B=Math.sqrt(B*B+E*E),I+B>F?(I=this._generatePositionsOnLine(f.spatialReference,d,F,n,I,t,p,u,q,c,a,b,g,m,h,l),F=n):I+=B}},_generateLinePositionsPlaceAtCenter:function(f,d,c,a,b,g,e,m,h,l,n){var r,k,t,p,u,q,v,E;for(m=0;m<f.paths.length;m++){var D=f.paths[m];if(!(2>D.length)){if(2==D.length){p=D[0];r=D[1];t=p[0];p=p[1];
D=r[0];q=r[1];u=(D-t)*(D-t)+(q-p)*(q-p);v=Math.atan2(q-p,D-t);q=Math.cos(v);v=Math.sin(v);D=[];E=t;for(var F=p;(E-t)*(E-t)+(F-p)*(F-p)<u;)D.push([E,F]),E+=c/2*q,F+=c/2*v;D.push(r)}var I=0;for(r=0;r<D.length-1;r++)t=D[r][0],p=D[r][1],u=D[r+1][0],q=D[r+1][1],v=u-t,E=q-p,I+=Math.sqrt(v*v+E*E);for(r=F=0;r<D.length-1;r++){t=D[r][0];p=D[r][1];u=D[r+1][0];q=D[r+1][1];v=u-t;E=q-p;v=Math.sqrt(v*v+E*E);if(F+v>I/2)break;F+=v}r==D.length-1&&r--;t=D[r][0];p=D[r][1];u=D[r+1][0];q=D[r+1][1];v=u-t;E=q-p;F=I/2-F;
v=Math.atan2(E,v);E=t+F*Math.cos(v);v=p+F*Math.sin(v);t=this._angleAndShifts(t,p,u,q,e,h,l);n.push({x:E+t.shiftX,y:v+t.shiftY,angle:t.angle});var I=E,M=v,F=0;for(k=r;k<D.length-1;k++)k==r?(t=I,p=M):(t=D[k][0],p=D[k][1]),u=D[k+1][0],q=D[k+1][1],v=u-t,E=q-p,v=Math.sqrt(v*v+E*E),F=F+v>c?this._generatePositionsOnLine(f.spatialReference,d,c,c,F,t,p,u,q,a,b,g,e,h,l,n):F+v;F=0;for(k=r;0<=k;k--)k==r?(t=I,p=M):(t=D[k+1][0],p=D[k+1][1]),u=D[k][0],q=D[k][1],v=u-t,E=q-p,v=Math.sqrt(v*v+E*E),F=F+v>c?this._generatePositionsOnLine(f.spatialReference,
d,c,c,F,t,p,u,q,a,b,g,e,h,l,n):F+v}}},_generatePositionsOnLine:function(f,d,c,a,b,g,e,m,h,l,k,p,q,z,x,A){l=Math.atan2(h-e,m-g);k=g;p=e;var r=k,t=p;do if(b=c-b,k+=b*Math.cos(l),p+=b*Math.sin(l),this._belongs(k,p,g,e,m,h))b=this._angleAndShifts(g,e,m,h,q,z,x),c=k+b.shiftX,t=p+b.shiftY,d?this._labelLayer._isWithinScreenArea(new n(c,t,c,t,f))&&A.push({x:c,y:t,angle:b.angle}):A.push({x:c,y:t,angle:b.angle}),r=k,t=p,b=0,c=a;else return f=m-r,h-=t,Math.sqrt(f*f+h*h);while(1)},_postSorting:function(f,d,c){if(f&&
0<d.length){var a=.5*(f.xmin+f.xmax);f=.5*(f.ymin+f.ymax);for(var b=d[0].x,g=d[0].y,e=Math.sqrt((b-a)*(b-a)+(g-f)*(g-f)),m=d[0].angle,h=0;h<d.length;h++){var l=d[h].x,n=d[h].y,k=Math.sqrt((l-a)*(l-a)+(n-f)*(n-f));k<e&&(b=l,g=n,e=k,m=d[h].angle)}c.push({x:b,y:g,angle:m})}},_belongs:function(f,d,c,a,b,g){if(b==c&&g==a)return!1;if(b>c){if(f>b||f<c)return!1}else if(f<b||f>c)return!1;if(g>a){if(d>g||d<a)return!1}else if(d<g||d>a)return!1;return!0},_angleAndShifts:function(f,d,c,a,b,g,e){for(f=Math.atan2(a-
d,c-f);f>Math.PI/2;)f-=Math.PI;for(;f<-(Math.PI/2);)f+=Math.PI;a=Math.sin(f);var m=Math.cos(f);c=d=0;"Above"==g&&(d=b*a*this._scale,c=b*m*this._scale);"Below"==g&&(d=-b*a*this._scale,c=-b*m*this._scale);b=[];b.angle=e?-f:0;b.shiftX=-d;b.shiftY=c;return b},_generatePolygonPositionsForManyLabels:function(f,d,c,a,b,g,e){b=this._findCentroidForRing(f);a=b[0];var m=b[1],h=this._calcRingExtent(f);b=h.xmin;g=h.ymin;var l=h.xmax,h=h.ymax,n=(h-g)/(this._map.height*this._scale);if(!(10<(l-b)/(this._map.width*
this._scale)&&10<n)){var k=!0;if(l-b>this._map.width*this._scale||h-g>this._map.height*this._scale)k=!1;var n=this._map.width*this._scale*(k?.1875:.5),k=this._map.height*this._scale*(k?.1875:.5),p=!0,u=!0,q=0;do{m+=(q%2?-1:1)*q*k;if(this._scanRingByX(c,d,f,a,m,b,l,n,e))break;m<g&&(p=!1);m>h&&(u=!1);q++}while(p||u)}},_scanRingByX:function(f,d,c,a,b,g,e,m,h){var l=!0,r=!0,k=0,p=1E3;do{a+=(k%2?-1:1)*k*m;var u=this._movePointInsideRing(c,a,b),q=this._labelLayer._isWithinScreenArea(new n(u,b,u,b,d)),A=
this._isPointWithinRing(f,c,u,b);if(q&&A)return h.push({x:u,y:b}),!0;a<g&&(l=!1);a>e&&(r=!1);k++;p--;if(0>=p)return!0}while(l||r);return!1},_movePointInsideRing:function(f,d,c){for(var a=[],b=f.length-1,g=f[0][1]>=f[b][1]?1:-1,e=0;e<=b;e++){var m=e,h=e+1;e==b&&(h=0);var l=f[m][0],m=f[m][1],n=f[h][0],h=f[h][1],k=h>=m?1:-1;if(m<=c&&c<=h||h<=c&&c<=m)c!=m&&c!=h?(a.push((c-m)*(n-l)/(h-m)+l),g=k):c==m&&c!=h?(g!=k&&a.push(l),g=k):c!=m&&c==h?(a.push(n),g=k):c==m&&c==h&&(1==g&&a.push(l),a.push(n),g=k)}a.sort(function(a,
b){return a-b});f=a.length;if(0<f){for(e=c=d=0;e<f-1;e+=2)b=Math.abs(a[e+1]-a[e]),b>d&&(d=b,c=e);d=(a[c]+a[c+1])/2}return d},_calcRingExtent:function(f){var d,c;c=new n;for(d=0;d<f.length-1;d++){var a=f[d][0],b=f[d][1];if(void 0===c.xmin||a<c.xmin)c.xmin=a;if(void 0===c.ymin||b<c.ymin)c.ymin=b;if(void 0===c.xmax||a>c.xmax)c.xmax=a;if(void 0===c.ymax||b>c.ymax)c.ymax=b}return c},_isPointWithinPolygon:function(f,d,c,a){var b;for(b=0;b<d.rings.length;b++)if(this._isPointWithinRing(f,d.rings[b],c,a))return!0;
return!1},_isPointWithinRing:function(f,d,c,a){var b,g,e,m,h=[],l=d.length;for(f=0;f<l-1;f++)if(b=d[f][0],g=d[f][1],e=d[f+1][0],m=d[f+1][1],b!=e||g!=m){if(g==m)if(a==g)h.push(b);else continue;b==e?(g<m&&a>=g&&a<m&&h.push(b),g>m&&a<=g&&a>m&&h.push(b)):(g=(e-b)/(m-g)*(a-g)+b,b<e&&g>=b&&g<e&&h.push(g),b>e&&g<=b&&g>e&&h.push(g))}h.sort(function(a,b){return a-b});for(f=0;f<h.length-1;f++)if(b=h[f],e=h[f+1],c>=b&&c<e)if(f%2)break;else return!0;return!1},_findCentroidForRing:function(f){for(var d=f.length,
c=[0,0],a=0,b=f[0][0],g=f[0][1],e=1;e<d-1;e++){var m=f[e][0],h=f[e][1],l=f[e+1][0],n=f[e+1][1],k=(m-b)*(n-g)-(l-b)*(h-g);c[0]+=k*(b+m+l);c[1]+=k*(g+h+n);a+=k}c[0]/=3*a;c[1]/=3*a;return c},_findCentroidForFeature:function(f){for(var d=0,c=[0,0],a=0;a<f.rings.length;a++)for(var b=f.rings[a],g=b.length,e=b[0][0],m=b[0][1],h=1;h<g-1;h++){var l=b[h][0],n=b[h][1],k=b[h+1][0],p=b[h+1][1],q=(l-e)*(p-m)-(k-e)*(n-m);c[0]+=q*(e+l+k);c[1]+=q*(m+n+p);d+=q}c[0]/=3*d;c[1]/=3*d;return c},_findPlace:function(f,d,
c,a,b,g,e){if(isNaN(c)||isNaN(a))return!1;for(var m=0;m<this._placedLabels.length;m++){var l=this._placedLabels[m].angle,k=this._placedLabels[m].width*this._scale,p=this._placedLabels[m].height*this._scale,u=this._placedLabels[m].x-c,q=this._placedLabels[m].y-a;if(0===b&&0===l){if(this._findPlace2(-g*this._scale,-e*this._scale,g*this._scale,e*this._scale,u-k,q-p,u+k,q+p))return!1}else{var z=new n(-g*this._scale,-e*this._scale,g*this._scale,e*this._scale,null),x=0,A=1;0!==b&&(x=Math.sin(b),A=Math.cos(b));
var C=u*A-q*x,u=u*x+q*A,l=l-b,x=Math.sin(l),A=Math.cos(l),B=-k*A- -p*x,q=-k*x+-p*A,l=+k*A- -p*x,E=+k*x+-p*A,k=C+B,p=u-q,x=C+l,A=u-E,B=C-B,q=u+q,C=C-l,u=u+E,l=new h;l.addRing([[k,p],[x,A],[B,q],[C,u],[k,p]]);if(z.intersects(l))return!1}}for(;b>Math.PI/2;)b-=Math.PI;for(;b<-(Math.PI/2);)b+=Math.PI;m={};m.layer=f;m.text=d;m.angle=b;m.x=c;m.y=a;m.width=g;m.height=e;this._placedLabels.push(m);return!0},_findPlace2:function(f,d,c,a,b,g,e,m){return(f>=b&&f<=e||c>=b&&c<=e||f<=b&&c>=e)&&(d>=g&&d<=m||a>=g&&
a<=m||d<=g&&a>=m)?!0:!1}})})},"esri/dijit/Legend":function(){define("dojo/_base/kernel dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/_base/json dojo/_base/Color dojo/debounce dojo/has dojo/sniff dojo/Deferred dojo/DeferredList dojo/json dojo/dom dojo/dom-construct dojo/dom-style dojo/dom-class dijit/_Widget dojox/gfx dojox/gfx/matrix dojox/html/entities ../kernel ../config ../request ../lang ../numberUtils ../renderers/utils ../renderers/SimpleRenderer ../renderers/UniqueValueRenderer ../renderers/ClassBreaksRenderer ../renderers/ScaleDependentRenderer ../renderers/DotDensityRenderer ../renderers/TemporalRenderer ../renderers/VectorFieldRenderer ../renderers/HeatmapRenderer ../symbols/PictureFillSymbol ../symbols/SimpleLineSymbol ../symbols/jsonUtils ../renderers/jsonUtils ./_EventedWidget dojo/i18n!../nls/jsapi".split(" "),
function(k,e,p,q,n,l,h,f,d,c,a,b,g,u,m,r,t,v,y,w,z,x,A,C,B,E,D,F,I,M,L,J,P,K,U,O,S,Y,N,W,ca){var ha=e([W,v],{declaredClass:"esri.dijit.Legend",widgetsInTemplate:!1,layers:null,alignRight:!1,hoverLabelShowing:!1,_preserveCacheOnDestroy:!1,dotDensitySwatchSize:26,dotCoverage:75,gradientHeight:30,transparencyRampColor:new h([64,64,64]),defaultText:"Aa",sizeRampLightColor:new h([255,255,255]),sizeRampDarkColor:new h([128,128,128]),layerConnects:[],gradientWidth:34,colorRampBorder:"1px solid",_specialChars:{lt:"\x3c",
gt:"\x3e"},_ieTimer:100,_isRightToLeft:!1,_align:null,_legendAlign:null,constructor:function(a,b){p.mixin(this,ca.widgets.legend);this._i18n=ca.widgets.legend;a=a||{};a.map?b?(this.map=a.map,this.layerInfos=a.layerInfos,this._respectCurrentMapScale=!1===a.respectCurrentMapScale?!1:!0,this._respectVisibility=!1===a.respectVisibility?!1:!0,this._preserveCacheOnDestroy=a.preserveCacheOnDestroy?!0:!1,this.arrangement=a.arrangement===ha.ALIGN_RIGHT?ha.ALIGN_RIGHT:ha.ALIGN_LEFT,this.arrangement===ha.ALIGN_RIGHT&&
(this.alignRight=!0),this.autoUpdate=!1===a.autoUpdate?!1:!0,this._surfaceItems=[],this.hideLayersInLegend={},this.refresh=f(this.refresh,0)):console.error("esri.dijit.Legend: must specify a container for the legend"):console.error("esri.dijit.Legend: unable to find the 'map' property in parameters")},postMixInProperties:function(){this.inherited(arguments);var a=["ar","he"],b,c;for(b=0;b<a.length;b+=1)c=a[b],k.locale&&-1!==k.locale.indexOf(c)&&(-1!==k.locale.indexOf("-")?-1!==k.locale.indexOf(c+
"-")&&(this._isRightToLeft=!0):this._isRightToLeft=!0);this._isRightToLeft?(this._align=this.alignRight?"left":"right",this._legendAlign=this.alignRight?"esriLegendLeft":"esriLegendRight"):(this._align=this.alignRight?"right":"left",this._legendAlign=this.alignRight?"esriLegendRight":"esriLegendLeft")},startup:function(){this.inherited(arguments);this._initialize();9>d("ie")&&(this._repaintItems=p.hitch(this,this._repaintItems),setTimeout(this._repaintItems,this._ieTimer))},destroy:function(){this._deactivate();
this._removeCachedLegendResponses();this._removeHoverHandlers();this.inherited(arguments)},_removeCachedLegendResponses:function(){this._preserveCacheOnDestroy||q.forEach(this.layers,function(a){delete a.legendResponse})},refresh:function(a){if(this.domNode){a?(this.layerInfos=a,this.layers=[],q.forEach(this.layerInfos,function(a){this._isSupportedLayerType(a.layer)&&(a.title&&(a.layer._titleForLegend=a.title),a.layer._hideDefaultSymbol=!1===a.defaultSymbol?!0:!1,a.hideLayers?(this.hideLayersInLegend[a.layer.id]=
a.hideLayers,this._addSubLayersToHide(a)):this.hideLayersInLegend[a.layer.id]=[],a.hoverLabel&&(a.layer._hoverLabel=a.hoverLabel),a.hoverLabels&&(a.layer._hoverLabels=a.hoverLabels),this.layers.push(a.layer))},this)):this.useAllMapLayers&&(this.layers=this.layerInfos=null);for(a=this.domNode.children.length-1;0<=a;a--)m.destroy(this.domNode.children[a]);this._removeHoverHandlers();this.startup()}},_legendUrl:"http://utility.arcgis.com/sharing/tools/legend",_initialize:function(){this.layerInfos&&
(this.layers=[],q.forEach(this.layerInfos,function(a){this._isSupportedLayerType(a.layer)&&(a.title&&(a.layer._titleForLegend=a.title),a.layer._hideDefaultSymbol=!1===a.defaultSymbol?!0:!1,a.hideLayers?(this.hideLayersInLegend[a.layer.id]=a.hideLayers,this._addSubLayersToHide(a)):this.hideLayersInLegend[a.layer.id]=[],a.hoverLabel&&(a.layer._hoverLabel=a.hoverLabel),a.hoverLabels&&(a.layer._hoverLabels=a.hoverLabels),this.layers.push(a.layer))},this));this.useAllMapLayers=!1;if(!this.layers){this.useAllMapLayers=
!0;this.layers=[];var a=[],b=[];q.forEach(this.map.layerIds,function(c){c=this.map.getLayer(c);var d;this._isSupportedLayerType(c)&&(c.arcgisProps&&c.arcgisProps.title&&(c._titleForLegend=c.arcgisProps.title),this.layers.push(c));"esri.layers.KMLLayer"==c.declaredClass&&(d=c.getLayers(),q.forEach(d,function(b){a.push(b.id)},this));"esri.layers.GeoRSSLayer"==c.declaredClass&&(d=c.getFeatureLayers(),q.forEach(d,function(a){b.push(a.id)},this))},this);q.forEach(this.map.graphicsLayerIds,function(c){var d=
this.map.getLayer(c);-1==q.indexOf(a,c)&&-1==q.indexOf(b,c)&&this._isSupportedLayerType(d)&&this._isLayerDrawingEnabled(d)&&(d.arcgisProps&&d.arcgisProps.title&&(d._titleForLegend=d.arcgisProps.title),this.layers.push(d))},this)}this._createLegend()},_isLayerDrawingEnabled:function(a){return a&&(a._params&&a._params.drawMode||a.isFeatureReductionActive&&a.isFeatureReductionActive())},_activate:function(){this._deactivate();this.autoUpdate&&(this._respectCurrentMapScale&&(this._ozeConnect=n.connect(this.map,
"onZoomEnd",this,"_refreshLayers")),this.useAllMapLayers&&(this._olaConnect=n.connect(this.map,"onLayerAdd",this,"_updateAllMapLayers"),this._olrConnect=n.connect(this.map,"onLayerRemove",this,"_updateAllMapLayers"),this._olroConnect=n.connect(this.map,"onLayersReordered",this,"_updateAllMapLayers")),q.forEach(this.layers,function(a){var b={};b.oarcConnect=n.connect(a,"onFeatureReductionRendererChange",this,"_refreshLayers");b.oaicConnect=n.connect(a,"onFeatureReductionChange",this,"_refreshLayers");
b.ovcConnect=n.connect(a,"onVisibilityChange",this,"_refreshLayers");b.oocConnect=n.connect(a,"onOpacityChange",this,"_refreshLayers");b.oscConnect=n.connect(a,"onScaleRangeChange",this,"_refreshLayers");"esri.layers.ArcGISDynamicMapServiceLayer"===a.declaredClass&&a.supportsDynamicLayers&&(b.odcConnect=n.connect(a,"_onDynamicLayersChange",p.hitch(this,"_updateDynamicLayers",a)));"esri.layers.ArcGISImageServiceLayer"===a.declaredClass&&(b.oirConnect=n.connect(a,"onRenderingChange",p.partial(this._updateImageServiceLayers,
this,a)),b.oivrConnect=n.connect(a,"onRendererChange",p.partial(this._updateImageServiceLayers,this,a)));"esri.layers.ArcGISImageServiceVectorLayer"===a.declaredClass&&(b.oivrConnect=n.connect(a,"onRendererChange",p.hitch(this,"_refreshLayers")));this.layerConnects[a.id]=b},this))},_deactivate:function(){this._ozeConnect&&n.disconnect(this._ozeConnect);this._olaConnect&&n.disconnect(this._olaConnect);this._olroConnect&&n.disconnect(this._olroConnect);this._olrConnect&&n.disconnect(this._olrConnect);
q.forEach(this.layers,function(a){a=this.layerConnects[a.id]||{};a.oarcConnect&&n.disconnect(a.oarcConnect);a.oaicConnect&&n.disconnect(a.oaicConnect);a.ovcConnect&&n.disconnect(a.ovcConnect);a.oocConnect&&n.disconnect(a.oocConnect);a.oscConnect&&n.disconnect(a.oscConnect);a.odcConnect&&n.disconnect(a.odcConnect);a.oirConnect&&n.disconnect(a.oirConnect);a.oivrConnect&&n.disconnect(a.oivrConnect)},this);this.layerConnects=[]},_updateDynamicLayers:function(a){delete a.legendResponse;this._refreshLayers()},
_updateImageServiceLayers:function(a,b){delete b.legendResponse;a._refreshLayers()},_refreshLayers:function(){this.refresh()},_updateAllMapLayers:function(){this.layers=[];q.forEach(this.map.layerIds,function(a){a=this.map.getLayer(a);this._isSupportedLayerType(a)&&this.layers.push(a)},this);q.forEach(this.map.graphicsLayerIds,function(a){a=this.map.getLayer(a);this._isSupportedLayerType(a)&&this._isLayerDrawingEnabled(a)&&this.layers.push(a)},this);this.refresh()},_createLegend:function(){var a=
!1,c=!1;r.set(this.domNode,"position","relative");m.create("div",{id:this.id+"_msg",className:"esriLegendMsg",innerHTML:this.NLS_creatingLegend+"..."},this.domNode);var d=[];q.forEach(this.layers,function(b){if("esri.layers.KMLLayer"==b.declaredClass||"esri.layers.GeoRSSLayer"==b.declaredClass){var g;b.loaded?("esri.layers.KMLLayer"==b.declaredClass?g=b.getLayers():"esri.layers.GeoRSSLayer"==b.declaredClass&&(g=b.getFeatureLayers(),this.hideLayersInLegend[b.id]&&(g=q.filter(g,function(a){return-1==
q.indexOf(this.hideLayersInLegend[b.id],a.id)},this))),q.forEach(g,function(a){"esri.layers.FeatureLayer"==a.declaredClass&&b._titleForLegend&&(a._titleForLegend=b._titleForLegend+" - ","esriGeometryPoint"==a.geometryType?a._titleForLegend+=this.NLS_points:"esriGeometryPolyline"==a.geometryType?a._titleForLegend+=this.NLS_lines:"esriGeometryPolygon"==a.geometryType&&(a._titleForLegend+=this.NLS_areas),d.push(a))},this)):n.connect(b,"onLoad",p.hitch(this,function(){this.refresh(this.layerInfos)}))}else if("esri.layers.WMSLayer"===
b.declaredClass)if(!b.loaded)n.connect(b,"onLoad",p.hitch(this,function(){this.refresh(this.layerInfos)}));else{if((!this._respectVisibility||this._respectVisibility&&b.visible)&&0<b.layerInfos.length&&q.some(b.layerInfos,function(a){return a.legendURL})){var f=!1;q.forEach(b.layerInfos,function(c){if(c.legendURL&&-1<q.indexOf(b.visibleLayers,c.name)){f||(m.create("div",{innerHTML:"\x3cspan class\x3d'esriLegendServiceLabel'\x3e"+(b._titleForLegend||b.name||b.id)+"\x3c/span\x3e"},this.domNode),f=!0);
var d;c=c.legendURL;if(b.customParameters||b.customLayerParameters){var g=p.clone(b.customParameters||{});p.mixin(g,b.customLayerParameters||{});for(d in g)c+=(-1===c.indexOf("?")?"?":"\x26")+d+"\x3d"+g[d]}m.create("div",{innerHTML:"\x3cimg src\x3d'"+c+"'/\x3e"},this.domNode);a=!0}},this)}}else"esri.layers.WFSLayer"!==b.declaredClass||b.renderer?d.push(b):(g=m.create("div",{id:this.id+"_"+b.id,"class":"esriLegendService"}),m.create("span",{innerHTML:this._getServiceTitle(b),"class":"esriLegendServiceLabel"},
m.create("td",{align:this._align},m.create("tr",{},m.create("tbody",{},m.create("table",{width:"95%"},g))))),m.place(g,this.id,"first"),g=m.create("table",{cellpadding:0,cellspacing:0,width:"95%","class":"esriLegendLayer"},g),g=m.create("tbody",{},g),"esriGeometryComplex"===b.geometryType?(this._buildRow_Renderer(b,b._pointSymbol,null,this.NLS_points,null,g),this._buildRow_Renderer(b,b._lineSymbol,null,this.NLS_lines,null,g),this._buildRow_Renderer(b,b._polygonSymbol,null,this.NLS_areas,null,g)):
"esriGeometryPoint"===b.geometryType?this._buildRow_Renderer(b,b._pointSymbol,null,"",null,g):"esriGeometryPolyline"===b.geometryType?this._buildRow_Renderer(b,b._lineSymbol,null,"",null,g):"esriGeometryPolygon"===b.geometryType&&this._buildRow_Renderer(b,b._polygonSymbol,null,"",null,g),c=!0)},this);var g=[];q.forEach(d,function(a){if(!a.loaded)var b=n.connect(a,"onLoad",this,function(a){n.disconnect(b);b=null;this.refresh()});else if((!this._respectVisibility||this._respectVisibility&&a.visible)&&
(a.layerInfos||a.renderer||"esri.layers.ArcGISImageServiceLayer"==a.declaredClass)){var c=m.create("div",{id:this.id+"_"+a.id,style:{display:"none"},"class":"esriLegendService"});m.create("span",{innerHTML:this._getServiceTitle(a),"class":"esriLegendServiceLabel"},m.create("td",{align:this._align},m.create("tr",{},m.create("tbody",{},m.create("table",{width:"95%"},c)))));m.place(c,this.id,"first");a.legendResponse||a.renderer&&"esri.renderer.StretchRenderer"!==a.renderer.declaredClass?this._createLegendForLayer(a):
this.isHostedTileService(a)?this._getLayerInfos(a).then(p.hitch(this,function(a){this._createLegendForLayer(a)}),p.hitch(this,function(a){g.push(this._legendRequest(a))})):g.push(this._legendRequest(a))}},this);0!==g.length||a||c?(new b(g)).addCallback(p.hitch(this,function(b){a||c?u.byId(this.id+"_msg").innerHTML="":u.byId(this.id+"_msg").innerHTML=this.NLS_noLegend;this._activate()})):(u.byId(this.id+"_msg").innerHTML=this.NLS_noLegend,this._activate())},_createLegendForLayer:function(a){if(a.legendResponse||
a.renderer||this.isHostedTileService(a)){var b=!1;if(a.legendResponse||this.isHostedTileService(a)){var c=a.dynamicLayerInfos||a.layerInfos;c&&c.length?q.forEach(c,function(c,d){this.hideLayersInLegend[a.id]&&-1!==q.indexOf(this.hideLayersInLegend[a.id],c.id)||(c=this._buildLegendItems(a,c,d),b=b||c)},this):"esri.layers.ArcGISImageServiceLayer"==a.declaredClass&&(b=this._buildLegendItems(a,{id:0,name:null,title:a.name,subLayerIds:null,parentLayerId:-1},0))}else a.renderer&&(c=a.url?a.url.substring(a.url.lastIndexOf("/")+
1,a.url.length):"fc_"+a.id,b=this._buildLegendItems(a,{id:c,name:null,subLayerIds:null,parentLayerId:-1},0));b&&(r.set(u.byId(this.id+"_"+a.id),"display","block"),r.set(u.byId(this.id+"_msg"),"display","none"))}},_legendRequest:function(a){if(a.loaded)return 10.01<=a.version?this._legendRequestServer(a):this._legendRequestTools(a);n.connect(a,"onLoad",p.hitch(this,"_legendRequest"))},_legendRequestServer:function(a){var b=a.url,c=b.indexOf("?"),b=-1<c?b.substring(0,c)+"/legend"+b.substring(c):b+"/legend";
(c=a._getToken())&&(b+="?token\x3d"+c);var d=p.hitch(this,"_processLegendResponse"),f={f:"json"};a._params.dynamicLayers&&(f.dynamicLayers=g.stringify(this._createDynamicLayers(a)),"[{}]"===f.dynamicLayers&&(f.dynamicLayers="[]"));a._params.bandIds&&(f.bandIds=a._params.bandIds);a._params.renderingRule?f.renderingRule=a._params.renderingRule:a.rasterFunctionInfos&&0<a.rasterFunctionInfos.length&&q.forEach(a.rasterFunctionInfos,function(a){a&&a.name&&"none"===a.name.toLowerCase()&&(f.renderingRule=
g.stringify({rasterFunction:a.name}))});return C({url:b,content:f,callbackParamName:"callback",load:function(b,c){d(a,b,c)},error:A.defaults.io.errorHandler})},_legendRequestTools:function(a){var b=a.url.toLowerCase().indexOf("/rest/"),b=a.url.substring(0,b)+a.url.substring(b+5,a.url.length),b=this._legendUrl+"?soapUrl\x3d"+window.escape(b);if(!d("ie")||8<d("ie"))b+="\x26returnbytes\x3dtrue";var c=p.hitch(this,"_processLegendResponse");return C({url:b,content:{f:"json"},callbackParamName:"callback",
load:function(b,d){c(a,b,d)},error:A.defaults.io.errorHandler})},_processLegendResponse:function(a,b){b&&b.layers?(a.legendResponse=b,u.byId(this.id+"_"+a.id)&&m.empty(u.byId(this.id+"_"+a.id)),m.create("span",{innerHTML:this._getServiceTitle(a),"class":"esriLegendServiceLabel"},m.create("td",{align:this._align},m.create("tr",{},m.create("tbody",{},m.create("table",{width:"95%"},u.byId(this.id+"_"+a.id)))))),this._createLegendForLayer(a)):console.log("Legend could not get generated for "+a.url+": "+
l.toJson(b))},_buildLegendItems:function(a,b,c){var d=!1,g=u.byId(this.id+"_"+a.id),f=b.parentLayerId;if(b.subLayerIds)a=m.create("div",{id:this.id+"_"+a.id+"_"+b.id+"_group",style:{display:"none"},"class":-1==f?0<c?"esriLegendGroupLayer":"":this._legendAlign},-1==f?g:u.byId(this.id+"_"+a.id+"_"+f+"_group")),m.create("td",{innerHTML:z.encode(b.name),align:this._align},m.create("tr",{},m.create("tbody",{},m.create("table",{width:"95%","class":"esriLegendLayerLabel"},a))));else{if(this._respectVisibility&&
a.visibleLayers)if(c=a.dynamicLayerInfos||a.layerInfos)if(a._params&&a._params.layers){if(-1===q.indexOf(a.visibleLayers,b.id))return d}else{if(c=this._getReallyVisibleLayers(c,a.visibleLayers),-1===q.indexOf(c,b.id))return d}else if(-1===q.indexOf(a.visibleLayers,b.id))return d;g=m.create("div",{id:this.id+"_"+a.id+"_"+b.id,style:{display:"none"},"class":-1<f?this._legendAlign:""},-1==f?g:u.byId(this.id+"_"+a.id+"_"+f+"_group"));m.create("td",{innerHTML:z.encode(b.name)||"",align:this._align},m.create("tr",
{},m.create("tbody",{},m.create("table",{width:"95%","class":"esriLegendLayerLabel"},g))));c=a.dynamicLayerInfos||a.layerInfos;f=!1;c&&c.length&&(f=q.some(c,function(a){return!!a.drawingInfo}));if(a.legendResponse)d=d||this._buildLegendItems_Tools(a,b,g);else if(a.renderer||f)d=d||this._buildLegendItems_Renderer(a,b,g)}return d},_getReallyVisibleLayers:function(a,b){if(!a||!b||!b.length)return[];var c=[],d=[],g;for(g=0;g<a.length;g++)if(a[g].subLayerIds){if(-1===q.indexOf(b,a[g].id)||-1<q.indexOf(d,
a[g].id))d=d.concat(a[g].subLayerIds)}else-1<q.indexOf(b,a[g].id)&&-1===q.indexOf(d,a[g].id)&&c.push(a[g].id);return c},_buildLegendItems_Tools:function(a,b,c){var d=b.parentLayerId,g=this.map.getScale(),f=!1,e=function(a,b){var c,d;for(c=0;c<a.length;c++)if(b.dynamicLayerInfos)for(d=0;d<b.dynamicLayerInfos[d].length;d++){if(b.dynamicLayerInfos[d].mapLayerId==a[c].layerId)return a[c]}else if(b.id==a[c].layerId)return a[c];return{}};if(!this._respectCurrentMapScale||this._respectCurrentMapScale&&this._isLayerInScale(a,
b,g)){var h=!0;if(this._respectCurrentMapScale&&("esri.layers.ArcGISDynamicMapServiceLayer"===a.declaredClass||"esri.layers.ArcGISMapServiceLayer"===a.declaredClass)){var l=this._getEffectiveScale(a,b);if(l.minScale&&l.minScale<g||l.maxScale&&l.maxScale>g)h=!1}if(h){var g=e(a.legendResponse.layers,b),n=g.legendType,k=g.layerType,t=g.legend;if(t){"esri.layers.ArcGISImageServiceLayer"!==a.declaredClass&&this._sanitizeLegendResponse(a,g,b);c=m.create("table",{cellpadding:0,cellspacing:0,width:"95%",
"class":"esriLegendLayer"},c);var p=m.create("tbody",{},c);(a._hoverLabel||a._hoverLabels)&&this._createHoverAction(c,a,b);var v=[];q.forEach(t,function(c){if(!(10.1<=a.version&&!c.values&&1<t.length)||!a._hideDefaultSymbol&&"\x3call other values\x3e"!==c.label&&(c.label||"esri.layers.ArcGISImageServiceLayer"===a.declaredClass&&10.3<=a.version||"Raster Layer"===k)){var d=c.label;if(c.url&&0===c.url.indexOf("http")||c.imageData&&0<c.imageData.length)f=!0,d&&-1!==q.indexOf(v,d)||(v.push(d),this._buildRow_Tools(c,
p,a,b.id,n))}},this)}}}f&&(r.set(u.byId(this.id+"_"+a.id+"_"+b.id),"display","block"),-1<d&&(r.set(u.byId(this.id+"_"+a.id+"_"+d+"_group"),"display","block"),this._findParentGroup(a.id,a,d)));return f},_getLayerInfos:function(b){var c=new a,d=b.dynamicLayerInfos||b.layerInfos;if(d&&d.length)if(q.some(d,function(a){return!!a.drawingInfo}))c.resolve(b);else{var g=b.url,f=g.indexOf("?"),g=-1==f?g+"/layers":g.substring(0,f)+"/layers"+g.substring(f,g.length);C({url:g,content:{f:"json"},callbackParamName:"callback",
load:function(a,g){a.layers?(q.forEach(d,function(b){var c=q.filter(a.layers,function(a){return b.source?a.id===b.source.mapLayerId:a.id===b.id});c&&c[0]&&c[0].drawingInfo&&(b.drawingInfo=c[0].drawingInfo,b.fields=c[0].fields)}),c.resolve(b)):c.reject(b)},error:function(a){c.reject(b)}})}return c},_sanitizeLegendResponse:function(a,b,c){var d=b.legend;if(10.1<=a.version&&1<d.length&&!b._sanitized){a=p.getObject("layerDefinition.drawingInfo.renderer",!1,c);var g,f;a||(a=p.getObject("drawingInfo.renderer",
!1,c));q.some(d,function(a){if(a.values)return!0})&&q.some(d,function(a,b){a.values||(f=b,g=a);return!!g});a?"uniqueValue"===a.type?g&&(d.splice(f,1),d.push(g)):"classBreaks"===a.type&&(g&&d.splice(f,1),d.reverse(),g&&d.push(g)):g&&(d.splice(f,1),d.push(g));b._sanitized=!0}},_buildRow_Tools:function(a,b,c,g,f){var e=m.create("tr",{},b),h;this.alignRight?(b=m.create("td",{align:this._isRightToLeft?"left":"right"},e),h=m.create("td",{align:this._isRightToLeft?"left":"right",width:35},e)):(h=m.create("td",
{width:35,align:"center"},e),b=m.create("td",{},e));e=a.url;(!d("ie")||9<=d("ie")||9>d("ie")&&"esri.layers.ArcGISImageServiceLayer"===c.declaredClass)&&a.imageData&&0<a.imageData.length?e="data:image/png;base64,"+a.imageData:0!==a.url.indexOf("http")&&(e=c.url+"/"+g+"/images/"+a.url,(g=c._getToken())&&(e+="?token\x3d"+g));g=m.create("img",{src:e,border:0,style:"opacity:"+c.opacity},h);a=m.create("td",{innerHTML:z.encode(a.label),align:this._align},m.create("tr",{},m.create("tbody",{},m.create("table",
{width:"95%",dir:"ltr"},b))));f&&"Stretched"===f&&10.3<=c.version&&"esri.layers.ArcGISImageServiceLayer"===c.declaredClass&&(a.style.verticalAlign="top",a.style.lineHeight="1",g.style.marginBottom="-1px",g.style.display="block",b.style.verticalAlign="top");9>d("ie")&&(g.style.filter="alpha(opacity\x3d"+100*c.opacity+")")},_getVariable:function(a,b,c){var d;a&&(d=(a=a.getVisualVariablesForType(b,c))&&a[0]);return d},_getVariables:function(a,b,c){a=[this._getVariable(a,"colorInfo",!1),this._getVariable(a,
"opacityInfo",!1),this._getVariable(a,"sizeInfo",!1)];return b?q.filter(a,function(a){return!(!a||a.field!==b||a.normalizationField!=c)}):a},_getFieldAlias:function(a,b,c){var d=b.infoTemplate||(b.infoTemplates&&c&&b.infoTemplates[c.id]?b.infoTemplates[c.id].infoTemplate:null),d=d&&d.getFieldInfo&&d.getFieldInfo(a);a=p.isFunction(a)?null:this.getField(b,a,c);b=d||a;c="";b&&(c=d&&d.label||a&&a.alias||b.name||b.fieldName);return c},_getDomainName:function(a,b,c,d){var g;a&&!p.isFunction(a)&&(g=(c=(a=
this.getField(c,a,d))&&c.getDomain?c.getDomain(a.name):null)&&c.codedValues?c.getName(b):null);return g},_getRampTitle:function(a,b,c){var d,g=a.field,f=a.normalizationField,m=!1,e=!1,h=!1,g=p.isFunction(g)?null:g,f=p.isFunction(f)?null:f;if(a.legendOptions&&a.legendOptions.title)d=a.legendOptions.title;else if(a.valueExpressionTitle)d=a.valueExpressionTitle;else{if(b.renderer&&b.renderer.authoringInfo&&b.renderer.authoringInfo.visualVariables){var l=b.renderer.authoringInfo.visualVariables;for(a=
0;a<l.length;a++){var n=l[a];if("colorInfo"===n.type&&"ratio"===n.style){m=!0;break}else if("colorInfo"===n.type&&"percent"===n.style){e=!0;break}else if("colorInfo"===n.type&&"percentTotal"===n.style){h=!0;break}}}(m=h&&"showRatioPercentTotal"||e&&"showRatioPercent"||m&&"showRatio"||f&&"showNormField"||g&&"showField"||null)&&(d=B.substitute({field:g&&this._getFieldAlias(g,b,c),normField:f&&this._getFieldAlias(f,b,c)},this._i18n[m]))}return d},_getRendererTitle:function(a,b,c){var d;if(a){var g,f,
m;"esri.renderer.ClassBreaksRenderer"===a.declaredClass&&(g=a.attributeField,f=a.normalizationField,m="percent-of-total"===a.normalizationType);g=p.isFunction(g)?null:g;f=p.isFunction(f)?null:f;a.legendOptions&&a.legendOptions.title?d=a.legendOptions.title:a.valueExpressionTitle?d=a.valueExpressionTitle:(a=f&&"showNormField"||(m?"showNormPct":null)||g&&"showField"||null)&&(d=B.substitute({field:g&&this._getFieldAlias(g,b,c),normField:f&&this._getFieldAlias(f,b,c)},this._i18n[a]))}return d},_buildLegendItems_Renderer:function(a,
b,c){var d=b.parentLayerId,g=this.map,f=g.getScale(),e,h=!1;if(!this._respectCurrentMapScale||this._isLayerInScale(a,b,f)){var l,n,k,t,v,w,x,y;k="esri.layers.ArcGISImageServiceVectorLayer"===a.declaredClass?a.renderer.renderer:b&&b.drawingInfo?N.fromJson(p.clone(b.drawingInfo.renderer)):a.isFeatureReductionActive&&a.isFeatureReductionActive()?a.getFeatureReductionRenderer():a.renderer;if("esri.renderer.ScaleDependentRenderer"===k.declaredClass&&(k=(g="zoom"===k.rangeType?k.getRendererInfoByZoom(g.getZoom()):
k.getRendererInfoByScale(f))&&g.renderer,!k))return!1;var B=this._getVariables(k),A=q.filter(B,function(a){return!!a}).length,f=B[0],g=B[1],B=B[2],C,E,I,J,D;f&&(t=this._getMedianColor(k,f),f.field&&(w=p.isFunction(f.field)?null:this.getField(a,f.field,b)),C=!(f.legendOptions&&!1===f.legendOptions.showLegend));g&&(g.field&&(y=p.isFunction(g.field)?null:this.getField(a,g.field,b)),E=!(g.legendOptions&&!1===g.legendOptions.showLegend));B&&(B.field&&(x=p.isFunction(B.field)?null:this.getField(a,B.field,
b)),I=!(B.legendOptions&&!1===B.legendOptions.showLegend));if("esri.renderer.HeatmapRenderer"===k.declaredClass)e=h=!0,this._showHeatRamp(a,b,k,c);else if("esri.renderer.DotDensityRenderer"===k.declaredClass)e=h=!0,this._showDotDensityLegend(a,b,k,c);else if("esri.renderer.TemporalRenderer"===k.declaredClass)e=h=!0,n=m.create("table",{cellpadding:0,cellspacing:0,width:"95%","class":"esriLegendLayer"},c),l=m.create("tbody",{},n),(a._hoverLabel||a._hoverLabels)&&this._createHoverAction(n,a,b),k.latestObservationRenderer&&
"esri.renderer.SimpleRenderer"===k.latestObservationRenderer.declaredClass&&this._buildRow_Renderer(a,k.latestObservationRenderer.symbol,t,z.encode(k.latestObservationRenderer.label)||this.NLS_currentObservations,null,l),k.observationRenderer&&"esri.renderer.SimpleRenderer"===k.observationRenderer.declaredClass&&this._buildRow_Renderer(a,k.observationRenderer.symbol,t,z.encode(k.observationRenderer.label)||this.NLS_previousObservations,null,l);else if("esri.renderer.UniqueValueRenderer"===k.declaredClass){if(k.infos&&
0<k.infos.length){e=h=!0;if(k.legendOptions&&k.legendOptions.title||k.valueExpressionTitle)n=m.create("table",{cellpadding:0,cellspacing:0,width:"95%","class":"esriLegendLayer"},c),l=m.create("tbody",{},n),A=k.legendOptions&&k.legendOptions.title?k.legendOptions.title:k.valueExpressionTitle,this._buildRow_Renderer(a,null,t,z.encode(A),null,l);n=m.create("table",{cellpadding:0,cellspacing:0,width:"95%","class":"esriLegendLayer"},c);l=m.create("tbody",{},n);(a._hoverLabel||a._hoverLabels)&&this._createHoverAction(n,
a,b);k.attributeField&&B&&this._addSubHeader(l,this._getFieldAlias(k.attributeField,a,b));var F=[];q.forEach(k.infos,function(c){var d=null;a._editable&&a.types&&(d=this._getTemplateFromTypes(a.types,c.value));var g=c.label;null==g&&(g=this._getDomainName(k.attributeField,c.value,a,b)||c.value);-1===q.indexOf(F,g)&&(F.push(g),this._buildRow_Renderer(a,c.symbol,t,z.encode(g),d,l))},this)}D=this._displayDefaultSymbol(a,k,c)}else if("esri.renderer.ClassBreaksRenderer"===k.declaredClass){if(k.infos&&
0<k.infos.length||"esri.layers.ArcGISImageServiceVectorLayer"===a.declaredClass)e=h=!0,J=this._isUnclassedRenderer(k),f||1!==k.infos.length||(v=(v=k.infos[0])&&v.symbol),J||(n=m.create("table",{cellpadding:0,cellspacing:0,width:"95%","class":"esriLegendLayer"},c),l=m.create("tbody",{},n),A=this._getRendererTitle(k,a,b),this._buildRow_Renderer(a,null,t,z.encode(A),null,l)),n=m.create("table",{cellpadding:0,cellspacing:0,width:"95%","class":"esriLegendLayer"},c),l=m.create("tbody",{},n),(a._hoverLabel||
a._hoverLabels)&&this._createHoverAction(n,a,b),J&&B&&I||(A=k.infos.slice(0).reverse(),q.forEach(A,function(b){var c=b.label;null!=c||J||(c=b.minValue+" - "+b.maxValue);this._buildRow_Renderer(a,b.symbol,t,z.encode(c),null,l)},this)),"esri.layers.ArcGISImageServiceVectorLayer"!==a.declaredClass||a.renderer.style!==K.STYLE_SCALAR&&a.renderer.style!==K.STYLE_SINGLE_ARROW||(this._buildRow_Renderer(a,k.defaultSymbol,null,"",null,l),a._hideDefaultSymbol=!0);J||(D=this._displayDefaultSymbol(a,k,c))}else"esri.renderer.SimpleRenderer"===
k.declaredClass&&(e=h=!0,n=m.create("table",{cellpadding:0,cellspacing:0,width:"95%","class":"esriLegendLayer"},c),l=m.create("tbody",{},n),(a._hoverLabel||a._hoverLabels)&&this._createHoverAction(n,a,b),v=null,a._editable&&a.templates&&0<a.templates.length&&(v=a.templates[0]),n=1<A?null:w&&C||y&&E||x&&I,this._buildRow_Renderer(a,k.symbol,t,z.encode(n?this._getRampTitle(1<A?null:f||g||B,a,b):k.label),v,l),v=f?null:k.symbol,n&&(w=y=x=null));e&&(f&&C&&(f.field||f.valueExpression)&&this._showGradientRamp(a,
b,k,null,c,f,w,null,B&&I?!0:!1),B&&I&&(B.field||B.valueExpression)&&(e=f&&C||"esri.renderer.UniqueValueRenderer"===k.declaredClass?!1:!0,this._showSizeLegend(a,b,k,B,t,c,x,null,e)),g&&E&&(g.field||g.valueExpression)&&this._showGradientRamp(a,b,k,v&&!v.url&&v.color?v.color:this.transparencyRampColor,c,g,y,null,!1));D||J&&!C&&!I&&!E||(D=this._displayDefaultSymbol(a,k,c));h=h||D}h&&(r.set(u.byId(this.id+"_"+a.id+"_"+b.id),"display","block"),-1<d&&(r.set(u.byId(this.id+"_"+a.id+"_"+d+"_group"),"display",
"block"),this._findParentGroup(a.id,d)));return h},_isUnclassedRenderer:function(a,b){var c;if("esri.renderer.ClassBreaksRenderer"===a.declaredClass&&a.infos&&1===a.infos.length){c=a.attributeField;var d=a.normalizationField;c=b?c===b:!!this._getVariables(a,c,d).length}return c},_displayDefaultSymbol:function(a,b,c){var d;!a._hideDefaultSymbol&&b.defaultSymbol&&(d=!0,c=m.create("table",{cellpadding:0,cellspacing:0,width:"95%","class":"esriLegendLayer"},c),c=m.create("tbody",{},c),this._buildRow_Renderer(a,
b.defaultSymbol,null,z.encode(b.defaultLabel)||"others",null,c));return d},_showGradientRamp:function(a,b,c,d,g,f,e,h,l){l=m.create("table",{cellpadding:0,cellspacing:0,width:"95%","class":"esriLegendLayer"+(l?"":" esriLegendSubFragment")},g);g=m.create("tbody",{},l);(a._hoverLabel||a._hoverLabels||h)&&this._createHoverAction(l,a,b,h);(e||f.valueExpression||f.legendOptions&&f.legendOptions.title)&&this._addSubHeader(g,this._getRampTitle(f,a,b));e=f.field;var n;e&&(n=p.isFunction(e)?null:this.getField(a,
e,b));(b=this._getRampStops(c,f,d,n&&"esriFieldTypeDate"===n.type))&&b.length&&this._drawGradientRamp(g,b,!0,a,this._getRampBorderColor(c),!!d)},_getMedianColor:function(a,b){var c,d;b.colors?(c=b.minDataValue,d=b.maxDataValue):b.stops&&(c=b.stops[0].value,d=b.stops[b.stops.length-1].value);return a.getColor(c+(d-c)/2,{colorInfo:b})},_getRampStops:function(a,b,c,d){var g,f,m,e,l=!1;b.colors||b.opacityValues?(f=b.maxDataValue-b.minDataValue,g=q.map([0,.25,.5,.75,1],function(a){m=b.minDataValue+a*f;
return Number(m.toFixed(6))}),this._checkPrecision(0,4,g)):b.stops&&(g=q.map(b.stops,function(a){return a.value}),(l=q.some(b.stops,function(a){return!!a.label}))&&(e=q.map(b.stops,function(a){return a.label})));var n=g[0],k,r;f=g[g.length-1]-n;return q.map(g,function(m,t){c?(k=new h(c.toRgba()),r=a.getOpacity(m,{opacityInfo:b}),null!=r&&(k.a=r)):k=a.getColor(m,{colorInfo:b});var p="";if(l)p=e[t];else{var p=d?D.formatDate(m,D.timelineDateFormatOptions):E.format(m),u="";0===t?u=this._specialChars.lt+
" ":t===g.length-1&&(u=this._specialChars.gt+" ");p=u+p}return{value:m,color:k,offset:1-(m-n)/f,label:p}},this).reverse()},_checkPrecision:function(a,b,c){var d=a+(b-a)/2,g=c[a],f=c[d],m=c[b],e=Math.floor(g),h=Math.floor(f),l=Math.floor(m);e===g&&l===m&&h!==f&&e!==h&&l!==h&&(c[d]=h);a+1!==d&&this._checkPrecision(a,d,c);d+1!==b&&this._checkPrecision(d,b,c)},_getRampBorderColor:function(a){var b;if("esri.renderer.SimpleRenderer"===a.declaredClass)b=a.symbol;else if("esri.renderer.UniqueValueRenderer"===
a.declaredClass||"esri.renderer.ClassBreaksRenderer"===a.declaredClass)b=a.infos[0].symbol;return(a=b&&-1===b.type.indexOf("linesymbol")?b.getStroke():null)&&a.color},_drawGradientRamp:function(a,b,c,g,f,e){var l=m.create("tr",{},a),n,k,t,p,u,v=b.length-1,w;p=0;this.alignRight?(a=m.create("td",{align:this._isRightToLeft?"left":"right"},l),n=m.create("td",{align:this._isRightToLeft?"left":"right",width:this.gradientWidth},l)):(n=m.create("td",{width:this.gradientWidth,align:"center"},l),a=m.create("td",
{},l));l=f&&0<f.a&&!(240<=f.r&&240<=f.g&&240<=f.b);k=m.create("div",{"class":l?"":"esriLegendBorderLessColorRamp",style:"position: relative; width:"+this.gradientWidth+"px;"},n);n=m.create("div",{"class":"esriLegendColorRamp"+(e?" esriLegendTransparencyRamp":"")},k);e=r.get(n,"width");l&&(f=9>d("ie")?f.toHex():"rgba("+f.toRgba().join(",")+")",r.set(n,"border",this.colorRampBorder+" "+f));c?(f=this.gradientHeight*v,r.set(n,"height",f+"px")):f=r.get(n,"height");r.set(k,"height",f+"px");l=y.createSurface(n,
e,f);9>d("ie")&&(p=l.getEventSource(),r.set(p,"position","relative"),r.set(p.parentNode,"position","relative"),p=1);try{c&&q.forEach(b,function(a,b){a.offset=b/v}),u=l.createRect({x:-p,y:-p,width:e+p,height:f+p}),u.setFill({type:"linear",x1:0,y1:0,x2:0,y2:f,colors:b}).setStroke(null),l.createRect({width:e,height:f}).setFill(new h([255,255,255,1-g.opacity])).setStroke(null),this._surfaceItems.push(l)}catch(Ba){l.clear(),l.destroy()}q.forEach(b,function(a,c){a.label&&(w="top:"+100*a.offset+"%;",a="",
0===c&&(a+=" esriLegendColorRampTickFirst"),c===b.length-1&&(a+=" esriLegendColorRampTickLast"),m.create("div",{"class":"esriLegendColorRampTick"+a,innerHTML:"\x26nbsp;",style:w},k))});t=m.create("div",{"class":"esriLegendColorRampLabels",style:{height:f+this.gradientHeight+"px"}},a);c?q.forEach(b,function(a){m.create("div",{"class":"esriLegendColorRampLabel",innerHTML:z.encode(a.label)||"\x26nbsp;"},t)}):(m.create("div",{"class":"esriLegendColorRampLabel",innerHTML:this._i18n.high},t),m.create("div",
{"class":"esriLegendColorRampLabel",innerHTML:this._i18n.low,style:"top: "+(f+this.gradientHeight-2*this.gradientHeight)+"px;"},t))},_showHeatRamp:function(a,b,c,d,g){var f,e=c.field;f=m.create("table",{cellpadding:0,cellspacing:0,width:"95%","class":"esriLegendLayer"},d);d=m.create("tbody",{},f);(a._hoverLabel||a._hoverLabels||g)&&this._createHoverAction(f,a,b,g);(e=e&&this.getField(a,e,b))&&this._addSubHeader(d,this._getFieldAlias(e.name,a,b));b=this._getHeatmapStops(c);b.length&&this._drawGradientRamp(d,
b,!1,a)},_getHeatmapStops:function(a){var b=a.colorStops;a=a.colors;var c,d,g,f;b&&b[0]?(c=b.length-1,(a=b[0]&&null!=b[0].ratio)?(a=b[c])&&1!==a.ratio&&(b=b.slice(0),b.push({ratio:1,color:a.color}),c++):(d=b[0].value,g=b[c].value-d,b=q.map(b,function(a){return{color:a.color,ratio:(a.value-d)/g}}))):a&&a[0]&&(c=a.length-1,f=1/(a.length-1),b=q.map(a,function(a,b){return{color:a,ratio:b*f}}));b=q.map(b,function(a,b){var d="";0===b?d="Low":b===c&&(d="High");return{color:a.color,label:d,offset:1-a.ratio}});
return b.reverse()},_showDotDensityLegend:function(a,b,c,d){var g=c.legendOptions,f,e,h,l,n,k,r,t=this.dotDensitySwatchSize,u=Math.round(t/2);g&&(e=g.backgroundColor,h=g.outline,l=g.valueUnit,n=g.dotCoverage);n=(n||this.dotCoverage)/100;r=Math.round(t*t/Math.pow(c.dotSize,2)*n);d=m.create("table",{cellpadding:0,cellspacing:0,width:"95%","class":"esriLegendLayer"},d);k=m.create("tbody",{},d);(a._hoverLabel||a._hoverLabels)&&this._createHoverAction(d,a,b);this._addSubHeader(k,B.substitute({value:c.dotValue,
unit:l||""},this.NLS_dotValue));q.forEach(c.fields,function(d){d=p.mixin({},d);d.numPoints=r;f=new O(c._generateImageSrc(t,t,[d],{x:0,y:0},{x:t,y:t},e),h||c.outline,t,t);d=this.getField(a,d.name,b)||d;this._buildRow_Renderer(a,f,null,z.encode(this._getFieldAlias(d.name,a,b)),null,k,{type:"path",path:"M "+-u+","+-u+" L "+u+","+-u+" L "+u+","+u+" L "+-u+","+u+" L "+-u+","+-u+" E"})},this)},_showSizeLegend:function(a,b,c,d,g,f,e,h,l){var n=d.legendOptions,n=n&&n.customValues;g=this._getSizeSymbol(c,
g);if((!d.valueUnit||"unknown"===d.valueUnit)&&g&&(n||null!=d.minSize&&null!=d.maxSize&&null!=d.minDataValue&&null!=d.maxDataValue||d.stops&&!(1>=d.stops.length))){l=m.create("table",{cellpadding:0,cellspacing:0,width:"95%","class":"esriLegendLayer"+(l?"":" esriLegendSubFragment")},f);f=m.create("tbody",{},l);(a._hoverLabel||a._hoverLabels||h)&&this._createHoverAction(l,a,b,h);(e||d.valueExpression||d.legendOptions&&d.legendOptions.title)&&this._addSubHeader(f,this._getRampTitle(d,a,b));e=d.field;
var k;h=p.isFunction(e);e&&(k=h?null:a.isFeatureReductionActive&&a.isFeatureReductionActive()?a.getFeatureReductionField(e):this.getField(a,e,b));b=k&&"esriFieldTypeDate"===k.type;var n=n||this._getDataValues(c,g,d,b),r,t=n.length-1;for(k=t;0<=k;k--)l=n[k],g=Y.fromJson(g.toJson()),this._applySize(g,c,d,l),l=b?D.formatDate(l,D.timelineDateFormatOptions):E.format(l),r="",k===t?r=this._specialChars.gt+" ":0===k&&(r=e&&!h&&"cluster_count"===e.toLowerCase()&&1===n[k]?"":this._specialChars.lt+" "),r="\x3cspan class\x3d'esriLegendSizeRampLabel'\x3e"+
z.encode(r+l)+"\x3c/span\x3e",this._buildRow_Renderer(a,g,null,r,null,f)}},_getSizeSymbol:function(a,b){var c,d;if("esri.renderer.SimpleRenderer"===a.declaredClass)c=a.symbol;else if("esri.renderer.VectorFieldRenderer"===a.declaredClass)c=a.defaultSymbol;else if("esri.renderer.UniqueValueRenderer"===a.declaredClass||"esri.renderer.ClassBreaksRenderer"===a.declaredClass)c=a.infos[0].symbol,d=1<a.infos.length;if(c=c&&-1!==c.type.indexOf("fillsymbol")?null:c)if(c=Y.fromJson(c.toJson()),b||d)-1!==c.type.indexOf("linesymbol")?
c.setColor(new h(this.sizeRampDarkColor)):(c.setColor(new h(this.sizeRampLightColor)),c.setOutline&&(a=new S,a.setColor(new h(this.sizeRampDarkColor)),a.setWidth(1.5),c.setOutline(a)));return c},_getDataValues:function(a,b,c,d,g,f){g=null==g?5:g;f=null==f?20:f;var m=a.getSizeRangeAtScale(c,this.map.getScale());g=this._interpolateSizeRange(m,g);var e=this._getDataRange(c),h=q.map(g,function(a){return this._getDataValueFromSize(a,e,m)},this);if(!d){var l,h=E.round(h);for(d=1;d<h.length-1;d++)if(l=this._roundDataValue(a,
b,c,h[d],h[d-1],f))h[d]=l[0],g[d]=l[1]}return h},_getDataRange:function(a){var b=a.stops;return b?{min:b[0].value,max:b[b.length-1].value}:{min:a.minDataValue,max:a.maxDataValue}},_interpolateSizeRange:function(a,b){var c=a.minSize;a=(a.maxSize-c)/(b-1);var d,g=[];for(d=0;d<b;d++)g.push(c+a*d);return g},_getDataValueFromSize:function(a,b,c){var d=c.minSize;c=c.maxSize;var g=b.min;b=b.max;return a<=d?g:a>=c?b:(a-d)/(c-d)*(b-g)+g},_roundDataValue:function(a,b,c,d,g,f){var m=this._getSize(b,a,c,d);g=
this._getSize(b,a,c,g);var e,h=E.getDigits(d),l=h.integer,h=h.fractional,n,k,r,t,p,u,q,v,w,z,x;0<d&&1>d&&(e=Math.pow(10,h),d*=e,l=E.getDigits(d).integer);for(--l;0<=l&&(n=Math.pow(10,l),h=Math.floor(d/n)*n,n*=Math.ceil(d/n),null!=e&&(h/=e,n/=e),k=(h+n)/2,k=E.round([h,k,n],{indexes:[1]})[1],r=this._getSize(b,a,c,h),t=this._getSize(b,a,c,n),p=this._getSize(b,a,c,k),u=E.getPctChange(m,r,g,null),q=E.getPctChange(m,t,g,null),v=E.getPctChange(m,p,g,null),w=u.prev<=f,z=q.prev<=f,w&&z&&(u.prev<=q.prev?(w=
!0,z=!1):(z=!0,w=!1)),w?x=[h,r]:z?x=[n,t]:v.prev<=f&&(x=[k,p]),!x);l--);return x},_applySize:function(a,b,c,d){var g=a.type;b=this._getSize(a,b,c,d);switch(g){case "simplemarkersymbol":a.setSize(b);break;case "picturemarkersymbol":g=a.width;c=a.height;a.setHeight(b);a.setWidth(g/c*b);break;case "simplelinesymbol":case "cartographiclinesymbol":a.setWidth(b);break;case "textsymbol":a.font&&a.font.setSize(b)}},_getSize:function(a,b,c,d){return b.getSize(d,{sizeInfo:c,scale:this.map.getScale(),shape:-1!==
a.type.indexOf("markersymbol")?a.style:null})},_buildRow_Renderer:function(a,b,c,d,g,f,e){var h=m.create("tr",{},f),l;this.alignRight?(f=m.create("td",{align:this._isRightToLeft?"left":"right"},h),b&&(l=m.create("td",{align:this._isRightToLeft?"left":"right",width:35},h))):(b&&(l=m.create("td",{width:35,align:"center"},h)),f=m.create("td",{},h));var n=h=30,k;if(b){if("simplemarkersymbol"==b.type)h=Math.min(Math.max(h,b.size+12),125),n=Math.min(Math.max(n,b.size+12),125);else if("picturemarkersymbol"==
b.type)h=Math.min(Math.max(h,b.width),125),n=Math.min(b.height||n,125);else if("textsymbol"==b.type){var r,t;b.text||(r=b.text,t=!0,b.setText(this.defaultText));h=Math.min(Math.max(h,b.getWidth()+12),125);n=Math.min(Math.max(n,b.getHeight()+12),125);t&&b.setText(r)}k=m.create("div",{style:"width:"+h+"px;height:"+n+"px;"},l)}B.isDefined(d)&&"number"===typeof d&&(d=""+d);m.create("td",{innerHTML:d||"",align:this._align},m.create("tr",{},m.create("tbody",{},m.create("table",{width:"95%"},f))));b&&(a=
this._drawSymbol(k,b,c,h,n,g,a,e),this._surfaceItems.push(a))},_addSubHeader:function(a,b){a=m.create("tr",{},a);a=m.create("td",{align:this._align,colspan:2},a);m.create("td",{innerHTML:z.encode(b)||"",align:this._align},m.create("tr",{},m.create("tbody",{},m.create("table",{width:"95%"},a))))},_drawSymbol:function(a,b,c,g,f,m,e,l){b=Y.fromJson(b.toJson());var n=e.opacity;c&&b.setColor(new h(c.toRgba()));if("simplelinesymbol"===b.type||"cartographiclinesymbol"===b.type||"textsymbol"===b.type){if(!b.color)return;
c=b.color.toRgba();c[3]*=n;b.color.setColor(c)}else"simplemarkersymbol"===b.type||"simplefillsymbol"===b.type?(b.color&&(c=b.color.toRgba(),c[3]*=n,b.color.setColor(c)),b.outline&&b.outline.color&&(c=b.outline.color.toRgba(),c[3]*=n,b.outline.color.setColor(c))):"picturemarkersymbol"===b.type&&(a.style.opacity=n,a.style.filter="alpha(opacity\x3d("+100*n+"))");a=y.createSurface(a,g,f);9>d("ie")&&(c=a.getEventSource(),r.set(c,"position","relative"),r.set(c.parentNode,"position","relative"));m=this._getDrawingToolShape(b,
m)||Y.getShapeDescriptors(b);var k,n=(c=m.defaultShape)&&"text"===c.type;try{n&&!c.text&&(c.text=this.defaultText),k=a.createShape(l||c).setFill(m.fill).setStroke(m.stroke),n&&k.setFont(m.font)}catch(aa){a.clear();a.destroy();return}var t=k.getBoundingBox();l=t.width;m=t.height;var n=-(t.x+l/2),u=-(t.y+m/2);c=a.getDimensions();n={dx:n+c.width/2,dy:u+c.height/2};if("simplemarkersymbol"===b.type&&"path"===b.style)g=e._getScaleMatrix(t,b.size),k.applyTransform(w.scaleAt(g.xx,g.yy,{x:c.width/2,y:c.height/
2}));else if(l>g||m>f)e=l/g>m/f,g=((e?g:f)-5)/(e?l:m),p.mixin(n,{xx:g,yy:g});k.applyTransform(n);return a},_getDrawingToolShape:function(a,b){switch(b?b.drawingTool||null:null){case "esriFeatureEditToolArrow":b={type:"path",path:"M 10,1 L 3,8 L 3,5 L -15,5 L -15,-2 L 3,-2 L 3,-5 L 10,1 Z"};break;case "esriFeatureEditToolTriangle":b={type:"path",path:"M -10,14 L 2,-10 L 14,14 L -10,14 Z"};break;case "esriFeatureEditToolRectangle":b={type:"path",path:"M -10,-10 L 10,-10 L 10,10 L -10,10 L -10,-10 Z"};
break;case "esriFeatureEditToolCircle":b={type:"circle",cx:0,cy:0,r:10};break;case "esriFeatureEditToolEllipse":b={type:"ellipse",cx:0,cy:0,rx:10,ry:5};break;default:return null}return{defaultShape:b,fill:a.getFill(),stroke:a.getStroke()}},_repaintItems:function(){q.forEach(this._surfaceItems,function(a){this._repaint(a)},this)},_repaint:function(a){if(a){a.getStroke&&a.setStroke&&a.setStroke(a.getStroke());try{a.getFill&&a.setFill&&a.setFill(a.getFill())}catch(Z){}a.children&&p.isArray(a.children)&&
q.forEach(a.children,this._repaint,this)}},_createHoverAction:function(a,b,c,d){if(d=b._hoverLabel||b._hoverLabels&&b._hoverLabels[c.id]||d)d=z.encode(d),b.mouseMoveHandler=b.mouseMoveHandler||{},b.mouseMoveHandler[c.id]=n.connect(a,"onmousemove",p.hitch(this,function(a,b){this.mouseX=b.clientX;this.mouseY=b.clientY;this.hoverLabelShowing&&(this.hoverLabelShowing=!1,r.set(u.byId(this.id+"_hoverLabel"),"display","none"));setTimeout(p.hitch(this,function(a,b,c){if(a==this.mouseX&&b==this.mouseY&&!this.hoverLabelShowing)if(this.hoverLabelShowing=
!0,u.byId(this.id+"_hoverLabel")){var d=u.byId(this.id+"_hoverLabel");d.innerHTML="\x3cspan\x3e"+c+"\x3c/span\x3e";r.set(d,"top",b+"px");r.set(d,"left",a+15+"px");r.set(d,"display","")}else m.create("div",{innerHTML:"\x3cspan\x3e"+c+"\x3c/span\x3e",id:this.id+"_hoverLabel","class":"esriLegendHoverLabel",style:{top:b+"px",left:a+15+"px"}},document.body)},b.clientX,b.clientY,a),500)},d)),b.mouseOutHandler=b.mouseOutHandler||{},b.mouseOutHandler[c.id]=n.connect(a,"onmouseout",p.hitch(this,function(a){this.mouseY=
this.mouseX=-1;this.hoverLabelShowing&&(this.hoverLabelShowing=!1,r.set(u.byId(this.id+"_hoverLabel"),"display","none"))}))},_removeHoverHandlers:function(){var a;q.forEach(this.layers,function(b){if(b.mouseMoveHandler)for(a in b.mouseMoveHandler)n.disconnect(b.mouseMoveHandler[a]);if(b.mouseOutHandler)for(a in b.mouseOutHandler)n.disconnect(b.mouseOutHandler[a])})},_createDynamicLayers:function(a){var b=[],c;q.forEach(a.dynamicLayerInfos||a.layerInfos,function(d){c={id:d.id};c.source=d.source&&d.source.toJson();
var g;a.layerDefinitions&&a.layerDefinitions[d.id]&&(g=a.layerDefinitions[d.id]);g&&(c.definitionExpression=g);var f;a.layerDrawingOptions&&a.layerDrawingOptions[d.id]&&(f=a.layerDrawingOptions[d.id]);f&&(c.drawingInfo=f.toJson());c.minScale=d.minScale||0;c.maxScale=d.maxScale||0;b.push(c)});return b},_getTemplateFromTypes:function(a,b){var c;for(c=0;c<a.length;c++)if(a[c].id==b&&a[c].templates&&0<a[c].templates.length)return a[c].templates[0];return null},_findParentGroup:function(a,b,c){var d,g=
b.dynamicLayerInfos||b.layerInfos;for(d=0;d<g.length;d++)if(c==g[d].id){-1<g[d].parentLayerId&&(r.set(u.byId(this.id+"_"+a+"_"+g[d].parentLayerId+"_group"),"display","block"),this._findParentGroup(a,b,g[d].parentLayerId));break}},_addSubLayersToHide:function(a){function b(c,d){var g=a.layer.dynamicLayerInfos||a.layer.layerInfos,f,m;for(f=0;f<g.length;f++)if(g[f].id===c&&g[f].subLayerIds)for(m=0;m<g[f].subLayerIds.length;m++){var e=g[f].subLayerIds[m];-1===q.indexOf(d,e)&&(d.push(e),b(e,d))}}a.layer.layerInfos&&
q.forEach(this.hideLayersInLegend[a.layer.id],function(c){b(c,this.hideLayersInLegend[a.layer.id])},this)},_isLayerInScale:function(a,b,c){var d,g=!0;if(a.legendResponse&&a.legendResponse.layers)for(d=0;d<a.legendResponse.layers.length;d++){var f=a.legendResponse.layers[d];if(b.id==f.layerId){var m,e;!a.minScale&&0!==a.minScale||!a.maxScale&&0!==a.maxScale?(0==f.minScale&&a.tileInfo&&(m=a.tileInfo.lods[0].scale),0==f.maxScale&&a.tileInfo&&(e=a.tileInfo.lods[a.tileInfo.lods.length-1].scale)):(m=Math.min(a.minScale,
f.minScale)||a.minScale||f.minScale,e=Math.max(a.maxScale,f.maxScale));if(0<m&&m<c||e>c)g=!1;break}}else if(a.minScale||a.maxScale)if(a.minScale&&a.minScale<c||a.maxScale&&a.maxScale>c)g=!1;return g},_getServiceTitle:function(a){var b=a._titleForLegend;b||(b=a.url,a.url?-1<a.url.indexOf("/MapServer")?(b=a.url.substring(0,a.url.indexOf("/MapServer")),b=b.substring(b.lastIndexOf("/")+1,b.length)):-1<a.url.indexOf("/ImageServer")?(b=a.url.substring(0,a.url.indexOf("/ImageServer")),b=b.substring(b.lastIndexOf("/")+
1,b.length)):-1<a.url.indexOf("/FeatureServer")&&(b=a.url.substring(0,a.url.indexOf("/FeatureServer")),b=b.substring(b.lastIndexOf("/")+1,b.length)):b="",a.name&&(b=0<b.length?b+(" - "+a.name):a.name));"esri.layers.ArcGISImageServiceVectorLayer"===a.declaredClass&&a.vectorFieldPixelFilter&&(a=a.vectorFieldPixelFilter.outputUnit?this["NLS_"+a.vectorFieldPixelFilter.outputUnit]:this["NLS_"+a.vectorFieldPixelFilter.inputUnit],B.isDefined(a)&&(b+=" ("+a+")"));return z.encode(b)},_getEffectiveScale:function(a,
b){var c=b.minScale,d=b.maxScale;if(B.isDefined(b.parentLayerId)){a=a.layerInfos;b=b.parentLayerId;var g;for(g=a.length-1;0<=g;g--)if(a[g].id==b)if(0==c&&0<a[g].minScale?c=a[g].minScale:0<c&&0==a[g].minScale||0<c&&0<a[g].minScale&&(c=Math.min(c,a[g].minScale)),d=Math.max(d||0,a[g].maxScale||0),-1<a[g].parentLayerId)b=a[g].parentLayerId;else break}return{minScale:c,maxScale:d}},_isSupportedLayerType:function(a){return a&&("esri.layers.ArcGISDynamicMapServiceLayer"===a.declaredClass||"esri.layers.ArcGISImageServiceLayer"===
a.declaredClass&&10.2<=a.version||"esri.layers.ArcGISImageServiceVectorLayer"===a.declaredClass||"esri.layers.ArcGISTiledMapServiceLayer"===a.declaredClass||"esri.layers.FeatureLayer"===a.declaredClass||"esri.layers.StreamLayer"===a.declaredClass||"esri.layers.KMLLayer"===a.declaredClass||"esri.layers.GeoRSSLayer"===a.declaredClass||"esri.layers.WMSLayer"===a.declaredClass||"esri.layers.WFSLayer"===a.declaredClass||"esri.layers.CSVLayer"===a.declaredClass)?!0:!1},isHostedTileService:function(a){var b=
/(https?:)?\/\/services.*\.arcgis\.com/i;return"esri.layers.ArcGISTiledMapServiceLayer"===a.declaredClass&&b.test(a.url)?!0:!1},getField:function(a,b,c){if(a.getField)return a.getField(b);if(c&&c.fields){var d;q.forEach(c.fields,function(a){a.name===b&&(d=a)});return d}return null}});p.mixin(ha,{ALIGN_LEFT:0,ALIGN_RIGHT:1});return ha})},"dojo/debounce":function(){define([],function(){return function(k,e){var p;return function(){p&&clearTimeout(p);var q=this,n=arguments;p=setTimeout(function(){k.apply(q,
n)},e)}}})},"esri/numberUtils":function(){define(["dojo/has","dojo/number","dojo/i18n!dojo/cldr/nls/number","./kernel"],function(k,e,p,q){var n=function(e,f){return e-f},l={_reNumber:/^-?(\d+)(\.(\d+))?$/i,getDigits:function(e){var f=String(e),d=f.match(l._reNumber);e={integer:0,fractional:0};d&&d[1]?(e.integer=d[1].split("").length,e.fractional=d[3]?d[3].split("").length:0):-1<f.toLowerCase().indexOf("e")&&(d=f.split("e"),f=d[0],d=d[1],f&&d&&(f=Number(f),d=Number(d),(e=0<d)||(d=Math.abs(d)),f=l.getDigits(f),
e?(f.integer+=d,f.fractional=d>f.fractional?0:f.fractional-d):(f.fractional+=d,f.integer=d>f.integer?1:f.integer-d),e=f));return e},getFixedNumbers:function(e,f){var d;d=Number(e.toFixed(f));d<e?e=d+1/Math.pow(10,f):(e=d,d-=1/Math.pow(10,f));d=Number(d.toFixed(f));e=Number(e.toFixed(f));return[d,e]},getPctChange:function(e,f,d,c){var a={prev:null,next:null},b;null!=d&&(b=e-d,a.prev=Math.floor(Math.abs(100*(f-d-b)/b)));null!=c&&(b=c-e,a.next=Math.floor(Math.abs(100*(c-f-b)/b)));return a},round:function(e,
f){e=e.slice(0);var d,c,a,b,g,h,m,k,t=f&&null!=f.tolerance?f.tolerance:2,p=f&&f.indexes,q=f&&null!=f.strictBounds?f.strictBounds:!1;if(p)p.sort(n);else for(p=[],g=0;g<e.length;g++)p.push(g);for(g=0;g<p.length;g++)if(k=p[g],f=e[k],d=0===k?null:e[k-1],c=k===e.length-1?null:e[k+1],a=l.getDigits(f),a=a.fractional){h=0;for(m=!1;h<=a&&!m;)b=l.getFixedNumbers(f,h),b=q&&0===g?b[1]:b[0],m=l.hasMinimalChange(f,b,d,c,t),h++;m&&(e[k]=b)}return e},hasMinimalChange:function(e,f,d,c,a){e=l.getPctChange(e,f,d,c);
f=null==e.prev||e.prev<=a;d=null==e.next||e.next<=a;return f&&d||e.prev+e.next<=2*a},_reAllZeros:new RegExp("\\"+p.decimal+"0+$","g"),_reSomeZeros:/(\d)0*$/g,format:function(h,f){f=f||{places:20,round:-1};(h=e.format(h,f))&&(h=h.replace(l._reSomeZeros,"$1").replace(l._reAllZeros,""));return h}};return l})},"esri/renderers/utils":function(){define("dojo/_base/lang dojo/_base/array dojo/has dojo/date/locale ../kernel ../numberUtils ../Color dojo/i18n!dojo/cldr/nls/gregorian".split(" "),function(k,e,
p,q,n,l,h,f){function d(a){return a&&e.map(a,function(a){return new h(a)})}function c(a,c,d){var g="";0===c?g=b.lt+" ":c===d&&(g=b.gt+" ");return g+a}var a={},b={lte:"\x3c\x3d",gte:"\x3e\x3d",lt:"\x3c",gt:"\x3e",pct:"%"},g={millisecond:0,second:1,minute:2,hour:3,day:4,month:5,year:6},u={millisecond:{dateOptions:{formatLength:"long"},timeOptions:{formatLength:"medium"}},second:{dateOptions:{formatLength:"long"},timeOptions:{formatLength:"medium"}},minute:{dateOptions:{formatLength:"long"},timeOptions:{formatLength:"short"}},
hour:{dateOptions:{formatLength:"long"},timeOptions:{formatLength:"short"}},day:{selector:"date",dateOptions:{formatLength:"long"}},month:{selector:"date",dateOptions:{formatLength:"long"}},year:{selector:"date",dateOptions:{selector:"year"}}},m={formatLength:"short",fullYear:!0},r={formatLength:"short"};k.mixin(a,{timelineDateFormatOptions:{selector:"date",dateOptions:{formatLength:"short",fullYear:!0}},formatDate:function(a,b){var c=[];null==a||a instanceof Date||(a=new Date(a));b=b||{};b=k.mixin({},
b);var d=b.selector?b.selector.toLowerCase():null,g=!d||-1<d.indexOf("time"),d=!d||-1<d.indexOf("date");g&&(b.timeOptions=b.timeOptions||r,b.timeOptions&&(b.timeOptions=k.mixin({},b.timeOptions),b.timeOptions.selector=b.timeOptions.selector||"time",c.push(b.timeOptions)));d&&(b.dateOptions=b.dateOptions||m,b.dateOptions&&(b.dateOptions=k.mixin({},b.dateOptions),b.dateOptions.selector=b.dateOptions.selector||"date",c.push(b.dateOptions)));c&&c.length?(c=e.map(c,function(b){return q.format(a,b)}),b=
1==c.length?c[0]:f["dateTimeFormat-medium"].replace(/\'/g,"").replace(/\{(\d+)\}/g,function(a,b){return c[b]})):b=q.format(a);return b},createColorStops:function(b){var d=b.values,g=b.colors,f=b.labelIndexes,m=b.isDate,h=b.dateFormatOptions;b=[];return b=e.map(d,function(b,n){var k=null;if(!f||-1<e.indexOf(f,n)){var r;(r=m?a.formatDate(b,h):l.format(b))&&(k=c(r,n,d.length-1))}return{value:b,color:g[n],label:k}})},updateColorStops:function(b){var d=b.stops,g=b.changes,f=b.isDate,m=b.dateFormatOptions,
h=[],n,k=e.map(d,function(a){return a.value});e.forEach(g,function(a){h.push(a.index);k[a.index]=a.value});n=l.round(k,{indexes:h});e.forEach(d,function(b,g){b.value=k[g];if(null!=b.label){var e,h=null;(e=f?a.formatDate(n[g],m):l.format(n[g]))&&(h=c(e,g,d.length-1));b.label=h}})},createClassBreakLabel:function(a){var c=a.minValue,d=a.maxValue,g=a.isFirstBreak?"":b.gt+" ";a="percent-of-total"===a.normalizationType?b.pct:"";c=null==c?"":l.format(c);d=null==d?"":l.format(d);return g+c+a+" \u2013 "+d+
a},setLabelsForClassBreaks:function(b){var c=b.classBreaks,d=b.classificationMethod,g=b.normalizationType,f=[];c&&c.length&&("standard-deviation"===d?console.log("setLabelsForClassBreaks: cannot set labels for class breaks generated using 'standard-deviation' method."):b.round?(f.push(c[0].minValue),e.forEach(c,function(a){f.push(a.maxValue)}),f=l.round(f),e.forEach(c,function(b,c){b.label=a.createClassBreakLabel({minValue:0===c?f[0]:f[c],maxValue:f[c+1],isFirstBreak:0===c,normalizationType:g})})):
e.forEach(c,function(b,c){b.label=a.createClassBreakLabel({minValue:b.minValue,maxValue:b.maxValue,isFirstBreak:0===c,normalizationType:g})}))},updateClassBreak:function(b){var c=b.classBreaks,d=b.normalizationType,g=b.change,f=g.index,g=g.value,m=-1,e=-1,h=c.length;"standard-deviation"===b.classificationMethod?console.log("updateClassBreak: cannot update labels for class breaks generated using 'standard-deviation' method."):(0===f?m=f:f===h?e=f-1:(e=f-1,m=f),-1<m&&m<h&&(b=c[m],b.minValue=g,b.label=
a.createClassBreakLabel({minValue:b.minValue,maxValue:b.maxValue,isFirstBreak:0===m,normalizationType:d})),-1<e&&e<h&&(b=c[e],b.maxValue=g,b.label=a.createClassBreakLabel({minValue:b.minValue,maxValue:b.maxValue,isFirstBreak:0===e,normalizationType:d})))},calculateDateFormatInterval:function(a){var b,c,d=a.length,f,m,h,l,n,k,r=Infinity,t;a=e.map(a,function(a){return new Date(a)});for(b=0;b<d-1;b++){f=a[b];h=[];n=Infinity;k="";for(c=b+1;c<d;c++)m=a[c],m=f.getFullYear()!==m.getFullYear()&&"year"||f.getMonth()!==
m.getMonth()&&"month"||f.getDate()!==m.getDate()&&"day"||f.getHours()!==m.getHours()&&"hour"||f.getMinutes()!==m.getMinutes()&&"minute"||f.getSeconds()!==m.getSeconds()&&"second"||"millisecond",l=g[m],l<n&&(n=l,k=m),h.push(m);n<r&&(r=n,t=k)}return t},createUniqueValueLabel:function(b){var c=b.value,d=b.fieldInfo,g=b.domain;b=b.dateFormatInterval;var f=String(c);(g=g&&g.codedValues?g.getName(c):null)?f=g:"number"===typeof c&&(f=d&&"esriFieldTypeDate"===d.type?a.formatDate(c,b&&u[b]):l.format(c));return f},
cloneColorInfo:function(a){var b;a&&(b=k.mixin({},a),b.colors=d(b.colors),b.stops=b.stops&&e.map(b.stops,function(a){a=k.mixin({},a);a.color&&(a.color=new h(a.color));return a}),b.legendOptions&&(b.legendOptions=k.mixin({},b.legendOptions)));return b},cloneOpacityInfo:function(a){var b;if(a){b=k.mixin({},a);if(a=b.opacityValues)b.opacityValues=a.slice(0);if(a=b.stops)b.stops=e.map(a,function(a){return k.mixin({},a)});if(a=b.legendOptions)b.legendOptions=k.mixin({},a)}return b},cloneSizeInfo:function(b){var c;
b&&(c=k.mixin({},b),c.stops&&(c.stops=e.map(c.stops,function(a){return k.mixin({},a)})),(b=c.minSize)&&"object"===typeof b&&(c.minSize=a.cloneSizeInfo(b)),(b=c.maxSize)&&"object"===typeof b&&(c.maxSize=a.cloneSizeInfo(b)),b=c.legendOptions)&&(c.legendOptions=k.mixin({},b),b=b.customValues)&&(c.legendOptions.customValues=b.slice(0));return c}});return a})},"jimu/LayerInfos/LayerInfoForGeoRSS":function(){define(["dojo/_base/declare","dojo/_base/array","esri/graphicsUtils","./LayerInfo","esri/lang"],
function(k,e,p,q,n){return k(q,{constructor:function(){},getExtent:function(){var e=this.layerObject.items;if(0===e.length)return null;e=p.graphicsExtent(e);return this._convertGeometryToMapSpatialRef(e)},_resetLayerObjectVisiblity:function(e){var h=e?e[this.id]:null;if(h){var f={},d;for(d in e)e.hasOwnProperty(d)&&"function"!==typeof e[d]&&(f[d]=e[d].visible);this._setSubLayerVisibleByCheckedInfo(f);this._setTopLayerVisible(h.visible)}},_setSubLayerVisibleByCheckedInfo:function(l){e.forEach(this.newSubLayers,
function(e){n.isDefined(l[e.id])&&e.layerObject.setVisibility(l[e.id])},this)},_initVisible:function(){var e=!1,h;for(h=0;h<this.newSubLayers.length;h++)e=e||this.newSubLayers[h].layerObject.visible;e&&(this._visible=!0)},_setTopLayerVisible:function(l){this._visible=l?!0:!1;e.forEach(this.newSubLayers,function(e){e.setLayerVisiblefromTopLayer()},this);this._onVisibilityChanged()},obtainNewSubLayers:function(){var l=[],h=this.layerObject.getFeatureLayers();e.forEach(h,function(f){f=this._layerInfoFactory.create({layerObject:f,
title:f.label||f.title||f.name||f.id||" ",id:f.id||" ",subId:f.id||" ",collection:{layerInfo:this},selfType:"geo_rss",parentLayerInfo:this});l.push(f);f.init()},this);this._markInvalidSubLayerInfoThatAsRootLayer(h);return l},_markInvalidSubLayerInfoThatAsRootLayer:function(l){var h;e.forEach(l,function(f){if(h=this._getLayerInfosObj()._findTopLayerInfoById(f.id))h._flag._invalid=!0},this)},_needToRenew:function(){var e=this.layerObject.getFeatureLayers();return(e?e.length:0)===this.newSubLayers.length?
!1:!0},_obtainLayerIndexesInMap:function(){var e=[],h,f;for(f=0;f<this.newSubLayers.length;f++)(h=this._getLayerIndexesInMapByLayerId(this.newSubLayers[f].layerObject.id))&&e.push(h);return e},moveLeftOfIndex:function(e){var h;for(h=this.newSubLayers.length-1;0<=h;h--)this.map.reorderLayer(this.newSubLayers[h].layerObject,e)},moveRightOfIndex:function(e){var h;for(h=0;h<this.newSubLayers.length;h++)this.map.reorderLayer(this.newSubLayers[h].layerObject,e)}})})},"jimu/LayerInfos/LayerInfoForWMS":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/topic dojo/Deferred esri/graphicsUtils dojo/aspect ./LayerInfo ./LayerInfoForDefaultWMS esri/layers/FeatureLayer esri/lang".split(" "),
function(k,e,p,q,n,l,h,f,d,c,a){return k(f,{constructor:function(a,c){},getExtent:function(){return this._convertGeometryToMapSpatialRef(this.originOperLayer.layerObject.extent)},_initVisible:function(){this._visible=this.layerObject.visible},_setTopLayerVisible:function(a){this._visible=a;this.layerObject.setVisibility(a)},_setSubLayerVisible:function(a){var b=[],c,b=p.clone(this.originOperLayer.layerObject.visibleLayers),d;for(d in a)if(a.hasOwnProperty(d)&&"function"!==typeof a[d]){var f=a[d],
h=d.toString();c=e.indexOf(b,h);f?0>c&&b.push(h):0<=c&&b.splice(c,1)}this._setVisibleLayersBySelfFlag=!0;this.layerObject.setVisibleLayers(b)},_resetLayerObjectVisiblity:function(a){var b=a?a[this.id]:null,c=!1;if(a){b&&this.layerObject.setVisibility(b.visible);var b={},d;for(d in a)a.hasOwnProperty(d)&&"function"!==typeof a[d]&&(c=!0,b[d]=a[d].visible);c&&this._setSubLayerVisibleByCheckedInfo(b)}},_setSubLayerVisibleByCheckedInfo:function(b){var c={};this.traversal(function(c){c.isRootLayer()||a.isDefined(b[c.id])&&
c._setVisible(b[c.id])});this.traversal(function(a){0===a.getSubLayers().length&&(c[a.subId]=a._isAllSubLayerVisibleOnPath())});this._setSubLayerVisible(c)},_getServiceDefinition:function(){var a=this.getUrl();return this._serviceDefinitionBuffer.getRequest(this.subId).request(a)},_serviceDefinitionRequest:function(a){return this._normalRequest(a,{SERVICE:"WMS",REQUEST:"GetCapabilities"},"xml")},obtainNewSubLayers:function(){var a=[];e.forEach(this.layerObject.layerInfos,function(b,c){b=this._getOperLayerFromWMSLayerInfo(b,
this);b=this._layerInfoFactory.create(b);a.push(b);b.init()},this);return a},_getOperLayerFromWMSLayerInfo:function(a,c){return{layerObject:this.layerObject,title:a.label||a.title||a.name||" ",id:this.id+"_"+(a.name||"-"),subId:a.name||"-",wms:{layerInfo:this,subId:a.name||"-",wmsLayerInfo:a},selfType:"wms",parentLayerInfo:c}},_bindEvent:function(){this.inherited(arguments);this.layerObject&&!this.layerObject.empty&&h.after(this.layerObject,"setVisibleLayers",p.hitch(this,this._onVisibleLayersChanged))},
_onVisibleLayersChanged:function(){var a=[];this._setVisibleLayersBySelfFlag||(this.traversal(function(a){a.isRootLayer()||a._initVisible()}),this._setVisibleLayersBySelfFlag=!1);this.traversal(function(b){b.isRootLayer()||a.push(b)});this._setVisibleLayersBySelfFlag=!1;q.publish("layerInfos/layerInfo/visibleChanged",a);this._isShowInMapChanged2()}})})},"jimu/LayerInfos/LayerInfoForDefaultWMS":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/html dojo/dom-construct dojo/on ./LayerInfoForDefault".split(" "),
function(k,e,p,q,n,l){return k(l,{constructor:function(e,f){this.layerObject=e.layerObject},getExtent:function(){},_resetLayerObjectVisiblity:function(){},_initVisible:function(){var h=!1;this.traversal(function(f){if(0<=e.indexOf(f.layerObject.visibleLayers,f.subId))return h=!0});this._visible=h},_setVisible:function(e){this._visible=e?!0:!1},_setTopLayerVisible:function(e){var f=this.originOperLayer.wms;this._visible=e?!0:!1;var d={};this.traversal(function(c){0===c.getSubLayers().length&&(d[c.subId]=
c._isAllSubLayerVisibleOnPath())});f.layerInfo._setSubLayerVisible(d)},_getServiceDefinition:function(){var e=this.getUrl();return this._serviceDefinitionBuffer.getRequest(this.subId).request(e)},_serviceDefinitionRequest:function(e){return this._normalRequest(e,{SERVICE:"WMS",REQUEST:"GetCapabilities"},"xml")},obtainNewSubLayers:function(){var h=[],f=this.originOperLayer.wms;e.forEach(f.wmsLayerInfo.subLayers,function(d){d=f.layerInfo._getOperLayerFromWMSLayerInfo(d,this);d=this._layerInfoFactory.create(d);
h.push(d);d.init()},this);return h},drawLegends:function(e){this._initLegendsNode(e)},_initLegendsNode:function(e){if(this.originOperLayer.wms.wmsLayerInfo.legendURL){var f=q.create("img",{"class":"legend-div-image",src:this.originOperLayer.wms.wmsLayerInfo.legendURL});n(f,"load",function(){q.empty(e);var d=q.create("div",{"class":"legend-div"},e);p.place(f,d)})}else q.empty(e)},getOpacity:function(){},setOpacity:function(e){},_bindEvent:function(){},_onVisibleLayersChanged:function(){},getScaleRange:function(){return this.originOperLayer.wms.layerInfo.getScaleRange()}})})},
"jimu/LayerInfos/LayerInfoForDefaultDynamic":function(){define(["dojo/_base/declare","./LayerInfoForDefaultService"],function(k,e){return k(e,{constructor:function(e,k){},_initVisible:function(){var e=!1,k=this.originOperLayer.mapService;k&&k.layerInfo._subLayerVisible[k.subId]&&(e=!0);this._visible=e},_setTopLayerVisible:function(e){var k=this.originOperLayer.mapService;if(k){k.layerInfo._subLayerVisible[k.subId]=e?!0:!1;this._visible=e;var n={};this.traversal(function(e){0===e.getSubLayers().length&&
(n[e.originOperLayer.mapService.subId]=e._isAllSubLayerVisibleOnPath())});k.layerInfo._setSubLayerVisible(n)}}})})},"jimu/LayerInfos/LayerInfoForDefaultService":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/Deferred dojo/dom-construct ./LayerInfoForDefault ./LayerObjectFacory".split(" "),function(k,e,p,q,n,l,h){return k(l,{_legendsNode:null,_layerObjectFacory:null,constructor:function(){this._layerObjectFacory=new h(this)},_resetLayerObjectVisiblity:function(){},_loadLegends:function(f){var d=
new q;this.originOperLayer.mapService.layerInfo.getLegendInfo(f).then(p.hitch(this,function(c){d.resolve(c)}));return d},drawLegends:function(f,d){this._loadLegends(d).then(p.hitch(this,function(c){this._initLegendsNode(c,f)}))},_initLegendsNode:function(f,d){var c=this.originOperLayer.mapService;if(f){n.empty(d);for(var a=null,b=0;b<f.length;b++)if(f[b].layerId===c.subId){a=f[b];break}if(a){var g=n.create("table",{"class":"legend-table",style:"font-size: 12px"},d);e.forEach(a.legend,function(a){if("\x3call other values\x3e"!==
a.label){var b=n.create("tr",{"class":"legend-tr",style:"border: 1px solid"},g),c=n.create("td",{"class":"legend-symbol-td",style:""},b),d=null,d=a.imageData?"data:"+a.contentType+";base64,"+a.imageData:a.url;n.create("img",{"class":"legend-symbol-image",style:"overflow:auto;margin:auto;top:0;left:0;bottom:0;right:0",src:d},c);n.create("td",{"class":"legend-label-td",innerHTML:a.label||" ",style:"padding-left: 5px"},b)}},this)}}},_initControlPopup:function(){var f=this.originOperLayer.mapService.layerInfo.layerObject,
d=this.originOperLayer.mapService.subId;this.controlPopupInfo={enablePopup:f.infoTemplates&&f.infoTemplates[d]?!0:!1,infoTemplates:void 0}},_afterSetInfoTemplates:function(){var f=this.originOperLayer.mapService.layerInfo.layerObject,d=this.originOperLayer.mapService.subId;!this.controlPopupInfo.enablePopup&&f.infoTemplates&&delete f.infoTemplates[d]},_getShowLegendOfWebmap:function(){return this.originOperLayer.mapService.layerInfo._getSublayerShowLegendOfWebmap(this.originOperLayer.mapService.subId)},
_getServiceDefinition:function(){return this.originOperLayer.mapService.layerInfo._getSubserviceDefinition(this.originOperLayer.mapService.mapServiceSubId)},_getLayerObject:function(f){var d=new q;(f?this._layerObjectFacory.getLayerObjectWithUrl(f):this._layerObjectFacory.getLayerObject()).then(p.hitch(this,function(c){this.layerObject.empty&&c&&(this.layerObject=c);d.resolve(c)}));return d},getLayerObject:function(){return this._getLayerObject()},getLayerObjectTryUsingFeatureService:function(){var f;
return this.isItemLayer()?this.getItemInfo().then(p.hitch(this,function(d){d&&d.getItemData()&&d.getItemData().layers&&e.some(d.getItemData().layers,function(c){if(c.id===this.subId)return f=c.layerUrl,!0},this);return f?this._getLayerObject(f):this._getLayerObject()})):this.getLayerObject()},getPopupInfo:function(){var f=null,d=this.originOperLayer.mapService.layerInfo.originOperLayer.layers;if(d)for(var c=0;c<d.length;c++)if(d[c].id===this.originOperLayer.mapService.subId){f=d[c].popupInfo;break}return f},
getFilterOfWebmap:function(){var f=null,d=this.originOperLayer.mapService.layerInfo.originOperLayer.layers;if(d)for(var c=0;c<d.length;c++)if(d[c].id===this.originOperLayer.mapService.subId){f=d[c].layerDefinition?d[c].layerDefinition.definitionExpression:null;break}return f},getFilter:function(){var f=this.originOperLayer.mapService;return f.layerInfo.layerObject&&f.layerInfo.layerObject.layerDefinitions?f.layerInfo.layerObject.layerDefinitions[f.subId]:null},setFilter:function(f){var d,c=this.originOperLayer.mapService;
c.layerInfo.layerObject&&c.layerInfo.layerObject.setLayerDefinitions&&(d=c.layerInfo.layerObject.layerDefinitions?e.map(c.layerInfo.layerObject.layerDefinitions,function(a){return a}):[],d[c.subId]=f,c.layerInfo.layerObject.setLayerDefinitions(d))},getLayerType:function(){var f=new q;0<this.getSubLayers().length?f.resolve("GroupLayer"):this._getServiceDefinition().then(p.hitch(this,function(d){d?f.resolve(d.type.replace(/\ /g,"")):f.resolve(null)}),function(){f.resolve(null)});return f},getSupportTableInfo:function(){var f=
new q,d={isSupportedLayer:!1,isSupportQuery:!1,layerType:null};this.getLayerType().then(p.hitch(this,function(c){d.layerType=c;0<=this._getLayerTypesOfSupportTable().indexOf(c)&&(d.isSupportedLayer=!0);this._getServiceDefinition().then(p.hitch(this,function(a){a&&0<=a.capabilities.indexOf("Data")&&(d.isSupportQuery=!0);f.resolve(d)}),function(){f.resolve(d)})}),function(){f.resolve(d)});return f},enablePopup:function(){var f=this.originOperLayer.mapService.layerInfo,d=f.layerObject,c=this.originOperLayer.mapService.subId;
return this.loadInfoTemplate().then(p.hitch(this,function(){return f.controlPopupInfo.infoTemplates&&f.controlPopupInfo.infoTemplates[c]?(this.controlPopupInfo.enablePopup=!0,d.infoTemplates||(d.infoTemplates={}),d.infoTemplates[c]=f.controlPopupInfo.infoTemplates[c],!0):!1}))},disablePopup:function(){var f=this.originOperLayer.mapService.layerInfo.layerObject,d=this.originOperLayer.mapService.subId;this.controlPopupInfo.enablePopup=!1;f.infoTemplates&&delete f.infoTemplates[d]},loadInfoTemplate:function(){var f=
new q,d=this.originOperLayer.mapService.layerInfo,c=this.originOperLayer.mapService.subId;d.controlPopupInfo.infoTemplates&&d.controlPopupInfo.infoTemplates[c]&&d.controlPopupInfo.infoTemplates[c].infoTemplate?f.resolve(d.controlPopupInfo.infoTemplates[c].infoTemplate):(d.controlPopupInfo.infoTemplates||(d.controlPopupInfo.infoTemplates={}),this.getLayerObject().then(p.hitch(this,function(a){a=this._getDefaultPopupTemplate(a);d.controlPopupInfo.infoTemplates[c]={infoTemplate:a,layerUrl:null};f.resolve(a)}),
p.hitch(this,function(){f.resolve(null)})));return f},getInfoTemplate:function(){var f=this.originOperLayer.mapService.layerInfo,d=this.originOperLayer.mapService.subId;return f.controlPopupInfo.infoTemplates&&f.controlPopupInfo.infoTemplates[d]&&f.controlPopupInfo.infoTemplates[d].infoTemplate?f.controlPopupInfo.infoTemplates[d].infoTemplate:null},getScaleRange:function(){var f=this.originOperLayer.mapService;return(f=f.layerInfo._getJsapiLayerInfoById(f.subId))&&0<=f.minScale&&0<=f.maxScale?{minScale:f.minScale,
maxScale:f.maxScale}:{minScale:0,maxScale:0}},_onVisibilityChanged:function(){}})})},"jimu/LayerInfos/LayerObjectFacory":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/Deferred ./RequestBuffer esri/layers/FeatureLayer esri/layers/RasterLayer esri/layers/StreamLayer esri/layers/ArcGISImageServiceLayer esri/layers/ArcGISImageServiceVectorLayer".split(" "),function(k,e,p,q,n,l,h,f,d,c){return k(null,{_layerInfo:null,_layerObjectBuffer:null,constructor:function(a){this._layerInfo=
a;this._initLayerObjectBuffer()},_initLayerObjectBuffer:function(){this._layerObjectBuffer=new n(e.hitch(this,this._getLayerObject))},getLayerObject:function(){var a=this._layerInfo.getUrl();return this._layerObjectBuffer.getRequest(this._layerInfo.subId).request(a)},getLayerObjectWithUrl:function(a){return this._layerObjectBuffer.getRequest(this._layerInfo.subId+"_url").request(a)},_getLayerObject:function(a){var b,g=new q;this._layerInfo.getLayerType().then(e.hitch(this,function(n){var m=e.mixin(this._getLayerOptionsForCreateLayerObject(),
this._layerInfo.originOperLayer.options||{})||{};switch(n){case "FeatureLayer":b=new l(a,m);break;case "RasterLayer":b=new h(a);break;case "StreamLayer":b=new f(a);break;case "ArcGISImageServiceLayer":b=new d(a);break;case "ArcGISImageServiceVectorLayer":b=new c(a);break;case "Table":if(this._layerInfo.layerObject&&this._layerInfo.layerObject.url)b=new l(a,m);else return this._layerInfo.layerObject&&this._layerInfo.layerObject.featureCollectionData?(b=new l(this._layerInfo.layerObject.featureCollectionData,
m),this._setLayerObjectProperties(b),g.resolve(b)):g.resolve(null),g;break;case "GroupLayer":return g=this._getGroupLayerObject();default:return g.resolve(null),g}var k=b.on("load",e.hitch(this,function(){this._setLayerObjectProperties(b);g.resolve(b);k.remove&&k.remove()})),t=b.on("error",e.hitch(this,function(a){g.reject(a);t.remove&&t.remove()}))}),e.hitch(this,function(){g.reject()}));return g},_getGroupLayerObject:function(){var a=new q;this._layerInfo._getServiceDefinition().then(e.hitch(this,
function(b){if(null===b)a.reject();else{var c=this._layerInfo.getUrl();b.url=c;b.id=this._layerInfo.id;a.resolve(b)}}));return a},_getLayerOptionsForCreateLayerObject:function(){var a={},b=[],c=this._layerInfo.getInfoTemplate();c&&c.info&&c.info.fieldInfos?p.forEach(c.info.fieldInfos,function(a){a.visible&&b.push(a.fieldName)},this):b=["*"];a.outFields=b;return a},_setLayerObjectProperties:function(a){a.name&&!e.getObject("_wabProperties.originalLayerName",!1,a)&&(e.setObject("_wabProperties.originalLayerName",
a.name,a),a.name=this._layerInfo.title);a.id=this._layerInfo.id}})})},"esri/layers/RasterLayer":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/connect dojo/_base/array dojo/sniff dojo/dom-construct dojo/dom-style dojo/number ../lang ../domUtils ./BaseRasterLayer ./ImageServiceLayerMixin ./pixelFilters/StretchFilter ../SpatialReference ../geometry/Point".split(" "),function(k,e,p,q,n,l,h,f,d,c,a,b,g,u,m){return k([a,b],{declaredClass:"esri.layers.RasterLayer",constructor:function(a,
b){this.pixelData=null;null!==this.format&&void 0!==this.format||this.setImageFormat("LERC",!0)},_setDefaultFilter:function(){if(this.loaded&&this.drawType&&!this._isVectorData()&&(!this.pixelFilter||this._isDefaultPixelFilter))if("jpeg"===this.format.toLowerCase()||"jpg"===this.format.toLowerCase()||-1<this.format.toLowerCase().indexOf("png"))this._isDefaultPixelFilter&&(this.pixelFilter=null,this._isDefaultPixelFilter=!1);else{var a,b;if(this.minValues&&this.maxValues&&this.stdvValues&&this.meanValues){a=
[];for(b=0;b<this.minValues.length;b++)a.push([this.minValues[b],this.maxValues[b],this.meanValues[b],this.stdvValues[b]]);this.bandCount!==a.length&&(a=null)}b=0;var c=!1;"U8"===this.pixelType?(b=5,c=a?!1:!0):a?(b=5,c=!1):(b=6,c=!0);this.renderingRule&&(b=5,c=!0);this.pixelFilter=(new g({stretchType:b,min:0,max:255,dra:c,minPercent:.25,maxPercent:.25,useGamma:!1,computeGamma:!1,statistics:a,numberOfStandardDeviations:2.5})).filter;this._isDefaultPixelFilter=!0}}})})},"esri/layers/BaseRasterLayer":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/connect dojo/_base/array dojo/sniff dojo/dom-construct dojo/dom-style dojox/gfx/matrix ../kernel ../config ../lang ../domUtils ../geometry/Point ./layer".split(" "),
function(k,e,p,q,n,l,h,f,d,c,a,b,g,u){var m=c.defaults.map.zoomDuration;return k([u],{declaredClass:"esri.layers.BaseRasterLayer",managedSuspension:!0,opacity:1,constructor:function(a,b){this.drawMode=b&&void 0!==b.drawMode?b.drawMode:!0;this.drawType=b&&b.drawType?b.drawType:"2d";this.pixelData=null;this._initialize(a,b)},setDrawMode:function(a){this.drawMode=a},setOpacity:function(a){this.opacity!==a&&(this.opacity=a,this.onOpacityChange(a))},onOpacityChange:function(){},refresh:function(){if(!this._canDraw()||
10>n("ie"))this.onError(Error("Unable to refresh. This layer is not supported in the current browser."));else this._map&&this._extentChangeHandler(this._map.extent)},clear:function(){this._canDraw()&&"2d"===this.drawType&&this._context.clearRect(0,0,this._mapWidth,this._mapHeight)},getContext:function(){return this._context},onResume:function(){this.inherited(arguments);this._toggleTime();if("css-transforms"===this._map.navigationMode){var a=this._map.__visibleDelta;this._left=this._tdx=a.x;this._top=
this._tdy=a.y;h.set(this._div,d._css.names.transform,d._css.translate(this._left,this._top))}this._displayTimer=this._displayTimer||setTimeout(e.hitch(this,function(){this._extentChangeHandler(this._map.extent,null,!0)}),0)},onSuspend:function(){this.inherited(arguments);this._toggleTime();clearTimeout(this._displayTimer);this._displayTimer=null},redraw:function(){this.hasDataChanged=!1;this._setPixelData(this.originalPixelData)},getCurrentResolution:function(){var a=this._map.extent;return new g((a.xmax-
a.xmin)/this._map.width,(a.ymax-a.ymin)/this._map.height,a.spatialReference)},setPixelFilter:function(a,b){this.pixelFilter=a;b||this.redraw()},_toggleTime:function(){},_setMap:function(b,c){this.inherited(arguments);this._dragOrigin={x:0,y:0};var g=this._div=l.create("div",null,c),f={width:b.width+"px",height:b.height+"px",position:"absolute"};"css-transforms"===b.navigationMode?(f[d._css.names.transform]=d._css.translate(b.__visibleDelta.x,b.__visibleDelta.y),this._left=b.__visibleDelta.x,this._top=
b.__visibleDelta.y):this._left=this._top=0;h.set(g,f);this._canvas=l.create("canvas",{id:"canvas",width:b.width+"px",height:b.height+"px",style:"position: absolute;"},g);a.isDefined(this.opacity)&&h.set(g,"opacity",this.opacity);(this._context=this._canvas.getContext(this.drawType))||console.error("Unable to create the context. This browser might not support \x3ccanvas\x3e elements.");this._mapWidth=b.width;this._mapHeight=b.height;this._connects=[];this._connects.push(p.connect(b,"onPan",this,this._panHandler));
this._connects.push(p.connect(b,"onPanEnd",this,this._panEndHandler));"css-transforms"===b.navigationMode?this._connects.push(p.connect(b,"onScale",this,this._onScaleHandler)):(this._connects.push(p.connect(b,"onZoom",this,this._onZoomHandler)),this._connects.push(p.connect(b,"onZoomEnd",this,this._onZoomEndHandler)));this._connects.push(p.connect(b,"onResize",this,this._onResizeHandler));this._connects.push(p.connect(b,"onExtentChange",this,this._extentChangeHandler));this._connects.push(p.connect(this,
"onVisibilityChange",this,this._visibilityChangeHandler));this._connects.push(p.connect(this,"onOpacityChange",this,this._opacityChangeHandler));this._startRect={left:0,top:0,width:b.width,height:b.height};this.evaluateSuspension();if(this.suspended&&!b.loaded)var e=p.connect(b,"onLoad",this,function(){p.disconnect(e);e=null;this.evaluateSuspension()});return g},_unsetMap:function(a,b){q.forEach(this._connects,p.disconnect,this);var c=this._div;c&&(b.removeChild(c),l.destroy(c));this._map=this._canvas=
this._context=this.data=this._connects=null;clearTimeout(this._displayTimer);this._displayTimer=null;this.inherited(arguments)},_canDraw:function(){return!!(this._map&&this._canvas&&this._context)},_requestDataErrorHandler:function(a){"CancelError"!==a.name&&(this.clear(),this.onError(a))},_drawPixelData:function(){this._startRect={left:0,top:0,width:this._map.width,height:this._map.height};var a=this._useBrowserDecoding();!a&&this.drawMode||"css-transforms"!==this._map.navigationMode||(this._tdx=
this._left,this._tdy=this._top,this._multiply=null,h.set(this._div,d._css.names.transform,d._css.translate(this._left,this._top)),h.set(this._canvas,d._css.names.transform,d._css.translate(-this._left,-this._top)),this._dragOrigin={x:0,y:0});if(this._canDraw&&this.drawMode)if(a)this._fireUpdateEnd();else if(this.drawMode)if(this.pixelData&&this.pixelData.pixelBlock){var a=this.pixelData.pixelBlock,b=this._context,c=b.createImageData(a.width,a.height);c.data.set(a.getAsRGBA());var g=this.pixelData.extent,
f=this._map.extent,e=this.getCurrentResolution(),m=0,l=0;Math.abs(g.xmin-f.xmin)>e.x&&(m=Math.round((g.xmin-f.xmin)/e.x));Math.abs(f.ymax-g.ymax)>e.y&&(l=Math.round((f.ymax-g.ymax)/e.y));this.clear();"css-transforms"===this._map.navigationMode?(this._tdx=this._left,this._tdy=this._top,this._multiply=null,h.set(this._div,d._css.names.transform,d._css.translate(this._left,this._top)),h.set(this._canvas,d._css.names.transform,d._css.translate(-this._left,-this._top))):(h.set(this._div,{left:"0px",top:"0px",
width:this._map.width+"px",height:this._map.height+"px"}),h.set(this._canvas,{left:"0px",top:"0px",width:this._map.width+"px",height:this._map.height+"px"}));this._dragOrigin={x:0,y:0};b.putImageData(c,m,l,0,0,a.width,a.height);this._fireUpdateEnd()}else this.clear()},_panHandler:function(a,b){"css-transforms"===this._map.navigationMode?(this._left=this._map.__visibleDelta.x+b.x,this._top=this._map.__visibleDelta.y+b.y,h.set(this._div,d._css.names.transform,d._css.translate(this._left,this._top))):
h.set(this._div,{left:this._startRect.left+b.x+"px",top:this._startRect.top+b.y+"px"})},_panEndHandler:function(a,b){b&&(this._startRect.left+=b.x,this._startRect.top+=b.y)},_onScaleHandler:function(a,b){var c={},g=d._css.names;h.set(this._canvas,g.transition,b?"none":g.transformName+" "+m+"ms ease");this._matrix=a;a=this._multiply?f.multiply(a,this._multiply):a;if(this._tdx||this._tdy)a=f.multiply(a,{xx:1,xy:0,yx:0,yy:1,dx:-this._tdx,dy:-this._tdy});c[g.transform]=d._css.matrix(a);h.set(this._canvas,
c)},_onZoomHandler:function(a,b,c){var d=this._startRect;a=d.width*b;b*=d.height;var g=d.left-(a-d.width)*(c.x-d.left)/d.width;c=d.top-(b-d.height)*(c.y-d.top)/d.height;h.set(this._canvas,{left:g+"px",top:c+"px",width:a+"px",height:b+"px"});this._endRect={left:g,top:c,width:a,height:b}},_onZoomEndHandler:function(){this._endRect&&(this._startRect=this._endRect)},_onResizeHandler:function(a,b,c){h.set(this._div,{width:b+"px",height:c+"px"});h.set(this._canvas,{width:b+"px",height:c+"px"});this._startRect.width=
this._canvas.width=b;this._startRect.height=this._canvas.height=c},_extentChangeHandler:function(a,b,c,g){this.suspended||b&&0===b.x&&0===b.y&&!c||("css-transforms"===this._map.navigationMode&&(b&&(this._dragOrigin.x+=b.x,this._dragOrigin.y+=b.y),c||(this._left=this._map.__visibleDelta.x,this._top=this._map.__visibleDelta.y,h.set(this._div,d._css.names.transform,d._css.translate(this._left,this._top))),c&&(h.set(this._canvas,d._css.names.transition,"none"),this._multiply=this._multiply?f.multiply(this._matrix,
this._multiply):this._matrix)),this._fireUpdateStart(),a=this._map,this._requestData(a.extent,a.width,a.height))},_visibilityChangeHandler:function(a){a?b.show(this._div):b.hide(this._div)},_opacityChangeHandler:function(a){h.set(this._div,"opacity",a)}})})},"esri/layers/ImageServiceLayerMixin":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/Deferred dojo/_base/array dojo/_base/json dojo/_base/config dojo/_base/connect dojo/has dojo/io-query dojo/DeferredList ../kernel ../config ../lang ../request ../deferredUtils ../urlUtils ../geometry/Extent ../geometry/Point ../geometry/Polygon ./MosaicRule ./RasterFunction ./DimensionalDefinition ./Raster ./PixelBlock ./pixelFilters/VectorFieldPixelFilter ./rasterFormats/ImageCanvasDecoder ./TimeInfo ./Field ../graphic ../tasks/ImageServiceIdentifyTask ../tasks/ImageServiceIdentifyParameters".split(" "),
function(k,e,p,q,n,l,h,f,d,c,a,b,g,u,m,r,t,v,y,w,z,x,A,C,B,E,D,F,I,M,L){return k(null,{declaredClass:"esri.layers.ImageServiceLayerMixin",_rasterFieldPrefix:"Raster.",_renderingRuleFieldSubPrefix:"ServicePixelValue.",_rasterFunctionServiceInfoProps:"bandCount pixelType hasRasterAttributeTable hasHistograms minValues maxValues meanValues stdvValues".split(" "),_rasterFunctionTemplateInfos:{},_pixelTypeRanges:{U1:[0,1],U2:[0,3],U4:[0,15],U8:[0,255],S8:[-128,127],U16:[0,65535],S16:[-32768,32767]},_eventMap:{"rendering-change":!0,
"mosaic-rule-change":!0,"spatial-reference-change":!0,"renderer-change":!0},constructor:function(a,b){this.useMapTime=b&&b.hasOwnProperty("useMapTime")?!!b.useMapTime:!0},_initialize:function(a,b){this._url=r.urlToObject(a);this.raster=new A(this._url.path);this.infoTemplate=b&&b.infoTemplate;this.format=(a=b&&b.imageServiceParameters)&&a.format;this.compressionTolerance=a&&a.compressionTolerance?a.compressionTolerance:.01;this.interpolation=a?a.interpolation:null;this.compressionQuality=a?a.compressionQuality:
null;this.bandIds=a?a.bandIds:null;this.mosaicRule=a?a.mosaicRule:null;this.renderingRule=a?a.renderingRule:null;this.renderer=a?a.renderer:null;this.useMapDimensionValue=b&&b.hasOwnProperty("useMapDimensionValue")?!!b.useMapDimensionValue:!0;this.activeMapDimensions=b&&b.activeMapDimensions;this._params=e.mixin({},this._url.query,{f:"image",interpolation:this.interpolation,format:this.format,compressionQuality:this.compressionQuality,bandIds:this.bandIds?this.bandIds.join(","):null},a?a.toJson():
{});this.pixelFilter=b&&b.pixelFilter;this.originalPixelData=this.pixelData=null;this.hasDataChanged=!0;this._requestDataHandler=e.hitch(this,this._requestDataHandler);this._requestDataErrorHandler=e.hitch(this,this._requestDataErrorHandler);this._rasterReadPromise=null;this._initLayer=e.hitch(this,this._initLayer);this._queryVisibleRastersHandler=e.hitch(this,this._queryVisibleRastersHandler);this._visibleRasters=[];this._rasterAttributeTableFields=[];this._rasterAttributeTableFeatures=[];this._renderingRuleAttributeTable=
{};this._useRenderingRuleAttributeTable=!1;this._loadCallback=b&&b.loadCallback;(b=b&&b.resourceInfo)?this._initLayer(b):u({url:this._url.path,content:e.mixin({f:"json"},this._url.query),callbackParamName:"callback",load:this._initLayer,error:this._errorHandler});this.registerConnectEvents()},disableClientCaching:!1,_initLayer:function(a,b){if(null!==a&&void 0!==a){this._findCredential();(this.credential&&this.credential.ssl||a&&a._ssl)&&this._useSSL();b=this.minScale;var c=this.maxScale;e.mixin(this,
a);this.minScale=b;this.maxScale=c;this.initialExtent=this.fullExtent=this.extent=new t(a.extent);this.spatialReference=this.initialExtent.spatialReference;this.pixelSizeX=parseFloat(this.pixelSizeX);this.pixelSizeY=parseFloat(this.pixelSizeY);var d=this.minValues,f=this.maxValues,m=this.meanValues,h=this.stdvValues,l=this.bands=[];b=0;for(c=this.bandCount;b<c;b++)l[b]={min:d[b],max:f[b],mean:m[b],stddev:h[b]};this.timeInfo=(b=this.timeInfo)&&b.timeExtent?new D(b):null;c=this.fields=[];if(d=a.fields)for(b=
0;b<d.length;b++)c.push(new F(d[b]));this.version=a.currentVersion;this.version||(this.version="fields"in a||"objectIdField"in a||"timeInfo"in a?10:9.3);g.isDefined(a.minScale)&&!this._hasMin&&this.setMinScale(a.minScale);g.isDefined(a.maxScale)&&!this._hasMax&&this.setMaxScale(a.maxScale);b={};a.defaultMosaicMethod?(b.method=a.defaultMosaicMethod,b.operation=a.mosaicOperator,b.sortField=a.sortField,b.sortValue=a.sortValue):b.method=w.METHOD_NONE;this.defaultMosaicRule=new w(b);this.defaultMosaicRule.ascending=
!0;this._useRenderingRuleAttributeTable=10<this.version&&"esriImageServiceDataTypeThematic"===this.serviceDataType&&!this.hasRasterAttributeTable;this._setDefaultRenderingRule(!0);this._isScientificData()&&(!this.mosaicRule||this.mosaicRule&&!this.mosaicRule.multidimensionalDefinition)&&this._setDefaultMultidimensionalDefinition(!0);10<this.version&&this.hasRasterAttributeTable&&this.getRasterAttributeTable().then(e.hitch(this,function(a){a&&(a.features&&a.fields&&(this.rasterAttributeTable=e.clone(a)),
a.features&&0<a.features.length&&(this._rasterAttributeTableFeatures=e.clone(a.features)),a.fields&&0<a.fields.length&&(this._rasterAttributeTableFields=e.clone(a.fields)),!this.renderer||"esri.renderer.ClassBreaksRenderer"!==this.renderer.declaredClass&&"esri.renderer.UniqueValueRenderer"!==this.renderer.declaredClass||this.refresh())}));this._isVectorData()&&!g.isDefined(this.pixelFilter)&&(this.vectorFieldPixelFilter=new B,this.vectorFieldPixelFilter.isDataUV="esriImageServiceDataTypeVector-UV"===
this.serviceDataType,this.pixelFilter=this.vectorFieldPixelFilter.computeMagnitudeAndDirection,this.getKeyProperties().then(e.hitch(this,this._setFlowRepresentation)));this.loaded=!0;this._setDefaultFilter();this.onLoad(this);if(a=this._loadCallback)delete this._loadCallback,a(this)}},getKeyProperties:function(a){var b=this._url.path+"/keyProperties",c=new p(m._dfdCanceller),d={f:"json"};a&&a.renderingRule&&(d.renderingRule=n.toJson(a.renderingRule.toJson()));10<this.version?(c._pendingDfd=u({url:b,
content:d,handleAs:"json",callbackParamName:"callback"}),c._pendingDfd.then(function(a){c.callback(a)},function(a){c.errback(a)})):(a=Error("Layer does not have key properties"),a.log=!!l.isDebug,c.errback(a));return c},getRasterAttributeTable:function(a){var b=this._url.path+"/rasterAttributeTable",c=new p(m._dfdCanceller),d={f:"json"},g=this.hasRasterAttributeTable;a&&a.renderingRule&&(d.renderingRule=n.toJson(a.renderingRule.toJson()),g=!0);10<this.version&&g?(c._pendingDfd=u({url:b,content:d,
handleAs:"json",callbackParamName:"callback"}),c._pendingDfd.then(function(a){c.callback(a)},function(a){c.errback(a)})):(a=Error("Layer does not support raster attribute table"),a.log=!!l.isDebug,c.errback(a));return c},getRenderingRuleAttributeTable:function(a){var b=new p(m._dfdCanceller);if(!a||!a.renderingRule)return b.errback(Error("Rendering rule is not specified")),b;a=a.renderingRule;var c=a.functionName;this._renderingRuleAttributeTable&&c&&this._renderingRuleAttributeTable.hasOwnProperty(c)?
b.resolve(this._renderingRuleAttributeTable[c]):b=this.getRasterAttributeTable({renderingRule:a}).then(e.hitch(this,function(a){var b;a&&a.features&&a.features.length&&a.fields&&a.fields.length&&(b={features:e.clone(a.features),fields:e.clone(a.fields)},c&&(this._renderingRuleAttributeTable[c]=b));return b}));return b},_getRasterAttributeTableFeatures:function(){var a=new p;if(this._rasterAttributeTableFeatures&&0<this._rasterAttributeTableFeatures.length)return a.resolve(this._rasterAttributeTableFeatures),
a;if(10<this.version&&this.hasRasterAttributeTable)return a=this.getRasterAttributeTable(),a.then(e.hitch(this,function(a){a&&a.features&&0<a.features.length&&(this._rasterAttributeTableFeatures=e.clone(a.features))})),a;a.resolve(this._rasterAttributeTableFeatures);return a},_getRenderingRuleAttributeTableFeatures:function(a){a=a&&a.renderingRule;return a?this.getRenderingRuleAttributeTable({renderingRule:a}).then(function(a){return a&&a.features}):(a=new p,a.errback(Error("Rendering rule is not specified")),
a)},getCustomRasterFields:function(a){var b=a?a.rasterAttributeTableFieldPrefix:this._rasterFieldPrefix;a=10.3<=this.version?"esriFieldTypeDouble":"esriFieldTypeString";var c={name:this._rasterFieldPrefix+"ItemPixelValue",alias:"Item Pixel Value",domain:null,editable:!1,length:50,type:a},d={name:this._rasterFieldPrefix+"ServicePixelValue",alias:"Service Pixel Value",domain:null,editable:!1,length:50,type:a},f={name:this._rasterFieldPrefix+"ServicePixelValue.Raw",alias:"Raw Service Pixel Value",domain:null,
editable:!1,length:50,type:"esriFieldTypeDouble"},m=this.fields?e.clone(this.fields):[];a=m.length;m[a]=d;10.4<=this.version&&"esri.layers.ArcGISImageServiceLayer"===this.declaredClass&&(!this.rasterFunctionInfos||!this.rasterFunctionInfos.length||this._isRasterFunctionInfoAvailable("none"))&&(a++,m[a]=f);if(this.capabilities&&-1<this.capabilities.toLowerCase().indexOf("catalog")||this.fields&&0<this.fields.length)a++,m[a]=c;!g.isDefined(this.pixelFilter)||"esriImageServiceDataTypeVector-UV"!==this.serviceDataType&&
"esriImageServiceDataTypeVector-MagDir"!==this.serviceDataType||(c={name:this._rasterFieldPrefix+"Magnitude",alias:"Magnitude",domain:null,editable:!1,type:"esriFieldTypeDouble"},d={name:this._rasterFieldPrefix+"Direction",alias:"Direction",domain:null,editable:!1,type:"esriFieldTypeDouble"},a++,m[a]=c,a++,m[a]=d);a=this._rasterAttributeTableFields;(c=this.renderingRule&&this.renderingRule.functionName)&&this._renderingRuleAttributeTable&&this._renderingRuleAttributeTable.hasOwnProperty(c)&&(a=this._renderingRuleAttributeTable[c].fields);
a&&0<a.length&&(a=q.filter(a,function(a){return"esriFieldTypeOID"!==a.type&&"value"!==a.name.toLowerCase()}),a=q.map(a,function(a){var c=e.clone(a);c.name=b+a.name;return c}),m=m.concat(a));var h=this._rasterFieldPrefix+this._renderingRuleFieldSubPrefix;10.4<=this.version&&this.rasterFunctionInfos&&q.forEach(this.rasterFunctionInfos,function(a){a&&a.name&&"none"!==a.name.toLowerCase()&&(a={name:h+a.name.replace(/ /gi,"_"),alias:a.name,domain:null,editable:!1,type:"esriFieldTypeDouble"},m.push(a))});
return m},_prepareGetImageParameters:function(a,b,c,d){d=g.isDefined(d)?d:this._params;if(this.renderer){var f=this.getExportImageRenderingRule();d.renderingRule=f?n.toJson(f.toJson()):null}f=a.spatialReference.wkid||n.toJson(a.spatialReference.toJson(!1));delete d._ts;e.mixin(d,{bbox:a.xmin+","+a.ymin+","+a.xmax+","+a.ymax,imageSR:f,bboxSR:f,size:b+","+c},this.disableClientCaching?{_ts:(new Date).getTime()}:{});delete d.compressionTolerance;d.format&&"LERC"===d.format.toUpperCase()&&(d.compressionTolerance=
this.compressionTolerance);d.token=this._getToken()},getImageUrl:function(a,c,f,m,h){h=g.isDefined(h)?h:this._params;this._prepareGetImageParameters(a,c,f,h);a=e.clone(h);this._cleanupRequestParams(a);c=this._url.path+"/exportImage?";f=r.addProxy(c+d.objectToQuery(e.mixin(a,{f:"image"})));var l=a.token;f.length>b.defaults.io.postLength||this.useMapImage?this._jsonRequest=u({url:c,content:e.mixin(a,{f:"json"}),callbackParamName:"callback",load:function(a,b){a=a.href;l&&(a+=-1===a.indexOf("?")?"?token\x3d"+
l:"\x26token\x3d"+l);m(r.addProxy(a))},error:this._errorHandler}):m(f)},onRenderingChange:function(){},onMosaicRuleChange:function(){},onRendererChange:function(){},setInterpolation:function(a,b){this.interpolation=this._params.interpolation=a;b||this.refresh(!0)},setCompressionQuality:function(a,b){this.compressionQuality=this._params.compressionQuality=a;b||this.refresh(!0)},setCompressionTolerance:function(a,b){this.compressionTolerance=a;b||this.refresh(!0)},setBandIds:function(a,b){var c=!1;
this.bandIds!==a&&(c=!0);this.bandIds=a;this._params.bandIds=a.join(",");if(c&&!b)this.onRenderingChange();b||this.refresh(!0)},setDefaultBandIds:function(a){this.bandIds=this._params.bandIds=null;a||this.refresh(!0)},setDisableClientCaching:function(a){this.disableClientCaching=a},setMosaicRule:function(a,b){var c=!1;this.mosaicRule!==a&&(c=!0);this.mosaicRule=a;this._params.mosaicRule=n.toJson(a.toJson());if(c&&!b)this.onMosaicRuleChange();b||this.refresh(!0)},setRenderingRule:function(a,b){var c=
!1;this.renderingRule!==a&&(c=!0);this.renderingRule=a;this._params.renderingRule=a?n.toJson(a.toJson()):null;this._useRenderingRuleAttributeTable&&this.getRenderingRuleAttributeTable({renderingRule:a});if(c)this.onRenderingChange();this._setDefaultFilter();b||this.refresh(!0)},setImageFormat:function(a,b){this.format=this._params.format=a;this._setDefaultFilter();b||this.refresh(!0)},setInfoTemplate:function(a){this.infoTemplate=a},setDefinitionExpression:function(a,b){var c=this.mosaicRule?this.mosaicRule.toJson():
{};this.mosaicRule||(this.defaultMosaicRule?c=this.defaultMosaicRule.toJson():c.method=w.METHOD_NONE);c.where=a;a=new w(c);this.setMosaicRule(a,b);return this},getDefinitionExpression:function(){return this.mosaicRule?this.mosaicRule.where:null},setPixelFilter:function(a){this.pixelFilter=a;this._isDefaultPixelFilter=!1},getPixelData:function(a){return a?(this._useBrowserDecoding()&&(this.originalPixelData={pixelBlock:this._getPixelBlockFromCanvas(this._context,this._map.width,this._map.height),extent:this._map.extent}),
this.originalPixelData):this.pixelData},getExportImageRenderingRule:function(){return this._combineRenderingRule(this._convertRendererToRenderingRule(this.renderer),this.renderingRule)},redraw:function(){this.hasDataChanged=!1;this._setPixelData(this.originalPixelData)},getHistograms:function(){var a=new p(m._dfdCanceller);if(this.hasHistograms)a._pendingDfd=u({url:this._url.path+"/histograms",content:{f:"json"},handleAs:"json",callbackParamName:"callback"}),a._pendingDfd.then(function(b){a.callback(b)},
function(b){a.errback(b)});else{var b=Error("Layer does not have histograms.");b.log=!!l.isDebug;a.errback(b)}return a},computeHistograms:function(a){var b=new p(m._dfdCanceller);if(10.1<=this.currentVersion){a=a||{};var c=a.geometry||this.fullExtent,d=(a.geometry||this.fullExtent).toJson(),c="extent"===c.type?"esriGeometryEnvelope":"esriGeometryPolygon",g=a.renderingRule||this.renderingRule||this.defaultRenderingRule,g=g?g.toJson():null,f=a.mosaicRule||this.mosaicRule||this.defaultMosaicRule,f=f?
f.toJson():null;a=a.pixelSize||{x:this.pixelSizeX,y:this.pixelSizeY};b._pendingDfd=u({url:this._url.path+"/computeHistograms",content:e.mixin({f:"json",geometry:JSON.stringify(d),geometryType:c,renderingRule:JSON.stringify(g),mosaicRule:JSON.stringify(f),pixelSize:JSON.stringify(a),callbackParamName:"callback"}),handleAs:"json"});b._pendingDfd.then(function(a){b.callback(a)},function(a){b.errback(a)})}else d=Error("Layer doesn't support computeHistograms."),d.log=!!l.isDebug,b.errback(d);return b},
getRenderingRuleServiceInfo:function(a){var b=new m._fixDfd(new p(m._dfdCanceller));if(!a)return b.errback(Error("Rendering rule is not specified")),b;var c=a&&a.functionName&&!a.functionArguments?a.functionName:null;return c&&this._rasterFunctionTemplateInfos[c]?(b.resolve(this._rasterFunctionTemplateInfos[c]),b):u({url:this._url.path,content:e.mixin(e.mixin({f:"json",renderingRule:JSON.stringify(a.toJson())},this._url.query)),callbackParamName:"callback",load:e.hitch(this,function(a){var b={};q.forEach(this._rasterFunctionServiceInfoProps,
function(c){b[c]=a[c]});return this._rasterFunctionTemplateInfos[c]=b}),error:this._errorHandler})},queryVisibleRasters:function(a,b,c,d){var g=this._map,f=m._fixDfd(new p(m._dfdCanceller));this._visibleRasters=[];var h,l,n=!0,k=this.infoTemplate?this.infoTemplate.info:null,r=k?e.clone(this.infoTemplate.info.fieldInfos):null;b=b||{};if(k&&this.infoTemplate.info.mediaInfos&&this.infoTemplate.info.mediaInfos.length){var t=[];q.forEach(this.infoTemplate.info.mediaInfos,function(a){t=t.concat(a&&a.value&&
a.value.fields||[])});t.length&&q.forEach(r,function(a){a&&-1<t.indexOf(a.fieldName)&&(a.visible=!0)})}if(r&&0<r.length)for(n=!1,h=0;h<r.length;h++)if((l=r[h])&&l.fieldName.toLowerCase()!==this._rasterFieldPrefix.toLowerCase()+"servicepixelvalue"&&(l.visible||k.title&&-1<k.title.toLowerCase().indexOf(l.fieldName.toLowerCase()))){n=!0;break}var u=(l=this._removeVisualizationStretchFunction(this.renderingRule))&&l.functionName,w=[];if(10.4<=this.version){var x=!1;if(this.rasterFunctionInfos&&r){var y=
this._rasterFieldPrefix+this._renderingRuleFieldSubPrefix;q.forEach(this.rasterFunctionInfos,function(a){var b=y+a.name.replace(/ /gi,"_");q.some(r,function(a){return a.visible&&a.fieldName===b})&&(x=x||u&&u===a.name,w.push(new z({rasterFunction:a.name})))})}l&&!x&&w.push(l)}h=new L;h.geometry=a.geometry;h.returnGeometry=this._map.spatialReference.equals(this.spatialReference);h.returnCatalogItems=n;h.timeExtent=a.timeExtent;this._params.time&&this.mosaicRule?(a=e.clone(this.mosaicRule),a=this._filterOutTimeDimension(a),
h.mosaicRule=a):h.mosaicRule=this.mosaicRule||null;h.renderingRule=10.4>this.version&&l||null;h.renderingRules=w||null;g&&(g=new v((g.extent.xmax-g.extent.xmin)/g.width,(g.extent.ymax-g.extent.ymin)/g.height,g.extent.spatialReference),h.pixelSize=g);b.requestParams=h;var B=this,g=new M(this.url);(f._pendingDfd=g.execute(h)).addCallbacks(function(a){B._queryVisibleRastersHandler(a,b,c,d,f)},function(a){B._resolve([a],null,d,f,!0)});return f},_queryVisibleRastersHandler:function(a,b,c,d,f){function m(){var a=
this.getCustomRasterFields(b),d=this._getDomainFields(a),m=b?b.returnDomainValues:!1,n=b&&b.rasterAttributeTableFieldPrefix,p,u,w,v,z,x,y,B,E,I;this._useRenderingRuleAttributeTable&&this.renderingRule?(a=this._getRenderingRuleAttributeTableFeatures({renderingRule:this.renderingRule}),I=h):a=this._getRasterAttributeTableFeatures();a.then(e.hitch(this,function(a){for(p=0;p<r.length;p++){K=r[p];K.setInfoTemplate(this.infoTemplate);K._layer=this;if(h){E=h.replace(/ /gi,"").split(",");u=h;w=E;k&&k.length>=
p&&(u=k[p].replace(/ /gi,", "),w=k[p].split(" "));K.attributes[this._rasterFieldPrefix+"ItemPixelValue"]=w;K.attributes[this._rasterFieldPrefix+"ServicePixelValue"]=E;l&&(K.attributes[this._rasterFieldPrefix+"ServicePixelValue.Raw"]=l.replace(/ /gi,"").split(","));if(this.pixelFilter){var b=new C({height:1,width:1,pixelType:"F32",pixels:[],statistics:[]});q.forEach(w,function(a){b.addData({pixels:[a],statistics:{minValue:a,maxValue:a,noDataValue:null}})});this.pixelFilter({pixelBlock:b,extent:new t(0,
0,0,0,this._map.spatialReference)});if("esriImageServiceDataTypeVector-UV"===this.serviceDataType||"esriImageServiceDataTypeVector-MagDir"===this.serviceDataType)K.attributes[this._rasterFieldPrefix+"Magnitude"]=b.pixels[0][0],K.attributes[this._rasterFieldPrefix+"Direction"]=b.pixels[1][0]}q.forEach(A,function(a){K.attributes[a.name]=a.value});var D=I||u;if(a&&0<a.length&&(v=q.filter(a,function(a){if(a&&a.attributes)return a.attributes.hasOwnProperty("Value")?a.attributes.Value==D:a.attributes.VALUE==
D}),0<v.length&&(z=e.clone(v[0]),n&&z))){B={};for(x in z.attributes)z.attributes.hasOwnProperty(x)&&(y=n+x,B[y]=z.attributes[x]);z.attributes=B;K.attributes=e.mixin(K.attributes,z.attributes)}}m&&d&&0<d.length&&q.forEach(d,function(a){if(a){var b=K.attributes[a.name];g.isDefined(b)&&(b=this._getDomainValue(a.domain,b),g.isDefined(b)&&(K.attributes[a.name]=b))}},this);U.push(K);this._visibleRasters.push(K)}this._resolve([U,null,!0],null,c,f)}))}var h=a.value,l=a.value,k,r,p=0,w=0,v=this,z=this.objectIdField,
x,B,A=[];d=b.requestParams.renderingRules;var E=a.processedValues,D=this.renderingRule&&n.toJson(this._removeVisualizationStretchFunction(this.renderingRule).toJson());if(d&&E&&d.length===E.length){var F=this._rasterFieldPrefix+this._renderingRuleFieldSubPrefix;q.forEach(d,function(a,b){if(a.functionName){var c={name:F+a.functionName.replace(/ /gi,"_"),value:E[b].replace(/ /gi,"").split(",")};A.push(c);D&&D===n.toJson(a.toJson())&&(h=E[b])}})}d=this.infoTemplate&&this.infoTemplate.info&&this.infoTemplate.info.layerOptions&&
this.infoTemplate.info.layerOptions.hasOwnProperty("showNoDataRecords")?this.infoTemplate.info.layerOptions.showNoDataRecords:!0;if(a.catalogItems){var L=0,J,P,M=a.catalogItems.features.length;B=0;r=Array(M);k=Array(M);x=Array(M);for(p=0;p<M;p++)-1<a.properties.Values[p].toLowerCase().indexOf("nodata")&&B++;J=M-B;for(p=0;p<M;p++)B=!0,-1<a.properties.Values[p].toLowerCase().indexOf("nodata")?(P=J++,d||(B=!1,r.length--,k.length--,x.length--)):P=L++,B&&(r[P]=a.catalogItems.features[p],k[P]=a.properties.Values[p],
x[P]=r[P].attributes[z])}this._visibleRasters=[];var K;(a=-1<h.toLowerCase().indexOf("nodata"))&&!d&&(r=[],k=[],x=[]);!h||r||a||(z="ObjectId",r=[],K=new I(new t(this.fullExtent),null,{ObjectId:0}),r.push(K));var U=[];r?!this._map.spatialReference.equals(this.spatialReference)&&x&&0<x.length?u({url:this._url.path+"/query",content:{f:"json",objectIds:x.join(","),returnGeometry:!0,outSR:n.toJson(v._map.spatialReference.toJson()),outFields:z},handleAs:"json",callbackParamName:"callback",load:function(a){if(0===
a.features.length)v._resolve([U,null,null],null,c,f);else{for(p=0;p<a.features.length;p++)for(w=0;w<r.length;w++)r[w].attributes[z]==a.features[p].attributes[z]&&(r[w].geometry=new y(a.features[p].geometry),r[w].geometry.setSpatialReference(v._map.spatialReference));m.call(v)}},error:function(a){v._resolve([U,null,null],null,c,f)}}):m.call(this):this._resolve([U,null,null],null,c,f)},getVisibleRasters:function(){var a=this._visibleRasters,b=[],c;for(c in a)a.hasOwnProperty(c)&&b.push(a[c]);return b},
_getDomainFields:function(a){if(a){var b=[];q.forEach(a,function(a){if(a.domain){var c={};c.name=a.name;c.domain=a.domain;b.push(c)}});return b}},_getDomainValue:function(a,b){if(a&&a.codedValues){var c;q.some(a.codedValues,function(a){return a.code===b?(c=a.name,!0):!1});return c}},_requestData:function(a,b,c){this._rasterReadPromise&&this._rasterReadPromise.cancel();a=e.clone(a);var d=a._normalize(!0);this._prepareGetImageParameters(d,b,c);b=e.clone(this._params);this._cleanupRequestParams(b);b.extent=
a;b.format=b.format||(10.3<=this.version?"lerc":"jpgpng");"lerc"===b.format.toLowerCase()&&!b.lercVersion&&10.5<=this.version&&(b.lercVersion=2);c=null;this._useBrowserDecoding()&&(c=new E({ctx:this._context}));b={imageServiceParameters:b,nBands:Math.min(this.bandCount,3),pixelType:this.pixelType,decodeFunc:c?e.hitch(c,"decode"):null};this._rasterReadPromise=this.raster.read(b,this._requestDataHandler,this._requestDataErrorHandler)},_requestDataHandler:function(a){this._rasterReadPromise&&this._rasterReadPromise.isCanceled()||
(this.originalPixelData=a,this.hasDataChanged=!0,this._setPixelData(a))},_setPixelData:function(a){a=this._clonePixelData(a);this.pixelFilter&&this.pixelFilter(a);this.pixelData=a;this._rasterReadPromise&&this._rasterReadPromise.isCanceled()||(this._drawPixelData(),this._rasterReadPromise=null)},_clonePixelData:function(a){if(null===a||void 0===a)return a;var b={};a.extent&&(b.extent=e.clone(a.extent));a=a.pixelBlock;if(null===a||void 0===a)return b;b.pixelBlock=a.clone();return b},_setDefaultFilter:function(){},
_getPixelBlockFromCanvas:function(a,b,c){a=a.getImageData(0,0,b,c).data;for(var d=b*c,g=0,f=0,e=new Uint8Array(d),m=new Uint8Array(d),h=new Uint8Array(d),l=new Uint8Array(d),n=Infinity,k=Infinity,r=Infinity,t=-Infinity,p=-Infinity,u=-Infinity,q,w,v,g=0;g<d;g++)q=a[f++],w=a[f++],v=a[f++],n=n<q?n:q,t=t>q?t:q,k=k<w?k:w,p=p>w?p:w,r=r<v?r:v,u=u>v?u:v,e[g]=q,m[g]=w,h[g]=v,l[g]=a[f++]&1;return new C({width:b,height:c,pixels:[e,m,h],pixelType:"U8",mask:l,statistics:[{minValue:n,maxValue:t},{minValue:k,maxValue:p},
{minValue:r,maxValue:u}]})},_useBrowserDecoding:function(){return(void 0===this.pixelFilter||null===this.pixelFilter)&&("jpeg"===this.format.toLowerCase()||"jpg"===this.format.toLowerCase()||-1<this.format.toLowerCase().indexOf("png"))},getMultidimensionalInfo:function(){var a=this._url.path+"/multiDimensionalInfo",b=new p(m._dfdCanceller);if(this._multidimensionalInfo)return b.resolve(this._multidimensionalInfo),b;10.3<=this.version&&this.hasMultidimensions?(b._pendingDfd=u({url:a,content:{f:"json"},
handleAs:"json",callbackParamName:"callback"}),b._pendingDfd.then(e.hitch(this,function(a){this._multidimensionalInfo=a.multidimensionalInfo;b.callback(a.multidimensionalInfo)}),function(a){b.errback(a)})):(a=Error("Layer does not support multidimensional info"),a.log=!!l.isDebug,b.errback(a));return b},getDefaultMultidimensionalDefinition:function(){var a,b,c,d=[],g=new p(m._dfdCanceller),f;if(this._defaultMultidimensionalDefinition)return g.resolve(this._defaultMultidimensionalDefinition),g;g._pendingDfd=
this.getMultidimensionalInfo();g._pendingDfd.then(e.hitch(this,function(e){a=e;b=a.variables[0].dimensions;for(c in b)b.hasOwnProperty(c)&&"StdTime"!==b[c].name&&(f=b[c],d.push(new x({variableName:"",dimensionName:f.name,isSlice:!f.hasRanges,values:[this._getDefaultDimensionValue(f)]})));this._defaultMultidimensionalDefinition=d;g.callback(d)}),function(a){g.errback(a)});return g},_getDefaultDimensionValue:function(a){if(a&&a.values&&a.values.length){var b,c,d=Infinity,g,f;if(a.hasRanges)return a.values[0];
if(a.name&&"stdz"===a.name.toLowerCase()){for(f=0;f<a.values.length&&(g=a.values[f],c=Math.abs(g-0),c<d&&(d=c,b=g),0!==c);f++);return b}return a.extent[0]}},_setDefaultMultidimensionalDefinition:function(a){var b,c={};this.getDefaultMultidimensionalDefinition().then(e.hitch(this,function(d){b=d;0<b.length&&(this.mosaicRule?(c=e.clone(this.mosaicRule),c.multidimensionalDefinition=b):this.defaultMosaicRule?(c=e.clone(this.defaultMosaicRule),c.multidimensionalDefinition=b):c=new w({multidimensionalDefinition:b}),
this.setMosaicRule(c,a))}))},_setDefaultRenderingRule:function(a){var b={};if(!this.renderingRule&&"esri.layers.ArcGISImageServiceVectorLayer"!==this.declaredClass&&!this.bandIds&&this.rasterFunctionInfos&&this.rasterFunctionInfos.length&&"none"!==this.rasterFunctionInfos[0].name.toLowerCase())b.rasterFunction=this.rasterFunctionInfos[0].name;else if(!this.renderingRule&&"esri.layers.ArcGISImageServiceVectorLayer"===this.declaredClass&&10.3<this.version){var c="esriImageServiceDataTypeVector-UV"===
this.serviceDataType?7:10;b.rasterFunction="Resample";b.rasterFunctionArguments={ResamplingType:c,InputCellSize:{x:this.pixelSizeX,y:this.pixelSizeY}}}b.hasOwnProperty("rasterFunction")&&(this.defaultRenderingRule=new z(b),this.setRenderingRule(this.defaultRenderingRule,a))},_cleanupRequestParams:function(a){if(!a)return a;if(a.time&&a.mosaicRule){var b=new w(n.fromJson(a.mosaicRule)),b=this._filterOutTimeDimension(b);a.mosaicRule=n.toJson(b.toJson())}var b="displayOnPan drawMode styling id opacity visible resourceInfo useMapDimensionValue extent renderer".split(" "),
c;for(c in b)a.hasOwnProperty(b[c])&&delete a[b[c]];return a},_filterOutTimeDimension:function(a){if(a&&a.multidimensionalDefinition&&0<a.multidimensionalDefinition.length){var b=q.filter(a.multidimensionalDefinition,function(a){return"StdTime"!==a.dimensionName});a.multidimensionalDefinition=b}return a},_removeVisualizationStretchFunction:function(a){var b=a&&a.functionName;if(!b||"stretch"!==b.toLowerCase())return a;var c=a.functionArguments.Raster;return c&&c.functionName&&q.some(this.rasterFunctionInfos,
function(a){return c.functionName===a.name})?c:a},_isScientificData:function(){return"esriImageServiceDataTypeVector-UV"===this.serviceDataType||"esriImageServiceDataTypeVector-MagDir"===this.serviceDataType||"esriImageServiceDataTypeScientific"===this.serviceDataType},_isVectorData:function(){return"esriImageServiceDataTypeVector-UV"===this.serviceDataType||"esriImageServiceDataTypeVector-MagDir"===this.serviceDataType},_isRasterFunctionInfoAvailable:function(a){return q.some(a&&(this.rasterFunctionInfos||
[]),function(b){return b&&b.name&&b.name.toLowerCase()===a.toLowerCase()})},_createPixelData:function(a){a=new C({width:2,height:2,pixels:a,pixelType:this.pixelType,statistics:a});var b=this.fullExtent.getCenter(),b=new t(b.x,b.y,b.x+this.pixelSizeX,b.y+this.pixelSizeY,this.spatialReference);return{pixelBlock:a,extent:b}},_convertRendererToRenderingRule:function(a){var b=a&&a.declaredClass;if(!b||"esri.renderer.UniqueValueRenderer"!==b&&"esri.renderer.ClassBreaksRenderer"!==b&&"esri.renderer.StretchRenderer"!==
b)return null;var c=null;"esri.renderer.StretchRenderer"===b?c=a.toRenderingRule({convertToColormap:10.6>this.version}):"esri.renderer.ClassBreaksRenderer"===b?c=this._convertClassifyRenderer(a):"esri.renderer.UniqueValueRenderer"===b&&(c=this._convertUniqueValueRenderer(a));return c},_getValueField:function(a){if(a&&a.length){var b,c;q.some(a,function(a){if((c=a.name)&&"value"===c.toLowerCase())return b=c,!0});return b}},_convertClassifyRenderer:function(a){var b,c=[],d=[],g=[],f=[],e;b=this.renderingRule&&
this.renderingRule.functionName;var m,h,l=this.hasRasterAttributeTable,n,k;b&&(l=this._rasterFunctionTemplateInfos[b]?this._rasterFunctionTemplateInfos[b].hasRasterAttributeTable:this.hasRasterAttributeTable,h=this._renderingRuleAttributeTable[b],k=this._rasterFunctionTemplateInfos[b]);m=h&&h.features?h.features:this._rasterAttributeTableFeatures;n=this._getValueField(h&&h.fields?h.fields:this._rasterAttributeTableFields);l&&m?(q.forEach(a.infos,function(b,c){var d,g=b.symbol.color;g.a&&q.forEach(m,
function(e){d=e.attributes[a.attributeField];(d>=b.minValue&&d<b.maxValue||c===a.infos.length-1&&d>=b.minValue)&&f.push([e.attributes[n],g.r,g.g,g.b])},this)},this),b=k&&k.pixelType||this.pixelType,this._adjustColormapToPixelTypeRange(f,b),b=new z,b.functionName="Colormap",b.functionArguments={},b.functionArguments.Colormap=f,b.variableName="Raster"):(q.forEach(a.infos,function(a,b){e=a.symbol&&a.symbol.color;e.a?(c.push.call(c,a.minValue,a.maxValue),d.push(b),f.push([b,e.r,e.g,e.b])):g.push(a.minValue,
a.maxValue)}),b=new z,b.functionName="Remap",b.functionArguments={InputRanges:c,OutputValues:d,NoDataRanges:g},b.variableName="Raster",h=new z,h.functionName="Colormap",h.functionArguments={Colormap:f,Raster:b},b=h);return b},_convertUniqueValueRenderer:function(a){var b=[],c=this.renderingRule&&this.renderingRule.functionName,d,g,f,e;c&&(g=this._renderingRuleAttributeTable[c],e=this._rasterFunctionTemplateInfos[c]);d=g&&g.features?g.features:this._rasterAttributeTableFeatures;f=this._getValueField(g&&
g.fields?g.fields:this._rasterAttributeTableFields);q.forEach(a.infos,function(c){var g=c.symbol.color;g.a&&(a.attributeField!==f&&d?q.forEach(d,function(d){d.attributes[a.attributeField]==c.value&&b.push([d.attributes[f],g.r,g.g,g.b])},this):b.push([c.value,g.r,g.g,g.b]))},this);this._adjustColormapToPixelTypeRange(b,e&&e.pixelType||this.pixelType);c=new z;c.functionName="Colormap";c.functionArguments={};c.functionArguments.Colormap=b;c.variableName="Raster";return c},_adjustColormapToPixelTypeRange:function(a,
b){(b=this._pixelTypeRanges[b])&&a.push([Math.floor(b[0]-1),0,0,0],[Math.ceil(b[1]+1),0,0,0]);return a},_combineRenderingRule:function(a,b){if(!a||!b)return a||b;var c=function(a){var b=a.Raster;return b=b&&"esri.layers.RasterFunction"===b.declaredClass?c(b.functionArguments):a};a=e.clone(a);c(a.functionArguments).Raster=b;return a},_resolve:function(a,b,c,d,g){b&&this[b].apply(this,a);c&&c.apply(null,a);d&&m._resDfd(d,a,g)},_toggleTime:function(){var a=this._map;this.timeInfo&&this.useMapTime&&a&&
!this.suspended?(this._timeConnect||(this._timeConnect=h.connect(a,"onTimeExtentChange",this,this._onTimeExtentChangeHandler)),this._setTime(a.timeExtent)):(h.disconnect(this._timeConnect),this._timeConnect=null,this._setTime(null))},setUseMapTime:function(a,b){this.useMapTime=a;this._toggleTime();!b&&this._map&&this.refresh(!0)},_setTime:function(a){this._params&&(this._params.time=a?a.toJson().join(","):null)},_onTimeExtentChangeHandler:function(a){this.suspended||(this._setTime(a),this.refresh(!0))},
handleSpatialReferenceChange:function(){this.onSpatialReferenceChange()}})})},"esri/layers/MosaicRule":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../lang ../geometry/Point".split(" "),function(k,e,p,q,n,l){var h=k(null,{declaredClass:"esri.layers.MosaicRule",method:null,where:null,sortField:null,sortValue:null,ascending:!1,lockRasterIds:null,viewpoint:null,objectIds:null,operation:null,multidimensionalDefinition:[],constructor:function(f){e.isObject(f)&&(e.mixin(this,
f),f.mosaicMethod&&(this.method=f.mosaicMethod),this.method&&"esri"!==this.method.toLowerCase().substring(0,4)&&(this.method=this._getMethodEnum(this.method)),f.mosaicOperation&&(this.operation=f.mosaicOperation),this.operation&&"MT_"!==this.operation.toUpperCase().substring(0,3)&&(this.operation=this._getOperatorEnum(this.operation)),f.fids&&(this.objectIds=f.fids),f.viewpoint&&(this.viewpoint=new l(f.viewpoint)),this.multidimensionalDefinition=f.multidimensionalDefinition||[])},toJson:function(){var f=
null,d=this.multidimensionalDefinition?this.multidimensionalDefinition.length:0;if(d)for(var f=[],c=0;c<d;c++)f.push("esri.layers.DimensionalDefinition"===this.multidimensionalDefinition[c].declaredClass?this.multidimensionalDefinition[c].toJson():this.multidimensionalDefinition[c]);f={mosaicMethod:this.method,where:this.where,sortField:this.sortField,sortValue:this.sortValue,ascending:this.ascending,lockRasterIds:this.lockRasterIds,viewpoint:this.viewpoint?this.viewpoint.toJson():null,fids:this.objectIds,
mosaicOperation:this.operation,multidimensionalDefinition:f};return n.filter(f,function(a){if(null!==a)return!0})},_getMethodEnum:function(f){if(f){var d=h.METHOD_NONE;switch(f.toLowerCase()){case "byattribute":d=h.METHOD_ATTRIBUTE;break;case "center":d=h.METHOD_CENTER;break;case "lockraster":d=h.METHOD_LOCKRASTER;break;case "nadir":d=h.METHOD_NADIR;break;case "northwest":d=h.METHOD_NORTHWEST;break;case "seamline":d=h.METHOD_SEAMLINE;break;case "viewpoint":d=h.METHOD_VIEWPOINT}return d}},_getOperatorEnum:function(f){if(f)switch(f.toLowerCase()){case "first":return h.OPERATION_FIRST;
case "last":return h.OPERATION_LAST;case "max":return h.OPERATION_MAX;case "min":return h.OPERATION_MIN;case "blend":return h.OPERATION_BLEND;case "mean":return h.OPERATION_MEAN;case "sum":return h.OPERATION_SUM}}});e.mixin(h,{METHOD_NONE:"esriMosaicNone",METHOD_CENTER:"esriMosaicCenter",METHOD_NADIR:"esriMosaicNadir",METHOD_VIEWPOINT:"esriMosaicViewpoint",METHOD_ATTRIBUTE:"esriMosaicAttribute",METHOD_LOCKRASTER:"esriMosaicLockRaster",METHOD_NORTHWEST:"esriMosaicNorthwest",METHOD_SEAMLINE:"esriMosaicSeamline",
OPERATION_FIRST:"MT_FIRST",OPERATION_LAST:"MT_LAST",OPERATION_MIN:"MT_MIN",OPERATION_MAX:"MT_MAX",OPERATION_MEAN:"MT_MEAN",OPERATION_BLEND:"MT_BLEND",OPERATION_SUM:"MT_SUM"});return h})},"esri/layers/DimensionalDefinition":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel","../lang"],function(k,e,p,q,n){return k(null,{declaredClass:"esri.layers.DimensionalDefinition",variableName:null,dimensionName:null,values:[],isSlice:!1,constructor:function(l){e.isObject(l)&&e.mixin(this,
l)},toJson:function(){return n.filter({variableName:this.variableName,dimensionName:this.dimensionName,values:this.values,isSlice:this.isSlice},function(e){return null!==e})}})})},"esri/layers/Raster":function(){define("require dojo/_base/declare dojo/_base/lang dojo/_base/Deferred dojo/_base/array dojo/_base/config dojo/json dojo/sniff ../kernel ../Evented ../request ../geometry/Extent ../SpatialReference ../deferredUtils ./PixelBlock ./rasterFormats/LercCodec ./rasterFormats/Lerc2Codec".split(" "),
function(k,e,p,q,n,l,h,f,d,c,a,b,g,u,m,r,t){var v,y,w,z,x,A,C=null,B=null,E=function(a){if("U1"===a||"U2"===a||"U4"===a||"U8"===a)return B=Math.pow(2,8)-1,C=Uint8Array,"U8";"U16"===a?(B=B||Math.pow(2,16)-1,C=Uint16Array):"U32"===a?(B=B||Math.pow(2,32)-1,C=Uint32Array):"S8"===a?(B=B||0-Math.pow(2,7),C=Int8Array):"S16"===a?(B=B||0-Math.pow(2,15),C=Int16Array):"S32"===a?(B=B||0-Math.pow(2,31),C=Int32Array):C=Float32Array;return a},D=function(a,b){return a.height!==b.height||a.width!==b.width?!1:!0};
return e(c,{declaredClass:"esri.layers.Raster",imageServiceUrl:null,validPixelTypes:"U1 U2 U4 U8 U16 U32 S8 S16 S32 F32".split(" "),validFormats:"lerc jpeg jpg jpgpng png png8 png24 png32 bip bsq tiff".split(" "),_eventMap:{"raster-read-complete":["pixelData","params"]},constructor:function(a){this.imageServiceUrl=a;this.registerConnectEvents();this._loadRasterFormatModules()},read:function(b,c,d){var g=this,e=new q(u._dfdCanceller);if(10>f("ie"))throw"This browser is not supported.";if(!b.imageServiceParameters)throw"Insufficient parameters to read data";
var m=p.clone(b.imageServiceParameters),h=b.pixelType;n.some(this.validPixelTypes,function(a){return a===h})||(m.pixelType="F32");n.some(this.validFormats,function(a){return a.toLowerCase()===m.format.toLowerCase()})||(m.format="lerc");var l=b.decodeFunc,k;this._prepareGetImageParameters(m);var r=m.width,t=m.height,w=m.extent;delete m.width;delete m.height;delete m.extent;e._pendingDfd=a({url:this.imageServiceUrl+"/exportImage",handleAs:"arraybuffer",content:p.mixin(m,{f:"image"}),load:function(a){g.decode(a,
{width:r,height:t,planes:null,pixelType:h,noDataValue:m.noData,format:m.format,decodeFunc:l}).then(function(a){k={pixelBlock:a,extent:w};g._resolve([k,m],"onRasterReadComplete",c,e)},function(a){g._resolve([a],null,d,e,!0)})},error:function(a){g._resolve([a],null,d,e,!0)}});return e.promise},decode:function(a,b){if(void 0===b||null===b)throw"missing decode options";var c,d;b.format&&(c=b.format.toUpperCase());"BSQ"!==c&&"BIP"!==c&&(c=this._getFormat(a));d=b.decodeFunc;if(void 0===d||null===d)d=this._getFormatDecoderDfd(c);
return d(a,b)},onRasterReadComplete:function(){},_prepareGetImageParameters:function(a){if(a.size&&a.bbox){var c=a.size.split(",");a.width=parseFloat(c[0]);a.height=parseFloat(c[1]);a.extent||(c=a.bbox.split(","),a.extent=new b(parseFloat(c[0]),parseFloat(c[1]),parseFloat(c[2]),parseFloat(c[3]),new g(a.bboxSR)))}else{if(!a.width||Math.floor(a.width)!==a.width||!a.height||Math.floor(a.height)!==a.height)throw"Incorrect Image Dimensions";if(!a.extent||"esri.geometry.Extent"!==a.extent.declaredClass)throw"Incorrect extent";
var c=a.extent,d=c.spatialReference.wkid||h.toJson(c.spatialReference.toJson());delete a._ts;p.mixin(a,{bbox:c.xmin+","+c.ymin+","+c.xmax+","+c.ymax,imageSR:d,bboxSR:d,size:a.width+","+a.height},a.disableClientCaching?{_ts:(new Date).getTime()}:{})}},_adjustExtent:function(a,b,c){var d=a.ymax-a.ymin,g=a.xmax-a.xmin;c>=b?a.ymax=a.ymin+g*b/c:a.xmax=a.xmin+d*c/b;return a},_resolve:function(a,b,c,d,g){b&&this[b].apply(this,a);c&&c.apply(null,a);d&&u._resDfd(d,a,g)},_getFormatDecoderDfd:function(a){var b=
null;switch(a){case "LERC":b=this._decodeLerc;break;case "LERC2":b=this._decodeLerc2;break;case "JPEG":b=this._decodeJpeg;break;case "PNG":b=this._decodePng;break;case "BSQ":b=this._decodeBsq;break;case "BIP":b=this._decodeBip;break;case "TIFF":b=this._decodeTiff;break;default:b=function(a,b){throw"The raster format is not supported";}}b=p.hitch(this,b);return function(c,d){var g=new q;try{var f;"LERC"===a||!0===x?(f=b(c,d),g.resolve(f)):A.then(function(){f=b(c,d);g.resolve(f)})}catch(K){g.reject(K)}return g}},
_getFormat:function(a){a=new Uint8Array(a,0,10);var b="";if(255===a[0]&&216===a[1])b="JPEG";else if(137===a[0]&&80===a[1]&&78===a[2]&&71===a[3])b="PNG";else if(67===a[0]&&110===a[1]&&116===a[2]&&90===a[3]&&73===a[4]&&109===a[5]&&97===a[6]&&103===a[7]&&101===a[8]&&32===a[9])b="LERC";else if(76===a[0]&&101===a[1]&&114===a[2]&&99===a[3]&&50===a[4]&&32===a[5])b="LERC2";else if(-1<String.fromCharCode.apply(null,a).toLowerCase().indexOf("error"))b="ERROR";else if(73===a[0]&&73===a[1]&&42===a[2]&&0===a[3]||
77===a[0]&&77===a[1]&&0===a[2]&&42===a[3])b="TIFF";return b},_validateDecodeParams:function(a){if(!a.height||Math.floor(a.height)!==a.height)throw"Height not provided.";if(!a.width||Math.floor(a.width)!==a.width)throw"Width not provided.";},_decodeJpeg:function(a,b){if(!v)throw"The jpeg decoder module is not loaded.";this._validateDecodeParams(b);a=(new v).decode(a);if(!D(a,b))throw"The decoded image dimensions are incorrect.";b=[];var c,d;for(c=0;c<a.pixels.length;c++)d=a.pixels[c],b.push(this._calculateBandStatistics(d));
return new m({width:a.width,height:a.height,pixels:a.pixels,pixelType:"U8",mask:a.mask,statistics:b})},_decodePng:function(a,b){if(!y)throw"The png decoder module is not loaded.";this._validateDecodeParams(b);a=new Uint8Array(a);var c=new y(a);a=new Uint8Array(b.width*b.height*4);c.copyToImageData(a,c.decodePixels());for(var d=c=0,g,d=new Uint8Array(b.width*b.height),c=0;c<b.width*b.height;c++)d[c]=a[4*c+3];for(var f=new m({width:b.width,height:b.height,pixels:[],pixelType:"U8",mask:d,statistics:[]}),
c=0;3>c;c++){g=new Uint8Array(b.width*b.height);for(d=0;d<b.width*b.height;d++)g[d]=a[4*d+c];f.addData({pixels:g,statistics:this._calculateBandStatistics(g)})}return f},_decodeBsq:function(a,b){if(!w)throw"The bsq decoder module is not loaded.";this._validateDecodeParams(b);B=b.noDataValue;b.pixelType=E(b.pixelType);a=w.decodeBSQ(a,{bandCount:b.planes,width:b.width,height:b.height,pixelType:C,noDataValue:B});var c=[],d,g=null;for(d=0;d<a.pixels.length;d++)g=a.pixels[d],c.push(this._calculateBandStatistics(g));
return new m({width:b.width,height:b.height,pixels:a.pixels,pixelType:b.pixelType,mask:a.maskData,statistics:c})},_decodeBip:function(a,b){this._validateDecodeParams(b);B=b.noDataValue;b.pixelType=E(b.pixelType);a=w.decodeBIP(a,{bandCount:b.planes,width:b.width,height:b.height,pixelType:C,noDataValue:B});var c=[],d,g=null;for(d=0;d<a.pixels.length;d++)g=a.pixels[d],c.push(this._calculateBandStatistics(g));return new m({width:b.width,height:b.height,pixels:a.pixels,pixelType:b.pixelType,mask:a.maskData,
statistics:c})},_decodeTiff:function(a,b){this._validateDecodeParams(b);B=b.noDataValue;b.pixelType=E(b.pixelType);a=z.decode(a);b=[];var c,d=null;for(c=0;c<a.pixels.length;c++)d=a.pixels[c],b.push(this._calculateBandStatistics(d,a.maskData));return new m({width:a.width,height:a.height,pixels:a.pixels,pixelType:a.pixelType,mask:a.maskData,statistics:b})},_decodeLerc:function(a,b){this._validateDecodeParams(b);B=b.noDataValue;b.pixelType=E(b.pixelType);for(var c=0,d,g=0,f,e=a.byteLength-10;g<e;){var h=
r.decode(a,{inputOffset:g,encodedMaskData:d,returnMask:0===c?!0:!1,returnEncodedMask:0===c?!0:!1,returnFileInfo:!0,pixelType:C,noDataValue:B}),g=h.fileInfo.eofOffset;0===c&&(d=h.encodedMaskData,f=new m({width:b.width,height:b.height,pixels:[],pixelType:b.pixelType,mask:h.maskData,statistics:[]}));c++;if(!D(h,b))throw"The decoded image dimensions are incorrect";f.addData({pixels:h.pixelData,statistics:{minValue:h.minValue,maxValue:h.maxValue,noDataValue:h.noDataValue}})}return f},_decodeLerc2:function(a,
b){this._validateDecodeParams(b);B=b.noDataValue;b.pixelType=E(b.pixelType);for(var c=0,d,g,f=0,e,h=a.byteLength-10;f<h;){g=t.decode(a,{inputOffset:f,maskData:d,returnFileInfo:!0});f=g.fileInfo.eofOffset;0===c&&(d=g.maskData,e=new m({width:b.width,height:b.height,pixels:[],pixelType:g.fileInfo.pixelType,mask:g.maskData,statistics:[]}));c++;if(!D(g,b))throw"The decoded image dimensions are incorrect";e.addData({pixels:g.pixelData,statistics:{minValue:g.minValue,maxValue:g.maxValue,noDataValue:g.noDataValue}})}return e},
_calculateBandStatistics:function(a,b){var c=Infinity,d=-Infinity,g=a.length,f,e=0;if(b)for(f=0;f<g;f++)b[f]&&(e=a[f],c=e<c?e:c,d=e>d?e:d);else for(f=0;f<g;f++)e=a[f],c=e<c?e:c,d=e>d?e:d;return{minValue:c,maxValue:d}},_loadRasterFormatModules:function(){x||(A||(A=new q),10>f("ie")?A.isRejected()||A.reject("unsupported browser version"):k(["./rasterFormats/JpgPlus","./rasterFormats/Png","./rasterFormats/Raw","./rasterFormats/TiffDecoder","./rasterFormats/Zlib"],function(a,b,c,d){v=a;y=b;w=c;z=d;x=
!0;A.isResolved()||A.resolve(!0)}))}})})},"esri/layers/PixelBlock":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel"],function(k,e,p,q){return k([],{declaredClass:"esri.layers.PixelBlock",planes:null,width:null,height:null,pixelType:null,pixels:[],statistics:[],constructor:function(e){if(e){if(!e.width||Math.floor(e.width)!==e.width)throw"PixelBlock: incorrect width";if(!e.height||Math.floor(e.height)!==e.height)throw"PixelBlock: incorrect height";if(!e.pixels||!e.statistics)throw"PixelBlock: pixel data or statistics not present";
this.width=e.width;this.height=e.height;this.pixels=e.pixels;this.pixelType=e.pixelType||null;this.statistics=e.statistics;this.mask=e.mask||null}},getPlaneCount:function(){return this.pixels.length!==this.statistics.length?console.error("Inconsistent pixel data and statistics"):this.statistics.length},addData:function(e){if(!e.pixels||!e.statistics)throw"Pixel data or statistics are not present";if(e.pixels.length!==this.width*this.height)throw"Inconsistent pixel data size";this.statistics.push(e.statistics);
this.pixels.push(e.pixels)},getAsRGBA:function(){var e=new ArrayBuffer(this.width*this.height*4);switch(this.pixelType){case "S8":case "S16":case "U16":case "S32":case "U32":case "F32":case "F64":this._fillFromNon8Bit(e);break;default:this._fillFrom8Bit(e)}return new Uint8ClampedArray(e)},getAsRGBAFloat:function(){var e=new Float32Array(this.width*this.height*4);this._fillFrom32Bit(e);return e},clone:function(){var n=new this.constructor;n.width=this.width;n.height=this.height;n.pixelType=this.pixelType;
this.mask&&(n.mask=new Uint8Array(this.mask));var l,h;if(this.pixels)for(n.pixels=[],h=this.pixels.length,l=0;l<h;l++)n.pixels[l]=new Float32Array(this.pixels[l]);if(this.statistics)for(n.statistics=[],h=this.statistics.length,l=0;l<h;l++)n.statistics[l]=e.clone(this.statistics[l]);return n},_fillFrom8Bit:function(e){var l=this.pixels,h=this.mask;if(!e||!l||!l.length)return console.error("Unable to convert to RGBA. The input pixel block is empty.");var f,d,c;f=d=c=l[0];3<=l.length&&(d=l[1],c=l[2]);
var l=new Uint32Array(e),a=this.width*this.height;if(f.length!==a)return console.error("Unable to convert to RGBA. The pixelblock is invalid.");if(h&&h.length===a)for(e=0;e<a;e++)h[e]&&(l[e]=-16777216|c[e]<<16|d[e]<<8|f[e]);else for(e=0;e<a;e++)l[e]=-16777216|c[e]<<16|d[e]<<8|f[e]},_fillFromNon8Bit:function(e){var l=this.pixels,h=this.mask,f=this.statistics;if(!e||!l||!l.length)return console.error("Unable to convert to RGBA. The input pixel block is empty.");var d=1,c=0;f&&0<f.length?(c=f[0].minValue,
d=255/(f[0].maxValue-f[0].minValue)):(d=255,"S8"===this.pixelType?(c=-128,d=127):"U16"===this.pixelType?d=65535:"S16"===this.pixelType?(c=-32768,d=32767):"U32"===this.pixelType?d=4294967295:"S32"===this.pixelType?(c=-2147483648,d=2147483647):"F32"===this.pixelType?(c=-3.4*1E39,d=3.4*1E39):"F64"===this.pixelType&&(c=-Number.MAX_VALUE,d=Number.MAX_VALUE),d=255/(d-c));e=new Uint32Array(e);var f=this.width*this.height,a,b,g;a=l[0];if(a.length!==f)return console.error("Unable to convert to RGBA. The pixelblock is invalid.");
if(3<=l.length)if(b=l[1],g=l[2],h&&h.length===f)for(l=0;l<f;l++)h[l]&&(e[l]=-16777216|(g[l]-c)*d<<16|(b[l]-c)*d<<8|(a[l]-c)*d);else for(l=0;l<f;l++)e[l]=-16777216|(g[l]-c)*d<<16|(b[l]-c)*d<<8|(a[l]-c)*d;else if(h&&h.length===f)for(l=0;l<f;l++)b=(a[l]-c)*d,h[l]&&(e[l]=-16777216|b<<16|b<<8|b);else for(l=0;l<f;l++)b=(a[l]-c)*d,e[l]=-16777216|b<<16|b<<8|b},_fillFrom32Bit:function(e){var l=this.pixels,h=this.mask;if(!e||!l||!l.length)return console.error("Unable to convert to RGBA. The input pixel block is empty.");
var f,d,c;f=d=c=l[0];3<=l.length&&(d=l[1],c=l[2]);var a=this.width*this.height;if(f.length!==a)return console.error("Unable to convert to RGBA. The pixelblock is invalid.");var b=0;if(h&&h.length===a)for(l=0;l<a;l++)e[b++]=f[l],e[b++]=d[l],e[b++]=c[l],e[b++]=h[l];else for(l=0;l<a;l++)e[b++]=f[l],e[b++]=d[l],e[b++]=c[l],e[b++]=255}})})},"esri/layers/rasterFormats/LercCodec":function(){define([],function(){var k={defaultNoDataValue:-3.4027999387901484E38,decode:function(p,q){var n;q=q||{};var l=q.inputOffset||
0,h=q.encodedMaskData||null===q.encodedMaskData,f={},d=new Uint8Array(p,l,10);f.fileIdentifierString=String.fromCharCode.apply(null,d);if("CntZImage"!=f.fileIdentifierString.trim())throw"Unexpected file identifier string: "+f.fileIdentifierString;l+=10;d=new DataView(p,l,24);f.fileVersion=d.getInt32(0,!0);f.imageType=d.getInt32(4,!0);f.height=d.getUint32(8,!0);f.width=d.getUint32(12,!0);f.maxZError=d.getFloat64(16,!0);l+=24;if(!h)if(d=new DataView(p,l,16),f.mask={},f.mask.numBlocksY=d.getUint32(0,
!0),f.mask.numBlocksX=d.getUint32(4,!0),f.mask.numBytes=d.getUint32(8,!0),f.mask.maxValue=d.getFloat32(12,!0),l+=16,0<f.mask.numBytes){var h=new Uint8Array(Math.ceil(f.width*f.height/8)),d=new DataView(p,l,f.mask.numBytes),c=d.getInt16(0,!0),a=2,b=0;do{if(0<c)for(;c--;)h[b++]=d.getUint8(a++);else for(var g=d.getUint8(a++),c=-c;c--;)h[b++]=g;c=d.getInt16(a,!0);a+=2}while(a<f.mask.numBytes);if(-32768!==c||b<h.length)throw"Unexpected end of mask RLE encoding";f.mask.bitset=h;l+=f.mask.numBytes}else 0===
(f.mask.numBytes|f.mask.numBlocksY|f.mask.maxValue)&&(h=new Uint8Array(Math.ceil(f.width*f.height/8)),f.mask.bitset=h);d=new DataView(p,l,16);f.pixels={};f.pixels.numBlocksY=d.getUint32(0,!0);f.pixels.numBlocksX=d.getUint32(4,!0);f.pixels.numBytes=d.getUint32(8,!0);f.pixels.maxValue=d.getFloat32(12,!0);l+=16;h=f.pixels.numBlocksX;d=f.pixels.numBlocksY;h+=0<f.width%h?1:0;c=d+(0<f.height%d?1:0);f.pixels.blocks=Array(h*c);for(b=a=0;b<c;b++)for(g=0;g<h;g++){var u=0,d=new DataView(p,l,Math.min(10,p.byteLength-
l)),m={};f.pixels.blocks[a++]=m;var r=d.getUint8(0);u++;m.encoding=r&63;if(3<m.encoding)throw"Invalid block encoding ("+m.encoding+")";if(2===m.encoding)l++;else{if(0!==r&&2!==r){r>>=6;m.offsetType=r;if(2===r)m.offset=d.getInt8(1),u++;else if(1===r)m.offset=d.getInt16(1,!0),u+=2;else if(0===r)m.offset=d.getFloat32(1,!0),u+=4;else throw"Invalid block offset type";if(1===m.encoding)if(r=d.getUint8(u),u++,m.bitsPerPixel=r&63,r>>=6,m.numValidPixelsType=r,2===r)m.numValidPixels=d.getUint8(u),u++;else if(1===
r)m.numValidPixels=d.getUint16(u,!0),u+=2;else if(0===r)m.numValidPixels=d.getUint32(u,!0),u+=4;else throw"Invalid valid pixel count type";}l+=u;if(3!=m.encoding)if(0===m.encoding){r=(f.pixels.numBytes-1)/4;if(r!==Math.floor(r))throw"uncompressed block has invalid length";d=new ArrayBuffer(4*r);u=new Uint8Array(d);u.set(new Uint8Array(p,l,4*r));d=new Float32Array(d);m.rawData=d;l+=4*r}else 1===m.encoding&&(r=Math.ceil(m.numValidPixels*m.bitsPerPixel/8),d=new ArrayBuffer(4*Math.ceil(r/4)),u=new Uint8Array(d),
u.set(new Uint8Array(p,l,r)),m.stuffedData=new Uint32Array(d),l+=r)}}f.eofOffset=l;p=null!=q.noDataValue?q.noDataValue:k.defaultNoDataValue;var h=q.encodedMaskData,r=q.returnMask,c=0,a=f.pixels.numBlocksX,b=f.pixels.numBlocksY,g=Math.floor(f.width/a),m=Math.floor(f.height/b),u=2*f.maxZError,l=Number.MAX_VALUE,t,h=h||(f.mask?f.mask.bitset:null),v,d=new (q.pixelType||Float32Array)(f.width*f.height);r&&h&&(v=new Uint8Array(f.width*f.height));for(var r=new Float32Array(g*m),y,w,z=0;z<=b;z++){var x=z!==
b?m:f.height%b;if(0!==x)for(var A=0;A<=a;A++){var C=A!==a?g:f.width%a;if(0!==C){var B=z*f.width*m+A*g,E=f.width-C,D=f.pixels.blocks[c],F,I;if(2>D.encoding){if(0===D.encoding)F=D.rawData;else{F=D.stuffedData;I=D.bitsPerPixel;t=D.numValidPixels;y=D.offset;w=u;var M=r,L=f.pixels.maxValue,J=(1<<I)-1,P=0,K=void 0,U=0,O=void 0,S=void 0,Y=Math.ceil((L-y)/w);F[F.length-1]<<=8*(4*F.length-Math.ceil(I*t/8));for(K=0;K<t;K++)0===U&&(S=F[P++],U=32),U>=I?(O=S>>>U-I&J,U-=I):(U=I-U,O=(S&J)<<U&J,S=F[P++],U=32-U,O+=
S>>>U),M[K]=O<Y?y+O*w:L;F=r}I=0}else n=2===D.encoding?0:D.offset;var N;if(h)for(w=0;w<x;w++){B&7&&(N=h[B>>3],N<<=B&7);for(y=0;y<C;y++)B&7||(N=h[B>>3]),N&128?(v&&(v[B]=1),t=2>D.encoding?F[I++]:n,l=l>t?t:l,d[B++]=t):(v&&(v[B]=0),d[B++]=p),N<<=1;B+=E}else if(2>D.encoding)for(w=0;w<x;w++){for(y=0;y<C;y++)t=F[I++],l=l>t?t:l,d[B++]=t;B+=E}else for(l=l>n?n:l,w=0;w<x;w++){for(y=0;y<C;y++)d[B++]=n;B+=E}if(1===D.encoding&&I!==D.numValidPixels)throw"Block and Mask do not match";c++}}}n=v;v={width:f.width,height:f.height,
pixelData:d,minValue:l,maxValue:f.pixels.maxValue,noDataValue:p};n&&(v.maskData=n);q.returnEncodedMask&&f.mask&&(v.encodedMaskData=f.mask.bitset?f.mask.bitset:null);if(q.returnFileInfo&&(v.fileInfo=e(f),q.computeUsedBitDepths)){q=v.fileInfo;n=f.pixels.numBlocksX*f.pixels.numBlocksY;N={};for(F=0;F<n;F++)I=f.pixels.blocks[F],0===I.encoding?N.float32=!0:1===I.encoding?N[I.bitsPerPixel]=!0:N[0]=!0;f=Object.keys(N);q.bitDepths=f}return v}},e=function(e){return{fileIdentifierString:e.fileIdentifierString,
fileVersion:e.fileVersion,imageType:e.imageType,height:e.height,width:e.width,maxZError:e.maxZError,eofOffset:e.eofOffset,mask:e.mask?{numBlocksX:e.mask.numBlocksX,numBlocksY:e.mask.numBlocksY,numBytes:e.mask.numBytes,maxValue:e.mask.maxValue}:null,pixels:{numBlocksX:e.pixels.numBlocksX,numBlocksY:e.pixels.numBlocksY,numBytes:e.pixels.numBytes,maxValue:e.pixels.maxValue,noDataValue:this.noDataValue}}};return k})},"esri/layers/rasterFormats/Lerc2Codec":function(){define([],function(){var k={unstuff:function(e,
n,l,h,f,d,c,a){var b=(1<<l)-1,g=0,k,m=0,r,t;e[e.length-1]<<=8*(4*e.length-Math.ceil(l*h/8));if(f)for(k=0;k<h;k++)0===m&&(t=e[g++],m=32),m>=l?(r=t>>>m-l&b,m-=l):(m=l-m,r=(t&b)<<m&b,t=e[g++],m=32-m,r+=t>>>m),n[k]=f[r];else for(f=Math.ceil((a-d)/c),k=0;k<h;k++)0===m&&(t=e[g++],m=32),m>=l?(r=t>>>m-l&b,m-=l):(m=l-m,r=(t&b)<<m&b,t=e[g++],m=32-m,r+=t>>>m),n[k]=r<f?d+r*c:a},unstuffLUT:function(e,n,l,h,f,d){var c=(1<<n)-1,a=0,b=0,g=0,k=g=0,m,r=[];e[e.length-1]<<=8*(4*e.length-Math.ceil(n*l/8));for(var t=Math.ceil((d-
h)/f),b=0;b<l;b++)0===g&&(m=e[a++],g=32),g>=n?(k=m>>>g-n&c,g-=n):(g=n-g,k=(m&c)<<g&c,m=e[a++],g=32-g,k+=m>>>g),r[b]=k<t?h+k*f:d;r.unshift(h);return r},unstuff2:function(e,n,l,h,f,d,c,a){var b=(1<<l)-1,g=0,k,m=0,r=0,t,p,q;if(f)for(k=0;k<h;k++)0===m&&(p=e[g++],m=32,r=0),m>=l?(t=p>>>r&b,m-=l,r+=l):(q=l-m,t=p>>>r&b,p=e[g++],m=32-q,t|=(p&(1<<q)-1)<<l-q,r=q),n[k]=f[t];else for(f=Math.ceil((a-d)/c),k=0;k<h;k++)0===m&&(p=e[g++],m=32,r=0),m>=l?(t=p>>>r&b,m-=l,r+=l):(q=l-m,t=p>>>r&b,p=e[g++],m=32-q,t|=(p&(1<<
q)-1)<<l-q,r=q),n[k]=t<f?d+t*c:a;return n},unstuffLUT2:function(e,n,l,h,f,d){for(var c=(1<<n)-1,a=0,b=0,g=0,k=0,m=0,r=0,t,p=[],q=Math.ceil((d-h)/f),b=0;b<l;b++)0===k&&(t=e[a++],k=32,r=0),k>=n?(m=t>>>r&c,k-=n,r+=n):(g=n-k,m=t>>>r&c,t=e[a++],k=32-g,m|=(t&(1<<g)-1)<<n-g,r=g),p[b]=m<q?h+m*f:d;p.unshift(h);return p},originalUnstuff:function(e,n,l,h){var f=(1<<l)-1,d=0,c,a=0,b,g;e[e.length-1]<<=8*(4*e.length-Math.ceil(l*h/8));for(c=0;c<h;c++)0===a&&(g=e[d++],a=32),a>=l?(b=g>>>a-l&f,a-=l):(a=l-a,b=(g&f)<<
a&f,g=e[d++],a=32-a,b+=g>>>a),n[c]=b;return n},originalUnstuff2:function(e,n,l,h){var f=(1<<l)-1,d=0,c,a=0,b=0,g,k,m;for(c=0;c<h;c++)0===a&&(k=e[d++],a=32,b=0),a>=l?(g=k>>>b&f,a-=l,b+=l):(m=l-a,g=k>>>b&f,k=e[d++],a=32-m,g|=(k&(1<<m)-1)<<l-m,b=m),n[c]=g;return n}},e={HUFFMAN_LUT_BITS_MAX:12,computeChecksumFletcher32:function(e){for(var n=65535,l=65535,h=e.length,f=Math.floor(h/2),d=0;f;){var c=359<=f?359:f,f=f-c;do n+=e[d++]<<8,l+=n+=e[d++];while(--c);n=(n&65535)+(n>>>16);l=(l&65535)+(l>>>16)}h&1&&
(l+=n+=e[d]<<8);return((l&65535)+(l>>>16)<<16|(n&65535)+(n>>>16))>>>0},readHeaderInfo:function(e,n){var l=n.ptr,h=new Uint8Array(e,l,6),f={};f.fileIdentifierString=String.fromCharCode.apply(null,h);if(0!==f.fileIdentifierString.lastIndexOf("Lerc2",0))throw"Unexpected file identifier string (expect Lerc2 ): "+f.fileIdentifierString;l+=6;h=new DataView(e,l,52);f.fileVersion=h.getInt32(0,!0);l+=4;3<=f.fileVersion&&(f.checksum=h.getUint32(4,!0),l+=4);h=new DataView(e,l,48);f.height=h.getUint32(0,!0);
f.width=h.getUint32(4,!0);f.numValidPixel=h.getUint32(8,!0);f.microBlockSize=h.getInt32(12,!0);f.blobSize=h.getInt32(16,!0);f.imageType=h.getInt32(20,!0);f.maxZError=h.getFloat64(24,!0);f.zMin=h.getFloat64(32,!0);f.zMax=h.getFloat64(40,!0);l+=48;n.headerInfo=f;n.ptr=l;if(3<=f.fileVersion&&(e=this.computeChecksumFletcher32(new Uint8Array(e,l-48,f.blobSize-14)),e!==f.checksum))throw"Checksum failed.";return!0},readMask:function(e,n){var l=n.ptr,h=n.headerInfo,f=h.width*h.height,d=h.numValidPixel,c=
new DataView(e,l,4),h={};h.numBytes=c.getUint32(0,!0);l+=4;if((0===d||f===d)&&0!==h.numBytes)throw"invalid mask";if(0===d)d=new Uint8Array(Math.ceil(f/8)),h.bitset=d,c=new Uint8Array(f),n.pixels.resultMask=c,l+=h.numBytes;else if(0<h.numBytes){d=new Uint8Array(Math.ceil(f/8));c=new DataView(e,l,h.numBytes);e=c.getInt16(0,!0);var a=2,b=0,g=0;do{if(0<e)for(;e--;)d[b++]=c.getUint8(a++);else for(g=c.getUint8(a++),e=-e;e--;)d[b++]=g;e=c.getInt16(a,!0);a+=2}while(a<h.numBytes);if(-32768!==e||b<d.length)throw"Unexpected end of mask RLE encoding";
c=new Uint8Array(f);for(a=a=e=0;a<f;a++)a&7?(e=d[a>>3],e<<=a&7):e=d[a>>3],e&128&&(c[a]=1);n.pixels.resultMask=c;h.bitset=d;l+=h.numBytes}n.ptr=l;n.mask=h;return!0},readDataOneSweep:function(k,n,l){var h=n.ptr,f=n.headerInfo,d=f.width*f.height,f=f.numValidPixel*e.getDateTypeSize(f.imageType);if(l===Uint8Array)k=new Uint8Array(k,h,f);else{var c=new ArrayBuffer(f);(new Uint8Array(c)).set(new Uint8Array(k,h,f));k=new l(c)}if(k.length===d)n.pixels.resultPixels=k;else for(n.pixels.resultPixels=new l(d),
c=c=l=0;c<d;c++)n.pixels.resultMask[c]&&(n.pixels.resultPixels[c]=k[l++]);n.ptr=h+f;return!0},readHuffman:function(k,n,l){var h=n.headerInfo,f=h.width*h.height,d=this.HUFFMAN_LUT_BITS_MAX,h=new DataView(k,n.ptr,16);n.ptr+=16;if(2>h.getInt32(0,!0))throw"unsupported Huffman version";var c=h.getInt32(4,!0),a=h.getInt32(8,!0),b=h.getInt32(12,!0);if(a>=b)return!1;var g=new Uint32Array(b-a);e.decodeBits(k,n,g);for(var u=[],m,r,h=a;h<b;h++)m=h-(h<c?0:c),u[m]={first:g[h-a],second:null};h=k.byteLength-n.ptr;
g=new ArrayBuffer(4*Math.ceil(h/4));(new Uint8Array(g)).set(new Uint8Array(k,n.ptr,h));k=new Uint32Array(g);var g=0,t,q=0;t=k[0];for(h=a;h<b;h++)m=h-(h<c?0:c),r=u[m].first,0<r&&(u[m].second=t<<g>>>32-r,32-g>=r?(g+=r,32===g&&(g=0,q++,t=k[q])):(g+=r-32,q++,t=k[q],u[m].second|=t>>>32-g));for(var y=0===n.headerInfo.imageType?128:0,w=n.headerInfo.height,z=n.headerInfo.width,x=0,A=0,C=new p,h=0;h<u.length;h++)void 0!==u[h]&&(x=Math.max(x,u[h].first));A=x>=d?d:x;30<=x&&console.log("WARning, large NUM LUT BITS IS "+
x);for(var d=[],B,h=a;h<b;h++)if(m=h-(h<c?0:c),r=u[m].first,0<r)if(t=[r,m],r<=A)for(m=u[m].second<<A-r,B=1<<A-r,a=0;a<B;a++)d[m|a]=t;else for(m=u[m].second,B=C,a=r-1;0<=a;a--)(r=m>>>a&1)?(B.right||(B.right=new p),B=B.right):(B.left||(B.left=new p),B=B.left),0!==a||B.val||(B.val=t[1]);var c=n.pixels.resultMask,E,u=b=0;0<g&&(q++,g=0);t=k[q];l=new l(f);if(n.headerInfo.numValidPixel===z*w)for(h=a=0;h<w;h++)for(m=0;m<z;m++,a++){f=0;u=E=t<<g>>>32-A;32-g<A&&(u=E|=k[q+1]>>>64-g-A);if(d[u])f=d[u][1],g+=d[u][0];
else for(u=E=t<<g>>>32-x,32-g<x&&(u=E|=k[q+1]>>>64-g-x),B=C,u=0;u<x;u++)if(B=(r=E>>>x-u-1&1)?B.right:B.left,!B.left&&!B.right){f=B.val;g=g+u+1;break}32<=g&&(g-=32,q++,t=k[q]);f-=y;f=0<m?f+b:0<h?f+l[a-z]:f+b;f&=255;b=l[a]=f}else for(h=a=0;h<w;h++)for(m=0;m<z;m++,a++)if(c[a]){f=0;u=E=t<<g>>>32-A;32-g<A&&(u=E|=k[q+1]>>>64-g-A);if(d[u])f=d[u][1],g+=d[u][0];else for(u=E=t<<g>>>32-x,32-g<x&&(u=E|=k[q+1]>>>64-g-x),B=C,u=0;u<x;u++)if(B=(r=E>>>x-u-1&1)?B.right:B.left,!B.left&&!B.right){f=B.val;g=g+u+1;break}32<=
g&&(g-=32,q++,t=k[q]);f-=y;f=0<m&&c[a-1]?f+b:0<h&&c[a-z]?f+l[a-z]:f+b;f&=255;b=l[a]=f}n.pixels.resultPixels=l;n.ptr=n.ptr+4*(q+1)+(0<g?4:0)},decodeBits:function(e,n,l,h){var f=n.headerInfo.fileVersion,d=0,c=new DataView(e,n.ptr,5),a=c.getUint8(0);d++;var b=a>>6,g=0===b?4:3-b,p=0<(a&32)?!0:!1,b=a&31,a=0;if(1===g)a=c.getUint8(d),d++;else if(2===g)a=c.getUint16(d,!0),d+=2;else if(4===g)a=c.getUint32(d,!0),d+=4;else throw"Invalid valid pixel count type";var g=2*n.headerInfo.maxZError,m,r,t;if(p){n.counter.lut++;
t=c.getUint8(d);d++;p=Math.ceil((t-1)*b/8);m=Math.ceil(p/4);m=new ArrayBuffer(4*m);r=new Uint8Array(m);n.ptr+=d;r.set(new Uint8Array(e,n.ptr,p));d=new Uint32Array(m);n.ptr+=p;for(c=0;t-1>>>c;)c++;p=Math.ceil(a*c/8);m=Math.ceil(p/4);m=new ArrayBuffer(4*m);r=new Uint8Array(m);r.set(new Uint8Array(e,n.ptr,p));e=new Uint32Array(m);n.ptr+=p;n=3<=f?k.unstuffLUT2(d,b,t-1,h,g,n.headerInfo.zMax):k.unstuffLUT(d,b,t-1,h,g,n.headerInfo.zMax);3<=f?k.unstuff2(e,l,c,a,n):k.unstuff(e,l,c,a,n)}else n.counter.bitstuffer++,
c=b,n.ptr+=d,0<c&&(p=Math.ceil(a*c/8),m=Math.ceil(p/4),m=new ArrayBuffer(4*m),r=new Uint8Array(m),r.set(new Uint8Array(e,n.ptr,p)),e=new Uint32Array(m),n.ptr+=p,3<=f?null==h?k.originalUnstuff2(e,l,c,a):k.unstuff2(e,l,c,a,!1,h,g,n.headerInfo.zMax):null==h?k.originalUnstuff(e,l,c,a):k.unstuff(e,l,c,a,!1,h,g,n.headerInfo.zMax))},readTiles:function(k,n,l){var h=n.headerInfo,f=h.width,d=h.height,c=h.microBlockSize,h=h.imageType,a=Math.ceil(f/c),b=Math.ceil(d/c);n.pixels.numBlocksY=b;n.pixels.numBlocksX=
a;for(var g=n.pixels.ptr=0,p=0,m=0,r=0,t=0,q=0,y=0,w=0,z=g=0,x=0,A=0,y=y=g=y=0,C,B=new l(c*c),d=d%c||c,E=f%c||c,m=0;m<b;m++)for(t=m!==b-1?c:d,r=0;r<a;r++){q=r!==a-1?c:E;x=m*f*c+r*c;A=f-q;y=k.byteLength-n.ptr;p=new DataView(k,n.ptr,Math.min(10,y));C={};y=0;w=p.getUint8(0);y++;g=w>>6&255;z=w>>2&15;if(z!==(r*c>>3&15))throw"integrity issue";w&=3;if(3<w)throw n.ptr+=y,"Invalid block encoding ("+w+")";if(2===w)n.counter.constant++,n.ptr+=y;else if(0===w){n.counter.uncompressed++;n.ptr+=y;y=t*q*e.getDateTypeSize(h);
g=k.byteLength-n.ptr;y=y<g?y:g;g=new ArrayBuffer(y);p=new Uint8Array(g);p.set(new Uint8Array(k,n.ptr,y));C=new l(g);y=0;if(n.pixels.resultMask)for(g=0;g<t;g++){for(p=0;p<q;p++)n.pixels.resultMask[x]&&(n.pixels.resultPixels[x]=C[y++]),x++;x+=A}else for(g=0;g<t;g++){for(p=0;p<q;p++)n.pixels.resultPixels[x++]=C[y++];x+=A}n.ptr+=y*e.getDateTypeSize(h)}else if(g=e.getDataTypeUsed(h,g),C=e.getOnePixel(C,y,g,p),y+=e.getDateTypeSize(g),3===w)if(n.ptr+=y,n.counter.constantoffset++,n.pixels.resultMask)for(g=
0;g<t;g++){for(p=0;p<q;p++)n.pixels.resultMask[x]&&(n.pixels.resultPixels[x]=C),x++;x+=A}else for(g=0;g<t;g++){for(p=0;p<q;p++)n.pixels.resultPixels[x++]=C;x+=A}else if(n.ptr+=y,e.decodeBits(k,n,B,C),y=0,n.pixels.resultMask)for(g=0;g<t;g++){for(p=0;p<q;p++)n.pixels.resultMask[x]&&(n.pixels.resultPixels[x]=B[y++]),x++;x+=A}else for(g=0;g<t;g++){for(p=0;p<q;p++)n.pixels.resultPixels[x++]=B[y++];x+=A}}},formatFileInfo:function(k){return{fileIdentifierString:k.headerInfo.fileIdentifierString,fileVersion:k.headerInfo.fileVersion,
imageType:k.headerInfo.imageType,height:k.headerInfo.height,width:k.headerInfo.width,numValidPixel:k.headerInfo.numValidPixel,microBlockSize:k.headerInfo.microBlockSize,blobSize:k.headerInfo.blobSize,maxZError:k.headerInfo.maxZError,pixelType:e.getPixelType(k.headerInfo.imageType),eofOffset:k.eofOffset,mask:k.mask?{numBytes:k.mask.numBytes}:null,pixels:{numBlocksX:k.pixels.numBlocksX,numBlocksY:k.pixels.numBlocksY,maxValue:k.headerInfo.zMax,minValue:k.headerInfo.zMin,noDataValue:k.noDataValue}}},
constructConstantSurface:function(e){var n=e.headerInfo.zMax,l=e.headerInfo.height*e.headerInfo.width,h=0;if(e.pixels.resultMask)for(h=0;h<l;h++)e.pixels.resultMask[h]&&(e.pixels.resultPixels[h]=n);else for(h=0;h<l;h++)e.pixels.resultPixels[h]=n},getDataTypeArray:function(e){switch(e){case 0:e=Int8Array;break;case 1:e=Uint8Array;break;case 2:e=Int16Array;break;case 3:e=Uint16Array;break;case 4:e=Int32Array;break;case 5:e=Uint32Array;break;case 6:e=Float32Array;break;case 7:e=Float64Array;break;default:e=
Float32Array}return e},getPixelType:function(e){switch(e){case 0:e="S8";break;case 1:e="U8";break;case 2:e="S16";break;case 3:e="U16";break;case 4:e="S32";break;case 5:e="U32";break;case 6:e="F32";break;case 7:e="F64";break;default:e="F32"}return e},isValidPixelValue:function(e,n){if(null===n||void 0===n)return!1;switch(e){case 0:e=-128<=n&&127>=n;break;case 1:e=0<=n&&255>=n;break;case 2:e=-32768<=n&&32767>=n;break;case 3:e=0<=n&&65536>=n;break;case 4:e=-2147483648<=n&&2147483647>=n;break;case 5:e=
0<=n&&4294967296>=n;break;case 6:e=-3.4027999387901484E38<=n&&3.4027999387901484E38>=n;break;case 7:e=4.9E-324<=n&&1.7976931348623157E308>=n;break;default:e=!1}return e},getDateTypeSize:function(e){var n=0;switch(e){case 0:case 1:n=1;break;case 2:case 3:n=2;break;case 4:case 5:case 6:n=4;break;case 7:n=8;break;default:n=e}return n},getDataTypeUsed:function(e,n){var l=e;switch(e){case 2:case 4:l=e-n;break;case 3:case 5:l=e-2*n;break;case 6:l=0===n?e:1===n?2:1;break;case 7:l=0===n?e:e-2*n+1;break;default:l=
e}return l},getOnePixel:function(e,n,l,h){e=0;switch(l){case 0:e=h.getInt8(n);break;case 1:e=h.getUint8(n);break;case 2:e=h.getInt16(n,!0);break;case 3:e=h.getUint16(n,!0);break;case 4:e=h.getInt32(n,!0);break;case 5:e=h.getUInt32(n,!0);break;case 6:e=h.getFloat32(n,!0);break;case 7:e=h.getFloat64(n,!0);break;default:throw"the decoder does not understand this pixel type";}return e}},p=function(e,n,l){this.val=e;this.left=n;this.right=l};return{decode:function(k,n){n=n||{};var l=n.maskData||null===
n.maskData,h=n.noDataValue,f=0,d={};d.ptr=n.inputOffset||0;d.pixels={};if(e.readHeaderInfo(k,d)){var f=d.headerInfo,c=e.getDataTypeArray(f.imageType);if(l)d.pixels.resultMask=n.maskData,d.ptr+=4;else if(!e.readMask(k,d))return;l=f.width*f.height;d.pixels.resultPixels=new c(l);d.counter={onesweep:0,uncompressed:0,lut:0,bitstuffer:0,constant:0,constantoffset:0};if(0!==f.numValidPixel)if(f.zMax===f.zMin)e.constructConstantSurface(d);else{var a=new DataView(k,d.ptr,2),b=a.getUint8(0,!0);d.ptr++;b?e.readDataOneSweep(k,
d,c):1<f.fileVersion&&1>=f.imageType&&1E-5>Math.abs(f.maxZError-.5)?(a=a.getUint8(1,!0),d.ptr++,a?e.readHuffman(k,d,c):e.readTiles(k,d,c)):e.readTiles(k,d,c)}d.eofOffset=d.ptr;n.inputOffset?(k=d.headerInfo.blobSize+n.inputOffset-d.ptr,1<=Math.abs(k)&&(d.eofOffset=n.inputOffset+d.headerInfo.blobSize)):(k=d.headerInfo.blobSize-d.ptr,1<=Math.abs(k)&&(d.eofOffset=d.headerInfo.blobSize));k={width:f.width,height:f.height,pixelData:d.pixels.resultPixels,minValue:f.zMin,maxValue:f.zMax,maskData:d.pixels.resultMask};
if(d.pixels.resultMask&&e.isValidPixelValue(f.imageType,h)){c=d.pixels.resultMask;for(f=0;f<l;f++)c[f]||(k.pixelData[f]=h);k.noDataValue=h}d.noDataValue=h;n.returnFileInfo&&(k.fileInfo=e.formatFileInfo(d));return k}},getBandCount:function(k){for(var n=0,l=0,h={ptr:0,pixels:{}};l<k.byteLength-58;)e.readHeaderInfo(k,h),l+=h.headerInfo.blobSize,n++,h.ptr=l;return n}}})},"esri/layers/pixelFilters/VectorFieldPixelFilter":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../../kernel ../../lang dojo/_base/array".split(" "),
function(k,e,p,q,n,l){return k(null,{declaredClass:"esri.layers.pixelFilters.VectorFieldPixelFilter",speedUnits:["esriMetersPerSecond","esriKilometersPerHour","esriKnots","esriFeetPerSecond","esriMilesPerHour"],constructor:function(h){e.mixin(this,h);this.isDataUV=h&&h.isDataUV?h.isDataUV:!1;this.computeMagnitudeAndDirection=e.hitch(this,this.computeMagnitudeAndDirection);this.unitConversionFactor=1;this._updateUnitConvFactor()},setUnits:function(e,f){this.inputUnit=e;this.outputUnit=f;this.unitConversionFactor=
1;this._updateUnitConvFactor()},_updateUnitConvFactor:function(){var e=l.indexOf(this.speedUnits,this.inputUnit),f=l.indexOf(this.speedUnits,this.outputUnit);if(this.inputUnit&&this.outputUnit&&0<=e&&0<=f){var d=[1,.277778,.514444,.3048,.44704,0];this.unitConversionFactor=d[e]/d[f]}},computeMagnitudeAndDirection:function(e){if(!n.isDefined(e))throw"Could not compute magnitude and direction. No pixel data is available.";var f=e.pixelBlock;if(!n.isDefined(f)||2!==f.getPlaneCount())throw"Could not compute magnitude and direction. Pixel data does not contain two bands.";
var d=e.extent,c=(d.xmax-d.xmin)/f.width,a=(d.ymax-d.ymin)/f.height,b=d.xmin+c/2,d=d.ymax-a/2;f.statistics[0].minValue=0;f.statistics[0].maxValue=0;var g=180/Math.PI,h=[],m=0,l=0,k=0,p=!n.isDefined(f.mask),q,w,z,x,A,C,B,E;A=B=Infinity;C=E=-Infinity;for(m=0;m<f.height;m++)for(l=0;l<f.width;l++,k++)if(h.push([b+c*l,d-a*m]),p||f.mask[k])z=q=f.pixels[0][k]*this.unitConversionFactor,x=w=f.pixels[1][k],this.isDataUV&&(z=Math.sqrt(q*q+w*w),x=90-g*Math.atan2(w,q),f.pixels[0][k]=z*this.unitConversionFactor,
f.pixels[1][k]=x),z>C&&(C=z),z<A&&(A=z),x>E&&(E=x),x<B&&(B=x);f.statistics[0].maxValue=C;f.statistics[0].minValue=A;f.statistics[1].maxValue=E;f.statistics[1].minValue=B;e.locations=h;return e}})})},"esri/layers/rasterFormats/ImageCanvasDecoder":function(){define(["require","dojo/_base/declare","dojo/Deferred","dojo/sniff"],function(k,e,p,q){var n;return e(null,{constructor:function(e){this.ctx=e.ctx;this._loadRasterFormatModule()},decode:function(e,h){if(!h.width||!h.height)throw"Native decoding requires the image format, width and height";
var f=new p,d,c=new Uint8Array(e);e=this._getFormat(e);if("error"===e)throw"invalid format";"jpeg"===e&&(d=this._getMask(c,h));var a="",b,g;for(b=0;b<c.length;b+=65535)g=c.subarray(b,b+65535>c.length-1?c.length-1:b+65535),a+=String.fromCharCode.apply(null,g);var c="data:image/"+e+";base64,"+window.btoa(a),l=new Image,m;l.src=c;var k=this;l.onload=function(){k.ctx.clearRect(0,0,h.width,h.height);k.ctx.drawImage(l,0,0);var a=k.ctx.getImageData(0,0,l.width,l.height);m=a.data;if(d)for(b=0;b<d.length;b++)m[4*
b+3]=d[b]?255:0;k.ctx.putImageData(a,0,0);f.resolve(null)};l.onerror=function(){f.reject("cannot load image")};return f},_getFormat:function(e){e=new Uint8Array(e,0,10);var h="error";255===e[0]&&216===e[1]?h="jpeg":137===e[0]&&80===e[1]&&78===e[2]&&71===e[3]&&(h="png");return h},_getMask:function(e,h){var f;try{if(!n)throw"The zlib decoder module is not loaded.";var d=0,c=0,a=Math.round(e.length/2);1===a%2&&(a+=1);for(var b=e.length-2,d=a;d<b&&(255!==e[d]||217!==e[d+1]);d++);a=d+=2;if(a<e.length-
1){var g=(new n(e.subarray(a))).getBytes();f=new Uint8Array(h.width*h.height);for(d=e=0;d<g.length;d++)for(c=7;0<=c;c--)f[e++]=g[d]>>c&1}}catch(u){}return f},_loadRasterFormatModule:function(){10>q("ie")||k(["./Zlib"],function(e){n=e})}})})},"esri/tasks/ImageServiceIdentifyTask":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../request ../geometry/normalizeUtils ./Task ./ImageServiceIdentifyResult".split(" "),function(k,e,p,q,n,l,h,f){k=k(h,{declaredClass:"esri.tasks.ImageServiceIdentifyTask",
constructor:function(d){this._url.path+="/identify";this._handler=e.hitch(this,this._handler)},__msigns:[{n:"execute",c:3,a:[{i:0,p:["geometry"]}],e:2}],_handler:function(d,c,a,b,g){try{var e=new f(d);this._successHandler([e],"onComplete",a,g)}catch(m){this._errorHandler(m,b,g)}},execute:function(d,c,a,b){var g=b.assembly;d=this._encode(e.mixin({},this._url.query,{f:"json"},d.toJson(g&&g[0])));var f=this._handler,m=this._errorHandler;return n({url:this._url.path,content:d,callbackParamName:"callback",
load:function(d,g){f(d,g,c,a,b.dfd)},error:function(c){m(c,a,b.dfd)}})},onComplete:function(){}});l._createWrappers(k);return k})},"esri/tasks/ImageServiceIdentifyResult":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../geometry/jsonUtils ./FeatureSet".split(" "),function(k,e,p,q,n,l){return k(null,{declaredClass:"esri.tasks.ImageServiceIdentifyResult",constructor:function(e){e.catalogItems&&(this.catalogItems=new l(e.catalogItems));e.location&&(this.location=n.fromJson(e.location));
this.catalogItemVisibilities=e.catalogItemVisibilities;this.name=e.name;this.objectId=e.objectId;this.value=e.value;this.processedValues=e.processedValues;this.properties=e.properties}})})},"esri/tasks/ImageServiceIdentifyParameters":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/json dojo/_base/array dojo/has ../kernel ../lang ../geometry/jsonUtils".split(" "),function(k,e,p,q,n,l,h,f){return k(null,{declaredClass:"esri.tasks.ImageServiceIdentifyParameters",geometry:null,mosaicRule:null,
renderingRule:null,renderingRules:null,pixelSizeX:null,pixelSizeY:null,pixelSize:null,returnGeometry:!1,returnCatalogItems:!0,timeExtent:null,toJson:function(d){var c=d&&d.geometry||this.geometry;d={geometry:c,returnGeometry:this.returnGeometry,returnCatalogItems:this.returnCatalogItems,mosaicRule:this.mosaicRule?p.toJson(this.mosaicRule.toJson()):null,renderingRule:this.renderingRule?p.toJson(this.renderingRule.toJson()):null};c&&(d.geometryType=f.getJsonType(c));c=this.timeExtent;d.time=c?c.toJson().join(","):
null;h.isDefined(this.pixelSizeX)&&h.isDefined(this.pixelSizeY)?d.pixelSize=p.toJson({x:parseFloat(this.pixelSizeX),y:parseFloat(this.pixelSizeY)}):this.pixelSize&&(d.pixelSize=this.pixelSize?p.toJson(this.pixelSize.toJson()):null);this.renderingRules&&(d.renderingRules=p.toJson(q.map(this.renderingRules,function(a){return a.toJson()})));return d}})})},"esri/layers/pixelFilters/StretchFilter":function(){define(["dojo/_base/declare","dojo/_base/lang","../PixelBlock"],function(k,e,p){var q;return k(null,
{stretchType:0,min:0,max:255,numberOfStandardDeviations:2,statistics:null,histograms:null,dra:!1,minPercent:.25,maxPercent:.5,useGamma:!1,gamma:null,raster:null,outputPixelType:"U8",computeGamma:!1,constructor:function(e){this.stretchType=e.stretchType||e.StretchType||this.stretchType;this.min=e.min||e.Min||this.min;this.max=e.max||e.Max||this.max;this.numberOfStandardDeviations=e.numberOfStandardDeviations||e.NumberOfStandardDeviations||this.numberOfStandardDeviations;this.statistics=e.statistics||
e.Statistics||this.statistics;this.dra=e.dra||e.DRA||e.dRA||this.dra;this.minPercent=e.minPercent||e.MinPercent||this.minPercent;this.maxPercent=e.maxPercent||e.MaxPercent||this.maxPercent;this.useGamma=e.useGamma||e.UseGamma||this.useGamma;this.gamma=e.gamma||e.Gamma||this.gamma;this.computeGamma=e.computeGamma||e.ComputeGamma||this.computeGamma;this.raster=e.raster||e.Raster||this.raster;this.outputPixelType=e.outputPixelType||e.OutputPixelType||this.outputPixelType;this.raster=e.raster||e.Raster||
this.raster;q=this},filter:function(e){if(null!==e&&null!==e.pixelBlock&&null!==e.pixelBlock.pixels){var l=e.pixelBlock,h=l.pixels,f=l.width*l.height,d=h.length,c;(c=6===q.stretchType||3===q.stretchType&&q.dra)&&q._calculateStatisticsHistograms(e);if(q.dra)if(c)q._statistics=l.statistics,q._histograms=l.histograms;else{var a=l.statistics;q._statistics=[];for(c=0;c<d;c++)q._statistics[c]=[a[c].minValue,a[c].maxValue,0,0]}else q._statistics=q.statistics,q._histograms=q.histograms;q.computeGamma&&(q.gamma=
q._computeGammaValues(l.pixelType),q.useGamma=!0);q._createLUT(e);if(void 0===q.LUT||null===q.LUT)return q._filterNoLUT(e);var a=q.LUT,b=q.LUTOffset,g,k;for(c=0;c<d;c++)for(k=a[c],l=0;l<f;l++)g=h[c][l],h[c][l]=k[g-b];e.pixelBlock.pixelType="U8";return e}},_calculateStatisticsHistograms:function(k){k=k.pixelBlock;var l=k.pixelType,h=k.pixels,f=k.mask,d=h.length,c,a,b,g,n=function(a){this.min=-.5;this.max=255.5;this.size=256;e.mixin(this,a);this.counts=this.counts||new Uint32Array(this.size)},m=[],
r,t,p,q,w,z;for(b=0;b<d;b++){r=new n;t=r.counts;q=h[b];if("U8"===l)if(f)for(g=0;g<k.width*k.height;g++)f[g]&&t[q[g]]++;else for(g=0;g<k.width*k.height;g++)t[q[g]]++;else{c=k.statistics[b].minValue;a=k.statistics[b].maxValue;r.min=c;r.max=a;a=(a-c)/256;p=new Uint32Array(257);if(f)for(g=0;g<k.width*k.height;g++)f[g]&&p[Math.floor((q[g]-c)/a)]++;else for(g=0;g<k.width*k.height;g++)p[Math.floor((q[g]-c)/a)]++;for(g=0;255>g;g++)t[g]=p[g];t[255]=p[255]+p[256]}m.push(r);q=[];c=k.statistics[b].minValue;a=
k.statistics[b].maxValue;for(g=z=w=p=0;g<r.size;g++)p+=t[g],w+=g*t[g];w/=p;for(g=0;g<r.size;g++)z+=t[g]*Math.pow(g-w,2);t=Math.sqrt(z/(p-1));g=(w+.5)*(r.max-r.min)/r.size+r.min;r=t*(r.max-r.min)/r.size;q.push(c);q.push(a);q.push(g);q.push(r);k.statistics[b]=q}k.histograms=m},_getCutOffPoints:function(e){e=e.pixelBlock.pixels.length;var l=[],h=[],f,d,c,a,b,g;switch(q.stretchType){case 5:for(b=0;b<e;b++)l[b]=q._statistics[b][0],h[b]=q._statistics[b][1];break;case 3:for(b=0;b<e;b++)l[b]=q._statistics[b][2]-
q.numberOfStandardDeviations*q._statistics[b][3],h[b]=q._statistics[b][2]+q.numberOfStandardDeviations*q._statistics[b][3],l[b]<q._statistics[b][0]&&(l[b]=q._statistics[b][0]),h[b]>q._statistics[b][1]&&(h[b]=q._statistics[b][1]);break;case 6:for(b=0;b<e;b++){f=q._histograms[b];a=new Uint32Array(f.size);c=f.counts;for(g=d=0;g<f.size;g++)d+=c[g],a[g]=d;c=q.minPercent*d/100;for(g=1;g<f.size;g++)if(a[g]>c){l[b]=f.min+(f.max-f.min)/f.size*(g-.5);break}c=(1-q.maxPercent/100)*d;for(g=f.size-2;0<=g;g--)if(a[g]<
c){h[b]=f.min+(f.max-f.min)/f.size*(g+.5);break}}break;default:for(b=0;b<e;b++)l[b]=0,h[b]=255}return{minCutOff:l,maxCutOff:h}},_createLUT:function(e){var l=e.pixelBlock,h=l.pixelType;if("U8"===h||"U16"===h||"S8"===h||"S16"===h){if(q._LUTSignature&&(h=q._computeLutSignature(),h.length===q._LUTSignature.length&&!h.some(function(a,b){return a!==q._LUTSignature[b]})))return;var h=l.pixels.length,f=[],d=[],c=[],a,b,g,k=q.max,m=q.min,n=q.gamma,t=k-m,p=q._getCutOffPoints(e);e=p.minCutOff;var p=p.maxCutOff,
y=0,w=256,z;"S8"===l.pixelType?y=-127:"S16"===l.pixelType&&(y=-32767);if("U16"===l.pixelType||"S16"===l.pixelType)w=65536;for(l=0;l<h;l++)f[l]=p[l]-e[l];if(q.useGamma&&null!==n&&n.length===h)for(l=0;l<h;l++)c[l]=1<n[l]?2<n[l]?6.5+Math.pow(n[l]-2,2.5):6.5+100*Math.pow(2-n[l],4):1;if(q.useGamma)for(var x,l=0;l<h;l++){z=[];for(a=0;a<w;a++)b=a+y,x=(b-e[l])/f[l],g=1,1<n[l]&&(g-=Math.pow(1/t,x*c[l])),b<p[l]&&b>e[l]?z[a]=Math.floor(g*t*Math.pow(x,1/n[l]))+m:b>p[l]?z[a]=k:b<e[l]&&(z[a]=m);d[l]=z}else for(l=
0;l<h;l++){z=[];for(a=0;a<w;a++)b=a+y,z[a]=b<e[l]?m:b>p[l]?k:Math.floor((b-e[l])/f[l]*t)+m;d[l]=z}q.LUT=d;q.LUTOffset=y;q._LUTSignature=q._computeLutSignature()}},_computeLutSignature:function(){var e=[],l,h;e.push(q.stretchType);e.push(q.min);e.push(q.max);e.push(q.numberOfStandardDeviations);if(q._statistics)for(l=0;l<q._statistics.length;l++)for(h=0;h<q._statistics[l].length;h++)e.push(q._statistics[l][h]);e.push(q.dra?1:0);e.push(q.minPercent);e.push(q.maxPercent);if(q.gamma)for(l=0;l<q._statistics.length;l++)e.push(q.gamma[l]);
e.push(q.useGamma?1:0);return e},_filterNoLUT:function(e){if(null!==e&&null!==e.pixelBlock&&null!==e.pixelBlock.pixels){var l=e.pixelBlock,h=l.pixels,f=l.mask,l=l.width*l.height,d=h.length,c=[],a=[],b,g,k,m,n,t=q.max,p=q.min,y=q.gamma,w=t-p;b=q._getCutOffPoints(e);var z=b.minCutOff,x=b.maxCutOff;for(b=0;b<d;b++)c[b]=x[b]-z[b];if(q.useGamma&&null!==y&&y.length===d)for(b=0;b<d;b++)a[b]=1<y[b]?2<y[b]?6.5+Math.pow(y[b]-2,2.5):6.5+100*Math.pow(2-y[b],4):1;if(q.useGamma)if(void 0!==f&&null!==f)for(g=0;g<
l;g++){if(f[g])for(b=0;b<d;b++)k=h[b][g],n=(k-z[b])/c[b],m=1,1<y[b]&&(m-=Math.pow(1/w,n*a[b])),k<x[b]&&k>z[b]?h[b][g]=Math.floor(m*w*Math.pow(n,1/y[b]))+p:k>x[b]?h[b][g]=t:k<z[b]&&(h[b][g]=p)}else for(g=0;g<l;g++)for(b=0;b<d;b++)k=h[b][g],n=(k-z[b])/c[b],m=1,1<y[b]&&(m-=Math.pow(1/w,n*a[b])),k<x[b]&&k>z[b]?h[b][g]=Math.floor(m*w*Math.pow(n,1/y[b]))+p:k>x[b]?h[b][g]=t:k<z[b]&&(h[b][g]=p);else if(void 0!==f&&null!==f)for(g=0;g<l;g++){if(f[g])for(b=0;b<d;b++)k=h[b][g],k<x[b]&&k>z[b]?h[b][g]=Math.floor((k-
z[b])/c[b]*w)+p:k>x[b]?h[b][g]=t:k<z[b]&&(h[b][g]=p)}else for(g=0;g<l;g++)for(b=0;b<d;b++)k=h[b][g],k<x[b]&&k>z[b]?h[b][g]=Math.floor((k-z[b])/c[b]*w)+p:k>x[b]?h[b][g]=t:k<z[b]&&(h[b][g]=p);e.pixelBlock.pixelType="U8";return e}},_computeGammaValues:function(e){var l=this._statistics.length,h,f=[],d;for(h=0;h<l;h++)d=this._statistics[h][2],"U8"!==e&&(d=255*(d-this._statistics[h][0])/(this._statistics[h][1]-this._statistics[h][0])),f.push(this._computeGammaValue(d));return f},_computeGammaValue:function(e){if(0!==
e&&!(255<e||0>e)){var l=0;0<e&&150!=e&&255>e&&(l=150>=e?45*Math.cos(.01047*e):17*Math.sin(.021*e));l=Math.log((e+l)/255);if(0!==l&&(e=Math.log(e/255)/l,!isNaN(e)))return Math.min(9.9,Math.max(.01,e))}}})})},"esri/layers/StreamLayer":function(){define("dojo/_base/declare dojo/_base/connect dojo/_base/array dojo/_base/Color dojo/_base/lang dojo/Deferred dojo/has dojo/io-query dojo/on dojo/aspect ../kernel ../request ../graphic ./FeatureLayer ./StreamMode ./StreamTrackManager ../geometry/jsonUtils ../symbols/SimpleFillSymbol ../symbols/SimpleLineSymbol ../symbols/SimpleMarkerSymbol ../renderers/SimpleRenderer ./PurgeOptions".split(" "),
function(k,e,p,q,n,l,h,f,d,c,a,b,g,u,m,r,t,v,y,w,z,x){return k([u],{declaredClass:"esri.layers.StreamLayer",_preventInit:!0,constructor:function(a,c){c=c||{};c.mode&&c.mode!==u.MODE_STREAM||(this._isStream=!0,this.currentMode=this.mode=u.MODE_STREAM,this._mode=new m(this));this.purgeOptions=new x(this,c.purgeOptions||{});this.purgeInterval=c.purgeInterval||0;this._reconnectAttempts=0;this.maxReconnectAttempts=10;this.socket=this._reconnectTimeoutId=null;this._keepLatestQueried=!1;this._keepLatestUrl=
null;this._relatedQueried=!1;this._joinField=this._relatedUrl=null;this._refreshing=!1;this._attemptReconnect=n.hitch(this,this._attemptReconnect);this._purge=n.hitch(this,this._purge);this._processServiceJson=n.hitch(this,this._processServiceJson);if(n.isObject(a)&&a.layerDefinition)this._initFeatureLayer(a,c);else{var d=this;b({url:a,content:n.mixin({f:"json"}),callbackParamName:"callback"}).then(function(a){d._processServiceJson(a,c)},function(a){d._errorHandler(a)})}},_processServiceJson:function(a,
c){var d=this;a.relatedFeatures&&a.relatedFeatures.featuresUrl&&a.relatedFeatures.joinField?(this._relatedUrl=a.relatedFeatures.featuresUrl,this.objectIdField=this._joinField=a.relatedFeatures.joinField,b({url:this._relatedUrl,content:{f:"json"},callbackParamName:"callback"}).then(function(b){b=b.fields||[];var g=p.map(a.fields,function(a){return a.name.toLowerCase()});p.forEach(b,function(b){-1===p.indexOf(g,b.name.toLowerCase())&&a.fields.push(b)});c.resourceInfo=a;d._initFeatureLayer(d._url,c)},
function(a){d.onError({error:a})})):(c.resourceInfo=a,this._initFeatureLayer(this._url,c))},_initLayer:function(a,b){this.inherited(arguments);if(a){var c;if(a.layerDefinition)this.purgeOptions=new x(this,this._params.purgeOptions||{}),this.socketUrl=this._params.socketUrl||a.layerDefinition.socketUrl||void 0;else{if(this._params.socketUrl)this.socketUrl=this._params.socketUrl;else{var d=this._getWebsocketConnectionInfo(a),g=d.urls;g&&g.length?(this._socketUrls=g,this.socketUrl=g[0],this.socketDirection=
"broadcast"===this._params.socketDirection?"broadcast":"subscribe",this.socketUrl+="/"+this.socketDirection,this._websocketToken=d.token,g.length>this.maxReconnectAttempts&&(this.maxReconnectAttempts=g.length)):(this.socketUrl=void 0,d="No web socket urls were retrieved from the Stream Service. Layer will not attempt to connect.","https:"===location.protocol&&(d+=" An insecure web socket connection cannot be made from a secure web page."),this.onError(Error(d)))}if(this._params.filter)try{this._filter=
c=this._makeFilter(this._params.filter)}catch(F){this.onError(Error("Error trying to create filter object: "+F+". Layer will not have filter applied")),this._filter=null}if(this._params.geometryDefinition||this._outFields||this._defnExpr){c=c||{};c.geometry=this._params.geometryDefinition;c.outFields=this._outFields;c.where=this._defnExpr;try{this._filter=c=this._makeFilter(c)}catch(F){this.onError(Error("Error trying to create filter object: "+F+". Layer will not have filter applied")),this._filter=
null}}}this.maximumTrackPoints=this._params.maximumTrackPoints||0===this._params.maximumTrackPoints?this._params.maximumTrackPoints:1;(this._params.refreshRate||0===this._params.refreshRate)&&this._mode&&this._mode._setRefreshRate&&this._mode._setRefreshRate(this._params.refreshRate);this._keepLatestUrl=a.keepLatestArchive?a.keepLatestArchive.featuresUrl:null;a.relatedFeatures&&a.relatedFeatures.featuresUrl&&a.relatedFeatures.joinField&&(this._relatedUrl=a.relatedFeatures.featuresUrl,this.objectIdField=
this._joinField=a.relatedFeatures.joinField);this.objectIdField||this._makeObjectIdField();this._map&&this.socketUrl&&!this._connected&&this.connect()}},_setMap:function(a){var b=this.inherited(arguments),c=this._getRenderer();this.timeInfo&&(this._trackIdField||c&&(c.latestObservationRenderer||c.trackRenderer))&&(this._trackManager=new r(this),this._trackManager.initialize(a));this.socketUrl&&!this._connected&&this._map&&this.connect();return b},_unsetMap:function(a,b){p.forEach(this._connects,e.disconnect);
(this._connected||this._reconnecting||this.socket)&&this.disconnect();this._togglePurgeT();this.inherited(arguments);this._map=null},_suspend:function(){this._togglePurgeT();this.inherited(arguments)},_resume:function(){this.inherited(arguments);this._togglePurgeT(!0)},clear:function(){try{this._mode&&this._mode._clearDrawBuffer&&this._mode._clearDrawBuffer(),this._mode&&this._mode._clearTimeBin&&this._mode._clearTimeBin(),this._mode&&this._mode._clearFeatureMap&&this._mode._clearFeatureMap(),this._trackManager&&
this._trackManager.clearTracks()}catch(A){}this.inherited(arguments)},redraw:function(){this._mode&&this._mode._flushDrawBuffer&&this._mode._flushDrawBuffer();this.inherited(arguments)},setDefinitionExpression:function(a){this.setFilter({where:a})},getDefinitionExpression:function(){var a;this._filter&&(a=this._filter.where);return a},destroy:function(){this.disconnect();this.inherited(arguments)},onResume:function(a){this.inherited(arguments)},setGeometryDefinition:function(a){this.setFilter({geometry:a})},
getGeometryDefinition:function(){var a;this._filter&&(a=this._filter.geometry);return a},connect:function(a){var b=new l,c={},d=this._filter,g,e,m=this.socketUrl,h;try{this._connected||this._connecting?b.reject(Error("Cannot start new connection process. Layer is connecting.")):(this._connecting=!0,this._getRelatedFeatures().then(function(){return this._getKeepLatestFeatures()}.bind(this)).then(function(){this._websocketToken&&(c.token=this._websocketToken);this._map&&this._map.spatialReference&&
this.spatialReference&&this._map.spatialReference.wkid!==this.spatialReference.wkid&&(c.outSR=this._map.spatialReference.wkid);if(d)for(e in d)null!==d[e]&&(g="geometry"===e?JSON.stringify(d[e]):d[e],c[e]=g);m+="?"+f.objectToQuery(c);h=this._createConnection(m,a);b.resolve(h)}.bind(this)).otherwise(function(a){b.reject(a)}))}catch(L){a&&(a(L,!1),b.reject(L)),this.onConnectionError({error:L})}return b.promise},disconnect:function(a){var b=this._refreshing?"Disconnecting as part of layer refresh cycle":
"Connection closed from client",c=this._refreshing?!0:!1;this._reconnectTimeoutId&&clearTimeout(this._reconnectTimeoutId);this._refreshing=this._reconnecting=this._connecting=this._connected=!1;this.socket&&this.socket.close();this.onDisconnect({willReconnect:c,message:b});a&&a(null,!0)},setFilter:function(a){var b,c;if(this._collection)return this.onError("Filter can only be set when the source of the layer is a Stream Service"),!1;try{if(void 0!==a.outFields)return c=Error("Outfields property cannot be changed after layer is created"),
this.onFilterChange({filter:this.getFilter(),error:c}),!1;b=this._makeFilter(a)}catch(E){return c=Error(E),this.onFilterChange({filter:this.getFilter(),error:c}),!1}if(this.socket)a={filter:b},this.socket.send(JSON.stringify(a));else d.once(this,"connect",function(a){this.setFilter(b)});return!0},getFilter:function(){var a=this._filter,b={},c=["geometry","outFields","where"];a&&p.forEach(c,function(c){var d=a[c];d&&("geometry"===c?d=t.fromJson(d):"outFields"===c&&(d=d.split(",")),b[c]=d)});return b},
setMaximumTrackPoints:function(a){if(!a&&0!==a)return!1;this.maximumTrackPoints=a;this._mode.propertyChangeHandler(3)},getUniqueValues:function(a){var b,c={},d=[];b=this._getField(a,!0);if(!b)return d;a=b.name;p.forEach(this.graphics||[],function(b){b=(b.attributes||{})[a];void 0===b||c[b]||(c[b]=1,d.push(b))});d.sort(function(a,b){return a<b?-1:a>b?1:0});return d},getLatestObservations:function(){var a=[];return a=this._trackManager?this._trackManager.getLatestObservations():this.graphics},setPurgeInterval:function(a){var b=
this.purgeInterval;this.purgeInterval=a;this._togglePurgeT();a&&this._togglePurgeT(!0);if(b!==a)this.onPurgeIntervalChange();return this},_togglePurgeT:function(a){if(a&&this.purgeInterval){var b=this;clearTimeout(this._purgeT);this._mode&&this._mode._flushDrawBuffer&&(this._purgeT=setTimeout(function(){b.updating||b.suspended||(b._mode._flushDrawBuffer(),b._togglePurgeT(!0))},6E4*this.purgeInterval))}else this._purgeT&&(clearTimeout(this._purgeT),this._refreshT=null)},onMessage:function(){},onConnect:function(){},
onDisconnect:function(){},onFilterChange:function(){},onAttemptReconnect:function(){},onConnectionError:function(){},onPurgeIntervalChange:function(){},_createConnection:function(a,b){var c=this,d=new WebSocket(a);d.onopen=function(){c.socket=d;c._connected=!0;c._connecting=!1;c._reconnecting=!1;c._reconnectAttempts=0;c._bind();c.onConnect();b&&b(null,!0)};d.onclose=function(a){var b,d=!0,g=c._connected,f=null;if(c._connected||c._reconnecting){if(a.code)if(b="Connection failed: ",1001===a.code)b+=
a.reason||"Service is going away.",d=!1;else if(4400===a.code)b+=a.reason||"Invalid url parameters. Check filter properties.",d=!1;else if(4404===a.code)b+="Service not found",d=!1;else if(4401===a.code||4403===a.code)b+="Not authorized",d=!1;d&&(c._reconnectAttempts+=1,c._reconnectAttempts>c.maxReconnectAttempts&&(b="Maximum reconnect attempts exceeded",d=!1,g=!0));c._connected=!1;g&&(b&&(f=Error(b)),c.onDisconnect({error:f,willReconnect:d}));d?c._attemptReconnect():c.socket=null}else c.socket||
(f=Error("Could not make connection to service"),c.onConnectionError({error:f})),c.socket=null,c._connected=!1};d.onerror=function(a){console.log("Socket error")};return d},_getKeepLatestFeatures:function(){var a=new l;this._map&&this._keepLatestUrl&&!this._keepLatestQueried&&this._mode._fetchArchive?(Date.now(),this._mode._fetchArchive(this._keepLatestUrl).then(function(){a.resolve()}.bind(this)).otherwise(function(b){a.reject(b)}).always(function(){this._keepLatestQueried=!0}.bind(this))):a.resolve();
return a.promise},_getRelatedFeatures:function(){var a=new l;this._map&&this._relatedUrl&&!this._relatedQueried&&this._mode._fetchArchive?(Date.now(),this._mode._fetchArchive(this._relatedUrl).then(function(){a.resolve()}.bind(this)).otherwise(function(b){a.reject(b)}).always(function(){this._relatedQueried=!0}.bind(this))):a.resolve();return a.promise},_purge:function(){var a,b=[],c;if(this.purgeOptions.displayCount&&this.graphics.length>this.purgeOptions.displayCount)for(a=0;a<this.graphics.length-
this.purgeOptions.displayCount;a++)c=this.graphics[a],b.push(c);0<b.length&&(this._mode._removeFeatures(b),this._trackManager&&this._trackManager.removeFeatures(b))},_bind:function(){var a=this;this.socket.onmessage=function(b){a._onMessage(JSON.parse(b.data))}},_onMessage:function(a){var b=this;this.onMessage(a);var c={create:function(a){b._create(a)},update:function(a){b._update(a)},"delete":function(a){b._delete(a)}};if(a.type)c[a.type](a.feature);else a.hasOwnProperty("filter")?b._handleFilterMessage(a):
this._create(a)},_create:function(a){function b(a){if(!c._featureHasOID(a,d)){if(!a.geometry)return!1;a.attributes=a.attributes||{};a.attributes[d]=c._nextId++}a=a.declaredClass?a:new g(a);c._mode.drawFeature(a)}var c=this,d=c.objectIdField;a.length?a.forEach(function(a){a&&b(a)}):a&&b(a)},_delete:function(a){var b=this,c=a[b.objectIdField]||a.attributes[b.objectIdField],d=!1;this.graphics.forEach(function(a){a.attributes[b.objectIdField]==c&&(d=a)});d&&this.remove(d)},_update:function(a){var b=this,
c=!1;this.graphics.forEach(function(d){d.attributes[b.objectIdField]==a.attributes[b.objectIdField]&&(c=d)});c&&(a.attributes&&c.setAttributes(a.attributes),a.geometry&&c.setGeometry(t.fromJson(a.geometry)))},_makeFilter:function(a){var b,c=null;a=a||{};if(void 0!==a.geometry)if(c=c||{},null===a.geometry)c.geometry=null;else{b="string"===typeof a.geometry?t.fromJson(JSON.parse(a.geometry)):a.geometry.declaredClass?a.geometry:t.fromJson(a.geometry);if(!b||"point"===b.type)throw"Query object contains invalid geometry";
"extent"!==b.type&&(b=b.getExtent());if(!b||0===b.getHeight()&&0===b.getWidth())throw"Invalid filter geometry: Extent cannot have a height and width of 0";c.spatialRel="esriSpatialRelIntersects";c.geometryType="esriGeometryEnvelope";c.geometry=b.toJson()}void 0!==a.where&&(c=c||{},c.where=a.where);if(void 0!==a.outFields&&(c=c||{},a="string"===typeof a.outFields?"*"===a.outFields?null:a.outFields.replace(/,\s+/g,",").split(","):null===a.outFields?null:a.outFields,a=this._makeOutFields(a))){if(a.errors&&
0<a.errors.length)throw"Invalid filter outFields. "+a.errors.join(",");c.outFields=a.fields?a.fields.join(","):null}return c},_makeOutFields:function(a){var b=this,c=[],d=[],g={fields:null};if(!a||0===a.length)return g;p.forEach(a,function(a){if("*"===a)return g;var f=b._getField(a,!0);f?c.push(f.name):d.push("Field named "+a+" not found in schema.")});a=b._getOutFields();p.forEach(a,function(a){b._getField(a)&&-1===p.indexOf(c,a)&&c.push(a)});g.fields=c;g.errors=d;return g},_handleFilterMessage:function(a){a.error?
(a=Error(a.error.join(",")),this.onFilterChange({filter:this.getFilter(),error:a})):(a=a.filter,a.geometry&&"string"===typeof a.geometry&&(a.geometry=JSON.parse(a.geometry)),this._filter=a,this.onFilterChange({filter:this.getFilter()}))},_getWebsocketConnectionInfo:function(a){var b={urls:[]},c,d=[],g=[],f,e,m;a.streamUrls&&p.forEach(a.streamUrls,function(a){"ws"===a.transport&&(c=a.urls,b.token=a.token)});if(!c)return b;p.forEach(c,function(a){0===a.lastIndexOf("wss",0)?g.push(a):d.push(a)});a="https:"===
location.protocol||0===this.url.lastIndexOf("https:",0)?g:0===d.length?g:d;if(1<a.length)for(f=0;f<a.length-1;f++)e=f+Math.floor(Math.random()*(a.length-f)),m=a[e],a[e]=a[f],a[f]=m;b.urls=a;return b},_attemptReconnect:function(){var a=this,b;this._reconnectTimeoutId=null;a._connected=!1;if(!a._socketUrls)return!1;if(!a._collection&&!a._reconnecting&&a.socket&&a.credential)return a._reconnecting=!0,a._getServiceConnectionMetadata(a._attemptReconnect),!1;a._reconnecting=!0;a.socket=null;if(a._reconnectAttempts>
a.maxReconnectAttempts)return a._reconnecting=!1;a.socketUrl=a._socketUrls[a._reconnectAttempts>a._socketUrls.length-1?a._reconnectAttempts%a._socketUrls.length:a._reconnectAttempts];a.socketUrl+="/"+a.socketDirection;b=a._randomIntFromInterval(0,1E3);this._reconnectTimeoutId=setTimeout(function(){a.onAttemptReconnect({count:a._reconnectAttempts,url:a.socketUrl});a.connect()},1E3*a._reconnectAttempts+b)},_getServiceConnectionMetadata:function(a){var c=this,d=c._url.path;a="function"===typeof a?a:
null;b({url:d,content:n.mixin({f:"json"},this._url.query),callbackParamName:"callback"}).then(function(b){b=c._getWebsocketConnectionInfo(b);c._websocketToken=b.token;a&&a()},function(a){c.onError(Error(a))})},_setDefaultRenderer:function(){var a=this.geometryType,b=new q([5,112,176,.8]),c=new q([255,255,255]),c=new y(y.STYLE_SOLID,c,1),d;if("esriGeometryPoint"===a||"esriGeometryMultipoint"===a)d=new w(w.STYLE_CIRCLE,10,c,b);else if("esriGeometryPolyline"===a)d=new y(y.STYLE_SOLID,b,2);else if("esriGeometryPolygon"===
a||"esriGeometryEnvelope"===a)b=new q([5,112,176,.2]),c=new q([5,112,176,.8]),c=new y(y.STYLE_SOLID,c,1),d=new v(v.STYLE_SOLID,c,b);d&&this.setRenderer(new z(d))},_makeObjectIdField:function(){var a=1,b,c,d=[];if(!this.objectIdField){b=this.fields.length;for(c=0;c<b;c++)d.push(this.fields[c].name.toLowerCase());for(;-1!==p.indexOf(d,"objectid_"+a);)a+=1;this.objectIdField="objectid_"+a;this.fields.push({name:"objectid_"+a,type:"esriFieldTypeOID",alias:"objectid_"+a,nullable:!1})}},_featureHasOID:function(a,
b){return a.attributes&&(a.attributes[b]||0===a.attributes[b])},_randomIntFromInterval:function(a,b){return Math.floor(Math.random()*(b-a+1)+a)}})})},"esri/layers/StreamTrackManager":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has ../kernel ../graphic ../geometry/Polyline ./TrackManager".split(" "),function(k,e,p,q,n,l,h,f){return k([f],{declaredClass:"esri.layers._StreamTrackManager",constructor:function(d){this.inherited(arguments)},initialize:function(d){this.inherited(arguments)},
addFeatures:function(d,c){function a(a,c){var d,g,f;b[a]||(b[a]=[]);a=b[a];0<e&&(c.length>e&&c.splice(0,c.length-e),g=c.length+a.length,g>e&&(d=a.splice(0,g-e)));g=c.length;for(f=0;f<g;f+=1)a.push(c[f]);return{deletes:d,adds:c}}var b,g,f,e,h={},l={},k;if(c)return this.inherited(arguments),h;b=this.trackMap;g=this.layer;f=g._trackIdField;e=g.maximumTrackPoints||0;p.forEach(d,function(a){var b=a.attributes[f];a.visible&&(l[b]||(l[b]=[]),l[b].push(a))});for(k in l)l.hasOwnProperty(k)&&(g=a(k,l[k]),h[k]=
g);return h},removeFeatures:function(d){var c=[],a=this.layer.objectIdField,b=this.layer._trackIdField;d&&(p.forEach(d,function(d){var g,f,e,h;f=d.attributes[b];g=d.attributes[a];if(e=this.trackMap[f])for(d=0;d<e.length;d+=1)if(h=e[d],h.attributes[a]===g){this.trackMap[f].splice(d,1);-1===p.indexOf(f)&&c.push(f);break}},this),0<d.length&&this.refreshTracks(c))},drawTracks:function(d){function c(c){var d=g[c],m=d&&1<d.length,k,n,r;(r=a.trackLineMap[c])&&!m&&(b.remove(r),delete a.trackLineMap[c],r=
null);if(!m)return!1;m=[];for(k=d.length-1;0<=k;--k)(n=d[k].geometry)&&m.push([n.x,n.y]);d={};d[e]=c;1<m.length&&(r?(c=r.geometry,c.removePath(0),c.addPath(m),r.setGeometry(c)):(r=new l(new h({paths:[m],spatialReference:f}),null,d),b.add(r),a.trackLineMap[c]=r))}var a=this,b=this.container,g,f,e,k;if(b)if(g=this.trackMap,f=this.map.spatialReference,e=this.layer._trackIdField,d)p.forEach(d,function(a){c(a)});else for(k in g)g.hasOwnProperty(k)&&c(k)},refreshTracks:function(d){function c(c){var d,g;
c=a[c]||[];d=c.length;for(g=0;g<d;g++)b._repaint(c[g],null,!0)}var a=this.trackMap,b=this.layer;b._getRenderer();var g;this.drawTracks(d);if(d)p.forEach(d,function(a){c(a)});else for(g in a)a.hasOwnProperty(g)&&c(g)},getLatestObservations:function(){var d,c,a=this.trackMap,b=[];for(d in a)a.hasOwnProperty(d)&&(c=a[d],b.push(c[c.length-1]));return b},destroy:function(){this.inherited(arguments);this.trackLineMap=null}})})},"esri/layers/PurgeOptions":function(){define(["dojo/_base/declare","dojo/_base/lang",
"dojo/Stateful","dojo/has","../kernel"],function(k,e,p,q,n){return k([p],{declaredClass:"esri.layers.PurgeOptions",constructor:function(e,h){this.parent=e;for(var f in h)this[f]=h[f]},_displayCountSetter:function(e){this.displayCount=e;this.parent.refresh()}})})},"esri/layers/ArcGISImageServiceLayer":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../config ./DynamicMapServiceLayer ./ImageServiceLayerMixin".split(" "),function(k,e,p,q,n,l,h){return k([l,h],{declaredClass:"esri.layers.ArcGISImageServiceLayer",
constructor:function(f,d){this._initialize(f,d);this.useMapImage=d&&d.useMapImage||!1},refresh:function(f){if(f)this.inherited(arguments);else{var d=this.disableClientCaching;this.disableClientCaching=!0;this.inherited(arguments);this.disableClientCaching=d}},setRenderer:function(f,d){this.renderer=f;this.onRendererChange();d||this.refresh(!0)},exportMapImage:function(f,d){var c=n.defaults.map;f=e.mixin({size:c.width+","+c.height},this._params,f?f.toJson(this.normalization):{},{f:"json"});delete f._ts;
this._exportMapImage(this._url.path+"/exportImage",f,d)}})})},"esri/layers/DynamicMapServiceLayer":function(){define("dojo/_base/declare dojo/_base/connect dojo/_base/lang dojo/dom-construct dojo/dom-style dojox/gfx/matrix ../kernel ../config ../sniff ../request ../domUtils ./layer ./MapImage".split(" "),function(k,e,p,q,n,l,h,f,d,c,a,b,g){var u=f.defaults.map.zoomDuration;return k(b,{declaredClass:"esri.layers.DynamicMapServiceLayer",_eventMap:{"map-image-export":["mapImage"]},constructor:function(a,
b){this.useMapTime=b&&b.hasOwnProperty("useMapTime")?!!b.useMapTime:!0;this.extentProcessor=b&&b.extentProcessor;a=p.hitch;this._exportMapImageHandler=a(this,this._exportMapImageHandler);this._imgSrcFunc=a(this,this._imgSrcFunc);this._divAlphaImageFunc=a(this,this._divAlphaImageFunc);this._tileLoadHandler=a(this,this._tileLoadHandler);this._tileErrorHandler=a(this,this._tileErrorHandler);this.registerConnectEvents()},opacity:1,isPNG32:!1,_setMap:function(a,b,c){this.inherited(arguments);this._map=
a;var g=this._div=q.create("div",null,b),f=h._css.names,m={position:"absolute",width:a.width+"px",height:a.height+"px",overflow:"visible",opacity:this.opacity},l=d("ie"),k=e.connect,r=a.__visibleDelta;8===l&&delete m.opacity;"css-transforms"===a.navigationMode?(this._isChildLayer||(m[f.transform]=h._css.translate(r.x,r.y),n.set(g,m)),this._left=r.x,this._top=r.y):(m.left="0px",m.top="0px",n.set(g,m),this._left=this._top=0);n.set(g,m);this._onResizeHandler_connect=k(a,"onResize",this,"_onResizeHandler");
this._opacityChangeHandler_connect=k(this,"onOpacityChange",this,"_opacityChangeHandler");this._img_loading=null;this._dragOrigin={x:0,y:0};this.evaluateSuspension();if(this.suspended&&!a.loaded)var t=e.connect(a,"onLoad",this,function(){e.disconnect(t);t=null;this.evaluateSuspension()});this.extentProcessor&&(this._panEndEvalHandle=e.connect(a,"onPanEnd",this,this.evaluateSuspension),this._zoomEndEvalHandle=e.connect(a,"onZoomEnd",this,this.evaluateSuspension));return g},_unsetMap:function(a,b){this._img&&
this._clearEventListeners(this._img);this._img_loading&&this._clearEventListeners(this._img_loading);q.destroy(this._div);this._map=this._div=this._img=this._img_loading=null;var c=e.disconnect;c(this._onResizeHandler_connect);c(this._opacityChangeHandler_connect);c(this._panEndEvalHandle);c(this._zoomEndEvalHandle);this._panEndEvalHandle=this._zoomEndEvalHandle=this._onResizeHandler_connect=this._opacityChangeHandler_connect=null;this._fireUpdateEnd();this._toggleTime();clearTimeout(this._wakeTimer);
this._wakeTimer=null;this._disableDrawConnectors();this.inherited(arguments)},_onResizeHandler:function(a,b,c){n.set(this._div,{width:b+"px",height:c+"px"});this._onExtentChangeHandler(a)},onSuspend:function(){this.inherited(arguments);this._fireUpdateEnd();this._toggleTime();a.hide(this._div);clearTimeout(this._wakeTimer);this._wakeTimer=null;this._disableDrawConnectors()},onResume:function(){this.inherited(arguments);var a=this._map;this._toggleTime();"css-transforms"===a.navigationMode&&(a=a.__visibleDelta,
this._left=a.x,this._top=a.y,this._isChildLayer||n.set(this._div,h._css.names.transform,h._css.translate(this._left,this._top)));this._enableDrawConnectors();this._wakeTimer=this._wakeTimer||setTimeout(p.hitch(this,function(){this.suspended||this._onExtentChangeHandler(this._map.extent,null,!0)}),0)},canResume:function(){var a=this.inherited(arguments);if(a){var b=this._map.extent;this.extentProcessor&&b&&(a=!!this.extentProcessor({layer:this,extent:b,width:this._map.width}).extent)}return a},_enableDrawConnectors:function(){var a=
e.connect,b=this._map;b&&(this._onPanHandler_connect=a(b,"onPan",this,"_onPanHandler"),this._onExtentChangeHandler_connect=a(b,"onExtentChange",this,"_onExtentChangeHandler"),"css-transforms"===b.navigationMode?this._onScaleHandler_connect=a(b,"onScale",this,this._onScaleHandler):this._onZoomHandler_connect=a(b,"onZoom",this,"_onZoomHandler"))},_disableDrawConnectors:function(){var a=e.disconnect;a(this._onPanHandler_connect);a(this._onExtentChangeHandler_connect);a(this._onZoomHandler_connect);a(this._onScaleHandler_connect);
this._onPanHandler_connect=this._onExtentChangeHandler_connect=this._onZoomHandler_connect=this._onScaleHandler_connect=null},_toggleTime:function(){var a=this._map;this.timeInfo&&this.useMapTime&&a&&!this.suspended?(this._timeConnect||(this._timeConnect=e.connect(a,"onTimeExtentChange",this,this._onTimeExtentChangeHandler)),this._setTime(a.timeExtent)):(e.disconnect(this._timeConnect),this._timeConnect=null,this._setTime(null))},_setTime:function(a){this._params&&(this._params.time=a?a.toJson().join(","):
null)},_onPanHandler:function(a,b){this._panDx=b.x;this._panDy=b.y;a=this._dragOrigin;var c=this._map.__visibleDelta,d=this._img;d&&("css-transforms"===this._map.navigationMode?(this._left=c.x+b.x,this._top=c.y+b.y,this._isChildLayer||n.set(this._div,h._css.names.transform,h._css.translate(this._left,this._top))):n.set(d,{left:a.x+b.x+"px",top:a.y+b.y+"px"}))},_onExtentChangeHandler:function(a,b,c){if(!this.suspended){clearTimeout(this._wakeTimer);this._wakeTimer=null;var g=this._map,f=this._img,
m=f&&f.style,k=this._dragOrigin;!b||c||!f||b.x===this._panDx&&b.y===this._panDy||("css-transforms"===g.navigationMode?(b=g.__visibleDelta,this._left=b.x,this._top=b.y,this._isChildLayer||n.set(this._div,h._css.names.transform,h._css.translate(this._left,this._top))):n.set(f,{left:k.x+b.x+"px",top:k.y+b.y+"px"}));f?(k.x=parseInt(m.left,10),k.y=parseInt(m.top,10)):k.x=k.y=0;"css-transforms"===g.navigationMode&&c&&f&&(n.set(f,h._css.names.transition,"none"),f._multiply=f._multiply?l.multiply(f._matrix,
f._multiply):f._matrix);this._fireUpdateStart();if(c=this._img_loading)if(this._clearEventListeners(c),q.destroy(c),this._img_loading=null,c=this._jsonRequest){try{c.cancel()}catch(F){}this._jsonRequest=null}var r=g.width;c=g.height;b=r;var t=0;10<=this.version&&g.wrapAround180&&(a=a._normalize(!0));this.extentProcessor&&(t=this.extentProcessor({layer:this,extent:a,width:b}),a=t.extent,b=t.width,t=t.marginLeft||0);if(this.isPNG32)f=this._img_loading=q.create("div"),f.id=g.id+"_"+this.id+"_"+(new Date).getTime(),
n.set(f,{position:"absolute",left:"0px",top:"0px",width:b+"px",height:c+"px"}),g=f.appendChild(q.create("div")),n.set(g,{opacity:0,width:b+"px",height:c+"px"}),this.getImageUrl(a,b,c,this._divAlphaImageFunc),f=null;else{var p=this._img_loading=q.create("img"),B=h._css.names,E=d("ie"),D={position:"absolute",width:b+"px",height:c+"px"};8===E&&(D.opacity=this.opacity);null!=t&&0!==t&&(D.marginLeft=t+"px");"css-transforms"===g.navigationMode?(D[B.transform]=h._css.translate(-this._left,-this._top),p._tdx=
-this._left,p._tdy=-this._top,D[B.transition]=B.transformName+" "+u+"ms ease",this.extentProcessor&&(D[B.origin]=r/2-t+"px "+c/2+"px")):(D.left="0px",D.top="0px");p.id=g.id+"_"+this.id+"_"+(new Date).getTime();n.set(p,D);p._onload_connect=e.connect(p,"onload",this,"_onLoadHandler");p._onerror_connect=e.connect(p,"onerror",this,"_onErrorHandler");p._onabort_connect=e.connect(p,"onabort",this,"_onErrorHandler");this._startRect={left:k.x,top:k.y,width:f?parseInt(m.width,10):b,height:f?parseInt(m.height,
10):c,marginLeft:f?parseInt(m.marginLeft||"0",10):t,zoom:m&&m.zoom?parseFloat(m.zoom):1};this.getImageUrl(a,b,c,this._imgSrcFunc);p=null}}},_onTimeExtentChangeHandler:function(a){this.suspended||(this._setTime(a),this.refresh(!0))},getImageUrl:function(a,b,c,d){},_imgSrcFunc:function(a){this._img_loading.src=a},_divAlphaImageFunc:function(a){n.set(this._img_loading,"filter","progid:DXImageTransform.Microsoft.AlphaImageLoader(src\x3d'"+a+"', sizingMethod\x3d'scale')");this._onLoadHandler({currentTarget:this._img_loading})},
_onLoadHandler:function(b){b=b.currentTarget;var c=this._map;this._clearEventListeners(b);!c||c.__panning||c.__zooming?q.destroy(b):(this._img&&this._div.removeChild(this._img),this._img=b,c=b.style,this._startRect={left:0,top:0,width:parseInt(c.width,10),height:parseInt(c.height,10),marginLeft:parseInt(c.marginLeft||"0",10),zoom:1},this._div.appendChild(b),this.suspended||a.show(this._div),this._img_loading=null,b=this._dragOrigin,b.x=b.y=0,this.onUpdate());this._fireUpdateEnd()},_onErrorHandler:function(a){a=
a.currentTarget;n.set(a,"visibility","hidden");this._clearEventListeners(a);a=Error("Unable to load image: "+a.src);this.onError(a);this._fireUpdateEnd(a)},_clearEventListeners:function(a){e.disconnect(a._onload_connect);e.disconnect(a._onerror_connect);e.disconnect(a._onabort_connect);a._onload_connect=a._onerror_connect=a._onabort_connect=null},setUseMapTime:function(a,b){this.useMapTime=a;this._toggleTime();b||this.refresh(!0)},refresh:function(){this._map&&this._onExtentChangeHandler(this._map.extent)},
_onScaleHandler:function(a,b){var c={},d=h._css.names,g=this._img;if(g){n.set(g,d.transition,b?"none":d.transformName+" "+u+"ms ease");g._matrix=a;a=g._multiply?l.multiply(a,g._multiply):a;if(g._tdx||g._tdy)a=l.multiply(a,{xx:1,xy:0,yx:0,yy:1,dx:g._tdx,dy:g._tdy});c[d.transform]=h._css.matrix(a);n.set(g,c)}},_onZoomHandler:function(a,b,c){a=this._startRect;var g=a.width*b,f=a.height*b,e=a.marginLeft*b,m=this._img,h=d("ie");m&&(h&&8>h?n.set(m,{left:a.left-(g-a.width)*(c.x-a.left)/a.width+"px",top:a.top-
(f-a.height)*(c.y-a.top)/a.height+"px",zoom:b*a.zoom}):n.set(m,{left:a.left-(g-a.width)*(c.x-a.left)/a.width+"px",top:a.top-(f-a.height)*(c.y-a.top)/a.height+"px",width:g+"px",height:f+"px"}),null!=e&&0!==e&&n.set(m,{marginLeft:e+"px"}))},_exportMapImage:function(a,b,d){var g=this._exportMapImageHandler;b.token=this._getToken();c({url:a,content:b,callbackParamName:"callback",load:function(a,b){g(a,b,d)},error:f.defaults.io.errorHandler})},_exportMapImageHandler:function(a,b,c){a=new g(a);this.onMapImageExport(a);
c&&c(a)},onMapImageExport:function(){},setOpacity:function(a){if(this.opacity!=a)this.onOpacityChange(this.opacity=a)},onOpacityChange:function(){},_opacityChangeHandler:function(a){var b=8===d("ie")?this._img:this._div;n.set(b,"opacity",a)}})})},"esri/layers/ArcGISImageServiceVectorLayer":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/connect dojo/_base/json dojo/sniff ../kernel ../lang ./GraphicsLayer ./ImageServiceLayerMixin ../renderers/VectorFieldRenderer ../geometry/Point ../geometry/Extent ../graphic dojox/gfx".split(" "),
function(k,e,p,q,n,l,h,f,d,c,a,b,g,u){return k([f,d],{declaredClass:"esri.layers.ArcGISImageServiceVectorLayer",constructor:function(a,b){this.symbolTileSize=b&&b.symbolTileSize?b.symbolTileSize:50;this._maxMag=this._minMag=null;var d=e.clone(this._params);delete d.imageServiceParameters;delete d.pixelFilter;delete d.rendererStyle;delete d.symbolTileSize;this._initialize(a,b);this.renderer||this.setVectorRendererStyle(b&&b.rendererStyle?b.rendererStyle:c.STYLE_SINGLE_ARROW);this.geometryType="esriGeometryPoint";
this.symbolTileSizeUnits="Pixels";e.mixin(this._params,d)},getField:function(a){return this._getField(a,!0)},setVectorRendererStyle:function(a){this.rendererStyle=a;this._updateVectorFieldRenderer();this.useDefaultRenderer=!0},setRenderer:function(){this.useDefaultRenderer=!1;this.inherited(arguments)},getFlowRepresentation:function(){return this._vectorFlowRepresentation},onResume:function(){this.inherited(arguments);this._toggleTime()},onSuspend:function(){this.inherited(arguments);this._toggleTime()},
_refresh:function(a){if(10>n("ie"))this.onError(Error("Unable to refresh. This layer is not supported in the current browser."));else if(this._map){this.setImageFormat("LERC",!0);a=this.fullExtent&&this.fullExtent.xmin;var b=this.fullExtent&&this.fullExtent.ymax,c=e.clone(this._map.extent),d=1/this.symbolTileSize*this._map.width,d=d?Math.ceil(d):50,g=1/this.symbolTileSize*this._map.height,g=g?Math.ceil(g):Math.ceil((c.ymax-c.ymin)/(c.xmax-c.xmin)*d),f=(c.xmax-c.xmin)/d,m=(c.ymax-c.ymin)/g;c.xmin=
a+Math.floor((c.xmin-a)/f)*f;c.xmax=a+Math.ceil((c.xmax-a)/f)*f;c.ymin=b+Math.floor((c.ymin-b)/m)*m;c.ymax=b+Math.ceil((c.ymax-b)/m)*m;this._requestData(c,d,g)}},_drawPixelData:function(){this.clear();if(this.pixelData){var c=this.pixelData.pixelBlock,d=this.pixelData.extent,f=this.pixelData.locations,e=h.isDefined(c.mask)&&0<c.mask.length;if(c&&d&&f){if(this.useDefaultRenderer&&this.renderer&&(!h.isDefined(this._minMag)||!h.isDefined(this._maxMag))){var l=this._getServiceMinMaxStats();l?(this._minMag=
l.min,this._maxMag=l.max):(this._minMag=c.statistics[0].minValue,this._maxMag=c.statistics[0].maxValue);var l={type:"sizeInfo",minSize:u.px2pt(.2*this.symbolTileSize),maxSize:u.px2pt(.8*this.symbolTileSize),minDataValue:this._minMag,maxDataValue:this._maxMag},k=[];k.push(l);k.push({type:"colorInfo"});this.renderer.setVisualVariables(k)}for(var n=k=l=0,p,A=d.spatialReference?d.spatialReference._getInfo():null,l=0;l<c.height;l++)for(k=0;k<c.width;k++,n++)if(p=f[n],(!e||c.mask[n])&&p&&2===p.length){p=
new a(p[0],p[1],d.spatialReference);A&&(p.x=b.prototype._normalizeX(p.x,A).x);var C={Magnitude:c.pixels[0][n],Direction:c.pixels[1][n],Location:q.toJson(p.toJson())};p=new g(p,null,C);this.add(p)}}}},_getServiceMinMaxStats:function(){if(!h.isDefined(this.minValues)||!h.isDefined(this.maxValues)||2>this.minValues.length||2>this.maxValues.length)return null;var a=this.minValues[0],b=this.maxValues[0],c=this.minValues[1],d=this.maxValues[1];if(this.pixelFilter&&a&&b&&c&&d){var g=[];g.push([a,b]);g.push([c,
d]);c=this._createPixelData(g);this.pixelFilter(c);c&&c.pixelBlock&&c.pixelBlock.pixels&&0<c.pixelBlock.pixels.length&&(a=c.pixelBlock.pixels[0][0],b=c.pixelBlock.pixels[0][1])}return a&&b?{min:a,max:b}:null},_updateVectorFieldRenderer:function(){var a={type:"sizeInfo",minSize:u.px2pt(.2*this.symbolTileSize),maxSize:u.px2pt(.8*this.symbolTileSize),minDataValue:this._minMag,maxDataValue:this._maxMag},b=[];b.push(a);a=new c({style:this.rendererStyle,visualVariables:b,flowRepresentation:this._vectorFlowRepresentation});
this.setRenderer(a)},_getField:function(a,b){if(h.isDefined(a))return b&&(a=a.toLowerCase()),"magnitude"!==a&&"direction"!==a?null:{name:a,alias:a,domain:null,editable:!1,length:50,type:"esriFieldTypeDouble"}},_requestDataErrorHandler:function(a){"CancelError"!==a.name&&(this.clear(),this.onError(a))},_setFlowRepresentation:function(a){a&&this.renderer&&h.isDefined(a.FlowDirection)&&(this._vectorFlowRepresentation="oceanographic"===a.FlowDirection.toLowerCase()?this.renderer.FLOW_TO:this.renderer.FLOW_FROM);
this.renderer&&(this.renderer.flowRepresentation=this._vectorFlowRepresentation)}})})},"jimu/LayerInfos/LayerInfoForDefaultTile":function(){define(["dojo/_base/declare","./LayerInfoForDefaultService"],function(k,e){return k(e,{constructor:function(e,k){this.isTiled=!0},getExtent:function(){},_initVisible:function(){},_setTopLayerVisible:function(e){},setLayerVisiblefromTopLayer:function(){},getOpacity:function(){},setOpacity:function(e){},isShowInMap:function(){return this.originOperLayer.mapService.layerInfo.layerObject.visible}})})},
"jimu/LayerInfos/LayerInfoForDefaultTable":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/Deferred dojo/aspect ./LayerInfoForDefault ./LayerObjectFacory esri/dijit/PopupTemplate".split(" "),function(k,e,p,q,n,l,h,f){return k(l,{_layerObjectFacory:null,constructor:function(){this.newSubLayers=[];this.isTable=!0;this._layerObjectFacory=new h(this)},init:function(){},_getLayerObject:function(){var d=new q;this._layerObjectFacory.getLayerObject().then(e.hitch(this,function(c){this.layerObject.empty&&
c&&(this.layerObject=c,this._bindEventAfterLayerObjectLoaded());d.resolve(c)}));return d},getLayerObject:function(){return this._getLayerObject()},getPopupInfoFromLayerObject:function(){var d=this.getPopupInfo();d||!this.layerObject||this.layerObject.empty||(d=this._getDefaultPopupInfo(this.layerObject));return d},loadPopupInfo:function(){var d=new q,c=this.getPopupInfo();c?d.resolve(c):this.getLayerObject().then(e.hitch(this,function(){c=this._getDefaultPopupInfo(this.layerObject);d.resolve(c)}));
return d},getLayerType:function(){var d=new q;d.resolve("Table");return d},isVisible:function(){return!1},isLeaf:function(){return!0},isRootLayer:function(){return!1},createLegendsNode:function(){return p.create("div",{"class":"legends-div"})},_initControlPopup:function(){this.inherited(arguments);this.controlPopupInfo={enablePopup:this.originOperLayer.popupInfo?!0:!1,infoTemplate:this.originOperLayer.popupInfo?new f(this.originOperLayer.popupInfo):null}},_bindEventAfterLayerObjectLoaded:function(){var d=
n.after(this.layerObject,"setDefinitionExpression",e.hitch(this,this._onFilterChanged));this._eventHandles.push(d)},getFilter:function(){var d;this.layerObject&&!this.layerObject.empty&&this.layerObject.getDefinitionExpression?(d=this.layerObject.getDefinitionExpression(),void 0===d&&(d=this.getFilterOfWebmap())):d=this.getFilterOfWebmap();return d}})})},"jimu/LayerInfos/LayerInfoForDefaultImage":function(){define("dojo/_base/declare dojo/dom-construct dojo/_base/array dojo/_base/lang dojo/Deferred dojo/promise/all dojo/aspect esri/request ./LayerInfoForDefault".split(" "),
function(k,e,p,q,n,l,h,f,d){return k(d,{constructor:function(){this._addImageServiceLayerType()},_addImageServiceLayerType:function(){this.layerObject.type=!this.layerObject.serviceDataType||"esriImageServiceDataTypeVector-UV"!==this.layerObject.serviceDataType&&"esriImageServiceDataTypeVector-MagDir"!==this.layerObject.serviceDataType?"ArcGISImageServiceLayer":"ArcGISImageServiceVectorLayer"},_initLegendsNode:function(c){10.2<=this.layerObject.version?this._legendRequestServer().then(q.hitch(this,
function(a){e.empty(c);p.forEach(a.layers,function(a){p.forEach(a.legend,function(a){if("\x3call other values\x3e"!==a.label){var b=e.create("div",{"class":"legend-div"},c),d=e.create("div",{"class":"legend-symbol jimu-float-leading",style:"width:50px;height:50px;position:relative"},b),g=null,g=a.imageData?"data:"+a.contentType+";base64,"+a.imageData:a.url;e.create("img",{"class":"legend-symbol-image",style:"overflow:auto;margin:auto;position:absolute;top:0;left:0;bottom:0;right:0",src:g},d);e.create("div",
{"class":"legend-label jimu-float-leading",innerHTML:a.label||" "},b)}},this)},this)}),q.hitch(this,function(){e.empty(c)})):e.empty(c)},_legendRequestServer:function(){var c=this.layerObject.url+"/legend",a={f:"json"};this.layerObject._params.bandIds&&(a.bandIds=this.layerObject._params.bandIds);this.layerObject._params.renderingRule&&(a.renderingRule=this.layerObject._params.renderingRule);return f({url:c,content:a,handleAs:"json",callbackParamName:"callback"})},getSupportTableInfo:function(){var c=
new n,a={isSupportedLayer:!1,isSupportQuery:!1,layerType:null},b=this.getLayerType(),d=this.getLayerObject();l({type:b,layerObject:d}).then(q.hitch(this,function(b){var d=b.type;b=b.layerObject;a.layerType=d;0<=this._getLayerTypesOfSupportTable().indexOf(d)&&(a.isSupportedLayer=!0);b.capabilities&&0<=b.capabilities.indexOf("Catalog")?a.isSupportQuery=!0:a.isSupportedLayer=!1;c.resolve(a)}),function(){c.resolve(a)});return c},_getServiceDefinition:function(){var c=this.getUrl();return this._serviceDefinitionBuffer.getRequest(this.subId).request(c)},
_bindEvent:function(){var c;this.inherited(arguments);this.layerObject&&!this.layerObject.empty&&(c=h.after(this.layerObject,"setRenderingRule",q.hitch(this,this._onRendererChanged)),this._eventHandles.push(c))}})})},"jimu/LayerInfos/LayerInfoForDefaultStream":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/Deferred","dojo/promise/all","./LayerInfoForDefault"],function(k,e,p,q,n){return k(n,{getSupportTableInfo:function(){var l=new p,h={isSupportedLayer:!1,isSupportQuery:!0,layerType:null,
otherReasonCanNotSupport:!0},f=this.getLayerType(),d=this.getLayerObject();q({type:f,layerObject:d}).then(e.hitch(this,function(c){var a=c.type;c=c.layerObject;h.layerType=a;0<=this._getLayerTypesOfSupportTable().indexOf(a)&&(h.isSupportedLayer=!0);(a=c.getLatestObservations())&&0<a.length&&(h.otherReasonCanNotSupport=!1);l.resolve(h)}),function(){l.resolve(h)});return l}})})},"jimu/LayerInfos/LayerInfoForDefaultKML":function(){define(["dojo/_base/declare","dojo/_base/array","dojo/dom-construct",
"./LayerInfoForDefault"],function(k,e,p,q){return k(q,{constructor:function(e,l){this.layerObject=e.layerObject},getExtent:function(){},_resetLayerObjectVisiblity:function(){},_initVisible:function(){var e=this.originOperLayer.kml,l=e.layerInfo.originOperLayer.visibleFolders;e.layerInfo.isRootLayer()&&l?-1<l.indexOf(this.subId)?this._visible=!0:this._visible=!1:this._visible=this.originOperLayer.kml.currentFolder.visible},_setTopLayerVisible:function(e){var l=this.originOperLayer.kml.currentFolder;
this._visible=e;this.originOperLayer.kml.layerInfo.layerObject.setFolderVisibility(l,e)},obtainNewSubLayers:function(){var k=[],l=this.originOperLayer.kml;l.currentFolder&&e.forEach(l.layerInfo._getOperLayerByParentFolderId(l.currentFolder.id,this),function(e){e=this._layerInfoFactory.create(e);k.push(e);e.init()},this);return k},getOpacity:function(){},setOpacity:function(e){},drawLegends:function(e){p.empty(e)},_bindEvent:function(){},_onVisibleLayersChanged:function(){},getScaleRange:function(){return this.getRootLayerInfo().getScaleRange()}})})},
"jimu/filterUtils":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/date/locale dojo/number esri/lang dojo/data/ItemFileWriteStore jimu/utils moment/moment".split(" "),function(k,e,p,q,n,l,h,f,d){var c=k([],{_stringFieldType:"esriFieldTypeString",_dateFieldType:"esriFieldTypeDate",_numberFieldTypes:["esriFieldTypeOID","esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble"],_supportFieldTypes:[],dayInMS:86399E3,fieldsStore:null,isHosted:!1,
constructor:function(){String.prototype.startsWith=function(a){return 0===this.indexOf(a)};String.prototype.endsWith=function(a){return this.substring(this.length-a.length)===a};String.prototype.count=function(a){return this.split(a).length-1};String.prototype.trim||(String.prototype.trim=e.trim);this._supportFieldTypes=[];this._supportFieldTypes.push(this._stringFieldType);this._supportFieldTypes.push(this._dateFieldType);this._supportFieldTypes=this._supportFieldTypes.concat(this._numberFieldTypes)},
OPERATORS:{stringOperatorIs:"stringOperatorIs",stringOperatorIsNot:"stringOperatorIsNot",stringOperatorStartsWith:"stringOperatorStartsWith",stringOperatorEndsWith:"stringOperatorEndsWith",stringOperatorContains:"stringOperatorContains",stringOperatorDoesNotContain:"stringOperatorDoesNotContain",stringOperatorIsBlank:"stringOperatorIsBlank",stringOperatorIsNotBlank:"stringOperatorIsNotBlank",numberOperatorIs:"numberOperatorIs",numberOperatorIsNot:"numberOperatorIsNot",numberOperatorIsAtLeast:"numberOperatorIsAtLeast",
numberOperatorIsLessThan:"numberOperatorIsLessThan",numberOperatorIsAtMost:"numberOperatorIsAtMost",numberOperatorIsGreaterThan:"numberOperatorIsGreaterThan",numberOperatorIsBetween:"numberOperatorIsBetween",numberOperatorIsNotBetween:"numberOperatorIsNotBetween",numberOperatorIsBlank:"numberOperatorIsBlank",numberOperatorIsNotBlank:"numberOperatorIsNotBlank",dateOperatorIsOn:"dateOperatorIsOn",dateOperatorIsNotOn:"dateOperatorIsNotOn",dateOperatorIsBefore:"dateOperatorIsBefore",dateOperatorIsAfter:"dateOperatorIsAfter",
dateOperatorIsOnOrBefore:"dateOperatorIsOnOrBefore",dateOperatorIsOnOrAfter:"dateOperatorIsOnOrAfter",dateOperatorIsBetween:"dateOperatorIsBetween",dateOperatorIsNotBetween:"dateOperatorIsNotBetween",dateOperatorIsBlank:"dateOperatorIsBlank",dateOperatorIsNotBlank:"dateOperatorIsNotBlank",dateOperatorInTheLast:"dateOperatorInTheLast",dateOperatorNotInTheLast:"dateOperatorNotInTheLast",dateOperatorIsIn:"dateOperatorIsIn",dateOperatorIsNotIn:"dateOperatorIsNotIn",dateOperatorMinutes:"dateOperatorMinutes",
dateOperatorHours:"dateOperatorHours",dateOperatorDays:"dateOperatorDays",dateOperatorWeeks:"dateOperatorWeeks",dateOperatorMonths:"dateOperatorMonths",dateOperatorYears:"dateOperatorYears"},prepare:function(a,b){this.isHosted=f.isHostedService(a);b=b||[];this.setFieldsStoreByFieldInfos(b)},isPartsObjHasError:function(a){var b=!1;a&&(b=a.parts&&0<=a.parts.length?p.every(a.parts,e.hitch(this,function(a){return a.parts?0<a.parts.length?p.every(a.parts,e.hitch(this,function(a){return!a.error})):!1:!a.error})):
!1);return!b},isAskForValues:function(a){return c.isAskForValues(a)},hasVirtualDate:function(a){return c.hasVirtualDate(a)},setFieldsStoreByFieldInfos:function(a){a=p.filter(a,e.hitch(this,function(a){return 0<=this._supportFieldTypes.indexOf(a.type)}));a=p.map(a,function(a,c){var b;switch(a.type){case "esriFieldTypeString":b="string";break;case "esriFieldTypeDate":b="date";break;default:b="number"}return{id:c,label:a.name,shortType:b,alias:a.alias,editable:a.editable,name:a.name,nullable:a.nullable,
type:a.type}},this);this.fieldsStore=new h({data:{identifier:"id",label:"label",items:a}});return a.length},_validatePartsObj:function(a){return a&&"object"===typeof a},_isObject:function(a){return a&&"object"===typeof a},_isString:function(a){return a&&"string"===typeof a},containsNonLatinCharacter:function(a){for(var b=0;b<a.length;b++)if(255<a.charCodeAt(b))return!0;return!1},getExprByFilterObj:function(a){if(!p.every(a.parts,function(a){return!!a}))return null;if(!this.isPartsObjReadyToBuild(a))return a.expr=
"",a.expr;this._handleVirtualDate(a);var b="";if(0===a.parts.length)b="1\x3d1";else if(1===a.parts.length)b=this.builtFilterString(a.parts[0]);else for(var c="",d=0;d<a.parts.length;d++){var f=this.builtFilterString(a.parts[d]);if(!l.isDefined(f))return null;b+=c+"("+f+")";c=c||" "+a.logicalOperator+" "}return a.expr=b},_handleVirtualDate:function(a){this.hasVirtualDate(a)&&p.forEach(a.parts,e.hitch(this,function(a){a.parts?p.forEach(a.parts,e.hitch(this,function(a){this._updateRealDateByVirtualDate(a)})):
this._updateRealDateByVirtualDate(a)}))},_updateRealDateByVirtualDate:function(a){var b;b=[this.OPERATORS.dateOperatorIsOn,this.OPERATORS.dateOperatorIsNotOn,this.OPERATORS.dateOperatorIsBefore,this.OPERATORS.dateOperatorIsAfter,this.OPERATORS.dateOperatorIsOnOrBefore,this.OPERATORS.dateOperatorIsOnOrAfter];a.valueObj.virtualDate?a.operator===this.OPERATORS.dateOperatorIsIn||a.operator===this.OPERATORS.dateOperatorIsNotIn?(b=c.getRealDateByVirtualDate(a.valueObj.virtualDate),a.value1=b[0],a.value2=
b[1],a.valueObj.value1=b[0].toDateString(),a.valueObj.value2=b[1].toDateString()):-1<b.indexOf(a.operator)&&(b=c.getRealDateByVirtualDate(a.valueObj.virtualDate),a.value=b,a.valueObj.value=b.toDateString()):(a.valueObj.virtualDate1&&(b=c.getRealDateByVirtualDate(a.valueObj.virtualDate1),a.value1=b,a.valueObj.value1=b.toDateString()),a.valueObj.virtualDate2&&(b=c.getRealDateByVirtualDate(a.valueObj.virtualDate2),a.value2=b,a.valueObj.value2=b.toDateString()))},isPartsObjReadyToBuild:function(a){return p.every(a.parts,
e.hitch(this,function(a){return a.parts?p.every(a.parts,e.hitch(this,function(a){return this._isPartReadyToBuild(a)})):this._isPartReadyToBuild(a)}))},_isPartReadyToBuild:function(a){var b=a.fieldObj.shortType,c=a.operator,d=a.valueObj;a=d.type||"value";var e=d.value,h=d.value1,d=d.value2;if("value"===a){if("string"===b)return c===this.OPERATORS.stringOperatorIsBlank||c===this.OPERATORS.stringOperatorIsNotBlank?!0:f.isNotEmptyString(e);if("number"===b)return c===this.OPERATORS.numberOperatorIsBlank||
c===this.OPERATORS.numberOperatorIsNotBlank?!0:c===this.OPERATORS.numberOperatorIsBetween||c===this.OPERATORS.numberOperatorIsNotBetween?f.isValidNumber(h)&&f.isValidNumber(d):f.isValidNumber(e);if("date"===b)return c===this.OPERATORS.dateOperatorIsBlank||c===this.OPERATORS.dateOperatorIsNotBlank?!0:c===this.OPERATORS.dateOperatorIsBetween||c===this.OPERATORS.dateOperatorIsNotBetween||c===this.OPERATORS.dateOperatorIsIn||c===this.OPERATORS.dateOperatorIsNotIn?f.isNotEmptyString(h)&&f.isNotEmptyString(d):
c===this.OPERATORS.dateOperatorInTheLast||c===this.OPERATORS.dateOperatorNotInTheLast?void 0!==e&&null!==e:f.isNotEmptyString(e)}else{if("field"===a)return f.isNotEmptyString(e);if("unique"===a){if("string"===b)return f.isNotEmptyString(e);if("number"===b)return f.isValidNumber(e)}}return!1},builtFilterString:function(a){var b="";if(a.parts)for(var c="",d=0;d<a.parts.length;d++){var f=a.parts[d],e=this.builtSingleFilterString(f);f.expr=e.whereClause;if(!l.isDefined(e.whereClause))return null;b+=c+
e.whereClause;c=" "+a.logicalOperator+" "}else b=this.builtSingleFilterString(a).whereClause;return a.expr=b},_preBuiltSingleFilterString:function(a){if("string"===a.fieldObj.shortType&&"\x3cNull\x3e"===a.valueObj.value){if(a.operator===this.OPERATORS.stringOperatorIs)return{whereClause:a.fieldObj.name+" IS NULL"};if(a.operator===this.OPERATORS.stringOperatorIsNot)return{whereClause:a.fieldObj.name+" IS NOT NULL"}}if("number"===a.fieldObj.shortType&&"\x3cNull\x3e"===a.valueObj.value){if(a.operator===
this.OPERATORS.numberOperatorIs)return{whereClause:a.fieldObj.name+" IS NULL"};if(a.operator===this.OPERATORS.numberOperatorIsNot)return{whereClause:a.fieldObj.name+" IS NOT NULL"}}return null},builtSingleFilterString:function(a,b){this.isHosted&&(a.caseSensitive=!1);if(l.isDefined(a.valueObj.isValid)&&!a.valueObj.isValid)return{whereClause:null};var c=this._preBuiltSingleFilterString(a);if(c)return c;var c=a.valueObj.value,d=a.valueObj.value1,f=a.valueObj.value2,e=!1;a.interactiveObj&&l.isDefined(b)&&
(e=!0,l.isDefined(a.valueObj.value)&&(c="{"+b+"}"),l.isDefined(a.valueObj.value1)&&(d="{"+b+"}"),l.isDefined(a.valueObj.value2)&&(f="{"+(b+1)+"}"));var h="";if("string"===a.fieldObj.shortType)switch(b="",e&&this.isHosted?b="N":c&&"field"!==a.valueObj.type&&this.isHosted&&this.containsNonLatinCharacter(c)&&(b="N"),a.operator){case this.OPERATORS.stringOperatorIs:h="field"===a.valueObj.type?a.fieldObj.name+" \x3d "+c:a.fieldObj.name+" \x3d "+b+"'"+c.replace(/\'/g,"''")+"'";break;case this.OPERATORS.stringOperatorIsNot:h=
"field"===a.valueObj.type?a.fieldObj.name+" \x3c\x3e "+c:a.fieldObj.name+" \x3c\x3e "+b+"'"+c.replace(/\'/g,"''")+"'";break;case this.OPERATORS.stringOperatorStartsWith:h=a.caseSensitive?a.fieldObj.name+" LIKE "+b+"'"+c.replace(/\'/g,"''")+"%'":"UPPER("+a.fieldObj.name+") LIKE UPPER("+b+"'"+c.replace(/\'/g,"''")+"%')";break;case this.OPERATORS.stringOperatorEndsWith:h=a.caseSensitive?a.fieldObj.name+" LIKE "+b+"'%"+c.replace(/\'/g,"''")+"'":"UPPER("+a.fieldObj.name+") LIKE UPPER("+b+"'%"+c.replace(/\'/g,
"''")+"')";break;case this.OPERATORS.stringOperatorContains:h=a.caseSensitive?a.fieldObj.name+" LIKE "+b+"'%"+c.replace(/\'/g,"''")+"%'":"UPPER("+a.fieldObj.name+") LIKE UPPER("+b+"'%"+c.replace(/\'/g,"''")+"%')";break;case this.OPERATORS.stringOperatorDoesNotContain:h=a.caseSensitive?a.fieldObj.name+" NOT LIKE "+b+"'%"+c.replace(/\'/g,"''")+"%'":"UPPER("+a.fieldObj.name+") NOT LIKE UPPER("+b+"'%"+c.replace(/\'/g,"''")+"%')";break;case this.OPERATORS.stringOperatorIsBlank:h=a.fieldObj.name+" IS NULL";
break;case this.OPERATORS.stringOperatorIsNotBlank:h=a.fieldObj.name+" IS NOT NULL"}else if("number"===a.fieldObj.shortType)switch(a.operator){case this.OPERATORS.numberOperatorIs:h=a.fieldObj.name+" \x3d "+c;break;case this.OPERATORS.numberOperatorIsNot:h=a.fieldObj.name+" \x3c\x3e "+c;break;case this.OPERATORS.numberOperatorIsAtLeast:h=a.fieldObj.name+" \x3e\x3d "+c;break;case this.OPERATORS.numberOperatorIsLessThan:h=a.fieldObj.name+" \x3c "+c;break;case this.OPERATORS.numberOperatorIsAtMost:h=
a.fieldObj.name+" \x3c\x3d "+c;break;case this.OPERATORS.numberOperatorIsGreaterThan:h=a.fieldObj.name+" \x3e "+c;break;case this.OPERATORS.numberOperatorIsBetween:h=a.fieldObj.name+" BETWEEN "+d+" AND "+f;break;case this.OPERATORS.numberOperatorIsNotBetween:h=a.fieldObj.name+" NOT BETWEEN "+d+" AND "+f;break;case this.OPERATORS.numberOperatorIsBlank:h=a.fieldObj.name+" IS NULL";break;case this.OPERATORS.numberOperatorIsNotBlank:h=a.fieldObj.name+" IS NOT NULL"}else switch(l.isDefined(c)&&"field"!==
a.valueObj.type&&"string"===typeof c&&(c=new Date(c)),"field"!==a.valueObj.type&&(c&&(c=new Date(c)),d&&(d=new Date(d)),f&&(f=new Date(f))),a.operator){case this.OPERATORS.dateOperatorIsOn:h="field"===a.valueObj.type?a.fieldObj.name+" \x3d "+c:e?a.fieldObj.name+" BETWEEN "+(this.isHosted?"":"timestamp ")+"'{"+b+"}' AND "+(this.isHosted?"":"timestamp ")+"'{"+(b+1)+"}'":a.fieldObj.name+" BETWEEN "+(this.isHosted?"":"timestamp ")+"'"+this.formatDate(c)+"' AND "+(this.isHosted?"":"timestamp ")+"'"+this.formatDate(this.addDay(c))+
"'";break;case this.OPERATORS.dateOperatorIsNotOn:h="field"===a.valueObj.type?a.fieldObj.name+" \x3c\x3e "+c:e?a.fieldObj.name+" NOT BETWEEN "+(this.isHosted?"":"timestamp ")+"'{"+b+"}' AND "+(this.isHosted?"":"timestamp ")+"'{"+(b+1)+"}'":a.fieldObj.name+" NOT BETWEEN "+(this.isHosted?"":"timestamp ")+"'"+this.formatDate(c)+"' AND "+(this.isHosted?"":"timestamp ")+"'"+this.formatDate(this.addDay(c))+"'";break;case this.OPERATORS.dateOperatorIsBefore:h="field"===a.valueObj.type?a.fieldObj.name+" \x3c "+
c:a.fieldObj.name+" \x3c "+(this.isHosted?"":"timestamp ")+"'"+this.formatDate(c)+"'";break;case this.OPERATORS.dateOperatorIsAfter:h="field"===a.valueObj.type?a.fieldObj.name+" \x3e "+c:a.fieldObj.name+" \x3e "+(this.isHosted?"":"timestamp ")+"'"+this.formatDate(this.addDay(c))+"'";break;case this.OPERATORS.dateOperatorIsOnOrBefore:h="field"===a.valueObj.type?a.fieldObj.name+" \x3c\x3d "+c:a.fieldObj.name+" \x3c\x3d "+(this.isHosted?"":"timestamp ")+"'"+this.formatDate(this.addDay(c))+"'";break;
case this.OPERATORS.dateOperatorIsOnOrAfter:h="field"===a.valueObj.type?a.fieldObj.name+" \x3e\x3d "+c:a.fieldObj.name+" \x3e\x3d "+(this.isHosted?"":"timestamp ")+"'"+this.formatDate(c)+"'";break;case this.OPERATORS.dateOperatorInTheLast:h=a.fieldObj.name+" BETWEEN CURRENT_TIMESTAMP - "+this._convertRangeToDays(a.valueObj.value,a.valueObj.range)+" AND CURRENT_TIMESTAMP";break;case this.OPERATORS.dateOperatorNotInTheLast:h=a.fieldObj.name+" NOT BETWEEN CURRENT_TIMESTAMP - "+this._convertRangeToDays(a.valueObj.value,
a.valueObj.range)+" AND CURRENT_TIMESTAMP";break;case this.OPERATORS.dateOperatorIsBetween:case this.OPERATORS.dateOperatorIsIn:h=e?a.fieldObj.name+" BETWEEN '"+d+"' AND '"+f+"'":a.fieldObj.name+" BETWEEN "+(this.isHosted?"":"timestamp ")+"'"+this.formatDate(d)+"' AND "+(this.isHosted?"":"timestamp ")+"'"+this.formatDate(this.addDay(f))+"'";break;case this.OPERATORS.dateOperatorIsNotBetween:case this.OPERATORS.dateOperatorIsNotIn:h=e?a.fieldObj.name+" NOT BETWEEN '"+d+"' AND '"+f+"'":a.fieldObj.name+
" NOT BETWEEN "+(this.isHosted?"":"timestamp ")+"'"+this.formatDate(d)+"' AND "+(this.isHosted?"":"timestamp ")+"'"+this.formatDate(this.addDay(f))+"'";break;case this.OPERATORS.dateOperatorIsBlank:h=a.fieldObj.name+" IS NULL";break;case this.OPERATORS.dateOperatorIsNotBlank:h=a.fieldObj.name+" IS NOT NULL"}return{whereClause:h}},_convertRangeToDays:function(a,b){var c=a;b===this.OPERATORS.dateOperatorYears?c=365*a:b===this.OPERATORS.dateOperatorMonths?c=30*a:b===this.OPERATORS.dateOperatorWeeks?
c=7*a:b===this.OPERATORS.dateOperatorHours?c=a/24:b===this.OPERATORS.dateOperatorMinutes&&(c=a/1440);return c=Math.round(1E6*c)/1E6},formatDate:function(a){a=new Date(a);return""+a.getUTCFullYear()+"-"+n.format(a.getUTCMonth()+1,{pattern:"00"})+"-"+n.format(a.getUTCDate(),{pattern:"00"})+" "+n.format(a.getUTCHours(),{pattern:"00"})+":"+n.format(a.getUTCMinutes(),{pattern:"00"})+":"+n.format(a.getSeconds(),{pattern:"00"})},addDay:function(a){return new Date(a.getTime()+this.dayInMS)},getFilterObjByExpr:function(a){if(a&&
this.fieldsStore){var b=this.replaceStrings(a);a=b.defExpr;var c=this.findParts(a,"AND");1===c.parts.length&&(c=this.findParts(a,"OR"),1===c.parts.length&&(c.logicalOperator="AND"));p.forEach(c.parts,function(a){a.expr=a.expr.trim();if(a.expr.startsWith("(")&&-1<a.expr.search(/\)$/)){var b=a.expr.substring(1,a.expr.length-1),c=b.indexOf("("),d=b.indexOf(")");if(-1===c&&-1===d||c<d)a.expr=b}b=this.findParts(a.expr,"AND");1===b.parts.length&&(b=this.findParts(a.expr,"OR"));1<b.parts.length&&(a.parts=
b.parts,a.logicalOperator=b.logicalOperator)},this);this.parseExpr(c);this.reReplaceStrings(b,c,e.hitch(this,function(){c&&c.parts&&p.forEach(c.parts,e.hitch(this,function(a){a&&(a.parts?p.forEach(a.parts,e.hitch(this,function(a){this._handleParsedValuesForSinglePart(a);this._addDefalutValueTypeForSinglePart(a)})):(this._handleParsedValuesForSinglePart(a),this._addDefalutValueTypeForSinglePart(a)))}))}));this.isPartsObjHasError(c)&&(c=null);return c}},_handleParsedValuesForSinglePart:function(a){a&&
a.fieldObj&&"number"===a.fieldObj.shortType&&a.valueObj&&(a.valueObj.hasOwnProperty("value")&&(a.valueObj.value=parseFloat(a.valueObj.value)),a.valueObj.hasOwnProperty("value1")&&(a.valueObj.value1=parseFloat(a.valueObj.value1)),a.valueObj.hasOwnProperty("value2")&&(a.valueObj.value2=parseFloat(a.valueObj.value2)))},_addDefalutValueTypeForSinglePart:function(a){a&&a.valueObj&&!a.valueObj.type&&(a.valueObj.type="value")},replaceStrings:function(a){for(var b=a,c=function(a,b,d){var g=-1,g=a.indexOf("'",
d+1);return g===d+1?(g=a.indexOf("'",g+1),c(a,b,g)):d},d=[],f=a.indexOf("'");-1<f;){var e=f,f=a.indexOf("'",f+1),h=0,f=c(a,e,f);"%"===a[e+1]&&e++;"%"===a[f-1]&&(--f,h++);var l=a.substring(e+1,f);"N"===a[e-1]&&(a=a.substring(0,e-1)+a.substring(e),--e,--f);this.isDateString(l)||-1!==l.indexOf("{")?f=a.indexOf("'",f+1+h):(d.push(l),a=a.substring(0,e+1)+"#"+(d.length-1)+"#"+a.substring(f),f=a.indexOf("'",a.lastIndexOf("#")+2+h))}return{origDefExpr:b,defExpr:a,savedStrings:d}},reReplaceStrings:function(a,
b,c){var d=a.savedStrings;if(!d.length)c&&"function"===typeof c&&c();else if(d.length){var g=function(a,b){if(void 0===a.valueObj||null===a.valueObj||void 0===a.valueObj.value||null===a.valueObj.value||"string"!==a.fieldObj.shortType)return!1;var c=a.valueObj.value.indexOf("#"),d=a.valueObj.value.lastIndexOf("#");return l.isDefined(a.valueObj.value)&&-1<c?(a.valueObj.value=b[parseInt(a.valueObj.value.substring(c+1,d),10)].replace(/\'\'/g,"'"),this.builtSingleFilterString(a),!0):!1},g=e.hitch(this,
g),f=!1;p.forEach(b.parts,function(a){if(a.parts){var b=!1;p.forEach(a.parts,function(a){b=g(a,d)||b});b&&(f=b,a.expr=this.builtFilterString(a))}else(f=g(a,d)||f)&&this.builtFilterString(a)},this);c&&"function"===typeof c&&c();f&&(b.expr=null,this.getExprByFilterObj(b))}},isDateString:function(a){return 19===a.length&&"-"===a.charAt(4)&&"-"===a.charAt(7)&&" "===a.charAt(10)&&":"===a.charAt(13)&&":"===a.charAt(16)?!0:!1},findParts:function(a,b){for(var c=a.toLowerCase(),d=" "+b.toLowerCase()+" ",f=
[],e=0,h=c.indexOf(d);0<h;){var l=a.substring(e,h),k=l.toLowerCase(),n=l.count("("),p=l.count(")"),q=l.count("'");n!==p||1===q%2?h=c.indexOf(d,h+1):-1<k.indexOf(" between ")&&-1===k.indexOf(" and ")?h=c.indexOf(d,h+1):(f.push({expr:l}),e=h+d.length,h=c.indexOf(d,e))}f.push({expr:a.substring(e)});for(c=f.length-1;0<=c;c--)!this.hasOperator(f[c].expr)&&0<c&&(f[c-1].expr+=" "+b+" "+f[c].expr,f.splice(c,1));return{expr:a,parts:f,logicalOperator:b}},hasOperator:function(a){a=a.toLowerCase();return-1<a.indexOf("{")&&
-1<a.indexOf("}")||-1<a.indexOf(" \x3d ")||-1<a.indexOf(" \x3c ")||-1<a.indexOf(" \x3e ")||-1<a.indexOf(" \x3c\x3e ")||-1<a.indexOf(" \x3c\x3d ")||-1<a.indexOf(" \x3e\x3d ")||-1<a.indexOf(" like ")||-1<a.indexOf(" between ")||-1<a.indexOf(" date")||-1<a.indexOf(" is null")||-1<a.indexOf(" is not null")?!0:!1},parseExpr:function(a){p.forEach(a.parts,function(a){a.parts?this.parseExpr(a):this.parseSingleExpr(a)},this)},_preParseSingleExpr:function(a){var b=null;try{if(b=e.clone(a),b.expr=b.expr.trim(),
/^UPPER\((.*)\)(\s+|\s+NOT\s+)LIKE\s+UPPER\(N?'(.*)'\)$/i.test(b.expr)){var c=a="",d=b.expr.match(/^UPPER\((.*)\)\s+/i);if(d&&2<=d.length)a=d[1];else return null;var f=b.expr.match(/UPPER\(N?'(.*)'\)$/i);if(f&&2<=f.length)c="'"+f[1]+"'";else return null;b.expr=b.expr.replace(/^UPPER\((.*)\)\s+/i,a+" ");b.expr=b.expr.replace(/UPPER\(N?'(.*)'\)$/i,c);b.caseSensitive=!1}else/^(.+)(\s+|\s+NOT\s+)LIKE\s+N?'(.*)'$/i.test(b.expr)&&(b.caseSensitive=!0)}catch(r){return console.log(r),null}b&&this.isHosted&&
(b.caseSensitive=!1);return b},_removeOperator:function(a,b,c){b=b.substring(c).trim();"date"===a&&!this.isHosted&&b.toLowerCase().startsWith("timestamp ")&&(b=b.substring(10).trim());return b},parseSingleExpr:function(a){var b=this._preParseSingleExpr(a);b&&(a=e.mixin(a,b));var b=a.expr.trim(),c=b.indexOf(" "),d=b.substring(0,c);a.fieldObj={name:d};a.valueObj={};this.getFieldItemByName({name:d},function(b){a.fieldObj.shortType=b.shortType[0];a.fieldObj.label=b.label[0]},function(){a.error={msg:"unknown field name ("+
d+")",code:1}});b=b.substring(c+1).trim();c=b.toLowerCase();c.startsWith("\x3d ")?(b=this._removeOperator(a.fieldObj.shortType,b,2),this.storeValue(b,a),a.operator="date"===a.fieldObj.shortType?this.OPERATORS.dateOperatorIsOn:"string"===a.fieldObj.shortType?this.OPERATORS.stringOperatorIs:this.OPERATORS.numberOperatorIs):c.startsWith("\x3c ")?(b=this._removeOperator(a.fieldObj.shortType,b,2),this.storeValue(b,a),"date"===a.fieldObj.shortType?a.operator=this.OPERATORS.dateOperatorIsBefore:"number"===
a.fieldObj.shortType?a.operator=this.OPERATORS.numberOperatorIsLessThan:a.error={msg:"operator ("+c+") not supported for string",code:3}):c.startsWith("\x3e ")?(b=this._removeOperator(a.fieldObj.shortType,b,2),this.storeValue(b,a),"date"===a.fieldObj.shortType?a.operator=this.OPERATORS.dateOperatorIsAfter:"number"===a.fieldObj.shortType?a.operator=this.OPERATORS.numberOperatorIsGreaterThan:a.error={msg:"operator ("+c+") not supported for string",code:3}):c.startsWith("\x3c\x3e ")?(b=this._removeOperator(a.fieldObj.shortType,
b,3),this.storeValue(b,a),a.operator="date"===a.fieldObj.shortType?this.OPERATORS.dateOperatorIsNotOn:"string"===a.fieldObj.shortType?this.OPERATORS.stringOperatorIsNot:this.OPERATORS.numberOperatorIsNot):c.startsWith("\x3c\x3d ")?(b=this._removeOperator(a.fieldObj.shortType,b,3),this.storeValue(b,a),"date"===a.fieldObj.shortType?a.operator=this.OPERATORS.dateOperatorIsOnOrBefore:"number"===a.fieldObj.shortType?a.operator=this.OPERATORS.numberOperatorIsAtMost:a.error={msg:"operator ("+c+") not supported for string",
code:3}):c.startsWith("\x3e\x3d ")?(b=this._removeOperator(a.fieldObj.shortType,b,3),this.storeValue(b,a),"date"===a.fieldObj.shortType?a.operator=this.OPERATORS.dateOperatorIsOnOrAfter:"number"===a.fieldObj.shortType?a.operator=this.OPERATORS.numberOperatorIsAtLeast:a.error={msg:"operator ("+c+") not supported for string",code:3}):c.startsWith("like ")?(b=b.substring(5).trim(),b.startsWith("N'")&&(b=b.substring(1,b.length)),b.startsWith("'%")&&b.endsWith("%'")?(this.storeValue(b.substring(2,b.length-
2),a),a.operator=this.OPERATORS.stringOperatorContains):b.startsWith("'%")&&b.endsWith("'")?(this.storeValue(b.substring(2,b.length-1),a),a.operator=this.OPERATORS.stringOperatorEndsWith):b.startsWith("'")&&b.endsWith("%'")?(this.storeValue(b.substring(1,b.length-2),a),a.operator=this.OPERATORS.stringOperatorStartsWith):a.error={msg:"value ("+c+") not supported for LIKE",code:3}):c.startsWith("not like ")?(b=b.substring(9).trim(),b.startsWith("N'")&&(b=b.substring(1,b.length)),b.startsWith("'%")&&
b.endsWith("%'")?(this.storeValue(b.substring(2,b.length-2),a),a.operator=this.OPERATORS.stringOperatorDoesNotContain):a.error={msg:"value ("+c+") not supported for NOT LIKE",code:3}):c.startsWith("between ")?this._updatePartForBetween(b,!0,a):c.startsWith("not between ")?this._updatePartForBetween(b,!1,a):"is null"===c?(a.valueObj.value=null,a.operator="date"===a.fieldObj.shortType?this.OPERATORS.dateOperatorIsBlank:"string"===a.fieldObj.shortType?this.OPERATORS.stringOperatorIsBlank:this.OPERATORS.numberOperatorIsBlank):
"is not null"===c?(a.valueObj.value=null,a.operator="date"===a.fieldObj.shortType?this.OPERATORS.dateOperatorIsNotBlank:"string"===a.fieldObj.shortType?this.OPERATORS.stringOperatorIsNotBlank:this.OPERATORS.numberOperatorIsNotBlank):a.error={msg:"unknown operator ("+c+")",code:2};if(l.isDefined(a.valueObj.value)&&"string"===typeof a.valueObj.value&&a.valueObj.value.startsWith("{")&&a.valueObj.value.endsWith("}")||l.isDefined(a.valueObj.value1)&&"string"===typeof a.valueObj.value1&&a.valueObj.value1.startsWith("{")&&
a.valueObj.value1.endsWith("}"))a.isInteractive=!0},getFieldItemByName:function(a,b,c){this.fieldsStore.fetch({query:a,onComplete:e.hitch(this,function(a){a&&a.length?b(a[0]):c()})})},subtractDay:function(a){return new Date(a.getTime()-this.dayInMS)},_updatePartForBetween:function(a,b,c){var d,g,f,e,h;a=this._removeOperator(c.fieldObj.shortType,a,(b?"between ":"not between ").length);d=a.toLowerCase().indexOf(" and ");if(-1<d)if(g=a.substring(0,d).trim(),g.startsWith("CURRENT_TIMESTAMP "))if(g=g.substring(18).trim(),
g.startsWith("-")){c.operator=b?this.OPERATORS.dateOperatorInTheLast:this.OPERATORS.dateOperatorNotInTheLast;try{h=parseFloat(g.substring(1).trim()),1<=h?(f=this.OPERATORS.dateOperatorDays,e=h/365,1E-4>Math.abs(e-Math.round(e))?(h=Math.round(e),f=this.OPERATORS.dateOperatorYears):(e=h/30,1E-4>Math.abs(e-Math.round(e))?(h=Math.round(e),f=this.OPERATORS.dateOperatorMonths):(e=h/7,1E-4>Math.abs(e-Math.round(e))&&(h=Math.round(e),f=this.OPERATORS.dateOperatorWeeks)))):(f=this.OPERATORS.dateOperatorMinutes,
h*=24,1E-4>Math.abs(h-Math.round(h))?f=this.OPERATORS.dateOperatorHours:h*=60),c.valueObj.value=h,c.valueObj.range=f}catch(y){c.error={msg:"missing count for '"+(b?"":"not ")+"in the last'",code:3}}}else c.error={msg:"'"+(b?"":"not ")+"in the next' not supported",code:3};else if(a=this._removeOperator(c.fieldObj.shortType,a.substring(d),5),this.storeValue1(g,c),this.storeValue2(a,c),"date"===c.fieldObj.shortType){if(c.operator=b?this.OPERATORS.dateOperatorIsBetween:this.OPERATORS.dateOperatorIsNotBetween,
"object"===typeof c.valueObj.value1&&"object"===typeof c.valueObj.value2)try{1E3>Math.abs(this.subtractDay(c.valueObj.value2).getTime()-c.valueObj.value1.getTime())&&(c.valueObj.value=c.valueObj.value1,delete c.valueObj.value1,delete c.valueObj.value2,c.operator=b?this.OPERATORS.dateOperatorIsOn:this.OPERATORS.dateOperatorIsNotOn)}catch(y){}}else"number"===c.fieldObj.shortType||"oid"===c.fieldObj.shortType?c.operator=b?this.OPERATORS.numberOperatorIsBetween:this.OPERATORS.numberOperatorIsNotBetween:
c.error={msg:c.fieldObj.shortType+" field not supported for "+(b?"":"NOT ")+"BETWEEN",code:3};else c.error={msg:"missing AND operator for "+(b?"":"NOT ")+"BETWEEN",code:3}},storeValue:function(a,b){if(a.startsWith("{")&&a.endsWith("}"))b.valueObj.value=a;else if(a.startsWith("'{")&&a.endsWith("}'"))b.valueObj.value=a.substring(1,a.length-1);else if("date"===b.fieldObj.shortType)if(a.startsWith("'")&&a.endsWith("'")){var c=a.substring(1,a.length-1);b.valueObj.value=this.parseDate(c)}else b.valueObj.value=
a,b.valueObj.type="field";else"string"===b.fieldObj.shortType?(a.startsWith("#")||a.startsWith("%#"))&&(a.endsWith("#")||a.endsWith("#%"))?b.valueObj.value=a:a.startsWith("'")&&a.endsWith("'")?b.valueObj.value=a.substring(1,a.length-1).replace(/\'\'/g,"'"):(b.valueObj.value=a,b.valueObj.type="field",this.getFieldItemByName({name:a},function(a){b.valueObj.label=a.label[0]},function(){b.error={msg:"unknown field name ("+a+")",code:1}})):(b.valueObj.value=a,isNaN(a)&&(b.valueObj.type="field",this.getFieldItemByName({name:a},
function(a){b.valueObj.label=a.label[0]},function(){b.error={msg:"unknown field name ("+a+")",code:1}})))},storeValue1:function(a,b){a.startsWith("{")&&a.endsWith("}")?b.valueObj.value1=a:a.startsWith("'{")&&a.endsWith("}'")?b.valueObj.value1=a.substring(1,a.length-1):"date"===b.fieldObj.shortType?a.startsWith("'")&&a.endsWith("'")?(a=a.substring(1,a.length-1),b.valueObj.value1=this.parseDate(a)):(b.valueObj.value1=a,b.valueObj.type="field"):(b.valueObj.value1=a,isNaN(a)&&(b.valueObj.type="field"))},
storeValue2:function(a,b){a.startsWith("{")&&a.endsWith("}")?b.valueObj.value2=a:a.startsWith("'{")&&a.endsWith("}'")?b.valueObj.value2=a.substring(1,a.length-1):"date"===b.fieldObj.shortType?a.startsWith("'")&&a.endsWith("'")?(a=a.substring(1,a.length-1),b.valueObj.value2=this.parseDate(a)):(b.valueObj.value2=a,b.valueObj.type="field"):(b.valueObj.value2=a,isNaN(a)&&(b.valueObj.type="field"))},parseDate:function(a){var b=q.parse(a,{datePattern:"yyyy-MM-dd",timePattern:"HH:mm:ss"});b||(b=q.parse(a.replace(" ",
", "),{datePattern:"yyyy-MM-dd",timePattern:"HH:mm:ss"}))||(b=q.parse(a.replace(" "," - "),{datePattern:"yyyy-MM-dd",timePattern:"HH:mm:ss"}));return b}});c.VIRTUAL_DATE_TODAY="today";c.VIRTUAL_DATE_YESTERDAY="yesterday";c.VIRTUAL_DATE_TOMORROW="tomorrow";c.VIRTUAL_DATE_THIS_WEEK="thisWeek";c.VIRTUAL_DATE_THIS_MONTH="thisMonth";c.VIRTUAL_DATE_THIS_QUARTER="thisQuarter";c.VIRTUAL_DATE_THIS_YEAR="thisYear";c.isAskForValues=function(a){var b=!1;return b=p.some(a.parts,function(a){return a.parts?p.some(a.parts,
function(a){return!!a.interactiveObj}):!!a.interactiveObj})};c.hasVirtualDate=function(a){var b=!1;return b=p.some(a.parts,function(a){return a.parts?p.some(a.parts,function(a){return!!a.valueObj.virtualDate||!!a.valueObj.virtualDate1||!!a.valueObj.virtualDate2}):!!a.valueObj.virtualDate||!!a.valueObj.virtualDate1||!!a.valueObj.virtualDate2})};c.getRealDateByVirtualDate=function(a){var b=null,g=new Date,f=g.getTime();switch(a){case c.VIRTUAL_DATE_TODAY:b=g;break;case c.VIRTUAL_DATE_YESTERDAY:b=new Date(f-
864E5);break;case c.VIRTUAL_DATE_TOMORROW:b=new Date(f+864E5);break;case c.VIRTUAL_DATE_THIS_WEEK:b=[d().startOf("week").toDate(),d().endOf("week").toDate()];break;case c.VIRTUAL_DATE_THIS_MONTH:b=[d().startOf("month").toDate(),d().endOf("month").toDate()];break;case c.VIRTUAL_DATE_THIS_QUARTER:b=[d().startOf("quarter").toDate(),d().endOf("quarter").toDate()];break;case c.VIRTUAL_DATE_THIS_YEAR:b=[d().startOf("year").toDate(),d().endOf("year").toDate()]}return b};return c})},"dojo/data/ItemFileWriteStore":function(){define("../_base/lang ../_base/declare ../_base/array ../_base/json ../_base/kernel ./ItemFileReadStore ../date/stamp".split(" "),
function(k,e,p,q,n,l,h){return e("dojo.data.ItemFileWriteStore",l,{constructor:function(f){this._features["dojo.data.api.Write"]=!0;this._features["dojo.data.api.Notification"]=!0;this._pending={_newItems:{},_modifiedItems:{},_deletedItems:{}};this._datatypeMap.Date.serialize||(this._datatypeMap.Date.serialize=function(d){return h.toISOString(d,{zulu:!0})});f&&!1===f.referenceIntegrity&&(this.referenceIntegrity=!1);this._saveInProgress=!1},referenceIntegrity:!0,_assert:function(f){if(!f)throw Error("assertion failed in ItemFileWriteStore");
},_getIdentifierAttribute:function(){return this.getFeatures()["dojo.data.api.Identity"]},newItem:function(f,d){this._assert(!this._saveInProgress);this._loadFinished||this._forceLoad();if("object"!=typeof f&&"undefined"!=typeof f)throw Error("newItem() was passed something other than an object");var c=null,a=this._getIdentifierAttribute();if(a===Number)c=this._arrayOfAllItems.length;else{c=f[a];if("undefined"===typeof c)throw Error("newItem() was not passed an identity for the new item");if(k.isArray(c))throw Error("newItem() was not passed an single-valued identity");
}this._itemsByIdentity&&this._assert("undefined"===typeof this._itemsByIdentity[c]);this._assert("undefined"===typeof this._pending._newItems[c]);this._assert("undefined"===typeof this._pending._deletedItems[c]);var b={};b[this._storeRefPropName]=this;b[this._itemNumPropName]=this._arrayOfAllItems.length;this._itemsByIdentity&&(this._itemsByIdentity[c]=b,b[a]=[c]);this._arrayOfAllItems.push(b);a=null;if(d&&d.parent&&d.attribute){var a={item:d.parent,attribute:d.attribute,oldValue:void 0},g=this.getValues(d.parent,
d.attribute);if(g&&0<g.length){var e=g.slice(0,g.length);a.oldValue=1===g.length?g[0]:g.slice(0,g.length);e.push(b);this._setValueOrValues(d.parent,d.attribute,e,!1);a.newValue=this.getValues(d.parent,d.attribute)}else this._setValueOrValues(d.parent,d.attribute,b,!1),a.newValue=b}else b[this._rootItemPropName]=!0,this._arrayOfTopLevelItems.push(b);this._pending._newItems[c]=b;for(var m in f){if(m===this._storeRefPropName||m===this._itemNumPropName)throw Error("encountered bug in ItemFileWriteStore.newItem");
d=f[m];k.isArray(d)||(d=[d]);b[m]=d;if(this.referenceIntegrity)for(c=0;c<d.length;c++)g=d[c],this.isItem(g)&&this._addReferenceToMap(g,b,m)}this.onNew(b,a);return b},_removeArrayElement:function(f,d){d=p.indexOf(f,d);return-1!=d?(f.splice(d,1),!0):!1},deleteItem:function(f){this._assert(!this._saveInProgress);this._assertIsItem(f);var d=f[this._itemNumPropName],c=this.getIdentity(f);if(this.referenceIntegrity){var a=this.getAttributes(f);f[this._reverseRefMap]&&(f["backup_"+this._reverseRefMap]=k.clone(f[this._reverseRefMap]));
p.forEach(a,function(a){p.forEach(this.getValues(f,a),function(b){this.isItem(b)&&(f["backupRefs_"+this._reverseRefMap]||(f["backupRefs_"+this._reverseRefMap]=[]),f["backupRefs_"+this._reverseRefMap].push({id:this.getIdentity(b),attr:a}),this._removeReferenceFromMap(b,f,a))},this)},this);if(a=f[this._reverseRefMap])for(var b in a){var g=null;if(g=this._itemsByIdentity?this._itemsByIdentity[b]:this._arrayOfAllItems[b])for(var e in a[b]){var m=this.getValues(g,e)||[],h=p.filter(m,function(a){return!(this.isItem(a)&&
this.getIdentity(a)==c)},this);this._removeReferenceFromMap(f,g,e);h.length<m.length&&this._setValueOrValues(g,e,h,!0)}}}this._arrayOfAllItems[d]=null;f[this._storeRefPropName]=null;this._itemsByIdentity&&delete this._itemsByIdentity[c];this._pending._deletedItems[c]=f;f[this._rootItemPropName]&&this._removeArrayElement(this._arrayOfTopLevelItems,f);this.onDelete(f);return!0},setValue:function(f,d,c){return this._setValueOrValues(f,d,c,!0)},setValues:function(f,d,c){return this._setValueOrValues(f,
d,c,!0)},unsetAttribute:function(f,d){return this._setValueOrValues(f,d,[],!0)},_setValueOrValues:function(f,d,c,a){this._assert(!this._saveInProgress);this._assertIsItem(f);this._assert(k.isString(d));this._assert("undefined"!==typeof c);var b=this._getIdentifierAttribute();if(d==b)throw Error("ItemFileWriteStore does not have support for changing the value of an item's identifier.");var b=this._getValueOrValues(f,d),g=this.getIdentity(f);if(!this._pending._modifiedItems[g]){var e={},m;for(m in f)e[m]=
m===this._storeRefPropName||m===this._itemNumPropName||m===this._rootItemPropName?f[m]:m===this._reverseRefMap?k.clone(f[m]):f[m].slice(0,f[m].length);this._pending._modifiedItems[g]=e}g=!1;if(k.isArray(c)&&0===c.length){if(g=delete f[d],c=void 0,this.referenceIntegrity&&b){m=b;k.isArray(m)||(m=[m]);for(var h=0;h<m.length;h++)e=m[h],this.isItem(e)&&this._removeReferenceFromMap(e,f,d)}}else{g=k.isArray(c)?c.slice(0,c.length):[c];if(this.referenceIntegrity)if(b){m=b;k.isArray(m)||(m=[m]);var l={};p.forEach(m,
function(a){this.isItem(a)&&(a=this.getIdentity(a),l[a.toString()]=!0)},this);p.forEach(g,function(a){if(this.isItem(a)){var b=this.getIdentity(a);l[b.toString()]?delete l[b.toString()]:this._addReferenceToMap(a,f,d)}},this);for(h in l)this._removeReferenceFromMap(this._itemsByIdentity?this._itemsByIdentity[h]:this._arrayOfAllItems[h],f,d)}else for(h=0;h<g.length;h++)e=g[h],this.isItem(e)&&this._addReferenceToMap(e,f,d);f[d]=g;g=!0}if(a)this.onSet(f,d,b,c);return g},_addReferenceToMap:function(f,
d,c){d=this.getIdentity(d);var a=f[this._reverseRefMap];a||(a=f[this._reverseRefMap]={});(f=a[d])||(f=a[d]={});f[c]=!0},_removeReferenceFromMap:function(f,d,c){d=this.getIdentity(d);var a=f[this._reverseRefMap],b;if(a){for(b in a)b==d&&(delete a[b][c],this._isEmpty(a[b])&&delete a[b]);this._isEmpty(a)&&delete f[this._reverseRefMap]}},_dumpReferenceMap:function(){var f;for(f=0;f<this._arrayOfAllItems.length;f++){var d=this._arrayOfAllItems[f];d&&d[this._reverseRefMap]&&console.log("Item: ["+this.getIdentity(d)+
"] is referenced by: "+q.toJson(d[this._reverseRefMap]))}},_getValueOrValues:function(f,d){var c=void 0;this.hasAttribute(f,d)&&(f=this.getValues(f,d),c=1==f.length?f[0]:f);return c},_flatten:function(f){if(this.isItem(f))return{_reference:this.getIdentity(f)};if("object"===typeof f)for(var d in this._datatypeMap){var c=this._datatypeMap[d];if(k.isObject(c)&&!k.isFunction(c)){if(f instanceof c.type){if(!c.serialize)throw Error("ItemFileWriteStore:  No serializer defined for type mapping: ["+d+"]");
return{_type:d,_value:c.serialize(f)}}}else if(f instanceof c)return{_type:d,_value:f.toString()}}return f},_getNewFileContentString:function(){var f={},d=this._getIdentifierAttribute();d!==Number&&(f.identifier=d);this._labelAttr&&(f.label=this._labelAttr);f.items=[];for(d=0;d<this._arrayOfAllItems.length;++d){var c=this._arrayOfAllItems[d];if(null!==c){var a={},b;for(b in c)if(b!==this._storeRefPropName&&b!==this._itemNumPropName&&b!==this._reverseRefMap&&b!==this._rootItemPropName){var g=this.getValues(c,
b);if(1==g.length)a[b]=this._flatten(g[0]);else for(var e=[],m=0;m<g.length;++m)e.push(this._flatten(g[m])),a[b]=e}f.items.push(a)}}return q.toJson(f,!0)},_isEmpty:function(f){var d=!0;if(k.isObject(f))for(var c in f){d=!1;break}else k.isArray(f)&&0<f.length&&(d=!1);return d},save:function(f){this._assert(!this._saveInProgress);this._saveInProgress=!0;var d=this,c=function(){d._pending={_newItems:{},_modifiedItems:{},_deletedItems:{}};d._saveInProgress=!1;f&&f.onComplete&&f.onComplete.call(f.scope||
n.global)},a=function(a){d._saveInProgress=!1;f&&f.onError&&f.onError.call(f.scope||n.global,a)};if(this._saveEverything){var b=this._getNewFileContentString();this._saveEverything(c,a,b)}this._saveCustom&&this._saveCustom(c,a);this._saveEverything||this._saveCustom||c()},revert:function(){this._assert(!this._saveInProgress);for(var f in this._pending._modifiedItems){var d=this._pending._modifiedItems[f],c=null,c=this._itemsByIdentity?this._itemsByIdentity[f]:this._arrayOfAllItems[f];d[this._storeRefPropName]=
this;for(var a in c)delete c[a];k.mixin(c,d)}var b;for(f in this._pending._deletedItems)b=this._pending._deletedItems[f],b[this._storeRefPropName]=this,d=b[this._itemNumPropName],b["backup_"+this._reverseRefMap]&&(b[this._reverseRefMap]=b["backup_"+this._reverseRefMap],delete b["backup_"+this._reverseRefMap]),this._arrayOfAllItems[d]=b,this._itemsByIdentity&&(this._itemsByIdentity[f]=b),b[this._rootItemPropName]&&this._arrayOfTopLevelItems.push(b);for(f in this._pending._deletedItems)b=this._pending._deletedItems[f],
b["backupRefs_"+this._reverseRefMap]&&(p.forEach(b["backupRefs_"+this._reverseRefMap],function(a){this._addReferenceToMap(this._itemsByIdentity?this._itemsByIdentity[a.id]:this._arrayOfAllItems[a.id],b,a.attr)},this),delete b["backupRefs_"+this._reverseRefMap]);for(f in this._pending._newItems)d=this._pending._newItems[f],d[this._storeRefPropName]=null,this._arrayOfAllItems[d[this._itemNumPropName]]=null,d[this._rootItemPropName]&&this._removeArrayElement(this._arrayOfTopLevelItems,d),this._itemsByIdentity&&
delete this._itemsByIdentity[f];this._pending={_newItems:{},_modifiedItems:{},_deletedItems:{}};return!0},isDirty:function(f){return f?(f=this.getIdentity(f),(new Boolean(this._pending._newItems[f]||this._pending._modifiedItems[f]||this._pending._deletedItems[f])).valueOf()):!this._isEmpty(this._pending._newItems)||!this._isEmpty(this._pending._modifiedItems)||!this._isEmpty(this._pending._deletedItems)},onSet:function(f,d,c,a){},onNew:function(f,d){},onDelete:function(f){},close:function(f){if(this.clearOnClose){if(this.isDirty())throw Error("dojo.data.ItemFileWriteStore: There are unsaved changes present in the store.  Please save or revert the changes before invoking close.");
this.inherited(arguments)}}})})},"dojo/data/ItemFileReadStore":function(){define("../_base/kernel ../_base/lang ../_base/declare ../_base/array ../_base/xhr ../Evented ./util/filter ./util/simpleFetch ../date/stamp".split(" "),function(k,e,p,q,n,l,h,f,d){p=p("dojo.data.ItemFileReadStore",[l],{constructor:function(c){this._arrayOfAllItems=[];this._arrayOfTopLevelItems=[];this._loadFinished=!1;this.url=this._ccUrl=this._jsonFileUrl=c.url;this._jsonData=c.data;this.data=null;this._datatypeMap=c.typeMap||
{};this._datatypeMap.Date||(this._datatypeMap.Date={type:Date,deserialize:function(a){return d.fromISOString(a)}});this._features={"dojo.data.api.Read":!0,"dojo.data.api.Identity":!0};this._itemsByIdentity=null;this._storeRefPropName="_S";this._itemNumPropName="_0";this._rootItemPropName="_RI";this._reverseRefMap="_RRM";this._loadInProgress=!1;this._queuedFetches=[];void 0!==c.urlPreventCache&&(this.urlPreventCache=c.urlPreventCache?!0:!1);void 0!==c.hierarchical&&(this.hierarchical=c.hierarchical?
!0:!1);c.clearOnClose&&(this.clearOnClose=!0);"failOk"in c&&(this.failOk=c.failOk?!0:!1)},url:"",_ccUrl:"",data:null,typeMap:null,clearOnClose:!1,urlPreventCache:!1,failOk:!1,hierarchical:!0,_assertIsItem:function(c){if(!this.isItem(c))throw Error(this.declaredClass+": Invalid item argument.");},_assertIsAttribute:function(c){if("string"!==typeof c)throw Error(this.declaredClass+": Invalid attribute argument.");},getValue:function(c,a,b){c=this.getValues(c,a);return 0<c.length?c[0]:b},getValues:function(c,
a){this._assertIsItem(c);this._assertIsAttribute(a);return(c[a]||[]).slice(0)},getAttributes:function(c){this._assertIsItem(c);var a=[],b;for(b in c)b!==this._storeRefPropName&&b!==this._itemNumPropName&&b!==this._rootItemPropName&&b!==this._reverseRefMap&&a.push(b);return a},hasAttribute:function(c,a){this._assertIsItem(c);this._assertIsAttribute(a);return a in c},containsValue:function(c,a,b){var d=void 0;"string"===typeof b&&(d=h.patternToRegExp(b,!1));return this._containsValue(c,a,b,d)},_containsValue:function(c,
a,b,d){return q.some(this.getValues(c,a),function(a){if(null!==a&&!e.isObject(a)&&d){if(a.toString().match(d))return!0}else if(b===a)return!0})},isItem:function(c){return c&&c[this._storeRefPropName]===this&&this._arrayOfAllItems[c[this._itemNumPropName]]===c?!0:!1},isItemLoaded:function(c){return this.isItem(c)},loadItem:function(c){this._assertIsItem(c.item)},getFeatures:function(){return this._features},getLabel:function(c){if(this._labelAttr&&this.isItem(c))return this.getValue(c,this._labelAttr)},
getLabelAttributes:function(c){return this._labelAttr?[this._labelAttr]:null},filter:function(c,a,b){var d=[],f,e;if(c.query){var l;f=c.queryOptions?c.queryOptions.ignoreCase:!1;var k={};for(e in c.query)l=c.query[e],"string"===typeof l?k[e]=h.patternToRegExp(l,f):l instanceof RegExp&&(k[e]=l);for(f=0;f<a.length;++f){var n=!0,p=a[f];if(null===p)n=!1;else for(e in c.query)l=c.query[e],this._containsValue(p,e,l,k[e])||(n=!1);n&&d.push(p)}}else for(f=0;f<a.length;++f)e=a[f],null!==e&&d.push(e);b(d,c)},
_fetchItems:function(c,a,b){var d=this;if(this._loadFinished)this.filter(c,this._getItemsArray(c.queryOptions),a);else if(this._jsonFileUrl!==this._ccUrl?(k.deprecated(this.declaredClass+": ","To change the url, set the url property of the store, not _jsonFileUrl.  _jsonFileUrl support will be removed in 2.0"),this.url=this._ccUrl=this._jsonFileUrl):this.url!==this._ccUrl&&(this._ccUrl=this._jsonFileUrl=this.url),null!=this.data&&(this._jsonData=this.data,this.data=null),this._jsonFileUrl)if(this._loadInProgress)this._queuedFetches.push({args:c,
filter:e.hitch(d,"filter"),findCallback:e.hitch(d,a)});else{this._loadInProgress=!0;var f=n.get({url:d._jsonFileUrl,handleAs:"json-comment-optional",preventCache:this.urlPreventCache,failOk:this.failOk});f.addCallback(function(g){try{d._getItemsFromLoadedData(g),d._loadFinished=!0,d._loadInProgress=!1,d.filter(c,d._getItemsArray(c.queryOptions),a),d._handleQueuedFetches()}catch(t){d._loadFinished=!0,d._loadInProgress=!1,b(t,c)}});f.addErrback(function(a){d._loadInProgress=!1;b(a,c)});var m=null;c.abort&&
(m=c.abort);c.abort=function(){var a=f;a&&-1===a.fired&&(a.cancel(),a=null);m&&m.call(c)}}else if(this._jsonData)try{this._loadFinished=!0,this._getItemsFromLoadedData(this._jsonData),this._jsonData=null,d.filter(c,this._getItemsArray(c.queryOptions),a)}catch(r){b(r,c)}else b(Error(this.declaredClass+": No JSON source data was provided as either URL or a nested Javascript object."),c)},_handleQueuedFetches:function(){if(0<this._queuedFetches.length){for(var c=0;c<this._queuedFetches.length;c++){var a=
this._queuedFetches[c],b=a.args,d=a.filter,a=a.findCallback;d?d(b,this._getItemsArray(b.queryOptions),a):this.fetchItemByIdentity(b)}this._queuedFetches=[]}},_getItemsArray:function(c){return c&&c.deep?this._arrayOfAllItems:this._arrayOfTopLevelItems},close:function(c){this.clearOnClose&&this._loadFinished&&!this._loadInProgress&&(""!=this._jsonFileUrl&&null!=this._jsonFileUrl||""!=this.url&&null!=this.url||null!=this.data||console.debug(this.declaredClass+": WARNING!  Data reload  information has not been provided.  Please set 'url' or 'data' to the appropriate value before the next fetch"),
this._arrayOfAllItems=[],this._arrayOfTopLevelItems=[],this._loadFinished=!1,this._itemsByIdentity=null,this._loadInProgress=!1,this._queuedFetches=[])},_getItemsFromLoadedData:function(c){function a(a){return null!==a&&"object"===typeof a&&(!e.isArray(a)||d)&&!e.isFunction(a)&&(a.constructor==Object||e.isArray(a))&&"undefined"===typeof a._reference&&"undefined"===typeof a._type&&"undefined"===typeof a._value&&f.hierarchical}function b(c){f._arrayOfAllItems.push(c);for(var d in c){var g=c[d];if(g)if(e.isArray(g))for(var m=
0;m<g.length;++m){var h=g[m];a(h)&&b(h)}else a(g)&&b(g)}}var d=!1,f=this;this._labelAttr=c.label;var m,h;this._arrayOfAllItems=[];this._arrayOfTopLevelItems=c.items;for(m=0;m<this._arrayOfTopLevelItems.length;++m)h=this._arrayOfTopLevelItems[m],e.isArray(h)&&(d=!0),b(h),h[this._rootItemPropName]=!0;var l={},k;for(m=0;m<this._arrayOfAllItems.length;++m)for(k in h=this._arrayOfAllItems[m],h){if(k!==this._rootItemPropName){var n=h[k];null!==n?e.isArray(n)||(h[k]=[n]):h[k]=[null]}l[k]=k}for(;l[this._storeRefPropName];)this._storeRefPropName+=
"_";for(;l[this._itemNumPropName];)this._itemNumPropName+="_";for(;l[this._reverseRefMap];)this._reverseRefMap+="_";if(l=c.identifier)for(this._itemsByIdentity={},this._features["dojo.data.api.Identity"]=l,m=0;m<this._arrayOfAllItems.length;++m)if(h=this._arrayOfAllItems[m],c=h[l],c=c[0],Object.hasOwnProperty.call(this._itemsByIdentity,c)){if(this._jsonFileUrl)throw Error(this.declaredClass+":  The json data as specified by: ["+this._jsonFileUrl+"] is malformed.  Items within the list have identifier: ["+
l+"].  Value collided: ["+c+"]");if(this._jsonData)throw Error(this.declaredClass+":  The json data provided by the creation arguments is malformed.  Items within the list have identifier: ["+l+"].  Value collided: ["+c+"]");}else this._itemsByIdentity[c]=h;else this._features["dojo.data.api.Identity"]=Number;for(m=0;m<this._arrayOfAllItems.length;++m)h=this._arrayOfAllItems[m],h[this._storeRefPropName]=this,h[this._itemNumPropName]=m;for(m=0;m<this._arrayOfAllItems.length;++m)for(k in h=this._arrayOfAllItems[m],
h)for(c=h[k],l=0;l<c.length;++l)if(n=c[l],null!==n&&"object"==typeof n){if("_type"in n&&"_value"in n){var p=n._type,q=this._datatypeMap[p];if(q)if(e.isFunction(q))c[l]=new q(n._value);else if(e.isFunction(q.deserialize))c[l]=q.deserialize(n._value);else throw Error("dojo.data.ItemFileReadStore: Value provided in typeMap was neither a constructor, nor a an object with a deserialize function");else throw Error("dojo.data.ItemFileReadStore: in the typeMap constructor arg, no object class was specified for the datatype '"+
p+"'");}if(n._reference){n=n._reference;if(e.isObject(n))for(p=0;p<this._arrayOfAllItems.length;++p){var q=this._arrayOfAllItems[p],x=!0,A;for(A in n)q[A]!=n[A]&&(x=!1);x&&(c[l]=q)}else c[l]=this._getItemByIdentity(n);this.referenceIntegrity&&(n=c[l],this.isItem(n)&&this._addReferenceToMap(n,h,k))}else this.isItem(n)&&this.referenceIntegrity&&this._addReferenceToMap(n,h,k)}},_addReferenceToMap:function(c,a,b){},getIdentity:function(c){var a=this._features["dojo.data.api.Identity"];return a===Number?
c[this._itemNumPropName]:(c=c[a])?c[0]:null},fetchItemByIdentity:function(c){var a,b;if(this._loadFinished)a=this._getItemByIdentity(c.identity),c.onItem&&(b=c.scope?c.scope:k.global,c.onItem.call(b,a));else{var d=this;this._jsonFileUrl!==this._ccUrl?(k.deprecated(this.declaredClass+": ","To change the url, set the url property of the store, not _jsonFileUrl.  _jsonFileUrl support will be removed in 2.0"),this.url=this._ccUrl=this._jsonFileUrl):this.url!==this._ccUrl&&(this._ccUrl=this._jsonFileUrl=
this.url);null!=this.data&&null==this._jsonData&&(this._jsonData=this.data,this.data=null);this._jsonFileUrl?this._loadInProgress?this._queuedFetches.push({args:c}):(this._loadInProgress=!0,b=n.get({url:d._jsonFileUrl,handleAs:"json-comment-optional",preventCache:this.urlPreventCache,failOk:this.failOk}),b.addCallback(function(b){var g=c.scope?c.scope:k.global;try{d._getItemsFromLoadedData(b),d._loadFinished=!0,d._loadInProgress=!1,a=d._getItemByIdentity(c.identity),c.onItem&&c.onItem.call(g,a),d._handleQueuedFetches()}catch(r){d._loadInProgress=
!1,c.onError&&c.onError.call(g,r)}}),b.addErrback(function(a){d._loadInProgress=!1;c.onError&&c.onError.call(c.scope?c.scope:k.global,a)})):this._jsonData&&(d._getItemsFromLoadedData(d._jsonData),d._jsonData=null,d._loadFinished=!0,a=d._getItemByIdentity(c.identity),c.onItem&&(b=c.scope?c.scope:k.global,c.onItem.call(b,a)))}},_getItemByIdentity:function(c){var a=null;this._itemsByIdentity?Object.hasOwnProperty.call(this._itemsByIdentity,c)&&(a=this._itemsByIdentity[c]):Object.hasOwnProperty.call(this._arrayOfAllItems,
c)&&(a=this._arrayOfAllItems[c]);void 0===a&&(a=null);return a},getIdentityAttributes:function(c){c=this._features["dojo.data.api.Identity"];return c===Number?null:[c]},_forceLoad:function(){var c=this;this._jsonFileUrl!==this._ccUrl?(k.deprecated(this.declaredClass+": ","To change the url, set the url property of the store, not _jsonFileUrl.  _jsonFileUrl support will be removed in 2.0"),this.url=this._ccUrl=this._jsonFileUrl):this.url!==this._ccUrl&&(this._ccUrl=this._jsonFileUrl=this.url);null!=
this.data&&(this._jsonData=this.data,this.data=null);if(this._jsonFileUrl){var a=n.get({url:this._jsonFileUrl,handleAs:"json-comment-optional",preventCache:this.urlPreventCache,failOk:this.failOk,sync:!0});a.addCallback(function(a){try{if(!0!==c._loadInProgress&&!c._loadFinished)c._getItemsFromLoadedData(a),c._loadFinished=!0;else if(c._loadInProgress)throw Error(this.declaredClass+":  Unable to perform a synchronous load, an async load is in progress.");}catch(g){throw console.log(g),g;}});a.addErrback(function(a){throw a;
})}else this._jsonData&&(c._getItemsFromLoadedData(c._jsonData),c._jsonData=null,c._loadFinished=!0)}});e.extend(p,f);return p})},"dojo/data/util/filter":function(){define(["../../_base/lang"],function(k){var e={};k.setObject("dojo.data.util.filter",e);e.patternToRegExp=function(e,k){for(var n="^",l=null,h=0;h<e.length;h++)switch(l=e.charAt(h),l){case "\\":n+=l;h++;n+=e.charAt(h);break;case "*":n+=".*";break;case "?":n+=".";break;case "$":case "^":case "/":case "+":case ".":case "|":case "(":case ")":case "{":case "}":case "[":case "]":n+=
"\\";default:n+=l}n+="$";return k?new RegExp(n,"mi"):new RegExp(n,"m")};return e})},"dojo/data/util/simpleFetch":function(){define(["../../_base/lang","../../_base/kernel","./sorter"],function(k,e,p){var q={};k.setObject("dojo.data.util.simpleFetch",q);q.errorHandler=function(k,l){l.onError&&l.onError.call(l.scope||e.global,k,l)};q.fetchHandler=function(k,l){var h=l.abort||null,f=!1,d=l.start?l.start:0,c=l.count&&Infinity!==l.count?d+l.count:k.length;l.abort=function(){f=!0;h&&h.call(l)};var a=l.scope||
e.global;l.store||(l.store=this);l.onBegin&&l.onBegin.call(a,k.length,l);l.sort&&k.sort(p.createSortFunction(l.sort,this));if(l.onItem)for(var b=d;b<k.length&&b<c;++b){var g=k[b];f||l.onItem.call(a,g,l)}l.onComplete&&!f&&(b=null,l.onItem||(b=k.slice(d,c)),l.onComplete.call(a,b,l))};q.fetch=function(e){e=e||{};e.store||(e.store=this);this._fetchItems(e,k.hitch(this,"fetchHandler"),k.hitch(this,"errorHandler"));return e};return q})},"dojo/data/util/sorter":function(){define(["../../_base/lang"],function(k){var e=
{};k.setObject("dojo.data.util.sorter",e);e.basicComparator=function(e,k){var n=-1;null===e&&(e=void 0);null===k&&(k=void 0);if(e==k)n=0;else if(e>k||null==e)n=1;return n};e.createSortFunction=function(k,q){function n(a,b,c,d){return function(g,f){g=d.getValue(g,a);f=d.getValue(f,a);return b*c(g,f)}}for(var l=[],h,f=q.comparatorMap,d=e.basicComparator,c=0;c<k.length;c++){h=k[c];var a=h.attribute;if(a){h=h.descending?-1:1;var b=d;f&&("string"!==typeof a&&"toString"in a&&(a=a.toString()),b=f[a]||d);
l.push(n(a,h,b,q))}}return function(a,b){for(var c=0;c<l.length;){var d=l[c++](a,b);if(0!==d)return d}return 0}};return e})},"jimu/Query":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/promise/all dojo/Deferred jimu/utils jimu/ServiceDefinitionManager esri/tasks/query esri/tasks/QueryTask esri/tasks/FeatureSet".split(" "),function(k,e,p,q,n,l,h,f,d,c){var a=k(null,{queryType:0,nextPageIndex:1,pageSizeOption:null,layerDefinition:null,layerDefinitionDef:null,type1CountDef:null,
type2ObjectIdsDef:null,type3QueryDef:null,sdf:null,url:null,query:null,pageSize:1E3,constructor:function(a){this.sdf=h.getInstance();this.url=a.url;this.query=a.query;this.pageSizeOption=a.pageSize;this.query.outFields&&0!==this.query.outFields.length||(this.query.outFields=["*"]);this.pageSize=0<a.pageSize?a.pageSize:1E3;this.getFeatureCount()},getFeatureCount:function(){return this._getQueryType().then(e.hitch(this,function(a){return 1===a?this._getCountForQueryType1():2===a?this._getCountForQueryType2():
this._getCountForQueryType3()}))},getPageCount:function(){return this.getFeatureCount().then(e.hitch(this,function(a){return 0===a?0:3===this.queryType?1:Math.ceil(a/this.pageSize)}))},getAllFeatures:function(){return this.getPageCount().then(e.hitch(this,function(a){if(0<a){for(var b=[],c=1;c<=a;c++)b.push(this.queryByPage(c));return q(b).then(e.hitch(this,function(a){for(var b=[],c=0;c<a.length;c++)a[c].features&&0<a[c].features.length&&(b=b.concat(a[c].features));a=a[0];a.features=b;return a}))}return this._getEmptyFeatureSet()}))},
_getEmptyFeatureSet:function(){var a=new c;a.features=[];a.geometryType=this.layerDefinition.geometryType;a.fields=[];var d=e.clone(this.layerDefinition.fields);0<=this.query.outFields.indexOf("*")?a.fields=d:a.fields=p.filter(d,e.hitch(this,function(a){return 0<=this.query.outFields.indexOf(a.name)}));return a},getCurrentPageIndex:function(){return this.nextPageIndex},queryNextPage:function(){var a=this.nextPageIndex;this.nextPageIndex++;return this.queryByPage(a)},queryByPage:function(a){var b=
null,c=this._getEmptyFeatureSet();0>=a?(b=new n,b.resolve(c)):b=this.getPageCount().then(e.hitch(this,function(b){return a>b?c:1===this.queryType?this._queryPageForType1(a):2===this.queryType?this._queryPageForType2(a):this._queryPageForType3(a)}));return b},_getQueryType:function(){var b=new n;if(0<this.queryType)b.resolve(this.queryType);else return this._getLayerDefinition().then(e.hitch(this,function(b){return this.queryType=a.getQueryType(b)}));return b},_getDefStatus:function(a){return a?a.isFulfilled()?
a.isResolved()?2:-1:1:0},_getLayerDefinition:function(){0>=this._getDefStatus(this.layerDefinitionDef)&&(this.layerDefinitionDef=this.sdf.getServiceDefinition(this.url).then(e.hitch(this,function(a){this.layerDefinition=a;var b=a.maxRecordCount;0<b&&(!(0<this.pageSizeOption)||this.pageSize>a.maxRecordCount)&&(this.pageSize=b);return this.layerDefinition})));return this.layerDefinitionDef},_getCountForQueryType1:function(){0>=this._getDefStatus(this.type1CountDef)&&(this.type1CountDef=this._queryCount());
return this.type1CountDef},_getCountForQueryType2:function(){return this._getObjectIdsForQueryType2().then(e.hitch(this,function(a){return a.length}))},_getObjectIdsForQueryType2:function(){0>=this._getDefStatus(this.type2ObjectIdsDef)&&(this.type2ObjectIdsDef=this._queryIds());return this.type2ObjectIdsDef},_getCountForQueryType3:function(){return this._doQueryForQueryType3().then(e.hitch(this,function(a){return(a.features||[]).length}))},_doQueryForQueryType3:function(){0>=this._getDefStatus(this.type3QueryDef)&&
(this.type3QueryDef=this._query());return this.type3QueryDef},_queryPageForType1:function(a){return this._queryWithPaginationAndOrder((a-1)*this.pageSize)},_queryPageForType2:function(a){return this._getObjectIdsForQueryType2().then(e.hitch(this,function(b){var c=(a-1)*this.pageSize;b=b.slice(c,c+this.pageSize);return this._queryByObjectIds(b)}))},_queryPageForType3:function(a){return this._doQueryForQueryType3().then(e.hitch(this,function(b){var c=e.mixin({},b);c.features=[];var d=(a-1)*this.pageSize;
c.features=(b.features||[]).slice(d,d+this.pageSize);return c}))},_tryLocaleNumber:function(a){var b=l.localizeNumber(a);if(null===b||void 0===b)b=a;return b},_tryLocaleDate:function(a){var b=l.localizeDate(a);b||(b=a.toLocaleDateString());return b},_getLayerIndexByLayerUrl:function(a){var b=a.lastIndexOf("/");a=a.slice(b+1,a.length);return parseInt(a,10)},_getServiceUrlByLayerUrl:function(a){var b=a.lastIndexOf("/");return a.slice(0,b)},_isImageServiceLayer:function(a){return-1<a.indexOf("/ImageServer")},
_isTable:function(a){return"Table"===a.type},_getObjectIdField:function(){return this.layerDefinition.objectIdField},_query:function(a){var b=new f;b.where=a||this.query.where;b.geometry=this.query.geometry;b.outSpatialReference=this.map.spatialReference;b.returnGeometry=this.query.returnGeometry;b.spatialRelationship=this.query.spatialRelationship;b.outFields=this.query.outFields;return(new d(this.url)).execute(b)},_queryIds:function(){var a=new f;a.where=this.query.where;a.geometry=this.query.geometry;
a.returnGeometry=!1;a.spatialRelationship=this.query.spatialRelationship;a.outSpatialReference=this.query.outSpatialReference;return(new d(this.url)).executeForIds(a).then(e.hitch(this,function(a){a||(a=[]);return a}))},_queryByObjectIds:function(a){var b=new n,c=new f;c.returnGeometry=this.query.returnGeometry;c.outSpatialReference=this.query.outSpatialReference;c.spatialRelationship=this.query.spatialRelationship;c.outFields=this.query.outFields;c.objectIds=a;(new d(this.url)).execute(c).then(e.hitch(this,
function(a){b.resolve(a)}),e.hitch(this,function(c){if(400===c.code){var d=this._getObjectIdField(),g="",f=a.length;p.forEach(a,e.hitch(this,function(a,b){g+=d+" \x3d "+a;b!==f-1&&(g+=" OR ")}));this._query(g).then(e.hitch(this,function(a){b.resolve(a)}),e.hitch(this,function(a){b.reject(a)}))}else b.reject(c)}));return b},_queryCount:function(){var a=new f;a.where=this.query.where;a.geometry=this.query.geometry;a.outSpatialReference=this.query.outSpatialReference;a.spatialRelationship=this.query.spatialRelationship;
a.returnGeometry=!1;return(new d(this.url)).executeForCount(a)},_queryWithPaginationAndOrder:function(a){var b=new f;b.where=this.query.where;b.geometry=this.query.geometry;b.outSpatialReference=this.query.outSpatialReference;b.returnGeometry=this.query.returnGeometry;b.spatialRelationship=this.query.spatialRelationship;b.outFields=this.query.outFields;b.start=a;b.num=this.pageSize;(a=this.query.orderByFields)&&0<a.length&&(b.orderByFields=a,a=p.map(a,e.hitch(this,function(a){return a.split(" ")[0]})),
p.forEach(a,e.hitch(this,function(a){0>b.outFields.indexOf(a)&&b.outFields.push(a)})));return(new d(this.url)).execute(b)}});a._isServiceSupportsOrderBy=function(a){var b=!1;a.advancedQueryCapabilities&&a.advancedQueryCapabilities.supportsOrderBy&&(b=!0);return b};a._isServiceSupportsPagination=function(a){var b=!1;a.advancedQueryCapabilities&&a.advancedQueryCapabilities.supportsPagination&&(b=!0);return b};a._isSupportObjectIds=function(a){var b=0;a.currentVersion&&(b=parseFloat(a.currentVersion));
return 10<=b||a.hasOwnProperty("typeIdField")};a.getQueryType=function(b){var c=-1;return c=a._isServiceSupportsOrderBy(b)&&a._isServiceSupportsPagination(b)?1:a._isSupportObjectIds(b)?2:3};return a})},"builder/tokenUtils":function(){define(["jimu/tokenUtils"],function(k){return k})},"builder/utils":function(){define(["dojo/request/xhr","dojo/cookie","jimu/portalUrlUtils","jimu/utils"],function(k,e,p,q){return{appendParamsToAppPath:function(e,l){for(var h in l)l.hasOwnProperty(h)&&(e=0>e.indexOf("?")?
e+"?"+h+"\x3d"+l[h]:e+"\x26"+h+"\x3d"+l[h]);return e},removeActionFromUrl:function(e){return q.url.removeQueryParamFromUrl(e,"action")},checkProtocolAndUpdateSigninInfo:function(n,l){var h=l.portalUrl,f=h,d="https"===p.getProtocol(h);n=!!n.allSSL;d!==n&&n&&(f=p.setHttpsProtocol(h));l.portalUrl=f;return k("/webappbuilder/rest/signininfo/setsignininfo",{handleAs:"json",data:l,method:"POST"}).then(function(c){c.success&&(e("wab_portalurl",f,{path:"/webappbuilder"}),e("wab_portalurl",f,{path:"/webappviewer"}),
e("wab_portalurl_persistent",f,{path:"/",expires:365}));return c})}}})},"builder/PluginManager":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/html dojo/Deferred dojo/Evented dojo/aspect dojo/promise/all jimu/utils".split(" "),function(k,e,p,q,n,l,h,f,d){var c=null,a=k(l,{constructor:function(a){this.loaded=[];a&&(this.pluginsMeta=a)},loadPlugin:function(a){var b=new n,c;a=e.clone(a);if(c=this.getPluginByName(a.name))b.resolve(c);else{if(!1===a.properties.hasClass)return c=
{name:a.name},this.loaded.push(c),b.resolve(c),b;this.loadPluginClass(a).then(e.hitch(this,function(c){this.loadPluginResources(a).then(e.hitch(this,function(d){try{var g=this.createPlugin(a,c,d)}catch(v){console.log("create ["+a.uri+"] error:"+v.stack),b.reject(v)}setTimeout(e.hitch(this,function(){b.resolve(g);this.emit("pluginCreated",g)}),50)}),function(a){b.reject(a)})}),function(a){b.reject(a)})}return b},getExtensions:function(a){var b=[],c;for(c in this.pluginsMeta)for(var d=this.pluginsMeta[c],
f=0;f<d.extensions.length;f++){var e=d.extensions[f];e.point===a&&b.push(e)}return b},getStemappInfo:function(a){for(var b=this.getExtensions("startup.stemapps"),c={},d=0;d<b.length;d++){var f=b[d];if(f.parameters.appType===a){var e=this.pluginsMeta[f.pluginName];c.appPath=f.parameters.appPath?e.folderUrl+f.parameters.appPath:e.folderUrl;c.appVersionManager=f.parameters.appVersionManager;c.appType=a;c.thumbnail=c.appPath+"images/thumbnail.png"}}return c},loadPluginClass:function(a){var b=new n;require([a.uri],
e.hitch(this,function(a){b.resolve(a)}));return b},loadPluginResources:function(a){var b=new n,c,d,h=[];c=this.loadPluginI18n(a);d=this.loadPluginStyle(a);a=this.loadPluginTemplate(a);h.push(c);h.push(a);h.push(d);f(h).then(e.hitch(this,function(a){var c={};c.i18n=a[0];c.template=a[1];c.style=a[2];b.resolve(c)}),function(a){b.reject(a)});return b},createPlugin:function(a,c,d){if(this.getPluginByName(a.name))return this.getPluginByName(a.name);a.nls=d.i18n||{};d.template&&(a.templateString=d.template);
a["class"]="builder-plugin";a.pluginsMeta=this.pluginsMeta;a.pluginManager=this;a=new c(a);h.before(a,"destroy",e.hitch(this,this._onDestroyPlugin,a));this.loaded.push(a);return a},getAllPlugins:function(){return this.loaded},destroyAllPlugins:function(){var a=p.map(this.loaded,function(a){return a.id});p.forEach(a,function(a){this.destroyPlugin(a)},this);this.loaded=[]},getPluginByName:function(a){var b;p.some(this.loaded,function(c){if(c.name===a)return b=c,!0},this);return b},loadPluginStyle:function(a){var b=
"plugin/style/"+a.uri,c=new n;if(!1===a.properties.hasStyle)return c.resolve(null),c;b=this._replaceId(b);return q.byId(b)?(c.resolve("load"),c):d.loadStyleLink(b,a.amdFolder+"css/style.css")},loadPluginI18n:function(a){var b=new n;if(!1===a.properties.hasLocale)return b.resolve(null),b;require(["dojo/i18n!"+a.amdFolder+"nls/strings"],function(a){b.resolve(a)});return b},loadPluginTemplate:function(a){var b=new n;if(!1===a.properties.hasUIFile)return b.resolve(null),b;require(["dojo/text!"+a.amdFolder+
"Plugin.html"],function(a){b.resolve(a)});return b},removePluginStyle:function(a){q.destroy(this._replaceId("plugin/style/"+a.uri))},_remove:function(a){return p.some(this.loaded,function(b,c){if(b.id===a)return this.loaded.splice(c,1),!0},this)},_replaceId:function(a){return a.replace(/\//g,"_").replace(/\./g,"_")},_onDestroyPlugin:function(a){"closed"!==a.state&&this.closePlugin(a);this._removePlugin(a)},_removePlugin:function(a){if("string"===typeof a&&(a=this.getPluginByName(a),!a))return;this.removePluginStyle(a);
this._remove(a.id)}});a.getInstance=function(b){null===c?c=new a(b):b&&(c.pluginsMeta=b);return c};return a})},"builder/plugins/_build-generate_plugins_module":function(){define("builder/plugins/app-actions/launch-app/_build-generate_module builder/plugins/app-actions/preview-app/_build-generate_module builder/plugins/app-actions/save-app/_build-generate_module builder/plugins/app-actions/to-template-config/_build-generate_module builder/plugins/app-config/_build-generate_module builder/plugins/app-config-configpart/_build-generate_module builder/plugins/app-config-morepreview-selectionpart/_build-generate_module builder/plugins/app-config-template-configpart/_build-generate_module builder/plugins/app-config-templateconfig/_build-generate_module builder/plugins/app-list/_build-generate_module builder/plugins/attribute-config/_build-generate_module builder/plugins/creation-entry/_build-generate_module builder/plugins/header/_build-generate_module builder/plugins/map-config/_build-generate_module builder/plugins/popup-actions/configmode-switch/_build-generate_module builder/plugins/popup-actions/popup-agoltemplate/_build-generate_module builder/plugins/popup-actions/popup-saveas/_build-generate_module builder/plugins/popup-actions/popup-share/_build-generate_module builder/plugins/startup/_build-generate_module builder/plugins/stemapps/web2d/_build-generate_module builder/plugins/stemapps/web3d/_build-generate_module builder/plugins/theme-config/_build-generate_module builder/plugins/widget-config/_build-generate_module".split(" "),
function(){})},"builder/plugins/app-actions/launch-app/_build-generate_module":function(){define(["builder/plugins/app-actions/launch-app/Plugin","dojo/text!builder/plugins/app-actions/launch-app/css/style.css","dojo/i18n!builder/plugins/app-actions/launch-app/nls/strings"],function(){})},"builder/plugins/app-actions/launch-app/Plugin":function(){define("dojo/_base/declare dojo/_base/lang dojo/on dojo/topic builder/BasePlugin dojo/_base/html jimu/portalUrlUtils jimu/utils builder/utils".split(" "),
function(k,e,p,q,n,l,h,f,d){return k([n],{baseClass:"plugin-app-actions-launch-app",postCreate:function(){this.inherited(arguments);var c;if(window.isXT)c=window.appInfo.appPath;else{var a=f.urlToObject(window.location.href).query||{};c="HTML3D"===window.appInfo.appType?"webappviewer3d":"webappviewer";var b=window.appInfo.id;"HTML"===b?b="stemapp":"HTML3D"===b&&(b="stemapp3d");c=a.appid?window.portalUrl+"apps/"+c+"/index.html?appid\x3d"+b:window.portalUrl+"apps/"+c+"/index.html?id\x3d"+b;delete a.id;
delete a.appid;delete a.apiurl;delete a.apiurl3d;delete a.edit;delete a.folderid;c=d.appendParamsToAppPath(c,a)}a=l.create("a",{href:c,target:"_blank"},this.domNode);l.create("div",{"class":"footer-button",title:this.nls.label,innerHTML:this.nls.label},a);this._bindEvent()},_bindEvent:function(){this.own(q.subscribe("app/appConfigLoaded",e.hitch(this,this._setAppConfig)));this.own(q.subscribe("app/appConfigChanged",e.hitch(this,this._setAppConfig)))},_setAppConfig:function(c){this.appConfig=c;this.visible=
!c.templateConfig||c.isTemplateApp||c._appData?!0:!1}})})},"builder/BasePlugin":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/topic dijit/_WidgetBase dijit/_TemplatedMixin".split(" "),function(k,e,p,q,n,l){return k([n,l],{id:void 0,folderUrl:null,state:"closed",windowState:"normal",started:!1,name:"",baseClass:null,templateString:"\x3cdiv\x3e\x3c/div\x3e",constructor:function(){this.extensions={};this.own(q.subscribe("publishData",e.hitch(this,this._onReceiveData)));
this.own(q.subscribe("dataFetched",e.hitch(this,this._onReceiveData)));this.own(q.subscribe("noData",e.hitch(this,this._onNoData)))},getPluginsMetaByExtensionPoint:function(e){var f=[];p.forEach(this.extensionPoints[e].extensions,function(d){f.push(this.pluginsMeta[d.pluginName])},this);return f},filterExtensionsByAppType:function(e,f){if(!this.extensionPoints[e].parameters||!this.extensionPoints[e].parameters.supportAppTypes)return this.extensionPoints[e].extensions;var d=[];p.forEach(this.extensionPoints[e].extensions,
function(c){("all"===c.parameters.supportAppTypes||-1<c.parameters.supportAppTypes.indexOf(f))&&d.push(c)},this);return d},onOpen:function(){},onClose:function(){},onNormalize:function(){},onMinimize:function(){},onMaximize:function(){},onSignIn:function(e){},onSignOut:function(){},setState:function(e){this.state=e},setWindowState:function(e){this.windowState=e},resize:function(){},publishData:function(e,f){"undefined"===typeof f&&(f=!1);q.publish("publishData",this.name,this.id,e,f)},fetchData:function(e){e?
q.publish("fetchData",e):0!==this.listenWidgetIds.length?p.forEach(this.listenWidgetIds,function(f){q.publish("fetchData",f)},this):q.publish("fetchData")},fetchDataByName:function(e){e=this.widgetManager.getWidgetsByName(e);p.forEach(e,function(f){this.fetchData(f.id)},this)},_onReceiveData:function(e,f,d,c){if(f!==this.id&&!(0!==this.listenWidgetIds.length&&0>this.listenWidgetIds.indexOf(f)))this.onReceiveData(e,f,d,c)},onReceiveData:function(e,f,d,c){},_onNoData:function(e,f){if(!(0!==this.listenWidgetIds.length&&
0>this.listenWidgetIds.indexOf(f)))this.onNoData(e,f)},onNoData:function(e,f){}})})},"builder/plugins/app-actions/preview-app/_build-generate_module":function(){define(["builder/plugins/app-actions/preview-app/Plugin","dojo/text!builder/plugins/app-actions/preview-app/Plugin.html","dojo/text!builder/plugins/app-actions/preview-app/css/style.css","dojo/i18n!builder/plugins/app-actions/preview-app/nls/strings"],function(){})},"builder/plugins/app-actions/preview-app/Plugin":function(){define("dojo/_base/declare dojo/_base/lang builder/BasePlugin dojo/_base/html dojo/on dojo/topic".split(" "),
function(k,e,p,q,n,l){return k([p],{baseClass:"plugin-app-actions-preview-app",postCreate:function(){this.inherited(arguments);this.own(n(this.domNode,"click",e.hitch(this,this._onClick)));this._bindEvent();this.mode="config"},_onClick:function(){var e=this.pluginManager.getPluginByName("app-config"),f=this.pluginManager.getPluginByName("popup-actions.configmode-switch");"none"===q.getStyle(this.btnConfig,"display")?(e.switchToPreviewMore(),f.visible=!1,q.setStyle(this.btnPreview,"display","none"),
q.setStyle(this.btnConfig,"display","inline-block"),this.mode="preview"):(f.visible=this.appConfig.templateConfig&&this.appConfig.isTemplateApp||this.appConfig.templateConfig&&this.appConfig._appData?!0:!1,f.isAdvance?e.switchToPreviewConfig():e.switchToTemplateConfigPart(),q.setStyle(this.btnPreview,"display","inline-block"),q.setStyle(this.btnConfig,"display","none"),this.mode="config")},_bindEvent:function(){this.own(l.subscribe("app/appConfigLoaded",e.hitch(this,this._setAppConfig)));this.own(l.subscribe("app/appConfigChanged",
e.hitch(this,this._setAppConfig)))},_setAppConfig:function(e){this.appConfig=e}})})},"builder/plugins/app-actions/save-app/_build-generate_module":function(){define(["builder/plugins/app-actions/save-app/Plugin","dojo/text!builder/plugins/app-actions/save-app/Plugin.html","dojo/text!builder/plugins/app-actions/save-app/css/style.css","dojo/i18n!builder/plugins/app-actions/save-app/nls/strings"],function(){})},"builder/plugins/app-actions/save-app/Plugin":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/topic dojo/Deferred dojo/on dojo/promise/all jimu/utils jimu/dijit/Message jimu/dijit/Popup builder/BasePlugin builder/serviceUtils jimu/portalUrlUtils builder/portalUtils".split(" "),
function(k,e,p,q,n,l,h,f,d,c,a,b,g,u){return k([a],{baseClass:"plugin-app-actions-save-app",lastAppConfig:null,disabled:null,boxNodeOfMainAppActionPlugin:null,boxNodeOfSaveAppPluginInConfigTemplatePage:null,_user:null,_itemGroups:null,postMixInProperties:function(){this.inherited(arguments);this.nls=e.mixin(this.nls,builderNls)},postCreate:function(){this.inherited(arguments);var a=g.getStandardPortalUrl(window.portalUrl),c=u.getPortal(a);"HTML"===window.appInfo.id||"HTML3D"===window.appInfo.id?this._blockSaveButton():
(a=c.getUser(),window.isXT?(c=new n,c.resolve()):c=c.getItemById(window.appInfo.id).then(e.hitch(this,function(a){return a.getItemGroups()})),h({user:a,itemGroups:c}).then(e.hitch(this,function(a){this._user=a.user;this._itemGroups=a.itemGroups;b.canSaveApp(this._user,window.appInfo.appOwner,this._itemGroups)||this._blockSaveButton()}),e.hitch(this,function(a){this._blockSaveButton();console.log(a)})));this.own(q.subscribe("app/appConfigChanged",e.hitch(this,this._onAppConfigChanged)));this.own(q.subscribe("app/appConfigLoaded",
e.hitch(this,this._onAppConfigLoaded)));this.own(q.subscribe("closeAppConfigPage",e.hitch(this,this._onLeavePage)));this.own(l(this.domNode,"click",e.hitch(this,this._onClick)));this.label=this.nls.label},_onClick:function(){this.saveApp()},_enableSaveButton:function(){p.addClass(this.actionNode,"save-enable");p.removeClass(this.actionNode,"save-disabled");p.setStyle(this.domNode,"cursor","pointer");p.setAttr(this.actionNode,"innerHTML",this.nls.save);p.setAttr(this.actionNode,"title",this.nls.save);
this.disabled=!1},_disableSaveButton:function(){p.removeClass(this.actionNode,"save-enable");p.addClass(this.actionNode,"save-disabled");p.setStyle(this.domNode,"cursor","default");p.setAttr(this.actionNode,"innerHTML",this.nls.saved);p.setAttr(this.actionNode,"title",this.nls.saved);this.disabled=!0},_blockSaveButton:function(){p.addClass(this.actionNode,"save-block");p.setStyle(this.domNode,"cursor","default")},_onAppConfigLoaded:function(a){this.lastAppConfig=e.clone(a);this._setAppConfig(a)},
_onAppConfigChanged:function(a){this.lastAppConfig||(this.lastAppConfig=e.clone(a));this._setAppConfig(a)},_setAppConfig:function(a){this.appConfig=e.clone(a);this._appHasChanged()?(this._enableSaveButton(),this._enableUnloadDlg()):(this._disableSaveButton(),this._disableUnloadDlg())},_appHasChanged:function(){if(!b.canSaveApp(this._user,window.appInfo.appOwner,this._itemGroups)||!this.appConfig)return!1;var a=e.clone(this.appConfig.getCleanConfig()),c=e.clone(this.lastAppConfig.getCleanConfig());
a.theme&&a.theme.styles&&c.theme&&c.theme.styles&&(a.theme.styles.splice(1,a.theme.styles.length),c.theme.styles.splice(1,c.theme.styles.length));return!f.isEqual(a,c)},saveApp:function(){var a=new n;this._appHasChanged()?(p.setAttr(this.actionNode,"innerHTML",this.nls.saving),p.setAttr(this.actionNode,"title",this.nls.saving),this._saveApp().then(e.hitch(this,function(b){b.success?(this._disableSaveButton(),this._disableUnloadDlg(),a.resolve()):a.reject()}),e.hitch(this,function(b){this._enableSaveButton();
a.reject(b)}))):a.resolve();return a},_saveApp:function(){var a=new n,c=this.appConfig;b.saveApp(window.appInfo.id,c.getCleanConfig()).then(e.hitch(this,function(b){b.success?(this.lastAppConfig=e.clone(c),a.resolve(b),(b=this.pluginManager.getPluginByName("app-list"))&&window.isXT&&b.refreshAppPage()):(new d({message:this.nls.saveFailedMeg+": "+b.message}),a.reject())}),e.hitch(this,function(b){new d({message:this.nls.saveFailedMeg});console.error(b);a.reject()}));return a},_enableUnloadDlg:function(){window.onbeforeunload=
e.hitch(this,function(){return this.nls.theApp+' "'+this.options.name+'" '+this.nls.unloadMessage})},_disableUnloadDlg:function(){window.onbeforeunload=null},_onLeavePage:function(a){var b=this.pluginManager.getPluginByName("header");if(this._appHasChanged())var d=new c({content:"\x3cdiv style\x3d'font-size: 14px'\x3e\x3cimg class\x3d'alert-image jimu-float-leading'  src\x3d'"+this.folderUrl+"css/images/alert.png'  style\x3d'margin-left:20px;margin-right:20px;'\x3e\x3c/img\x3e\x3cspan style\x3d'display:inline-block;width:285px'\x3e"+
this.nls.unSaveMegBegin+this.options.name+this.nls.unSaveMegEnd+"\x3c/span\x3e\x3c/div\x3e",titleLabel:this.nls.toHomeTitle,width:525,height:180,buttons:[{label:this.nls.save,onClick:e.hitch(this,function(){this._saveApp().then(e.hitch(this,function(c){d.close();c.success&&(window.onbeforeunload=null,b.setAppName(""),a())}),e.hitch(this,function(a){console.error(this.nls.saveFailedMeg,a)}))})},{label:this.nls.doNotSave,onClick:e.hitch(this,function(){d.close();window.onbeforeunload=null;b.setAppName("");
a()})},{label:this.nls.cancel,classNames:["jimu-btn-vacation"],onClick:e.hitch(this,function(){d.close()})}]});else window.onbeforeunload=null,a()}})})},"builder/serviceUtils":function(){define("dojo/_base/lang dojo/request/xhr dojo/Deferred dojo/json dojo/_base/array jimu/utils jimu/portalUrlUtils jimu/portalUtils jimu/appConfigResourceUtils jimu/ConfigLoader jimu/Role builder/portalUtils dojo/promise/all builder/tokenUtils".split(" "),function(k,e,p,q,n,l,h,f,d,c,a,b,g,u){function m(a){return e("/webappbuilder/rest/signininfo/getsignininfo",
{query:{portalUrl:a},handleAs:"json"})}function r(a){var b=[];a&&0<a.length&&n.forEach(a,function(a){a&&"string"===typeof a&&(a=h.getServerByUrl(a),b.push(a))});return b}function t(a,b,c,d,g,f){b.title=a.name;b.isWebTier=f;b.authorizedCrossOriginDomains=r(g.authorizedCrossOriginDomains);b.portalUrl=c;b.map.itemId=d;b.geometryService=g.helperServices.geometry.url;b.map.mapOptions||(b.map.mapOptions={});"HTML"!==a.appType||a.webmap||(b.map.mapOptions.extent=g.defaultExtent);a="/proxy.js";window.isXT||
(a=h.getPortalProxyUrl(b.portalUrl),a=h.removeProtocol(a));b.httpProxy={useProxy:!0,url:a};g.portalProperties&&g.portalProperties.sharedTheme?(a=g.portalProperties.sharedTheme.header.background?!0:!1,g=g.portalProperties.sharedTheme.logo.small?!0:!1,b.theme?(b.theme.sharedTheme={isPortalSupport:!0,useHeader:a,useLogo:g},a&&(g=b.theme.styles.pop(),b.theme.styles.unshift(g))):b.theme={sharedTheme:{isPortalSupport:!0,useHeader:a,useLogo:g}}):b.theme?b.theme.sharedTheme={isPortalSupport:!1,useHeader:!1,
useLogo:!1}:b.theme={sharedTheme:{isPortalSupport:!1,useHeader:!1,useLogo:!1}}}function v(a,c,d){var g=new p,f=new p,e={title:a.name,type:"Web Mapping Application",typeKeywords:"Web AppBuilder, Ready To Use, JavaScript, "+("HTML"===a.appType?"WAB2D":"WAB3D"),text:q.stringify(c),snippet:a.description,tags:a.tags},m=h.getStandardPortalUrl(window.portalUrl),l=b.getPortal(m);l.getUser().then(function(b){a.folderId===b.username&&(a.folderId="");var c={q:"owner:"+b.username+" title:"+e.title+' type:"Web Mapping Application"'};
d?f.resolve(b):l.queryItems(c).then(function(a){0<a.total?(f.reject(),g.resolve({success:!1,unsuccessCode:"01-01"})):f.resolve(b)},function(a){f.reject();g.reject(a)})},function(a){f.reject();g.reject(a)});f.then(function(b){b.addItem(e,a.folderId).then(function(d){if(d.success){if(d.user=b,g.resolve(d),!(c.appConfig&&c.appConfig.templateConfig&&c.appConfig._appData)){var f=h.getStandardPortalUrl(window.portalUrl),f=h.getItemUrl(f,d.id),f=h.removeProtocol(f);b.addItem({title:a.name,type:"Code Attachment",
typeKeywords:"Code, Web Mapping Application, Javascript",relationshipType:"WMA2Code",originItemId:d.id,url:f+"/package"},a.folderId).then(function(a){a.success||console.error(builderNls.createCodeAttachmentError)},function(a){console.error(builderNls.createCodeAttachmentError,a.message)})}}else g.resolve(d)},function(a){g.reject(a)})});return g}function y(a){var b=new p;e(window.stemappInfo.name+"/"+a+"/list.json",{handleAs:"json"}).then(function(c){return w(c,a).then(function(a){b.resolve({success:!0,
manifests:a})})},function(a){b.reject({success:!1,message:a.message})});return b}function w(a,b){var c=[],d=new p;a._buildInfo&&a._buildInfo.manifestsMerged?e(window.stemappInfo.name+"/"+b+"/"+b+"-manifest-builder.json",{handleAs:"json"}).then(function(f){var m=[];n.forEach(a[b],function(a){var d;(d="themes"===b?f["themes/"+a+"/main"]:f["widgets/"+a+"/Widget"])?m.push(d):c.push(e(window.stemappInfo.name+"/"+b+"/"+a+"/manifest.json",{handleAs:"json"}))});g(c).then(function(a){m=m.concat(a);z(m,b).then(function(){d.resolve(m)})})}):
(n.forEach(a[b],function(a){c.push(e(window.stemappInfo.name+"/"+b+"/"+a+"/manifest.json",{handleAs:"json"}))}),g(c).then(function(a){z(a,b).then(function(){d.resolve(a)})}));return d}function z(a,b){var c=[],d=new p;n.forEach(a,function(a){a.isRemote||(a.category="widgets"===b?"widget":"theme",k.mixin(a,l.getUriInfo(a.category+"s/"+a.name+"/Widget.js")));c.push(x(a))});g(c).then(function(){d.resolve()},function(a){d.reject(a)});return d}function x(a){return l.manifest.addI18NLabel(a).then(function(){l.manifest.addManifestProperies(a);
l.manifest.processManifestLabel(a,window.dojoConfig.locale);return a})}var A={},C=["HTML","HTML3D"];A.checkAppVersion=function(a,b){var c=new p;e("/webappbuilder/rest/apps/checkVersion",{method:"POST",data:{appConfig:q.stringify(a),appType:b.appType},handleAs:"json"}).then(k.hitch(this,function(a){a.success?c.resolve(a):c.reject(a)}),k.hitch(this,function(a){c.reject(a)}));return c.promise};A.importPortalApp=function(a,b){var c=new p;delete a.agolTemplateInfo;e("/webappbuilder/rest/apps/importportalapp",
{method:"POST",handleAs:"json",data:{appConfig:q.stringify(a),appInfo:q.stringify(b)}}).then(k.hitch(this,function(a){a.success?c.resolve(a):c.reject(a)}),k.hitch(this,function(a){c.reject(a)}));return c.promise};A.getTemplateList=function(a){var c=new p,d=h.getStandardPortalUrl(window.portalUrl),g;isXT?(g=b.getPortal(d),g.getUser().then(function(b){e((a?"/webappbuilder/rest/apps/templatelist?portalUrl\x3d"+d:"/webappbuilder/rest/apps/templatelist?username\x3d"+b.username+"\x26portalUrl\x3d"+d)+"\x26locale\x3d"+
dojoConfig.locale,{handleAs:"json"}).then(function(a){c.resolve(a)},function(a){c.reject(a)})},function(a){c.reject(a)})):c.resolve([]);return c};A.getAppList=function(){var a=new p,c=h.getStandardPortalUrl(window.portalUrl),d;isXT?(d=b.getPortal(c),d.getUser().then(function(b){e("/webappbuilder/rest/apps/list?username\x3d"+b.username+"\x26portalUrl\x3d"+c,{handleAs:"json"}).then(function(b){a.resolve(b)},function(b){a.reject(b)})},function(b){a.reject(b)})):(d=b.getPortal(c))?d.getUser().then(function(b){b.getItemsByKeywords("Web AppBuilder").then(function(b){var c=
[];(b=b&&b.results)&&0<b.length&&(c=n.map(b,function(a){return{name:a.title,description:a.description,id:a.id}}));a.resolve(c)},function(b){console.error(b);a.reject({success:!1,message:""})})},function(b){console.error(b);a.reject({success:!1,message:""})}):a.reject({success:!1,message:""});return a};A.getAppInfo=function(a){var c=new p;if(isXT)return-1<C.indexOf(a)?(c.resolve({id:a,appType:a,name:"stem app"}),c):e("/webappbuilder/rest/apps/"+a,{handleAs:"json"});var d=h.getStandardPortalUrl(window.portalUrl);
if(-1<C.indexOf(a))return c.resolve({id:a,appType:a,name:"stem app"}),c;b.getPortal(d).getItemById(a).then(function(a){var b;b=0<=a.typeKeywords.indexOf("Web AppBuilder")?0<=a.typeKeywords.indexOf("WAB3D")?"HTML3D":"HTML":a.url&&0<=a.url.indexOf("webappviewer3d")?"HTML3D":"HTML";c.resolve({name:a.title,description:a.description,id:a.id,owner:a.owner,appType:b})});return c};A.updateApp=function(a){var c=new p,d=h.getStandardPortalUrl(window.portalUrl);isXT?b.getPortal(d).getUser().then(function(b){e("/webappbuilder/rest/apps/updateapp",
{handleAs:"json",method:"POST",data:{id:a.id,name:a.name,description:a.description,modified:b.username||"",creator:a.creator,thumbnail:a.thumbnail,icon:a.icon,portalUrl:d}}).then(function(a){c.resolve(a)},function(a){c.reject(a)})},function(a){c.reject(a)}):c.resolve({success:!0});return c};A.createApp=function(a){var c=new p,d,f=h.getStandardPortalUrl(window.portalUrl),l=b.getPortal(f);d=l.loadSelfInfo();var n=l.getUser(),l=null;a.webmap?(l=new p,l.resolve(a.webmap)):a.webscene?(l=new p,l.resolve(a.webscene)):
l="HTML3D"===a.appType?b.getDefaultWebScene(f):b.getDefaultWebMap(f);if(isXT){var r=m(f);d=[d,n,l,r];g(d).then(function(b){var d=b[0],g=b[1],m=b[2];b=b[3];var l={map:{}};t(a,l,h.getStandardPortalUrl(b.info.portalUrl),m,d,b.info.isWebTier?!0:!1);e("/webappbuilder/rest/apps/createapp",{handleAs:"json",method:"POST",data:{name:a.name,description:a.description,creator:g.username||"",modified:g.username||"",extraPropertyOfAppConfig:JSON.stringify(l),portalUrl:f,fromAppId:a.fromAppId,icon:a.icon,thumbnail:a.thumbnail}}).then(function(a){c.resolve(a)},
function(a){c.reject(a)})},function(a){console.error(a);c.reject({success:!1,message:builderNls.createError})})}else n=A.getPredefinedAppConfig(),r=u.isWebTierPortal(f),d=[d,n,l,r],g(d).then(function(b){var d=b[1];t(a,d,f,b[2],b[0],b[3]);v(a,d,!0).then(function(b){var d=h.getStandardPortalUrl(window.portalUrl);if(b.success)c.resolve({success:!0,newAppId:b.id}),setTimeout(k.hitch(this,function(){b.user.updateItem(b.id,{url:"HTML3D"===a.appType?d+"/apps/webappviewer3d/index.html?id\x3d"+b.id:d+"/apps/webappviewer/index.html?id\x3d"+
b.id}).then(function(a){a.success||console.error(builderNls.createUrlError)},function(a){console.error(builderNls.createUrlError,a.message||"")})}),2E3);else{var g=builderNls.titleExist.replace("${TITLE}",a.name),f;f=a.webmap?d+"/home/webmap/viewer.html?webmap\x3d"+a.webmap:a.webscene?d+"/home/webscene/viewer.html?webmap\x3d"+a.webscene:d+"/home/content.html";switch(b.unsuccessCode){case "01-01":c.resolve({success:!1,message:g,href:f});console.error(builderNls.createError,g);break;default:c.resolve({success:!1,
message:builderNls.createError,href:f}),console.error(builderNls.createError,builderNls.addItemUnsuccess)}}},function(a){c.reject({success:!1,message:builderNls.createError});console.error(builderNls.createError,a.message||"")})},function(a){c.reject({success:!1,message:builderNls.createError});console.error(builderNls.createError,a.message||"")});return c};A.duplicateApp=function(a){var c=new p,d=h.getStandardPortalUrl(window.portalUrl);isXT?b.getPortal(d).getUser().then(function(b){e("/webappbuilder/rest/apps/duplicateapp",
{handleAs:"json",method:"POST",data:{fromAppId:a.fromAppId,creator:b.username||"",modified:b.username||"",portalUrl:d}}).then(function(a){c.resolve(a)},function(a){c.reject(a)})},function(a){console.error(builderNls.createError,a);c.reject({message:builderNls.createError})}):c.resolve();return c};A.saveAs=function(a,c){var f=new p,m=h.getStandardPortalUrl(window.portalUrl),l=b.getPortal(m),n=c.getCleanConfig?k.clone(c.getCleanConfig()):k.clone(c);if(isXT)b.getPortal(m).getUser().then(function(b){e("/webappbuilder/rest/apps/"+
a.fromAppId+"/saveas",{handleAs:"json",method:"POST",data:{name:a.name,description:a.description,fromAppId:a.fromAppId,creator:b.username||"",modified:b.username||"",portalUrl:m,appConfig:q.stringify(n),saveAsTemplate:a.saveAsTemplate,thumbnail:a.thumbnail}}).then(function(a){f.resolve(a)},function(a){f.reject(a)})},function(a){console.error(builderNls.createError,a);f.reject({message:builderNls.createError})});else{delete n.agolTemplateInfo;var r=A.switchImageFormatOfAppConfig({appConfig:n}),t=new p,
u=h.getStandardPortalUrl(window.portalUrl),w;c.templateConfig&&c._appData?l.getItemData(a.fromAppId).then(function(b){w="HTML3D"===a.appType?u+"/apps/webappviewer3d/index.html?appid\x3d":u+"/apps/webappviewer/index.html?appid\x3d";b.appConfig=n;b.values.app_title=n.title;b.values.app_subtitle=n.subtitle;b.values.webmap=n.map.itemId;t.resolve(b)},function(a){t.reject({success:!1,message:a.message})}):(w="HTML3D"===a.appType?u+"/apps/webappviewer3d/index.html?id\x3d":u+"/apps/webappviewer/index.html?id\x3d",
t.resolve(n));c=l.getItemById(a.fromAppId);g({itemData:t,item:c}).then(function(b){var c=b.itemData,g=b.item;v(a,c).then(function(b){if(b.success)d.AddResourcesToItemForAppSave(window.portalUrl,r.result,c.appItemId,b.id).then(function(){f.resolve({success:!0,newAppId:b.id})},function(a){f.reject({success:!1,message:builderNls.saveAsError});console.error(builderNls.saveAsError,a.message||"")}),setTimeout(k.hitch(this,function(){w+=b.id;c.appItemId=b.id;b.user.updateItem(b.id,{url:w,typeKeywords:g.typeKeywords.join(","),
text:q.stringify(c)}).then(function(a){},function(a){console.error(builderNls.duplicateUrlError,a.message||"")})}),2E3);else{var e=builderNls.titleExist.replace("${TITLE}",a.name);switch(b.unsuccessCode){case "01-01":f.resolve({success:!1,message:e});console.error(builderNls.saveAsError,e);break;default:f.resolve({success:!1,message:builderNls.saveAsError}),console.error(builderNls.saveAsError,builderNls.addItemUnsuccess)}}},function(a){f.reject({success:!1,message:builderNls.saveAsError});console.error(builderNls.saveAsError,
a.message||"")})},function(a){f.reject({success:!1,message:builderNls.saveAsError});console.error(builderNls.saveAsError,a.message||"")})}return f};A.removeApp=function(a){if(isXT)return e("/webappbuilder/rest/apps/removeapp",{handleAs:"json",method:"POST",data:{id:a}})};A.saveApp=function(a,c){var f=new p,l=h.getStandardPortalUrl(window.portalUrl),t=b.getPortal(l),u=t.getUser(),w;c.authorizedCrossOriginDomains=r(t.authorizedCrossOriginDomains);isXT?(w=m(l),g({user:u,signininfo:w}).then(function(b){c.portalUrl=
h.getStandardPortalUrl(b.signininfo.info.portalUrl);e("/webappbuilder/rest/apps/"+a+"/saveconfig",{data:{appConfig:q.stringify(c),modified:b.user.username},method:"POST",handleAs:"json"}).then(function(a){f.resolve(a)},function(a){f.reject(a)})},function(a){f.reject(a)})):u.then(function(b){t.getItemData(a).then(function(g){var e,m;c.templateConfig&&c._appData?(e=g.appConfig,m=g,m.appConfig=c,m.values.app_title=c.title,m.values.app_subtitle=c.subtitle,m.values.webmap=c.map.itemId):(e=g,m=c);g=A.switchImageFormatOfAppConfig({appConfig:m});
var h=[],r=[];n.forEach(g.result,function(a){a.b64&&r.push(a);h.push(a.resUrl)});d.AddResourcesToItemForAppSave(l,r,window.appInfo.id).then(k.hitch(this,function(){A.removeUnusedResources(h,l,a).then(k.hitch(this,function(){c.agolTemplateInfo=e?e.agolTemplateInfo:null;c.portalUrl=l;m.appItemId=a;b.updateItem(a,{text:q.stringify(m)}).then(function(a){f.resolve({success:!0,newAppId:a.id})})}),function(a){f.reject({success:!1,message:a.message})})}),function(a){f.reject({success:!1,message:a.message})})});
t.getItemById(a,!0).then(k.hitch(this,function(c){c.url&&""!==c.url?c=c.url:(c=h.getStandardPortalUrl(window.portalUrl),c="HTML3D"===window.appInfo.appType?c+"/apps/webappviewer3d/index.html?id\x3d"+a:c+"/apps/webappviewer/index.html?id\x3d"+a,b.updateItem(a,{url:c}).then(function(a){}))}))},function(a){f.reject({success:!1,message:a.message})});return f};A.getPredefinedAppConfig=function(){return e(window.stemappInfo.name+"/predefined-apps/default/config.json",{handleAs:"json"})};A.copyThemeToApp=
function(a,b,c){if(isXT)return-1<C.indexOf(a)?(a=new p,a.resolve({success:!0}),a):e("/webappbuilder/rest/apps/"+a+"/copytheme",{handleAs:"json",method:"POST",data:{themeName:b,layoutConfig:JSON.stringify(c)}});a=new p;a.resolve({success:!0});return a};A.copyWidgetToApp=function(a,b){var c=new p;if(b.isRemote)return c.resolve({success:!0}),c;if(isXT)return-1<C.indexOf(a)?(c=new p,c.resolve({success:!0}),c):e.post("/webappbuilder/rest/apps/"+a+"/copywidget",{data:{widgetName:b.name},handleAs:"json"});
c=new p;c.resolve({success:!0});return c};A.getAllThemes=function(){if(isXT)return e("/webappbuilder/rest/themes/search?q\x3d"+JSON.stringify({platform:window.stemappInfo.appType}),{handleAs:"json"}).then(function(a){n.forEach(a.themes,function(a){l.manifest.processManifestLabel(a,window.dojoConfig.locale)},this);return a});var a=new p;y("themes").then(function(b){n.forEach(b.manifests,function(a){l.manifest.processManifestLabel(a,window.dojoConfig.locale)},this);a.resolve({success:!0,themes:b.manifests})},
function(b){a.reject(b)});return a};A.searchWidgets=function(a){if(isXT)return e("/webappbuilder/rest/widgets/search?q\x3d"+JSON.stringify(a),{handleAs:"json"}).then(function(a){a.widgets&&a.widgets.forEach(function(a){k.mixin(a,l.getUriInfo("widgets/"+a.name+"/Widget"));l.manifest.processManifestLabel(a,window.dojoConfig.locale)});a.widgets=a.widgets.sort(function(a,b){return a.label.localeCompare(b.label,window.dojoConfig.locale)});if(!h.isOnline(window.portalUrl)){var b=!0;window.portalVersion&&
0<=f.comparePortalVersion(window.portalVersion,"3.10")&&(b=!1);var c=n.filter(a.widgets,function(a){return"Analysis"===a.name&&b?!1:!0});a.widgets=c}return a});var b=new p;y("widgets").then(function(c){var d=[];n.forEach(c.manifests,function(b){if("undefined"===typeof a["properties.inPanel"]||a["properties.inPanel"]===b.properties.inPanel)a.support2D!==b.support2D&&a.support3D!==b.support3D||d.push(b)});d=d.sort(function(a,b){return a.label.localeCompare(b.label,window.dojoConfig.locale)});b.resolve({success:!0,
widgets:d})},function(a){b.reject(a)});return b};A.getManifestFromItem=function(a){var b=l.widgetJson.getFolderUrlFromItem(a)+"manifest.json";return e(b,{handleAs:"json",headers:{"X-Requested-With":null}}).then(function(b){b.isRemote=!0;b.category="widget";b.itemId=a.id;k.mixin(b,l.getUriInfo(l.widgetJson.getUriFromItem(a)));return x(b)})};A.saveAgolTemplate=function(a,c){var d=new p,g=h.getStandardPortalUrl(window.portalUrl);if(isXT)e("/webappbuilder/rest/apps/updateagoltemplateinapp",{handleAs:"json",
method:"POST",data:{id:a.id,agolTemplateInfo:q.stringify(c)}}).then(k.hitch(this,function(a){!0===a.success?d.resolve():(console.error("The response of save agol template is 'unsuccess'!"),d.reject("The response of save agol template is 'unsuccess'!"))}),function(a){console.error(a.message||a);d.reject("Save AGOLTemplate failed!")});else{var f=b.getPortal(g);f.getUser().then(function(b){f.getItemData(a.id).then(function(g){delete g.agolTemplateJson;g.agolTemplateInfo=c;b.updateItem(a.id,{text:q.stringify(g)}).then(function(){d.resolve()},
function(a){console.error(a.message||a);d.reject("Save AGOLTemplate failed when updateItem!")})},function(a){console.error(a.message||a);d.reject("Save AGOLTemplate failed when get app's itemData!")})},function(a){console.error(a.message||a);d.reject("Save AGOLTemplate failed when get current user!")})}return d};A.canSaveApp=function(b,c,d){var g=!1;if(b){var f=new a({id:b.roleId?b.roleId:b.role,role:b.role});b.privileges&&f.setPrivileges(b.privileges);if(window.isXT)f.isAdmin()?g=!0:b.username===
c&&(g=!0);else if(f.isAdmin())g=!0;else if(b.username===c&&f.canCreateItem())g=!0;else if(f.canCreateItem()){var e;e=d?[].concat(d.admin,d.member,d.other):[];n.some(b.groups,function(a){return-1<a.capabilities.indexOf("updateitemcontrol")?n.some(e,function(b){return a.id===b.id?g=!0:!1}):!1})}}return g};A.switchImageFormatOfAppConfig=function(a,d){function g(a,b){var c=a.obj,d=a.key;"number"===typeof a.i?c[d][a.i]=b:c[d]=b}function f(a){return/^https?:\/\/(.)+\/sharing\/rest\/content\/items/.test(a)}
function e(a,b){a=c.getInstance().processItemIdAndTokenOfResources(b.value,a);return l.getBase64Data(a).then(function(a){g(b,a)})}var m=a.appConfig;a=a.appId?a.appId:window.appInfo.id;var n=h.getStandardPortalUrl(window.portalUrl),r={},p={appId:a,portalUrl:n};if("import"===d)return r={test:f,func:k.hitch(this,e,p)},b.getPortal(n).getItemById(a).then(k.hitch(this,function(a){p.isPublic="public"===a.access;return l.processItemResourceOfAppConfig(m,r)}));r={test:function(a){return/^data:image\/(png|jpg|jpeg|gif);base64,/.test(a)||
/^https?:\/\/(.)+\/sharing\/rest\/content\/items/.test(a)},func:k.hitch(this,function(a,b){if(/^data:image\/(png|jpg|jpeg|gif);base64,/.test(b.value)){var c=b.value.match(/^data:image\/(png|jpg|jpeg|gif)/)[1],c="."+c,d=l.getRandomString();a=h.getItemResourceUrl(a.portalUrl,"${itemId}","inConfig/"+(d+c));g(b,a);return{resUrl:a,b64:b.value}}if(/^https?:\/\/(.)+\/sharing\/rest\/content\/items/.test(b.value))return a=b.value,/(\?|\&)token=.+/.test(a)&&(a=a.replace(/(\?|\&)token=.+/,"")),g(b,a.replace(/items\/.+\/resources/,
"items/${itemId}/resources")),{resUrl:a}},p)};return l.processItemResourceOfAppConfig(m,r)};A.removeUnusedResources=function(a,c,d){a=a?a:[];0!==a.length&&(a=n.map(a,function(a){/(\?|\&)token=.+/.test(a)&&(a=a.replace(/(\?|\&)token=.+/,""));return a.split("resources/")[1]}));return b.getItemResources(c,d).then(function(f){f=n.map(f,function(a){return a.resource});f=l.subtractionArray(f,a);if(0===f.length)return f=new p,f.resolve(),f;if(f instanceof Array&&0<f.length)return f=n.map(f,function(a){return b.removeResources(c,
d,a)}),g(f).then(function(a){if(a instanceof Array&&0<a.length&&a[0].success)return a})})};return A})},"jimu/appConfigResourceUtils":function(){define(["dojo/Deferred","dojo/promise/all","jimu/portalUtils","jimu/utils"],function(k,e,p,q){return{AddResourcesToItemForAppSave:function(n,l,h,f){l=l||[];if(0===l.length){var d=new k;d.resolve(l);return d}l=l.map(function(c){var a=c.resUrl.split("resources/")[1],b=new k;c.b64?(c=q.b64toBlob(c.b64),b.resolve({blob:c,fileName:a.split("/")[1],prefixName:a.split("/")[0]})):
(c=c.resUrl,0<c.indexOf("${itemId}")&&(c=c.replace("${itemId}",h)),q.resourcesUrlToBlob(c).then(function(c){b.resolve({blob:c,fileName:a.split("/")[1],prefixName:a.split("/")[0]},function(a){console.error(a.message||a);b.reject(a)})}));return b});return e(l).then(function(c){if(c instanceof Array&&0<c.length)return c=c.map(function(a){var b=h;f&&(b=f);return p.addResource(n,b,a.blob,a.fileName,a.prefixName)}.bind(this)),e(c).then(function(a){return a})}.bind(this))}}})},"jimu/ConfigLoader":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/html dojo/_base/config dojo/cookie dojo/Deferred dojo/promise/all dojo/request/xhr ./utils ./WidgetManager ./shared/utils ./tokenUtils ./portalUtils ./appConfigResourceUtils ./portalUrlUtils ./AppStateManager esri/IdentityManager esri/config esri/urlUtils esri/arcgis/utils".split(" "),
function(k,e,p,q,n,l,h,f,d,c,a,b,g,u,m,r,t,v,y,w,z){var x=null,A;A=k(null,{urlParams:null,appConfig:null,rawAppConfig:null,configFile:null,_configLoaded:!1,portalSelf:null,constructor:function(b,c){this._removeHash(b);this.urlParams=b||{};this.widgetManager=a.getInstance();e.mixin(this,c)},loadConfig:function(){console.time("Load Config");return this._tryLoadConfig().then(e.hitch(this,function(a){var b=this.checkConfig(a);if(b)throw Error(b);this.rawAppConfig=e.clone(a);t.getInstance().setRawAppConfig(this.rawAppConfig);
a=this._upgradeAppConfig(a);this._processAfterTryLoad(a);this.appConfig=a;if(this.urlParams.id)return this.loadWidgetsManifest(a).then(e.hitch(this,function(){return this.loadAndUpgradeAllWidgetsConfig(a)})).then(e.hitch(this,function(a){return this.updateNecessaryAttrOfResourceUrlInAppConfig(a,this.urlParams.id)})).then(e.hitch(this,function(){this._configLoaded=!0;this._setDocumentTitle(a);this._readAndSetSharedTheme(a);return this.getAppConfig()}));g.setPortalUrl(a.portalUrl);z.arcgisUrl=r.getBaseItemUrl(a.portalUrl);
return this._proesssWebTierAndSignin(a).then(e.hitch(this,function(){return this.urlParams.appid?window.appInfo.isRunInPortal?this._getAppConfigFromTemplateAppId(a.portalUrl,this.urlParams.appid).then(e.hitch(this,function(a){this._tryUpdateAppConfigByLocationUrl(a);return this._processInPortalAppProtocol(a)})):this._processNotInPortalAppProtocol(a).then(e.hitch(this,function(a){return this._getAppDataAddTemplateDataFromTemplateAppId(a.portalUrl,this.urlParams.appid).then(e.hitch(this,function(b){b.appData.appConfig&&
(a=b.appData.appConfig);a._appData=b.appData;a.templateConfig=b.templateData;a.isTemplateApp=!0;return a}))})):this._processNotInPortalAppProtocol(a)})).then(e.hitch(this,function(a){this._processAfterTryLoad(a);this.appConfig=a;return a.map.itemId?a:(a.map["3D"]?u.getDefaultWebScene(a.portalUrl):u.getDefaultWebMap(a.portalUrl)).then(function(b){a.map.itemId=b;return a})})).then(e.hitch(this,function(a){return this.loadWidgetsManifest(a)})).then(e.hitch(this,function(a){return a._appData?a._appData.values&&
a._appData.values.webmap?u.getPortal(a.portalUrl).getItemById(a._appData.values.webmap).then(e.hitch(this,function(b){return c.template.mergeTemplateAppConfigToAppConfig(a,a._appData,b)})):c.template.mergeTemplateAppConfigToAppConfig(a,a._appData):a})).then(e.hitch(this,function(a){return this.loadAndUpgradeAllWidgetsConfig(a)})).then(e.hitch(this,function(a){return a._wabAppId?this.processResourceInAppConfigForConfigLoader(a,this.urlParams):a.appItemId&&-1<window.JSON.stringify(a).indexOf("${itemId}")?
this.updateNecessaryAttrOfResourceUrlInAppConfig(a,a.appItemId):a})).then(e.hitch(this,function(a){this.appConfig=a;this._configLoaded=!0;this._setDocumentTitle(a);this._readAndSetSharedTheme(a);return this.getAppConfig()}))}),e.hitch(this,function(a){this.showError(a);var b=new h;b.reject(a);return b}))},processResourceInAppConfigForConfigLoader:function(a,b){var c=a.portalUrl,d=a.appItemId,g=b.appid,f=new h,l=e.clone(a);this.updateNecessaryAttrOfResourceUrlInAppConfig(l,g).then(function(){if("config"===
b.mode){var e=this.getResourceUrlsOfAppConfig(a).result;0!==e.length?u.getItemResources(c,g).then(function(a){if(0===a.length)return e=e.map(function(a){return{resUrl:a}}),m.AddResourcesToItemForAppSave(c,e,d,g).then(function(){f.resolve(l)},function(a){console.warn("Add resource to template based app error:"+a.message||a);f.resolve(l)});f.resolve(l)},function(a){console.warn("Get resource of template based item error:"+a.message||a);f.resolve(l)}):f.resolve(l)}else f.resolve(l)}.bind(this),function(a){console.warn("Insert appId to resource url of appConfig error:"+
a.message||a);f.resolve(l)});return f},getResourceUrlsOfAppConfig:function(a){var b={test:function(a){return/^https?:\/\/(.)+\/sharing\/rest\/content\/items/.test(a)},func:e.hitch(this,function(a){return a.value})};return c.processItemResourceOfAppConfig(a,b)},updateNecessaryAttrOfResourceUrlInAppConfig:function(a,b){function d(a){return/^https?:\/\/(.)+\/sharing\/rest\/content\/items/.test(a)}function g(a,b){a=m.processItemIDAndTokenOfResources(b.value,a);a=m.setResouceProtocolForHttps(a);var c=
b.obj,d=b.key;"number"===typeof b.i?c[d][b.i]=a:c[d]=a;return!0}var f=a.portalUrl,m=this;return u.getPortal(f).getItemById(b).then(e.hitch(this,function(m){m={test:d,func:e.hitch(this,g,{appId:b,isPublic:"public"===m.access,portalUrl:f})};return c.processItemResourceOfAppConfig(a,m).appConfig}))},setResouceProtocolForHttps:function(a){var b=a;"https:"===window.location.protocol&&(b=a.replace(/^http(s?):\/\//i,"https://"));return b},processItemIDAndTokenOfResources:function(a,b){0<a.indexOf("${itemId}")&&
(a=a.replace("${itemId}",b.appId));/(\?|\&)token=.+/.test(a)&&(a=a.replace(/(\?|\&)token=.+/,""));b.isPublic||(b=g.getPortalCredential(b.portalUrl))&&(a+="?token\x3d"+b.token);return a},_setDocumentTitle:function(a){!window.isBuilder&&a&&a.title&&(document.title=c.stripHTML(a.title))},getAppConfig:function(){var a=e.clone(this.appConfig);a.getConfigElementById=function(a){return c.getConfigElementById(this,a)};a.getConfigElementsByName=function(a){return c.getConfigElementsByName(this,a)};a.visitElement=
function(a){c.visitElement(this,a)};this._addAuthorizedCrossOriginDomains(this.portalSelf,a);return a},_addAuthorizedCrossOriginDomains:function(a,b){a&&a.authorizedCrossOriginDomains&&g.addAuthorizedCrossOriginDomains(a.authorizedCrossOriginDomains);b&&b.authorizedCrossOriginDomains&&g.addAuthorizedCrossOriginDomains(b.authorizedCrossOriginDomains)},checkConfig:function(){return!1},processProxy:function(a){y.defaults.io.alwaysUseProxy=a.httpProxy&&a.httpProxy.useProxy&&a.httpProxy.alwaysUseProxy;
y.defaults.io.proxyUrl="";y.defaults.io.proxyRules=[];a.httpProxy&&a.httpProxy.useProxy&&a.httpProxy.url&&(y.defaults.io.proxyUrl=a.httpProxy.url);a.httpProxy&&a.httpProxy.useProxy&&a.httpProxy.rules&&p.forEach(a.httpProxy.rules,function(a){w.addProxyRule(a)})},addNeedValues:function(a){this._processNoUriWidgets(a);this._processEmptyGroups(a);this._addElementId(a);this._fixRepeatedId(a)},showError:function(a){a&&a.message&&q.create("div",{"class":"app-error",innerHTML:c.sanitizeHTML(a.message)},document.body)},
_tryLoadConfig:function(){"stemapp"===this.urlParams.id&&(this.urlParams.config=window.appInfo.appPath+"config.json",delete this.urlParams.id);if(this.urlParams.config)return this.configFile=this.urlParams.config,d(this.configFile,{handleAs:"json",headers:{"X-Requested-With":null}}).then(e.hitch(this,function(a){g.setPortalUrl(a.portalUrl);a.portalUrl&&(window.portalUrl=a.portalUrl);return this.urlParams.token?g.registerToken(this.urlParams.token).then(function(){return a}):a}));if(this.urlParams.id){window.appInfo.isRunInPortal=
!0;var a=r.getPortalUrlFromLocation(),b=new h;g.setPortalUrl(a);window.portalUrl=a;z.arcgisUrl=r.getBaseItemUrl(a);var c;this.urlParams.token?c=g.registerToken(this.urlParams.token):(c=new h,c.resolve());c.then(e.hitch(this,function(){u.getPortal(a).loadSelfInfo().then(e.hitch(this,function(c){this.portalSelf=c;c.allSSL&&"http:"===window.location.protocol?(console.log("redirect from http to https"),window.location.href=r.setHttpsProtocol(window.location.href),b.reject()):this._processSignIn(a).then(e.hitch(this,
function(){this._getAppConfigFromAppId(a,this.urlParams.id).then(e.hitch(this,function(a){this._tryUpdateAppConfigByLocationUrl(a);return this._processInPortalAppProtocol(a)})).then(function(a){b.resolve(a)},function(a){b.reject(a)})}))}))}),e.hitch(this,function(a){this.showError(a)}));return b}this.configFile="config.json";return d(this.configFile,{handleAs:"json"}).then(e.hitch(this,function(a){g.setPortalUrl(a.portalUrl);a.portalUrl&&(window.portalUrl=a.portalUrl);return this.urlParams.token?
g.registerToken(this.urlParams.token).then(function(){return a}):a}))},_upgradeAppConfig:function(a){var b=window.wabVersion,c=a.wabVersion;a.configWabVersion=a.wabVersion;if(b===c)return a;var d=this.versionManager.getVersionIndex(c),g=this.versionManager.getVersionIndex(b);if(d>g)throw Error("Bad version number, "+c);a=this.versionManager.upgrade(a,c,b);a.wabVersion=b;return a},loadAndUpgradeAllWidgetsConfig:function(a){var c=new h,d=[];b.visitElement(a,e.hitch(this,function(a){a.uri&&(a=this.widgetManager.tryLoadWidgetConfig(a),
d.push(a))}));f(d).then(e.hitch(this,function(){c.resolve(a)}),function(a){c.reject(a)});return c},_processAfterTryLoad:function(a){this._setPortalUrl(a);this._tryUpdateAppConfigByLocationUrl(a);this._processUrlParams(a);this.addNeedValues(a);this.processProxy(a);v.tokenValidity=10080;return a},_readAndSetSharedTheme:function(a){a.theme.sharedTheme||(a.theme.sharedTheme={useHeader:!1,useLogo:!1},a.theme.sharedTheme.isPortalSupport=this.portalSelf.portalProperties&&this.portalSelf.portalProperties.sharedTheme?
!0:!1);a.theme.sharedTheme.useHeader&&(a.theme.sharedTheme.isPortalSupport&&this.portalSelf.portalProperties?(a.theme.customStyles={mainBackgroundColor:this.portalSelf.portalProperties.sharedTheme.header.background},a.titleColor=this.portalSelf.portalProperties.sharedTheme.header.text):console.error("Portal does not support sharedTheme."));a.theme.sharedTheme.useLogo&&(a.theme.sharedTheme.isPortalSupport&&this.portalSelf.portalProperties?(a.logo=this.portalSelf.portalProperties.sharedTheme.logo.small?
this.portalSelf.portalProperties.sharedTheme.logo.small:"images/app-logo.png",!a.logoLink&&this.portalSelf.portalProperties.sharedTheme.logo.link&&(a.logoLink=this.portalSelf.portalProperties.sharedTheme.logo.link)):(console.error("Portal does not support sharedTheme, use default logo."),a.logo="images/app-logo.png"))},_tryUpdateAppConfigByLocationUrl:function(a){if(!(this.urlParams.config&&-1<this.urlParams.config.indexOf("arcgis.com/sharing/rest/content/items/"))){var b=r.getPortalUrlFromLocation(),
b=r.getStandardPortalUrl(b);r.isOnline(b)&&(b=r.updateUrlProtocolByOtherUrl(b,a.portalUrl),a.map.portalUrl&&r.isSamePortalUrl(a.portalUrl,a.map.portalUrl)&&(a.map.portalUrl=b),a.portalUrl=b,a.httpProxy&&a.httpProxy.url&&(a.httpProxy.url=r.getPortalProxyUrl(b)))}},_processWidgetJsons:function(a){b.visitElement(a,function(a,b){b.isWidget&&a.uri&&c.widgetJson.processWidgetJson(a)})},_processNoUriWidgets:function(a){var c=0;b.visitElement(a,function(a,b){b.isWidget&&!a.uri&&(c++,a.placeholderIndex=c)})},
_processEmptyGroups:function(a){var b=0;a.widgetOnScreen.groups&&p.forEach(a.widgetOnScreen.groups,function(a){if(!a.widgets||a.widgets&&0===a.widgets.length)b++,a.placeholderIndex=b})},_addElementId:function(a){var c=0,d;b.visitElement(a,function(a){if(a.id){a.id=a.id.replace(/\//g,"_");var b=a.id.lastIndexOf("_");-1<b&&(d=a.id.substr(b+1),c=Math.max(c,d))}});b.visitElement(a,function(a){a.id||(c++,a.id=a.itemId?a.itemId+"_"+c:a.uri?a.uri.replace(/\//g,"_")+"_"+c:"_"+c)})},_setPortalUrl:function(a){if(a.portalUrl){var b=
r.getPortalUrlFromLocation(),c=r.isOnline(b);r.isSamePortalUrl(a.portalUrl,b)||c||(window.appInfo.isRunInPortal=!1)}else window.isXT&&l("wab_portalurl")?a.portalUrl=l("wab_portalurl"):(window.appInfo.isRunInPortal=!0,a.portalUrl=r.getPortalUrlFromLocation())},_changePortalUrlProtocol:function(a,b){a.portalUrl=r.setProtocol(a.portalUrl,b);a.map.portalUrl&&(a.map.portalUrl=r.setProtocol(a.map.portalUrl,b));a.httpProxy&&(a.httpProxy.url=r.setProtocol(a.httpProxy.url,b),a.httpProxy&&a.httpProxy.rules&&
p.forEach(a.httpProxy.rules,e.hitch(this,function(a){a.proxyUrl=r.setProtocol(a.proxyUrl,b)})))},_processInPortalAppProtocol:function(a){var b=new h,c=u.getPortal(a.portalUrl),d=e.hitch(this,function(c){if("https:"===window.location.protocol)this._changePortalUrlProtocol(a,"https");else{if(c){console.log("redirect from http to https");window.location.href=r.setHttpsProtocol(window.location.href);b.reject();return}this._changePortalUrlProtocol(a,"http")}this._checkLocale();b.resolve(a)});c.loadSelfInfo().then(e.hitch(this,
function(b){this.portalSelf=b;"private"===b.access?(b=0===a.portalUrl.toLowerCase().indexOf("https://"),d(b)):d(b.allSSL)}),e.hitch(this,function(a){b.reject(a)}));return b},_processNotInPortalAppProtocol:function(a){var b=new h;a.portalUrl?u.getPortal(a.portalUrl).loadSelfInfo().then(e.hitch(this,function(c){this.portalSelf=c;var d="https:"===window.location.protocol;(c.allSSL||d)&&this._changePortalUrlProtocol(a,"https");0!==a.portalUrl.toLowerCase().indexOf("https://")||d||g.isInConfigOrPreviewWindow()?
b.resolve(a):(console.log("redirect from http to https"),window.location.href=r.setHttpsProtocol(window.location.href),b.reject())}),e.hitch(this,function(a){b.reject(a)})):b.resolve(a);return b},_proesssWebTierAndSignin:function(a){var b=new h,c=!1,d=a.portalUrl;this._processWebTier(a).then(e.hitch(this,function(a){c=a;return u.getPortal(d).loadSelfInfo()})).then(e.hitch(this,function(a){this.portalSelf=a;return this._processSignIn(d,c)})).then(e.hitch(this,function(){b.resolve()}),function(a){b.reject(a)});
return b},_processWebTier:function(a){var b=new h,c=a.portalUrl;a.isWebTier?(g.addAuthorizedCrossOriginDomains([c]),g.isWebTierPortal(c).then(e.hitch(this,function(){var d=g.getPortalCredential(c);d&&d.ssl&&"http:"===window.location.protocol&&!g.isInConfigOrPreviewWindow()?(console.log("redirect from http to https"),window.location.href=r.setHttpsProtocol(window.location.href)):b.resolve(a.isWebTier)}),e.hitch(this,function(a){b.reject(a)}))):b.resolve(!1);return b},_processSignIn:function(a,b){var c=
new h,d=u.getPortal(a),f=r.getSharingUrl(a);window.appInfo.isRunInPortal?(b=v.checkSignInStatus(f),b.promise.always(e.hitch(this,function(){c.resolve()}))):(!g.isInBuilderWindow()&&!g.isInConfigOrPreviewWindow()&&this.portalSelf.supportsOAuth&&this.rawAppConfig&&this.rawAppConfig.appId&&!b&&g.registerOAuthInfo(a,this.rawAppConfig.appId),b=v.checkSignInStatus(f),b.promise.always(e.hitch(this,function(){g.xtGetCredentialFromCookie(a);d.loadSelfInfo().then(e.hitch(this,function(a){this.portalSelf=a;
this._checkLocale();c.resolve()}))})));return c},_checkLocale:function(){if(!g.isInConfigOrPreviewWindow()){var a=this.portalSelf.user&&this.portalSelf.user.culture||n.locale,a=a.toLowerCase();!this.urlParams.locale&&c.isLocaleChanged(n.locale,a)&&(l("wab_app_locale",a),window.location.reload())}},_getAppConfigFromTemplateAppId:function(a,b){var c=u.getPortal(a);return this._getWabAppIdAndDataFromTemplateAppId(a,b).then(e.hitch(this,function(b){var d=b.appId,g=b.appData;return f([this._getAppConfigFromAppId(a,
d),c.getItemData(g.source)]).then(e.hitch(this,function(a){var b;g.appConfig?(b=g.appConfig,delete g.appConfig):b=a[0];b=this._upgradeAppConfig(b);a=a[1];b._appData=g;b._wabAppId=d;b.templateConfig=a;b.isTemplateApp=!0;return b}))}))},_getAppDataAddTemplateDataFromTemplateAppId:function(a,b){var c=u.getPortal(a);return c.getItemData(b).then(function(a){return c.getItemData(a.source).then(function(b){return{appData:a,templateData:b}})})},_getWabAppIdAndDataFromTemplateAppId:function(a,b){var c=new h,
d=u.getPortal(a);d.getItemData(b).then(e.hitch(this,function(a){d.getItemById(a.source).then(e.hitch(this,function(b){b=w.urlToObject(b.url);c.resolve({appId:b.query.id,appData:a})}))}),function(a){c.reject(a)});return c},_getAppConfigFromAppId:function(a,b){return u.getPortal(a).getItemData(b)},_removeHash:function(a){for(var b in a)a[b]&&(a[b]=a[b].replace("#",""))},loadWidgetsManifest:function(a){function d(b,d,f){function e(c){return b.loadWidgetManifest(c).then(function(a){return a},function(b){console.log("Widget failed to load, it is removed.",
c.name);b.stack?console.error(b.stack):console.log(b);g(a,c)})}return d.itemId?u.getPortal(f).getItemById(d.itemId).then(function(a){d.uri=c.widgetJson.getUriFromItem(a);return e(d)},function(b){console.log("Widget is not loaded, it is removed.",d.name,b);g(a,d)}):e(d)}function g(a,b){function c(c){a[c]&&a[c].widgets&&(a[c].widgets=a[c].widgets.filter(function(a){if(b)return a.id!==b.id;a.uri&&!a.manifest&&console.error("Widget is removed because it is not loaded successfully.",a.uri);return a.manifest}));
a[c]&&a[c].groups&&a[c].groups.forEach(function(a){a.widgets&&(a.widgets=a.widgets.filter(function(a){if(b)return a.id!==b.id;a.uri&&!a.manifest&&console.error("Widget is removed because it is not loaded successfully.",a.uri);return a.manifest}))})}c("widgetOnScreen");c("widgetPool")}var m=[],l=new h;this.urlParams.manifest&&a._buildInfo&&a._buildInfo.widgetManifestsMerged&&delete a._buildInfo.widgetManifestsMerged;a._buildInfo&&a._buildInfo.widgetManifestsMerged?this._loadMergedWidgetManifests().then(e.hitch(this,
function(g){b.visitElement(a,e.hitch(this,function(b){b.widgets||!b.uri&&!b.itemId||(b.uri&&g[b.uri]?(this._addNeedValuesForManifest(g[b.uri],b.uri),c.widgetJson.addManifest2WidgetJson(b,g[b.uri])):m.push(d(this.widgetManager,b,a.portalUrl)))}));f(m).then(function(){l.resolve(a)})})):(b.visitElement(a,e.hitch(this,function(b){b.widgets||!b.uri&&!b.itemId||m.push(d(this.widgetManager,b,a.portalUrl))})),f(m).then(function(){l.resolve(a)}));setTimeout(function(){l.isResolved()||(g(a),l.resolve(a))},
6E4);return l},_addNeedValuesForManifest:function(a,b){e.mixin(a,c.getUriInfo(b));c.manifest.addManifestProperies(a);c.manifest.processManifestLabel(a,n.locale)},_loadMergedWidgetManifests:function(){return d(window.appInfo.appPath+"widgets/widgets-manifest.json",{handleAs:"json"})},_fixRepeatedId:function(a){var c=[];b.visitElement(a,function(a){0<=c.indexOf(a.id)&&(a.id+="_");c.push(a.id)})},_processUrlParams:function(a){var b=this.urlParams.itemid||this.urlParams.webmap;b&&a.map.itemId!==b&&(a.map.mapOptions&&
c.deleteMapOptions(a.map.mapOptions),a.map.itemId=b);this.urlParams.mode&&(a.mode=this.urlParams.mode);a.map.mapOptions||(a.map.mapOptions={});this.urlParams.scale&&(a.map.mapOptions.scale=this.urlParams.scale);if(this.urlParams.level||this.urlParams.zoom)a.map.mapOptions.zoom=this.urlParams.level||this.urlParams.zoom}});A.getInstance=function(a,b){null===x?x=new A(a,b):(x.urlParams=a,x.options=b);return x};return A})},"jimu/WidgetManager":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/html dojo/Deferred dojo/topic dojo/Evented dojo/on dojo/aspect dojo/json dojo/query dojo/request/xhr dojo/promise/all dijit/registry ./utils jimu/tokenUtils ./dijit/Message ./DataSourceManager".split(" "),
function(k,e,p,q,n,l,h,f,d,c,a,b,g,u,m,r,t,v){var y=null,w=k(h,{constructor:function(){this.loaded=[];this.missedActions=[];this.activeWidget=null;window.isBuilder?(l.subscribe("app/mapLoaded",e.hitch(this,this._onMapLoaded)),l.subscribe("app/mapChanged",e.hitch(this,this._onMapChanged))):(l.subscribe("mapLoaded",e.hitch(this,this._onMapLoaded)),l.subscribe("mapChanged",e.hitch(this,this._onMapChanged)));window.isBuilder?(l.subscribe("app/sceneViewLoaded",e.hitch(this,this._onSceneViewLoaded)),l.subscribe("app/sceneViewChanged",
e.hitch(this,this._onSceneViewChanged))):(l.subscribe("sceneViewLoaded",e.hitch(this,this._onSceneViewLoaded)),l.subscribe("sceneViewChanged",e.hitch(this,this._onSceneViewChanged)));window.isBuilder?(l.subscribe("app/appConfigLoaded",e.hitch(this,this._onAppConfigLoaded)),l.subscribe("app/appConfigChanged",e.hitch(this,this._onAppConfigChanged))):(l.subscribe("appConfigLoaded",e.hitch(this,this._onAppConfigLoaded)),l.subscribe("appConfigChanged",e.hitch(this,this._onAppConfigChanged)));l.subscribe("userSignIn",
e.hitch(this,this._onUserSignIn));l.subscribe("userSignOut",e.hitch(this,this._onUserSignOut));l.subscribe("builder/actionTriggered",e.hitch(this,this._onActionTriggered));l.subscribe("/dnd/move/start",e.hitch(this,this._onMoveStart))},loadWidget:function(a){var b=new n,c;a=e.clone(a);(c=this.getWidgetById(a.id))?b.resolve(c):g([this.loadWidgetClass(a),this.loadWidgetManifest(a)]).then(e.hitch(this,function(a){var c=a[0],d=a[1];this.loadWidgetResources(d).then(e.hitch(this,function(a){try{var g=this.createWidget(d,
c,a);q.setAttr(g.domNode,"data-widget-name",d.name);console.log("widget ["+d.uri+"] created.")}catch(I){console.log("create ["+d.uri+"] error:"+I.stack),new t({message:window.jimuNls.widgetManager.createWidgetError+": "+d.uri}),u.byId(d.id)&&u.byId(d.id).destroy(),b.reject(I)}setTimeout(e.hitch(this,function(){b.resolve(g);this.emit("widget-created",g);l.publish("widgetCreated",g)}),50)}),function(a){b.reject(a)})}),function(a){b.reject(a)});return b},loadWidgetClass:function(a){var b=new n,c;c=a.isRemote?
a.uri+".js":a.uri;require(m.getRequireConfig(),[c],e.hitch(this,function(a){b.resolve(a)}));m.checkError(a.uri,b);return b},loadWidgetResources:function(a){var b=new n,c,d,f,m=[];f=e.clone(a);a=this.tryLoadWidgetConfig(f);c=this._tryLoadResource(f,"i18n");d=this._tryLoadResource(f,"style");f=this._tryLoadResource(f,"template");m.push(a);m.push(c);m.push(f);m.push(d);g(m).then(e.hitch(this,function(a){var c={};c.config=a[0];c.i18n=a[1];c.template=a[2];c.style=a[3];b.resolve(c)}),function(a){b.reject(a)});
return b},loadWidgetManifest:function(a){var c=new n,d=m.getUriInfo(a.uri),d=d.isRemote?d.folderUrl+"manifest.json?f\x3djson":d.folderUrl+"manifest.json";if(a.manifest)return c.resolve(a),c;b(d,{handleAs:"json",headers:{"X-Requested-With":null}}).then(e.hitch(this,function(b){if(b.error&&b.error.code)return c.reject(b.error);b.category="widget";e.mixin(b,m.getUriInfo(a.uri));m.manifest.addI18NLabel(b).then(e.hitch(this,function(){this._processManifest(b);m.widgetJson.addManifest2WidgetJson(a,b);c.resolve(a)}))}),
function(a){c.reject(a)});return c},getWidgetMarginBox:function(a){if("string"===typeof a&&(a=this.getWidgetById(a),!a))return{};if(a._marginBox)return a._marginBox;var b={left:-9999,top:-9999,relativeTo:a.position.relativeTo};a._isTestSizeFlag=!0;a.setPosition(b);this.openWidget(a);a._marginBox=a.getMarginBox();this.closeWidget(a);"undefined"!==typeof a._isTestSizeFlag&&delete a._isTestSizeFlag;return a._marginBox},_processManifest:function(a){m.manifest.addManifestProperies(a);m.manifest.processManifestLabel(a,
window.dojoConfig.locale)},createWidget:function(a,b,c){if(this.getWidgetById(a.id))return this.getWidgetById(a.id);c.config&&c.i18n&&(c.config=m.replacePlaceHolder(c.config,c.i18n));a.rawConfig=a.config;a.config=c.config||{};this.appConfig._appData&&this._mergeAgolConfig(a);a.nls=c.i18n||{};c.template&&(a.templateString=c.template);a["class"]="jimu-widget";a.label||(a.label=a.name);this.map&&(a.map=this.map);a.appConfig=this.appConfig;c={};for(var g in a)a.hasOwnProperty(g)&&(c[g]=a[g]);c.widgetManager=
this;a=new b(c);a.clazz=b;d.after(a,"startup",e.hitch(this,this._postWidgetStartup,a));d.before(a,"destroy",e.hitch(this,this._onDestroyWidget,a));f(a.domNode,"click",e.hitch(this,this._onClickWidget,a));this.loaded.push(a);return a},getAllWidgets:function(){return this.loaded},destroyAllWidgets:function(){var a=p.map(this.loaded,function(a){return a.id});p.forEach(a,function(a){this.destroyWidget(a)},this);this.loaded=[]},loadWidgetSettingPage:function(a){var b=new n;a=e.clone(a);a.id+="_setting";
g([this.loadWidgetSettingClass(a)]).then(e.hitch(this,function(c){var g=c[0];this.loadWidgetSettingPageResources(a).then(e.hitch(this,function(c){var f;c={nls:c.i18n,templateString:c.template,appConfig:this.appConfig,"class":"jimu-widget-setting"};"HTML3D"===window.appInfo.appType?c.sceneView=this.sceneView:c.map=this.map;for(var m in a)a.hasOwnProperty(m)&&(c[m]=a[m]);try{f=new g(c),q.setAttr(f.domNode,"data-widget-name-setting",c.name),d.before(f,"destroy",e.hitch(this,this._onDestroyWidgetSetting,
f)),b.resolve(f)}catch(F){new t({message:window.jimuNls.widgetManager.createWidgetSettingPageError+":"+a.uri}),u.byId(c.id)&&u.byId(c.id).destroy(),b.reject(F)}}),function(a){console.log(a)})}),function(a){b.reject(a)});return b},loadWidgetSettingClass:function(a){var b=new n,c;c=a.isRemote?a.folderUrl+"setting/Setting.js":a.amdFolder+"setting/Setting";require(m.getRequireConfig(),[c],e.hitch(this,function(a){b.resolve(a)}));m.checkError(a.folderUrl+"setting/Setting.js",b);return b},loadWidgetSettingPageResources:function(a){var b=
new n,c,d,f=[];a=e.clone(a);c=this._tryLoadResource(a,"settingI18n");d=this._tryLoadResource(a,"settingTemplate");a=this._tryLoadResource(a,"settingStyle");f.push(c);f.push(d);f.push(a);g(f).then(e.hitch(this,function(a){var c={};c.i18n=a[0]||{};c.template=a[1];c.style=a[2];b.resolve(c)}),function(a){console.log(a)});return b},getWidgetById:function(a){var b;p.some(this.loaded,function(c){if(c.id===a)return b=c,!0},this);return b},getWidgetByLabel:function(a){var b;p.some(this.loaded,function(c){if(c.label===
a)return b=c,!0},this);return b},getWidgetsByName:function(a){var b=[];p.some(this.loaded,function(c){c.name===a&&b.push(c)},this);return b},changeWindowStateTo:function(a,b){"normal"===b?this.normalizeWidget(a):"minimized"===b?this.minimizeWidget(a):"maximized"===b?this.maximizeWidget(a):console.log("error state: "+b)},closeWidget:function(a){if("string"===typeof a&&(a=this.getWidgetById(a),!a))return;if("closed"!==a.state){this.activeWidget&&this.activeWidget.id===a.id&&(this.activeWidget.onDeActive(),
this.activeWidget=null);q.setStyle(a.domNode,"display","none");a.setState("closed");try{a.onClose()}catch(x){console.log(console.error("fail to close widget "+a.name+". "+x.stack))}}this.appConfig.mode||this._removeDataSourceUsage(a)},openWidget:function(a){if("string"===typeof a&&(a=this.getWidgetById(a),!a))return;if(!a.started)try{a.started=!0,a.startup()}catch(x){console.error("fail to startup widget "+a.name+". "+x.stack)}if("closed"===a.state){q.setStyle(a.domNode,"display","");a.setState("opened");
try{a.onOpen()}catch(x){console.error("fail to open widget "+a.name+". "+x.stack)}}this.appConfig.mode||this._addDataSourceUsage(a)},activateWidget:function(a){if("string"===typeof a&&(a=this.getWidgetById(a),!a))return;"opened"===a.state&&this._activeWidget(a)},maximizeWidget:function(a){if("string"===typeof a&&(a=this.getWidgetById(a),!a))return;"closed"===a.state&&this.openWidget(a);a.setWindowState("maximized");try{a.onMaximize()}catch(x){console.log(console.error("fail to maximize widget "+a.name+
". "+x.stack))}},minimizeWidget:function(a){if("string"===typeof a&&(a=this.getWidgetById(a),!a))return;"closed"===a.state&&this.openWidget(a);a.setWindowState("minimized");try{a.onMinimize()}catch(x){console.log(console.error("fail to minimize widget "+a.name+". "+x.stack))}},normalizeWidget:function(a){if("string"===typeof a&&(a=this.getWidgetById(a),!a))return;"closed"===a.state&&this.openWidget(a);a.setWindowState("normal");try{a.onNormalize()}catch(x){console.log(console.error("fail to normalize widget "+
a.name+". "+x.stack))}},destroyWidget:function(a){if("string"===typeof a&&(a=this.getWidgetById(a),!a))return;this._removeWidget(a);try{a.destroy()}catch(x){console.log(console.error("fail to destroy widget "+a.name+". "+x.stack))}},tryLoadWidgetConfig:function(a){return this._tryLoadWidgetConfig(a).then(e.hitch(this,function(b){return this._upgradeWidgetConfig(a,b).then(function(b){return a.config=b})}))},triggerWidgetOpen:function(a){function b(a){var b=d.after(a,"onOpen",function(){b.remove();
c.resolve(a)})}var c=new n,g=this.getWidgetById(a);if(g){if("closed"!==g.state)return c.resolve(g),c;b(g)}else var f=l.subscribe("widgetCreated",e.hitch(this,function(b){b.id===a&&(f.remove(),c.resolve(b))}));l.publish("openWidget",a);return c},_tryLoadWidgetConfig:function(a){var d=new n;if(a.config&&e.isObject(a.config))return d.resolve(a.config),d;if(a.config){if(require.cache["url:"+a.config])return d.resolve(c.parse(require.cache["url:"+a.config])),d;d=m.processUrlInAppConfig(a.config);d=d.split("/");
d[d.length-1]=encodeURIComponent(d[d.length-1]);d=d.join("/");return b(d,{handleAs:"json",headers:{"X-Requested-With":null}})}return this._tryLoadResource(a,"config").then(function(b){a.isDefaultConfig=!0;return b})},_upgradeWidgetConfig:function(a,b){var c=new n,d=a.manifest.version,g=a.version,f;if(d===g)return c.resolve(b),c;if(!1===a.hasVersionManager)return a.version=d,c.resolve(b),c;require(m.getRequireConfig(),[a.amdFolder+"VersionManager"],e.hitch(this,function(e){e=new e;var m=e.getVersionIndex(g),
h=e.getVersionIndex(d);if(m>h)c.reject("Bad widget version number, "+a.name+","+g);else try{f=e.upgrade(b,g,d),a.version=d,c.resolve(f)}catch(M){console.log("Read widget ["+a.name+"] old config error,"+M.stack),c.resolve(b)}}));return c},loadWidgetStyle:function(a){var b=this._getStyleIdFromWidgetJson(a,!1),c=new n;return q.byId(b)?(c.resolve("load"),c):m.loadStyleLink(b,a.styleFile,"theme_"+this.appConfig.theme.name+"_style_common")},loadWidgetSettingStyle:function(a){var b=this._getStyleIdFromWidgetJson(a,
!0),c=new n;return q.byId(b)?(c.resolve("load"),c):m.loadStyleLink(b,a.settingStyleFile)},loadWidgetConfig:function(a){a=require(m.getRequireConfig()).toUrl(a.configFile);if(require.cache["url:"+a]){var d=new n;d.resolve(c.parse(require.cache["url:"+a]));return d}return b(a,{handleAs:"json",headers:{"X-Requested-With":null}})},loadWidgetI18n:function(a){var b=new n;require(m.getRequireConfig(),["dojo/i18n!"+a.i18nFile],function(a){b.resolve(a)});return b},loadWidgetSettingI18n:function(a){var b=new n;
require(m.getRequireConfig(),["dojo/i18n!"+a.settingI18nFile],function(a){b.resolve(a)});return b},loadWidgetTemplate:function(a){var b=new n;require(m.getRequireConfig(),["dojo/text!"+a.templateFile],function(a){b.resolve(a)});m.checkError(a.templateFile,b);return b},loadWidgetSettingTemplate:function(a){var b=new n;require(m.getRequireConfig(),["dojo/text!"+a.settingTemplateFile],function(a){b.resolve(a)});m.checkError(a.settingTemplateFile,b);return b},removeWidgetStyle:function(a){this._removeStyle(this._getStyleIdFromWidgetJson(a,
!1))},removeWidgetSettingStyle:function(a){this._removeStyle(this._getStyleIdFromWidgetJson(a,!0))},_removeStyle:function(a){if(q.byId(a)){var b=q.attr(a,"data-import-styles");if(b)for(var c=0;c<parseInt(b,10);c++)q.destroy(a+"_import_"+c);q.destroy(a)}},_getStyleIdFromWidgetJson:function(a,b){return this._replaceId("widget/style/"+(a.itemId?a.itemId:a.uri)+(b?"/setting":""))},getControllerWidgets:function(){return p.filter(this.loaded,function(a){return a.isController})},getOffPanelWidgets:function(){return p.filter(this.loaded,
function(a){return!a.inPanel})},getOnScreenOffPanelWidgets:function(){return p.filter(this.loaded,function(a){return a.isOnScreen&&!a.inPanel})},closeOtherWidgetsInTheSameGroup:function(a){if("string"===typeof a&&(a=this.getWidgetById(a),!a))return;for(var b=0;b<this.loaded.length;b++)this.loaded[b].gid===a.gid&&this.loaded[b].id!==a.id&&this.closeWidget(this.loaded[b])},closeAllWidgetsInGroup:function(a){for(var b=0;b<this.loaded.length;b++)this.loaded[b].gid===a&&this.closeWidget(this.loaded[b])},
_addDataSourceUsage:function(a){p.forEach(this._getUsedDataSourceIdFromWidget(a),function(b){v.getInstance().addDataSourceUsage(b,a.id)})},_removeDataSourceUsage:function(a){p.forEach(this._getUsedDataSourceIdFromWidget(a),function(b){v.getInstance().removeDataSourceUsage(b,a.id)})},_getUsedDataSourceIdFromWidget:function(a){if((a=this.appConfig.getConfigElementById(a.id))&&a.config){var b=c.stringify(a.config);return p.filter(Object.keys(this.appConfig.dataSource.dataSources),function(a){return-1<
b.indexOf(a)},this)}},_mergeAgolConfig:function(a){var b=this.appConfig._appData.values,c="widgets["+a.id+"]",d;for(d in b){var g=d.replace(/\//g,"_").indexOf(c+"_config");0<=g&&m.template.setConfigValue(a,d.replace(/\//g,"_").substr(g,d.length).replace(c,"widget"),b[d])}},_onUserSignIn:function(a){p.forEach(this.loaded,function(b){b.onSignIn(a)},this)},_onUserSignOut:function(){p.forEach(this.loaded,function(a){a.onSignOut()},this)},_activeWidget:function(a){if(this.activeWidget){if(this.activeWidget.id===
a.id){!1===this.activeWidget.inPanel&&this.activeWidget.moveTopOnActive&&q.setStyle(this.activeWidget.domNode,"zIndex",101);return}"active"===this.activeWidget.state&&(this.activeWidget.setState("opened"),!1===this.activeWidget.inPanel&&q.setStyle(a.domNode,"zIndex","zIndex"in a.position?a.position.zIndex:"auto"),this.activeWidget.onDeActive())}this.activeWidget=a;"opened"===this.activeWidget.state&&(this.activeWidget.setState("active"),!1===this.activeWidget.inPanel&&this.activeWidget.moveTopOnActive&&
q.setStyle(this.activeWidget.domNode,"zIndex",101),this.activeWidget.onActive(),l.publish("widgetActived",a))},_onClickWidget:function(b,c){var d=a(".jimu-widget",b.domNode);if(0<d.length)for(var g=0;g<d.length;g++)if(c.target===d[g]||q.isDescendant(c.target,d[g]))return;this._activeWidget(b)},_onMoveStart:function(a){p.forEach(this.loaded,function(b){b.domNode===a.node&&this._activeWidget(b)},this)},_onAppConfigLoaded:function(a){this.appConfig=a=e.clone(a);r.setPortalUrl(a.portalUrl)},_onMapLoaded:function(a){this.map=
a},_onMapChanged:function(a){this.map=a},_onSceneViewLoaded:function(a){this.sceneView=a},_onSceneViewChanged:function(a){this.sceneView=a},_onAppConfigChanged:function(a,b,c,d){var g=e.clone(a);this.appConfig=g;p.forEach(this.loaded,function(a){a&&(a.onAppConfigChanged(g,b,c,d),"widgetChange"===b&&this._onConfigChanged(c.id,c.config,d))},this)},_onConfigChanged:function(a,b){if(a=this.getWidgetById(a))a.onConfigChanged(b),e.mixin(a.config,b)},_onActionTriggered:function(a){if("map"!==a.elementId&&
"app"!==a.elementId){var b=this.getWidgetById(a.elementId);if(b)b.onAction(a.action,a.data);else this.missedActions.push({id:a.elementId,action:{name:a.action,data:a.data}});p.forEach(this.getControllerWidgets(),function(b){if(b.widgetIsControlled(a.elementId))b.onAction(a.action,{widgetId:a.elementId,data:a.data})},this)}},_postWidgetStartup:function(a){a.started=!0;m.setVerticalCenter(a.domNode);d.after(a,"resize",e.hitch(this,m.setVerticalCenter,a.domNode));this.openWidget(a);var b=r.getPortalCredential(this.appConfig.portalUrl);
if(b)a.onSignIn(b);else a.onSignOut();this._triggerMissedAction(a)},_triggerMissedAction:function(a){this.missedActions.forEach(function(b){if(b.id===a.id)a.onAction(b.action.name,b.action.data)})},_remove:function(a){return p.some(this.loaded,function(b,c){if(b.id===a)return this.loaded.splice(c,1),!0},this)},_tryLoadResource:function(a,b){var c,d=new n;if("config"===b)c=a.amdFolder+"config.json",a.configFile=c,c="hasConfig";else if("style"===b)c=a.amdFolder+"css/style.css",a.styleFile=c,c="hasStyle";
else if("i18n"===b)c=a.amdFolder+"nls/strings.js",a.i18nFile=a.isRemote?c:a.amdFolder+"nls/strings",c="hasLocale";else if("template"===b)c=a.amdFolder+"Widget.html",a.templateFile=c,c="hasUIFile";else if("settingTemplate"===b)c=a.amdFolder+"setting/Setting.html",a.settingTemplateFile=c,c="hasSettingUIFile";else if("settingI18n"===b)c=a.amdFolder+"setting/nls/strings.js",a.settingI18nFile=a.isRemote?c:a.amdFolder+"setting/nls/strings",c="hasSettingLocale";else if("settingStyle"===b)c=a.amdFolder+"setting/css/style.css",
a.settingStyleFile=c,c="hasSettingStyle";else return d;a[c]?function(){var c;if("config"===b)c=this.loadWidgetConfig(a);else if("style"===b)c=this.loadWidgetStyle(a);else if("i18n"===b)c=this.loadWidgetI18n(a);else if("template"===b)c=this.loadWidgetTemplate(a);else if("settingTemplate"===b)c=this.loadWidgetSettingTemplate(a);else if("settingStyle"===b)c=this.loadWidgetSettingStyle(a);else if("settingI18n"===b)c=this.loadWidgetSettingI18n(a);else return d;c.then(function(a){d.resolve(a)},function(b){new t({message:window.jimuNls.widgetManager.loadWidgetResourceError+
": "+a.uri});d.reject(b)})}.apply(this):d.resolve(null);return d},_replaceId:function(a){return a.replace(/\//g,"_").replace(/\./g,"_")},_onDestroyWidget:function(a){"closed"!==a.state&&this.closeWidget(a);this._removeWidget(a);this.emit("widget-destroyed",a.id);l.publish("widgetDestroyed",a.id);console.log("destroy widget ["+a.uri+"].")},_onDestroyWidgetSetting:function(a){this.removeWidgetSettingStyle(a)},_removeWidget:function(a){if("string"===typeof a&&(a=this.getWidgetById(a),!a))return;this.activeWidget&&
this.activeWidget.id===a.id&&(this.activeWidget=null);this._remove(a.id);0===this.getWidgetsByName(a.name).length&&this.removeWidgetStyle(a)}});w.getInstance=function(a){null===y&&(y=new w(a),window._widgetManager=y);return y};return w})},"jimu/AppStateManager":function(){define("dojo/_base/declare dojo/_base/lang dojo/Deferred dojo/json esri/geometry/Extent esri/SpatialReference libs/storejs/store libs/md5/md5 jimu/tokenUtils".split(" "),function(k,e,p,q,n,l,h,f,d){var c=null,a=k(null,{rawAppConfig:null,
mapMd5:null,appStateKey:null,setRawAppConfig:function(a){this.rawAppConfig=a},_getAppStateMd5:function(){if("string"!==typeof this.mapMd5){var a=q.stringify(this.rawAppConfig.map);this.mapMd5=f(a)}return this.mapMd5},_getAppStateKey:function(){return this.appStateKey?this.appStateKey:this.appStateKey="wab_appstate_"+this.urlParams.id||this.urlParams.appid||window.path},getWabAppState:function(){var a=new p,c={};if(d.isInConfigOrPreviewWindow()||!this.rawAppConfig||!this.rawAppConfig.map)return a.resolve(c),
a;var f=this._getAppStateKey(),e=h.get(f);e&&e.appStateMd5===this._getAppStateMd5()?(f=e.map&&e.map.extent,e=e.map&&e.map.layers,f&&(c.extent=new n(f.xmin,f.ymin,f.xmax,f.ymax,new l(f.spatialReference))),e&&(c.layers=e)):h.remove(f);a.resolve(c);return a},saveWabAppState:function(a,c){if(a&&!d.isInConfigOrPreviewWindow()){var b=this._getAppStateKey(),g={extent:{xmin:a.extent.xmin,xmax:a.extent.xmax,ymin:a.extent.ymin,ymax:a.extent.ymax,spatialReference:{wkid:a.extent.spatialReference.wkid,wkt:a.extent.spatialReference.wkt}},
layers:{}};c&&c.traversal&&c.traversal(e.hitch(this,function(a){g.layers[a.id]={visible:a.isVisible()}}));h.set(b,{map:g,appStateMd5:this._getAppStateMd5()})}}});a.getInstance=function(b){null===c&&(c=new a);c.urlParams=b;return c};return a})},"libs/storejs/store":function(){(function(k){var e={},p=k.document,q;e.disabled=!1;e.set=function(c,a){};e.get=function(c){};e.remove=function(c){};e.clear=function(){};e.transact=function(c,a,b){var d=e.get(c);null==b&&(b=a,a=null);"undefined"==typeof d&&(d=
a||{});b(d);e.set(c,d)};e.getAll=function(){};e.forEach=function(){};e.serialize=function(c){return JSON.stringify(c)};e.deserialize=function(c){if("string"==typeof c)try{return JSON.parse(c)}catch(a){return c||void 0}};var n;try{n="localStorage"in k&&k.localStorage}catch(c){n=!1}if(n)q=k.localStorage,e.set=function(c,a){if(void 0===a)return e.remove(c);q.setItem(c,e.serialize(a));return a},e.get=function(c){return e.deserialize(q.getItem(c))},e.remove=function(c){q.removeItem(c)},e.clear=function(){q.clear()},
e.getAll=function(){var c={};e.forEach(function(a,b){c[a]=b});return c},e.forEach=function(c){for(var a=0;a<q.length;a++){var b=q.key(a);c(b,e.get(b))}};else if(p.documentElement.addBehavior){var l=function(c){return c.replace(/^d/,"___$\x26").replace(d,"___")};n=function(c){return function(){var a=Array.prototype.slice.call(arguments,0);a.unshift(q);h.appendChild(q);q.addBehavior("#default#userData");q.load("localStorage");a=c.apply(e,a);h.removeChild(q);return a}};var h,f;try{f=new ActiveXObject("htmlfile"),
f.open(),f.write('\x3cscript\x3edocument.w\x3dwindow\x3c/script\x3e\x3ciframe src\x3d"/favicon.ico"\x3e\x3c/iframe\x3e'),f.close(),h=f.w.frames[0].document,q=h.createElement("div")}catch(c){q=p.createElement("div"),h=p.body}var d=/[!"#$%&'()*+,/\\:;<=>?@[\]^`{|}~]/g;e.set=n(function(c,a,b){a=l(a);if(void 0===b)return e.remove(a);c.setAttribute(a,e.serialize(b));c.save("localStorage");return b});e.get=n(function(c,a){a=l(a);return e.deserialize(c.getAttribute(a))});e.remove=n(function(c,a){a=l(a);
c.removeAttribute(a);c.save("localStorage")});e.clear=n(function(c){var a=c.XMLDocument.documentElement.attributes;c.load("localStorage");for(var b=0,d;d=a[b];b++)c.removeAttribute(d.name);c.save("localStorage")});e.getAll=function(c){var a={};e.forEach(function(b,c){a[b]=c});return a};e.forEach=n(function(c,a){for(var b=c.XMLDocument.documentElement.attributes,d=0,f;f=b[d];++d)a(f.name,e.deserialize(c.getAttribute(f.name)))})}try{e.set("__storejs__","__storejs__"),"__storejs__"!=e.get("__storejs__")&&
(e.disabled=!0),e.remove("__storejs__")}catch(c){e.disabled=!0}e.enabled=!e.disabled;"undefined"!=typeof module&&module.exports&&this.module!==module?module.exports=e:"function"===typeof define&&define.amd?define(e):k.store=e})(Function("return this")())},"libs/md5/md5":function(){(function(k){function e(a,b){var c=(a&65535)+(b&65535);return(a>>16)+(b>>16)+(c>>16)<<16|c&65535}function p(a,b,c,d,g,f){a=e(e(b,a),e(d,f));return e(a<<g|a>>>32-g,c)}function q(a,b,c,d,g,f,e){return p(b&c|~b&d,a,b,g,f,e)}
function n(a,b,c,d,g,f,e){return p(b&d|c&~d,a,b,g,f,e)}function l(a,b,c,d,g,f,e){return p(c^(b|~d),a,b,g,f,e)}function h(a,b){a[b>>5]|=128<<b%32;a[(b+64>>>9<<4)+14]=b;var c,d,g,f,m=1732584193,h=-271733879,k=-1732584194,u=271733878;for(b=0;b<a.length;b+=16)c=m,d=h,g=k,f=u,m=q(m,h,k,u,a[b],7,-680876936),u=q(u,m,h,k,a[b+1],12,-389564586),k=q(k,u,m,h,a[b+2],17,606105819),h=q(h,k,u,m,a[b+3],22,-1044525330),m=q(m,h,k,u,a[b+4],7,-176418897),u=q(u,m,h,k,a[b+5],12,1200080426),k=q(k,u,m,h,a[b+6],17,-1473231341),
h=q(h,k,u,m,a[b+7],22,-45705983),m=q(m,h,k,u,a[b+8],7,1770035416),u=q(u,m,h,k,a[b+9],12,-1958414417),k=q(k,u,m,h,a[b+10],17,-42063),h=q(h,k,u,m,a[b+11],22,-1990404162),m=q(m,h,k,u,a[b+12],7,1804603682),u=q(u,m,h,k,a[b+13],12,-40341101),k=q(k,u,m,h,a[b+14],17,-1502002290),h=q(h,k,u,m,a[b+15],22,1236535329),m=n(m,h,k,u,a[b+1],5,-165796510),u=n(u,m,h,k,a[b+6],9,-1069501632),k=n(k,u,m,h,a[b+11],14,643717713),h=n(h,k,u,m,a[b],20,-373897302),m=n(m,h,k,u,a[b+5],5,-701558691),u=n(u,m,h,k,a[b+10],9,38016083),
k=n(k,u,m,h,a[b+15],14,-660478335),h=n(h,k,u,m,a[b+4],20,-405537848),m=n(m,h,k,u,a[b+9],5,568446438),u=n(u,m,h,k,a[b+14],9,-1019803690),k=n(k,u,m,h,a[b+3],14,-187363961),h=n(h,k,u,m,a[b+8],20,1163531501),m=n(m,h,k,u,a[b+13],5,-1444681467),u=n(u,m,h,k,a[b+2],9,-51403784),k=n(k,u,m,h,a[b+7],14,1735328473),h=n(h,k,u,m,a[b+12],20,-1926607734),m=p(h^k^u,m,h,a[b+5],4,-378558),u=p(m^h^k,u,m,a[b+8],11,-2022574463),k=p(u^m^h,k,u,a[b+11],16,1839030562),h=p(k^u^m,h,k,a[b+14],23,-35309556),m=p(h^k^u,m,h,a[b+
1],4,-1530992060),u=p(m^h^k,u,m,a[b+4],11,1272893353),k=p(u^m^h,k,u,a[b+7],16,-155497632),h=p(k^u^m,h,k,a[b+10],23,-1094730640),m=p(h^k^u,m,h,a[b+13],4,681279174),u=p(m^h^k,u,m,a[b],11,-358537222),k=p(u^m^h,k,u,a[b+3],16,-722521979),h=p(k^u^m,h,k,a[b+6],23,76029189),m=p(h^k^u,m,h,a[b+9],4,-640364487),u=p(m^h^k,u,m,a[b+12],11,-421815835),k=p(u^m^h,k,u,a[b+15],16,530742520),h=p(k^u^m,h,k,a[b+2],23,-995338651),m=l(m,h,k,u,a[b],6,-198630844),u=l(u,m,h,k,a[b+7],10,1126891415),k=l(k,u,m,h,a[b+14],15,-1416354905),
h=l(h,k,u,m,a[b+5],21,-57434055),m=l(m,h,k,u,a[b+12],6,1700485571),u=l(u,m,h,k,a[b+3],10,-1894986606),k=l(k,u,m,h,a[b+10],15,-1051523),h=l(h,k,u,m,a[b+1],21,-2054922799),m=l(m,h,k,u,a[b+8],6,1873313359),u=l(u,m,h,k,a[b+15],10,-30611744),k=l(k,u,m,h,a[b+6],15,-1560198380),h=l(h,k,u,m,a[b+13],21,1309151649),m=l(m,h,k,u,a[b+4],6,-145523070),u=l(u,m,h,k,a[b+11],10,-1120210379),k=l(k,u,m,h,a[b+2],15,718787259),h=l(h,k,u,m,a[b+9],21,-343485551),m=e(m,c),h=e(h,d),k=e(k,g),u=e(u,f);return[m,h,k,u]}function f(a){var b,
c="";for(b=0;b<32*a.length;b+=8)c+=String.fromCharCode(a[b>>5]>>>b%32&255);return c}function d(a){var b,c=[];c[(a.length>>2)-1]=void 0;for(b=0;b<c.length;b+=1)c[b]=0;for(b=0;b<8*a.length;b+=8)c[b>>5]|=(a.charCodeAt(b/8)&255)<<b%32;return c}function c(a){return f(h(d(a),8*a.length))}function a(a,b){var c=d(a),g=[],e=[];g[15]=e[15]=void 0;16<c.length&&(c=h(c,8*a.length));for(a=0;16>a;a+=1)g[a]=c[a]^909522486,e[a]=c[a]^1549556828;b=h(g.concat(d(b)),512+8*b.length);return f(h(e.concat(b),640))}function b(a){var b=
"",c,d;for(d=0;d<a.length;d+=1)c=a.charCodeAt(d),b+="0123456789abcdef".charAt(c>>>4&15)+"0123456789abcdef".charAt(c&15);return b}function g(d,g,f){g?f?d=a(unescape(encodeURIComponent(g)),unescape(encodeURIComponent(d))):(d=a(unescape(encodeURIComponent(g)),unescape(encodeURIComponent(d))),d=b(d)):d=f?c(unescape(encodeURIComponent(d))):b(c(unescape(encodeURIComponent(d))));return d}"function"===typeof define&&define.amd?define(function(){return g}):k.md5=g})(this)},"builder/portalUtils":function(){define(["jimu/portalUtils"],
function(k){return k})},"builder/plugins/app-actions/to-template-config/_build-generate_module":function(){define(["builder/plugins/app-actions/to-template-config/Plugin","dojo/text!builder/plugins/app-actions/to-template-config/css/style.css","dojo/i18n!builder/plugins/app-actions/to-template-config/nls/strings"],function(){})},"builder/plugins/app-actions/to-template-config/Plugin":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/topic","dojo/on","builder/BasePlugin"],function(k,
e,p,q,n){return k([n],{baseClass:"plugin-app-actions-to-template-config",templateString:'\x3cdiv\x3e\x3cdiv class\x3d"footer-button" title\x3d"${nls.label}" data-dojo-attach-point\x3d"actionNode"\x3e${nls.label}\x3c/div\x3e\x3c/div\x3e',postCreate:function(){this.inherited(arguments);this.visible=!1;this.own(q(this.domNode,"click",e.hitch(this,this._onClick)));this._bindEvent()},_bindEvent:function(){this.own(p.subscribe("app/appConfigLoaded",e.hitch(this,this._setAppConfig)));this.own(p.subscribe("app/appConfigChanged",
e.hitch(this,this._setAppConfig)))},_onClick:function(){this.pluginManager.getPluginByName("app-config").switchToConfigTemplate()},_setAppConfig:function(e){this.appConfig=e;this.visible=!e.templateConfig||e.isTemplateApp||e._appData?!1:!0}})})},"builder/plugins/app-config/_build-generate_module":function(){define(["builder/plugins/app-config/Plugin","dojo/text!builder/plugins/app-config/Plugin.html","dojo/text!builder/plugins/app-config/css/style.css"],function(){})},"builder/plugins/app-config/Plugin":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/html dojo/on dojo/topic dojo/promise/all dojo/query builder/utils jimu/utils jimu/WidgetManager jimu/dijit/ViewStack jimu/dijit/LoadingShelter jimu/dijit/AGOLLoading jimu/ConfigLoader jimu/LayerInfos/LayerInfos esri/tasks/GeometryService esri/config builder/BasePlugin".split(" "),
function(k,e,p,q,n,l,h,f,d,c,a,b,g,u,m,r,t,v,y){return k([y],{baseClass:"plugin-config-app",_PreviewMoreIframeSrc:"",_isPortrait:!0,_deviceInfo:null,appId:null,postCreate:function(){this.inherited(arguments);this.atLoading=new u({loadingText:window.jimuNls.loadingShelter.loading+"..."});this.atLoading.placeAt(this.domNode);this.atLoading.show();this.optsLoading=new g({loadingText:"",hidden:!0,showLoading:!1});this.optsLoading.placeAt(this.leftPaneNode);this.republishEvents=[];this.pluginsLoadDefs=
[];this._createAppTemplateViewStack();this._createOptsViewStack();this._createPreviewViewStack();this._bindEvent();this.saveTemplatePluginBox=this.saveAppPluginBox=null},startup:function(){this.pluginsLoadDefs.push(this._loadConfigOptsPlugin());this.pluginsLoadDefs.push(this._loadMorePreviewOptsPlugin());this.pluginsLoadDefs.push(this._loadTemplateConfigOptsPlugin());this.pluginsLoadDefs.push(this._loadConfigTemplatePlugin());this.pluginsLoadDefs.push(this._createMainAppActions());this.pluginsLoadDefs.push(this._createPopupAppActions());
this.widgetManager=a.getInstance();this._defineSetConfigViewerTopicFunction();this._defineSetPreviewViewerTopicFunction();this._updateAppId()},addRepublishEvent:function(a){a=a.replace(/\s/g,"");-1<this.republishEvents.indexOf(a)||(this.republishEvents.push(a),this.own(l.subscribe(a,e.hitch(this,function(b){window.verboseLog&&("actionTriggered"!==a||"actionTriggered"===a&&"editLayout"===b.action)&&console.log("Builer event:","builder/"+a,b);this.configViewerTopic.publish("builder/"+a,b)}))))},showLoadingCover:function(){this.optsLoading.show()},
hideLoadingCover:function(){this.optsLoading.hide()},switchToPreviewConfig:function(){this.optsViewStack.switchView(this.configOptsPaneNode);this.previewViewStack.switchView(this.previewConfig);this.pluginManager.getPluginByName("app-config-template-configpart").visible=!1},switchToTemplateConfigPart:function(){this.optsViewStack.switchView(this.templateOptsPaneNode);this.previewViewStack.switchView(this.previewConfig);var a=this.pluginManager.getPluginByName("app-config-template-configpart");a.visible=
!0;a.refresh()},switchToPreviewMore:function(){this.optsViewStack.switchView(this.morePreviewOptsPaneNode);this.previewViewStack.switchView(this.previewMore);this._showPreviewMore()},switchToConfigApp:function(a){q.setStyle(this.configAppNode,"visibility","visible");a=a||this.appConfig;this.atViewStack.switchView(this.configAppNode);a.templateConfig&&a.isTemplateApp||a.templateConfig&&a._appData?this.switchToTemplateConfigPart():(a=this.pluginManager.getPluginByName("app-actions.preview-app"))&&"config"!==
a.mode?this.switchToPreviewMore():this.switchToPreviewConfig();(a=this.pluginManager.getPluginByName("app-actions.save-app"))&&this.saveAppPluginBox&&q.place(a.domNode,this.saveAppPluginBox);this.pluginManager.getPluginByName("app-config-templateconfig").visible=!1},switchToConfigTemplate:function(){q.setStyle(this.configAppNode,"visibility","hidden");this.atViewStack.switchView(this.configTemplateNode);this.switchToPreviewConfig();var a=this.pluginManager.getPluginByName("app-actions.save-app");
a&&this.saveTemplatePluginBox&&q.place(a.domNode,this.saveTemplatePluginBox);a=this.pluginManager.getPluginByName("app-config-templateconfig");a.visible=!0;a.refresh()},_bindEvent:function(){this.own(l.subscribe("app/preloadWidgetsLoaded",e.hitch(this,this._onPreloadWidgetsLoaded)));this.own(l.subscribe("app/mapCreatedFailed",e.hitch(this,this._onMapCreatedFailed)));this.own(n(this.btnPortrait,"click",e.hitch(this,function(){this._resizePreviewMore(!0)})));this.own(n(this.btnLandscape,"click",e.hitch(this,
function(){this._resizePreviewMore(!1)})));this.own(n(document.body,"click",e.hitch(this,function(){q.setStyle(this.popupActionsMenu,"display","none")})));this.own(l.subscribe("iframeClick",e.hitch(this,function(){q.setStyle(this.popupActionsMenu,"display","none")})));this._bindFrameEvent()},_bindFrameEvent:function(){this.own(n(this.previewConfigFrameNode,"load",e.hitch(this,function(){window.configWindow=this.previewConfigFrameNode.contentWindow;this.own(n(this.previewConfigFrameNode.contentWindow.document.body,
"click",e.hitch(this,function(a){l.publish("iframeClick",a)})))})));this.own(n(this.previewMoreFrameNode,"load",e.hitch(this,function(){window.previewWindow=this.previewMoreFrameNode.contentWindow;this.own(n(this.previewMoreFrameNode.contentWindow.document.body,"click",e.hitch(this,function(a){l.publish("iframeClick",a)})))})))},_createAppTemplateViewStack:function(){this.atViewStack=new b({viewType:"dom",views:[this.configAppNode,this.configTemplateNode]},this.atViewStackNode)},_createOptsViewStack:function(){this.optsViewStack=
new b({viewType:"dom",views:[this.configOptsPaneNode,this.morePreviewOptsPaneNode,this.templateOptsPaneNode]},this.optsViewStackNode)},_createPreviewViewStack:function(){this.previewViewStack=new b({viewType:"dom",views:[this.previewConfig,this.previewMore]},this.rightPreviewSection)},_defineSetConfigViewerTopicFunction:function(){window.setConfigViewerTopic=e.hitch(this,function(a){this.configViewerTopic=a;this.own(this.configViewerTopic.subscribe("appConfigLoaded",e.hitch(this,this.onAppConfigLoaded)));
this.own(this.configViewerTopic.subscribe("appConfigChanged",e.hitch(this,this.onAppConfigChanged)));this.own(this.configViewerTopic.subscribe("mapLoaded",e.hitch(this,this.onMapLoaded)));this.own(this.configViewerTopic.subscribe("mapChanged",e.hitch(this,this.onMapChanged)));this.own(this.configViewerTopic.subscribe("sceneViewLoaded",e.hitch(this.onSceneViewLoaded)));this.own(this.configViewerTopic.subscribe("sceneViewChanged",e.hitch(this.onSceneViewChanged)));this.own(this.configViewerTopic.subscribe("preloadWidgetsLoaded",
e.hitch(this,this.onPreloadWidgetsLoaded)));this.own(this.configViewerTopic.subscribe("mapCreatedFailed",e.hitch(this,this.onMapCreatedFailed)));this.own(this.configViewerTopic.subscribe("layoutDefinitionChanged",e.hitch(this,this.onLayoutDefinitionChanged)));this.own(this.configViewerTopic.subscribe("editLayoutCancelled",e.hitch(this,this.onEditLayoutCancelled)));this.own(this.configViewerTopic.subscribe("dataSourceDataUpdated",e.hitch(this,this.onDataSourceDataUpdated)));this.own(this.configViewerTopic.subscribe("editLayout",
e.hitch(this,this.onEditLayout)));this._onConfigViewerLoaded()})},_defineSetPreviewViewerTopicFunction:function(){window.setPreviewViewerTopic=e.hitch(this,function(a){this.previewViewerTopic=a;a=e.clone(this.appConfig);a.mode="preview";this.previewViewerTopic.publish("builder/setAppConfig",a);this.own(this.previewViewerTopic.subscribe("mapLoaded",e.hitch(this,function(){this._syncPreviewMapExtentWithConfigMapExtent()})));this.own(this.previewViewerTopic.subscribe("sceneViewLoaded",e.hitch(this,function(){this._syncPreviewViewpointWithConfigViewpoint()})));
this._onPreviewViewerLoaded()})},_loadConfigOptsPlugin:function(){var a=this.filterExtensionsByAppType("config-part",this.options.appInfo.appType),a=this.pluginsMeta[a[0].pluginName];a.options=this.options;return this.pluginManager.loadPlugin(a).then(e.hitch(this,function(a){q.place(a.domNode,this.configOptsPaneNode);a.startup();return a}))},_loadMorePreviewOptsPlugin:function(){var a=this.filterExtensionsByAppType("morepreview-selction-part",this.options.appInfo.appType);if(0!==a.length)return this.pluginManager.loadPlugin(this.pluginsMeta[a[0].pluginName]).then(e.hitch(this,
function(a){q.place(a.domNode,this.morePreviewOptsPaneNode);a.startup();return a}))},_updateAppId:function(){window.jimuConfig.widgetsPackage={name:"widgets",location:window.appInfo.appPath+"widgets"};window.jimuConfig.themesPackage={name:"themes",location:window.appInfo.appPath+"themes"};window.jimuConfig.configsPackage={name:"configs",location:window.appInfo.appPath+"configs"};var a=c.urlToObject(window.location.href).query||{},b=window.appInfo.appPath+"index.html";delete a.id;window.isXT||a.appid||
(b=b+"?id\x3d"+window.appInfo.id);a.mode="preview";this._PreviewMoreIframeSrc=d.appendParamsToAppPath(b,a);a.mode="config";q.attr(this.previewConfigFrameNode,"src",d.appendParamsToAppPath(b,a))},_onConfigViewerLoaded:function(){h(this.pluginsLoadDefs).then(e.hitch(this,function(){window.stemappInfo.appVersionManager?require([window.appInfo.appPath+window.stemappInfo.appVersionManager],e.hitch(this,function(a){this._loadAppConfig(a)})):this._loadAppConfig()}))},_loadAppConfig:function(a){var b=c.urlToObject(window.location.href).query||
{};window.isXT?(delete b.id,b.config=window.appInfo.appPath+"config.json"):(b.appid&&(b.config=window.path+"stemapp/config.json"),"stemapp"===b.id&&(b.config=window.path+"stemapp/config.json",delete b.id));b.mode="config";m.getInstance(b,{versionManager:a?new a:null}).loadConfig().then(e.hitch(this,function(a){this.atLoading.hide();this.showLoadingCover();a.templateConfig&&a.isTemplateApp||a.templateConfig&&a._appData||!a.templateConfig?(this.switchToConfigApp(a),a.templateConfig?h(this._loadWidgetConfigsInTemplateConfig(a)).then(e.hitch(this,
function(){this.configViewerTopic.publish("builder/setAppConfig",a)})):this.configViewerTopic.publish("builder/setAppConfig",a)):(this.switchToConfigTemplate(),this.configViewerTopic.publish("builder/setAppConfig",a))}))},_loadWidgetConfigsInTemplateConfig:function(a){var b=c.template.getConfigedWidgetsByTemplateConfig(a.templateConfig),d=[];p.forEach(b,function(b){b=a.getConfigElementById(b);d.push(this.widgetManager.tryLoadWidgetConfig(b))},this);return d},_onPreviewViewerLoaded:function(){},previewOnDevice:function(a,
b){this._deviceInfo=a;q.setStyle(this.previewMoreDes,"display","block");this.previewMoreDes.innerHTML=b?a.width+" x "+a.height:a.title+" "+a.width+" x "+a.height;this._resizePreviewMore(this._isPortrait)},_createMainAppActions:function(){var a=this.filterExtensionsByAppType("main-app-actions",window.appInfo.appType),b=360/a.length;a.sort(function(a,b){return a.parameters.index-b.parameters.index});p.forEach(a,function(a,c){this._createMainAppActionNode(a,c,b)},this);return h([])},_createMainAppActionNode:function(a,
b,c){0<b&&q.create("div",{"class":"seprate jimu-float-leading"},this.mainActionBoxNode);var d=q.create("div",{"class":"footer-button-box jimu-float-leading",pname:a.pluginName},this.mainActionBoxNode);q.setStyle(d,"width",c+"px");b=this.pluginsMeta[a.pluginName];b.options=this.options.appInfo;return this.pluginManager.loadPlugin(b).then(e.hitch(this,function(b){"app-actions.save-app"===a.pluginName&&(this.saveAppPluginBox=d);q.place(b.domNode,d);b.startup();return b}))},_refreshAppActions:function(){var a=
this.filterExtensionsByAppType("main-app-actions",window.appInfo.appType),b=0;p.forEach(a,function(a){var c=this.pluginManager.getPluginByName(a.pluginName);a=f('div[pname\x3d"'+a.pluginName+'"]',this.mainActionBoxNode)[0];!1===c.visible?q.setStyle(a,"display","none"):(q.setStyle(a,"display",""),b++)},this);var c=360/b,a=f(".footer-button-box",this.mainActionBoxNode);p.forEach(a,function(a){q.setStyle(a,"width",c+"px")})},_createPopupAppActions:function(){var a=this.filterExtensionsByAppType("popup-app-actions",
window.appInfo.appType);a.sort(function(a,b){return a.parameters.index-b.parameters.index});if(0===a.length)q.setStyle(this.btnArrow,"display","none");else{q.setStyle(this.popupActionsMenu,"top",-30*a.length+"px");var b=[];p.forEach(a,function(a){b.push(this._createPopupAppActionNode(a))},this);return h(b)}},_createPopupAppActionNode:function(a){var b=a.parameters,c=q.create("div",{id:a.pluginName},this.popupActionsMenu);return this.pluginManager.loadPlugin(this.pluginsMeta[a.pluginName]).then(e.hitch(this,
function(a){c.innerHTML=a.label;this.own(n(c,"click",e.hitch(a,a[b.onClickAction])));return a}))},_onBtnArrowClick:function(a){if("none"===q.getStyle(this.popupActionsMenu,"display")){q.setStyle(this.popupActionsMenu,"display","block");var b=this.filterExtensionsByAppType("popup-app-actions",window.appInfo.appType),c=0;p.forEach(b,function(a){var b=this.pluginManager.getPluginByName(a.pluginName);a=f('div[id\x3d"'+a.pluginName+'"]',this.popupActionsMenu)[0];a.innerHTML=b.label;!1===b.visible?q.setStyle(a,
"display","none"):(q.setStyle(a,"display",""),c++);b.disabled?q.addClass(a,"disable"):a&&q.removeClass(a,"disable")},this);q.setStyle(this.popupActionsMenu,"top",-30*c+"px")}else q.setStyle(this.popupActionsMenu,"display","none");a.stopPropagation()},_getGeomtryServiceByAppConfig:function(a){return new t(a.geometryService)},onAppConfigLoaded:function(a){a=this._processAppConfig(a);l.publish("app/appConfigLoaded",a);this._refreshAppActions()},onMapLoaded:function(a,b){r.setInstance(a,b);l.publish("app/mapLoaded",
a)},onMapChanged:function(a,b){r.setInstance(a,b);l.publish("app/mapChanged",a)},onSceneViewLoaded:function(a){l.publish("app/sceneViewLoaded",a)},onSceneViewChanged:function(a){l.publish("app/sceneViewChanged",a)},onAppConfigChanged:function(a,b,c){a=this._processAppConfig(a);l.publish("app/appConfigChanged",a,b,c);this._refreshAppActions()},onPreloadWidgetsLoaded:function(){l.publish("app/preloadWidgetsLoaded")},onMapCreatedFailed:function(){l.publish("app/mapCreatedFailed")},onDataSourceDataUpdated:function(a,
b){l.publish("app/dataSourceDataUpdated",a,b)},onLayoutDefinitionChanged:function(a){this.hideLoadingCover();l.publish("layoutDefinitionChanged",a)},onEditLayoutCancelled:function(){this.hideLoadingCover()},onEditLayout:function(){l.publish("app/editLayout")},_processAppConfig:function(a){a=c.reCreateObject(a);v.defaults.geometryService=this._getGeomtryServiceByAppConfig(a);this.appConfig=a;return window.appConfig=a},_showPreviewMore:function(){this.previewViewStack.switchView(this.previewMore);if(!this.previewMoreFrameNode.src&&
this._PreviewMoreIframeSrc)this._initPreviewMoreViewerPosition(),q.attr(this.previewMoreFrameNode,"src",this._PreviewMoreIframeSrc);else{var a=e.clone(this.appConfig);a.mode="preview";this._syncPreviewMapExtentWithConfigMapExtent();this.previewViewerTopic.publish("builder/setAppConfig",a)}},_syncPreviewMapExtentWithConfigMapExtent:function(){var a=window.configWindow&&window.configWindow._viewerMap,b=window.previewWindow&&window.previewWindow._viewerMap;a&&b&&this.previewViewerTopic&&this.previewViewerTopic.publish("builder/syncExtent",
a)},_syncPreviewViewpointWithConfigViewpoint:function(){var a=window.configWindow&&window.configWindow._sceneView,b=window.previewWindow&&window.previewWindow._sceneView;a&&b&&this.previewViewerTopic&&this.previewViewerTopic.publish("builder/syncViewpoint",a.viewpoint)},_initPreviewMoreViewerPosition:function(){var a=q.getMarginBox(this.previewMore);q.setStyle(this.previewMoreContainer,{width:a.w-220+"px",height:a.h-130+"px"});q.setStyle(this.previewMoreIframeSection,"marginTop","50px")},_setPreviewMoreViewerPosition:function(){var a=
q.getMarginBox(this.previewMore).h,b=q.getMarginBox(this.previewMoreContainer),c=q.getStyle(this.previewMoreContainer,"paddingTop"),d=q.getStyle(this.previewMoreContainer,"paddingBottom"),a=(a-(b.h+c+d))/2;0>a&&(a=0);q.setStyle(this.previewMoreIframeSection,"marginTop",a+"px")},_resizePreviewMore:function(a){a?this._showPortrait():this._showLandscape();setTimeout(e.hitch(this,function(){this._syncPreviewMapExtentWithConfigMapExtent()}),500)},_showPortrait:function(){this._deviceInfo&&(this._isPortrait=
!0,q.setStyle(this.previewMoreContainer,{width:this._deviceInfo.width+44+"px",height:this._deviceInfo.height+44+"px"}),q.addClass(this.btnPortrait,"selected"),q.removeClass(this.btnLandscape,"selected"),this._setPreviewMoreViewerPosition())},_showLandscape:function(){this._deviceInfo&&(this._isPortrait=!1,q.setStyle(this.previewMoreContainer,{width:this._deviceInfo.height+44+"px",height:this._deviceInfo.width+44+"px"}),q.removeClass(this.btnPortrait,"selected"),q.addClass(this.btnLandscape,"selected"),
this._setPreviewMoreViewerPosition())},_onPreloadWidgetsLoaded:function(){this.hideLoadingCover()},_onMapCreatedFailed:function(){this.hideLoadingCover()},_loadTemplateConfigOptsPlugin:function(){var a=this.filterExtensionsByAppType("template-config-part",this.options.appInfo.appType);if(0!==a.length)return this.pluginManager.loadPlugin(this.pluginsMeta[a[0].pluginName]).then(e.hitch(this,function(a){q.place(a.domNode,this.templateOptsPaneNode);a.startup();return a}))},_loadConfigTemplatePlugin:function(){var a=
this.filterExtensionsByAppType("config-template",this.options.appInfo.appType);if(0!==a.length)return this.pluginManager.loadPlugin(this.pluginsMeta[a[0].pluginName]).then(e.hitch(this,function(a){q.place(a.domNode,this.configTemplateNode);a.startup();this.saveTemplatePluginBox=a.savePluginNode;return a}))}})})},"jimu/dijit/ViewStack":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/_base/html","dojo/_base/array","dijit/_WidgetBase"],function(k,e,p,q,n){return k(n,{baseClass:"jimu-viewstack",
declaredClass:"jimu.dijit.ViewStack",_currentView:null,postCreate:function(){this.inherited(arguments);this.views||(this.views=[]);q.forEach(this.views,e.hitch(this,function(e){1===e.nodeType?(p.place(e,this.domNode),p.addClass(e,"view"),p.setStyle(e,"display","none")):e.domNode&&(p.place(e.domNode,this.domNode),p.addClass(e.domNode,"view"),p.setStyle(e.domNode,"display","none"))}))},startup:function(){this.inherited(arguments);0<this.views.length&&this.switchView(0)},getSelectedView:function(){return this._currentView},
getSelectedLabel:function(){var e="",h=this.getSelectedView();h&&(e=h.label);return e},getViewByLabel:function(e){for(var h=0;h<this.views.length;h++)if(e===this.views[h].label)return this.views[h];return null},addView:function(e){this.views.push(e);1===e.nodeType?(p.place(e,this.domNode),p.addClass(e,"view")):e.domNode&&(p.place(e.domNode,this.domNode),p.addClass(e.domNode,"view"))},removeView:function(e){var h=this.views.length;this.views=q.filter(this.views,function(f){return e!==f});h!==this.views.length&&
(1===e.nodeType?p.destroy(e):e.domNode&&e.destroyRecursive())},switchView:function(l){var h,f;h="number"===typeof l?this.views[l]:"string"===typeof l?this.getViewByLabel(l):l;this.views.forEach(e.hitch(this,function(d){if(d)if(1===d.nodeType?f=d:d.domNode&&(f=d.domNode),d===h){if(p.setStyle(f,"display","block"),d.domNode)if(!d._started)d.startup(),d._started=!0;else if("function"===typeof d.onShown)d.onShown()}else if(p.setStyle(f,"display","none"),d.domNode&&"function"===typeof d.onHidden)d.onHidden()}));
this._currentView=h;this.onViewSwitch(h)},onViewSwitch:function(){}})})},"jimu/dijit/LoadingShelter":function(){define(["dojo/_base/declare","dijit/_WidgetBase","dijit/_TemplatedMixin","dojo/text!./templates/LoadingShelter.html","dojo/_base/html"],function(k,e,p,q,n){return k([e,p],{baseClass:"jimu-loading-shelter",declaredClass:"jimu.dijit.LoadingShelter",templateString:q,loadingText:null,hidden:!1,showLoading:!0,postMixInProperties:function(){this.nls=window.jimuNls.loadingShelter},postCreate:function(){this.inherited(arguments);
this.hidden&&n.setStyle(this.domNode,"display","none");n.setStyle(this.domNode,{width:"100%",height:"100%"});this.showLoading||n.setStyle(this.loadingNode,"display","none");"string"===typeof this.loadingText&&(this.textNode.innerHTML=this.loadingText)},show:function(e){this.domNode&&this.hidden&&("string"===typeof e&&(this.textNode.innerHTML=e),n.setStyle(this.domNode,"display","block"),this.hidden=!1)},hide:function(){this.domNode&&!this.hidden&&(n.setStyle(this.domNode,"display","none"),this.hidden=
!0)}})})},"jimu/dijit/AGOLLoading":function(){define(["dojo/_base/declare","dijit/_WidgetBase","dijit/_TemplatedMixin","dojo/text!./templates/AGOLLoading.html","dojo/_base/html"],function(k,e,p,q,n){return k([e,p],{baseClass:"jimu-agol-loading",declaredClass:"jimu.dijit.AGOLLoading",templateString:q,loadingText:null,hidden:!1,showLoading:!0,postMixInProperties:function(){this.nls=window.jimuNls.loadingShelter},postCreate:function(){this.inherited(arguments);this.hidden&&n.setStyle(this.domNode,"display",
"none");n.setStyle(this.domNode,{width:"100%",height:"100%"});this.showLoading||n.setStyle(this.imgDiv,"display","none");"string"===typeof this.loadingText&&(this.textNode.innerHTML=this.loadingText)},show:function(e){this.domNode&&this.hidden&&("string"===typeof e&&(this.textNode.innerHTML=e),n.setStyle(this.domNode,"display","block"),this.hidden=!1)},hide:function(){this.domNode&&!this.hidden&&(n.setStyle(this.domNode,"display","none"),this.hidden=!0)}})})},"builder/plugins/app-config-configpart/_build-generate_module":function(){define(["builder/plugins/app-config-configpart/Plugin",
"dojo/text!builder/plugins/app-config-configpart/Plugin.html","dojo/text!builder/plugins/app-config-configpart/css/style.css","dojo/i18n!builder/plugins/app-config-configpart/nls/strings"],function(){})},"builder/plugins/app-config-configpart/Plugin":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/promise/all ./TabContainer2 builder/BasePlugin".split(" "),function(k,e,p,q,n,l){return k([l],{baseClass:"plugin-appconfig-configpart",postCreate:function(){this.inherited(arguments);
this.plugins=[];this.republishEvents=[]},startup:function(){this._createConfigTab();this._addRepublishEvents()},_addRepublishEvents:function(){var e=this.pluginManager.getPluginByName("app-config");p.forEach(this.republishEvents,function(f){e.addRepublishEvent(f)},this)},_createConfigTab:function(){var h=this.filterExtensionsByAppType("config-sections",window.appInfo.appType);p.some(h,e.hitch(this,function(d){return"map-config"===d.pluginName?(d.parameters.label="HTML3D"===window.appInfo.appType?
window.jimuNls.common.scene:window.jimuNls.common.map,!0):!1}));var f=[];p.forEach(h,function(d){f.push(this.pluginManager.loadPlugin(this.pluginsMeta[d.pluginName]));d=d.parameters.republishEvents.split(",");this.republishEvents=this.republishEvents.concat(d)},this);q(f).then(e.hitch(this,function(d){var c=[];p.forEach(d,function(a,b){b=h[b];this.plugins.push(a);c.push({title:b.parameters.label,icon:b.parameters.icon,selectedIcon:b.parameters.selectedIcon,content:a,index:b.parameters.index})},this);
c.sort(function(a,b){return a.index-b.index});this.tab=new n({tabs:c,selected:c[0].title},this.tabsNode);this.tab.startup()}),e.hitch(this,function(d){console.error(d)}))},_onMapChanged:function(e){this.map=e}})})},"builder/plugins/app-config-configpart/TabContainer2":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/html dojo/on dojo/Evented dojo/query dijit/_WidgetBase dijit/_TemplatedMixin dojo/text!./TabContainer2.html jimu/dijit/ViewStack".split(" "),function(k,
e,p,q,n,l,h,f,d,c,a){return k([f,d,l],{templateString:c,_controlNodes:null,selected:"",tabs:null,"class":"jimu-tab2",postCreate:function(){this.inherited(arguments);this._controlNodes=[];this.viewStack=new a(null,this.containerNode);p.forEach(this.tabs,function(a){this._createTab(a)},this)},startup:function(){this.selected?this.selectTab(this.selected):0<this.tabs.length&&this.selectTab(this.tabs[0].title)},_createTab:function(a){var b=q.toDom('\x3ctd\x3e\x3cdiv class\x3d"tab-item-div"\x3e\x3cdiv class\x3d"tab-item-icon"\x3e\x3c/div\x3e\x3cdiv class\x3d"tab-item-title"\x3e\x3c/div\x3e\x3c/div\x3e\x3c/td\x3e');
q.place(b,this.tabTr);var c=h(".tab-item-div",b)[0],d=h(".tab-item-icon",b)[0];h(".tab-item-title",b)[0].innerHTML=a.title||"";q.setAttr(c,"title",a.title||"");q.setStyle(d,"backgroundImage","url("+a.icon+")");this.viewStack.viewType=a.content.domNode?"dijit":"dom";c.tabConfig=a;c.iconNode=d;a.content.label=a.title;this.viewStack.addView(a.content);this.own(n(c,"click",e.hitch(this,this.onSelect,a.title)));this._controlNodes.push(c)},onSelect:function(a){this.selectTab(a)},selectTab:function(a){p.forEach(this._controlNodes,
e.hitch(this,function(b){var c="";b.tabConfig.title===a?(q.addClass(b,"selected-tab-item-div"),c=b.tabConfig.selectedIcon):(q.removeClass(b,"selected-tab-item-div"),c=b.tabConfig.icon);q.setStyle(b.iconNode,"backgroundImage","url("+c+")")}));this.viewStack.switchView(a);this.emit("tabChanged",a)}})})},"builder/plugins/app-config-morepreview-selectionpart/_build-generate_module":function(){define(["builder/plugins/app-config-morepreview-selectionpart/Plugin","dojo/text!builder/plugins/app-config-morepreview-selectionpart/Plugin.html",
"dojo/text!builder/plugins/app-config-morepreview-selectionpart/css/style.css","dojo/i18n!builder/plugins/app-config-morepreview-selectionpart/nls/strings"],function(){})},"builder/plugins/app-config-morepreview-selectionpart/Plugin":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/on dojo/query builder/BasePlugin jimu/portalUrlUtils jimu/dijit/QRCode".split(" "),function(k,e,p,q,n,l,h,f){return k([l],{baseClass:"plugin-appconfig-morepreview-selectionpart",postCreate:function(){this.inherited(arguments);
this._bindEvents();this._appConfigPlugin=this.pluginManager.getPluginByName("app-config")},startup:function(){this.inherited(arguments);this._initPreviewItems();this._initQRCode()},_bindEvents:function(){this.own(q(this.customWidth,"blur",e.hitch(this,this._onCustomSizeChanged)));this.own(q(this.customHeight,"blur",e.hitch(this,this._onCustomSizeChanged)))},_initPreviewItems:function(){p.empty(this.previewTbody);var d=[];d.push({"class":"iPhoneX",title:"iPhone X",width:375,height:812});d.push({"class":"iPhone6-plus",
title:"iPhone 8 Plus / iPhone 7 Plus / 6s Plus / 6 Plus",width:414,height:736});d.push({"class":"iPhone6",title:"iPhone 8 / iPhone 7 / 6s / 6",width:375,height:667});d.push({"class":"iPhone5",title:"iPhone SE / 5 / 5C / 5S",width:320,height:568});d.push({"class":"iPhone4",title:"iPhone 4s / 4",width:320,height:480});d.push({"class":"xiaomi-3",title:"LG G5 / G4 / G3",width:360,height:640});d.push({"class":"xiaomi-3",title:"Huawei Mate 9",width:360,height:640});d.push({"class":"xiaomi-3",title:"Lenovo Z2 Pro",
width:360,height:640});d.push({"class":"xiaomi-3",title:"Xiaomi Mi 5",width:360,height:640});d.push({"class":"htc-one",title:"HTC 10",width:360,height:640});d.push({"class":"Samsung-s8",title:"Samsung Galaxy S8 / Samsung Galaxy S8 Plus",width:360,height:740});d.push({"class":"Samsung-Galaxy-S4",title:"Samsung Galaxy S7, S7 edge",width:360,height:640});d.push({"class":"Samsung-Note-3",title:"Samsung Galaxy Note 4",width:360,height:640});d.push({"class":"new-iPad",title:"Google Nexus 10",width:800,
height:1280});d.push({"class":"Nexus-5",title:"Google Nexus 6",width:412,height:732});d.push({"class":"Nexus-4",title:"Google Nexus 5",width:360,height:640});d.push({"class":"iPad-Air",title:"iPad Pro",width:1024,height:1366});d.push({"class":"iPad-Air",title:"iPad 3 / 4 / Air / Air2",width:768,height:1024});d.push({"class":"iPad-mini",title:"iPad mini 2 / 3",width:768,height:1024});d.push({"class":"new-iPad",title:"Surface Pro 3",width:1024,height:1440});d.push({"class":"new-iPad",title:"Surface Pro / Pro 2",
width:720,height:1280});var c=Math.ceil(d.length/4),a;for(a=0;a<c;a++){var b=p.toDom("\x3ctr\x3e\x3ctd\x3e\x3c/td\x3e\x3ctd\x3e\x3c/td\x3e\x3ctd\x3e\x3c/td\x3e\x3ctd\x3e\x3c/td\x3e\x3c/tr\x3e");p.place(b,this.previewTbody)}c=n("td",this.previewTbody);for(a=0;a<d.length;a++){var b=c[a],g=this._createPreviewItem(d[a]);p.place(g,b)}},_createPreviewItem:function(d){var c=p.toDom('\x3cdiv class\x3d"preview-item"\x3e\x3cdiv class\x3d"preview-item-bg"\x3e\x3cdiv class\x3d"preview-item-thumbnail"\x3e\x3c/div\x3e\x3cdiv class\x3d"preview-selected-icon"\x3e\x3c/div\x3e\x3c/div\x3e\x3cspan class\x3d"preview-item-title"\x3e\x3c/span\x3e\x3c/div\x3e');
c.args=d;var a=n(".preview-item-bg",c)[0],b=n(".preview-item-thumbnail",c)[0],g=n(".preview-item-title",c)[0];this.own(q(a,"click",e.hitch(this,this._onPreviewItemBgClick)));d["class"]&&p.addClass(b,d["class"]);g.innerHTML=d.title||"";return c},_onPreviewItemBgClick:function(d){d=d.target||d.srcElement;p.hasClass(d,"preview-item-thumbnail")&&(d=d.parentNode,n(".preview-item-bg",this.previewTbody).removeClass("selected"),p.addClass(d,"selected"),d=d.parentNode.args,this.customWidth.value=d.width,this.customHeight.value=
d.height,this._appConfigPlugin.previewOnDevice(d,!1))},_onCustomSizeChanged:function(){var d=function(a){var b=!1;isNaN(a)||isNaN(parseFloat(a))||0<parseInt(a,10)&&(b=!0);return b},c=this.customWidth.value,a=this.customHeight.value;d(c)&&d(a)&&(n(".preview-item-bg",this.previewTbody).removeClass("selected"),c=parseInt(c,10),a=parseInt(a,10),this._appConfigPlugin.previewOnDevice({width:c,height:a},!0))},_initQRCode:function(){var d="";window.isXT?d=window.location.protocol+"//"+window.location.host+
path+"apps/"+window.appInfo.id:(d=h.getStandardPortalUrl(window.portalUrl),d=h.setProtocol(d,window.location.protocol),d=window.queryObject.appid?d+"/apps/webappviewer/index.html?appid\x3d"+window.appInfo.id:d+"/apps/webappviewer/index.html?id\x3d"+window.appInfo.id);new f({text:d,width:75,height:75},this.qrcodeImage);p.setAttr(this.qrcodeDescription,"innerHTML",this.nls.qrcodeDesc);setTimeout(function(){n(".qrcode-image table").style("margin","0px")},100)}})})},"jimu/dijit/QRCode":function(){define(["dojo/_base/declare",
"dijit/_WidgetBase","libs/qrcode"],function(k,e){return k([e],{baseClass:"jimu-qrcode",declaredClass:"jimu.dijit.QRCode",postCreate:function(){new QRCode(this.domNode,{text:this.text,width:this.width||128,height:this.height||128,colorDark:this.colorDark||" #000000",colorLight:this.colorLight||"#ffffff",correctLevel:this.correctLevel||QRCode.CorrectLevel.L})}})})},"libs/qrcode":function(){define(["dojo","dijit","dojox"],function(k,e,p){var q;(function(){function e(b){this.mode=a.MODE_8BIT_BYTE;this.data=
b;this.parsedData=[];b=0;for(var c=this.data.length;b<c;b++){var d=[],g=this.data.charCodeAt(b);65536<g?(d[0]=240|(g&1835008)>>>18,d[1]=128|(g&258048)>>>12,d[2]=128|(g&4032)>>>6,d[3]=128|g&63):2048<g?(d[0]=224|(g&61440)>>>12,d[1]=128|(g&4032)>>>6,d[2]=128|g&63):128<g?(d[0]=192|(g&1984)>>>6,d[1]=128|g&63):d[0]=g;this.parsedData.push(d)}this.parsedData=Array.prototype.concat.apply([],this.parsedData);this.parsedData.length!=this.data.length&&(this.parsedData.unshift(191),this.parsedData.unshift(187),
this.parsedData.unshift(239))}function l(a,b){this.typeNumber=a;this.errorCorrectLevel=b;this.modules=null;this.moduleCount=0;this.dataCache=null;this.dataList=[]}function h(a,b){if(void 0==a.length)throw Error(a.length+"/"+b);for(var c=0;c<a.length&&0==a[c];)c++;this.num=Array(a.length-c+b);for(b=0;b<a.length-c;b++)this.num[b]=a[b+c]}function f(a,b){this.totalCount=a;this.dataCount=b}function d(){this.buffer=[];this.length=0}function c(){var a=!1,b=navigator.userAgent;/android/i.test(b)&&(a=!0,(aMat=
b.toString().match(/android ([0-9]\.[0-9])/i))&&aMat[1]&&(a=parseFloat(aMat[1])));return a}e.prototype={getLength:function(a){return this.parsedData.length},write:function(a){for(var b=0,c=this.parsedData.length;b<c;b++)a.put(this.parsedData[b],8)}};l.prototype={addData:function(a){a=new e(a);this.dataList.push(a);this.dataCache=null},isDark:function(a,b){if(0>a||this.moduleCount<=a||0>b||this.moduleCount<=b)throw Error(a+","+b);return this.modules[a][b]},getModuleCount:function(){return this.moduleCount},
make:function(){this.makeImpl(!1,this.getBestMaskPattern())},makeImpl:function(a,b){this.moduleCount=4*this.typeNumber+17;this.modules=Array(this.moduleCount);for(var c=0;c<this.moduleCount;c++){this.modules[c]=Array(this.moduleCount);for(var d=0;d<this.moduleCount;d++)this.modules[c][d]=null}this.setupPositionProbePattern(0,0);this.setupPositionProbePattern(this.moduleCount-7,0);this.setupPositionProbePattern(0,this.moduleCount-7);this.setupPositionAdjustPattern();this.setupTimingPattern();this.setupTypeInfo(a,
b);7<=this.typeNumber&&this.setupTypeNumber(a);null==this.dataCache&&(this.dataCache=l.createData(this.typeNumber,this.errorCorrectLevel,this.dataList));this.mapData(this.dataCache,b)},setupPositionProbePattern:function(a,b){for(var c=-1;7>=c;c++)if(!(-1>=a+c||this.moduleCount<=a+c))for(var d=-1;7>=d;d++)-1>=b+d||this.moduleCount<=b+d||(this.modules[a+c][b+d]=0<=c&&6>=c&&(0==d||6==d)||0<=d&&6>=d&&(0==c||6==c)||2<=c&&4>=c&&2<=d&&4>=d?!0:!1)},getBestMaskPattern:function(){for(var a=0,b=0,c=0;8>c;c++){this.makeImpl(!0,
c);var d=g.getLostPoint(this);if(0==c||a>d)a=d,b=c}return b},createMovieClip:function(a,b,c){a=a.createEmptyMovieClip(b,c);this.make();for(b=0;b<this.modules.length;b++){c=1*b;for(var d=0;d<this.modules[b].length;d++){var g=1*d;this.modules[b][d]&&(a.beginFill(0,100),a.moveTo(g,c),a.lineTo(g+1,c),a.lineTo(g+1,c+1),a.lineTo(g,c+1),a.endFill())}}return a},setupTimingPattern:function(){for(var a=8;a<this.moduleCount-8;a++)null==this.modules[a][6]&&(this.modules[a][6]=0==a%2);for(a=8;a<this.moduleCount-
8;a++)null==this.modules[6][a]&&(this.modules[6][a]=0==a%2)},setupPositionAdjustPattern:function(){for(var a=g.getPatternPosition(this.typeNumber),b=0;b<a.length;b++)for(var c=0;c<a.length;c++){var d=a[b],f=a[c];if(null==this.modules[d][f])for(var e=-2;2>=e;e++)for(var m=-2;2>=m;m++)this.modules[d+e][f+m]=-2==e||2==e||-2==m||2==m||0==e&&0==m?!0:!1}},setupTypeNumber:function(a){for(var b=g.getBCHTypeNumber(this.typeNumber),c=0;18>c;c++){var d=!a&&1==(b>>c&1);this.modules[Math.floor(c/3)][c%3+this.moduleCount-
8-3]=d}for(c=0;18>c;c++)d=!a&&1==(b>>c&1),this.modules[c%3+this.moduleCount-8-3][Math.floor(c/3)]=d},setupTypeInfo:function(a,b){b=g.getBCHTypeInfo(this.errorCorrectLevel<<3|b);for(var c=0;15>c;c++){var d=!a&&1==(b>>c&1);6>c?this.modules[c][8]=d:8>c?this.modules[c+1][8]=d:this.modules[this.moduleCount-15+c][8]=d}for(c=0;15>c;c++)d=!a&&1==(b>>c&1),8>c?this.modules[8][this.moduleCount-c-1]=d:9>c?this.modules[8][15-c-1+1]=d:this.modules[8][15-c-1]=d;this.modules[this.moduleCount-8][8]=!a},mapData:function(a,
b){for(var c=-1,d=this.moduleCount-1,f=7,e=0,m=this.moduleCount-1;0<m;m-=2)for(6==m&&m--;;){for(var h=0;2>h;h++)if(null==this.modules[d][m-h]){var l=!1;e<a.length&&(l=1==(a[e]>>>f&1));g.getMask(b,d,m-h)&&(l=!l);this.modules[d][m-h]=l;f--; -1==f&&(e++,f=7)}d+=c;if(0>d||this.moduleCount<=d){d-=c;c=-c;break}}}};l.PAD0=236;l.PAD1=17;l.createData=function(a,b,c){b=f.getRSBlocks(a,b);for(var e=new d,m=0;m<c.length;m++){var h=c[m];e.put(h.mode,4);e.put(h.getLength(),g.getLengthInBits(h.mode,a));h.write(e)}for(m=
a=0;m<b.length;m++)a+=b[m].dataCount;if(e.getLengthInBits()>8*a)throw Error("code length overflow. ("+e.getLengthInBits()+"\x3e"+8*a+")");for(e.getLengthInBits()+4<=8*a&&e.put(0,4);0!=e.getLengthInBits()%8;)e.putBit(!1);for(;!(e.getLengthInBits()>=8*a);){e.put(l.PAD0,8);if(e.getLengthInBits()>=8*a)break;e.put(l.PAD1,8)}return l.createBytes(e,b)};l.createBytes=function(a,b){for(var c=0,d=0,f=0,e=Array(b.length),m=Array(b.length),l=0;l<b.length;l++){var k=b[l].dataCount,n=b[l].totalCount-k,d=Math.max(d,
k),f=Math.max(f,n);e[l]=Array(k);for(var r=0;r<e[l].length;r++)e[l][r]=255&a.buffer[r+c];c+=k;r=g.getErrorCorrectPolynomial(n);k=(new h(e[l],r.getLength()-1)).mod(r);m[l]=Array(r.getLength()-1);for(r=0;r<m[l].length;r++)n=r+k.getLength()-m[l].length,m[l][r]=0<=n?k.get(n):0}for(r=l=0;r<b.length;r++)l+=b[r].totalCount;a=Array(l);for(r=c=0;r<d;r++)for(l=0;l<b.length;l++)r<e[l].length&&(a[c++]=e[l][r]);for(r=0;r<f;r++)for(l=0;l<b.length;l++)r<m[l].length&&(a[c++]=m[l][r]);return a};for(var a={MODE_NUMBER:1,
MODE_ALPHA_NUM:2,MODE_8BIT_BYTE:4,MODE_KANJI:8},b={L:1,M:0,Q:3,H:2},g={PATTERN_POSITION_TABLE:[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,
86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]],G15:1335,G18:7973,G15_MASK:21522,getBCHTypeInfo:function(a){for(var b=a<<10;0<=g.getBCHDigit(b)-g.getBCHDigit(g.G15);)b^=g.G15<<g.getBCHDigit(b)-g.getBCHDigit(g.G15);return(a<<10|b)^g.G15_MASK},getBCHTypeNumber:function(a){for(var b=a<<12;0<=g.getBCHDigit(b)-g.getBCHDigit(g.G18);)b^=g.G18<<g.getBCHDigit(b)-
g.getBCHDigit(g.G18);return a<<12|b},getBCHDigit:function(a){for(var b=0;0!=a;)b++,a>>>=1;return b},getPatternPosition:function(a){return g.PATTERN_POSITION_TABLE[a-1]},getMask:function(a,b,c){switch(a){case 0:return 0==(b+c)%2;case 1:return 0==b%2;case 2:return 0==c%3;case 3:return 0==(b+c)%3;case 4:return 0==(Math.floor(b/2)+Math.floor(c/3))%2;case 5:return 0==b*c%2+b*c%3;case 6:return 0==(b*c%2+b*c%3)%2;case 7:return 0==(b*c%3+(b+c)%2)%2;default:throw Error("bad maskPattern:"+a);}},getErrorCorrectPolynomial:function(a){for(var b=
new h([1],0),c=0;c<a;c++)b=b.multiply(new h([1,k.gexp(c)],0));return b},getLengthInBits:function(b,c){if(1<=c&&10>c)switch(b){case a.MODE_NUMBER:return 10;case a.MODE_ALPHA_NUM:return 9;case a.MODE_8BIT_BYTE:return 8;case a.MODE_KANJI:return 8;default:throw Error("mode:"+b);}else if(27>c)switch(b){case a.MODE_NUMBER:return 12;case a.MODE_ALPHA_NUM:return 11;case a.MODE_8BIT_BYTE:return 16;case a.MODE_KANJI:return 10;default:throw Error("mode:"+b);}else if(41>c)switch(b){case a.MODE_NUMBER:return 14;
case a.MODE_ALPHA_NUM:return 13;case a.MODE_8BIT_BYTE:return 16;case a.MODE_KANJI:return 12;default:throw Error("mode:"+b);}else throw Error("type:"+c);},getLostPoint:function(a){for(var b=a.getModuleCount(),c=0,d=0;d<b;d++)for(var g=0;g<b;g++){for(var f=0,e=a.isDark(d,g),m=-1;1>=m;m++)if(!(0>d+m||b<=d+m))for(var h=-1;1>=h;h++)0>g+h||b<=g+h||0==m&&0==h||e!=a.isDark(d+m,g+h)||f++;5<f&&(c+=3+f-5)}for(d=0;d<b-1;d++)for(g=0;g<b-1;g++)if(f=0,a.isDark(d,g)&&f++,a.isDark(d+1,g)&&f++,a.isDark(d,g+1)&&f++,
a.isDark(d+1,g+1)&&f++,0==f||4==f)c+=3;for(d=0;d<b;d++)for(g=0;g<b-6;g++)a.isDark(d,g)&&!a.isDark(d,g+1)&&a.isDark(d,g+2)&&a.isDark(d,g+3)&&a.isDark(d,g+4)&&!a.isDark(d,g+5)&&a.isDark(d,g+6)&&(c+=40);for(g=0;g<b;g++)for(d=0;d<b-6;d++)a.isDark(d,g)&&!a.isDark(d+1,g)&&a.isDark(d+2,g)&&a.isDark(d+3,g)&&a.isDark(d+4,g)&&!a.isDark(d+5,g)&&a.isDark(d+6,g)&&(c+=40);for(g=f=0;g<b;g++)for(d=0;d<b;d++)a.isDark(d,g)&&f++;return c+Math.abs(100*f/b/b-50)/5*10}},k={glog:function(a){if(1>a)throw Error("glog("+a+
")");return k.LOG_TABLE[a]},gexp:function(a){for(;0>a;)a+=255;for(;256<=a;)a-=255;return k.EXP_TABLE[a]},EXP_TABLE:Array(256),LOG_TABLE:Array(256)},m=0;8>m;m++)k.EXP_TABLE[m]=1<<m;for(m=8;256>m;m++)k.EXP_TABLE[m]=k.EXP_TABLE[m-4]^k.EXP_TABLE[m-5]^k.EXP_TABLE[m-6]^k.EXP_TABLE[m-8];for(m=0;255>m;m++)k.LOG_TABLE[k.EXP_TABLE[m]]=m;h.prototype={get:function(a){return this.num[a]},getLength:function(){return this.num.length},multiply:function(a){for(var b=Array(this.getLength()+a.getLength()-1),c=0;c<this.getLength();c++)for(var d=
0;d<a.getLength();d++)b[c+d]^=k.gexp(k.glog(this.get(c))+k.glog(a.get(d)));return new h(b,0)},mod:function(a){if(0>this.getLength()-a.getLength())return this;for(var b=k.glog(this.get(0))-k.glog(a.get(0)),c=Array(this.getLength()),d=0;d<this.getLength();d++)c[d]=this.get(d);for(d=0;d<a.getLength();d++)c[d]^=k.gexp(k.glog(a.get(d))+b);return(new h(c,0)).mod(a)}};f.RS_BLOCK_TABLE=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],
[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,2,117,93],[6,58,36,2,59,37],[4,
46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,43,15],[3,141,113,4,142,114],[3,
70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,14,55,25],[16,45,15,14,46,16],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,17],[8,132,106,4,133,107],[8,75,47,13,76,48],[7,54,24,22,55,25],[22,45,15,13,
46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,152,122,4,153,123],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,147,117,10,148,118],[3,73,45,23,74,46],[4,54,24,31,55,25],[11,45,15,31,46,16],[7,146,116,7,147,117],[21,73,45,7,74,46],[1,53,23,37,54,24],[19,45,15,26,46,16],[5,145,115,10,146,116],[19,75,47,10,76,48],[15,54,24,25,55,25],[23,45,15,25,46,16],[13,145,115,3,146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],[23,45,15,28,46,16],[17,145,115],
[10,74,46,23,75,47],[10,54,24,35,55,25],[19,45,15,35,46,16],[17,145,115,1,146,116],[14,74,46,21,75,47],[29,54,24,19,55,25],[11,45,15,46,46,16],[13,145,115,6,146,116],[14,74,46,23,75,47],[44,54,24,7,55,25],[59,46,16,1,47,17],[12,151,121,7,152,122],[12,75,47,26,76,48],[39,54,24,14,55,25],[22,45,15,41,46,16],[6,151,121,14,152,122],[6,75,47,34,76,48],[46,54,24,10,55,25],[2,45,15,64,46,16],[17,152,122,4,153,123],[29,74,46,14,75,47],[49,54,24,10,55,25],[24,45,15,46,46,16],[4,152,122,18,153,123],[13,74,
46,32,75,47],[48,54,24,14,55,25],[42,45,15,32,46,16],[20,147,117,4,148,118],[40,75,47,7,76,48],[43,54,24,22,55,25],[10,45,15,67,46,16],[19,148,118,6,149,119],[18,75,47,31,76,48],[34,54,24,34,55,25],[20,45,15,61,46,16]];f.getRSBlocks=function(a,b){var c=f.getRsBlockTable(a,b);if(void 0==c)throw Error("bad rs block @ typeNumber:"+a+"/errorCorrectLevel:"+b);a=c.length/3;b=[];for(var d=0;d<a;d++)for(var g=c[3*d+0],e=c[3*d+1],m=c[3*d+2],h=0;h<g;h++)b.push(new f(e,m));return b};f.getRsBlockTable=function(a,
c){switch(c){case b.L:return f.RS_BLOCK_TABLE[4*(a-1)+0];case b.M:return f.RS_BLOCK_TABLE[4*(a-1)+1];case b.Q:return f.RS_BLOCK_TABLE[4*(a-1)+2];case b.H:return f.RS_BLOCK_TABLE[4*(a-1)+3]}};d.prototype={get:function(a){return 1==(this.buffer[Math.floor(a/8)]>>>7-a%8&1)},put:function(a,b){for(var c=0;c<b;c++)this.putBit(1==(a>>>b-c-1&1))},getLengthInBits:function(){return this.length},putBit:function(a){var b=Math.floor(this.length/8);this.buffer.length<=b&&this.buffer.push(0);a&&(this.buffer[b]|=
128>>>this.length%8);this.length++}};var r=[[17,14,11,7],[32,26,20,14],[53,42,32,24],[78,62,46,34],[106,84,60,44],[134,106,74,58],[154,122,86,64],[192,152,108,84],[230,180,130,98],[271,213,151,119],[321,251,177,137],[367,287,203,155],[425,331,241,177],[458,362,258,194],[520,412,292,220],[586,450,322,250],[644,504,364,280],[718,560,394,310],[792,624,442,338],[858,666,482,382],[929,711,509,403],[1003,779,565,439],[1091,857,611,461],[1171,911,661,511],[1273,997,715,535],[1367,1059,751,593],[1465,1125,
805,625],[1528,1190,868,658],[1628,1264,908,698],[1732,1370,982,742],[1840,1452,1030,790],[1952,1538,1112,842],[2068,1628,1168,898],[2188,1722,1228,958],[2303,1809,1283,983],[2431,1911,1351,1051],[2563,1989,1423,1093],[2699,2099,1499,1139],[2809,2213,1579,1219],[2953,2331,1663,1273]],m=function(){var a=function(a,b){this._el=a;this._htOption=b};a.prototype.draw=function(a){function b(a,b){a=document.createElementNS("http://www.w3.org/2000/svg",a);for(var c in b)b.hasOwnProperty(c)&&a.setAttribute(c,
b[c]);return a}var c=this._htOption,d=this._el,g=a.getModuleCount();this.clear();var f=b("svg",{viewBox:"0 0 "+String(g)+" "+String(g),width:"100%",height:"100%",fill:c.colorLight});f.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xlink","http://www.w3.org/1999/xlink");d.appendChild(f);f.appendChild(b("rect",{fill:c.colorDark,width:"1",height:"1",id:"template"}));for(c=0;c<g;c++)for(d=0;d<g;d++)if(a.isDark(c,d)){var e=b("use",{x:String(c),y:String(d)});e.setAttributeNS("http://www.w3.org/1999/xlink",
"href","#template");f.appendChild(e)}};a.prototype.clear=function(){for(;this._el.hasChildNodes();)this._el.removeChild(this._el.lastChild)};return a}(),p="svg"===document.documentElement.tagName.toLowerCase()?m:"undefined"==typeof CanvasRenderingContext2D?function(){var a=function(a,b){this._el=a;this._htOption=b};a.prototype.draw=function(a){for(var b=this._htOption,c=this._el,d=a.getModuleCount(),g=Math.floor(b.width/d),f=Math.floor(b.height/d),e=['\x3ctable style\x3d"border:0;border-collapse:collapse;"\x3e'],
m=0;m<d;m++){e.push("\x3ctr\x3e");for(var h=0;h<d;h++)e.push('\x3ctd style\x3d"border:0;border-collapse:collapse;padding:0;margin:0;width:'+g+"px;height:"+f+"px;background-color:"+(a.isDark(m,h)?b.colorDark:b.colorLight)+';"\x3e\x3c/td\x3e');e.push("\x3c/tr\x3e")}e.push("\x3c/table\x3e");c.innerHTML=e.join("");a=c.childNodes[0];c=(b.width-a.offsetWidth)/2;b=(b.height-a.offsetHeight)/2;0<c&&0<b&&(a.style.margin=b+"px "+c+"px")};a.prototype.clear=function(){this._el.innerHTML=""};return a}():function(){function a(){this._elImage.src=
this._elCanvas.toDataURL("image/png");this._elImage.style.display="block";this._elCanvas.style.display="none"}function b(a,b){var c=this;c._fFail=b;c._fSuccess=a;null===c._bSupportDataURI?(a=document.createElement("img"),b=function(){c._bSupportDataURI=!1;c._fFail&&_fFail.call(c)},a.onabort=b,a.onerror=b,a.onload=function(){c._bSupportDataURI=!0;c._fSuccess&&c._fSuccess.call(c)},a.src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxgljNBAAO9TXL0Y4OHwAAAABJRU5ErkJggg\x3d\x3d"):
!0===c._bSupportDataURI&&c._fSuccess?c._fSuccess.call(c):!1===c._bSupportDataURI&&c._fFail&&c._fFail.call(c)}if(this._android&&2.1>=this._android){var d=1/window.devicePixelRatio,g=CanvasRenderingContext2D.prototype.drawImage;CanvasRenderingContext2D.prototype.drawImage=function(a,b,c,f,e,m,h,l,k){if("nodeName"in a&&/img/i.test(a.nodeName))for(var n=arguments.length-1;1<=n;n--)arguments[n]*=d;else"undefined"==typeof l&&(arguments[1]*=d,arguments[2]*=d,arguments[3]*=d,arguments[4]*=d);g.apply(this,
arguments)}}var f=function(a,b){this._bIsPainted=!1;this._android=c();this._htOption=b;this._elCanvas=document.createElement("canvas");this._elCanvas.width=b.width;this._elCanvas.height=b.height;a.appendChild(this._elCanvas);this._el=a;this._oContext=this._elCanvas.getContext("2d");this._bIsPainted=!1;this._elImage=document.createElement("img");this._elImage.alt="Scan me!";this._elImage.style.display="none";this._el.appendChild(this._elImage);this._bSupportDataURI=null};f.prototype.draw=function(a){var b=
this._elImage,c=this._oContext,d=this._htOption,g=a.getModuleCount(),f=d.width/g,e=d.height/g,m=Math.round(f),h=Math.round(e);b.style.display="none";this.clear();for(b=0;b<g;b++)for(var l=0;l<g;l++){var k=a.isDark(b,l),n=l*f,r=b*e;c.strokeStyle=k?d.colorDark:d.colorLight;c.lineWidth=1;c.fillStyle=k?d.colorDark:d.colorLight;c.fillRect(n,r,f,e);c.strokeRect(Math.floor(n)+.5,Math.floor(r)+.5,m,h);c.strokeRect(Math.ceil(n)-.5,Math.ceil(r)-.5,m,h)}this._bIsPainted=!0};f.prototype.makeImage=function(){this._bIsPainted&&
b.call(this,a)};f.prototype.isPainted=function(){return this._bIsPainted};f.prototype.clear=function(){this._oContext.clearRect(0,0,this._elCanvas.width,this._elCanvas.height);this._bIsPainted=!1};f.prototype.round=function(a){return a?Math.floor(1E3*a)/1E3:a};return f}();q=function(a,d){this._htOption={width:256,height:256,typeNumber:4,colorDark:"#000000",colorLight:"#ffffff",correctLevel:b.H};"string"===typeof d&&(d={text:d});if(d)for(var g in d)this._htOption[g]=d[g];"string"==typeof a&&(a=document.getElementById(a));
this._android=c();this._el=a;this._oQRCode=null;this._oDrawing=new p(this._el,this._htOption);this._htOption.text&&this.makeCode(this._htOption.text)};q.prototype.makeCode=function(a){var c=this._htOption.correctLevel,d=1,g;g=encodeURI(a).toString().replace(/\%[0-9a-fA-F]{2}/g,"a");g=g.length+(g.length!=a?3:0);for(var f=0,e=r.length;f<=e;f++){var m=0;switch(c){case b.L:m=r[f][0];break;case b.M:m=r[f][1];break;case b.Q:m=r[f][2];break;case b.H:m=r[f][3]}if(g<=m)break;else d++}if(d>r.length)throw Error("Too long data");
this._oQRCode=new l(d,this._htOption.correctLevel);this._oQRCode.addData(a);this._oQRCode.make();this._el.title=a;this._oDrawing.draw(this._oQRCode);this.makeImage()};q.prototype.makeImage=function(){"function"==typeof this._oDrawing.makeImage&&(!this._android||3<=this._android)&&this._oDrawing.makeImage()};q.prototype.clear=function(){this._oDrawing.clear()};q.CorrectLevel=b;window.QRCode=q})()})},"dojox/main":function(){define(["dojo/_base/kernel"],function(k){return k.dojox})},"builder/plugins/app-config-template-configpart/_build-generate_module":function(){define(["builder/plugins/app-config-template-configpart/Plugin",
"dojo/text!builder/plugins/app-config-template-configpart/Plugin.html","dojo/text!builder/plugins/app-config-template-configpart/css/style.css","dojo/i18n!builder/plugins/app-config-template-configpart/nls/strings"],function(){})},"builder/plugins/app-config-template-configpart/Plugin":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/Deferred dojo/_base/html dojo/promise/all dojo/_base/array dojo/topic builder/BasePlugin jimu/utils builder/dijit/TemplateAttributes".split(" "),function(k,
e,p,q,n,l,h,f,d,c){return k([f],{baseClass:"plugin-appconfig-template-configpart",_appConfig:null,_appConfigLoadDef:null,postCreate:function(){this.inherited(arguments);this._appConfigLoadDef=new p;this._updateDom();this._bindEvent()},startup:function(){this.inherited(arguments);this.isAdvance=!1;n({appConfig:this._appConfigLoadDef}).then(e.hitch(this,function(){this._init()}))},_updateDom:function(){"HTML3D"===window.appInfo.appType&&(q.setAttr(this.mapTitle,"innerHTML",this.nls.scene),q.setAttr(this.selectMapBtn,
"innerHTML",this.nls.chooseWebScene))},_init:function(){if(this.visible&&this._appConfig){var a=this._getCleanTemplateConfigByAppConfig(this._appConfig.templateConfig);this.agoltempAttrs&&this.agoltempAttrs.destroy();this.agoltempAttrs=(new c({templateConfig:a})).placeAt(this.configPart);this.agoltempAttrs.on("fieldChanged",e.hitch(this,this._onAGOLTemplateAttributeChanged))}},_getCleanTemplateConfigByAppConfig:function(a){var b={configurationSettings:[],values:{}};if(a)return l.forEach(a.configurationSettings,
function(a){var c={category:a.category,fields:[]};l.forEach(a.fields,function(a){if(a.fieldName){var g=d.template.getConfigValueWithId(this._appConfig,a.fieldName);void 0!==g&&(c.fields.push(a),b.values[a.fieldName]=g)}},this);0<c.fields.length&&b.configurationSettings.push(c)},this),b},_getTemplateAppConfigByTemplateConfig:function(a,b){var c=this._getDefaultTemplateAppConfig();if(b)return l.forEach(b.configurationSettings,function(b){l.forEach(b.fields,function(b){if(b.fieldName){var g=d.template.getConfigValueWithId(a,
b.fieldName);void 0!==g&&(c.values[b.fieldName]=g)}},this)},this),c},_getChangedTemplateAppConfigFromTemplateAttirbuts:function(a){var b=this._getDefaultTemplateAppConfig(),c=this.agoltempAttrs.getElementDijits(),f;for(f in c)if(c.hasOwnProperty(f)&&"function"!==typeof c[f]){var e=d.template.getConfigValueWithId(a,f);void 0!==e&&e!==c[f].getDijitValue()&&(b.values[f]=e)}return b},_getDefaultTemplateConfig:function(){return{configurationSettings:[{category:"",fields:[]}],values:{}}},_getDefaultTemplateAppConfig:function(){return{source:null,
folderId:null,values:{}}},_onAGOLTemplateAttributeChanged:function(a){d.template.setConfigValueWithId(this._appConfig,a.fieldName,a.value);"Attribute"===a.categoryName?h.publish("appAttributeChanged",{title:this._appConfig.title,subtitle:this._appConfig.subtitle,links:this._appConfig.links,logo:this._appConfig.logo}):(a=d.template.getKeyInfo(a.fieldName),"widget"===a.type?(a=this._appConfig.getConfigElementById(a.id),h.publish("widgetChanged",a)):"group"===a.type?(a=this._appConfig.getConfigElementById(a.id),
h.publish("groupChanged",a)):console.errror("errror"))},_bindEvent:function(){this.own(h.subscribe("app/appConfigLoaded",e.hitch(this,this._onAppConfigLoaded)));this.own(h.subscribe("app/appConfigChanged",e.hitch(this,this._onAppConfigChanged)));this.own(h.subscribe("new-webmap-item-selected",e.hitch(this,this._onWebmapItemSelected)));this.own(h.subscribe("app/mapLoaded",e.hitch(this,this._onMapLoaded)))},_onAppConfigLoaded:function(a){this._appConfig=e.clone(a);this._appConfigLoadDef.resolve(this._appConfig)},
_onAppConfigChanged:function(a){this._appConfig=e.clone(a)},_onSelectMapClick:function(){var a=this.pluginManager.getPluginByName("map-config");a&&a.showMapSelector()},_onWebmapItemSelected:function(a){q.setAttr(this.mapName,"innerHTML",a.title);q.setAttr(this.mapName,"title",a.title)},_onMapLoaded:function(a){q.setAttr(this.mapName,"innerHTML",a.itemInfo.item.title);q.setAttr(this.mapName,"title",a.itemInfo.item.title)},refresh:function(){this._init()}})})},"builder/dijit/TemplateAttributes":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/Deferred dojo/_base/html dojo/on dojo/promise/all dojo/Evented jimu/utils dijit/_WidgetBase dijit/_TemplatedMixin dijit/form/_FormMixin dijit/Tooltip dijit/form/CheckBox dijit/form/NumberTextBox dijit/form/Select dijit/form/ValidationTextBox dijit/form/SimpleTextarea dijit/Editor esri/dijit/ColorPicker dijit/_editor/plugins/TextColor dijit/_editor/plugins/LinkDialog".split(" "),
function(k,e,p,q,n,l,h,f,d,c,a,b,g,u,m,r,t,v,y,w){var z=k([c,a,b,f],{templateString:'\x3cdiv dojoAttachPoint\x3d"containerNode"\x3e\x3c/div\x3e',baseClass:"agoltemplate-attributes",item:null,itemTitle:null,defaultMaxSelectHeight:"150px",defaultTextAreaSize:5,_appConfig:null,_templateConfig:null,_templateAppConfig:null,_elementDijits:null,constructor:function(a){this.nls=e.mixin(this.nls,builderNls);this._init(a.templateConfig,a.templateAppConfig)},destroy:function(){p.forEach(this.tooltips,function(a){a.destroy()});
this.inherited(arguments)},startup:function(){this.buildConfigurationPanel();this.inherited(arguments)},update:function(a){for(var b in a.values)a.values.hasOwnProperty(b)&&"function"!==typeof a.values[b]&&this._elementDijits[b].setDijitValue(a.values[b])},getElementDijits:function(){return this._elementDijits},getTemplateAppConfig:function(){var a=this._getValuesObjOfElementDijits();e.mixin(this._templateAppConfig.values,a);return this._templateAppConfig},onFieldChange:function(a,b,c){this.emit("fieldChanged",
{categoryName:a,fieldName:b,value:c})},_init:function(a,b){this._templateConfig=a||{configurationSettings:{},values:{}};this._templateAppConfig=b||{source:null,folderId:null,values:{webmap:null}};e.mixin(this._templateConfig.values,this._templateAppConfig.values);this._elementDijits={};this._templateConfig.configurationSettings&&this._templateAppConfig.values||console.error("AGOLTemplate config page: please provide correct parameters in the constructor");this.tooltips=[];this.originalItem={id:this._templateConfig.values.webmap||
this._templateConfig.values.group,type:this._templateConfig.values.webmap?"webmap":"group"}},_getWebmapOrGroupItem:function(a,b){var c=new q;try{"webmap"===b?this.portal.queryItems({q:"id:"+a}).then(e.hitch(this,function(a){0<a.results.length&&(this.item=a=a.results[0],this.itemTitle=a.title);c.resolve()})):this.portal.queryGroups({q:"id:"+a}).then(e.hitch(this,function(a){0<a.results.length&&(this.item=a=a.results[0],this.itemTitle=a.title);c.resolve()}))}catch(B){c.resolve()}return c.promise},buildConfigurationPanel:function(){var a=
[];p.forEach(this._templateConfig.configurationSettings,e.hitch(this,function(b){var c=b.category,d=b.fields,f=n.create("fieldset",{},this.containerNode);n.create("legend",e.mixin(b.params||{},{innerHTML:c}),f);p.forEach(d,e.hitch(this,function(b){a.push(this._createField(b,c).then(e.hitch(this,function(a){p.forEach(a.nodes,function(a){n.place(a.domNode||a,f)});n.create("br",{},f);"paragraph"!==a.type&&null!==a.fieldDijit&&b.tooltip&&b.tooltip.length&&this.tooltips.push(new g({connectId:[a.fieldDijit.id],
label:b.tooltip}))})))}))}));h(a).then(e.hitch(this,function(){}))},_createField:function(a,b){var c=new q,g=null,f=a.type&&a.type.toLowerCase()||"string",e=[],m=n.create("layerandfieldselector"===f?"p":"label",{innerHTML:d.stripHTML(a.label)||"",id:f+"_"+a.fieldName,"class":f},null);e.push(m);"boolean"===f?(e.splice(0,0,g=this._createBooleanField(a,b)),n.addClass(m,"checkout-box-label")):"number"===f?e.push(g=this._createNumberField(a,b)):"paragraph"===f?e.splice(0,1,g=this._createParagraph(a)):
a.options?e.push(g=this._createOptionsField(a,b)):"color"===f?e.push(g=this._createColor(a,b)):e.push(g=this._createStringField(a,b));n.setAttr(m,"for",g.id);c.resolve({nodes:e,fieldDijit:g,type:f});return c.promise},_createBooleanField:function(a,b){var c=e.mixin({value:!0,name:a.fieldName},a),d=this._templateConfig.values;c.checked=d&&void 0!==d[a.fieldName]?d[a.fieldName]:!0;c=new u(c);this._afterCreateNormalField(c,b,a.fieldName);return c},_createNumberField:function(a,b){var c=e.mixin({name:a.fieldName,
"class":"field-input"},a),d=this._templateConfig.values;c.value=d&&void 0!==d[a.fieldName]?d[a.fieldName]:a.min||NaN;c=new m(c);this._afterCreateNormalField(c,b,a.fieldName);return c},_createParagraph:function(a){var b=e.mixin({name:a.fieldName||""},a);b.innerHTML=a.value||"";return n.create("p",b)},_createOptionsField:function(a,b){var c={maxHeight:this.defaultMaxSelectHeight,name:a.fieldName,"class":"field-input"},c=e.mixin(c,a),d=-1,g=p.some(c.options,e.hitch(this,function(b,c){d=c;return b.value===
this._templateConfig.values[a.fieldName]?c:!1}));c.options[g?d:0].selected=!0;c=new r(c);this._afterCreateNormalField(c,b,a.fieldName);return c},_createStringField:function(a,b){var c=null,c={regExp:".*",constraints:{},trim:!0,name:a.fieldName,value:(this._templateConfig.values[a.fieldName]||"").toString(),"class":" "},c=e.mixin(c,a);a.stringFieldOption&&a.stringFieldOption===z.STRING_FIELD_OPTION_TEXTAREA?(c["class"]+=" field-input text-area-field",c.rows=a.rows||this.defaultTextAreaSize,c.columns=
a.columns||this.defaultTextAreaSize,c=new v(c)):a.stringFieldOption&&a.stringFieldOption===z.STRING_FIELD_OPTION_RICHTEXT?(c["class"]+=" rich-text-field",c.plugins="bold italic underline foreColor hiliteColor removeFormat | justifyLeft indent outdent | insertOrderedList insertUnorderedList |".split(" "),c.extraPlugins=["createLink","unlink","insertImage"],c=new y(c)):(c["class"]+=" field-input",c=new t(c));this._afterCreateNormalField(c,b,a.fieldName);return c},_createColor:function(a,b){var c=new w({name:a.fieldName,
required:!0,showTransparencySlider:!1,showRecentColors:!1,"class":"color-picker-field"});this._templateConfig.values[a.fieldName]&&c.set("color",this._templateConfig.values[a.fieldName]);c.setDijitValue=e.hitch(c,function(a){this.set("color",a,!1)});c.getDijitValue=e.hitch(c,function(){this.get("color")});this._elementDijits[a.fieldName]=c;c.on("color-change",e.hitch(this,function(c){if(c&&c.color)this.onFieldChange(b,a.fieldName,c.color.toHex())}));return c},_afterCreateNormalField:function(a,b,
c){a.setDijitValue=e.hitch(a,function(a){this.set("value",a,!1)});a.getDijitValue=e.hitch(a,function(){return this.get("value")});this._elementDijits[c]=a;this.own(l(a,"change",e.hitch(this,this.onFieldChange,b,c)))},_getValuesObjOfElementDijits:function(){var a={},b=this.getElementDijits(),c;for(c in b)b.hasOwnProperty(c)&&"function"!==typeof b[c]&&(a[c]=b[c].getDijitValue());return a}});e.mixin(z,{STRING_FIELD_OPTION_TEXTBOX:"textbox",STRING_FIELD_OPTION_TEXTAREA:"textarea",STRING_FIELD_OPTION_RICHTEXT:"richtext"});
return z})},"dijit/form/CheckBox":function(){define("require dojo/_base/declare dojo/dom-attr dojo/has dojo/query dojo/ready ./ToggleButton ./_CheckBoxMixin dojo/text!./templates/CheckBox.html dojo/NodeList-dom ../a11yclick".split(" "),function(k,e,p,q,n,l,h,f,d){q("dijit-legacy-requires")&&l(0,function(){k(["dijit/form/RadioButton"])});return e("dijit.form.CheckBox",[h,f],{templateString:d,baseClass:"dijitCheckBox",_setValueAttr:function(c,a){"string"==typeof c&&(this.inherited(arguments),c=!0);
this._created&&this.set("checked",c,a)},_getValueAttr:function(){return this.checked&&this._get("value")},_setIconClassAttr:null,_setNameAttr:"focusNode",postMixInProperties:function(){this.inherited(arguments);this.checkedAttrSetting=""},_fillContent:function(){},_onFocus:function(){this.id&&n("label[for\x3d'"+this.id+"']").addClass("dijitFocusedLabel");this.inherited(arguments)},_onBlur:function(){this.id&&n("label[for\x3d'"+this.id+"']").removeClass("dijitFocusedLabel");this.inherited(arguments)}})})},
"dijit/form/ToggleButton":function(){define(["dojo/_base/declare","dojo/_base/kernel","./Button","./_ToggleButtonMixin"],function(k,e,p,q){return k("dijit.form.ToggleButton",[p,q],{baseClass:"dijitToggleButton",setChecked:function(k){e.deprecated("setChecked("+k+") is deprecated. Use set('checked',"+k+") instead.","","2.0");this.set("checked",k)}})})},"dijit/form/_ToggleButtonMixin":function(){define(["dojo/_base/declare","dojo/dom-attr"],function(k,e){return k("dijit.form._ToggleButtonMixin",null,
{checked:!1,_aria_attr:"aria-pressed",_onClick:function(e){var k=this.checked;this._set("checked",!k);var n=this.inherited(arguments);this.set("checked",n?this.checked:k);return n},_setCheckedAttr:function(k,q){this._set("checked",k);var n=this.focusNode||this.domNode;this._created&&e.get(n,"checked")!=!!k&&e.set(n,"checked",!!k);n.setAttribute(this._aria_attr,String(k));this._handleOnChange(k,q)},postCreate:function(){this.inherited(arguments);var e=this.focusNode||this.domNode;this.checked&&e.setAttribute("checked",
"checked");void 0===this._resetValue&&(this._lastValueReported=this._resetValue=this.checked)},reset:function(){this._hasBeenBlurred=!1;this.set("checked",this.params.checked||!1)}})})},"dijit/form/_CheckBoxMixin":function(){define(["dojo/_base/declare","dojo/dom-attr"],function(k,e){return k("dijit.form._CheckBoxMixin",null,{type:"checkbox",value:"on",readOnly:!1,_aria_attr:"aria-checked",_setReadOnlyAttr:function(k){this._set("readOnly",k);e.set(this.focusNode,"readOnly",k)},_setLabelAttr:void 0,
_getSubmitValue:function(e){return null==e||""===e?"on":e},_setValueAttr:function(k){k=this._getSubmitValue(k);this._set("value",k);e.set(this.focusNode,"value",k)},reset:function(){this.inherited(arguments);this._set("value",this._getSubmitValue(this.params.value));e.set(this.focusNode,"value",this.value)},_onClick:function(e){return this.readOnly?(e.stopPropagation(),e.preventDefault(),!1):this.inherited(arguments)}})})},"dijit/form/NumberTextBox":function(){define("dojo/_base/declare dojo/_base/lang dojo/i18n dojo/string dojo/number ./RangeBoundTextBox".split(" "),
function(k,e,p,q,n,l){var h=function(d){d=d||{};var c=p.getLocalization("dojo.cldr","number",p.normalizeLocale(d.locale)),a=d.pattern?d.pattern:c[(d.type||"decimal")+"Format"];d="number"==typeof d.places?d.places:"string"===typeof d.places&&0<d.places.length?d.places.replace(/.*,/,""):-1!=a.indexOf(".")?a.split(".")[1].replace(/[^#0]/g,"").length:0;return{sep:c.decimal,places:d}},f=k("dijit.form.NumberTextBoxMixin",null,{pattern:function(d){return"("+(this.focused&&this.editOptions?this._regExpGenerator(e.delegate(d,
this.editOptions))+"|":"")+this._regExpGenerator(d)+")"},value:NaN,editOptions:{pattern:"#.######"},_formatter:n.format,_regExpGenerator:n.regexp,_decimalInfo:h(),postMixInProperties:function(){this.inherited(arguments);this._set("type","text")},_setConstraintsAttr:function(d){var c="number"==typeof d.places?d.places:0;c&&c++;"number"!=typeof d.max&&(d.max=9*Math.pow(10,15-c));"number"!=typeof d.min&&(d.min=-9*Math.pow(10,15-c));this.inherited(arguments,[d]);this.focusNode&&this.focusNode.value&&
!isNaN(this.value)&&this.set("value",this.value);this._decimalInfo=h(d)},_onFocus:function(){if(!this.disabled&&!this.readOnly){var d=this.get("value");"number"!=typeof d||isNaN(d)||(d=this.format(d,this.constraints),void 0!==d&&(this.textbox.value=d));this.inherited(arguments)}},format:function(d,c){var a=String(d);if("number"!=typeof d)return a;if(isNaN(d))return"";if(!("rangeCheck"in this&&this.rangeCheck(d,c))&&!1!==c.exponent&&/\de[-+]?\d/i.test(a))return a;this.editOptions&&this.focused&&(c=
e.mixin({},c,this.editOptions));return this._formatter(d,c)},_parser:n.parse,parse:function(d,c){var a=e.mixin({},c,this.editOptions&&this.focused?this.editOptions:{});if(this.focused&&null!=a.places){var b=a.places,b="number"===typeof b?b:Number(b.split(",").pop());a.places="0,"+b}a=this._parser(d,a);this.editOptions&&this.focused&&isNaN(a)&&(a=this._parser(d,c));return a},_getDisplayedValueAttr:function(){var d=this.inherited(arguments);return isNaN(d)?this.textbox.value:d},filter:function(d){if(null==
d||"string"==typeof d&&""==d)return NaN;"number"!=typeof d||isNaN(d)||0==d||(d=n.round(d,this._decimalInfo.places));return this.inherited(arguments,[d])},serialize:function(d,c){return"number"!=typeof d||isNaN(d)?"":this.inherited(arguments)},_setBlurValue:function(){var d=e.hitch(e.delegate(this,{focused:!0}),"get")("value");this._setValueAttr(d,!0)},_setValueAttr:function(d,c,a){if(void 0!==d&&void 0===a)if(a=String(d),"number"==typeof d)if(isNaN(d))a="";else{if("rangeCheck"in this&&this.rangeCheck(d,
this.constraints)||!1===this.constraints.exponent||!/\de[-+]?\d/i.test(a))a=void 0}else d?d=void 0:(a="",d=NaN);this.inherited(arguments,[d,c,a])},_getValueAttr:function(){var d=this.inherited(arguments);if(isNaN(d)&&""!==this.textbox.value){if(!1!==this.constraints.exponent&&/\de[-+]?\d/i.test(this.textbox.value)&&(new RegExp("^"+n._realNumberRegexp(e.delegate(this.constraints))+"$")).test(this.textbox.value))return d=Number(this.textbox.value),isNaN(d)?void 0:d}else return d},isValid:function(d){if(!this.focused||
this._isEmpty(this.textbox.value))return this.inherited(arguments);var c=this.get("value");return!isNaN(c)&&this.rangeCheck(c,this.constraints)?!1!==this.constraints.exponent&&/\de[-+]?\d/i.test(this.textbox.value)?!0:this.inherited(arguments):!1},_isValidSubset:function(){var d="number"==typeof this.constraints.min,c="number"==typeof this.constraints.max,a=this.get("value");if(isNaN(a)||!d&&!c)return this.inherited(arguments);var b=a|0,g=0>a,f=-1!=this.textbox.value.indexOf(this._decimalInfo.sep),
e=(this.maxLength||20)-this.textbox.value.length,h=f?this.textbox.value.split(this._decimalInfo.sep)[1].replace(/[^0-9]/g,""):"",b=f?b+"."+h:b+"",e=q.rep("9",e),f=a;g?f=Number(b+e):a=Number(b+e);return!(d&&a<this.constraints.min||c&&f>this.constraints.max)}});k=k("dijit.form.NumberTextBox",[l,f],{baseClass:"dijitTextBox dijitNumberTextBox"});k.Mixin=f;return k})},"dijit/form/RangeBoundTextBox":function(){define(["dojo/_base/declare","dojo/i18n","./MappedTextBox","dojo/i18n!./nls/validate"],function(k,
e,p){return k("dijit.form.RangeBoundTextBox",p,{rangeMessage:"",rangeCheck:function(e,k){return("min"in k?0<=this.compare(e,k.min):!0)&&("max"in k?0>=this.compare(e,k.max):!0)},isInRange:function(){return this.rangeCheck(this.get("value"),this.constraints)},_isDefinitelyOutOfRange:function(){var e=this.get("value");if(null==e)return!1;var k=!1;"min"in this.constraints&&(k=this.constraints.min,k=0>this.compare(e,"number"==typeof k&&0<=k&&0!=e?0:k));!k&&"max"in this.constraints&&(k=this.constraints.max,
k=0<this.compare(e,"number"!=typeof k||0<k?k:0));return k},_isValidSubset:function(){return this.inherited(arguments)&&!this._isDefinitelyOutOfRange()},isValid:function(e){return this.inherited(arguments)&&(this._isEmpty(this.textbox.value)&&!this.required||this.isInRange(e))},getErrorMessage:function(e){var k=this.get("value");return null==k||""===k||"number"==typeof k&&isNaN(k)||this.isInRange(e)?this.inherited(arguments):this.rangeMessage},postMixInProperties:function(){this.inherited(arguments);
this.rangeMessage||(this.messages=e.getLocalization("dijit.form","validate",this.lang),this.rangeMessage=this.messages.rangeMessage)}})})},"dijit/form/MappedTextBox":function(){define(["dojo/_base/declare","dojo/sniff","dojo/dom-construct","./ValidationTextBox"],function(k,e,p,q){return k("dijit.form.MappedTextBox",q,{postMixInProperties:function(){this.inherited(arguments);this.nameAttrSetting=""},_setNameAttr:"valueNode",serialize:function(e){return e.toString?e.toString():""},toString:function(){var e=
this.filter(this.get("value"));return null!=e?"string"==typeof e?e:this.serialize(e,this.constraints):""},validate:function(){this.valueNode.value=this.toString();return this.inherited(arguments)},buildRendering:function(){this.inherited(arguments);this.valueNode=p.place("\x3cinput type\x3d'hidden'"+(this.name&&!e("msapp")?' name\x3d"'+this.name.replace(/"/g,"\x26quot;")+'"':"")+"/\x3e",this.textbox,"after")},reset:function(){this.valueNode.value="";this.inherited(arguments)}})})},"dijit/form/Select":function(){define("dojo/_base/array dojo/_base/declare dojo/dom-attr dojo/dom-class dojo/dom-geometry dojo/i18n dojo/keys dojo/_base/lang dojo/on dojo/sniff ./_FormSelectWidget ../_HasDropDown ../DropDownMenu ../MenuItem ../MenuSeparator ../Tooltip ../_KeyNavMixin ../registry dojo/text!./templates/Select.html dojo/i18n!./nls/validate".split(" "),
function(k,e,p,q,n,l,h,f,d,c,a,b,g,u,m,r,t,v,y){function w(a){return function(b){this._isLoaded?this.inherited(a,arguments):this.loadDropDown(f.hitch(this,a,b))}}var z=e("dijit.form._SelectMenu",g,{autoFocus:!0,buildRendering:function(){this.inherited(arguments);this.domNode.setAttribute("role","listbox")},postCreate:function(){this.inherited(arguments);this.own(d(this.domNode,"selectstart",function(a){a.preventDefault();a.stopPropagation()}))},focus:function(){var a=!1,b=this.parentWidget.value;
f.isArray(b)&&(b=b[b.length-1]);b&&k.forEach(this.parentWidget._getChildren(),function(c){c.option&&b===c.option.value&&(a=!0,this.focusChild(c,!1))},this);a||this.inherited(arguments)}});n=e("dijit.form.Select"+(c("dojo-bidi")?"_NoBidi":""),[a,b,t],{baseClass:"dijitSelect dijitValidationTextBox",templateString:y,_buttonInputDisabled:c("ie")?"disabled":"",required:!1,state:"",message:"",tooltipPosition:[],emptyLabel:"\x26#160;",_isLoaded:!1,_childrenLoaded:!1,labelType:"html",_fillContent:function(){this.inherited(arguments);
if(this.options.length&&!this.value&&this.srcNodeRef){var a=this.srcNodeRef.selectedIndex||0;this._set("value",this.options[0<=a?a:0].value)}this.dropDown=new z({id:this.id+"_menu",parentWidget:this});q.add(this.dropDown.domNode,this.baseClass.replace(/\s+|$/g,"Menu "))},_getMenuItemForOption:function(a){if(a.value||a.label){var b=f.hitch(this,"_setValueAttr",a);a=new u({option:a,label:("text"===this.labelType?(a.label||"").toString().replace(/&/g,"\x26amp;").replace(/</g,"\x26lt;"):a.label)||this.emptyLabel,
onClick:b,ownerDocument:this.ownerDocument,dir:this.dir,textDir:this.textDir,disabled:a.disabled||!1});a.focusNode.setAttribute("role","option");return a}return new m({ownerDocument:this.ownerDocument})},_addOptionItem:function(a){this.dropDown&&this.dropDown.addChild(this._getMenuItemForOption(a))},_getChildren:function(){return this.dropDown?this.dropDown.getChildren():[]},focus:function(){if(!this.disabled&&this.focusNode.focus)try{this.focusNode.focus()}catch(x){}},focusChild:function(a){a&&this.set("value",
a.option)},_getFirst:function(){var a=this._getChildren();return a.length?a[0]:null},_getLast:function(){var a=this._getChildren();return a.length?a[a.length-1]:null},childSelector:function(a){return(a=v.byNode(a))&&a.getParent()==this.dropDown},onKeyboardSearch:function(a,b,c,d){a&&this.focusChild(a)},_loadChildren:function(a){if(!0===a)if(this.dropDown&&(delete this.dropDown.focusedChild,this.focusedChild=null),this.options.length)this.inherited(arguments);else{k.forEach(this._getChildren(),function(a){a.destroyRecursive()});
var b=new u({ownerDocument:this.ownerDocument,label:this.emptyLabel});this.dropDown.addChild(b)}else this._updateSelection();this._isLoaded=!1;this._childrenLoaded=!0;this._loadingStore||this._setValueAttr(this.value,!1)},_refreshState:function(){this._started&&this.validate(this.focused)},startup:function(){this.inherited(arguments);this._refreshState()},_setValueAttr:function(a){this.inherited(arguments);p.set(this.valueNode,"value",this.get("value"));this._refreshState()},_setNameAttr:"valueNode",
_setDisabledAttr:function(a){this.inherited(arguments);this._refreshState()},_setRequiredAttr:function(a){this._set("required",a);this.focusNode.setAttribute("aria-required",a);this._refreshState()},_setOptionsAttr:function(a){this._isLoaded=!1;this._set("options",a)},_setDisplay:function(a){a=("text"===this.labelType?(a||"").replace(/&/g,"\x26amp;").replace(/</g,"\x26lt;"):a)||this.emptyLabel;this.containerNode.innerHTML='\x3cspan role\x3d"option" aria-selected\x3d"true" class\x3d"dijitReset dijitInline '+
this.baseClass.replace(/\s+|$/g,"Label ")+'"\x3e'+a+"\x3c/span\x3e"},validate:function(a){a=this.disabled||this.isValid(a);this._set("state",a?"":this._hasBeenBlurred?"Error":"Incomplete");this.focusNode.setAttribute("aria-invalid",a?"false":"true");var b=a?"":this._missingMsg;b&&this.focused&&this._hasBeenBlurred?r.show(b,this.domNode,this.tooltipPosition,!this.isLeftToRight()):r.hide(this.domNode);this._set("message",b);return a},isValid:function(){return!this.required||0===this.value||!/^\s*$/.test(this.value||
"")},reset:function(){this.inherited(arguments);r.hide(this.domNode);this._refreshState()},postMixInProperties:function(){this.inherited(arguments);this._missingMsg=l.getLocalization("dijit.form","validate",this.lang).missingMessage},postCreate:function(){this.inherited(arguments);this.own(d(this.domNode,"selectstart",function(a){a.preventDefault();a.stopPropagation()}));this.domNode.setAttribute("aria-expanded","false");var a=this._keyNavCodes;delete a[h.LEFT_ARROW];delete a[h.RIGHT_ARROW]},_setStyleAttr:function(a){this.inherited(arguments);
q.toggle(this.domNode,this.baseClass.replace(/\s+|$/g,"FixedWidth "),!!this.domNode.style.width)},isLoaded:function(){return this._isLoaded},loadDropDown:function(a){this._loadChildren(!0);this._isLoaded=!0;a()},destroy:function(a){this.dropDown&&!this.dropDown._destroyed&&(this.dropDown.destroyRecursive(a),delete this.dropDown);r.hide(this.domNode);this.inherited(arguments)},_onFocus:function(){this.validate(!0)},_onBlur:function(){r.hide(this.domNode);this.inherited(arguments);this.validate(!1)}});
c("dojo-bidi")&&(n=e("dijit.form.Select",n,{_setDisplay:function(a){this.inherited(arguments);this.applyTextDir(this.containerNode)}}));n._Menu=z;n.prototype._onContainerKeydown=w("_onContainerKeydown");n.prototype._onContainerKeypress=w("_onContainerKeypress");return n})},"dijit/form/_FormSelectWidget":function(){define("dojo/_base/array dojo/_base/Deferred dojo/aspect dojo/data/util/sorter dojo/_base/declare dojo/dom dojo/dom-class dojo/_base/kernel dojo/_base/lang dojo/query dojo/when dojo/store/util/QueryResults ./_FormValueWidget".split(" "),
function(k,e,p,q,n,l,h,f,d,c,a,b,g){return n("dijit.form._FormSelectWidget",g,{multiple:!1,options:null,store:null,_setStoreAttr:function(a){this._created&&this._deprecatedSetStore(a)},query:null,_setQueryAttr:function(a){this._created&&this._deprecatedSetStore(this.store,this.selectedValue,{query:a})},queryOptions:null,_setQueryOptionsAttr:function(a){this._created&&this._deprecatedSetStore(this.store,this.selectedValue,{queryOptions:a})},labelAttr:"",onFetch:null,sortByLabel:!0,loadChildrenOnOpen:!1,
onLoadDeferred:null,getOptions:function(a){var b=this.options||[];if(null==a)return b;if(d.isArrayLike(a))return k.map(a,"return this.getOptions(item);",this);d.isString(a)&&(a={value:a});d.isObject(a)&&(k.some(b,function(b,c){for(var d in a)if(!(d in b)||b[d]!=a[d])return!1;a=c;return!0})||(a=-1));return 0<=a&&a<b.length?b[a]:null},addOption:function(a){k.forEach(d.isArrayLike(a)?a:[a],function(a){a&&d.isObject(a)&&this.options.push(a)},this);this._loadChildren()},removeOption:function(a){a=this.getOptions(d.isArrayLike(a)?
a:[a]);k.forEach(a,function(a){a&&(this.options=k.filter(this.options,function(b){return b.value!==a.value||b.label!==a.label}),this._removeOptionItem(a))},this);this._loadChildren()},updateOption:function(a){k.forEach(d.isArrayLike(a)?a:[a],function(a){var b=this.getOptions({value:a.value}),c;if(b)for(c in a)b[c]=a[c]},this);this._loadChildren()},setStore:function(a,b,c){f.deprecated(this.declaredClass+"::setStore(store, selectedValue, fetchArgs) is deprecated. Use set('query', fetchArgs.query), set('queryOptions', fetchArgs.queryOptions), set('store', store), or set('value', selectedValue) instead.",
"","2.0");this._deprecatedSetStore(a,b,c)},_deprecatedSetStore:function(c,g,f){var m=this.store;f=f||{};if(m!==c){for(var h;h=this._notifyConnections.pop();)h.remove();c.get||(d.mixin(c,{_oldAPI:!0,get:function(a){var b=new e;this.fetchItemByIdentity({identity:a,onItem:function(a){b.resolve(a)},onError:function(a){b.reject(a)}});return b.promise},query:function(a,c){var g=new e(function(){f.abort&&f.abort()});g.total=new e;var f=this.fetch(d.mixin({query:a,onBegin:function(a){g.total.resolve(a)},
onComplete:function(a){g.resolve(a)},onError:function(a){g.reject(a)}},c));return new b(g)}}),c.getFeatures()["dojo.data.api.Notification"]&&(this._notifyConnections=[p.after(c,"onNew",d.hitch(this,"_onNewItem"),!0),p.after(c,"onDelete",d.hitch(this,"_onDeleteItem"),!0),p.after(c,"onSet",d.hitch(this,"_onSetItem"),!0)]));this._set("store",c)}this.options&&this.options.length&&this.removeOption(this.options);this._queryRes&&this._queryRes.close&&this._queryRes.close();this._observeHandle&&this._observeHandle.remove&&
(this._observeHandle.remove(),this._observeHandle=null);f.query&&this._set("query",f.query);f.queryOptions&&this._set("queryOptions",f.queryOptions);c&&c.query&&(this._loadingStore=!0,this.onLoadDeferred=new e,this._queryRes=c.query(this.query,this.queryOptions),a(this._queryRes,d.hitch(this,function(a){if(this.sortByLabel&&!f.sort&&a.length)if(c.getValue)a.sort(q.createSortFunction([{attribute:c.getLabelAttributes(a[0])[0]}],c));else{var b=this.labelAttr;a.sort(function(a,c){return a[b]>c[b]?1:c[b]>
a[b]?-1:0})}f.onFetch&&(a=f.onFetch.call(this,a,f));k.forEach(a,function(a){this._addOptionForItem(a)},this);this._queryRes.observe&&(this._observeHandle=this._queryRes.observe(d.hitch(this,function(a,b,c){b==c?this._onSetItem(a):(-1!=b&&this._onDeleteItem(a),-1!=c&&this._onNewItem(a))}),!0));this._loadingStore=!1;this.set("value","_pendingValue"in this?this._pendingValue:g);delete this._pendingValue;this.loadChildrenOnOpen?this._pseudoLoadChildren(a):this._loadChildren();this.onLoadDeferred.resolve(!0);
this.onSetStore()}),d.hitch(this,function(a){console.error("dijit.form.Select: "+a.toString());this.onLoadDeferred.reject(a)})));return m},_setValueAttr:function(a,b){this._onChangeActive||(b=null);if(this._loadingStore)this._pendingValue=a;else if(null!=a){a=d.isArrayLike(a)?k.map(a,function(a){return d.isObject(a)?a:{value:a}}):d.isObject(a)?[a]:[{value:a}];a=k.filter(this.getOptions(a),function(a){return a&&a.value});var c=this.getOptions()||[];this.multiple||a[0]&&a[0].value||!c.length||(a[0]=
c[0]);k.forEach(c,function(b){b.selected=k.some(a,function(a){return a.value===b.value})});c=k.map(a,function(a){return a.value});if("undefined"!=typeof c&&"undefined"!=typeof c[0]){var g=k.map(a,function(a){return a.label});this._setDisplay(this.multiple?g:g[0]);this.inherited(arguments,[this.multiple?c:c[0],b]);this._updateSelection()}}},_getDisplayedValueAttr:function(){var a=k.map([].concat(this.get("selectedOptions")),function(a){return a&&"label"in a?a.label:a?a.value:null},this);return this.multiple?
a:a[0]},_setDisplayedValueAttr:function(a){this.set("value",this.getOptions("string"==typeof a?{label:a}:a))},_loadChildren:function(){this._loadingStore||(k.forEach(this._getChildren(),function(a){a.destroyRecursive()}),k.forEach(this.options,this._addOptionItem,this),this._updateSelection())},_updateSelection:function(){this.focusedChild=null;this._set("value",this._getValueFromOpts());var a=[].concat(this.value);if(a&&a[0]){var b=this;k.forEach(this._getChildren(),function(c){var d=k.some(a,function(a){return c.option&&
a===c.option.value});d&&!b.multiple&&(b.focusedChild=c);h.toggle(c.domNode,this.baseClass.replace(/\s+|$/g,"SelectedOption "),d);c.domNode.setAttribute("aria-selected",d?"true":"false")},this)}},_getValueFromOpts:function(){var a=this.getOptions()||[];if(!this.multiple&&a.length){var b=k.filter(a,function(a){return a.selected})[0];if(b&&b.value)return b.value;a[0].selected=!0;return a[0].value}return this.multiple?k.map(k.filter(a,function(a){return a.selected}),function(a){return a.value})||[]:""},
_onNewItem:function(a,b){b&&b.parent||this._addOptionForItem(a)},_onDeleteItem:function(a){this.removeOption({value:this.store.getIdentity(a)})},_onSetItem:function(a){this.updateOption(this._getOptionObjForItem(a))},_getOptionObjForItem:function(a){var b=this.store,c=this.labelAttr&&this.labelAttr in a?a[this.labelAttr]:b.getLabel(a);return{value:c?b.getIdentity(a):null,label:c,item:a}},_addOptionForItem:function(a){var b=this.store;b.isItemLoaded&&!b.isItemLoaded(a)?b.loadItem({item:a,onItem:function(a){this._addOptionForItem(a)},
scope:this}):(a=this._getOptionObjForItem(a),this.addOption(a))},constructor:function(a){this._oValue=(a||{}).value||null;this._notifyConnections=[]},buildRendering:function(){this.inherited(arguments);l.setSelectable(this.focusNode,!1)},_fillContent:function(){this.options||(this.options=this.srcNodeRef?c("\x3e *",this.srcNodeRef).map(function(a){return"separator"===a.getAttribute("type")?{value:"",label:"",selected:!1,disabled:!1}:{value:a.getAttribute("data-"+f._scopeName+"-value")||a.getAttribute("value"),
label:String(a.innerHTML),selected:a.getAttribute("selected")||!1,disabled:a.getAttribute("disabled")||!1}},this):[]);this.value?this.multiple&&"string"==typeof this.value&&this._set("value",this.value.split(",")):this._set("value",this._getValueFromOpts())},postCreate:function(){this.inherited(arguments);p.after(this,"onChange",d.hitch(this,"_updateSelection"));var a=this.store;a&&(a.getIdentity||a.getFeatures()["dojo.data.api.Identity"])&&(this.store=null,this._deprecatedSetStore(a,this._oValue,
{query:this.query,queryOptions:this.queryOptions}));this._storeInitialized=!0},startup:function(){this._loadChildren();this.inherited(arguments)},destroy:function(){for(var a;a=this._notifyConnections.pop();)a.remove();this._queryRes&&this._queryRes.close&&this._queryRes.close();this._observeHandle&&this._observeHandle.remove&&(this._observeHandle.remove(),this._observeHandle=null);this.inherited(arguments)},_addOptionItem:function(){},_removeOptionItem:function(){},_setDisplay:function(){},_getChildren:function(){return[]},
_getSelectedOptionsAttr:function(){return this.getOptions({selected:!0})},_pseudoLoadChildren:function(){},onSetStore:function(){}})})},"dijit/_HasDropDown":function(){define("dojo/_base/declare dojo/_base/Deferred dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-geometry dojo/dom-style dojo/has dojo/keys dojo/_base/lang dojo/on dojo/touch ./registry ./focus ./popup ./_FocusMixin".split(" "),function(k,e,p,q,n,l,h,f,d,c,a,b,g,u,m,r){return k("dijit._HasDropDown",r,{_buttonNode:null,_arrowWrapperNode:null,
_popupStateNode:null,_aroundNode:null,dropDown:null,autoWidth:!0,forceWidth:!1,maxHeight:-1,dropDownPosition:["below","above"],_stopClickEvents:!0,_onDropDownMouseDown:function(d){this.disabled||this.readOnly||("MSPointerDown"!=d.type&&d.preventDefault(),this.own(a.once(this.ownerDocument,b.release,c.hitch(this,"_onDropDownMouseUp"))),this.toggleDropDown())},_onDropDownMouseUp:function(a){var b=this.dropDown,c=!1;if(a&&this._opened){var d=l.position(this._buttonNode,!0);if(!(a.pageX>=d.x&&a.pageX<=
d.x+d.w&&a.pageY>=d.y&&a.pageY<=d.y+d.h)){for(d=a.target;d&&!c;)n.contains(d,"dijitPopup")?c=!0:d=d.parentNode;if(c){d=a.target;if(b.onItemClick){for(var f;d&&!(f=g.byNode(d));)d=d.parentNode;if(f&&f.onClick&&f.getParent)f.getParent().onItemClick(f,a)}return}}}this._opened?b.focus&&(!1!==b.autoFocus||"mouseup"==a.type&&!this.hovering)&&(this._focusDropDownTimer=this.defer(function(){b.focus();delete this._focusDropDownTimer})):this.focus&&this.defer("focus")},_onDropDownClick:function(a){this._stopClickEvents&&
(a.stopPropagation(),a.preventDefault())},buildRendering:function(){this.inherited(arguments);this._buttonNode=this._buttonNode||this.focusNode||this.domNode;this._popupStateNode=this._popupStateNode||this.focusNode||this._buttonNode;var a={after:this.isLeftToRight()?"Right":"Left",before:this.isLeftToRight()?"Left":"Right",above:"Up",below:"Down",left:"Left",right:"Right"}[this.dropDownPosition[0]]||this.dropDownPosition[0]||"Down";n.add(this._arrowWrapperNode||this._buttonNode,"dijit"+a+"ArrowButton")},
postCreate:function(){this.inherited(arguments);var d=this.focusNode||this.domNode;this.own(a(this._buttonNode,b.press,c.hitch(this,"_onDropDownMouseDown")),a(this._buttonNode,"click",c.hitch(this,"_onDropDownClick")),a(d,"keydown",c.hitch(this,"_onKey")),a(d,"keyup",c.hitch(this,"_onKeyUp")))},destroy:function(){this._opened&&this.closeDropDown(!0);this.dropDown&&(this.dropDown._destroyed||this.dropDown.destroyRecursive(),delete this.dropDown);this.inherited(arguments)},_onKey:function(a){if(!this.disabled&&
!this.readOnly){var b=this.dropDown,c=a.target;b&&this._opened&&b.handleKey&&!1===b.handleKey(a)?(a.stopPropagation(),a.preventDefault()):b&&this._opened&&a.keyCode==d.ESCAPE?(this.closeDropDown(),a.stopPropagation(),a.preventDefault()):!this._opened&&(a.keyCode==d.DOWN_ARROW||(a.keyCode==d.ENTER||a.keyCode==d.SPACE&&(!this._searchTimer||a.ctrlKey||a.altKey||a.metaKey))&&("input"!==(c.tagName||"").toLowerCase()||c.type&&"text"!==c.type.toLowerCase()))&&(this._toggleOnKeyUp=!0,a.stopPropagation(),
a.preventDefault())}},_onKeyUp:function(){if(this._toggleOnKeyUp){delete this._toggleOnKeyUp;this.toggleDropDown();var a=this.dropDown;a&&a.focus&&this.defer(c.hitch(a,"focus"),1)}},_onBlur:function(){this.closeDropDown(!1);this.inherited(arguments)},isLoaded:function(){return!0},loadDropDown:function(a){a()},loadAndOpenDropDown:function(){var a=new e,b=c.hitch(this,function(){this.openDropDown();a.resolve(this.dropDown)});this.isLoaded()?b():this.loadDropDown(b);return a},toggleDropDown:function(){this.disabled||
this.readOnly||(this._opened?this.closeDropDown(!0):this.loadAndOpenDropDown())},openDropDown:function(){var a=this.dropDown,b=a.domNode,d=this._aroundNode||this.domNode,g=this,f=m.open({parent:this,popup:a,around:d,orient:this.dropDownPosition,maxHeight:this.maxHeight,onExecute:function(){g.closeDropDown(!0)},onCancel:function(){g.closeDropDown(!0)},onClose:function(){q.set(g._popupStateNode,"popupActive",!1);n.remove(g._popupStateNode,"dijitHasDropDownOpen");g._set("_opened",!1)}});if(this.forceWidth||
this.autoWidth&&d.offsetWidth>a._popupWrapper.offsetWidth){var d=d.offsetWidth-a._popupWrapper.offsetWidth,e={w:a.domNode.offsetWidth+d};this._origStyle=b.style.cssText;c.isFunction(a.resize)?a.resize(e):l.setMarginBox(b,e);"R"==f.corner[1]&&(a._popupWrapper.style.left=a._popupWrapper.style.left.replace("px","")-d+"px")}q.set(this._popupStateNode,"popupActive","true");n.add(this._popupStateNode,"dijitHasDropDownOpen");this._set("_opened",!0);this._popupStateNode.setAttribute("aria-expanded","true");
this._popupStateNode.setAttribute("aria-owns",a.id);"presentation"===b.getAttribute("role")||b.getAttribute("aria-labelledby")||b.setAttribute("aria-labelledby",this.id);return f},closeDropDown:function(a){this._focusDropDownTimer&&(this._focusDropDownTimer.remove(),delete this._focusDropDownTimer);this._opened&&(this._popupStateNode.setAttribute("aria-expanded","false"),a&&this.focus&&this.focus(),m.close(this.dropDown),this._opened=!1);this._origStyle&&(this.dropDown.domNode.style.cssText=this._origStyle,
delete this._origStyle)}})})},"dijit/popup":function(){define("dojo/_base/array dojo/aspect dojo/_base/declare dojo/dom dojo/dom-attr dojo/dom-construct dojo/dom-geometry dojo/dom-style dojo/has dojo/keys dojo/_base/lang dojo/on ./place ./BackgroundIframe ./Viewport ./main dojo/touch".split(" "),function(k,e,p,q,n,l,h,f,d,c,a,b,g,u,m,r){function t(){this._popupWrapper&&(l.destroy(this._popupWrapper),delete this._popupWrapper)}p=p(null,{_stack:[],_beginZIndex:1E3,_idGen:1,_repositionAll:function(){if(this._firstAroundNode){var b=
this._firstAroundPosition,c=h.position(this._firstAroundNode,!0),d=c.x-b.x,b=c.y-b.y;if(d||b)for(this._firstAroundPosition=c,c=0;c<this._stack.length;c++){var g=this._stack[c].wrapper.style;g.top=parseFloat(g.top)+b+"px";"auto"==g.right?g.left=parseFloat(g.left)+d+"px":g.right=parseFloat(g.right)-d+"px"}this._aroundMoveListener=setTimeout(a.hitch(this,"_repositionAll"),d||b?10:50)}},_createWrapper:function(a){var c=a._popupWrapper,d=a.domNode;c||(c=l.create("div",{"class":"dijitPopup",style:{display:"none"},
role:"region","aria-label":a["aria-label"]||a.label||a.name||a.id},a.ownerDocumentBody),c.appendChild(d),d=d.style,d.display="",d.visibility="",d.position="",d.top="0px",a._popupWrapper=c,e.after(a,"destroy",t,!0),"ontouchend"in document&&b(c,"touchend",function(a){/^(input|button|textarea)$/i.test(a.target.tagName)||a.preventDefault()}),c.dojoClick=!0);return c},moveOffScreen:function(a){var b=this._createWrapper(a);a=h.isBodyLtr(a.ownerDocument);var c={visibility:"hidden",top:"-9999px",display:""};
c[a?"left":"right"]="-9999px";c[a?"right":"left"]="auto";f.set(b,c);return b},hide:function(a){var b=this._createWrapper(a);f.set(b,{display:"none",height:"auto",overflowY:"visible",border:""});a=a.domNode;"_originalStyle"in a&&(a.style.cssText=a._originalStyle)},getTopPopup:function(){for(var a=this._stack,b=a.length-1;0<b&&a[b].parent===a[b-1].widget;b--);return a[b]},open:function(e){for(var l=this._stack,k=e.popup,r=k.domNode,p=e.orient||["below","below-alt","above","above-alt"],t=e.parent?e.parent.isLeftToRight():
h.isBodyLtr(k.ownerDocument),v=e.around,B=e.around&&e.around.id?e.around.id+"_dropdown":"popup_"+this._idGen++;l.length&&(!e.parent||!q.isDescendant(e.parent.domNode,l[l.length-1].widget.domNode));)this.close(l[l.length-1].widget);var E=this.moveOffScreen(k);k.startup&&!k._started&&k.startup();var D,F=h.position(r);if("maxHeight"in e&&-1!=e.maxHeight)D=e.maxHeight||Infinity;else{D=m.getEffectiveBox(this.ownerDocument);var I=v?h.position(v,!1):{y:e.y-(e.padding||0),h:2*(e.padding||0)};D=Math.floor(Math.max(I.y,
D.h-(I.y+I.h)))}F.h>D&&(F=f.getComputedStyle(r),f.set(E,{overflowY:"scroll",height:D+"px",border:F.borderLeftWidth+" "+F.borderLeftStyle+" "+F.borderLeftColor}),r._originalStyle=r.style.cssText,r.style.border="none");n.set(E,{id:B,style:{zIndex:this._beginZIndex+l.length},"class":"dijitPopup "+(k.baseClass||k["class"]||"").split(" ")[0]+"Popup",dijitPopupParent:e.parent?e.parent.id:""});0==l.length&&v&&(this._firstAroundNode=v,this._firstAroundPosition=h.position(v,!0),this._aroundMoveListener=setTimeout(a.hitch(this,
"_repositionAll"),50));d("config-bgIframe")&&!k.bgIframe&&(k.bgIframe=new u(E));B=k.orient?a.hitch(k,"orient"):null;p=v?g.around(E,v,p,t,B):g.at(E,e,"R"==p?["TR","BR","TL","BL"]:["TL","BL","TR","BR"],e.padding,B);E.style.visibility="visible";r.style.visibility="visible";r=[];r.push(b(E,"keydown",a.hitch(this,function(a){if(a.keyCode==c.ESCAPE&&e.onCancel)a.stopPropagation(),a.preventDefault(),e.onCancel();else if(a.keyCode==c.TAB&&(a.stopPropagation(),a.preventDefault(),(a=this.getTopPopup())&&a.onCancel))a.onCancel()})));
k.onCancel&&e.onCancel&&r.push(k.on("cancel",e.onCancel));r.push(k.on(k.onExecute?"execute":"change",a.hitch(this,function(){var a=this.getTopPopup();if(a&&a.onExecute)a.onExecute()})));l.push({widget:k,wrapper:E,parent:e.parent,onExecute:e.onExecute,onCancel:e.onCancel,onClose:e.onClose,handlers:r});if(k.onOpen)k.onOpen(p);return p},close:function(a){for(var b=this._stack;a&&k.some(b,function(b){return b.widget==a})||!a&&b.length;){var c=b.pop(),d=c.widget,g=c.onClose;d.bgIframe&&(d.bgIframe.destroy(),
delete d.bgIframe);if(d.onClose)d.onClose();for(var f;f=c.handlers.pop();)f.remove();d&&d.domNode&&this.hide(d);g&&g()}0==b.length&&this._aroundMoveListener&&(clearTimeout(this._aroundMoveListener),this._firstAroundNode=this._firstAroundPosition=this._aroundMoveListener=null)}});return r.popup=new p})},"dijit/DropDownMenu":function(){define(["dojo/_base/declare","dojo/keys","dojo/text!./templates/Menu.html","./_MenuBase"],function(k,e,p,q){return k("dijit.DropDownMenu",q,{templateString:p,baseClass:"dijitMenu",
_onUpArrow:function(){this.focusPrev()},_onDownArrow:function(){this.focusNext()},_onRightArrow:function(e){this._moveToPopup(e);e.stopPropagation();e.preventDefault()},_onLeftArrow:function(e){if(this.parentMenu)if(this.parentMenu._isMenuBar)this.parentMenu.focusPrev();else this.onCancel(!1);else e.stopPropagation(),e.preventDefault()}})})},"dijit/_MenuBase":function(){define("dojo/_base/array dojo/_base/declare dojo/dom dojo/dom-attr dojo/dom-class dojo/_base/lang dojo/mouse dojo/on dojo/window ./a11yclick ./registry ./_Widget ./_CssStateMixin ./_KeyNavContainer ./_TemplatedMixin".split(" "),
function(k,e,p,q,n,l,h,f,d,c,a,b,g,u,m){return e("dijit._MenuBase",[b,m,u,g],{selected:null,_setSelectedAttr:function(a){this.selected!=a&&(this.selected&&(this.selected._setSelected(!1),this._onChildDeselect(this.selected)),a&&a._setSelected(!0),this._set("selected",a))},activated:!1,_setActivatedAttr:function(a){n.toggle(this.domNode,"dijitMenuActive",a);n.toggle(this.domNode,"dijitMenuPassive",!a);this._set("activated",a)},parentMenu:null,popupDelay:500,passivePopupDelay:Infinity,autoFocus:!1,
childSelector:function(b){var c=a.byNode(b);return b.parentNode==this.containerNode&&c&&c.focus},postCreate:function(){var b=this,d="string"==typeof this.childSelector?this.childSelector:l.hitch(this,"childSelector");this.own(f(this.containerNode,f.selector(d,h.enter),function(){b.onItemHover(a.byNode(this))}),f(this.containerNode,f.selector(d,h.leave),function(){b.onItemUnhover(a.byNode(this))}),f(this.containerNode,f.selector(d,c),function(c){b.onItemClick(a.byNode(this),c);c.stopPropagation()}),
f(this.containerNode,f.selector(d,"focusin"),function(){b._onItemFocus(a.byNode(this))}));this.inherited(arguments)},onKeyboardSearch:function(a,b,c,d){this.inherited(arguments);if(a&&(-1==d||a.popup&&1==d))this.onItemClick(a,b)},_keyboardSearchCompare:function(a,b){return a.shortcutKey?b==a.shortcutKey.toLowerCase()?-1:0:this.inherited(arguments)?1:0},onExecute:function(){},onCancel:function(){},_moveToPopup:function(a){if(this.focusedChild&&this.focusedChild.popup&&!this.focusedChild.disabled)this.onItemClick(this.focusedChild,
a);else(a=this._getTopMenu())&&a._isMenuBar&&a.focusNext()},_onPopupHover:function(){this.set("selected",this.currentPopupItem);this._stopPendingCloseTimer()},onItemHover:function(a){this.activated?(this.set("selected",a),!a.popup||a.disabled||this.hover_timer||(this.hover_timer=this.defer(function(){this._openItemPopup(a)},this.popupDelay))):Infinity>this.passivePopupDelay&&(this.passive_hover_timer&&this.passive_hover_timer.remove(),this.passive_hover_timer=this.defer(function(){this.onItemClick(a,
{type:"click"})},this.passivePopupDelay));this._hoveredChild=a;a._set("hovering",!0)},_onChildDeselect:function(a){this._stopPopupTimer();this.currentPopupItem==a&&(this._stopPendingCloseTimer(),this._pendingClose_timer=this.defer(function(){this.currentPopupItem=this._pendingClose_timer=null;a._closePopup()},this.popupDelay))},onItemUnhover:function(a){this._hoveredChild==a&&(this._hoveredChild=null);this.passive_hover_timer&&(this.passive_hover_timer.remove(),this.passive_hover_timer=null);a._set("hovering",
!1)},_stopPopupTimer:function(){this.hover_timer&&(this.hover_timer=this.hover_timer.remove())},_stopPendingCloseTimer:function(){this._pendingClose_timer&&(this._pendingClose_timer=this._pendingClose_timer.remove())},_getTopMenu:function(){for(var a=this;a.parentMenu;a=a.parentMenu);return a},onItemClick:function(a,b){this.passive_hover_timer&&this.passive_hover_timer.remove();this.focusChild(a);if(a.disabled)return!1;a.popup?(this.set("selected",a),this.set("activated",!0),b=/^key/.test(b._origType||
b.type)||0==b.clientX&&0==b.clientY,this._openItemPopup(a,b)):(this.onExecute(),a._onClick?a._onClick(b):a.onClick(b))},_openItemPopup:function(a,b){if(a!=this.currentPopupItem){this.currentPopupItem&&(this._stopPendingCloseTimer(),this.currentPopupItem._closePopup());this._stopPopupTimer();var c=a.popup;c.parentMenu=this;this.own(this._mouseoverHandle=f.once(c.domNode,"mouseover",l.hitch(this,"_onPopupHover")));var d=this;a._openPopup({parent:this,orient:this._orient||["after","before"],onCancel:function(){b&&
d.focusChild(a);d._cleanUp()},onExecute:l.hitch(this,"_cleanUp",!0),onClose:function(){d._mouseoverHandle&&(d._mouseoverHandle.remove(),delete d._mouseoverHandle)}},b);this.currentPopupItem=a}},onOpen:function(){this.isShowingNow=!0;this.set("activated",!0)},onClose:function(){this.set("activated",!1);this.set("selected",null);this.isShowingNow=!1;this.parentMenu=null},_closeChild:function(){this._stopPopupTimer();this.currentPopupItem&&(this.focused&&(q.set(this.selected.focusNode,"tabIndex",this.tabIndex),
this.selected.focusNode.focus()),this.currentPopupItem._closePopup(),this.currentPopupItem=null)},_onItemFocus:function(a){if(this._hoveredChild&&this._hoveredChild!=a)this.onItemUnhover(this._hoveredChild);this.set("selected",a)},_onBlur:function(){this._cleanUp(!0);this.inherited(arguments)},_cleanUp:function(a){this._closeChild();"undefined"==typeof this.isShowingNow&&this.set("activated",!1);a&&this.set("selected",null)}})})},"dijit/_KeyNavContainer":function(){define("dojo/_base/array dojo/_base/declare dojo/dom-attr dojo/_base/kernel dojo/keys dojo/_base/lang ./registry ./_Container ./_FocusMixin ./_KeyNavMixin".split(" "),
function(k,e,p,q,n,l,h,f,d,c){return e("dijit._KeyNavContainer",[d,c,f],{connectKeyNavHandlers:function(a,b){var c=this._keyNavCodes={},d=l.hitch(this,"focusPrev"),f=l.hitch(this,"focusNext");k.forEach(a,function(a){c[a]=d});k.forEach(b,function(a){c[a]=f});c[n.HOME]=l.hitch(this,"focusFirstChild");c[n.END]=l.hitch(this,"focusLastChild")},startupKeyNavChildren:function(){q.deprecated("startupKeyNavChildren() call no longer needed","","2.0")},startup:function(){this.inherited(arguments);k.forEach(this.getChildren(),
l.hitch(this,"_startupChild"))},addChild:function(a,b){this.inherited(arguments);this._startupChild(a)},_startupChild:function(a){a.set("tabIndex","-1")},_getFirst:function(){var a=this.getChildren();return a.length?a[0]:null},_getLast:function(){var a=this.getChildren();return a.length?a[a.length-1]:null},focusNext:function(){this.focusChild(this._getNextFocusableChild(this.focusedChild,1))},focusPrev:function(){this.focusChild(this._getNextFocusableChild(this.focusedChild,-1),!0)},childSelector:function(a){return(a=
h.byNode(a))&&a.getParent()==this}})})},"dijit/_KeyNavMixin":function(){define("dojo/_base/array dojo/_base/declare dojo/dom-attr dojo/keys dojo/_base/lang dojo/on dijit/registry dijit/_FocusMixin".split(" "),function(k,e,p,q,n,l,h,f){return e("dijit._KeyNavMixin",f,{tabIndex:"0",childSelector:null,postCreate:function(){this.inherited(arguments);p.set(this.domNode,"tabIndex",this.tabIndex);if(!this._keyNavCodes){var d=this._keyNavCodes={};d[q.HOME]=n.hitch(this,"focusFirstChild");d[q.END]=n.hitch(this,
"focusLastChild");d[this.isLeftToRight()?q.LEFT_ARROW:q.RIGHT_ARROW]=n.hitch(this,"_onLeftArrow");d[this.isLeftToRight()?q.RIGHT_ARROW:q.LEFT_ARROW]=n.hitch(this,"_onRightArrow");d[q.UP_ARROW]=n.hitch(this,"_onUpArrow");d[q.DOWN_ARROW]=n.hitch(this,"_onDownArrow")}var c=this,d="string"==typeof this.childSelector?this.childSelector:n.hitch(this,"childSelector");this.own(l(this.domNode,"keypress",n.hitch(this,"_onContainerKeypress")),l(this.domNode,"keydown",n.hitch(this,"_onContainerKeydown")),l(this.domNode,
"focus",n.hitch(this,"_onContainerFocus")),l(this.containerNode,l.selector(d,"focusin"),function(a){c._onChildFocus(h.getEnclosingWidget(this),a)}))},_onLeftArrow:function(){},_onRightArrow:function(){},_onUpArrow:function(){},_onDownArrow:function(){},focus:function(){this.focusFirstChild()},_getFirstFocusableChild:function(){return this._getNextFocusableChild(null,1)},_getLastFocusableChild:function(){return this._getNextFocusableChild(null,-1)},focusFirstChild:function(){this.focusChild(this._getFirstFocusableChild())},
focusLastChild:function(){this.focusChild(this._getLastFocusableChild())},focusChild:function(d,c){d&&(this.focusedChild&&d!==this.focusedChild&&this._onChildBlur(this.focusedChild),d.set("tabIndex",this.tabIndex),d.focus(c?"end":"start"))},_onContainerFocus:function(d){d.target!==this.domNode||this.focusedChild||this.focus()},_onFocus:function(){p.set(this.domNode,"tabIndex","-1");this.inherited(arguments)},_onBlur:function(d){p.set(this.domNode,"tabIndex",this.tabIndex);this.focusedChild&&(this.focusedChild.set("tabIndex",
"-1"),this.lastFocusedChild=this.focusedChild,this._set("focusedChild",null));this.inherited(arguments)},_onChildFocus:function(d){d&&d!=this.focusedChild&&(this.focusedChild&&!this.focusedChild._destroyed&&this.focusedChild.set("tabIndex","-1"),d.set("tabIndex",this.tabIndex),this.lastFocused=d,this._set("focusedChild",d))},_searchString:"",multiCharSearchDuration:1E3,onKeyboardSearch:function(d,c,a,b){d&&this.focusChild(d)},_keyboardSearchCompare:function(d,c){var a=d.domNode;d=(d.label||(a.focusNode?
a.focusNode.label:"")||a.innerText||a.textContent||"").replace(/^\s+/,"").substr(0,c.length).toLowerCase();return c.length&&d==c?-1:0},_isFormElement:function(d){return"INPUT"===d.tagName||"TEXTAREA"===d.tagName||"SELECT"===d.tagName||"BUTTON"===d.tagName},_onContainerKeydown:function(d){if(!this._isFormElement(document.activeElement)){var c=this._keyNavCodes[d.keyCode];c?(c(d,this.focusedChild),d.stopPropagation(),d.preventDefault(),this._searchString=""):d.keyCode!=q.SPACE||!this._searchTimer||
d.ctrlKey||d.altKey||d.metaKey||(d.stopImmediatePropagation(),d.preventDefault(),this._keyboardSearch(d," "))}},_onContainerKeypress:function(d){this._isFormElement(document.activeElement)||d.charCode<=q.SPACE||d.ctrlKey||d.altKey||d.metaKey||(d.preventDefault(),d.stopPropagation(),this._keyboardSearch(d,String.fromCharCode(d.charCode).toLowerCase()))},_keyboardSearch:function(d,c){var a=null,b,g=0;n.hitch(this,function(){this._searchTimer&&this._searchTimer.remove();this._searchString+=c;var d=/^(.)\1*$/.test(this._searchString)?
1:this._searchString.length;b=this._searchString.substr(0,d);this._searchTimer=this.defer(function(){this._searchTimer=null;this._searchString=""},this.multiCharSearchDuration);var f=this.focusedChild||null;if(1==d||!f)if(f=this._getNextFocusableChild(f,1),!f)return;d=f;do{var e=this._keyboardSearchCompare(f,b);e&&0==g++&&(a=f);if(-1==e){g=-1;break}f=this._getNextFocusableChild(f,1)}while(f&&f!=d)})();this.onKeyboardSearch(a,d,b,g)},_onChildBlur:function(){},_getNextFocusableChild:function(d,c){var a=
d;do{if(d)d=this._getNext(d,c);else if(d=this[0<c?"_getFirst":"_getLast"](),!d)break;if(null!=d&&d!=a&&d.isFocusable())return d}while(d!=a);return null},_getFirst:function(){return null},_getLast:function(){return null},_getNext:function(d,c){if(d)for(d=d.domNode;d;)if((d=d[0>c?"previousSibling":"nextSibling"])&&"getAttribute"in d){var a=h.byNode(d);if(a)return a}return null}})})},"dijit/MenuItem":function(){define("dojo/_base/declare dojo/dom dojo/dom-attr dojo/dom-class dojo/_base/kernel dojo/sniff dojo/_base/lang ./_Widget ./_TemplatedMixin ./_Contained ./_CssStateMixin dojo/text!./templates/MenuItem.html".split(" "),
function(k,e,p,q,n,l,h,f,d,c,a,b){h=k("dijit.MenuItem"+(l("dojo-bidi")?"_NoBidi":""),[f,d,c,a],{templateString:b,baseClass:"dijitMenuItem",label:"",_setLabelAttr:function(a){this._set("label",a);var b="",c;c=a.search(/{\S}/);if(0<=c){var b=a.charAt(c+1),d=a.substr(0,c);a=a.substr(c+3);c=d+b+a;a=d+'\x3cspan class\x3d"dijitMenuItemShortcutKey"\x3e'+b+"\x3c/span\x3e"+a}else c=a;this.domNode.setAttribute("aria-label",c+" "+this.accelKey);this.containerNode.innerHTML=a;this._set("shortcutKey",b)},iconClass:"dijitNoIcon",
_setIconClassAttr:{node:"iconNode",type:"class"},accelKey:"",disabled:!1,_fillContent:function(a){!a||"label"in this.params||this._set("label",a.innerHTML)},buildRendering:function(){this.inherited(arguments);p.set(this.containerNode,"id",this.id+"_text");this.accelKeyNode&&p.set(this.accelKeyNode,"id",this.id+"_accel");e.setSelectable(this.domNode,!1)},onClick:function(){},focus:function(){try{8==l("ie")&&this.containerNode.focus(),this.focusNode.focus()}catch(g){}},_setSelected:function(a){q.toggle(this.domNode,
"dijitMenuItemSelected",a)},setLabel:function(a){n.deprecated("dijit.MenuItem.setLabel() is deprecated.  Use set('label', ...) instead.","","2.0");this.set("label",a)},setDisabled:function(a){n.deprecated("dijit.Menu.setDisabled() is deprecated.  Use set('disabled', bool) instead.","","2.0");this.set("disabled",a)},_setDisabledAttr:function(a){this.focusNode.setAttribute("aria-disabled",a?"true":"false");this._set("disabled",a)},_setAccelKeyAttr:function(a){this.accelKeyNode&&(this.accelKeyNode.style.display=
a?"":"none",this.accelKeyNode.innerHTML=a,p.set(this.containerNode,"colSpan",a?"1":"2"));this._set("accelKey",a)}});l("dojo-bidi")&&(h=k("dijit.MenuItem",h,{_setLabelAttr:function(a){this.inherited(arguments);"auto"===this.textDir&&this.applyTextDir(this.textDirNode)}}));return h})},"dijit/_Contained":function(){define(["dojo/_base/declare","./registry"],function(k,e){return k("dijit._Contained",null,{_getSibling:function(e){var k=this.getParent();return k&&k._getSiblingOfChild&&k._getSiblingOfChild(this,
"previous"==e?-1:1)||null},getPreviousSibling:function(){return this._getSibling("previous")},getNextSibling:function(){return this._getSibling("next")},getIndexInParent:function(){var e=this.getParent();return e&&e.getIndexOfChild?e.getIndexOfChild(this):-1}})})},"dijit/MenuSeparator":function(){define("dojo/_base/declare dojo/dom ./_WidgetBase ./_TemplatedMixin ./_Contained dojo/text!./templates/MenuSeparator.html".split(" "),function(k,e,p,q,n,l){return k("dijit.MenuSeparator",[p,q,n],{templateString:l,
buildRendering:function(){this.inherited(arguments);e.setSelectable(this.domNode,!1)},isFocusable:function(){return!1}})})},"dijit/form/SimpleTextarea":function(){define(["dojo/_base/declare","dojo/dom-class","dojo/sniff","./TextBox"],function(k,e,p,q){return k("dijit.form.SimpleTextarea",q,{baseClass:"dijitTextBox dijitTextArea",rows:"3",cols:"20",templateString:"\x3ctextarea ${!nameAttrSetting} data-dojo-attach-point\x3d'focusNode,containerNode,textbox' autocomplete\x3d'off'\x3e\x3c/textarea\x3e",
postMixInProperties:function(){!this.value&&this.srcNodeRef&&(this.value=this.srcNodeRef.value);this.inherited(arguments)},buildRendering:function(){this.inherited(arguments);p("ie")&&this.cols&&e.add(this.textbox,"dijitTextAreaCols")},filter:function(e){e&&(e=e.replace(/\r/g,""));return this.inherited(arguments)},_onInput:function(e){if(this.maxLength){var l=parseInt(this.maxLength),h=this.textbox.value.replace(/\r/g,""),l=h.length-l;if(0<l){var f=this.textbox;if(f.selectionStart){var d=f.selectionStart,
c=0;p("opera")&&(c=(this.textbox.value.substring(0,d).match(/\r/g)||[]).length);this.textbox.value=h.substring(0,d-l-c)+h.substring(d-c);f.setSelectionRange(d-l,d-l)}else this.ownerDocument.selection&&(f.focus(),h=this.ownerDocument.selection.createRange(),h.moveStart("character",-l),h.text="",h.select())}}this.inherited(arguments)}})})},"dijit/Editor":function(){define("require dojo/_base/array dojo/_base/declare dojo/Deferred dojo/i18n dojo/dom-attr dojo/dom-class dojo/dom-geometry dojo/dom-style dojo/keys dojo/_base/lang dojo/sniff dojo/string dojo/topic ./_Container ./Toolbar ./ToolbarSeparator ./layout/_LayoutWidget ./form/ToggleButton ./_editor/_Plugin ./_editor/plugins/EnterKeyHandling ./_editor/html ./_editor/range ./_editor/RichText ./main dojo/i18n!./_editor/nls/commands".split(" "),
function(k,e,p,q,n,l,h,f,d,c,a,b,g,u,m,r,t,v,y,w,z,x,A,C,B){function E(a){return new w({command:a.name})}function D(a){return new w({buttonClass:y,command:a.name})}p=p("dijit.Editor",C,{plugins:null,extraPlugins:null,constructor:function(){a.isArray(this.plugins)||(this.plugins=["undo","redo","|","cut","copy","paste","|","bold","italic","underline","strikethrough","|","insertOrderedList","insertUnorderedList","indent","outdent","|","justifyLeft","justifyRight","justifyCenter","justifyFull",z]);this._plugins=
[];this._editInterval=1E3*this.editActionInterval;if(b("ie")||b("trident")||b("edge"))this.events.push("onBeforeDeactivate"),this.events.push("onBeforeActivate")},postMixInProperties:function(){this.setValueDeferred=new q;this.inherited(arguments)},postCreate:function(){this.inherited(arguments);this._steps=this._steps.slice(0);this._undoedSteps=this._undoedSteps.slice(0);a.isArray(this.extraPlugins)&&(this.plugins=this.plugins.concat(this.extraPlugins));this.commands=n.getLocalization("dijit._editor",
"commands",this.lang);b("webkit")&&d.set(this.domNode,"KhtmlUserSelect","none")},startup:function(){this.inherited(arguments);this.toolbar||(this.toolbar=new r({ownerDocument:this.ownerDocument,dir:this.dir,lang:this.lang,"aria-label":this.id}),this.header.appendChild(this.toolbar.domNode));e.forEach(this.plugins,this.addPlugin,this);this.setValueDeferred.resolve(!0);h.add(this.iframe.parentNode,"dijitEditorIFrameContainer");h.add(this.iframe,"dijitEditorIFrame");l.set(this.iframe,"allowTransparency",
!0);this.toolbar.startup();this.onNormalizedDisplayChanged()},destroy:function(){e.forEach(this._plugins,function(a){a&&a.destroy&&a.destroy()});this._plugins=[];this.toolbar.destroyRecursive();delete this.toolbar;this.inherited(arguments)},addPlugin:function(b,c){var d=a.isString(b)?{name:b}:a.isFunction(b)?{ctor:b}:b;if(!d.setEditor){var g={args:d,plugin:null,editor:this};d.name&&(w.registry[d.name]?g.plugin=w.registry[d.name](d):u.publish(B._scopeName+".Editor.getPlugin",g));if(!g.plugin)try{var f=
d.ctor||a.getObject(d.name)||k(d.name);f&&(g.plugin=new f(d))}catch(P){throw Error(this.id+": cannot find plugin ["+d.name+"]");}if(!g.plugin)throw Error(this.id+": cannot find plugin ["+d.name+"]");b=g.plugin}1<arguments.length?this._plugins[c]=b:this._plugins.push(b);b.setEditor(this);a.isFunction(b.setToolbar)&&b.setToolbar(this.toolbar)},resize:function(a){a&&v.prototype.resize.apply(this,arguments)},layout:function(){var a=this._contentBox.h-(this.getHeaderHeight()+this.getFooterHeight()+f.getPadBorderExtents(this.iframe.parentNode).h+
f.getMarginExtents(this.iframe.parentNode).h);this.editingArea.style.height=a+"px";this.iframe&&(this.iframe.style.height="100%");this._layoutMode=!0},_onIEMouseDown:function(a){var b,c=this.document.body,d=c.clientWidth,g=c.clientHeight,f=c.clientLeft,e=c.offsetWidth,m=c.offsetHeight,h=c.offsetLeft;/^rtl$/i.test(c.dir||"")?d<e&&a.x>d&&a.x<e&&(b=!0):a.x<f&&a.x>h&&(b=!0);b||g<m&&a.y>g&&a.y<m&&(b=!0);b||(delete this._cursorToStart,delete this._savedSelection,"BODY"==a.target.tagName&&this.defer("placeCursorAtEnd"),
this.inherited(arguments))},onBeforeActivate:function(){this._restoreSelection()},onBeforeDeactivate:function(a){this.customUndo&&this.endEditing(!0);"BODY"!=a.target.tagName&&this._saveSelection()},customUndo:!0,editActionInterval:3,beginEditing:function(a){this._inEditing||(this._inEditing=!0,this._beginEditing(a));0<this.editActionInterval&&(this._editTimer&&this._editTimer.remove(),this._editTimer=this.defer("endEditing",this._editInterval))},_steps:[],_undoedSteps:[],execCommand:function(a){if(!this.customUndo||
"undo"!=a&&"redo"!=a){this.customUndo&&(this.endEditing(),this._beginEditing());var b=this.inherited(arguments);this.customUndo&&this._endEditing();return b}return this[a]()},_pasteImpl:function(){return this._clipboardCommand("paste")},_cutImpl:function(){return this._clipboardCommand("cut")},_copyImpl:function(){return this._clipboardCommand("copy")},_clipboardCommand:function(a){var c;try{if(c=this.document.execCommand(a,!1,null),b("webkit")&&!c)throw{};}catch(M){c=g.substitute,alert(c(this.commands.systemShortcut,
[this.commands[a],c(this.commands[b("mac")?"appleKey":"ctrlKey"],[{cut:"X",copy:"C",paste:"V"}[a]])])),c=!1}return c},queryCommandEnabled:function(a){return!this.customUndo||"undo"!=a&&"redo"!=a?this.inherited(arguments):"undo"==a?1<this._steps.length:0<this._undoedSteps.length},_moveToBookmark:function(c){var d=c.mark,g=c.mark;c=c.isCollapsed;var f,m,h;g&&(9>b("ie")||9===b("ie")&&b("quirks")?a.isArray(g)?(d=[],e.forEach(g,function(a){d.push(A.getNode(a,this.editNode))},this),this.selection.moveToBookmark({mark:d,
isCollapsed:c})):g.startContainer&&g.endContainer&&(h=A.getSelection(this.window))&&h.removeAllRanges&&(h.removeAllRanges(),c=A.create(this.window),f=A.getNode(g.startContainer,this.editNode),m=A.getNode(g.endContainer,this.editNode),f&&m&&(c.setStart(f,g.startOffset),c.setEnd(m,g.endOffset),h.addRange(c))):(h=A.getSelection(this.window))&&h.removeAllRanges&&(h.removeAllRanges(),c=A.create(this.window),f=A.getNode(g.startContainer,this.editNode),m=A.getNode(g.endContainer,this.editNode),f&&m&&(c.setStart(f,
g.startOffset),c.setEnd(m,g.endOffset),h.addRange(c))))},_changeToStep:function(a,b){this.setValue(b.text);(a=b.bookmark)&&this._moveToBookmark(a)},undo:function(){var a=!1;if(!this._undoRedoActive){this._undoRedoActive=!0;this.endEditing(!0);var b=this._steps.pop();b&&0<this._steps.length&&(this.focus(),this._changeToStep(b,this._steps[this._steps.length-1]),this._undoedSteps.push(b),this.onDisplayChanged(),delete this._undoRedoActive,a=!0);delete this._undoRedoActive}return a},redo:function(){var a=
!1;if(!this._undoRedoActive){this._undoRedoActive=!0;this.endEditing(!0);var b=this._undoedSteps.pop();b&&0<this._steps.length&&(this.focus(),this._changeToStep(this._steps[this._steps.length-1],b),this._steps.push(b),this.onDisplayChanged(),a=!0);delete this._undoRedoActive}return a},endEditing:function(a){this._editTimer&&(this._editTimer=this._editTimer.remove());this._inEditing&&(this._endEditing(a),this._inEditing=!1)},_getBookmark:function(){var c=this.selection.getBookmark(),d=[];if(c&&c.mark){var g=
c.mark;if(9>b("ie")||9===b("ie")&&b("quirks")){var f=A.getSelection(this.window);if(a.isArray(g))e.forEach(c.mark,function(a){d.push(A.getIndex(a,this.editNode).o)},this),c.mark=d;else if(f){var m;f.rangeCount&&(m=f.getRangeAt(0));c.mark=m?m.cloneRange():this.selection.getBookmark()}}try{c.mark&&c.mark.startContainer&&(d=A.getIndex(c.mark.startContainer,this.editNode).o,c.mark={startContainer:d,startOffset:c.mark.startOffset,endContainer:c.mark.endContainer===c.mark.startContainer?d:A.getIndex(c.mark.endContainer,
this.editNode).o,endOffset:c.mark.endOffset})}catch(P){c.mark=null}}return c},_beginEditing:function(){0===this._steps.length&&this._steps.push({text:x.getChildrenHtml(this.editNode),bookmark:this._getBookmark()})},_endEditing:function(){var a=x.getChildrenHtml(this.editNode);this._undoedSteps=[];this._steps.push({text:a,bookmark:this._getBookmark()})},onKeyDown:function(a){b("ie")||this.iframe||a.keyCode!=c.TAB||this.tabIndent||this._saveSelection();if(this.customUndo){var d=a.keyCode;if(a.ctrlKey&&
!a.shiftKey&&!a.altKey){if(90==d||122==d){a.stopPropagation();a.preventDefault();this.undo();return}if(89==d||121==d){a.stopPropagation();a.preventDefault();this.redo();return}}this.inherited(arguments);switch(d){case c.ENTER:case c.BACKSPACE:case c.DELETE:this.beginEditing();break;case 88:case 86:if(a.ctrlKey&&!a.altKey&&!a.metaKey){this.endEditing();88==a.keyCode?this.beginEditing("cut"):this.beginEditing("paste");this.defer("endEditing",1);break}default:if(!a.ctrlKey&&!a.altKey&&!a.metaKey&&(a.keyCode<
c.F1||a.keyCode>c.F15)){this.beginEditing();break}case c.ALT:this.endEditing();break;case c.UP_ARROW:case c.DOWN_ARROW:case c.LEFT_ARROW:case c.RIGHT_ARROW:case c.HOME:case c.END:case c.PAGE_UP:case c.PAGE_DOWN:this.endEditing(!0);case c.CTRL:case c.SHIFT:case c.TAB:}}else this.inherited(arguments)},_onBlur:function(){this.inherited(arguments);this.endEditing(!0)},_saveSelection:function(){try{this._savedSelection=this._getBookmark()}catch(F){}},_restoreSelection:function(){this._savedSelection&&
(delete this._cursorToStart,this.selection.isCollapsed()&&this._moveToBookmark(this._savedSelection),delete this._savedSelection)},onClick:function(){this.endEditing(!0);this.inherited(arguments)},replaceValue:function(a){this.customUndo?this.isClosed?this.setValue(a):(this.beginEditing(),a||(a="\x26#160;"),this.setValue(a),this.endEditing()):this.inherited(arguments)},_setDisabledAttr:function(b){this.setValueDeferred.then(a.hitch(this,function(){!this.disabled&&b||!this._buttonEnabledPlugins&&b?
e.forEach(this._plugins,function(a){a.set("disabled",!0)}):this.disabled&&!b&&e.forEach(this._plugins,function(a){a.set("disabled",!1)})}));this.inherited(arguments)},_setStateClass:function(){try{this.inherited(arguments),this.document&&this.document.body&&d.set(this.document.body,"color",d.get(this.iframe,"color"))}catch(F){}}});a.mixin(w.registry,{undo:E,redo:E,cut:E,copy:E,paste:E,insertOrderedList:E,insertUnorderedList:E,indent:E,outdent:E,justifyCenter:E,justifyFull:E,justifyLeft:E,justifyRight:E,
"delete":E,selectAll:E,removeFormat:E,unlink:E,insertHorizontalRule:E,bold:D,italic:D,underline:D,strikethrough:D,subscript:D,superscript:D,"|":function(){return new w({setEditor:function(a){this.editor=a;this.button=new t({ownerDocument:a.ownerDocument})}})}});return p})},"dijit/Toolbar":function(){define("require dojo/_base/declare dojo/has dojo/keys dojo/ready ./_Widget ./_KeyNavContainer ./_TemplatedMixin".split(" "),function(k,e,p,q,n,l,h,f){p("dijit-legacy-requires")&&n(0,function(){k(["dijit/ToolbarSeparator"])});
return e("dijit.Toolbar",[l,f,h],{templateString:'\x3cdiv class\x3d"dijit" role\x3d"toolbar" tabIndex\x3d"${tabIndex}" data-dojo-attach-point\x3d"containerNode"\x3e\x3c/div\x3e',baseClass:"dijitToolbar",_onLeftArrow:function(){this.focusPrev()},_onRightArrow:function(){this.focusNext()}})})},"dijit/ToolbarSeparator":function(){define(["dojo/_base/declare","dojo/dom","./_Widget","./_TemplatedMixin"],function(k,e,p,q){return k("dijit.ToolbarSeparator",[p,q],{templateString:'\x3cdiv class\x3d"dijitToolbarSeparator dijitInline" role\x3d"presentation"\x3e\x3c/div\x3e',
buildRendering:function(){this.inherited(arguments);e.setSelectable(this.domNode,!1)},isFocusable:function(){return!1}})})},"dijit/layout/_LayoutWidget":function(){define("dojo/_base/lang ../_Widget ../_Container ../_Contained ../Viewport dojo/_base/declare dojo/dom-class dojo/dom-geometry dojo/dom-style".split(" "),function(k,e,p,q,n,l,h,f,d){return l("dijit.layout._LayoutWidget",[e,p,q],{baseClass:"dijitLayoutContainer",isLayoutContainer:!0,_setTitleAttr:null,buildRendering:function(){this.inherited(arguments);
h.add(this.domNode,"dijitContainer")},startup:function(){if(!this._started){this.inherited(arguments);var c=this.getParent&&this.getParent();c&&c.isLayoutContainer||(this.resize(),this.own(n.on("resize",k.hitch(this,"resize"))))}},resize:function(c,a){var b=this.domNode;c&&f.setMarginBox(b,c);a=a||{};k.mixin(a,c||{});"h"in a&&"w"in a||(a=k.mixin(f.getMarginBox(b),a));c=d.getComputedStyle(b);var g=f.getMarginExtents(b,c),e=f.getBorderExtents(b,c);a=this._borderBox={w:a.w-(g.w+e.w),h:a.h-(g.h+e.h)};
g=f.getPadExtents(b,c);this._contentBox={l:d.toPixelValue(b,c.paddingLeft),t:d.toPixelValue(b,c.paddingTop),w:a.w-g.w,h:a.h-g.h};this.layout()},layout:function(){},_setupChild:function(c){h.add(c.domNode,this.baseClass+"-child "+(c.baseClass?this.baseClass+"-"+c.baseClass:""))},addChild:function(c,a){this.inherited(arguments);this._started&&this._setupChild(c)},removeChild:function(c){h.remove(c.domNode,this.baseClass+"-child"+(c.baseClass?" "+this.baseClass+"-"+c.baseClass:""));this.inherited(arguments)}})})},
"dijit/_editor/_Plugin":function(){define(["dojo/_base/connect","dojo/_base/declare","dojo/_base/lang","../Destroyable","../form/Button"],function(k,e,p,q,n){e=e("dijit._editor._Plugin",q,{constructor:function(e){this.params=e||{};p.mixin(this,this.params);this._attrPairNames={}},editor:null,iconClassPrefix:"dijitEditorIcon",button:null,command:"",useDefaultCommand:!0,buttonClass:n,disabled:!1,getLabel:function(e){return this.editor.commands[e]},_initButton:function(){if(this.command.length){var e=
this.getLabel(this.command),h=this.editor,f=this.iconClassPrefix+" "+this.iconClassPrefix+this.command.charAt(0).toUpperCase()+this.command.substr(1);this.button||(e=p.mixin({label:e,ownerDocument:h.ownerDocument,dir:h.dir,lang:h.lang,showLabel:!1,iconClass:f,dropDown:this.dropDown,tabIndex:"-1"},this.params||{}),delete e.name,this.button=new this.buttonClass(e))}this.get("disabled")&&this.button&&this.button.set("disabled",this.get("disabled"))},destroy:function(){this.dropDown&&this.dropDown.destroyRecursive();
this.inherited(arguments)},connect:function(e,h,f){this.own(k.connect(e,h,this,f))},updateState:function(){var e=this.editor,h=this.command,f,d;if(e&&e.isLoaded&&h.length){var c=this.get("disabled");if(this.button)try{d=!c&&e.queryCommandEnabled(h),this.enabled!==d&&(this.enabled=d,this.button.set("disabled",!d)),d&&"boolean"==typeof this.button.checked&&(f=e.queryCommandState(h),this.checked!==f&&(this.checked=f,this.button.set("checked",e.queryCommandState(h))))}catch(a){console.log(a)}}},setEditor:function(e){this.editor=
e;this._initButton();this.button&&this.useDefaultCommand&&(this.editor.queryCommandAvailable(this.command)?this.own(this.button.on("click",p.hitch(this.editor,"execCommand",this.command,this.commandArg))):this.button.domNode.style.display="none");this.own(this.editor.on("NormalizedDisplayChanged",p.hitch(this,"updateState")))},setToolbar:function(e){this.button&&e.addChild(this.button)},set:function(e,h){if("object"===typeof e){for(var f in e)this.set(f,e[f]);return this}f=this._getAttrNames(e);if(this[f.s])var d=
this[f.s].apply(this,Array.prototype.slice.call(arguments,1));else this._set(e,h);return d||this},get:function(e){var h=this._getAttrNames(e);return this[h.g]?this[h.g]():this[e]},_setDisabledAttr:function(e){this._set("disabled",e);this.updateState()},_getAttrNames:function(e){var h=this._attrPairNames;if(h[e])return h[e];var f=e.charAt(0).toUpperCase()+e.substr(1);return h[e]={s:"_set"+f+"Attr",g:"_get"+f+"Attr"}},_set:function(e,h){this[e]=h}});e.registry={};return e})},"dijit/_editor/plugins/EnterKeyHandling":function(){define("dojo/_base/declare dojo/dom-construct dojo/keys dojo/_base/lang dojo/on dojo/sniff dojo/_base/window dojo/window ../_Plugin ../RichText ../range".split(" "),
function(k,e,p,q,n,l,h,f,d,c,a){return k("dijit._editor.plugins.EnterKeyHandling",d,{blockNodeForEnter:"BR",constructor:function(a){a&&("blockNodeForEnter"in a&&(a.blockNodeForEnter=a.blockNodeForEnter.toUpperCase()),q.mixin(this,a))},setEditor:function(a){if(this.editor!==a)if(this.editor=a,"BR"==this.blockNodeForEnter)this.editor.customUndo=!0,a.onLoadDeferred.then(q.hitch(this,function(b){this.own(n(a.document,"keydown",q.hitch(this,function(a){if(a.keyCode==p.ENTER){var b=q.mixin({},a);b.shiftKey=
!0;this.handleEnterKey(b)||(a.stopPropagation(),a.preventDefault())}})));9<=l("ie")&&10>=l("ie")&&this.own(n(a.document,"paste",q.hitch(this,function(a){setTimeout(q.hitch(this,function(){var a=this.editor.document.selection.createRange();a.move("character",-1);a.select();a.move("character",1);a.select()}),0)})));return b}));else if(this.blockNodeForEnter){var b=q.hitch(this,"handleEnterKey");a.addKeyHandler(13,0,0,b);a.addKeyHandler(13,0,1,b);this.own(this.editor.on("KeyPressed",q.hitch(this,"onKeyPressed")))}},
onKeyPressed:function(){if(this._checkListLater){if(this.editor.selection.isCollapsed()){var b=this.editor.selection.getAncestorElement("LI");if(b){l("mozilla")&&"LI"==b.parentNode.parentNode.nodeName&&(b=b.parentNode.parentNode);var d=b.firstChild;!d||1!=d.nodeType||"UL"!=d.nodeName&&"OL"!=d.nodeName||(b.insertBefore(d.ownerDocument.createTextNode("\u00a0"),d),d=a.create(this.editor.window),d.setStart(b.firstChild,0),b=a.getSelection(this.editor.window,!0),b.removeAllRanges(),b.addRange(d))}else c.prototype.execCommand.call(this.editor,
"formatblock",this.blockNodeForEnter),(b=this.editor.selection.getAncestorElement(this.blockNodeForEnter))?(b.innerHTML=this.bogusHtmlContent,9>=l("ie")&&(b=this.editor.document.selection.createRange(),b.move("character",-1),b.select())):console.error("onKeyPressed: Cannot find the new block node")}this._checkListLater=!1}this._pressedEnterInBlock&&(this._pressedEnterInBlock.previousSibling&&this.removeTrailingBr(this._pressedEnterInBlock.previousSibling),delete this._pressedEnterInBlock)},bogusHtmlContent:"\x26#160;",
blockNodes:/^(?:P|H1|H2|H3|H4|H5|H6|LI)$/,handleEnterKey:function(b){var d,h,m,k,n=this.editor.document,p,q,w;if(b.shiftKey){b=this.editor.selection.getParentElement();if(k=a.getAncestor(b,this.blockNodes)){if("LI"==k.tagName)return!0;b=a.getSelection(this.editor.window);d=b.getRangeAt(0);d.collapsed||(d.deleteContents(),b=a.getSelection(this.editor.window),d=b.getRangeAt(0));if(a.atBeginningOfContainer(k,d.startContainer,d.startOffset))p=n.createElement("br"),d=a.create(this.editor.window),k.insertBefore(p,
k.firstChild),d.setStartAfter(p),b.removeAllRanges(),b.addRange(d);else if(a.atEndOfContainer(k,d.startContainer,d.startOffset))d=a.create(this.editor.window),p=n.createElement("br"),k.appendChild(p),k.appendChild(n.createTextNode("\u00a0")),d.setStart(k.lastChild,0),b.removeAllRanges(),b.addRange(d);else return(q=d.startContainer)&&3==q.nodeType?(w=q.nodeValue,h=n.createTextNode(w.substring(0,d.startOffset)),m=n.createTextNode(w.substring(d.startOffset)),k=n.createElement("br"),""==m.nodeValue&&
l("webkit")&&(m=n.createTextNode("\u00a0")),e.place(h,q,"after"),e.place(k,h,"after"),e.place(m,k,"after"),e.destroy(q),d=a.create(this.editor.window),d.setStart(m,0),b.removeAllRanges(),b.addRange(d),!1):!0}else b=a.getSelection(this.editor.window),b.rangeCount?(d=b.getRangeAt(0))&&d.startContainer&&(d.collapsed||(d.deleteContents(),b=a.getSelection(this.editor.window),d=b.getRangeAt(0)),(q=d.startContainer)&&3==q.nodeType?(k=d.startOffset,q.length<k&&(m=this._adjustNodeAndOffset(q,k),q=m.node,k=
m.offset),w=q.nodeValue,h=n.createTextNode(w.substring(0,k)),m=n.createTextNode(w.substring(k)),k=n.createElement("br"),m.length||(m=n.createTextNode("\u00a0")),h.length?e.place(h,q,"after"):h=q,e.place(k,h,"after"),e.place(m,k,"after"),e.destroy(q)):(0<=d.startOffset&&(p=q.childNodes[d.startOffset]),k=n.createElement("br"),m=n.createTextNode("\u00a0"),p?(e.place(k,p,"before"),e.place(m,k,"after")):(q.appendChild(k),q.appendChild(m))),d=a.create(this.editor.window),d.setStart(m,0),d.setEnd(m,m.length),
b.removeAllRanges(),b.addRange(d),this.editor.selection.collapse(!0)):c.prototype.execCommand.call(this.editor,"inserthtml","\x3cbr\x3e");return!1}var z=!0;b=a.getSelection(this.editor.window);d=b.getRangeAt(0);d.collapsed||(d.deleteContents(),b=a.getSelection(this.editor.window),d=b.getRangeAt(0));p=a.getBlockAncestor(d.endContainer,null,this.editor.editNode);var x=p.blockNode;if(this._checkListLater=x&&("LI"==x.nodeName||"LI"==x.parentNode.nodeName))return l("mozilla")&&(this._pressedEnterInBlock=
x),/^(\s|&nbsp;|&#160;|\xA0|<span\b[^>]*\bclass=['"]Apple-style-span['"][^>]*>(\s|&nbsp;|&#160;|\xA0)<\/span>)?(<br>)?$/.test(x.innerHTML)&&(x.innerHTML="",l("webkit")&&(d=a.create(this.editor.window),d.setStart(x,0),b.removeAllRanges(),b.addRange(d)),this._checkListLater=!1),!0;if(!p.blockNode||p.blockNode===this.editor.editNode){try{c.prototype.execCommand.call(this.editor,"formatblock",this.blockNodeForEnter)}catch(A){}p={blockNode:this.editor.selection.getAncestorElement(this.blockNodeForEnter),
blockContainer:this.editor.editNode};if(p.blockNode){if(p.blockNode!=this.editor.editNode&&!(p.blockNode.textContent||p.blockNode.innerHTML).replace(/^\s+|\s+$/g,"").length)return this.removeTrailingBr(p.blockNode),!1}else p.blockNode=this.editor.editNode;b=a.getSelection(this.editor.window);d=b.getRangeAt(0)}x=n.createElement(this.blockNodeForEnter);x.innerHTML=this.bogusHtmlContent;this.removeTrailingBr(p.blockNode);m=d.endOffset;z=d.endContainer;z.length<m&&(m=this._adjustNodeAndOffset(z,m),z=
m.node,m=m.offset);if(a.atEndOfContainer(p.blockNode,z,m))p.blockNode===p.blockContainer?p.blockNode.appendChild(x):e.place(x,p.blockNode,"after"),z=!1,d=a.create(this.editor.window),d.setStart(x,0),b.removeAllRanges(),b.addRange(d),this.editor.height&&f.scrollIntoView(x);else if(a.atBeginningOfContainer(p.blockNode,d.startContainer,d.startOffset))e.place(x,p.blockNode,p.blockNode===p.blockContainer?"first":"before"),x.nextSibling&&this.editor.height&&(d=a.create(this.editor.window),d.setStart(x.nextSibling,
0),b.removeAllRanges(),b.addRange(d),f.scrollIntoView(x.nextSibling)),z=!1;else{p.blockNode===p.blockContainer?p.blockNode.appendChild(x):e.place(x,p.blockNode,"after");z=!1;p.blockNode.style&&x.style&&p.blockNode.style.cssText&&(x.style.cssText=p.blockNode.style.cssText);if((q=d.startContainer)&&3==q.nodeType){m=d.endOffset;q.length<m&&(m=this._adjustNodeAndOffset(q,m),q=m.node,m=m.offset);w=q.nodeValue;h=n.createTextNode(w.substring(0,m));m=n.createTextNode(w.substring(m,w.length));e.place(h,q,
"before");e.place(m,q,"after");e.destroy(q);for(d=h.parentNode;d!==p.blockNode;){w=n.createElement(d.tagName);d.style&&w.style&&d.style.cssText&&(w.style.cssText=d.style.cssText);"FONT"===d.tagName&&(d.color&&(w.color=d.color),d.face&&(w.face=d.face),d.size&&(w.size=d.size));for(;m;)q=m.nextSibling,w.appendChild(m),m=q;e.place(w,d,"after");h=d;m=w;d=d.parentNode}if(1==m.nodeType||3==m.nodeType&&m.nodeValue)x.innerHTML="";for(h=m;m;)q=m.nextSibling,x.appendChild(m),m=q}d=a.create(this.editor.window);
n=h;if("BR"!==this.blockNodeForEnter){for(;n;)k=n,n=q=n.firstChild;k&&k.parentNode?(x=k.parentNode,d.setStart(x,0),b.removeAllRanges(),b.addRange(d),this.editor.height&&f.scrollIntoView(x),l("mozilla")&&(this._pressedEnterInBlock=p.blockNode)):z=!0}else d.setStart(x,0),b.removeAllRanges(),b.addRange(d),this.editor.height&&f.scrollIntoView(x),l("mozilla")&&(this._pressedEnterInBlock=p.blockNode)}return z},_adjustNodeAndOffset:function(a,c){for(;a.length<c&&a.nextSibling&&3==a.nextSibling.nodeType;)c-=
a.length,a=a.nextSibling;return{node:a,offset:c}},removeTrailingBr:function(a){if(a=/P|DIV|LI/i.test(a.tagName)?a:this.editor.selection.getParentOfType(a,["P","DIV","LI"]))a.lastChild&&(1<a.childNodes.length&&3==a.lastChild.nodeType&&/^[\s\xAD]*$/.test(a.lastChild.nodeValue)||"BR"==a.lastChild.tagName)&&e.destroy(a.lastChild),a.childNodes.length||(a.innerHTML=this.bogusHtmlContent)}})})},"dijit/_editor/RichText":function(){define("dojo/_base/array dojo/_base/config dojo/_base/declare dojo/_base/Deferred dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/dom-geometry dojo/dom-style dojo/_base/kernel dojo/keys dojo/_base/lang dojo/on dojo/query dojo/domReady dojo/sniff dojo/string dojo/topic dojo/_base/unload dojo/_base/url dojo/window ../_Widget ../_CssStateMixin ../selection ./range ./html ../focus ../main".split(" "),
function(k,e,p,q,n,l,h,f,d,c,a,b,g,u,m,r,t,v,y,w,z,x,A,C,B,E,D,F,I){var M=p("dijit._editor.RichText",[A,C],{constructor:function(a){this.contentPreFilters=[];this.contentPostFilters=[];this.contentDomPreFilters=[];this.contentDomPostFilters=[];this.editingAreaStyleSheets=[];this.events=[].concat(this.events);this._keyHandlers={};a&&g.isString(a.value)&&(this.value=a.value);this.onLoadDeferred=new q},baseClass:"dijitEditor",inheritWidth:!1,focusOnLoad:!1,name:"",styleSheets:"",height:"300px",minHeight:"1em",
isClosed:!0,isLoaded:!1,_SEPARATOR:"@@**%%__RICHTEXTBOUNDRY__%%**@@",_NAME_CONTENT_SEP:"@@**%%:%%**@@",onLoadDeferred:null,isTabIndent:!1,disableSpellCheck:!1,postCreate:function(){"textarea"===this.domNode.tagName.toLowerCase()&&console.warn("RichText should not be used with the TEXTAREA tag.  See dijit._editor.RichText docs.");this.contentPreFilters=[g.trim,g.hitch(this,"_preFixUrlAttributes")].concat(this.contentPreFilters);t("mozilla")&&(this.contentPreFilters=[this._normalizeFontStyle].concat(this.contentPreFilters),
this.contentPostFilters=[this._removeMozBogus].concat(this.contentPostFilters));t("webkit")&&(this.contentPreFilters=[this._removeWebkitBogus].concat(this.contentPreFilters),this.contentPostFilters=[this._removeWebkitBogus].concat(this.contentPostFilters));if(t("ie")||t("trident"))this.contentPostFilters=[this._normalizeFontStyle].concat(this.contentPostFilters),this.contentDomPostFilters=[g.hitch(this,"_stripBreakerNodes")].concat(this.contentDomPostFilters);this.contentDomPostFilters=[g.hitch(this,
"_stripTrailingEmptyNodes")].concat(this.contentDomPostFilters);this.inherited(arguments);y.publish(I._scopeName+"._editor.RichText::init",this)},startup:function(){this.inherited(arguments);this.open();this.setupDefaultShortcuts()},setupDefaultShortcuts:function(){var a=g.hitch(this,function(a,b){return function(){return!this.execCommand(a,b)}}),b={b:a("bold"),i:a("italic"),u:a("underline"),a:a("selectall"),s:function(){this.save(!0)},m:function(){this.isTabIndent=!this.isTabIndent},1:a("formatblock",
"h1"),2:a("formatblock","h2"),3:a("formatblock","h3"),4:a("formatblock","h4"),"\\":a("insertunorderedlist")};t("ie")||(b.Z=a("redo"));for(var c in b)this.addKeyHandler(c,!0,!1,b[c])},events:["onKeyDown","onKeyUp"],captureEvents:[],_editorCommandsLocalized:!1,_localizeEditorCommands:function(){if(M._editorCommandsLocalized)this._local2NativeFormatNames=M._local2NativeFormatNames,this._native2LocalFormatNames=M._native2LocalFormatNames;else{M._editorCommandsLocalized=!0;M._local2NativeFormatNames={};
M._native2LocalFormatNames={};this._local2NativeFormatNames=M._local2NativeFormatNames;this._native2LocalFormatNames=M._native2LocalFormatNames;for(var a="div p pre h1 h2 h3 h4 h5 h6 ol ul address".split(" "),b="",c,d=0;c=a[d++];)b="l"!==c.charAt(1)?b+("\x3c"+c+"\x3e\x3cspan\x3econtent\x3c/span\x3e\x3c/"+c+"\x3e\x3cbr/\x3e"):b+("\x3c"+c+"\x3e\x3cli\x3econtent\x3c/li\x3e\x3c/"+c+"\x3e\x3cbr/\x3e");var e=f.create("div",{style:{position:"absolute",top:"0px",zIndex:10,opacity:.01},innerHTML:b});this.ownerDocumentBody.appendChild(e);
a=g.hitch(this,function(){for(var a=e.firstChild;a;)try{this.selection.selectElement(a.firstChild);var b=a.tagName.toLowerCase();this._local2NativeFormatNames[b]=document.queryCommandValue("formatblock");this._native2LocalFormatNames[this._local2NativeFormatNames[b]]=b;a=a.nextSibling.nextSibling}catch(Y){}f.destroy(e)});this.defer(a)}},open:function(a){if(!this.onLoadDeferred||0<=this.onLoadDeferred.fired)this.onLoadDeferred=new q;this.isClosed||this.close();y.publish(I._scopeName+"._editor.RichText::open",
this);1===arguments.length&&a.nodeName&&(this.domNode=a);var b=this.domNode,d;if(g.isString(this.value))d=this.value,b.innerHTML="";else if(b.nodeName&&"textarea"==b.nodeName.toLowerCase()){var m=this.textarea=b;this.name=m.name;d=m.value;b=this.domNode=this.ownerDocument.createElement("div");b.setAttribute("widgetId",this.id);m.removeAttribute("widgetId");b.cssText=m.cssText;b.className+=" "+m.className;f.place(b,m,"before");var k=g.hitch(this,function(){c.set(m,{display:"block",position:"absolute",
top:"-1000px"});if(t("ie")){var a=m.style;this.__overflow=a.overflow;a.overflow="hidden"}});t("ie")?this.defer(k,10):k();if(m.form){var r=m.value;this.reset=function(){this.getValue()!==r&&this.replaceValue(r)};u(m.form,"submit",g.hitch(this,function(){l.set(m,"disabled",this.disabled);m.value=this.getValue()}))}}else d=D.getChildrenHtml(b),b.innerHTML="";this.value=d;b.nodeName&&"LI"===b.nodeName&&(b.innerHTML=" \x3cbr\x3e");this.header=b.ownerDocument.createElement("div");b.appendChild(this.header);
this.editingArea=b.ownerDocument.createElement("div");b.appendChild(this.editingArea);this.footer=b.ownerDocument.createElement("div");b.appendChild(this.footer);this.name||(this.name=this.id+"_AUTOGEN");if(""!==this.name&&(!e.useXDomain||e.allowXdRichTextSave)){if((d=n.byId(I._scopeName+"._editor.RichText.value"))&&""!==d.value)for(var k=d.value.split(this._SEPARATOR),p=0,v;v=k[p++];)if(v=v.split(this._NAME_CONTENT_SEP),v[0]===this.name){this.value=v[1];k=k.splice(p,1);d.value=k.join(this._SEPARATOR);
break}M._globalSaveHandler||(M._globalSaveHandler={},w.addOnUnload(function(){for(var a in M._globalSaveHandler){var b=M._globalSaveHandler[a];g.isFunction(b)&&b()}}));M._globalSaveHandler[this.id]=g.hitch(this,"_saveContent")}this.isClosed=!1;d=this.editorObject=this.iframe=this.ownerDocument.createElement("iframe");d.id=this.id+"_iframe";d.style.border="none";d.style.width="100%";this._layoutMode?d.style.height="100%":7<=t("ie")?(this.height&&(d.style.height=this.height),this.minHeight&&(d.style.minHeight=
this.minHeight)):d.style.height=this.height?this.height:this.minHeight;d.frameBorder=0;d._loadFunc=g.hitch(this,function(a){this.window=a;this.document=a.document;this.selection=new B.SelectionManager(a);t("ie")&&this._localizeEditorCommands();this.onLoad(this.get("value"))});k=this._getIframeDocTxt().replace(/\\/g,"\\\\").replace(/'/g,"\\'");k=11>t("ie")?'javascript:document.open();try{parent.window;}catch(e){document.domain\x3d"'+document.domain+"\";}document.write('"+k+"');document.close()":"javascript: '"+
k+"'";this.editingArea.appendChild(d);d.src=k;"LI"===b.nodeName&&(b.lastChild.style.marginTop="-1.2em");h.add(this.domNode,this.baseClass)},_local2NativeFormatNames:{},_native2LocalFormatNames:{},_getIframeDocTxt:function(){var b=c.getComputedStyle(this.domNode),d;if(this["aria-label"])d=this["aria-label"];else{var f=m('label[for\x3d"'+this.id+'"]',this.ownerDocument)[0]||n.byId(this["aria-labelledby"],this.ownerDocument);f&&(d=f.textContent||f.innerHTML||"")}var f="\x3cdiv id\x3d'dijitEditorBody' role\x3d'textbox' aria-multiline\x3d'true' "+
(d?" aria-label\x3d'"+v.escape(d)+"'":"")+"\x3e\x3c/div\x3e",e=[b.fontWeight,b.fontSize,b.fontFamily].join(" "),h=b.lineHeight,h=0<=h.indexOf("px")?parseFloat(h)/parseFloat(b.fontSize):0<=h.indexOf("em")?parseFloat(h):"normal",l="",k=this;this.style.replace(/(^|;)\s*(line-|font-?)[^;]+/ig,function(a){a=a.replace(/^;/ig,"")+";";var b=a.split(":")[0];if(b){var b=g.trim(b),b=b.toLowerCase(),d,f="";for(d=0;d<b.length;d++){var e=b.charAt(d);switch(e){case "-":d++,e=b.charAt(d).toUpperCase();default:f+=
e}}c.set(k.domNode,f,"")}l+=a+";"});this.iframe.setAttribute("title",d);return["\x3c!DOCTYPE html\x3e","\x3chtml lang\x3d'"+(this.lang||a.locale.replace(/-.*/,""))+"'"+(this.isLeftToRight()?"":" dir\x3d'rtl'")+"\x3e\n","\x3chead\x3e\n\x3cmeta http-equiv\x3d'Content-Type' content\x3d'text/html'\x3e\n",d?"\x3ctitle\x3e"+v.escape(d)+"\x3c/title\x3e":"","\x3cstyle\x3e\n\tbody,html {\n\t\tbackground:transparent;\n\t\tpadding: 1px 0 0 0;\n\t\tmargin: -1px 0 0 0;\n\t}\n\tbody,html,#dijitEditorBody { outline: none; }html { height: 100%; width: 100%; overflow: hidden; }\n",
this.height?"\tbody,#dijitEditorBody { height: 100%; width: 100%; overflow: auto; }\n":"\tbody,#dijitEditorBody { min-height: "+this.minHeight+"; width: 100%; overflow-x: auto; overflow-y: hidden; }\n","\tbody{\n\t\ttop:0px;\n\t\tleft:0px;\n\t\tright:0px;\n\t\tfont:",e,";\n",this.height||t("opera")?"":"\t\tposition: fixed;\n","\t\tline-height:",h,";\n\t}\n\tp{ margin: 1em 0; }\n\tli \x3e ul:-moz-first-node, li \x3e ol:-moz-first-node{ padding-top: 1.2em; }\n",t("ie")||t("trident")||t("edge")?"":"\tli{ min-height:1.2em; }\n",
"\x3c/style\x3e\n",this._applyEditingAreaStyleSheets(),"\n\x3c/head\x3e\n\x3cbody role\x3d'application'",d?" aria-label\x3d'"+v.escape(d)+"'":"","onload\x3d'try{frameElement \x26\x26 frameElement._loadFunc(window,document)}catch(e){document.domain\x3d\""+document.domain+"\";frameElement._loadFunc(window,document)}' ","style\x3d'"+l+"'\x3e",f,"\x3c/body\x3e\n\x3c/html\x3e"].join("")},_applyEditingAreaStyleSheets:function(){var a=[];this.styleSheets&&(a=this.styleSheets.split(";"),this.styleSheets=
"");a=a.concat(this.editingAreaStyleSheets);this.editingAreaStyleSheets=[];for(var b="",c=0,d,g=x.get(this.ownerDocument);d=a[c++];)d=(new z(g.location,d)).toString(),this.editingAreaStyleSheets.push(d),b+='\x3clink rel\x3d"stylesheet" type\x3d"text/css" href\x3d"'+d+'"/\x3e';return b},addStyleSheet:function(a){var b=a.toString(),c=x.get(this.ownerDocument);if("."===b.charAt(0)||"/"!==b.charAt(0)&&!a.host)b=(new z(c.location,b)).toString();-1<k.indexOf(this.editingAreaStyleSheets,b)||(this.editingAreaStyleSheets.push(b),
this.onLoadDeferred.then(g.hitch(this,function(){if(this.document.createStyleSheet)this.document.createStyleSheet(b);else{var a=this.document.getElementsByTagName("head")[0],c=this.document.createElement("link");c.rel="stylesheet";c.type="text/css";c.href=b;a.appendChild(c)}})))},removeStyleSheet:function(a){var b=a.toString(),c=x.get(this.ownerDocument);if("."===b.charAt(0)||"/"!==b.charAt(0)&&!a.host)b=(new z(c.location,b)).toString();a=k.indexOf(this.editingAreaStyleSheets,b);-1!==a&&(delete this.editingAreaStyleSheets[a],
m('link[href\x3d"'+b+'"]',this.window.document).orphan())},disabled:!1,_mozSettingProps:{styleWithCSS:!1},_setDisabledAttr:function(a){a=!!a;this._set("disabled",a);if(this.isLoaded){var b=t("ie")&&(this.isLoaded||!this.focusOnLoad);b&&(this.editNode.unselectable="on");this.editNode.contentEditable=!a;this.editNode.tabIndex=a?"-1":this.tabIndex;b&&this.defer(function(){this.editNode&&(this.editNode.unselectable="off")});if(t("mozilla")&&!a&&this._mozSettingProps){a=this._mozSettingProps;for(var c in a)if(a.hasOwnProperty(c))try{this.document.execCommand(c,
!1,a[c])}catch(K){}}this._disabledOK=!0}},onLoad:function(a){this.window.__registeredWindow||(this.window.__registeredWindow=!0,this._iframeRegHandle=F.registerIframe(this.iframe));this.editNode=this.document.body.firstChild;var b=this;this.beforeIframeNode=f.place("\x3cdiv tabIndex\x3d-1\x3e\x3c/div\x3e",this.iframe,"before");this.afterIframeNode=f.place("\x3cdiv tabIndex\x3d-1\x3e\x3c/div\x3e",this.iframe,"after");this.iframe.onfocus=this.document.onfocus=function(){b.editNode.focus()};this.focusNode=
this.editNode;var c=this.events.concat(this.captureEvents),d=this.iframe?this.document:this.editNode;this.own.apply(this,k.map(c,function(a){var b=a.toLowerCase().replace(/^on/,"");return u(d,b,g.hitch(this,a))},this));this.own(u(d,"mouseup",g.hitch(this,"onClick")));t("ie")&&(this.own(u(this.document,"mousedown",g.hitch(this,"_onIEMouseDown"))),this.editNode.style.zoom=1);t("webkit")&&(this._webkitListener=this.own(u(this.document,"mouseup",g.hitch(this,"onDisplayChanged")))[0],this.own(u(this.document,
"mousedown",g.hitch(this,function(a){a=a.target;!a||a!==this.document.body&&a!==this.document||this.defer("placeCursorAtEnd")}))));if(t("ie"))try{this.document.execCommand("RespectVisibilityInDesign",!0,null)}catch(U){}this.isLoaded=!0;this.set("disabled",this.disabled);c=g.hitch(this,function(){this.setValue(a);this.onLoadDeferred&&!this.onLoadDeferred.isFulfilled()&&this.onLoadDeferred.resolve(!0);this.onDisplayChanged();this.focusOnLoad&&r(g.hitch(this,"defer","focus",this.updateInterval));this.value=
this.getValue(!0)});this.setValueDeferred?this.setValueDeferred.then(c):c()},onKeyDown:function(a){if(a.keyCode===b.SHIFT||a.keyCode===b.ALT||a.keyCode===b.META||a.keyCode===b.CTRL)return!0;a.keyCode===b.TAB&&this.isTabIndent&&(a.stopPropagation(),a.preventDefault(),this.queryCommandEnabled(a.shiftKey?"outdent":"indent")&&this.execCommand(a.shiftKey?"outdent":"indent"));if(a.keyCode==b.TAB&&!this.isTabIndent&&!a.ctrlKey&&!a.altKey)return a.shiftKey?this.beforeIframeNode.focus():this.afterIframeNode.focus(),
!0;9>t("ie")&&a.keyCode===b.BACKSPACE&&"Control"===this.document.selection.type&&(a.stopPropagation(),a.preventDefault(),this.execCommand("delete"));t("ff")&&(a.keyCode===b.PAGE_UP||a.keyCode===b.PAGE_DOWN)&&this.editNode.clientHeight>=this.editNode.scrollHeight&&a.preventDefault();var c=this._keyHandlers[a.keyCode],d=arguments;c&&!a.altKey&&k.some(c,function(b){if(!(b.shift^a.shiftKey||b.ctrl^(a.ctrlKey||a.metaKey)))return b.handler.apply(this,d)||a.preventDefault(),!0},this);this.defer("onKeyPressed",
1);return!0},onKeyUp:function(){},setDisabled:function(b){a.deprecated("dijit.Editor::setDisabled is deprecated",'use dijit.Editor::attr("disabled",boolean) instead',2);this.set("disabled",b)},_setValueAttr:function(a){this.setValue(a)},_setDisableSpellCheckAttr:function(a){this.document?l.set(this.document.body,"spellcheck",!a):this.onLoadDeferred.then(g.hitch(this,function(){l.set(this.document.body,"spellcheck",!a)}));this._set("disableSpellCheck",a)},addKeyHandler:function(a,b,c,d){"string"==
typeof a&&(a=a.toUpperCase().charCodeAt(0));g.isArray(this._keyHandlers[a])||(this._keyHandlers[a]=[]);this._keyHandlers[a].push({shift:c||!1,ctrl:b||!1,handler:d})},onKeyPressed:function(){this.onDisplayChanged()},onClick:function(a){this.onDisplayChanged(a)},_onIEMouseDown:function(){this.focused||this.disabled||this.focus()},_onBlur:function(a){(t("ie")||t("trident"))&&this.defer(function(){F.curNode||this.ownerDocumentBody.focus()});this.inherited(arguments);var b=this.getValue(!0);if(b!==this.value)this.onChange(b);
this._set("value",b)},_onFocus:function(a){this.disabled||(this._disabledOK||this.set("disabled",!1),this.inherited(arguments))},blur:function(){!t("ie")&&this.window.document.documentElement&&this.window.document.documentElement.focus?this.window.document.documentElement.focus():this.ownerDocumentBody.focus&&this.ownerDocumentBody.focus()},focus:function(){this.isLoaded?9>t("ie")?this.iframe.fireEvent("onfocus",document.createEventObject()):this.editNode.focus():this.focusOnLoad=!0},updateInterval:200,
_updateTimer:null,onDisplayChanged:function(){this._updateTimer&&this._updateTimer.remove();this._updateTimer=this.defer("onNormalizedDisplayChanged",this.updateInterval)},onNormalizedDisplayChanged:function(){delete this._updateTimer},onChange:function(){},_normalizeCommand:function(a,b){a=a.toLowerCase();"formatblock"===a?t("safari")&&void 0===b&&(a="heading"):"hilitecolor"!==a||t("mozilla")||(a="backcolor");return a},_qcaCache:{},queryCommandAvailable:function(a){var b=this._qcaCache[a];return void 0!==
b?b:this._qcaCache[a]=this._queryCommandAvailable(a)},_queryCommandAvailable:function(a){switch(a.toLowerCase()){case "bold":case "italic":case "underline":case "subscript":case "superscript":case "fontname":case "fontsize":case "forecolor":case "hilitecolor":case "justifycenter":case "justifyfull":case "justifyleft":case "justifyright":case "delete":case "selectall":case "toggledir":case "createlink":case "unlink":case "removeformat":case "inserthorizontalrule":case "insertimage":case "insertorderedlist":case "insertunorderedlist":case "indent":case "outdent":case "formatblock":case "inserthtml":case "undo":case "redo":case "strikethrough":case "tabindent":case "cut":case "copy":case "paste":return!0;
case "blockdirltr":case "blockdirrtl":case "dirltr":case "dirrtl":case "inlinedirltr":case "inlinedirrtl":return t("ie")||t("trident")||t("edge");case "inserttable":case "insertcell":case "insertcol":case "insertrow":case "deletecells":case "deletecols":case "deleterows":case "mergecells":case "splitcell":return!t("webkit");default:return!1}},execCommand:function(a,b){var c;this.focused&&this.focus();a=this._normalizeCommand(a,b);if(void 0!==b){if("heading"===a)throw Error("unimplemented");"formatblock"===
a&&(t("ie")||t("trident"))&&(b="\x3c"+b+"\x3e")}var d="_"+a+"Impl";if(this[d])c=this[d](b);else if((b=1<arguments.length?b:null)||"createlink"!==a)c=this.document.execCommand(a,!1,b);this.onDisplayChanged();return c},queryCommandEnabled:function(a){if(this.disabled||!this._disabledOK)return!1;a=this._normalizeCommand(a);var b="_"+a+"EnabledImpl";return this[b]?this[b](a):this._browserQueryCommandEnabled(a)},queryCommandState:function(a){if(this.disabled||!this._disabledOK)return!1;a=this._normalizeCommand(a);
try{return this.document.queryCommandState(a)}catch(J){return!1}},queryCommandValue:function(a){if(this.disabled||!this._disabledOK)return!1;a=this._normalizeCommand(a);if(t("ie")&&"formatblock"===a)a=this._native2LocalFormatNames[this.document.queryCommandValue(a)];else if(t("mozilla")&&"hilitecolor"===a){var b;try{b=this.document.queryCommandValue("styleWithCSS")}catch(P){b=!1}this.document.execCommand("styleWithCSS",!1,!0);a=this.document.queryCommandValue(a);this.document.execCommand("styleWithCSS",
!1,b)}else a=this.document.queryCommandValue(a);return a},_sCall:function(a,b){return this.selection[a].apply(this.selection,b)},placeCursorAtStart:function(){this.focus();var a=!1;if(t("mozilla"))for(var b=this.editNode.firstChild;b;){if(3===b.nodeType){if(0<b.nodeValue.replace(/^\s+|\s+$/g,"").length){a=!0;this.selection.selectElement(b);break}}else if(1===b.nodeType){var a=!0,c=b.tagName?b.tagName.toLowerCase():"";/br|input|img|base|meta|area|basefont|hr|link/.test(c)?this.selection.selectElement(b):
this.selection.selectElementChildren(b);break}b=b.nextSibling}else a=!0,this.selection.selectElementChildren(this.editNode);a&&this.selection.collapse(!0)},placeCursorAtEnd:function(){this.focus();var a=!1;if(t("mozilla"))for(var b=this.editNode.lastChild;b;){if(3===b.nodeType){if(0<b.nodeValue.replace(/^\s+|\s+$/g,"").length){a=!0;this.selection.selectElement(b);break}}else if(1===b.nodeType){a=!0;this.selection.selectElement(b.lastChild||b);break}b=b.previousSibling}else a=!0,this.selection.selectElementChildren(this.editNode);
a&&this.selection.collapse(!1)},getValue:function(a){return!this.textarea||!this.isClosed&&this.isLoaded?this.isLoaded?this._postFilterContent(null,a):this.value:this.textarea.value},_getValueAttr:function(){return this.getValue(!0)},setValue:function(a){if(this.isLoaded){if(!this.textarea||!this.isClosed&&this.isLoaded){a=this._preFilterContent(a);var b=this.isClosed?this.domNode:this.editNode;b.innerHTML=a;this._preDomFilterContent(b)}else this.textarea.value=a;this.onDisplayChanged();this._set("value",
this.getValue(!0))}else this.onLoadDeferred.then(g.hitch(this,function(){this.setValue(a)}))},replaceValue:function(a){this.isClosed?this.setValue(a):this.window&&this.window.getSelection&&!t("mozilla")?this.setValue(a):this.window&&this.window.getSelection?(a=this._preFilterContent(a),this.execCommand("selectall"),this.execCommand("inserthtml",a),this._preDomFilterContent(this.editNode)):this.document&&this.document.selection&&this.setValue(a);this._set("value",this.getValue(!0))},_preFilterContent:function(a){var b=
a;k.forEach(this.contentPreFilters,function(a){a&&(b=a(b))});return b},_preDomFilterContent:function(a){a=a||this.editNode;k.forEach(this.contentDomPreFilters,function(b){b&&g.isFunction(b)&&b(a)},this)},_postFilterContent:function(a,b){var c;g.isString(a)?c=a:(a=a||this.editNode,this.contentDomPostFilters.length&&(b&&(a=g.clone(a)),k.forEach(this.contentDomPostFilters,function(b){a=b(a)})),c=D.getChildrenHtml(a));g.trim(c.replace(/^\xA0\xA0*/,"").replace(/\xA0\xA0*$/,"")).length||(c="");k.forEach(this.contentPostFilters,
function(a){c=a(c)});return c},_saveContent:function(){var a=n.byId(I._scopeName+"._editor.RichText.value");a&&(a.value&&(a.value+=this._SEPARATOR),a.value+=this.name+this._NAME_CONTENT_SEP+this.getValue(!0))},escapeXml:function(a,b){a=a.replace(/&/gm,"\x26amp;").replace(/</gm,"\x26lt;").replace(/>/gm,"\x26gt;").replace(/"/gm,"\x26quot;");b||(a=a.replace(/'/gm,"\x26#39;"));return a},getNodeHtml:function(b){a.deprecated("dijit.Editor::getNodeHtml is deprecated","use dijit/_editor/html::getNodeHtml instead",
2);return D.getNodeHtml(b)},getNodeChildrenHtml:function(b){a.deprecated("dijit.Editor::getNodeChildrenHtml is deprecated","use dijit/_editor/html::getChildrenHtml instead",2);return D.getChildrenHtml(b)},close:function(a){if(!this.isClosed){arguments.length||(a=!0);a&&this._set("value",this.getValue(!0));this.interval&&clearInterval(this.interval);this._webkitListener&&(this._webkitListener.remove(),delete this._webkitListener);t("ie")&&(this.iframe.onfocus=null);this.iframe._loadFunc=null;this._iframeRegHandle&&
(this._iframeRegHandle.remove(),delete this._iframeRegHandle);if(this.textarea){var b=this.textarea.style;b.position="";b.left=b.top="";t("ie")&&(b.overflow=this.__overflow,this.__overflow=null);this.textarea.value=this.value;f.destroy(this.domNode);this.domNode=this.textarea}else this.domNode.innerHTML=this.value;delete this.iframe;h.remove(this.domNode,this.baseClass);this.isClosed=!0;this.isLoaded=!1;delete this.editNode;delete this.focusNode;this.window&&this.window._frameElement&&(this.window._frameElement=
null);this.editorObject=this.editingArea=this.document=this.window=null}},destroy:function(){this.isClosed||this.close(!1);this._updateTimer&&this._updateTimer.remove();this.inherited(arguments);M._globalSaveHandler&&delete M._globalSaveHandler[this.id]},_removeMozBogus:function(a){return a.replace(/\stype="_moz"/gi,"").replace(/\s_moz_dirty=""/gi,"").replace(/_moz_resizing="(true|false)"/gi,"")},_removeWebkitBogus:function(a){a=a.replace(/\sclass="webkit-block-placeholder"/gi,"");a=a.replace(/\sclass="apple-style-span"/gi,
"");return a=a.replace(/<meta charset=\"utf-8\" \/>/gi,"")},_normalizeFontStyle:function(a){return a.replace(/<(\/)?strong([ \>])/gi,"\x3c$1b$2").replace(/<(\/)?em([ \>])/gi,"\x3c$1i$2")},_preFixUrlAttributes:function(a){return a.replace(/(?:(<a(?=\s).*?\shref=)("|')(.*?)\2)|(?:(<a\s.*?href=)([^"'][^ >]+))/gi,"$1$4$2$3$5$2 _djrealurl\x3d$2$3$5$2").replace(/(?:(<img(?=\s).*?\ssrc=)("|')(.*?)\2)|(?:(<img\s.*?src=)([^"'][^ >]+))/gi,"$1$4$2$3$5$2 _djrealurl\x3d$2$3$5$2")},_browserQueryCommandEnabled:function(a){if(!a)return!1;
if(t("ie")||t("trident")||t("edge"))return this.focused&&!this.disabled;var b=9>t("ie")?this.document.selection.createRange():this.document;try{return b.queryCommandEnabled(a)}catch(P){return!1}},_createlinkEnabledImpl:function(){var a=!0;return a=t("opera")?this.window.getSelection().isCollapsed?!0:this.document.queryCommandEnabled("createlink"):this._browserQueryCommandEnabled("createlink")},_unlinkEnabledImpl:function(){var a=!0;return a=t("mozilla")||t("webkit")||t("ie")||t("trident")||t("edge")?
this.selection.hasAncestorElement("a"):this._browserQueryCommandEnabled("unlink")},_inserttableEnabledImpl:function(){var a=!0;return a=t("mozilla")||t("webkit")?!0:this._browserQueryCommandEnabled("inserttable")},_cutEnabledImpl:function(){var a=!0;t("webkit")?((a=this.window.getSelection())&&(a=a.toString()),a=!!a):a=this._browserQueryCommandEnabled("cut");return a},_copyEnabledImpl:function(){var a=!0;t("webkit")?((a=this.window.getSelection())&&(a=a.toString()),a=!!a):a=this._browserQueryCommandEnabled("copy");
return a},_pasteEnabledImpl:function(){var a=!0;return t("webkit")?!0:a=this._browserQueryCommandEnabled("paste")},_inserthorizontalruleImpl:function(a){return t("ie")?this._inserthtmlImpl("\x3chr\x3e"):this.document.execCommand("inserthorizontalrule",!1,a)},_unlinkImpl:function(a){return this.queryCommandEnabled("unlink")&&(t("mozilla")||t("webkit"))?(a=this.selection.getAncestorElement("a"),this.selection.selectElement(a),this.document.execCommand("unlink",!1,null)):this.document.execCommand("unlink",
!1,a)},_hilitecolorImpl:function(a){var b;this._handleTextColorOrProperties("hilitecolor",a)||(t("mozilla")?(this.document.execCommand("styleWithCSS",!1,!0),console.log("Executing color command."),b=this.document.execCommand("hilitecolor",!1,a),this.document.execCommand("styleWithCSS",!1,!1)):b=this.document.execCommand("hilitecolor",!1,a));return b},_backcolorImpl:function(a){t("ie")&&(a=a?a:null);var b=this._handleTextColorOrProperties("backcolor",a);b||(b=this.document.execCommand("backcolor",
!1,a));return b},_forecolorImpl:function(a){t("ie")&&(a=a?a:null);var b=!1;(b=this._handleTextColorOrProperties("forecolor",a))||(b=this.document.execCommand("forecolor",!1,a));return b},_inserthtmlImpl:function(a){a=this._preFilterContent(a);var b=!0;if(9>t("ie")){var c=this.document.selection.createRange();if("CONTROL"===this.document.selection.type.toUpperCase()){for(var d=c.item(0);c.length;)c.remove(c.item(0));d.outerHTML=a}else c.pasteHTML(a);c.select()}else if(8>t("trident")){var g=E.getSelection(this.window);
if(g&&g.rangeCount&&g.getRangeAt){c=g.getRangeAt(0);c.deleteContents();var e=f.create("div");e.innerHTML=a;for(var m,d=this.document.createDocumentFragment();a=e.firstChild;)m=d.appendChild(a);c.insertNode(d);m&&(c=c.cloneRange(),c.setStartAfter(m),c.collapse(!1),g.removeAllRanges(),g.addRange(c))}}else t("mozilla")&&!a.length?this.selection.remove():b=this.document.execCommand("inserthtml",!1,a);return b},_boldImpl:function(a){var b=!1;if(t("ie")||t("trident"))this._adaptIESelection(),b=this._adaptIEFormatAreaAndExec("bold");
b||(b=this.document.execCommand("bold",!1,a));return b},_italicImpl:function(a){var b=!1;if(t("ie")||t("trident"))this._adaptIESelection(),b=this._adaptIEFormatAreaAndExec("italic");b||(b=this.document.execCommand("italic",!1,a));return b},_underlineImpl:function(a){var b=!1;if(t("ie")||t("trident"))this._adaptIESelection(),b=this._adaptIEFormatAreaAndExec("underline");b||(b=this.document.execCommand("underline",!1,a));return b},_strikethroughImpl:function(a){var b=!1;if(t("ie")||t("trident"))this._adaptIESelection(),
b=this._adaptIEFormatAreaAndExec("strikethrough");b||(b=this.document.execCommand("strikethrough",!1,a));return b},_superscriptImpl:function(a){var b=!1;if(t("ie")||t("trident"))this._adaptIESelection(),b=this._adaptIEFormatAreaAndExec("superscript");b||(b=this.document.execCommand("superscript",!1,a));return b},_subscriptImpl:function(a){var b=!1;if(t("ie")||t("trident"))this._adaptIESelection(),b=this._adaptIEFormatAreaAndExec("subscript");b||(b=this.document.execCommand("subscript",!1,a));return b},
_fontnameImpl:function(a){var b;if(t("ie")||t("trident"))b=this._handleTextColorOrProperties("fontname",a);b||(b=this.document.execCommand("fontname",!1,a));return b},_fontsizeImpl:function(a){var b;if(t("ie")||t("trident"))b=this._handleTextColorOrProperties("fontsize",a);b||(b=this.document.execCommand("fontsize",!1,a));return b},_insertorderedlistImpl:function(a){var b=!1;if(t("ie")||t("trident")||t("edge"))b=this._adaptIEList("insertorderedlist",a);b||(b=this.document.execCommand("insertorderedlist",
!1,a));return b},_insertunorderedlistImpl:function(a){var b=!1;if(t("ie")||t("trident")||t("edge"))b=this._adaptIEList("insertunorderedlist",a);b||(b=this.document.execCommand("insertunorderedlist",!1,a));return b},getHeaderHeight:function(){return this._getNodeChildrenHeight(this.header)},getFooterHeight:function(){return this._getNodeChildrenHeight(this.footer)},_getNodeChildrenHeight:function(a){var b=0;if(a&&a.childNodes){var c;for(c=0;c<a.childNodes.length;c++)var g=d.position(a.childNodes[c]),
b=b+g.h}return b},_isNodeEmpty:function(a,b){return 1===a.nodeType?0<a.childNodes.length?this._isNodeEmpty(a.childNodes[0],b):!0:3===a.nodeType?""===a.nodeValue.substring(b):!1},_removeStartingRangeFromRange:function(a,b){if(a.nextSibling)b.setStart(a.nextSibling,0);else{for(a=a.parentNode;a&&null==a.nextSibling;)a=a.parentNode;a&&b.setStart(a.nextSibling,0)}return b},_adaptIESelection:function(){var a=E.getSelection(this.window);if(a&&a.rangeCount&&!a.isCollapsed){for(var b=a.getRangeAt(0),c=b.startContainer,
d=b.startOffset;3===c.nodeType&&d>=c.length&&c.nextSibling;)d-=c.length,c=c.nextSibling;for(var g=null;this._isNodeEmpty(c,d)&&c!==g;)g=c,b=this._removeStartingRangeFromRange(c,b),c=b.startContainer,d=0;a.removeAllRanges();a.addRange(b)}},_adaptIEFormatAreaAndExec:function(a){var b=E.getSelection(this.window),c=this.document,d,g,e,m,h,l,n;if(a&&b&&b.isCollapsed){if(this.queryCommandValue(a)){a=this._tagNamesForCommand(a);e=b.getRangeAt(0);m=e.startContainer;3===m.nodeType&&(g=e.endOffset,m.length<
g&&(g=this._adjustNodeAndOffset(d,g),m=g.node,g=g.offset));for(;m&&m!==this.editNode;){d=m.tagName?m.tagName.toLowerCase():"";if(-1<k.indexOf(a,d)){n=m;break}m=m.parentNode}if(n&&(d=e.startContainer,a=c.createElement(n.tagName),f.place(a,n,"after"),d&&3===d.nodeType)){g=e.endOffset;d.length<g&&(g=this._adjustNodeAndOffset(d,g),d=g.node,g=g.offset);m=d.nodeValue;e=c.createTextNode(m.substring(0,g));var r=m.substring(g,m.length);r&&(h=c.createTextNode(r));f.place(e,d,"before");h&&(l=c.createElement("span"),
l.className="ieFormatBreakerSpan",f.place(l,d,"after"),f.place(h,l,"after"),h=l);f.destroy(d);g=e.parentNode;for(d=[];g!==n;){m=g.tagName;e={tagName:m};d.push(e);m=c.createElement(m);g.style&&m.style&&g.style.cssText&&(m.style.cssText=g.style.cssText,e.cssText=g.style.cssText);"FONT"===g.tagName&&(g.color&&(m.color=g.color,e.color=g.color),g.face&&(m.face=g.face,e.face=g.face),g.size&&(m.size=g.size,e.size=g.size));g.className&&(m.className=g.className,e.className=g.className);if(h)for(;h;)e=h.nextSibling,
m.appendChild(h),h=e;m.tagName==g.tagName?(l=c.createElement("span"),l.className="ieFormatBreakerSpan",f.place(l,g,"after"),f.place(m,l,"after")):f.place(m,g,"after");e=g;h=m;g=g.parentNode}if(h){if(1===h.nodeType||3===h.nodeType&&h.nodeValue)a.innerHTML="";for(;h;)e=h.nextSibling,a.appendChild(h),h=e}if(d.length){e=d.pop();h=c.createElement(e.tagName);e.cssText&&h.style&&(h.style.cssText=e.cssText);e.className&&(h.className=e.className);"FONT"===e.tagName&&(e.color&&(h.color=e.color),e.face&&(h.face=
e.face),e.size&&(h.size=e.size));for(f.place(h,a,"before");d.length;)e=d.pop(),n=c.createElement(e.tagName),e.cssText&&n.style&&(n.style.cssText=e.cssText),e.className&&(n.className=e.className),"FONT"===e.tagName&&(e.color&&(n.color=e.color),e.face&&(n.face=e.face),e.size&&(n.size=e.size)),h.appendChild(n),h=n;n=c.createTextNode(".");l.appendChild(n);h.appendChild(n)}else l=c.createElement("span"),l.className="ieFormatBreakerSpan",n=c.createTextNode("."),l.appendChild(n),f.place(l,a,"before");h=
E.create(this.window);h.setStart(n,0);h.setEnd(n,n.length);b.removeAllRanges();b.addRange(h);this.selection.collapse(!1);n.parentNode.innerHTML="";a.firstChild||f.destroy(a);return!0}return!1}e=b.getRangeAt(0);if((d=e.startContainer)&&3===d.nodeType)return g=e.startOffset,d.length<g&&(g=this._adjustNodeAndOffset(d,g),d=g.node,g=g.offset),m=d.nodeValue,e=c.createTextNode(m.substring(0,g)),r=m.substring(g),""!==r&&(h=c.createTextNode(m.substring(g))),l=c.createElement("span"),n=c.createTextNode("."),
l.appendChild(n),e.length?f.place(e,d,"after"):e=d,f.place(l,e,"after"),h&&f.place(h,l,"after"),f.destroy(d),h=E.create(this.window),h.setStart(n,0),h.setEnd(n,n.length),b.removeAllRanges(),b.addRange(h),c.execCommand(a),f.place(l.firstChild,l,"before"),f.destroy(l),h.setStart(n,0),h.setEnd(n,n.length),b.removeAllRanges(),b.addRange(h),this.selection.collapse(!1),n.parentNode.innerHTML="",!0}else return!1},_adaptIEList:function(a){var b=E.getSelection(this.window);if(b.isCollapsed&&b.rangeCount&&
!this.queryCommandValue(a)){var c=b.getRangeAt(0),d=c.startContainer;if(d&&3==d.nodeType&&!c.startOffset)return c="ul","insertorderedlist"===a&&(c="ol"),a=this.document.createElement(c),c=f.create("li",null,a),f.place(a,d,"before"),c.appendChild(d),f.create("br",null,a,"after"),a=E.create(this.window),a.setStart(d,0),a.setEnd(d,d.length),b.removeAllRanges(),b.addRange(a),this.selection.collapse(!0),!0}return!1},_handleTextColorOrProperties:function(a,b){var d=E.getSelection(this.window),g=this.document,
e,m,h,l,k;b=b||null;if(a&&d&&d.isCollapsed&&d.rangeCount&&(m=d.getRangeAt(0),(e=m.startContainer)&&3===e.nodeType)){k=m.startOffset;e.length<k&&(m=this._adjustNodeAndOffset(e,k),e=m.node,k=m.offset);h=e.nodeValue;m=g.createTextNode(h.substring(0,k));""!==h.substring(k)&&(l=g.createTextNode(h.substring(k)));h=g.createElement("span");k=g.createTextNode(".");h.appendChild(k);g=g.createElement("span");h.appendChild(g);m.length?f.place(m,e,"after"):m=e;f.place(h,m,"after");l&&f.place(l,h,"after");f.destroy(e);
e=E.create(this.window);e.setStart(k,0);e.setEnd(k,k.length);d.removeAllRanges();d.addRange(e);if(t("webkit")){d="color";if("hilitecolor"===a||"backcolor"===a)d="backgroundColor";c.set(h,d,b);this.selection.remove();f.destroy(g);h.innerHTML="\x26#160;";this.selection.selectElement(h);this.focus()}else this.execCommand(a,b),f.place(h.firstChild,h,"before"),f.destroy(h),e.setStart(k,0),e.setEnd(k,k.length),d.removeAllRanges(),d.addRange(e),this.selection.collapse(!1),k.parentNode.removeChild(k);return!0}return!1},
_adjustNodeAndOffset:function(a,b){for(;a.length<b&&a.nextSibling&&3===a.nextSibling.nodeType;)b-=a.length,a=a.nextSibling;return{node:a,offset:b}},_tagNamesForCommand:function(a){return"bold"===a?["b","strong"]:"italic"===a?["i","em"]:"strikethrough"===a?["s","strike"]:"superscript"===a?["sup"]:"subscript"===a?["sub"]:"underline"===a?["u"]:[]},_stripBreakerNodes:function(a){if(this.isLoaded)return m(".ieFormatBreakerSpan",a).forEach(function(a){for(;a.firstChild;)f.place(a.firstChild,a,"before");
f.destroy(a)}),a},_stripTrailingEmptyNodes:function(a){function b(a){return/^(p|div|br)$/i.test(a.nodeName)&&0==a.children.length&&/^[\s\xA0]*$/.test(a.textContent||a.innerText||"")||3===a.nodeType&&/^[\s\xA0]*$/.test(a.nodeValue)}for(;a.lastChild&&b(a.lastChild);)f.destroy(a.lastChild);return a},_setTextDirAttr:function(a){this._set("textDir",a);this.onLoadDeferred.then(g.hitch(this,function(){this.editNode.dir=a}))}});return M})},"dijit/selection":function(){define("dojo/_base/array dojo/dom dojo/_base/lang dojo/sniff dojo/_base/window dijit/focus".split(" "),
function(k,e,p,q,n,l){var h=function(d){var c=d.document;this.getType=function(){if(c.getSelection){var a="text",b;try{b=d.getSelection()}catch(g){}b&&1==b.rangeCount&&(b=b.getRangeAt(0),b.startContainer==b.endContainer&&1==b.endOffset-b.startOffset&&3!=b.startContainer.nodeType&&(a="control"));return a}return c.selection.type.toLowerCase()};this.getSelectedText=function(){if(c.getSelection){var a=d.getSelection();return a?a.toString():""}return"control"==this.getType()?null:c.selection.createRange().text};
this.getSelectedHtml=function(){if(c.getSelection){var a=d.getSelection();if(a&&a.rangeCount){var b,g="";for(b=0;b<a.rangeCount;b++){var f=a.getRangeAt(b).cloneContents(),e=c.createElement("div");e.appendChild(f);g+=e.innerHTML}return g}return null}return"control"==this.getType()?null:c.selection.createRange().htmlText};this.getSelectedElement=function(){if("control"==this.getType()){if(c.getSelection){var a=d.getSelection();return a.anchorNode.childNodes[a.anchorOffset]}if((a=c.selection.createRange())&&
a.item)return c.selection.createRange().item(0)}return null};this.getParentElement=function(){if("control"==this.getType()){var a=this.getSelectedElement();if(a)return a.parentNode}else if(c.getSelection){if(a=c.getSelection()){for(a=a.anchorNode;a&&1!=a.nodeType;)a=a.parentNode;return a}}else return a=c.selection.createRange(),a.collapse(!0),a.parentElement();return null};this.hasAncestorElement=function(a){return null!=this.getAncestorElement.apply(this,arguments)};this.getAncestorElement=function(a){var b=
this.getSelectedElement()||this.getParentElement();return this.getParentOfType(b,arguments)};this.isTag=function(a,b){if(a&&a.tagName){a=a.tagName.toLowerCase();for(var c=0;c<b.length;c++){var d=String(b[c]).toLowerCase();if(a==d)return d}}return""};this.getParentOfType=function(a,b){for(;a;){if(this.isTag(a,b).length)return a;a=a.parentNode}return null};this.collapse=function(a){if(c.getSelection){var b=d.getSelection();b.removeAllRanges?a?b.collapseToStart():b.collapseToEnd():b.collapse(a)}else b=
c.selection.createRange(),b.collapse(a),b.select()};this.remove=function(){var a=c.selection;c.getSelection?(a=d.getSelection(),a.deleteFromDocument()):"none"!=a.type.toLowerCase()&&a.clear();return a};this.selectElementChildren=function(a,b){var g;a=e.byId(a);if(c.getSelection)b=d.getSelection(),q("opera")?(g=b.rangeCount?b.getRangeAt(0):c.createRange(),g.setStart(a,0),g.setEnd(a,3==a.nodeType?a.length:a.childNodes.length),b.addRange(g)):b.selectAllChildren(a);else if(g=a.ownerDocument.body.createTextRange(),
g.moveToElementText(a),!b)try{g.select()}catch(u){}};this.selectElement=function(a,b){var d;a=e.byId(a);if(c.getSelection)b=c.getSelection(),d=c.createRange(),b.removeAllRanges&&(q("opera")&&b.getRangeAt(0)&&(d=b.getRangeAt(0)),d.selectNode(a),b.removeAllRanges(),b.addRange(d));else try{var f=a.tagName?a.tagName.toLowerCase():"";d="img"===f||"table"===f?n.body(c).createControlRange():n.body(c).createRange();d.addElement(a);b||d.select()}catch(m){this.selectElementChildren(a,b)}};this.inSelection=
function(a){if(a){var b,g;if(c.getSelection){var f=d.getSelection();f&&0<f.rangeCount&&(g=f.getRangeAt(0));if(g&&g.compareBoundaryPoints&&c.createRange)try{if(b=c.createRange(),b.setStart(a,0),1===g.compareBoundaryPoints(g.START_TO_END,b))return!0}catch(m){}}else{g=c.selection.createRange();try{b=a.ownerDocument.body.createTextRange(),b.moveToElementText(a)}catch(m){}if(g&&b&&1===g.compareEndPoints("EndToStart",b))return!0}}return!1};this.getBookmark=function(){var a,b,g=c.selection,f=l.curNode;if(c.getSelection){if(g=
d.getSelection())if(g.isCollapsed){if(a=f?f.tagName:"")if(a=a.toLowerCase(),"textarea"==a||"input"==a&&(!f.type||"text"==f.type.toLowerCase()))return g={start:f.selectionStart,end:f.selectionEnd,node:f,pRange:!0},{isCollapsed:g.end<=g.start,mark:g};a={isCollapsed:!0};g.rangeCount&&(a.mark=g.getRangeAt(0).cloneRange())}else b=g.getRangeAt(0),a={isCollapsed:!1,mark:b.cloneRange()}}else if(g){a=f?f.tagName:"";a=a.toLowerCase();if(f&&a&&("button"==a||"textarea"==a||"input"==a)){if(g.type&&"none"==g.type.toLowerCase())return{isCollapsed:!0,
mark:null};b=g.createRange();return{isCollapsed:b.text&&b.text.length?!1:!0,mark:{range:b,pRange:!0}}}a={};try{b=g.createRange(),a.isCollapsed=!("Text"==g.type?b.htmlText.length:b.length)}catch(m){return a.isCollapsed=!0,a}if("CONTROL"==g.type.toUpperCase())if(b.length)for(a.mark=[],g=0,f=b.length;g<f;)a.mark.push(b.item(g++));else a.isCollapsed=!0,a.mark=null;else a.mark=b.getBookmark()}else console.warn("No idea how to store the current selection for this browser!");return a};this.moveToBookmark=
function(a){if(a=a.mark)if(c.getSelection){var b=d.getSelection();b&&b.removeAllRanges?a.pRange?(b=a.node,b.selectionStart=a.start,b.selectionEnd=a.end):(b.removeAllRanges(),b.addRange(a)):console.warn("No idea how to restore selection for this browser!")}else if(c.selection&&a){var g;a.pRange?g=a.range:p.isArray(a)?(g=c.body.createControlRange(),k.forEach(a,function(a){g.addElement(a)})):(g=c.body.createTextRange(),g.moveToBookmark(a));g.select()}};this.isCollapsed=function(){return this.getBookmark().isCollapsed}},
f=new h(window);f.SelectionManager=h;return f})},"dijit/_editor/range":function(){define(["dojo/_base/array","dojo/_base/declare","dojo/_base/lang"],function(k,e,p){var q={getIndex:function(e,f){for(var d=[],c=[],a=e,b,g;e!=f;){var h=0;for(b=e.parentNode;g=b.childNodes[h++];)if(g===e){--h;break}d.unshift(h);c.unshift(h-b.childNodes.length);e=b}if(0<d.length&&3==a.nodeType){for(g=a.previousSibling;g&&3==g.nodeType;)d[d.length-1]--,g=g.previousSibling;for(g=a.nextSibling;g&&3==g.nodeType;)c[c.length-
1]++,g=g.nextSibling}return{o:d,r:c}},getNode:function(e,f){if(!p.isArray(e)||0==e.length)return f;var d=f;k.every(e,function(c){if(0<=c&&c<d.childNodes.length)d=d.childNodes[c];else return d=null,!1;return!0});return d},getCommonAncestor:function(e,f,d){d=d||e.ownerDocument.body;var c=function(a){for(var b=[];a;)if(b.unshift(a),a!==d)a=a.parentNode;else break;return b};e=c(e);f=c(f);for(var c=Math.min(e.length,f.length),a=e[0],b=1;b<c;b++)if(e[b]===f[b])a=e[b];else break;return a},getAncestor:function(e,
f,d){for(d=d||e.ownerDocument.body;e&&e!==d;){var c=e.nodeName.toUpperCase();if(f.test(c))return e;e=e.parentNode}return null},BlockTagNames:/^(?:P|DIV|H1|H2|H3|H4|H5|H6|ADDRESS|PRE|OL|UL|LI|DT|DE)$/,getBlockAncestor:function(e,f,d){d=d||e.ownerDocument.body;f=f||q.BlockTagNames;for(var c=null,a;e&&e!==d;){var b=e.nodeName.toUpperCase();!c&&f.test(b)&&(c=e);!a&&/^(?:BODY|TD|TH|CAPTION)$/.test(b)&&(a=e);e=e.parentNode}return{blockNode:c,blockContainer:a||e.ownerDocument.body}},atBeginningOfContainer:function(e,
f,d){var c=!1,a=0==d;a||3!=f.nodeType||/^[\s\xA0]+$/.test(f.nodeValue.substr(0,d))&&(a=!0);if(a)for(c=!0;f&&f!==e;){if(f.previousSibling){c=!1;break}f=f.parentNode}return c},atEndOfContainer:function(e,f,d){var c=!1,a=d==(f.length||f.childNodes.length);a||3!=f.nodeType||/^[\s\xA0]+$/.test(f.nodeValue.substr(d))&&(a=!0);if(a)for(c=!0;f&&f!==e;){if(f.nextSibling){c=!1;break}f=f.parentNode}return c},adjacentNoneTextNode:function(e,f){var d=e;e=0-e.length||0;for(f=f?"nextSibling":"previousSibling";d&&
3==d.nodeType;)e+=d.length,d=d[f];return[d,e]},create:function(e){e=e||window;return e.getSelection?e.document.createRange():new l},getSelection:function(e,f){if(e.getSelection)return e.getSelection();e=new n.selection(e);f||e._getCurrentSelection();return e}};if(!window.getSelection)var n=q.ie={cachedSelection:{},selection:function(e){this._ranges=[];this.addRange=function(f,d){this._ranges.push(f);d||f._select();this.rangeCount=this._ranges.length};this.removeAllRanges=function(){this._ranges=[];
this.rangeCount=0};this.getRangeAt=function(f){return this._ranges[f]};this._getCurrentSelection=function(){this.removeAllRanges();var f;f=e.document.selection.createRange();f="CONTROL"==e.document.selection.type.toUpperCase()?new l(n.decomposeControlRange(f)):new l(n.decomposeTextRange(f));this.addRange(f,!0),this.isCollapsed=f.collapsed}},decomposeControlRange:function(e){var f=e.item(0),d=e.item(e.length-1);e=f.parentNode;var c=d.parentNode,f=q.getIndex(f,e).o[0],d=q.getIndex(d,c).o[0]+1;return[e,
f,c,d]},getEndPoint:function(e,f){var d=e.duplicate();d.collapse(!f);var c="EndTo"+(f?"End":"Start"),a=d.parentElement(),b,g,h;0<a.childNodes.length?k.every(a.childNodes,function(f,l){var m;if(3!=f.nodeType)if(d.moveToElementText(f),0<d.compareEndPoints(c,e))if(h&&3==h.nodeType)b=h,m=!0;else return b=a,g=l,!1;else{if(l==a.childNodes.length-1)return b=a,g=a.childNodes.length,!1}else l==a.childNodes.length-1&&(b=f,m=!0);if(m&&b)return b=(f=q.adjacentNoneTextNode(b)[0])?f.nextSibling:a.firstChild,l=
q.adjacentNoneTextNode(b),f=l[0],l=l[1],f?(d.moveToElementText(f),d.collapse(!1)):d.moveToElementText(a),d.setEndPoint(c,e),g=d.text.length-l,!1;h=f;return!0}):(b=a,g=0);f||1!=b.nodeType||g!=b.childNodes.length||(f=b.nextSibling)&&3==f.nodeType&&(b=f,g=0);return[b,g]},setEndPoint:function(e,f,d){e=e.duplicate();var c;if(3!=f.nodeType)if(0<d){if(c=f.childNodes[d-1])if(3==c.nodeType)f=c,d=c.length;else if(c.nextSibling&&3==c.nextSibling.nodeType)f=c.nextSibling,d=0;else{e.moveToElementText(c.nextSibling?
c:f);var a=c.parentNode;c=a.insertBefore(c.ownerDocument.createTextNode(" "),c.nextSibling);e.collapse(!1);a.removeChild(c)}}else e.moveToElementText(f),e.collapse(!0);3==f.nodeType&&(c=q.adjacentNoneTextNode(f),a=c[0],c=c[1],a?(e.moveToElementText(a),e.collapse(!1),"inherit"!=a.contentEditable&&c++):(e.moveToElementText(f.parentNode),e.collapse(!0),e.move("character",1),e.move("character",-1)),d+=c,0<d&&e.move("character",d)!=d&&console.error("Error when moving!"));return e},decomposeTextRange:function(e){var f=
n.getEndPoint(e),d=f[0],c=f[1],a=f[0],f=f[1];e.htmlText.length&&(e.htmlText==e.text?f=c+e.text.length:(f=n.getEndPoint(e,!0),a=f[0],f=f[1]));return[d,c,a,f]},setRange:function(e,f,d,c,a,b){f=n.setEndPoint(e,f,d);e.setEndPoint("StartToStart",f);if(!b)var g=n.setEndPoint(e,c,a);e.setEndPoint("EndToEnd",g||f);return e}},l=q.W3CRange=e(null,{constructor:function(){0<arguments.length?(this.setStart(arguments[0][0],arguments[0][1]),this.setEnd(arguments[0][2],arguments[0][3])):(this.startContainer=this.commonAncestorContainer=
null,this.startOffset=0,this.endContainer=null,this.endOffset=0,this.collapsed=!0)},_updateInternal:function(){this.commonAncestorContainer=this.startContainer!==this.endContainer?q.getCommonAncestor(this.startContainer,this.endContainer):this.startContainer;this.collapsed=this.startContainer===this.endContainer&&this.startOffset==this.endOffset},setStart:function(e,f){f=parseInt(f);if(this.startContainer!==e||this.startOffset!=f)delete this._cachedBookmark,this.startContainer=e,this.startOffset=
f,this.endContainer?this._updateInternal():this.setEnd(e,f)},setEnd:function(e,f){f=parseInt(f);if(this.endContainer!==e||this.endOffset!=f)delete this._cachedBookmark,this.endContainer=e,this.endOffset=f,this.startContainer?this._updateInternal():this.setStart(e,f)},setStartAfter:function(e,f){this._setPoint("setStart",e,f,1)},setStartBefore:function(e,f){this._setPoint("setStart",e,f,0)},setEndAfter:function(e,f){this._setPoint("setEnd",e,f,1)},setEndBefore:function(e,f){this._setPoint("setEnd",
e,f,0)},_setPoint:function(e,f,d,c){d=q.getIndex(f,f.parentNode).o;this[e](f.parentNode,d.pop()+c)},_getIERange:function(){var e=(this._body||this.endContainer.ownerDocument.body).createTextRange();n.setRange(e,this.startContainer,this.startOffset,this.endContainer,this.endOffset,this.collapsed);return e},getBookmark:function(){this._getIERange();return this._cachedBookmark},_select:function(){this._getIERange().select()},deleteContents:function(){var e=this.startContainer,f=this._getIERange();3!==
e.nodeType||this.startOffset||this.setStartBefore(e);f.pasteHTML("");this.endContainer=this.startContainer;this.endOffset=this.startOffset;this.collapsed=!0},cloneRange:function(){var e=new l([this.startContainer,this.startOffset,this.endContainer,this.endOffset]);e._body=this._body;return e},detach:function(){this.startContainer=this.commonAncestorContainer=this._body=null;this.startOffset=0;this.endContainer=null;this.endOffset=0;this.collapsed=!0}});p.setObject("dijit.range",q);return q})},"dijit/_editor/html":function(){define(["dojo/_base/array",
"dojo/_base/lang","dojo/sniff"],function(k,e,p){var q={};e.setObject("dijit._editor.html",q);var n=q.escapeXml=function(e,h){e=e.replace(/&/gm,"\x26amp;").replace(/</gm,"\x26lt;").replace(/>/gm,"\x26gt;").replace(/"/gm,"\x26quot;");h||(e=e.replace(/'/gm,"\x26#39;"));return e};q.getNodeHtml=function(e){var h=[];q.getNodeHtmlHelper(e,h);return h.join("")};q.getNodeHtmlHelper=function(e,h){switch(e.nodeType){case 1:var f=e.nodeName.toLowerCase();if(!f||"/"==f.charAt(0))return"";h.push("\x3c",f);var d=
[],c={},a;if(p("dom-attributes-explicit")||p("dom-attributes-specified-flag"))for(var b=0;a=e.attributes[b++];){var g=a.name;"_dj"===g.substr(0,3)||p("dom-attributes-specified-flag")&&!a.specified||g in c||(a=a.value,("src"==g||"href"==g)&&e.getAttribute("_djrealurl")&&(a=e.getAttribute("_djrealurl")),8===p("ie")&&"style"===g&&(a=a.replace("HEIGHT:","height:").replace("WIDTH:","width:")),d.push([g,a]),c[g]=a)}else{var l=(/^input$|^img$/i.test(e.nodeName)?e:e.cloneNode(!1)).outerHTML,c=l.match(/[\w-]+=("[^"]*"|'[^']*'|\S*)/gi),
l=l.substr(0,l.indexOf("\x3e"));k.forEach(c,function(a){if(a){var b=a.indexOf("\x3d");if(0<b&&(a=a.substring(0,b),"_dj"!=a.substr(0,3)))if("src"!=a&&"href"!=a||!e.getAttribute("_djrealurl")){var c;switch(a){case "style":c=e.style.cssText.toLowerCase();break;case "class":c=e.className;break;case "width":if("img"===f){(b=/width=(\S+)/i.exec(l))&&(c=b[1]);break}case "height":if("img"===f){(b=/height=(\S+)/i.exec(l))&&(c=b[1]);break}default:c=e.getAttribute(a)}null!=c&&d.push([a,c.toString()])}else d.push([a,
e.getAttribute("_djrealurl")])}},this)}d.sort(function(a,b){return a[0]<b[0]?-1:a[0]==b[0]?0:1});for(c=0;a=d[c++];)h.push(" ",a[0],'\x3d"',"string"===typeof a[1]?n(a[1],!0):a[1],'"');switch(f){case "br":case "hr":case "img":case "input":case "base":case "meta":case "area":case "basefont":h.push(" /\x3e");break;case "script":h.push("\x3e",e.innerHTML,"\x3c/",f,"\x3e");break;default:h.push("\x3e"),e.hasChildNodes()&&q.getChildrenHtmlHelper(e,h),h.push("\x3c/",f,"\x3e")}break;case 4:case 3:h.push(n(e.nodeValue,
!0));break;case 8:h.push("\x3c!--",n(e.nodeValue,!0),"--\x3e");break;default:h.push("\x3c!-- Element not recognized - Type: ",e.nodeType," Name: ",e.nodeName,"--\x3e")}};q.getChildrenHtml=function(e){var h=[];q.getChildrenHtmlHelper(e,h);return h.join("")};q.getChildrenHtmlHelper=function(e,h){if(e)for(var f=e.childNodes||e,d=!p("ie")||f!==e,c,a=0;c=f[a++];)d&&c.parentNode!=e||q.getNodeHtmlHelper(c,h)};return q})},"esri/dijit/ColorPicker":function(){define("../Color ../kernel ./_EventedWidget ./_Tooltip ./ColorPicker/colorUtil ./ColorPicker/HexPalette dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/_base/array dojo/_base/declare dojo/_base/lang dojo/dom-class dojo/dom-construct dojo/on dojo/query dojo/sniff dojo/dom-style dojo/i18n!../nls/jsapi dojo/text!./ColorPicker/templates/ColorPicker.html ./HorizontalSlider dijit/form/RadioButton dijit/form/TextBox dijit/form/ToggleButton dojo/NodeList-dom".split(" "),
function(k,e,p,q,n,l,h,f,d,c,a,b,g,u,m,r,t,v,y){e=c([p,h,f,q],{baseClass:"esriColorPicker",css:{container:"esriContainer",collapsed:"esriCollapsed",collapsible:"esriCollapsible",collapseIcon:"esriCollapseIcon",colorControls:"esriColorControls",header:"esriHeader",footer:"esriFooter",middle:"esriMiddle",swatch:"esriSwatch",swatchRow:"esriSwatchRow",swatchEmpty:"esriSwatchEmpty",swatchPreview:"esriSwatchPreview",swatchTransparencyBackground:"esriSwatchTransparencyBackground",palette:"esriPalette",paletteOptions:"esriPaletteOptions",
paletteToggle:"esriPaletteToggle",label:"esriLabel",hexInput:"esriHexInput",recent:"esriRecent",suggested:"esriSuggested",selected:"esriSelected",disabled:"esriDisabled",section:"esriSection",displayNone:"esriDisplayNone",transparencySlider:"esriTransparencySlider",alt:"esriAlt",downArrowIcon:"esri-icon-down"},declaredClass:"esri.dijit.ColorPicker",labels:v.widgets.colorPicker,templateString:y,constructor:function(a,b){a=a||{};this._colorInstance=new k;this._brightsPalette=new l({colors:a.palette});
this._pastelsPalette=new l({colors:this._toPastels(this._brightsPalette.get("colors"))});this._activePalette=this._brightsPalette;this._swatchCreator=a.swatchCreator||this._createSwatch;this._swatches={}},buildRendering:function(){this.inherited(arguments);this._createPalettes();this._noColorSwatchNode=g.create("div",{className:this.css.swatch+" "+this.css.swatchEmpty},this.dap_hexInput.domNode,"after")},postCreate:function(){this.inherited(arguments);this._addListeners();this._selectColor();this.dap_hexInput.intermediateChanges=
!0;this.dap_transparencySlider.intermediateChanges=!0;this.createTooltips([{node:this.dap_paletteContainer,label:this.labels.paletteTooltip},{node:this.dap_hexInput,label:this.labels.hexInputTooltip},{node:this._noColorSwatchNode,label:this.labels.noColorTooltip},{node:this.dap_paletteToggle,label:this.labels.moreColorsTooltip}])},_activePalette:null,_autoCollapseHandle:null,_brightsPalette:null,_colorInstance:null,_noColorSwatchNode:null,_pastelsPalette:null,_previousColor:null,_swatchCreator:null,
_swatches:null,_transparencyLabels:function(){return"["+[0,50,100].map(function(b){return a.replace(v.widgets.colorPicker.percent,{percent:b})}).map(function(a){return"'"+a+"'"})+"]"}(),collapsed:!1,_setCollapsedAttr:function(a){this.collapsible&&(b.toggle(this.domNode,this.css.collapsed,a),this._set("collapsed",a))},collapsible:!1,_setCollapsibleAttr:function(a){b.toggle(this.domNode,this.css.collapsible,a);if(a){if(!this._autoCollapseHandle){var c=u.pausable(this.ownerDocument,"click",function(a){a=
this.domNode.contains(a.target);this.collapsed||a||this.set("collapsed",!0)}.bind(this));this._autoCollapseHandle=c;this.own(c)}this._autoCollapseHandle.resume()}else this._autoCollapseHandle&&this._autoCollapseHandle.pause();this._set("collapsible",a)},color:null,_getColorAttr:function(){return"no-color"===this.color?"no-color":new k(this.color)},_setColorAttr:function(a,c){a=a||"no-color";c=c||void 0===c;if(!this.required){if("no-color"===a){this._set("color","no-color");this._previousColor="no-color";
this._disableTransparencySlider();this._clearSelection();this._silentlyUpdateHexInput("no-color");this._updatePreviewSwatch(a);b.add(this._noColorSwatchNode,this.css.selected);c&&this.emit("color-change",{color:"no-color"});return}this._enableTransparencySlider();b.remove(this._noColorSwatchNode,this.css.selected)}a=n.normalizeColor(a);var d=this._previousColor,g=this._colorInstance,f=this.css.selected;if(d){if(n.equal(d,a))return;if(d=this._findColorSwatch(d))b.remove(d,f),t.set(d,"borderColor",
"")}g.setColor(a);f=g.toHex();this._set("color",new k(g));this._previousColor=a;this._silentlyUpdateIntermediateChangingValueWidget(this.dap_transparencySlider,1-g.a);this._updatePreviewSwatch(g);this._checkSelection();this._silentlyUpdateHexInput(g);this.trackColors&&this._addRecentColor(f);c&&this.emit("color-change",{color:new k(g)})},colorsPerRow:13,_setColorsPerRow:function(a){this._set("colorsPerRow",0<a?a:13)},_setPaletteAttr:function(a){var b=this._activePalette===this._brightsPalette;this._brightsPalette.set("colors",
a);this._pastelsPalette.set("colors",this._toPastels(this._brightsPalette.get("colors")));this._activePalette=b?this._brightsPalette:this._pastelsPalette;this._createPalettes();this._togglePalette(!b)},recentColors:[],_getRecentColorsAttr:function(){return d.map(this.recentColors,function(a){return n.normalizeColor(a)})},_setRecentColorsAttr:function(a){this.recentColors=a||[];this.recentColors=d.map(this.recentColors,function(a){return n.normalizeColor(a).toHex()});0===this.recentColors.length?this._clearRecentSwatches():
this._renderRecentSwatches()},required:!1,_setRequiredAttr:function(a){b.toggle(this._noColorSwatchNode,this.css.displayNone,a);this._set("required",a)},_showRecentColors:!0,_setShowRecentColorsAttr:function(a){b.toggle(this.dap_recentColorSection,this.css.displayNone,!a);this._set("showRecentColors",a)},_showSuggestedColors:!1,_setShowSuggestedColorsAttr:function(a){b.toggle(this.dap_suggestedColorSection,this.css.displayNone,!a);this._set("showSuggestedColors",a)},_showTransparencySlider:!0,_setShowTransparencySliderAttr:function(a){b.toggle(this.dap_transparencySection,
this.css.displayNone,!a);this._set("showTransparencySlider",a)},suggestedColors:null,_getSuggestedColorsAttr:function(){return d.map(this.suggestedColors,function(a){return n.normalizeColor(a)})},_setSuggestedColorsAttr:function(a){this._clearSuggestedSwatches();this.suggestedColors=a||[];this.suggestedColors=d.map(this.suggestedColors,function(a){return n.normalizeColor(a).toHex()});0<this.suggestedColors.length&&this._renderSuggestedSwatches()},trackColors:!0,addRecentColor:function(a){a&&"no-color"!==
a&&this._addRecentColor(n.normalizeColor(a).toHex())},loadRecentColors:function(a){this.set("recentColors",JSON.parse(localStorage.getItem(a)))},saveRecentColors:function(a){localStorage.setItem(a,JSON.stringify(this.get("recentColors")))},_toPastels:function(a){var b=this._colorInstance,c=new k([238,238,238]);return d.map(a,function(a){return k.blendColors(b.setColor(a),c,.2)},this)},_createSwatch:function(a){return g.create("span",{className:a.className,style:{background:a.hexColor||"transparent"}},
a.paletteNode)},_createSwatches:function(a,b){var c=this.css.swatch,f=this.css.swatchRow,e=this.colorsPerRow;b=b.get("colors");var m,h;d.forEach(b,function(b,d){0===d%e&&(m=g.create("div",{className:f},a));h=this._swatchCreator({className:c,hexColor:b,paletteNode:m});this._swatches[b]=h},this)},_selectColor:function(){var a=this.color||this._activePalette.get("colors")[0];this.set("color",a)},_setColorWithCurrentAlpha:function(a){"no-color"!==a&&"no-color"!==this.color&&(a=n.normalizeColor(a),a.a=
this.color.a);this.set("color",a)},_updatePreviewSwatch:function(a){var c=this.css.swatchEmpty,d=this.dap_previewSwatch,g,f;"no-color"===a?(b.add(d,c),t.set(d,{backgroundColor:"",borderColor:""})):(g=n.getContrastingColor(a),f=8!==r("ie"),b.remove(d,c),c=a.toCss(f),g=g.toCss(f),g={backgroundColor:c,borderColor:g},f||(g.opacity=a.a),t.set(d,g))},_showBrights:function(){b.remove(this.dap_paletteContainer,this.css.alt);this._activePalette=this._brightsPalette},_showPastels:function(){b.add(this.dap_paletteContainer,
this.css.alt);this._activePalette=this._pastelsPalette},_setColorFromSwatch:function(a){a=t.get(a,"backgroundColor");this._setColorWithCurrentAlpha(a)},_checkSelection:function(){var a=this.get("color");this._activePalette.contains(a)?this._highlightColor(a):this._clearSelection()},_addListeners:function(){var b="."+this.css.swatch;this.own(u(this.dap_paletteContainer,u.selector(b,"click"),a.hitch(this,function(a){this._setColorFromSwatch(a.target)})));this.own(u(this.dap_recentColorPalette,u.selector(b,
"click"),a.hitch(this,function(a){this._setColorFromSwatch(a.target)})));this.own(u(this.dap_suggestedColorPalette,u.selector(b,"click"),a.hitch(this,function(a){this._setColorFromSwatch(a.target)})));this.own(u(this._noColorSwatchNode,"click",a.hitch(this,function(a){this.set("color","no-color")})));var c=this.dap_hexInput;c.on("blur",a.hitch(this,function(){var a=n.normalizeHex(c.get("value"));n.isShorthandHex(a)?this._setColorWithCurrentAlpha(a):this._silentlyUpdateHexInput(this.color)}));c.on("change",
a.hitch(this,function(){var a=n.normalizeHex(c.get("value"));n.isLonghandHex(a)&&("no-color"!==this.color&&this.color.toHex()===a||this._setColorWithCurrentAlpha(a))}));this.dap_transparencySlider.on("change",a.hitch(this,function(a){var b=this.get("color");"no-color"!==b&&(b=n.normalizeColor(this._colorInstance.setColor(b)),b.a=1-a,this._updatePreviewSwatch(b),this._silentlyUpdateHexInput(b),this.set("color",b))}));this.dap_paletteToggle.on("change",a.hitch(this,this._togglePalette));this.own(u(this.dap_header,
"click",function(){this.collapsible&&this.set("collapsed",!this.collapsed)}.bind(this)))},_togglePalette:function(a){this.dap_paletteToggle.set("checked",a,!1);a?this._showPastels():this._showBrights();this._checkSelection()},_createPalettes:function(){this._swatches={};g.empty(this.dap_primaryPalette);g.empty(this.dap_secondaryPalette);this._createSwatches(this.dap_primaryPalette,this._brightsPalette);this._createSwatches(this.dap_secondaryPalette,this._pastelsPalette)},_silentlyUpdateHexInput:function(a){a=
"no-color"===a?"":a.toHex();this._silentlyUpdateIntermediateChangingValueWidget(this.dap_hexInput,a)},_silentlyUpdateIntermediateChangingValueWidget:function(a,b){a.intermediateChanges=!1;a.set("value",b,!1);a.intermediateChanges=!0},_addRecentColor:function(a){if(a){var b=this.recentColors,c=d.indexOf(b,a);-1<c&&b.splice(c,1);b.unshift(a);b.length>this.colorsPerRow&&b.pop();this._renderRecentSwatches()}},_renderRecentSwatches:function(){if(this.recentColors){var a=this.css.recent,b=this.css.swatch,
c=m("."+a+"."+b,this.dap_recentColorPalette);d.forEach(this.recentColors,function(d,g){if(g<this.colorsPerRow){if(g+1>c.length){var f=this._swatchCreator({hexColor:d,className:b+" "+a,paletteNode:this.dap_recentColorPalette});c.push(f)}t.set(c[g],"backgroundColor",d)}},this)}},_renderSuggestedSwatches:function(){if(this.suggestedColors){var a=this.css.suggested,b=this.css.swatch,c=m("."+a+"."+b,this.dap_recentColorPalette);d.forEach(this.suggestedColors,function(d,g){if(g<this.colorsPerRow){if(g+
1>c.length){var f=this._swatchCreator({hexColor:d,className:b+" "+a,paletteNode:this.dap_suggestedColorPalette});c.push(f)}t.set(c[g],"backgroundColor",d)}},this)}},_clearRecentSwatches:function(){g.empty(this.dap_recentColorPalette)},_clearSuggestedSwatches:function(){g.empty(this.dap_suggestedColorPalette)},_clearSelection:function(){var a=this.css.selected;m("."+a,this.dap_paletteContainer).removeClass(a)},_highlightColor:function(a){var c=this.css.selected,d=this._findColorSwatch(a);d&&(a=n.normalizeColor(a),
a=n.getContrastingColor(a),b.add(d,c),t.set(d,"borderColor",a.toHex()))},_findColorSwatch:function(a){var b=this._activePalette.get("colors");a=this._colorInstance.setColor(a).toHex();var c;-1<d.indexOf(b,a)&&(c=this._swatches[a]);return c},_enableTransparencySlider:function(){b.remove(this.dap_transparencyLabel,this.css.disabled);this.dap_transparencySlider.set("disabled",!1)},_disableTransparencySlider:function(){b.add(this.dap_transparencyLabel,this.css.disabled);this.dap_transparencySlider.set("disabled",
!0)}});e.NO_COLOR="no-color";return e})},"esri/dijit/_Tooltip":function(){define(["dijit/Tooltip","dojo/_base/array","dojo/_base/declare","dojo/_base/lang","dojo/dom"],function(k,e,p,q,n){return p(null,{declaredClass:"esri.dijit._Tooltip",_tooltips:null,constructor:function(){this._tooltips=[]},startup:function(){this.inherited(arguments);this._started||e.forEach(this._tooltips,function(e){e.startup()})},destroy:function(){this.inherited(arguments);e.forEach(this._tooltips,function(e){e.destroy()});
this._tooltips=null},createTooltips:function(l){e.forEach(l,function(e){this.createTooltip(e.node,e.label)},this)},createTooltip:function(e,h){if(e=this._getConnectId(e))h="object"===typeof h?q.mixin({},h,{connectId:e}):{connectId:e,label:h},h=new k(h),this._started&&h.startup(),this._tooltips.push(h)},_getConnectId:function(l){var h,f;if(l){if(q.isArray(l)){if(h=[],e.forEach(l,function(d){(f=this._getNode(d))&&h.push(f)}),0===h.length)return}else if(h=this._getNode(l),!h)return;return h}},_getNode:function(e){return n.byId(e.domNode||
e)},findTooltip:function(l){var h=this._getNode(l),f,d,c;if(l){l=this._tooltips;f=l.length;for(var a=0;a<f;a++)if(d=l[a],c=q.isArray(d.connectId)?-1<e.indexOf(d.connectId,h):d.connectId===h)return d}}})})},"esri/dijit/ColorPicker/colorUtil":function(){define(["dojo/_base/lang","../../Color"],function(k,e){var p={equal:function(e,k){return e&&k&&e.r===k.r&&e.g===k.g&&e.b===k.b&&e.a===k.a},normalizeHex:function(e){return"#"+k.trim(e).replace(/#/g,"").substr(0,6)},normalizeColor:function(k){return new e(k)},
isValidHex:function(e){return p.isShorthandHex(e)||p.isLonghandHex(e)},_shortHandHex:/^#[0-9A-F]{3}$/i,isShorthandHex:function(e){return e&&4===e.length&&p._shortHandHex.test(e)},_longhandHex:/^#[0-9A-F]{6}$/i,isLonghandHex:function(e){return e&&7===e.length&&p._longhandHex.test(e)},getContrastingColor:function(e){return p.isBright(e)?this.darker(e):this.brighter(e,3)},isBright:function(e){return 127<=.299*e.r+.587*e.g+.114*e.b},darker:function(k,n){n=Math.pow(.7,n?n:1);return new e([Math.round(k.r*
n),Math.round(k.g*n),Math.round(k.b*n),k.a])},brighter:function(k,n){n=Math.pow(.7,n?n:1);var l=k.r,h=k.g,f=k.b;30>l&&(l=30);30>h&&(h=30);30>f&&(f=30);return new e([Math.min(255,Math.round(l/n)),Math.min(255,Math.round(h/n)),Math.min(255,Math.round(f/n)),k.a])}};return p})},"esri/dijit/ColorPicker/HexPalette":function(){define(["dojo/_base/array","dojo/_base/Color","dojo/_base/declare","dojo/Stateful"],function(k,e,p,q){var n="#ffffff #858585 #ffbebe #ffebbe #ffebaf #ffffbe #e9ffbe #d3ffbe #beffe8 #bee8ff #bed2ff #e8beff #ffbee8 #ebebeb #707070 #ff7f7f #ffa77f #ffd37f #ffff73 #d1ff73 #a3ff73 #73ffdf #73dfff #73b2ff #df73ff #ff73df #d6d6d6 #5c5c5c #ff0000 #ff5500 #ffaa00 #ffff00 #aaff00 #55ff00 #00ffc5 #00c5ff #0070ff #c500ff #ff00c5 #c2c2c2 #474747 #e60000 #e64c00 #e69800 #e6e600 #98e600 #4ce600 #00e6a9 #00a9e6 #005ce6 #a900e6 #e600a9 #adadad #242424 #a80000 #a83800 #a87000 #a8a800 #70a800 #38a800 #00a884 #0084a8 #004da8 #8400a8 #a80084 #999999 #1a1a1a #730000 #732600 #734c00 #737300 #4c7300 #267300 #00734c #004c73 #002673 #4c0073 #73004c".split(" ");
e=p([q],{constructor:function(e){e=e||{};this.set("colors",e.colors)},_colorInstance:new e,_colors:null,_colorsGetter:function(){return this._colors},_colorsSetter:function(e){e=e?e:n;this._colors=this._normalizeColors(e)},_normalizeColors:function(e){var h=this._colorInstance;return k.map(e,function(f){return h.setColor(f).toHex()},this)},contains:function(e){var h=this._colorInstance;h.setColor(e);return-1<k.indexOf(this._colors,h.toHex())}});e.DEFAULT_COLORS=n;return e})},"esri/dijit/HorizontalSlider":function(){define("dijit/form/HorizontalRuleLabels dijit/form/HorizontalSlider dojo/_base/declare dojo/_base/lang dojo/has ../kernel".split(" "),
function(k,e,p,q,n,l){return p("esri.dijit.HorizontalSlider",e,{baseClass:"esriHorizontalSlider",showButtons:!1,labels:null,constructor:function(e){e=e||{};e.labels&&(this.labels=e.labels)},buildRendering:function(){this.inherited(arguments);this.labels&&(new k({labels:this.labels})).placeAt(this.bottomDecoration)}})})},"dijit/form/HorizontalRuleLabels":function(){define("dojo/_base/declare dojo/has dojo/number dojo/query dojo/_base/lang ./HorizontalRule".split(" "),function(k,e,p,q,n,l){k=k("dijit.form.HorizontalRuleLabels",
l,{templateString:'\x3cdiv class\x3d"dijitRuleContainer dijitRuleContainerH dijitRuleLabelsContainer dijitRuleLabelsContainerH"\x3e\x3c/div\x3e',labelStyle:"",labels:[],numericMargin:0,minimum:0,maximum:1,constraints:{pattern:"#%"},_positionPrefix:'\x3cdiv class\x3d"dijitRuleLabelContainer dijitRuleLabelContainerH" style\x3d"left:',_labelPrefix:'"\x3e\x3cdiv class\x3d"dijitRuleLabel dijitRuleLabelH"\x3e',_suffix:"\x3c/div\x3e\x3c/div\x3e",_calcPosition:function(e){return e},_genHTML:function(e,f){f=
this.labels[f];return this._positionPrefix+this._calcPosition(e)+this._positionSuffix+this.labelStyle+this._genDirectionHTML(f)+this._labelPrefix+f+this._suffix},_genDirectionHTML:function(e){return""},getLabels:function(){var e=this.labels;!e.length&&this.srcNodeRef&&(e=q("\x3e li",this.srcNodeRef).map(function(a){return String(a.innerHTML)}));if(!e.length&&1<this.count)for(var e=[],f=this.minimum,d=(this.maximum-f)/(this.count-1),c=0;c<this.count;c++)e.push(c<this.numericMargin||c>=this.count-this.numericMargin?
"":p.format(f,this.constraints)),f+=d;return e},postMixInProperties:function(){this.inherited(arguments);this.labels=this.getLabels();this.count=this.labels.length}});e("dojo-bidi")&&k.extend({_setTextDirAttr:function(e){this.textDir!=e&&(this._set("textDir",e),q(".dijitRuleLabelContainer",this.domNode).forEach(n.hitch(this,function(f){f.style.direction=this.getTextDir(f.innerText||f.textContent||"")})))},_genDirectionHTML:function(e){return this.textDir?"direction:"+this.getTextDir(e)+";":""}});
return k})},"dijit/form/HorizontalRule":function(){define(["dojo/_base/declare","../_Widget","../_TemplatedMixin"],function(k,e,p){return k("dijit.form.HorizontalRule",[e,p],{templateString:'\x3cdiv class\x3d"dijitRuleContainer dijitRuleContainerH"\x3e\x3c/div\x3e',count:3,container:"containerNode",ruleStyle:"",_positionPrefix:'\x3cdiv class\x3d"dijitRuleMark dijitRuleMarkH" style\x3d"left:',_positionSuffix:"%;",_suffix:'"\x3e\x3c/div\x3e',_genHTML:function(e){return this._positionPrefix+e+this._positionSuffix+
this.ruleStyle+this._suffix},_isHorizontal:!0,buildRendering:function(){this.inherited(arguments);var e;if(1==this.count)e=this._genHTML(50,0);else{var k,l=100/(this.count-1);if(!this._isHorizontal||this.isLeftToRight()){e=this._genHTML(0,0);for(k=1;k<this.count-1;k++)e+=this._genHTML(l*k,k);e+=this._genHTML(100,this.count-1)}else{e=this._genHTML(100,0);for(k=1;k<this.count-1;k++)e+=this._genHTML(100-l*k,k);e+=this._genHTML(0,this.count-1)}}this.domNode.innerHTML=e}})})},"dijit/form/HorizontalSlider":function(){define("dojo/_base/array dojo/_base/declare dojo/dnd/move dojo/_base/fx dojo/dom-geometry dojo/dom-style dojo/keys dojo/_base/lang dojo/sniff dojo/dnd/Moveable dojo/dnd/Mover dojo/query dojo/mouse dojo/on ../_base/manager ../focus ../typematic ./Button ./_FormValueWidget ../_Container dojo/text!./templates/HorizontalSlider.html".split(" "),
function(k,e,p,q,n,l,h,f,d,c,a,b,g,u,m,r,t,v,y,w,z){var x=e("dijit.form._SliderMover",a,{onMouseMove:function(a){var b=this.widget,c=b._abspos;c||(c=b._abspos=n.position(b.sliderBarContainer,!0),b._setPixelValue_=f.hitch(b,"_setPixelValue"),b._isReversed_=b._isReversed());a=a[b._mousePixelCoord]-c[b._startingPixelCoord];b._setPixelValue_(b._isReversed_?c[b._pixelCount]-a:a,c[b._pixelCount],!1)},destroy:function(b){a.prototype.destroy.apply(this,arguments);var c=this.widget;c._abspos=null;c._setValueAttr(c.value,
!0)}});p=e("dijit.form.HorizontalSlider",[y,w],{templateString:z,value:0,showButtons:!0,minimum:0,maximum:100,discreteValues:Infinity,pageIncrement:2,clickSelect:!0,slideDuration:m.defaultDuration,_setIdAttr:"",_setNameAttr:"valueNode",baseClass:"dijitSlider",cssStateNodes:{incrementButton:"dijitSliderIncrementButton",decrementButton:"dijitSliderDecrementButton",focusNode:"dijitSliderThumb"},_mousePixelCoord:"pageX",_pixelCount:"w",_startingPixelCoord:"x",_handleOffsetCoord:"left",_progressPixelSize:"width",
_onKeyUp:function(a){this.disabled||this.readOnly||a.altKey||a.ctrlKey||a.metaKey||this._setValueAttr(this.value,!0)},_onKeyDown:function(a){if(!(this.disabled||this.readOnly||a.altKey||a.ctrlKey||a.metaKey)){switch(a.keyCode){case h.HOME:this._setValueAttr(this.minimum,!1);break;case h.END:this._setValueAttr(this.maximum,!1);break;case this._descending||this.isLeftToRight()?h.RIGHT_ARROW:h.LEFT_ARROW:case !1===this._descending?h.DOWN_ARROW:h.UP_ARROW:case !1===this._descending?h.PAGE_DOWN:h.PAGE_UP:this.increment(a);
break;case this._descending||this.isLeftToRight()?h.LEFT_ARROW:h.RIGHT_ARROW:case !1===this._descending?h.UP_ARROW:h.DOWN_ARROW:case !1===this._descending?h.PAGE_UP:h.PAGE_DOWN:this.decrement(a);break;default:return}a.stopPropagation();a.preventDefault()}},_onHandleClick:function(a){this.disabled||this.readOnly||(d("ie")||r.focus(this.sliderHandle),a.stopPropagation(),a.preventDefault())},_isReversed:function(){return!this.isLeftToRight()},_onBarClick:function(a){if(!this.disabled&&!this.readOnly&&
this.clickSelect){r.focus(this.sliderHandle);a.stopPropagation();a.preventDefault();var b=n.position(this.sliderBarContainer,!0),c=a[this._mousePixelCoord]-b[this._startingPixelCoord];this._setPixelValue(this._isReversed()?b[this._pixelCount]-c:c,b[this._pixelCount],!0);this._movable.onMouseDown(a)}},_setPixelValue:function(a,b,c){if(!this.disabled&&!this.readOnly){var d=this.discreteValues;if(1>=d||Infinity==d)d=b;d--;this._setValueAttr(Math.max(Math.min((this.maximum-this.minimum)*Math.round(a/
(b/d))/d+this.minimum,this.maximum),this.minimum),c)}},_setValueAttr:function(a,b){this._set("value",a);this.valueNode.value=a;this.focusNode.setAttribute("aria-valuenow",a);this.inherited(arguments);var c=this.maximum>this.minimum?(a-this.minimum)/(this.maximum-this.minimum):0,d=!1===this._descending?this.remainingBar:this.progressBar,g=!1===this._descending?this.progressBar:this.remainingBar;this._inProgressAnim&&"stopped"!=this._inProgressAnim.status&&this._inProgressAnim.stop(!0);if(b&&0<this.slideDuration&&
d.style[this._progressPixelSize]){var f=this,e={},m=parseFloat(d.style[this._progressPixelSize]),h=this.slideDuration*(c-m/100);0!=h&&(0>h&&(h=0-h),e[this._progressPixelSize]={start:m,end:100*c,units:"%"},this._inProgressAnim=q.animateProperty({node:d,duration:h,onAnimate:function(a){g.style[f._progressPixelSize]=100-parseFloat(a[f._progressPixelSize])+"%"},onEnd:function(){delete f._inProgressAnim},properties:e}),this._inProgressAnim.play())}else d.style[this._progressPixelSize]=100*c+"%",g.style[this._progressPixelSize]=
100*(1-c)+"%"},_bumpValue:function(a,b){if(!(this.disabled||this.readOnly||this.maximum<=this.minimum)){var c=l.getComputedStyle(this.sliderBarContainer),d=n.getContentBox(this.sliderBarContainer,c),c=this.discreteValues;if(1>=c||Infinity==c)c=d[this._pixelCount];c--;a=Math.round((this.value-this.minimum)*c/(this.maximum-this.minimum))+a;0>a&&(a=0);a>c&&(a=c);a=a*(this.maximum-this.minimum)/c+this.minimum;this._setValueAttr(a,b)}},_onClkBumper:function(a){this.disabled||this.readOnly||!this.clickSelect||
this._setValueAttr(a,!0)},_onClkIncBumper:function(){this._onClkBumper(!1===this._descending?this.minimum:this.maximum)},_onClkDecBumper:function(){this._onClkBumper(!1===this._descending?this.maximum:this.minimum)},decrement:function(a){this._bumpValue(a.keyCode==h.PAGE_DOWN?-this.pageIncrement:-1)},increment:function(a){this._bumpValue(a.keyCode==h.PAGE_UP?this.pageIncrement:1)},_mouseWheeled:function(a){this.focused&&(a.stopPropagation(),a.preventDefault(),this._bumpValue(0>a.wheelDelta?-1:1,!0))},
startup:function(){this._started||(k.forEach(this.getChildren(),function(a){this[a.container]!=this.containerNode&&this[a.container].appendChild(a.domNode)},this),this.inherited(arguments))},_typematicCallback:function(a,b,c){if(-1==a)this._setValueAttr(this.value,!0);else this[b==(this._descending?this.incrementButton:this.decrementButton)?"decrement":"increment"](c)},buildRendering:function(){this.inherited(arguments);this.showButtons&&(this.incrementButton.style.display="",this.decrementButton.style.display=
"");var a=b('label[for\x3d"'+this.id+'"]');a.length&&(a[0].id||(a[0].id=this.id+"_label"),this.focusNode.setAttribute("aria-labelledby",a[0].id));this.focusNode.setAttribute("aria-valuemin",this.minimum);this.focusNode.setAttribute("aria-valuemax",this.maximum)},postCreate:function(){this.inherited(arguments);this.showButtons&&this.own(t.addMouseListener(this.decrementButton,this,"_typematicCallback",25,500),t.addMouseListener(this.incrementButton,this,"_typematicCallback",25,500));this.own(u(this.domNode,
g.wheel,f.hitch(this,"_mouseWheeled")));var a=e(x,{widget:this});this._movable=new c(this.sliderHandle,{mover:a});this._layoutHackIE7()},destroy:function(){this._movable.destroy();this._inProgressAnim&&"stopped"!=this._inProgressAnim.status&&this._inProgressAnim.stop(!0);this.inherited(arguments)}});p._Mover=x;return p})},"dijit/typematic":function(){define("dojo/_base/array dojo/_base/connect dojo/_base/lang dojo/on dojo/sniff ./main".split(" "),function(k,e,p,q,n,l){var h=l.typematic={_fireEventAndReload:function(){this._timer=
null;this._callback(++this._count,this._node,this._evt);this._currentTimeout=Math.max(0>this._currentTimeout?this._initialDelay:1<this._subsequentDelay?this._subsequentDelay:Math.round(this._currentTimeout*this._subsequentDelay),this._minDelay);this._timer=setTimeout(p.hitch(this,"_fireEventAndReload"),this._currentTimeout)},trigger:function(f,d,c,a,b,g,e,m){if(b!=this._obj){this.stop();this._initialDelay=e||500;this._subsequentDelay=g||.9;this._minDelay=m||10;this._obj=b;this._node=c;this._count=
this._currentTimeout=-1;this._callback=p.hitch(d,a);this._evt={faux:!0};for(var h in f)"layerX"!=h&&"layerY"!=h&&(d=f[h],"function"!=typeof d&&"undefined"!=typeof d&&(this._evt[h]=d));this._fireEventAndReload()}},stop:function(){this._timer&&(clearTimeout(this._timer),this._timer=null);this._obj&&(this._callback(-1,this._node,this._evt),this._obj=null)},addKeyListener:function(f,d,c,a,b,g,l){var m="keyCode"in d?"keyCode":"charCode"in d?"charCode":"charOrCode",n=[q(f,"keyCode"in d?"keydown":"charCode"in
d?"keypress":e._keypress,p.hitch(this,function(e){e[m]!=d[m]||void 0!==d.ctrlKey&&d.ctrlKey!=e.ctrlKey||void 0!==d.altKey&&d.altKey!=e.altKey||void 0!==d.metaKey&&d.metaKey!=(e.metaKey||!1)||void 0!==d.shiftKey&&d.shiftKey!=e.shiftKey?h._obj==d&&h.stop():(e.stopPropagation(),e.preventDefault(),h.trigger(e,c,f,a,d,b,g,l))})),q(f,"keyup",p.hitch(this,function(){h._obj==d&&h.stop()}))];return{remove:function(){k.forEach(n,function(a){a.remove()})}}},addMouseListener:function(f,d,c,a,b,g){var e=[q(f,
"mousedown",p.hitch(this,function(e){e.preventDefault();h.trigger(e,d,f,c,f,a,b,g)})),q(f,"mouseup",p.hitch(this,function(a){this._obj&&a.preventDefault();h.stop()})),q(f,"mouseout",p.hitch(this,function(a){this._obj&&a.preventDefault();h.stop()})),q(f,"dblclick",p.hitch(this,function(e){e.preventDefault();9>n("ie")&&(h.trigger(e,d,f,c,f,a,b,g),setTimeout(p.hitch(this,h.stop),50))}))];return{remove:function(){k.forEach(e,function(a){a.remove()})}}},addListener:function(f,d,c,a,b,g,e,m){var h=[this.addKeyListener(d,
c,a,b,g,e,m),this.addMouseListener(f,a,b,g,e,m)];return{remove:function(){k.forEach(h,function(a){a.remove()})}}}};return h})},"dijit/form/RadioButton":function(){define(["dojo/_base/declare","./CheckBox","./_RadioButtonMixin"],function(k,e,p){return k("dijit.form.RadioButton",[e,p],{baseClass:"dijitRadio"})})},"dijit/form/_RadioButtonMixin":function(){define("dojo/_base/array dojo/_base/declare dojo/dom-attr dojo/_base/lang dojo/query!css2 ../registry".split(" "),function(k,e,p,q,n,l){return e("dijit.form._RadioButtonMixin",
null,{type:"radio",_getRelatedWidgets:function(){var e=[];n("input[type\x3dradio]",this.focusNode.form||this.ownerDocument).forEach(q.hitch(this,function(f){f.name==this.name&&f.form==this.focusNode.form&&(f=l.getEnclosingWidget(f))&&e.push(f)}));return e},_setCheckedAttr:function(e){this.inherited(arguments);this._created&&e&&k.forEach(this._getRelatedWidgets(),q.hitch(this,function(f){f!=this&&f.checked&&f.set("checked",!1)}))},_getSubmitValue:function(e){return null==e?"on":e},_onClick:function(e){if(this.checked||
this.disabled)return e.stopPropagation(),e.preventDefault(),!1;if(this.readOnly)return e.stopPropagation(),e.preventDefault(),k.forEach(this._getRelatedWidgets(),q.hitch(this,function(c){p.set(this.focusNode||this.domNode,"checked",c.checked)})),!1;var f=!1,d;k.some(this._getRelatedWidgets(),function(c){return c.checked?(d=c,!0):!1});this.checked=!0;d&&(d.checked=!1);if(!1===this.onClick(e)||e.defaultPrevented)f=!0;this.checked=!1;d&&(d.checked=!0);f?e.preventDefault():this.set("checked",!0);return!f}})})},
"dijit/_editor/plugins/TextColor":function(){define("require dojo/colors dojo/_base/declare dojo/_base/lang ../_Plugin ../../form/DropDownButton".split(" "),function(k,e,p,q,n,l){var h=p("dijit._editor.plugins.TextColor",n,{buttonClass:l,colorPicker:"dijit/ColorPalette",useDefaultCommand:!1,_initButton:function(){this.command=this.name;this.inherited(arguments);var f=this;this.button.loadDropDown=function(d){function c(a){f.button.dropDown=new a({dir:f.editor.dir,ownerDocument:f.editor.ownerDocument,
value:f.value,onChange:function(a){f.editor.execCommand(f.command,a)},onExecute:function(){f.editor.execCommand(f.command,this.get("value"))}});d()}"string"==typeof f.colorPicker?k([f.colorPicker],c):c(f.colorPicker)}},updateState:function(){var f=this.editor,d=this.command;if(f&&f.isLoaded&&d.length){if(this.button){var c=this.get("disabled");this.button.set("disabled",c);if(c)return;var a;try{a=f.queryCommandValue(d)||""}catch(b){a=""}}""==a&&(a="#000000");"transparent"==a&&(a="#ffffff");"string"==
typeof a?-1<a.indexOf("rgb")&&(a=e.fromRgb(a).toHex()):(a=((a&255)<<16|a&65280|(a&16711680)>>>16).toString(16),a="#000000".slice(0,7-a.length)+a);this.value=a;(f=this.button.dropDown)&&f.get&&a!==f.get("value")&&f.set("value",a,!1)}}});n.registry.foreColor=function(f){return new h(f)};n.registry.hiliteColor=function(f){return new h(f)};return h})},"dojo/colors":function(){define(["./_base/kernel","./_base/lang","./_base/Color","./_base/array"],function(k,e,p,q){var n={};e.setObject("dojo.colors",
n);var l=function(f,d,c){0>c&&++c;1<c&&--c;var a=6*c;return 1>a?f+(d-f)*a:1>2*c?d:2>3*c?f+(d-f)*(2/3-c)*6:f};k.colorFromRgb=p.fromRgb=function(f,d){var c=f.toLowerCase().match(/^(rgba?|hsla?)\(([\s\.\-,%0-9]+)\)/);if(c){f=c[2].split(/\s*,\s*/);var a=f.length,c=c[1];if("rgb"==c&&3==a||"rgba"==c&&4==a)return c=f[0],"%"==c.charAt(c.length-1)?(c=q.map(f,function(a){return 2.56*parseFloat(a)}),4==a&&(c[3]=f[3]),p.fromArray(c,d)):p.fromArray(f,d);if("hsl"==c&&3==a||"hsla"==c&&4==a){var c=(parseFloat(f[0])%
360+360)%360/360,b=parseFloat(f[1])/100,g=parseFloat(f[2])/100,b=.5>=g?g*(b+1):g+b-g*b,g=2*g-b,c=[256*l(g,b,c+1/3),256*l(g,b,c),256*l(g,b,c-1/3),1];4==a&&(c[3]=f[3]);return p.fromArray(c,d)}}return null};var h=function(f,d,c){f=Number(f);return isNaN(f)?c:f<d?d:f>c?c:f};p.prototype.sanitize=function(){this.r=Math.round(h(this.r,0,255));this.g=Math.round(h(this.g,0,255));this.b=Math.round(h(this.b,0,255));this.a=h(this.a,0,1);return this};n.makeGrey=p.makeGrey=function(f,d){return p.fromArray([f,f,
f,d])};e.mixin(p.named,{aliceblue:[240,248,255],antiquewhite:[250,235,215],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],blanchedalmond:[255,235,205],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,
169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,
34],floralwhite:[255,250,240],forestgreen:[34,139,34],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,
250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,
104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],oldlace:[253,245,230],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,
192,203],plum:[221,160,221],powderblue:[176,224,230],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,
222,179],whitesmoke:[245,245,245],yellowgreen:[154,205,50]});return p})},"dijit/form/DropDownButton":function(){define("dojo/_base/declare dojo/_base/kernel dojo/_base/lang dojo/query ../registry ../popup ./Button ../_Container ../_HasDropDown dojo/text!./templates/DropDownButton.html ../a11yclick".split(" "),function(k,e,p,q,n,l,h,f,d,c){return k("dijit.form.DropDownButton",[h,f,d],{baseClass:"dijitDropDownButton",templateString:c,_fillContent:function(){var a=this.srcNodeRef,b=this.containerNode;
if(a&&b)for(;a.hasChildNodes();){var c=a.firstChild;c.hasAttribute&&(c.hasAttribute("data-dojo-type")||c.hasAttribute("dojoType")||c.hasAttribute("data-"+e._scopeName+"-type")||c.hasAttribute(e._scopeName+"Type"))?(this.dropDownContainer=this.ownerDocument.createElement("div"),this.dropDownContainer.appendChild(c)):b.appendChild(c)}},startup:function(){this._started||(!this.dropDown&&this.dropDownContainer&&(this.dropDown=n.byNode(this.dropDownContainer.firstChild),delete this.dropDownContainer),
this.dropDown&&l.hide(this.dropDown),this.inherited(arguments))},isLoaded:function(){var a=this.dropDown;return!!a&&(!a.href||a.isLoaded)},loadDropDown:function(a){var b=this.dropDown,c=b.on("load",p.hitch(this,function(){c.remove();a()}));b.refresh()},isFocusable:function(){return this.inherited(arguments)&&!this._mouseDown}})})},"dijit/_editor/plugins/LinkDialog":function(){define("require dojo/_base/declare dojo/dom-attr dojo/keys dojo/_base/lang dojo/on dojo/sniff dojo/query dojo/string ../_Plugin ../../form/DropDownButton ../range".split(" "),
function(k,e,p,q,n,l,h,f,d,c,a,b){var g=e("dijit._editor.plugins.LinkDialog",c,{buttonClass:a,useDefaultCommand:!1,urlRegExp:"((https?|ftps?|file)\\://|./|../|/|)(/[a-zA-Z]{1,1}:/|)(((?:(?:[\\da-zA-Z](?:[-\\da-zA-Z]{0,61}[\\da-zA-Z])?)\\.)*(?:[a-zA-Z](?:[-\\da-zA-Z]{0,80}[\\da-zA-Z])?)\\.?)|(((\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])\\.){3}(\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])|(0[xX]0*[\\da-fA-F]?[\\da-fA-F]\\.){3}0[xX]0*[\\da-fA-F]?[\\da-fA-F]|(0+[0-3][0-7][0-7]\\.){3}0+[0-3][0-7][0-7]|(0|[1-9]\\d{0,8}|[1-3]\\d{9}|4[01]\\d{8}|42[0-8]\\d{7}|429[0-3]\\d{6}|4294[0-8]\\d{5}|42949[0-5]\\d{4}|429496[0-6]\\d{3}|4294967[01]\\d{2}|42949672[0-8]\\d|429496729[0-5])|0[xX]0*[\\da-fA-F]{1,8}|([\\da-fA-F]{1,4}\\:){7}[\\da-fA-F]{1,4}|([\\da-fA-F]{1,4}\\:){6}((\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])\\.){3}(\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])))(\\:\\d+)?(/(?:[^?#\\s/]+/)*(?:[^?#\\s/]{0,}(?:\\?[^?#\\s/]*)?(?:#.*)?)?)?",
emailRegExp:"\x3c?(mailto\\:)([!#-'*+\\-\\/-9\x3d?A-Z^-~]+[.])*[!#-'*+\\-\\/-9\x3d?A-Z^-~]+@((?:(?:[\\da-zA-Z](?:[-\\da-zA-Z]{0,61}[\\da-zA-Z])?)\\.)+(?:[a-zA-Z](?:[-\\da-zA-Z]{0,6}[\\da-zA-Z])?)\\.?)|localhost|^[^-][a-zA-Z0-9_-]*\x3e?",htmlTemplate:'\x3ca href\x3d"${urlInput}" _djrealurl\x3d"${urlInput}" target\x3d"${targetSelect}"\x3e${textInput}\x3c/a\x3e',tag:"a",_hostRxp:/^((([^\[:]+):)?([^@]+)@)?(\[([^\]]+)\]|([^\[:]*))(:([0-9]+))?$/,_userAtRxp:/^([!#-'*+\-\/-9=?A-Z^-~]+[.])*[!#-'*+\-\/-9=?A-Z^-~]+@/i,
linkDialogTemplate:"\x3ctable role\x3d'presentation'\x3e\x3ctr\x3e\x3ctd\x3e\x3clabel for\x3d'${id}_urlInput'\x3e${url}\x3c/label\x3e\x3c/td\x3e\x3ctd\x3e\x3cinput data-dojo-type\x3d'dijit.form.ValidationTextBox' required\x3d'true' id\x3d'${id}_urlInput' name\x3d'urlInput' data-dojo-props\x3d'intermediateChanges:true'/\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd\x3e\x3clabel for\x3d'${id}_textInput'\x3e${text}\x3c/label\x3e\x3c/td\x3e\x3ctd\x3e\x3cinput data-dojo-type\x3d'dijit.form.ValidationTextBox' required\x3d'true' id\x3d'${id}_textInput' name\x3d'textInput' data-dojo-props\x3d'intermediateChanges:true'/\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd\x3e\x3clabel for\x3d'${id}_targetSelect'\x3e${target}\x3c/label\x3e\x3c/td\x3e\x3ctd\x3e\x3cselect id\x3d'${id}_targetSelect' name\x3d'targetSelect' data-dojo-type\x3d'dijit.form.Select'\x3e\x3coption selected\x3d'selected' value\x3d'_self'\x3e${currentWindow}\x3c/option\x3e\x3coption value\x3d'_blank'\x3e${newWindow}\x3c/option\x3e\x3coption value\x3d'_top'\x3e${topWindow}\x3c/option\x3e\x3coption value\x3d'_parent'\x3e${parentWindow}\x3c/option\x3e\x3c/select\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd colspan\x3d'2'\x3e\x3cbutton data-dojo-type\x3d'dijit.form.Button' type\x3d'submit' id\x3d'${id}_setButton'\x3e${set}\x3c/button\x3e\x3cbutton data-dojo-type\x3d'dijit.form.Button' type\x3d'button' id\x3d'${id}_cancelButton'\x3e${buttonCancel}\x3c/button\x3e\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e",
_initButton:function(){this.inherited(arguments);this.button.loadDropDown=n.hitch(this,"_loadDropDown");this._connectTagEvents()},_loadDropDown:function(a){k("dojo/i18n ../../TooltipDialog ../../registry ../../form/Button ../../form/Select ../../form/ValidationTextBox dojo/i18n!../../nls/common dojo/i18n!../nls/LinkDialog".split(" "),n.hitch(this,function(b,c,g){var f=this;this.tag="insertImage"==this.command?"img":"a";b=n.delegate(b.getLocalization("dijit","common",this.lang),b.getLocalization("dijit._editor",
"LinkDialog",this.lang));var e=this.dropDown=this.button.dropDown=new c({title:b[this.command+"Title"],ownerDocument:this.editor.ownerDocument,dir:this.editor.dir,execute:n.hitch(this,"setValue"),onOpen:function(){f._onOpenDialog();c.prototype.onOpen.apply(this,arguments)},onCancel:function(){setTimeout(n.hitch(f,"_onCloseDialog"),0)}});b.urlRegExp=this.urlRegExp;b.id=g.getUniqueId(this.editor.id);this._uniqueId=b.id;this._setContent(e.title+"\x3cdiv style\x3d'border-bottom: 1px black solid;padding-bottom:2pt;margin-bottom:4pt'\x3e\x3c/div\x3e"+
d.substitute(this.linkDialogTemplate,b));e.startup();this._urlInput=g.byId(this._uniqueId+"_urlInput");this._textInput=g.byId(this._uniqueId+"_textInput");this._setButton=g.byId(this._uniqueId+"_setButton");this.own(g.byId(this._uniqueId+"_cancelButton").on("click",n.hitch(this.dropDown,"onCancel")));this._urlInput&&this.own(this._urlInput.on("change",n.hitch(this,"_checkAndFixInput")));this._textInput&&this.own(this._textInput.on("change",n.hitch(this,"_checkAndFixInput")));this._urlRegExp=new RegExp("^"+
this.urlRegExp+"$","i");this._emailRegExp=new RegExp("^"+this.emailRegExp+"$","i");this._urlInput.isValid=n.hitch(this,function(){var a=this._urlInput.get("value");return this._urlRegExp.test(a)||this._emailRegExp.test(a)});this.own(l(e.domNode,"keydown",n.hitch(this,n.hitch(this,function(a){!a||a.keyCode!=q.ENTER||a.shiftKey||a.metaKey||a.ctrlKey||a.altKey||this._setButton.get("disabled")||(e.onExecute(),e.execute(e.get("value")))}))));a()}))},_checkAndFixInput:function(){var a=this,b=this._urlInput.get("value");
this._delayedCheck&&(clearTimeout(this._delayedCheck),this._delayedCheck=null);this._delayedCheck=setTimeout(function(){var c=b,d=!1,g=!1;c&&1<c.length&&(c=n.trim(c),0!==c.indexOf("mailto:")&&(0<c.indexOf("/")?-1===c.indexOf("://")&&"/"!==c.charAt(0)&&c.indexOf("./")&&0!==c.indexOf("../")&&a._hostRxp.test(c)&&(d=!0):a._userAtRxp.test(c)&&(g=!0)));d&&a._urlInput.set("value","http://"+c);g&&a._urlInput.set("value","mailto:"+c);a._setButton.set("disabled",!a._isValid())},250)},_connectTagEvents:function(){this.editor.onLoadDeferred.then(n.hitch(this,
function(){this.own(l(this.editor.editNode,"dblclick",n.hitch(this,"_onDblClick")))}))},_isValid:function(){return this._urlInput.isValid()&&this._textInput.isValid()},_setContent:function(a){this.dropDown.set({parserScope:"dojo",content:a})},_checkValues:function(a){a&&a.urlInput&&(a.urlInput=a.urlInput.replace(/"/g,"\x26quot;"));return a},setValue:function(a){this._onCloseDialog();if(9>h("ie")){var c=b.getSelection(this.editor.window).getRangeAt(0).endContainer;3===c.nodeType&&(c=c.parentNode);
c&&c.nodeName&&c.nodeName.toLowerCase()!==this.tag&&(c=this.editor.selection.getSelectedElement(this.tag));c&&c.nodeName&&c.nodeName.toLowerCase()===this.tag&&this.editor.queryCommandEnabled("unlink")&&(this.editor.selection.selectElementChildren(c),this.editor.execCommand("unlink"))}a=this._checkValues(a);this.editor.execCommand("inserthtml",d.substitute(this.htmlTemplate,a));f("a",this.editor.document).forEach(function(a){a.innerHTML||p.has(a,"name")||a.parentNode.removeChild(a)},this)},_onCloseDialog:function(){this.editor.focused&&
this.editor.focus()},_getCurrentValues:function(a){var b,c,d;a&&a.tagName.toLowerCase()===this.tag?(b=a.getAttribute("_djrealurl")||a.getAttribute("href"),d=a.getAttribute("target")||"_self",c=a.textContent||a.innerText,this.editor.selection.selectElement(a,!0)):c=this.editor.selection.getSelectedText();return{urlInput:b||"",textInput:c||"",targetSelect:d||""}},_onOpenDialog:function(){var a,c;if(h("ie")){if(c=b.getSelection(this.editor.window),c.rangeCount){var d=c.getRangeAt(0);a=d.endContainer;
3===a.nodeType&&(a=a.parentNode);a&&a.nodeName&&a.nodeName.toLowerCase()!==this.tag&&(a=this.editor.selection.getSelectedElement(this.tag));if(!a||a.nodeName&&a.nodeName.toLowerCase()!==this.tag)(c=this.editor.selection.getAncestorElement(this.tag))&&c.nodeName&&c.nodeName.toLowerCase()==this.tag?(a=c,this.editor.selection.selectElement(a)):d.startContainer===d.endContainer&&(c=d.startContainer.firstChild)&&c.nodeName&&c.nodeName.toLowerCase()==this.tag&&(a=c,this.editor.selection.selectElement(a))}}else a=
this.editor.selection.getAncestorElement(this.tag);this.dropDown.reset();this._setButton.set("disabled",!0);this.dropDown.set("value",this._getCurrentValues(a))},_onDblClick:function(a){if(a&&a.target&&(a=a.target,(a.tagName?a.tagName.toLowerCase():"")===this.tag&&p.get(a,"href"))){var b=this.editor;this.editor.selection.selectElement(a);b.onDisplayChanged();b._updateTimer&&(b._updateTimer.remove(),delete b._updateTimer);b.onNormalizedDisplayChanged();var c=this.button;setTimeout(function(){c.set("disabled",
!1);c.loadAndOpenDropDown().then(function(){c.dropDown.focus&&c.dropDown.focus()})},10)}}}),u=e("dijit._editor.plugins.ImgLinkDialog",[g],{linkDialogTemplate:"\x3ctable role\x3d'presentation'\x3e\x3ctr\x3e\x3ctd\x3e\x3clabel for\x3d'${id}_urlInput'\x3e${url}\x3c/label\x3e\x3c/td\x3e\x3ctd\x3e\x3cinput dojoType\x3d'dijit.form.ValidationTextBox' regExp\x3d'${urlRegExp}' required\x3d'true' id\x3d'${id}_urlInput' name\x3d'urlInput' data-dojo-props\x3d'intermediateChanges:true'/\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd\x3e\x3clabel for\x3d'${id}_textInput'\x3e${text}\x3c/label\x3e\x3c/td\x3e\x3ctd\x3e\x3cinput data-dojo-type\x3d'dijit.form.ValidationTextBox' required\x3d'false' id\x3d'${id}_textInput' name\x3d'textInput' data-dojo-props\x3d'intermediateChanges:true'/\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd\x3e\x3c/td\x3e\x3ctd\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd colspan\x3d'2'\x3e\x3cbutton data-dojo-type\x3d'dijit.form.Button' type\x3d'submit' id\x3d'${id}_setButton'\x3e${set}\x3c/button\x3e\x3cbutton data-dojo-type\x3d'dijit.form.Button' type\x3d'button' id\x3d'${id}_cancelButton'\x3e${buttonCancel}\x3c/button\x3e\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e",
htmlTemplate:'\x3cimg src\x3d"${urlInput}" _djrealurl\x3d"${urlInput}" alt\x3d"${textInput}" /\x3e',tag:"img",_getCurrentValues:function(a){var b,c;a&&a.tagName.toLowerCase()===this.tag?(b=a.getAttribute("_djrealurl")||a.getAttribute("src"),c=a.getAttribute("alt"),this.editor.selection.selectElement(a,!0)):c=this.editor.selection.getSelectedText();return{urlInput:b||"",textInput:c||""}},_isValid:function(){return this._urlInput.isValid()},_connectTagEvents:function(){this.inherited(arguments);this.editor.onLoadDeferred.then(n.hitch(this,
function(){this.own(l(this.editor.editNode,"mousedown",n.hitch(this,"_selectTag")))}))},_selectTag:function(a){a&&a.target&&(a=a.target,(a.tagName?a.tagName.toLowerCase():"")===this.tag&&this.editor.selection.selectElement(a))},_checkValues:function(a){a&&a.urlInput&&(a.urlInput=a.urlInput.replace(/"/g,"\x26quot;"));a&&a.textInput&&(a.textInput=a.textInput.replace(/"/g,"\x26quot;"));return a},_onDblClick:function(a){if(a&&a.target&&(a=a.target,(a.tagName?a.tagName.toLowerCase():"")===this.tag&&p.get(a,
"src"))){var b=this.editor;this.editor.selection.selectElement(a);b.onDisplayChanged();b._updateTimer&&(b._updateTimer.remove(),delete b._updateTimer);b.onNormalizedDisplayChanged();var c=this.button;setTimeout(function(){c.set("disabled",!1);c.loadAndOpenDropDown().then(function(){c.dropDown.focus&&c.dropDown.focus()})},10)}}});c.registry.createLink=function(){return new g({command:"createLink"})};c.registry.insertImage=function(){return new u({command:"insertImage"})};g.ImgLinkDialog=u;return g})},
"builder/plugins/app-config-templateconfig/_build-generate_module":function(){define(["builder/plugins/app-config-templateconfig/Plugin","dojo/text!builder/plugins/app-config-templateconfig/Plugin.html","dojo/text!builder/plugins/app-config-templateconfig/css/style.css","dojo/i18n!builder/plugins/app-config-templateconfig/nls/strings"],function(){})},"builder/plugins/app-config-templateconfig/Plugin":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/topic builder/BasePlugin builder/dijit/template-config/Template builder/dijit/template-config/utils builder/dijit/TemplateAttributes".split(" "),
function(k,e,p,q,n,l,h,f){return k([n],{baseClass:"plugin-config-template",postCreate:function(){this.inherited(arguments);this.own(q.subscribe("app/appConfigLoaded",e.hitch(this,this._onAppConfigLoaded)));this.own(q.subscribe("app/appConfigChanged",e.hitch(this,this._onAppConfigChanged)));this.pluginManager.getPluginByName("app-config").addRepublishEvent("templateConfigChanged")},_init:function(){this.visible&&this.appConfig&&h.loadAllWidgetConfigs(e.clone(this.appConfig)).then(e.hitch(this,function(d){this._initConfigPanel(d);
this._initPriviewPanel(this.configTemplate.getTemplateConfig())}))},_initConfigPanel:function(d){this.configTemplate&&this.configTemplate.destroy();this.configTemplate=new l({appConfig:d,appInfo:window.appInfo,templateConfig:d.templateConfig});this.configTemplate.on("hasChanged",e.hitch(this,this._onConfigTempalteChanged));p.place(this.configTemplate.domNode,this.configPanel);this.configTemplate.startup()},_initPriviewPanel:function(d){this.previewTemplate&&this.previewTemplate.destroy();this.previewTemplate=
new f({templateConfig:d});p.place(this.previewTemplate.domNode,this.previewPanel);this.previewTemplate.startup()},_onAppConfigLoaded:function(d){this.appConfig=d;this._init()},_onAppConfigChanged:function(d){this.appConfig=d},_onToAppClick:function(){this.pluginManager.getPluginByName("app-config").switchToConfigApp()},_onConfigTempalteChanged:function(){this._initPriviewPanel(this.configTemplate.getTemplateConfig());q.publish("templateConfigChanged",this.configTemplate.getFullTemplateConfig())},
refresh:function(){this._init()}})})},"builder/dijit/template-config/Template":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/html dijit/_WidgetBase dijit/_TemplatedMixin dojo/text!./templates/Template.html dojo/on dojo/dom dojo/_base/lang dojo/dom-construct dojo/dom-style dojo/dom-class dojo/dom-attr dojo/json dojo/query dojo/Deferred dojo/Evented dijit/form/Select ./ConfigNode ./CategoryManager ./Export builder/serviceUtils jimu/utils jimu/WidgetManager jimu/dijit/Message jimu/portalUrlUtils builder/portalUtils jimu/dijit/LoadingShelter ./ExportMessage".split(" "),
function(k,e,p,q,n,l,h,f,d,c,a,b,g,u,m,r,t,v,y,w,z,x,A,C,B,E,D,F,I){return k([q,n,t],{templateString:l,baseClass:"agol-template",configTree:null,nls:null,lastTemplateJson:null,constructor:function(){this.loading=new F({hidden:!0})},postMixInProperties:function(){this.nls=window.builderNls;this.imageFolder="builder/css/images/agoltemplate/";this.arrowImgSrc=isRTL?this.imageFolder+"v_left.png":this.imageFolder+"v_right.png"},postCreate:function(){this.inherited(arguments)},startup:function(){this._beforeInitWork();
f.setSelectable(this.contentPart,!1);this.configTree=new y(this.cleanAppConfig,null,"app","",0);this.categoryManager=new w(this.configTree,this.cleanAppConfig,this.templateConfig);this.drawTree(this.configTree,this.treePart);this.drawCategoryPart();this._afterInitWork()},_beforeInitWork:function(){this.cleanAppConfig=this.appConfig.getCleanConfig(!0);delete this.cleanAppConfig.visitElement;delete this.cleanAppConfig._buildInfo;delete this.cleanAppConfig.agolTemplateJson},_afterInitWork:function(){this.lastTemplateJson=
this.categoryManager.getTemplateJson()},drawTree:function(a,b){var c;b=this.drawDomNode(a,b);if(0!==a.childs.length)for(c=0;c<a.childs.length;c++)this.drawTree(a.childs[c],b)},drawDomNode:function(b,g){var f,e,m,k,l;l=this.categoryManager.getCategoryByField(b.absolutePath);f=c.create("div",{"class":"tree-node-div",idAttr:b.id},g);b.traversal(d.hitch(this,function(a){if(this.categoryManager.getCategoryByField(a.absolutePath))return!0}))||a.set(f,"display","none");"leaf"!==b.nodeType||l||a.set(f,"color",
"#cccccc");e=c.create("div",{"class":"line-label-div "},f);var n=b.label?b.label:b.keyString;n.indexOf("]")===n.length-1&&(n+="\x26lrm;");n=c.create("div",{"class":"line-label-text ",innerHTML:n,title:n},e);"leaf"!==b.nodeType&&p.addClass(n,"leaf-node");l&&"leaf"===b.nodeType&&(m=c.create("div",{"class":"to-right-div "},f),c.create("img",{"class":"to-right-img",src:this.imageFolder+"add_field.png",alt:"img"},m),this.own(h(m,"click",d.hitch(this,function(c){a.set(m,"display","none");this._onToRightDiv(b,
"add",f);c.stopPropagation();this._checkTemplateStatus()}))),-1!==l.findFieldFromDisplay(b.absolutePath)&&a.set(m,"display","none"));k=12*b.level;"leaf"===b.nodeType?isRTL?a.set(e,"paddingRight",k+17+"px"):a.set(e,"paddingLeft",k+17+"px"):isRTL?a.set(e,"paddingRight",k+"px"):a.set(e,"paddingLeft",k+"px");g=c.create("div",{"class":"tree-node-subdiv"},g);a.set(g,"display","none");"leaf"!==b.nodeType?(a.set(f,"cursor","pointer"),this.own(h(f,"click",d.hitch(this,function(b,c,d){"none"===a.get(c,"display")?
(a.set(c,"display","block"),p.addClass(d,"unfold")):(a.set(c,"display","none"),p.removeClass(d,"unfold"));-1===b.absolutePath.search(/widgets\[[0-9]+\]_config$/)||b.jsonObject||this.addWidgetConfigToConfigTree(b.absolutePath)},b,g,n)))):l&&(a.set(f,"cursor","pointer"),this.own(h(f,"click",d.hitch(this,function(a,b){this._onToRightDiv(a,"notAdd",f);b.stopPropagation()},b))));b.lineDomNode=f;b.subLineDomNode=g;b.showSubDivDomNode=void 0;b.toRightDiv=m;0===b.level&&(p.setStyle(f,"display","none"),p.setStyle(g,
"display","block"));return g},drawCategoryPart:function(){e.forEach(this.categoryManager.displayCategorys,function(a){this.drawCategory(a)},this)},drawCategory:function(b){var f,m,k,l,n,p,r;f=c.create("div",{"class":"category-div",categoryDiv:b.name},this.categoryPart);l=c.create("div",{"class":"category-head-div",categoryHeadDiv:b.name},f);n=c.create("div",{"class":"category-fold-div jimu-float-leading"},l);r=c.create("img",{"class":"category-fold-img",src:this.arrowImgSrc,alt:"img"},n);c.create("div",
{"class":"category-title-div jimu-float-leading",innerHTML:b.title},l);m=c.create("div",{"class":"category-oper-div jimu-float-trailing"},l);n=c.create("div",{"class":"category-oper-item-div category-moveup-div jimu-float-leading",innerHTML:"\x3cimg src\x3d'"+this.imageFolder+"moveup.png' alt\x3d'img'\x3e\x3c/img\x3e"},m);p=c.create("div",{"class":"category-oper-item-div category-movedown-div jimu-float-leading",innerHTML:"\x3cimg src\x3d'"+this.imageFolder+"movedown.png' alt\x3d'img'\x3e\x3c/img\x3e"},
m);m=c.create("div",{"class":"category-oper-item-div category-remove-div jimu-float-leading",innerHTML:"\x3cimg src\x3d'"+this.imageFolder+"delete01.png' alt\x3d'img'\x3e\x3c/img\x3e"},m);k=c.create("div",{"class":"fields-div",fieldsDiv:b.name},f);this.own(h(n,"click",d.hitch(this,function(a){this.categoryManager.moveup(b)&&(c.empty(this.categoryPart),this.drawCategoryPart());this._changeHeighlightCategoryHead(b.name);a.stopPropagation();this._checkTemplateStatus()})));this.own(h(p,"click",d.hitch(this,
function(a){this.categoryManager.movedown(b)&&(c.empty(this.categoryPart),this.drawCategoryPart());this._changeHeighlightCategoryHead(b.name);a.stopPropagation();this._checkTemplateStatus()})));this.own(h(m,"click",d.hitch(this,function(d){this.categoryManager.removeCategoryFromDisplay(b);c.destroy(f);e.forEach(b.displayFields,function(b){var c=this.configTree.findNode(b.fieldPath);c&&(c.setTemplateField(b.fieldJson),c.toRightDiv&&a.set(c.toRightDiv,"display","block"))},this);b.displayFields=[];d.stopPropagation();
this._checkTemplateStatus()})));this.own(h(l,"click",d.hitch(this,function(){"block"===a.get(k,"display")?(a.set(k,"display","none"),g.set(r,"src",this.arrowImgSrc)):(a.set(k,"display","block"),g.set(r,"src",this.imageFolder+"v.png"));this._changeHeighlightCategoryHead(b.name)})));this.drawFields(b,f,k);a.set(k,"display","none")},drawFields:function(a,b,c){e.forEach(a.displayFields,function(d){this.drawField(a,b,c,d)},this)},addWidgetConfigToConfigTree:function(a){var b=new r,c=a.search(/widgets\[[0-9]+\]/),
g=a.slice(c,a.length).indexOf("]"),c=a.slice(0,c+g+1);a=c+"_config";var c=this.configTree.findNode(c),f=this.configTree.findNode(a);a=this.appConfig.getConfigElementById(c.jsonObject.id);C.getInstance().tryLoadWidgetConfig(a).then(d.hitch(this,function(a){if(a){var c;f.jsonObject=a;a.geocoder&&a.geocoder.geocoders&&delete a.geocoder.geocoders;for(c in a)a.hasOwnProperty(c)&&(c=f.addChild(a[c],c,f.absolutePath,f.level),this.drawTree(c,f.subLineDomNode))}b.resolve()}));return b},drawField:function(b,
f,m,k){var l,n,r,t,q,u,w,z;this.configTree.findNode(k.fieldPath);z=y.getDefaultTemplateField(k.fieldPath,k.fieldJson.type,k.fieldJson.label);for(l in k.fieldJson)k.fieldJson.hasOwnProperty(l)&&(z[l]=k.fieldJson[l]);l=c.create("div",{"class":"field-div",fieldDiv:k.fieldPath},m);this.own(h(l,"click",d.hitch(this,function(b,c){function g(){f=this.configTree.findNode(k);e=p.position(this.treePart).y;m=p.position(f.lineDomNode).y;h=m-e;(0>h||h>a.get(this.categoryPart,"height"))&&f.lineDomNode.scrollIntoView(!1);
this._changeHeighlightFieldDomNode(k);this._changeHeighlightTreeDomNode(f.lineDomNode);this._changeHeighlightCategoryHead(c.name)}var f,e,m,h,k=b.fieldPath;if(f=this.configTree.findNode(k)){for(;f;)a.set(f.subLineDomNode,"display","block"),f=f.parentNode;d.hitch(this,g)()}else this.addWidgetConfigToConfigTree(k).then(d.hitch(this,function(){for(f=this.configTree.findNode(k);f;)a.set(f.subLineDomNode,"display","block"),f=f.parentNode;d.hitch(this,g)()}))},k,b)));b=c.create("div",{"class":"field-head-div"},
l);r=c.create("div",{"class":"field-fold-div"},b);t=c.create("img",{"class":"field-fold-img",src:this.arrowImgSrc,alt:"img"},r);r=d.hitch(this,function(a){var b="",c=a.split("_"),g=d.clone(c);e.forEach(c,function(a,b){var d;d="";if(-1!==a.search(/widgets\[[0-9]+\]$/)||-1!==a.search(/groups\[[0-9]+\]$/)){for(a=0;a<=b;a++)d+=c[a]+"_";d=this.configTree.findNode(d.slice(0,-1));g[b]=d.label}},this);for(a=1;a<g.length;a++)b+=g[a]+"_";return b.slice(0,-1)})(k.fieldPath);c.create("div",{"class":"field-head-title-div",
innerHTML:r,title:r},b);q=c.create("div",{"class":"field-opers-div"},b);r=c.create("div",{"class":"field-oper-div jimu-float-trailing",innerHTML:"\x3cimg class\x3d'field-oper-img' src\x3d'"+this.imageFolder+"delete01.png' alt\x3d'img'\x3e\x3c/img\x3e"},q);u=c.create("div",{"class":"field-oper-div jimu-float-trailing",innerHTML:"\x3cimg class\x3d'field-oper-img' src\x3d'"+this.imageFolder+"movedown.png' alt\x3d'img'\x3e\x3c/img\x3e"},q);q=c.create("div",{"class":"field-oper-div jimu-float-trailing",
innerHTML:"\x3cimg class\x3d'field-oper-img' src\x3d'"+this.imageFolder+"moveup.png' alt\x3d'img'\x3e\x3c/img\x3e"},q);var x=c.create("div",{"class":"field-fixed-content-div",style:"display:none;"},l);n=c.create("div",{"class":"field-box-div"},x);c.create("span",{"class":"field-label-span",innerHTML:this.nls.fieldLabel},n);n=c.create("input",{"class":"jimu-input field-label-input",type:"text",value:z.label},n);this.own(h(n,"change",d.hitch(this,function(a,b){this._onFieldChange(a,{key:"label",value:A.stripHTML(b.value)})},
k.fieldPath,n)));n=c.create("div",{"class":"field-box-div"},x);c.create("span",{"class":"field-type-span",innerHTML:this.nls.fieldType},n);n=(new v({name:"selectFieldType","class":"field-type-select",options:[{label:this.nls.typeSelectString,value:"string"},{label:this.nls.typeSelectBoolean,value:"boolean"},{label:this.nls.typeSelectNumber,value:"number"},{label:this.nls.typeSelectOptions,value:"options"},{label:this.nls.typeSelectColor,value:"color"}],value:z.type})).placeAt(n);w=c.create("div",
{"class":"field-content-div",style:"display:none;"},l);this.drawFieldContent(k.fieldPath,z,w,n.getValue());this.own(h(n,"change",d.hitch(this,function(b,c,d,g){this.drawFieldContent(b,c,d,g);this._onFieldChange(b,{key:"type",value:g});a.set(d,"display","block")},k.fieldPath,z,w)));this.own(h(b,"click",d.hitch(this,function(){"block"===a.get(w,"display")?(a.set(w,"display","none"),a.set(x,"display","none"),g.set(t,"src",this.arrowImgSrc)):(a.set(w,"display","block"),a.set(x,"display","block"),g.set(t,
"src",this.imageFolder+"v.png"))})));this.own(h(r,"click",d.hitch(this,function(b,g,f,e){var m=b.fieldPath,h=this.configTree.findNode(m);h?(h.setTemplateField(b.fieldJson),h.toRightDiv&&a.set(h.toRightDiv,"display","block")):this.addWidgetConfigToConfigTree(m).then(d.hitch(this,function(){var a=this.configTree.findNode(m);b.fieldJson&&a.setTemplateField(b.fieldJson)}));h=this.categoryManager.getCategoryByField(m);h.removeFieldFromDisplay(m);c.destroy(g);h.displayIsEmpty()&&(this.categoryManager.removeCategoryFromDisplay(h),
c.destroy(f));e.stopPropagation();this._checkTemplateStatus()},k,l,f)));this.own(h(q,"click",d.hitch(this,function(a,b,d){var g=this.categoryManager.getCategoryByField(a);g.moveup(a)&&(c.empty(b),this.drawFields(g,f,b),this._changeHeighlightFieldDomNode(a));d.stopPropagation();this._checkTemplateStatus()},k.fieldPath,m)));this.own(h(u,"click",d.hitch(this,function(a,b,d){var g=this.categoryManager.getCategoryByField(a);g.movedown(a)&&(c.empty(b),this.drawFields(g,f,b),this._changeHeighlightFieldDomNode(a));
d.stopPropagation();this._checkTemplateStatus()},k.fieldPath,m)))},drawFieldContent:function(a,b,g,f){var m,k,l,n;c.empty(g);"color"!==f&&(c.create("span",{"class":"field-tooltip-span",innerHTML:this.nls.tooltip},g),m=c.create("input",{"class":"jimu-input field-tooltip-input",type:"text",value:b.tooltip},g),this.own(h(m,"change",d.hitch(this,function(a,b){this._onFieldChange(a,{key:"tooltip",value:b.value})},a,m))),c.create("br",{},g),"string"===f?(c.create("span",{"class":"field-string-ph-span",
innerHTML:this.nls.placeholder},g),f=c.create("input",{"class":"jimu-input field-string-ph-input",type:"text",value:b.placeHolder},g),this.own(h(f,"change",d.hitch(this,function(a,b){this._onFieldChange(a,{key:"placeHolder",value:b.value})},a,f))),f=c.create("div",{"class":"field-text-type-div"},g),c.create("span",{"class":"field-text-type-span",innerHTML:this.nls.textBoxType},f),b=(new v({name:"stringOptions","class":"field-string-options",options:[{label:this.nls.textBoxTypeTextbox,value:"textbox"},
{label:this.nls.textBoxTypeTextarea,value:"textarea"},{label:this.nls.textBoxTypeRichtext,value:"richtext"}],value:b.stringFieldOption})).placeAt(f),this.own(h(b,"change",d.hitch(this,function(a,b){this._onFieldChange(a,{key:"stringFieldOption",value:b})},a)))):"number"===f?(c.create("span",{"class":"field-num-min-span",innerHTML:this.nls.minvalue},g),k=c.create("input",{"class":"jimu-input field-num-input field-num-min-input",type:"text",value:b.constraints.min},g),c.create("br",{},g),c.create("span",
{"class":"field-num-max-span",innerHTML:this.nls.maxvalue},g),l=c.create("input",{"class":"jimu-input field-num-input field-num-max-input",type:"text",value:b.constraints.max},g),c.create("br",{},g),c.create("span",{"class":"field-num-places-span",innerHTML:this.nls.places},g),n=c.create("input",{"class":"jimu-input field-num-input field-num-places-input",type:"text",value:b.constraints.places},g),this.own(h(k,"change",d.hitch(this,function(a){this._onFieldChange(a,{key:"constraints",value:{min:k.value,
max:l.value,places:n.value}})},a))),this.own(h(l,"change",d.hitch(this,function(a){this._onFieldChange(a,{key:"constraints",value:{min:k.value,max:l.value,places:n.value}})},a))),this.own(h(n,"change",d.hitch(this,function(a){this._onFieldChange(a,{key:"constraints",value:{min:k.value,max:l.value,places:n.value}})},a)))):"options"===f&&(f=c.create("div",{"class":"field-options-add-div"},g),m=c.create("div",{"class":"field-options-add-content"},f),c.create("div",{"class":"field-options-add-img-div jimu-float-leading",
innerHTML:"\x3cimg src\x3d'"+this.imageFolder+"add_link.png' alt\x3d'img'\x3e\x3c/img\x3e"},m),c.create("div",{"class":"field-options-add-text-div jimu-float-leading",innerHTML:this.nls.addNewOption},m),e.forEach(b.options,function(b){this._onFieldOptionsAdd(a,g,b.label,b.value)},this),this.own(h(f,"click",d.hitch(this,this._onFieldOptionsAdd,a,g,"","")))))},_changeHeighlightFieldDomNode:function(a){m(".field-div",this.categoryPart).removeClass("field-heighlight-div");b.add(m('div[fieldDiv\x3d"'+
a+'"]',this.categoryPart)[0],"field-heighlight-div")},_changeHeighlightTreeDomNode:function(a){this.heighlightTreeDomNode&&b.remove(this.heighlightTreeDomNode,"tree-node-heighlight-div");b.add(a,"tree-node-heighlight-div");this.heighlightTreeDomNode=a},_changeHeighlightCategoryHead:function(a){m(".category-head-div",this.categoryPart).removeClass("category-head-div-selected");a=m("div[categoryHeadDiv\x3d'"+a+"']",this.categoryPart)[0];p.addClass(a,"category-head-div-selected")},_onToRightDiv:function(b,
c,d){var g,f,e=this.categoryManager.getCategoryByField(b.absolutePath);g=this.categoryManager.findDisplayCategory(e.name);f={fieldPath:b.absolutePath,fieldJson:b.getTemplateField()};if(-1===g){if("add"!==c)return;this.categoryManager.addCategoryToDisplay(e);e.addFieldToDisplay(f);this.drawCategory(e);g=m("div[fieldsDiv\x3d'"+e.name+"']",this.categoryPart)[0]}else if(-1===e.findFieldFromDisplay(b.absolutePath)){if("add"!==c)return;e.addFieldToDisplay(f);c=m("div[categoryDiv\x3d'"+e.name+"']",this.categoryPart)[0];
g=m("div[fieldsDiv\x3d'"+e.name+"']",this.categoryPart)[0];this.drawField(e,c,g,f)}else g=m("div[fieldsDiv\x3d'"+e.name+"']",this.categoryPart)[0];a.set(g,"display","block");f=m('div[fieldDiv\x3d"'+b.absolutePath+'"]',this.categoryPart)[0];this._changeHeighlightCategoryHead(e.name);this._changeHeighlightFieldDomNode(b.absolutePath);this._changeHeighlightTreeDomNode(d);b=p.position(this.categoryPart).y;b=p.position(f).y-b;(0>b||b>a.get(this.categoryPart,"height"))&&f.scrollIntoView(!1)},_onFieldChange:function(a,
b){var c=this.configTree.findNode(a);a=this.categoryManager.getCategoryByField(a).getDisplayField(a);a.fieldJson[b.key]=b.value;c.templateField=a.fieldJson;this._checkTemplateStatus()},_onFieldOptionsAdd:function(a,b,g,f){var e=c.create("div",{"class":"field-options-div"},b),m=c.create("div",{"class":"field-box-div"},e);c.create("div",{"class":"field-options-label-div jimu-float-leading",innerHTML:this.nls.labelStr},m);m=c.create("input",{"class":"jimu-input field-options-label-input jimu-float-leading",
type:"text",value:g},m);this.own(h(m,"change",d.hitch(this,function(a){this._onFieldChange(a,{key:"options",value:this._getFieldOptions(b)})},a)));m=c.create("div",{"class":"field-box-div"},e);c.create("div",{"class":"field-options-value-div jimu-float-leading",innerHTML:this.nls.value},m);f=c.create("input",{"class":"jimu-input field-options-value-input jimu-float-leading",type:"text",value:f},m);this.own(h(f,"change",d.hitch(this,function(a){this._onFieldChange(a,{key:"options",value:this._getFieldOptions(b)})},
a)));f=c.create("div",{"class":"jimu-icon jimu-icon-delete field-options-remove-div jimu-float-leading"},m);this.own(h(f,"click",d.hitch(this,function(a){c.destroy(e);this._onFieldChange(a,{key:"options",value:this._getFieldOptions(b)})},a)))},_getFieldOptions:function(a){var b=[];m(".field-options-div",a).forEach(d.hitch(this,function(a){b.push({label:m(".field-options-label-input",a).attr("value")[0],value:m(".field-options-value-input",a).attr("value")[0]})}));return b},_onReviewJsonDivClick:function(){var b=
this.categoryManager.getTemplateJson();this.showJsonWidget.setConfig(b);g.set(this.rightPartHeadText,"innerHTML",this.nls.rightPartHead2);a.set(this.showJsonDiv,"display","block");a.set(this.reviewJsonDiv,"display","none");a.set(this.reviewJsonBackDiv,"display","block")},_onReviewJsonBackDivClick:function(){g.set(this.rightPartHeadText,"innerHTML",this.nls.rightPartHead);a.set(this.reviewJsonDiv,"display","block");a.set(this.reviewJsonBackDiv,"display","none");a.set(this.showJsonDiv,"display","none")},
_saveAgolTemplate:function(a){var b=new r,c=u.stringify(this.categoryManager.getTemplateJson("fullJson")),g={itemId:a?a:this.appInfo.agolTemplateInfo?this.appInfo.agolTemplateInfo.itemId:null,json:c};x.saveAgolTemplate(this.appInfo,g).then(d.hitch(this,function(){this.appInfo.agolTemplateInfo=g;this.lastTemplateJson=this.categoryManager.getTemplateJson();b.resolve()}),function(a){new B({message:a});b.reject()});return b},_onDownloadNodeClick:function(){},_updateAgolTemplate:function(){var a=new r,
b=this.hasChanged(),c=u.stringify(this.categoryManager.getTemplateJson());this.loading.show(this.nls.updating);b?this._saveAgolTemplate().then(d.hitch(this,function(){this._checkTemplateStatus();a.resolve()})):a.resolve();a.then(d.hitch(this,function(){D.getPortal(window.portalUrl).getUser().then(d.hitch(this,function(a){a.updateItem(this.appInfo.agolTemplateInfo.itemId,{text:c}).then(d.hitch(this,function(){this.loading.hide();I._exportedMessage({itemId:this.appInfo.agolTemplateInfo.itemId,message:this.nls.exportSuccessfulUpdate},
this.nls.exportMessageTitleUpdate,this.nls)}),d.hitch(this,function(a){this.loading.hide();console.error(a.message||a);I._exportedMessage({itemId:null,message:this.nls.exportTemplateFailed7},this.nls.exportMessageTitleUpdate,this.nls)}))}),d.hitch(this,function(a){this.loading.hide();console.error(a.message||a);I._exportedMessage({itemId:null,message:this.nls.exportTemplateFailed6},this.nls.exportMessageTitleUpdate,this.nls)}))}))},_exportTemplate:function(a){var b="",c=u.stringify(this.categoryManager.getTemplateJson()),
g=u.stringify(this.categoryManager.getTemplateJson("fullJson"));window.isXT?b=E.getProtocol(window.portalUrl)+"://"+window.location.host+path+"apps/"+this.appInfo.id:(b=E.getStandardPortalUrl(window.portalUrl),b="HTML3D"===window.appInfo.appType?b+"/apps/webappviewer3d/index.html?id\x3d"+this.appInfo.id:b+"/apps/webappviewer/index.html?id\x3d"+this.appInfo.id);(new z({_templateUrl:b,_temlateJson:c,_fullTemplateJson:g,nls:this.nls,_afterAddItemOfExportCallback:d.hitch(this,this._afterAddItemOfExportCallback),
appInfo:this.appInfo,appConfig:this.cleanAppConfig,isExportWABTemplate:a})).startup()},_afterAddItemOfExportCallback:function(a){this._saveAgolTemplate(a).then(d.hitch(this,function(){this._checkTemplateStatus();this.emit("exported",!0)}))},_checkTemplateStatus:function(){var a=this.hasChanged();this.emit("hasChanged",a)},exportOrUpdateAGOLTemplate:function(){this.appInfo.agolTemplateInfo&&this.appInfo.agolTemplateInfo.itemId?this._updateAgolTemplate():this._exportTemplate(!1)},exportWABTemplate:function(){this._exportTemplate(!0)},
saveAgolTemplate:function(){return this._saveAgolTemplate()},hasChanged:function(){return!A.isEqual(this.lastTemplateJson,this.categoryManager.getTemplateJson())},getTemplateConfig:function(){return this.categoryManager.getTemplateJson()},getFullTemplateConfig:function(){return this.categoryManager.getTemplateJson("fullJson")}})})},"builder/dijit/template-config/ConfigNode":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/_base/array"],function(k,e,p){var q={},n=k([],{id:null,parentNode:null,
keyString:null,absolutePath:null,childs:null,nodeType:null,templateField:null,jsonObject:null,level:null,label:null,isVisible:!1,constructor:function(k,h,f,d,c){var a;this.parentNode=h;this.keyString=f;this.childs=[];this.absolutePath=""===d?f:d+"_"+f;this.jsonObject=k;this.level=c;this.initId();this.initLabel();this.initTemplateField(k);if("object"!==typeof k||null===k)this.nodeType="leaf";else if(e.isArrayLike(k))for(this.nodeType="array",h=0;h<k.length;h++)this.addChild(k[h],this.keyString+"["+
h+"]",d,c);else for(a in this.nodeType="normal",k)k.hasOwnProperty(a)&&"function"!==typeof k[a]&&this.addChild(k[a],a,this.absolutePath,c)},initId:function(){var k,h;k=this.absolutePath.search(/_widgets\[[0-9]+\]/);h=this.absolutePath.search(/_groups\[[0-9]+\]/);-1!==k||-1!==h?-1!==this.absolutePath.search(/_widgets\[[0-9]+\]$/)||-1!==this.absolutePath.search(/_groups\[[0-9]+\]$/)?this.id=this.parentNode.id+"["+this.jsonObject.id+"]":e.isArrayLike(this.parentNode.jsonObject)?this.id=this.parentNode.parentNode.id+
"_"+this.keyString:this.id=this.parentNode.id+"_"+this.keyString:this.id=this.absolutePath},initLabel:function(){this.label=this.keyString;if(-1!==this.absolutePath.search(/widgets\[[0-9]+\]$/)||-1!==this.absolutePath.search(/groups\[[0-9]+\]$/))this.label=this.jsonObject.label},initTemplateField:function(e){this.templateField=n.getDefaultTemplateField(this.absolutePath,typeof e,this.label);n.setDefaultValue(this.absolutePath,e,this.id)},getTemplateFieldDefaultValue:function(){return this.templateField.defaultValue},
getTemplateField:function(e){e=e?e:this.templateField;var h={type:e.type,fieldName:this.id,label:e.label,tooltip:e.tooltip};"leaf"!==this.nodeType&&(h.fieldName+="--");switch(h.type){case "string":h.stringFieldOption=e.stringFieldOption;h.placeHolder=e.placeHolder;break;case "number":h.constraints=e.constraints||{min:0,max:100,places:0};break;case "options":h.options=e.options||[{label:"label1",value:"value1"}]}return h},setTemplateField:function(e){this.templateField.type=e.type;this.templateField.label=
e.label;this.templateField.tooltip=e.tooltip;"leaf"!==this.nodeType&&(this.templateField.fieldName=this.templateField.fieldName.slice(0,this.templateField.fieldName.length-2));switch(this.templateField.type){case "string":this.templateField.stringFieldOption=e.stringFieldOption;this.templateField.placeHolder=e.placeHolder;break;case "number":this.templateField.constraints=e.constraints;break;case "options":this.templateField.options=e.options}return e},addChild:function(e,h,f,d){e=new n(e,this,h,
f,d+1);this.childs.push(e);return e},isLeaf:function(){var e=!1;this.childs&&0<this.childs.length&&(e=!0);return e},findNode:function(e){var h=[],f,d,c;e.split("_").forEach(function(a){var b=a.search(/\[[0-9]+\]/);-1!==b&&h.push(a.slice(0,b));h.push(a)});d=this;if(d.keyString!==h[0])return null;for(e=1;e<h.length;e++){c=d.childs.length;for(f=0;f<c;f++)if(d.childs[f].keyString===h[e]){d=d.childs[f];break}if(f===c)return null}return d},setVisible:function(){for(var e=this;e;)e.isVisible=!0,e=e.parentNode},
findNodeById:function(e){var h=null;this.traversal(function(f){if(f.id===e)return h=f,!0});return h},traversal:function(e){if(e(this))return!0;for(var h=0;h<this.childs.length;h++)if(this.childs[h].traversal(e))return!0},deserialize:function(e){e&&p.forEach(e.configurationSettings,function(e){p.forEach(e.fields,function(f){this.findNode(f.fieldName).setTemplateField(f)},this)},this)}});n.getDefaultValue=function(e){return q[e]};n.setDefaultValue=function(e,h,f){var d=null,d=h;"app_portalUrl"===e||
"app_map_itemId"===e?d=null:"app_title"===e?d="":"app_subtitle"===e?d="":"object"===typeof h&&(d=!1);q[f]=d};n.defaultValueExisted=function(e){return void 0===q[e]?!1:!0};n.getDefaultTemplateField=function(e,h,f){e="string";switch(h){case "number":e="number";break;case "boolean":e="boolean";break;case "object":e="boolean",f="disable"}return{type:e,label:f,tooltip:"",stringFieldOption:"textbox",placeHolder:f,constraints:{min:0,max:100,places:0},options:[{label:"label1",value:"value1"}]}};return n})},
"builder/dijit/template-config/CategoryManager":function(){define(["dojo/_base/declare","dojo/_base/array","./ConfigNode","./Category"],function(k,e,p,q){return k([],{categorys:null,displayCategorys:null,constructor:function(e,k,h){this.configTree=e;this.categorys=[];this.displayCategorys=[];this.initCategorys(k,e);this.deserialize(h,e)},initCategorys:function(k,l){var h=new q(l,"Attribute","Attribute",["app_title","app_subtitle","app_logo","app_links"],[],["app_title","app_subtitle"]);this.categorys.push(h);
e.forEach(k.widgetOnScreen.widgets,function(f,d){var c="ScreenWidget_"+f.id;d="app_widgetOnScreen_widgets["+d+"]";d=[d+"_label",d+"_visible",d+"_config",d+"_openAtStart"];var a=[];f.uri&&this.categorys.push(new q(l,c,f.label+" widget",d,a))},this);e.forEach(k.widgetOnScreen.groups,function(f,d){var c="ScreenWidgetGroup_"+f.id,a="app_widgetOnScreen_groups["+d+"]",b=[a+"_label",a+"_visible",a+"_openAtStart"];e.forEach(f.widgets,function(c,d){b.push(a+"_widgets["+d+"]_label");b.push(a+"_widgets["+d+
"]_visible");b.push(a+"_widgets["+d+"]_openAtStart");b.push(a+"_widgets["+d+"]_config")});this.categorys.push(new q(l,c,f.label,b,[]))},this);e.forEach(k.widgetPool.widgets,function(f,d){var c="widgetPoolWidget_"+f.id;d="app_widgetPool_widgets["+d+"]";d=[d+"_label",d+"_visible",d+"_config",d+"_openAtStart"];var a=[];f.uri&&this.categorys.push(new q(l,c,f.label+" widget",d,a))},this);e.forEach(k.widgetPool.groups,function(f,d){var c="widgetPoolGroup_"+f.id,a="app_widgetPool_groups["+d+"]",b=[a+"_label",
a+"_visible",a+"_openAtStart"];e.forEach(f.widgets,function(c,d){b.push(a+"_widgets["+d+"]_label");b.push(a+"_widgets["+d+"]_visible");b.push(a+"_widgets["+d+"]_openAtStart");b.push(a+"_widgets["+d+"]_config")});this.categorys.push(new q(l,c,f.label,b,[]))},this);this.displayCategorys.push(h)},getCategoryByName:function(e){return this.categorys[this.findCategory(e)]},getCategoryByField:function(e){var k;for(k=0;k<this.categorys.length;k++)if(this.categorys[k].hasField(e))return this.categorys[k];
return null},findCategory:function(e){return this._find(e,this.categorys)},findDisplayCategory:function(e){return this._find(e,this.displayCategorys)},_find:function(e,k){var h;for(h=0;h<k.length&&k[h].name!==e;h++);return h===k.length?-1:h},addCategoryToDisplay:function(e){-1===this.findDisplayCategory(e.name)&&this.displayCategorys.push(e)},removeCategoryFromDisplay:function(e){e=this.findDisplayCategory(e.name);0<=e&&this.displayCategorys.splice(e,1)},moveup:function(e){var k;e=this.findDisplayCategory(e.name);
return 0<e?(k=this.displayCategorys[e],this.displayCategorys[e]=this.displayCategorys[e-1],this.displayCategorys[e-1]=k,!0):!1},movedown:function(e){var k;e=this.findDisplayCategory(e.name);return 0<=e&&e<this.displayCategorys.length-1?(k=this.displayCategorys[e],this.displayCategorys[e]=this.displayCategorys[e+1],this.displayCategorys[e+1]=k,!0):!1},getTemplateJson:function(k){var l={configurationSettings:[],values:{}};e.forEach(this.displayCategorys,function(h,f){var d={category:h.title,fields:[]};
"fullJson"===k&&(d.categoryName=h.name);e.forEach(h.displayFields,function(c,a){var b=this.configTree.findNode(c.fieldPath).getTemplateField(c.fieldJson);d.fields[a]=b;l.values[b.fieldName]=p.getDefaultValue(c.fieldJson.fieldName)},this);l.configurationSettings[f]=d},this);return l},deserialize:function(k,l){if(k){e.forEach(this.displayCategorys,function(f){f.displayFields=[]});this.displayCategorys=[];e.forEach(k.configurationSettings,function(f){var d=this.getCategoryByName(f.categoryName),c=0;
d&&(c=d.deserialize(f.fields,l),0<c&&this.displayCategorys.push(d))},this);var h;k=k.values;for(h in k)k.hasOwnProperty(h)&&"function"!==typeof k[h]&&!p.defaultValueExisted(h)&&p.setDefaultValue(null,k[h],h)}}})})},"builder/dijit/template-config/Category":function(){define(["dojo/_base/declare","dojo/_base/array"],function(k,e){return k([],{name:null,title:null,includeFields:null,excludeFields:null,displayFields:null,constructor:function(k,q,n,l,h,f){this.name=q;this.title=n;this.includeFields=l;
this.excludeFields=h;this.displayFields=[];e.forEach(f,function(d){var c=k.findNode(d);c&&this.displayFields.push({fieldPath:d,fieldJson:c.getTemplateField()})},this)},hasField:function(e){var k=!1,n;for(n=0;n<this.includeFields.length;n++)if(0===e.indexOf(this.includeFields[n])){k=!0;break}for(n=0;n<this.excludeFields.length;n++)if(0===e.indexOf(this.excludeFields[n])){k=!1;break}return k},getDisplayField:function(e){e=this.findFieldFromDisplay(e);return-1!==e?this.displayFields[e]:null},findFieldFromDisplay:function(e){var k;
for(k=0;k<this.displayFields.length;k++)if(this.displayFields[k].fieldPath===e)return k;return-1},addFieldToDisplay:function(e){var k;k=this.findFieldFromDisplay(e.fieldPath);-1===k?this.displayFields.push({fieldPath:e.fieldPath,fieldJson:e.fieldJson}):this.displayFields[k].fieldJson=e.fieldJson},removeFieldFromDisplay:function(e){var k;k=this.findFieldFromDisplay(e);0<=k&&this.displayFields.splice(k,1);return e},moveup:function(e){var k;e=this.findFieldFromDisplay(e);return 0<e?(k=this.displayFields[e],
this.displayFields[e]=this.displayFields[e-1],this.displayFields[e-1]=k,!0):!1},movedown:function(e){var k;e=this.findFieldFromDisplay(e);return 0<=e&&e<this.displayFields.length-1?(k=this.displayFields[e],this.displayFields[e]=this.displayFields[e+1],this.displayFields[e+1]=k,!0):!1},displayIsEmpty:function(){return 0===this.displayFields.length},deserialize:function(k,q){this.displayFields=[];e.forEach(k,function(e){var k;k=e.fieldName.replace(/\//g,"_");(k=q.findNodeById(k))&&this.displayFields.push({fieldPath:k.absolutePath,
fieldJson:e})},this);return this.displayFields.length}})})},"builder/dijit/template-config/Export":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dijit/dijit dijit/_WidgetBase dijit/_TemplatedMixin dojo/text!./templates/Export.html dojo/Deferred dojo/promise/all dojo/dom-style dojo/dom-attr dojo/json jimu/dijit/Message jimu/dijit/LoadingShelter builder/portalUtils ./ExportMessage jimu/dijit/Popup builder/dijit/ItemInfo builder/serviceUtils builder/PluginManager".split(" "),
function(k,e,p,q,n,l,h,f,d,c,a,b,g,u,m,r,t,v,y,w){return k([n,l],{templateString:h,baseClass:"export-agoltemplate",_templateUrl:null,_temlateJson:null,_fullTemplateJson:null,pluginManager:null,_afterAddItemOfExportCallback:null,isExportWABTemplate:null,appInfo:null,constructor:function(){this.pluginManager=w.getInstance()},startup:function(){this.isExportWABTemplate?this.popupWABTemplateDlg():this.popupAGOLTemplateDlg()},popupAGOLTemplateDlg:function(a){this.isExportWABTemplate=!1;this._initToAGOLTemplateDlgPage();
this.popup=new t({content:this,container:"main-page",titleLabel:this.nls.title2,width:669,autoHeight:!0,buttons:[{label:this.nls.ok,onClick:e.hitch(this,this._onNextClick)},{label:this.nls.cancel,classNames:["jimu-btn-vacation"],onClick:e.hitch(this,this._onCancelClick)}]});this.loading=new u({hidden:!0});this.loading.placeAt(this.popup.domNode)},popupWABTemplateDlg:function(){this.isExportWABTemplate=!0;this._initToWABTemplateDlgPage();this.popup=new t({content:this,container:"main-page",titleLabel:this.nls.exportPopupTitleForWab,
width:669,autoHeight:!0,buttons:[{label:this.nls.ok,onClick:e.hitch(this,this._onNextClick)},{label:this.nls.cancel,classNames:["jimu-btn-vacation"],onClick:e.hitch(this,this._onCancelClick)}]});this.loading=new u({hidden:!0});this.loading.placeAt(this.popup.domNode)},_initToAGOLTemplateDlgPage:function(){window.isXT&&(a.set(this.explain1,"innerHTML",this.nls.explain1),c.set(this.explain1,"display","block"));this.itemInfoDijit=new v({itemInfo:this.getDefaultAppInfo()});this.itemInfoDijit.placeAt(this.itemInfoBox)},
_initToWABTemplateDlgPage:function(){var b=this.getDefaultAppInfo();window.isXT&&(a.set(this.templateTitle,"innerHTML",this.nls.templateTitleForWAB),b.tags=void 0,b.folderId=void 0,b.sharing=void 0,b.thumbnail="/webappbuilder/builder/images/templatethumbnail.jpg");this.itemInfoDijit=new v({itemInfo:b});this.itemInfoDijit.placeAt(this.itemInfoBox)},getDefaultAppInfo:function(){return{name:"",description:this.nls.templateDefaultSnippet,tags:["template"],folderId:"",sharing:void 0,thumbnail:void 0}},
_onNextClick:function(){this.isExportWABTemplate?this._exportWABTemplate():this._exportAGOLTemplate()},_onCancelClick:function(){this.close()},close:function(){this.popup.close()},_exportAGOLTemplate:function(){var a=this.itemInfoDijit.getProperties();a.name&&a.tags?(this.loading.show(),this.exportAGOLTemplate(a,this._templateUrl,this._fullTemplateJson,this._afterAddItemOfExportCallback).then(e.hitch(this,function(a){this.close();this.loading.hide();r._exportedMessage(a,this.nls.exportMessageTitle,
this.nls)}),e.hitch(this,function(a){this.close();this.loading.hide();r._exportedMessage(a,this.nls.exportMessageTitle,this.nls)}))):new g({message:this.nls.noTitleMessage})},_exportWABTemplate:function(){var a=this.itemInfoDijit.getProperties();if(a.name){this.loading.show();var c=this.pluginManager.getPluginByName("app-list");this.exportWABTemplate(a,b.parse(this._fullTemplateJson),this._afterAddItemOfExportCallback).then(e.hitch(this,function(){this.close();this.loading.hide();c&&(c._onSwitchToTemplateContent(),
c.refreshTemplatePage());new t({content:this.nls.exportSuccessfulForWab,titleLabel:this.nls.exportPopupTitleForWab,width:"600",autoHeight:!0,buttons:[{label:this.nls.ok}]})}),e.hitch(this,function(){this.close();this.loading.hide()}))}else new g({message:this.nls.noTitleMessage})},exportAGOLTemplate:function(a,b,c,g){var h=new f,k=new f,l=new f,n=new f,r="http://"+window.location.host+window.location.pathname,p=r.indexOf("index.html");-1!==p&&(r=r.slice(0,p));var r=r+"builder/css/images/agoltemplate/templateThumbnail.jpg",
t=m.getPortal(window.portalUrl);t.getUser().then(e.hitch(this,function(b){var c={q:"owner:"+b.username+" title:"+a.name+' type:"Web Mapping Application"'},d=builderNls.titleExist.replace("${TITLE}",a.name);t.queryItems(c).then(e.hitch(this,function(a){0<a.total?(k.reject(),h.reject({itemId:null,message:d})):k.resolve(b)}),e.hitch(this,function(a){k.reject(a);console.error(a.message||a);h.reject({itemId:null,message:this.nls.exportTemplateFailed5})}))}),e.hitch(this,function(a){k.reject(a);console.error(a.message||
a);h.reject({itemId:null,message:this.nls.exportTemplateFailed5})}));k.then(e.hitch(this,function(d){var f={title:a.name,snippet:a.description,tags:a.tags,url:b,thumbnailurl:r,type:"Web Mapping Application",typeKeywords:"Configurable, JavaScript, selfConfigured",text:c},m="";"HTML"===window.appInfo.appType?m="WAB2D":"HTML3D"===window.appInfo.appType&&(m="WAB3D, 3Dscene");f.typeKeywords=(window.isXT?"Configurable, JavaScript, WABTemplate, WABTemplateFromXT, ":"Configurable, JavaScript, selfConfigured, WABTemplate, WABTemplateFromAGOL, ")+
m;a.folderId===d.username&&(a.folderId="");d.addItem(f,a.folderId).then(e.hitch(this,function(a){a.success?(l.resolve(a),g(a.id)):(console.error(a.message||""),l.reject(this.nls.exportTemplateFailed1))}),e.hitch(this,function(a){l.reject(a);console.error(a.message||a);h.reject({itemId:null,message:this.nls.exportTemplateFailed1})}))}));m.getTemplatesGroup(window.portalUrl).then(e.hitch(this,function(a){n.resolve(a)}),e.hitch(this,function(a){n.reject(a);console.error(a.message||a);h.reject({itemId:null,
message:this.nls.exportTemplateFailed2})}));d({user:k,itemRes:l,templateGroup:n}).then(e.hitch(this,function(b){b.user.shareItem({groups:b.templateGroup.id},b.itemRes.id,a.folderId).then(e.hitch(this,function(a){-1===a.notSharedWith.indexOf(b.templateGroup.id)?h.resolve({itemId:b.itemRes.id,message:this.nls.exportSuccessful}):h.reject({itemId:b.itemRes.id,message:this.nls.exportTemplateFailed3,type:"no_permission_to_share"})}),e.hitch(this,function(a){console.error(a.message||a);h.reject({itemId:b.itemRes.id,
message:this.nls.exportTemplateFailed4})}))}));return h},exportWABTemplate:function(a,b,c){var d=new f;a={name:a.name,description:a.description,fromAppId:this.appInfo.id,saveAsTemplate:!0,thumbnail:a.thumbnail};var m=e.clone(window.appConfig);m.templateConfig=b;delete m.isTemplateApp;y.saveAs(a,m.getCleanConfig()).then(e.hitch(this,function(a){a.success?(d.resolve(),c()):(console.error("exportWABTemplate failed: duplicateApp response's success is false"),new g({message:"Exported as web app template failed."}),
d.reject())}),e.hitch(this,function(a){console.error("exportWABTemplate failed: duplicateApp error: "+a);new g({message:"Exported as web app template failed"});d.reject()}));return d}})})},"dijit/dijit":function(){define("./main ./_base dojo/parser ./_Widget ./_TemplatedMixin ./_Container ./layout/_LayoutWidget ./form/_FormWidget ./form/_FormValueWidget".split(" "),function(k){return k})},"dijit/_base":function(){define("./main ./a11y ./WidgetSet ./_base/focus ./_base/manager ./_base/place ./_base/popup ./_base/scroll ./_base/sniff ./_base/typematic ./_base/wai ./_base/window".split(" "),
function(k){return k._base})},"dijit/WidgetSet":function(){define(["dojo/_base/array","dojo/_base/declare","dojo/_base/kernel","./registry"],function(k,e,p,q){var n=e("dijit.WidgetSet",null,{constructor:function(){this._hash={};this.length=0},add:function(e){if(this._hash[e.id])throw Error("Tried to register widget with id\x3d\x3d"+e.id+" but that id is already registered");this._hash[e.id]=e;this.length++},remove:function(e){this._hash[e]&&(delete this._hash[e],this.length--)},forEach:function(e,
h){h=h||p.global;var f=0,d;for(d in this._hash)e.call(h,this._hash[d],f++,this._hash);return this},filter:function(e,h){h=h||p.global;var f=new n,d=0,c;for(c in this._hash){var a=this._hash[c];e.call(h,a,d++,this._hash)&&f.add(a)}return f},byId:function(e){return this._hash[e]},byClass:function(e){var h=new n,f,d;for(f in this._hash)d=this._hash[f],d.declaredClass==e&&h.add(d);return h},toArray:function(){var e=[],h;for(h in this._hash)e.push(this._hash[h]);return e},map:function(e,h){return k.map(this.toArray(),
e,h)},every:function(e,h){h=h||p.global;var f=0,d;for(d in this._hash)if(!e.call(h,this._hash[d],f++,this._hash))return!1;return!0},some:function(e,h){h=h||p.global;var f=0,d;for(d in this._hash)if(e.call(h,this._hash[d],f++,this._hash))return!0;return!1}});k.forEach("forEach filter byClass map every some".split(" "),function(e){q[e]=n.prototype[e]});return n})},"dijit/_base/focus":function(){define("dojo/_base/array dojo/dom dojo/_base/lang dojo/topic dojo/_base/window ../focus ../selection ../main".split(" "),
function(k,e,p,q,n,l,h,f){l.focus=function(d){if(d){var c="node"in d?d.node:d,a=d.bookmark;d=d.openedForWindow;var b=a?a.isCollapsed:!1;if(c){var g="iframe"==c.tagName.toLowerCase()?c.contentWindow:c;if(g&&g.focus)try{g.focus()}catch(u){}l._onFocusNode(c)}if(a&&n.withGlobal(d||n.global,f.isCollapsed)&&!b){d&&d.focus();try{n.withGlobal(d||n.global,f.moveToBookmark,null,[a])}catch(u){}}}};l.watch("curNode",function(d,c,a){f._curFocus=a;f._prevFocus=c;a&&q.publish("focusNode",a)});l.watch("activeStack",
function(d,c,a){f._activeStack=a});l.on("widget-blur",function(d,c){q.publish("widgetBlur",d,c)});l.on("widget-focus",function(d,c){q.publish("widgetFocus",d,c)});p.mixin(f,{_curFocus:null,_prevFocus:null,isCollapsed:function(){return f.getBookmark().isCollapsed},getBookmark:function(){return(n.global==window?h:new h.SelectionManager(n.global)).getBookmark()},moveToBookmark:function(d){return(n.global==window?h:new h.SelectionManager(n.global)).moveToBookmark(d)},getFocus:function(d,c){d=!l.curNode||
d&&e.isDescendant(l.curNode,d.domNode)?f._prevFocus:l.curNode;return{node:d,bookmark:d&&d==l.curNode&&n.withGlobal(c||n.global,f.getBookmark),openedForWindow:c}},_activeStack:[],registerIframe:function(d){return l.registerIframe(d)},unregisterIframe:function(d){d&&d.remove()},registerWin:function(d,c){return l.registerWin(d,c)},unregisterWin:function(d){d&&d.remove()}});return f})},"dijit/_base/place":function(){define(["dojo/_base/array","dojo/_base/lang","dojo/window","../place","../main"],function(k,
e,p,q,n){var l={getViewport:function(){return p.getBox()}};l.placeOnScreen=q.at;l.placeOnScreenAroundElement=function(h,f,d,c){var a;if(e.isArray(d))a=d;else{a=[];for(var b in d)a.push({aroundCorner:b,corner:d[b]})}return q.around(h,f,a,!0,c)};l.placeOnScreenAroundNode=l.placeOnScreenAroundElement;l.placeOnScreenAroundRectangle=l.placeOnScreenAroundElement;l.getPopupAroundAlignment=function(e,f){var d={};k.forEach(e,function(c){var a=f;switch(c){case "after":d[f?"BR":"BL"]=f?"BL":"BR";break;case "before":d[f?
"BL":"BR"]=f?"BR":"BL";break;case "below-alt":a=!a;case "below":d[a?"BL":"BR"]=a?"TL":"TR";d[a?"BR":"BL"]=a?"TR":"TL";break;case "above-alt":a=!a;default:d[a?"TL":"TR"]=a?"BL":"BR",d[a?"TR":"TL"]=a?"BR":"BL"}});return d};e.mixin(n,l);return n})},"dijit/_base/popup":function(){define(["dojo/dom-class","dojo/_base/window","../popup","../BackgroundIframe"],function(k,e,p){var q=p._createWrapper;p._createWrapper=function(l){l.declaredClass||(l={_popupWrapper:l.parentNode&&k.contains(l.parentNode,"dijitPopup")?
l.parentNode:null,domNode:l,destroy:function(){},ownerDocument:l.ownerDocument,ownerDocumentBody:e.body(l.ownerDocument)});return q.call(this,l)};var n=p.open;p.open=function(e){if(e.orient&&"string"!=typeof e.orient&&!("length"in e.orient)){var h=[],f;for(f in e.orient)h.push({aroundCorner:f,corner:e.orient[f]});e.orient=h}return n.call(this,e)};return p})},"dijit/_base/scroll":function(){define(["dojo/window","../main"],function(k,e){e.scrollIntoView=function(e,q){k.scrollIntoView(e,q)}})},"dijit/_base/sniff":function(){define(["dojo/uacss"],
function(){})},"dijit/_base/typematic":function(){define(["../typematic"],function(){})},"dijit/_base/wai":function(){define(["dojo/dom-attr","dojo/_base/lang","../main","../hccss"],function(k,e,p){e.mixin(p,{hasWaiRole:function(e,k){e=this.getWaiRole(e);return k?-1<e.indexOf(k):0<e.length},getWaiRole:function(p){return e.trim((k.get(p,"role")||"").replace("wairole:",""))},setWaiRole:function(e,n){k.set(e,"role",n)},removeWaiRole:function(p,n){var l=k.get(p,"role");l&&(n?(n=e.trim((" "+l+" ").replace(" "+
n+" "," ")),k.set(p,"role",n)):p.removeAttribute("role"))},hasWaiState:function(e,k){return e.hasAttribute?e.hasAttribute("aria-"+k):!!e.getAttribute("aria-"+k)},getWaiState:function(e,k){return e.getAttribute("aria-"+k)||""},setWaiState:function(e,k,l){e.setAttribute("aria-"+k,l)},removeWaiState:function(e,k){e.removeAttribute("aria-"+k)}});return p})},"dijit/_base/window":function(){define(["dojo/window","../main"],function(k,e){e.getDocumentWindow=function(e){return k.get(e)}})},"builder/dijit/template-config/ExportMessage":function(){define("dojo/_base/declare dojo/_base/html dijit/_WidgetBase dijit/_TemplatedMixin dojo/text!./templates/ExportMessage.html jimu/portalUrlUtils jimu/dijit/Popup".split(" "),
function(k,e,p,q,n,l,h){var f=k([p,q],{baseClass:"agol-template-export-message",templateString:n,constructor:function(){},postCreate:function(){this.inherited(arguments);"no_permission_to_share"===this.exportedInfo.type?(e.setAttr(this.word1,"innerHTML",this.nls.exportTemplateFailed31),this.exportedInfo.itemUrl&&(e.setAttr(this.itemLink,"innerHTML",this.nls.descriptionTemplateUrl21),e.setAttr(this.itemLink,"href",this.exportedInfo.itemUrl)),e.setAttr(this.word2,"innerHTML",this.nls.exportTemplateFailed32)):
(this.exportedInfo.message&&e.setAttr(this.resMessage,"innerHTML",this.exportedInfo.message),this.exportedInfo.itemUrl&&(e.setAttr(this.word1,"innerHTML",this.nls.descriptionTemplateUrl1),e.setAttr(this.itemLink,"innerHTML",this.nls.descriptionTemplateUrl2),e.setAttr(this.itemLink,"href",this.exportedInfo.itemUrl),e.setAttr(this.word2,"innerHTML",this.nls.descriptionTemplateUrl3)))}});f._exportedMessage=function(d,c,a){d.itemId&&(d.itemUrl=l.getItemDetailsPageUrl(window.portalUrl,d.itemId));d=new f({exportedInfo:d,
nls:a});new h({content:d,titleLabel:c,width:"600",autoHeight:!0,buttons:[{label:a.ok}]})};return f})},"builder/dijit/ItemInfo":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/html dojo/Deferred dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dijit/dijit dojo/text!./templates/ItemInfo.html dojo/dom-style dojo/_base/lang dojo/promise/all builder/portalUtils jimu/portalUrlUtils jimu/utils ./Tags dijit/form/SimpleTextarea jimu/dijit/ImageChooser dijit/form/TextBox dijit/form/Select dijit/form/CheckBox".split(" "),
function(k,e,p,q,n,l,h,f,d,c,a,b,g,u,m,r,t,v){return k([n,l,h],{templateString:d,baseClass:"dijit-item-info",postMixInProperties:function(){this.inherited(arguments);this.nls=a.mixin(this.nls,builderNls)},postCreate:function(){this.inherited(arguments);this.tags.nls=this.nls;this._init(this.itemInfo)},_init:function(d){this.appName.focus();void 0===d.tags&&c.set(this.tagsTr,"display","none");void 0===d.folderId&&c.set(this.folderTr,"display","none");void 0===d.sharing&&c.set(this.sharingTr,"display",
"none");void 0===d.thumbnail&&c.set(this.thumbnailTr,"display","none");void 0!==d.tags||void 0!==d.folder?g.getPortal(u.getStandardPortalUrl(window.portalUrl)).getUser().then(a.hitch(this,function(c){var g=[];this.user=c;if(void 0!==d.folderId)g.push(this._initFolder(c));else{var e=new q;e.resolve();g.push(e)}void 0!==d.tags?g.push(f.byId("publish-webmap-tags").loadTags(c)):(c=new q,c.resolve(),g.push(c));b(g).then(a.hitch(this,function(){this.setProperties(d)}),a.hitch(this,function(a){this.setProperties(d);
console.error(a.message||a)}))}),a.hitch(this,function(a){this.setProperties(d);console.error(a.message||a)})):(void 0!==d.thumbnail&&(this.imageChooser=new v({cropImage:!0,showSelfImg:!0,format:[v.GIF,v.JPEG,v.PNG],goldenWidth:300,goldenHeight:200}),p.place(this.imageChooser.domNode,this.imageChooserBase)),this.setProperties(d))},_initFolder:function(b){var c=new q;b.getContent().then(a.hitch(this,function(d){var g=[{label:b.username,value:""}],g=g.concat(e.map(d.folders,a.hitch(this,function(a){return{label:a.title,
value:a.id}})));f.byId("publish-webmap-folder").set("options",g);f.byId("publish-webmap-folder").set("value","");c.resolve()}),function(a){console.error("get userContent error!",a.message);c.reject()});return c},setProperties:function(a){f.byId("publish-webmap-name").set("value",a.name);f.byId("publish-webmap-tags").set("tags",a.tags||[]);f.byId("publish-webmap-summary").set("value",a.description);f.byId("publish-webmap-folder").set("value",a.folderId);f.byId("publish-webmap-sharing").set("checked",
a.sharing);this.imageChooser&&this.imageChooser.setDefaultSelfSrc(a.thumbnail)},getProperties:function(){return{name:m.stripHTML(f.byId("publish-webmap-name").get("value")),tags:f.byId("publish-webmap-tags").get("tags"),description:m.stripHTML(f.byId("publish-webmap-summary").get("value")),folderId:f.byId("publish-webmap-folder").get("value"),sharing:f.byId("publish-webmap-sharing").get("checked"),thumbnail:this.imageChooser&&this.imageChooser.imageData}}})})},"builder/dijit/Tags":function(){define("dojo/_base/array dojo/_base/lang dojo/_base/declare dojo/dom-construct dojo/store/Memory dojo/Deferred dojo/sniff dijit/_TemplatedMixin dijit/_WidgetBase dijit/form/TextBox ./AutoComplete dojo/text!./templates/Tags.html dojo/domReady!".split(" "),
function(k,e,p,q,n,l,h,f,d,c,a,b){return p([d,f],{templateString:b,baseClass:"esriAGOTags",_minWidth:"100%",_maxWidth:"100%",postMixInProperties:function(){this.inherited(arguments)},postCreate:function(){this.inherited(arguments);this._isIE8=h("ie")},startup:function(){this.inherited(arguments)},loadTags:function(a){var b=new l;this._isIE8?(this._textTags||(this.tagsId="userTags-"+(new Date).getTime(),q.create("div",{id:this.tagsId},this.domNode),this._textTags=new c({placeHolder:this.nls.addTags,
trim:!0,style:{minWidth:this._minWidth,maxWidth:this._maxWidth}},this.tagsId)),b.resolve()):a?a.getTags().then(e.hitch(this,function(a){this._handleTags(a);b.resolve()}),e.hitch(this,function(a){console.error("get user tags error: "+a);this._handleTags({tags:[]});b.resolve()})):(this._handleTags({tags:[]}),b.resolve());return b},_handleTags:function(b){if(b){this._autoComplete&&this._autoComplete.clearTags();var c=[];b.tags&&k.forEach(b.tags,e.hitch(this,function(a){c.push(a)}));this._tagStore?(this._tagStore.query({}).forEach(e.hitch(this,
function(a){this._tagStore.remove(a.tag)})),k.forEach(c,e.hitch(this,function(a){this._tagStore.add(a)}))):this._tagStore=new n({idProperty:"tag",data:c});this._autoComplete||(b=(new Date).getTime(),this.tagsId="userTags-"+b,this.gridId="grid-"+b,this.filterId="filter-"+b,q.create("div",{id:this.tagsId,className:"grid_1"},this.domNode),this._autoComplete=new a({placeholder:this.nls.addTags,noDataMsg:this.nls.noTagsFound,idProperty:"tag",gridId:this.gridId,filterId:this.filterId,minWidth:this._minWidth,
maxWidth:this._maxWidth,matchParam:"first",store:this._tagStore,style:{width:this._minWidth}},this.tagsId))}},_getUniqueTags:function(a){return k.filter(a,e.hitch(this,function(b,c){return k.indexOf(a,b)===c}))},_setValueAttr:function(a){this._setTagsAttr(a)},_getValueAttr:function(){return this._getTagsAttr()},_setTagsAttr:function(a){!a||a instanceof Array||(a=a.split(","));this._isIE8?this._textTags&&this._textTags.set("value",this._getUniqueTags(a).join(",")):this._autoComplete&&(this._autoComplete.clearTags(),
this._autoComplete.prepopulate(a?this._getUniqueTags(a):[]))},_getTagsAttr:function(){return this._isIE8?this._textTags?this._textTags.get("value"):"":this._autoComplete&&this._autoComplete.values?this._autoComplete.values.join(","):""},_setMinWidthAttr:function(a){this._minWidth=a},_setMaxWidthAttr:function(a){this._maxWidth=a}})})},"builder/dijit/AutoComplete":function(){define("dojo/_base/array dojo/_base/declare dojo/_base/lang dojo/_base/window dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/dom-style dojo/html dojo/json dojo/keys dojo/on dojo/query dojo/request dojo/string dijit/focus dijit/form/TextBox dijit/registry dijit/_OnDijitClickMixin dijit/_TemplatedMixin dijit/_WidgetBase dgrid/OnDemandGrid dgrid/Selection dgrid/Keyboard dojo/NodeList-traverse dojo/NodeList-manipulate".split(" "),
function(k,e,p,q,n,l,h,f,d,c,a,b,g,u,m,r,t,v,y,w,z,x,A,C,B){return e([x,w,z],{_attachmentNode:"",_autocompleteList:"",_grid:"",_store:"",_matchParam:"",_idProperty:"",_gridId:"",_filterId:"",_placeHolder:"",_noDataMsg:"",_maxWidth:"",_minWidth:"",_inputTextBox:"",_gridHasFocus:!1,_metaKeyPressed:!1,_shiftKeyPressed:!1,_CSS_STYLES:{CLASS_SELECTOR:".",ALL_SELECTOR:"\x3e",MULTI:"select2-container select2-container-multi",CHOICES:"select2-choices",CHOICE:"select2-search-choice",SEARCH_CHOICE_FOCUS:"select2-search-choice-focus",
SEARCH_FIELD:"select2-search-field",CLOSE_ICON:"select2-search-choice-close"},values:[],_selRows:[],_CHOICE_SELECTOR:"",_CHOICE_FOCUS:"",_CHOICE_FOCUS_ALL:"",constructor:function(a,b){this._attachmentNode=b;this._idProperty=a.idProperty;this._gridId=a.gridId;this._filterId=a.filterId;this._store=a.store;this._placeHolder=a.placeholder;this._noDataMsg=a.noDataMsg;this._maxWidth=a.maxWidth;this._minWidth=a.minWidth;this._matchParam=a.matchParam;this.values=[];this._selRows=[];this._CHOICE_ALL_SELECTOR=
this._CSS_STYLES.CLASS_SELECTOR+this._CSS_STYLES.CHOICE+this._CSS_STYLES.ALL_SELECTOR;this._CHOICE_FOCUS=this._CSS_STYLES.CLASS_SELECTOR+this._CSS_STYLES.SEARCH_CHOICE_FOCUS;this._CHOICE_FOCUS_ALL=this._CHOICE_FOCUS+this._CSS_STYLES.ALL_SELECTOR},buildRendering:function(){this._createContainerNode();this._createTagList();this._createDropDownList();this._createInput();var a=p.hitch(this,function(a,b,c){b=this._inputTextBox?this._inputTextBox.get("value")+"":"";if(1>b.length)return!0;if(!a.tag)return!1;
a=(a.tag+"").toLowerCase().match(new RegExp("^"+b.toLowerCase()));return null!==a&&0<a.length?!0:!1}),b=p.hitch(this,function(a,b,c){b=this._inputTextBox?this._inputTextBox.get("value")+"":"";return 1>b.length?!0:a.tag?~(a.tag+"").toLowerCase().indexOf(b.toLowerCase())?!0:!1:!1}),c=[{field:this._idProperty}],d=[{attribute:this._idProperty,ascending:!0}];this._grid=new (e([A,C,B]))({store:this._store,showHeader:!1,noDataMessage:this._noDataMsg,selectionMode:"extended",allowSelectAll:!0,cellNavigation:!1,
columns:c,sort:d,renderRow:this._renderItem},this._gridId);h.add(this._gridId,"gridHeightLimiter");this._grid.query="first"===this._matchParam?a:b},postCreate:function(){var a;this._inputTextBox.watch("value",p.hitch(this,function(b,c,d){a&&(clearTimeout(a),a=null);this._grid.refresh()}));this._grid.on(".dgrid-row:click",p.hitch(this,function(a){var b="";this._shiftKeyPressed||this._metaKeyPressed?a.shiftKey||a.metaKey||a.ctrlKey||(b=this._selRows[0],this._createTags(b),this._store.remove(b),this._grid.refresh(),
this._resetInputTextBox()):(b=this._grid.row(a).data.tag,this._createTags(b),this._store.remove(b),this._grid.refresh(),this._resetInputTextBox())}));this._grid.on("dgrid-deselect",p.hitch(this,function(a){this._selRows=[];for(var b in this._grid.selection)this._selRows.push(b)}));this._grid.on("dgrid-select",p.hitch(this,function(a){this._selRows=[];for(var b in this._grid.selection)this._selRows.push(b)}));this.connect(this.domNode,"keydown","_keydownHandler");window.onkeydown=p.hitch(this,function(a){if(a.shiftKey||
a.ctrlKey||224===a.keyCode)this._metaKeyPressed=!0});this.connect(document,"onkeydown",p.hitch(this,function(a){this._metaKeyPressed=this._shiftKeyPressed=!0}))},_keydownHandler:function(a){var c;void 0!==t.curNode.value&&(c=t.curNode.value.length);var g=u(this._CHOICE_FOCUS,n.byId(this.id)),e=u(this._CSS_STYLES.CLASS_SELECTOR+this._CSS_STYLES.CHOICE,n.byId(this.id)).last();switch(a.keyCode){case b.RIGHT_ARROW:this._navigate(g,c,e,"right");this._hideGrid();break;case b.LEFT_ARROW:this._navigate(g,
c,e,"left");this._hideGrid();break;case b.DOWN_ARROW:a.preventDefault();this._unhighlightTag(g);"none"===d.get(this._gridId,"display")&&this._showGrid();this._gridHasFocus||(this._grid.focus(this._setFocusOnFirstRow(this._grid,0)),this._gridHasFocus=!0);break;case b.UP_ARROW:break;case b.BACKSPACE:var m;if(0===c&&0===u(this._CHOICE_FOCUS_ALL).length&&void 0!==u(this._CHOICE_ALL_SELECTOR)[u(this._CHOICE_ALL_SELECTOR).length-1]&&(m=u(this._CHOICE_ALL_SELECTOR)[u(this._CHOICE_ALL_SELECTOR).length-1].title,
0<u("li",this._attachmentNode).length&&(f.destroy(e[0]),void 0!==m)))try{this._store.add({tag:m})}catch(J){}if(0<u(this._CHOICE_FOCUS_ALL).length&&(m=u(this._CHOICE_FOCUS_ALL).text(),f.destroy(g[0]),void 0!==m))try{this._store.add({tag:m})}catch(J){}this._grid.refresh();0===c&&this._hideGrid();this._removeTag(m);break;case b.CTRL:this._metaKeyPressed=!0;break;case b.META:this._metaKeyPressed=!0;break;case b.SHIFT:this._shiftKeyPressed=!0;break;case b.ENTER:if(0<c){c=t.curNode.value;c=c.split(",");
var h=[];k.forEach(c,function(a,b){-1===k.indexOf(h,a)&&h.push(r.trim(a))});k.forEach(h,p.hitch(this,function(a,b){this._isEmpty(a)||this._contains(this.values,a)||this._createTags(a)}))}else{for(c=0;c<this._selRows.length;c++)this._createTags(this._selRows[c]),this._store.remove(this._selRows[c]);this._metaKeyPressed=this._shiftKeyPressed=!1}this._resetInputTextBox();a.preventDefault();t.focus(n.byId(this._filterId));break;case b.TAB:if(t.curNode.id!==this._filterId||0!==c){if(0<c)c=t.curNode.value,
c=c.split(","),h=[],k.forEach(c,function(a,b){-1===k.indexOf(h,a)&&h.push(r.trim(a))}),k.forEach(h,p.hitch(this,function(a,b){this._isEmpty(a)||this._contains(this.values,a)||this._createTags(a)}));else{for(c=0;c<this._selRows.length;c++)this._createTags(this._selRows[c]),this._store.remove(this._selRows[c]);this._metaKeyPressed=this._shiftKeyPressed=!1}this._resetInputTextBox();a.preventDefault();t.focus(n.byId(this._filterId))}break;case b.ESCAPE:this._hideGrid();break;default:-1<c&&("none"===d.get(n.byId(this._gridId),
"display")&&this._showGrid(),this._unhighlightTag(g)),this._metaKeyPressed=!1}},_blurHandler:function(a,b,c){if(!this.focused){if(0<this._inputTextBox.value.length){var d=[];a=this._inputTextBox.value.split(",");k.forEach(a,function(a,b){-1===k.indexOf(d,a)&&d.push(r.trim(a))});k.forEach(d,p.hitch(this,function(a,b){this._isEmpty(a)||this._contains(this.values,a)||this._createTags(a)}));this._resetInputTextBox()}this._hideGrid()}},_resetInputTextBox:function(){y.byId(this._filterId).set("value","")},
_isEmpty:function(a){a=a.replace(/^\s+|\s+$/,"");return 0===a.length?!0:!1},_navigate:function(a,b,c,d){0<a.length&&1>b?("right"===d?this._hightlightTag(a.next()):this._hightlightTag(a.prev()),this._unhighlightTag(a)):1>b&&this._hightlightTag(c)},_contains:function(a,b){return 0<=k.indexOf(a,b)},_hightlightTag:function(a){a.addClass(this._CSS_STYLES.SEARCH_CHOICE_FOCUS)},_unhighlightTag:function(a){a.removeClass(this._CSS_STYLES.SEARCH_CHOICE_FOCUS)},_removeTag:function(a){a&&-1!==k.indexOf(this.values,
a)&&this.values.splice(k.indexOf(this.values,a),1)},_hideGrid:function(){n.byId(this._gridId)&&d.set(n.byId(this._gridId),"display","none");this._gridHasFocus=!1},_showGrid:function(){d.set(n.byId(this._gridId),"display","block");var a=d.get(n.byId(this._attachmentNode),"width");d.set(n.byId(this._gridId),"width",a+"px")},_setFocusOnFirstRow:function(a,b){return u(".dgrid-content .dgrid-cell",this._grid.domNode)[b]||u(".dgrid-content .dgrid-row",this._grid.domNode)[b]},_createTags:function(a){u(this._CHOICE_FOCUS,
n.byId(this.id)).removeClass("select2-search-choice-focus");var b=f.create("li",null,this._autocompleteList);h.add(b,this._CSS_STYLES.CHOICE);b=f.create("div",{title:a},b);c.set(b,this.htmlEncode(a));b=f.create("a",{href:"#"},b);h.add(b,this._CSS_STYLES.CLOSE_ICON);g(b,"click",p.hitch(this,function(a){var b=a.target.parentElement.innerText||a.target.parentElement.textContent;try{this._store.add({tag:b})}catch(M){}this._grid.refresh();this._removeTag(b);f.destroy(a.target.parentNode.parentNode);a.preventDefault()}));
b=y.byId(this._filterId);f.place(b.domNode,this._autocompleteList,"last");this._hideGrid();this.values.push(a)},_renderItem:function(a){return f.create("div",{innerHTML:a.tag})},_createContainerNode:function(){this.domNode=f.create("div",null,this._attachmentNode);h.add(this.domNode,this._CSS_STYLES.MULTI);d.set(this.domNode,"maxWidth",this._maxWidth);d.set(this.domNode,"minWidth",this._minWidth)},_createTagList:function(){this._autocompleteList=f.create("ul",null,this.domNode);h.add(this._autocompleteList,
this._CSS_STYLES.CHOICES)},_createInput:function(){var a=f.create("li",null,this._autocompleteList,"last");h.add(a,this._CSS_STYLES.SEARCH_FIELD);this._inputTextBox=new v({id:this._filterId,placeHolder:this._placeHolder,intermediateChanges:!0,trim:!0,style:{border:"none"}},a);h.add(this._inputTextBox,"inputTextBox");d.set(this._inputTextBox,"width",this._minWidth);t.watch("curNode",p.hitch(this,this._blurHandler))},_createDropDownList:function(){var a=f.create("div",{id:this._gridId},this.domNode);
h.add(a,"dropDownList");d.set(a,"width",this._minWidth)},prepopulate:function(a){k.forEach(a,p.hitch(this,function(a,b){this._createTags(a);this._store.remove(a)}))},clearTags:function(){var a=u(this._CSS_STYLES.CLASS_SELECTOR+this._CSS_STYLES.CHOICE,n.byId(this.id));0<a.length&&(k.forEach(a,p.hitch(this,function(a,b){try{this._store.add({tag:u(this._CHOICE_ALL_SELECTOR,n.byId(this.id))[0].title})}catch(I){}f.destroy(a)})),this.values=[])},addStyledTags:function(a,b){h.add(n.byId(b),this._CSS_STYLES.MULTI);
var g=f.create("ul",null,n.byId(b));h.add(g,this._CSS_STYLES.CHOICES);d.set(g,"border","none");k.forEach(a,function(a,b){b=f.create("li",null,g);d.set(b,"padding","3px 5px 3px 5px");h.add(b,"select2-search-resultSet");b=f.create("div",{title:a},b);c.set(b,a)})},htmlEncode:function(a){return a?a.replace(/&/g,"\x26amp;").replace(/>/g,"\x26gt;").replace(/</g,"\x26lt;").replace(/"/g,"\x26quot;"):a}})})},"dgrid/OnDemandGrid":function(){define(["dojo/_base/declare","./Grid","./OnDemandList"],function(k,
e,p){return k("dgrid.OnDemandGrid",[e,p],{})})},"dgrid/Grid":function(){define("dojo/_base/kernel dojo/_base/declare dojo/on dojo/has put-selector/put ./List ./util/misc dojo/_base/sniff".split(" "),function(k,e,p,q,n,l,h){function f(a,b){b&&b.nodeType&&a.appendChild(b)}function d(a,b,c,d){if(this.formatter){d=this.formatter;var g=this.grid.formatterScope;c.innerHTML="string"===typeof d&&g?g[d](b,a):this.formatter(b,a)}else null!=b&&c.appendChild(document.createTextNode(b))}var c=8>q("ie")&&!q("quirks");
e=e("dgrid.Grid",l,{columns:null,cellNavigation:!0,tabableHeader:!0,showHeader:!0,column:function(a){return"object"!=typeof a?this.columns[a]:this.cell(a).column},listType:"grid",cell:function(a,b){if(a.column&&a.element)return a;a.target&&a.target.nodeType&&(a=a.target);var c;if(a.nodeType){do{if(this._rowIdToObject[a.id])break;var d=a.columnId;if(d){b=d;c=a;break}a=a.parentNode}while(a&&a!=this.domNode)}if(!c&&"undefined"!=typeof b){var f=this.row(a);if(d=f&&f.element)for(var d=d.getElementsByTagName("td"),
e=0;e<d.length;e++)if(d[e].columnId==b){c=d[e];break}}if(null!=a)return{row:f||this.row(a),column:b&&this.column(b),element:c}},createRowCells:function(a,b,d,f){var g=n("table.dgrid-row-table[role\x3dpresentation]"),e=9>q("ie")||q("quirks")?n(g,"tbody"):g,k,l,p,u,z,x,A,C,B,E;d=d||this.subRows;l=0;for(p=d.length;l<p;l++)for(x=d[l],k=n(e,"tr"),x.className&&n(k,"."+x.className),u=0,z=x.length;u<z;u++){A=x[u];C=A.id;B=A.field?".field-"+h.escapeCssIdentifier(A.field,"-"):"";(E="function"===typeof A.className?
A.className(f):A.className)&&(B+="."+E);B=n(a+(".dgrid-cell.dgrid-cell-padding"+(C?".dgrid-column-"+h.escapeCssIdentifier(C,"-"):"")+B.replace(/ +/g,"."))+"[role\x3d"+("th"===a?"columnheader":"gridcell")+"]");B.columnId=C;c?(C=n(B,"!dgrid-cell-padding div.dgrid-cell-padding"),B.contents=C):C=B;if(E=A.colSpan)B.colSpan=E;if(E=A.rowSpan)B.rowSpan=E;b(C,A);k.appendChild(B)}return g},left:function(a,b){a.element||(a=this.cell(a));return this.cell(this._move(a,-(b||1),"dgrid-cell"))},right:function(a,
b){a.element||(a=this.cell(a));return this.cell(this._move(a,b||1,"dgrid-cell"))},renderRow:function(a,b){var c=this.createRowCells("td",function(c,g){var e=a;g.get?e=g.get(a):"field"in g&&"_item"!=g.field&&(e=e[g.field]);g.renderCell?f(c,g.renderCell(a,e,c,b)):d.call(g,a,e,c,b)},b&&b.subRows,a);return n("div[role\x3drow]\x3e",c)},renderHeader:function(){var a=this,b=this.headerNode,d=b.childNodes.length;for(b.setAttribute("role","row");d--;)n(b.childNodes[d],"!");d=this.createRowCells("th",function(a,
b){var d=b.headerNode=a;c&&(a=a.parentNode);var g=b.field;g&&(a.field=g);b.renderHeaderCell?f(d,b.renderHeaderCell(d)):("label"in b||b.field)&&d.appendChild(document.createTextNode("label"in b?b.label:b.field));!1!==b.sortable&&g&&"_item"!=g&&(a.sortable=!0,a.className+=" dgrid-sortable")},this.subRows&&this.subRows.headerRows);this._rowIdToObject[d.id=this.id+"-header"]=this.columns;b.appendChild(d);this._sortListener&&this._sortListener.remove();this._sortListener=p(d,"click,keydown",function(c){if("click"==
c.type||32==c.keyCode||!q("opera")&&13==c.keyCode){var d=c.target,g,f,e;do if(d.sortable){e=[{attribute:g=d.field||d.columnId,descending:(f=a._sort[0])&&f.attribute==g&&!f.descending}];g={bubbles:!0,cancelable:!0,grid:a,parentType:c.type,sort:e};p.emit(c.target,"dgrid-sort",g)&&(a._sortNode=d,a.set("sort",e));break}while((d=d.parentNode)&&d!=b)}})},resize:function(){var a=this.headerNode.firstChild,b=this.contentNode,c;this.inherited(arguments);if(!q("ie")||7<q("ie")&&!q("quirks"))b.style.width="",
b&&a&&(c=a.offsetWidth)!=b.offsetWidth&&(b.style.width=c+"px")},destroy:function(){this._destroyColumns();this._sortListener&&this._sortListener.remove();this.inherited(arguments)},_setSort:function(a,b){this.inherited(arguments);this.updateSortArrow(this._sort)},_findSortArrowParent:function(a){var b=this.columns,c;for(c in b){var d=b[c];if(d.field==a)return d.headerNode}},updateSortArrow:function(a,b){this._lastSortedArrow&&(n(this._lastSortedArrow,"\x3c!dgrid-sort-up!dgrid-sort-down"),n(this._lastSortedArrow,
"!"),delete this._lastSortedArrow);b&&(this._sort=a);if(a[0]){b=a[0].attribute;a=a[0].descending;b=this._sortNode||this._findSortArrowParent(b);var c;delete this._sortNode;b&&(b=b.contents||b,c=this._lastSortedArrow=n("div.dgrid-sort-arrow.ui-icon[role\x3dpresentation]"),c.innerHTML="\x26nbsp;",b.insertBefore(c,b.firstChild),n(b,a?".dgrid-sort-down":".dgrid-sort-up"),this.resize())}},styleColumn:function(a,b){return this.addCssRule("#"+h.escapeCssIdentifier(this.domNode.id)+" .dgrid-column-"+h.escapeCssIdentifier(a,
"-"),b)},_configColumns:function(a,b){var c=[],d=b instanceof Array;h.each(b,function(g,f){"string"==typeof g&&(b[f]=g={label:g});d||g.field||(g.field=f);f=g.id=g.id||(isNaN(f)?f:a+f);this._configColumn&&(this._configColumn(g,f,b,a),f=g.id);d&&(this.columns[f]=g);g.grid=this;"function"===typeof g.init&&g.init();c.push(g)},this);return d?b:c},_destroyColumns:function(){var a=this.subRows,b=a&&a.length,c,d,f,e;this.cleanup();for(c=0;c<b;c++)for(d=0,e=a[c].length;d<e;d++)f=a[c][d],"function"===typeof f.destroy&&
f.destroy()},configStructure:function(){var a=this.subRows,b=this._columns=this.columns;this.columns=!b||b instanceof Array?{}:b;if(a)for(b=0;b<a.length;b++)a[b]=this._configColumns(b+"-",a[b]);else this.subRows=[this._configColumns("",b)]},_getColumns:function(){return this._columns||this.columns},_setColumns:function(a){this._destroyColumns();this.subRows=null;this.columns=a;this._updateColumns()},_setSubRows:function(a){this._destroyColumns();this.subRows=a;this._updateColumns()},setColumns:function(a){k.deprecated("setColumns(...)",
'use set("columns", ...) instead',"dgrid 0.4");this.set("columns",a)},setSubRows:function(a){k.deprecated("setSubRows(...)",'use set("subRows", ...) instead',"dgrid 0.4");this.set("subRows",a)},_updateColumns:function(){this.configStructure();this.renderHeader();this.refresh();this._lastCollection&&this.renderArray(this._lastCollection);this._started&&(this._sort&&this._sort.length?this.updateSortArrow(this._sort):this.resize())}});e.appendIfNode=f;e.defaultRenderCell=d;return e})},"put-selector/put":function(){(function(k){var e,
p=/[-+,> ]/;k([],e=function(k,n){function l(a){function b(){t&&n&&t!=n&&(n==a&&(g||(g=p.test(z)&&k.createDocumentFragment()))?g:n).insertBefore(t,m||null)}for(var g,e,m,n,t,q=arguments,y=q[0],w=0;w<q.length;w++){var z=q[w];if("object"==typeof z){e=!1;if(z instanceof Array){t=k.createDocumentFragment();for(var x=0;x<z.length;x++)t.appendChild(l(z[x]));z=t}if(z.nodeType)t=z,b(),n=z,m=0;else for(x in z)t[x]=z[x]}else if(e)e=!1,t.appendChild(k.createTextNode(z));else{1>w&&(a=null);e=!0;if(y=z.replace(h,
function(g,e,h,p,r,u){e&&(b(),"-"==e||"+"==e?(n=(m=t||n).parentNode,t=null,"+"==e&&(m=m.nextSibling)):("\x3c"==e?n=t=(t||n).parentNode:(","==e?n=a:t&&(n=t),t=null),m=0),t&&(n=t));if((g=!h&&p)||!t&&(h||r))"$"==g?(g=q[++w],n.appendChild(k.createTextNode(g))):(g=g||l.defaultTag,(e=c&&q[w+1]&&q[w+1].name)&&(g="\x3c"+g+' name\x3d"'+e+'"\x3e'),t=d&&~(f=g.indexOf("|"))?k.createElementNS(d[g.slice(0,f)],g.slice(f+1)):k.createElement(g));if(h)if("$"==p&&(p=q[++w]),"#"==h)t.id=p;else if(e=(g=t.className)&&
(" "+g+" ").replace(" "+p+" "," "),"."==h)t.className=g?(e+p).substring(1):p;else if("!"==z){var v;c?l("div",t,"\x3c").innerHTML="":(v=t.parentNode)&&v.removeChild(t)}else e=e.substring(1,e.length-1),e!=g&&(t.className=e);r&&("$"==u&&(u=q[++w]),"style"==r?t.style.cssText=u:(h="!"==r.charAt(0)?(r=r.substring(1))&&"removeAttribute":"setAttribute",u=""===u?r:u,d&&~(f=r.indexOf("|"))?t[h+"NS"](d[r.slice(0,f)],r.slice(f+1),u):t[h](r,u)));return""}))throw new SyntaxError("Unexpected char "+y+" in "+z);
b();n=y=t||n}}a&&g&&a.appendChild(g);return y}p=n||p;var h=/(?:\s*([-+ ,<>]))?\s*(\.|!\.?|#)?([-\w\u00A0-\uFFFF%$|]+)?(?:\[([^\]=]+)=?['"]?([^\]'"]*)['"]?\])?/g,f,d=!1;k=k||document;var c="object"==typeof k.createElement;l.addNamespace=function(a,b){k.createElementNS?(d||(d={}))[a]=b:k.namespaces.add(a,b)};l.defaultTag="div";l.forDocument=e;return l})})(function(k,e,p){p=p||e;"function"===typeof define?define([],function(){return p()}):"undefined"==typeof window?require("./node-html")(module,p):put=
p()})},"dgrid/List":function(){define("dojo/_base/kernel dojo/_base/declare dojo/dom dojo/on dojo/has ./util/misc dojo/has!touch?./TouchScroll xstyle/has-class put-selector/put dojo/_base/sniff xstyle/css!./css/dgrid.css".split(" "),function(k,e,p,q,n,l,h,f,d){function c(a,b){d(document.body,a,".dgrid-scrollbar-measure");b=a["offset"+b]-a["client"+b];a.className="";document.body.removeChild(a);return b}function a(a){var b=a?"."+a.replace(v,"."):"";this._class&&(b="!"+this._class.replace(v,"!")+b);
d(this.domNode,b);this._class=a}function b(){return this._class}function g(){return{x:this.bodyNode.scrollLeft,y:this.bodyNode.scrollTop}}function u(a){"undefined"!==typeof a.x&&(this.bodyNode.scrollLeft=a.x);"undefined"!==typeof a.y&&(this.bodyNode.scrollTop=a.y)}f("mozilla","opera","webkit","ie","ie-6","ie-6-7","quirks","no-quirks","touch");var m,r;n.add("dom-scrollbar-width",function(a,b,d){return c(d,"Width")});n.add("dom-scrollbar-height",function(a,b,d){return c(d,"Height")});n.add("dom-rtl-scrollbar-left",
function(a,b,c){a=d("div");d(document.body,c,".dgrid-scrollbar-measure[dir\x3drtl]");d(c,a);b=!!n("ie")||!!n("trident")||a.offsetLeft>=n("dom-scrollbar-width");c.className="";document.body.removeChild(c);d(a,"!");c.removeAttribute("dir");return b});var t=0,v=/ +/g,y=7>n("ie")&&!n("quirks")?function(){var a,b,c;this._started&&(a=document.documentElement,b=a.clientWidth,a=a.clientHeight,c=this._prevWinDims||[],c[0]!==b||c[1]!==a)&&(this.resize(),this._prevWinDims=[b,a])}:function(){this._started&&this.resize()};
return e("dgrid.List",n("touch")?h:null,{tabableHeader:!1,showHeader:!1,showFooter:!1,maintainOddEven:!0,cleanAddedRules:!0,useTouchScroll:null,addUiClasses:!0,shouldObserveStore:!0,cleanEmptyObservers:!0,highlightDuration:250,postscript:function(a,b){var c=this;(this._Row=function(a,b,c){this.id=a;this.data=b;this.element=c}).prototype.remove=function(){c.removeRow(this.element)};b&&(this.srcNodeRef=b=b.nodeType?b:document.getElementById(b));this.create(a,b)},listType:"list",create:function(b,c){c=
this.domNode=c||d("div");var g;b?(this.params=b,e.safeMixin(this,b),g=b["class"]||b.className||c.className,this._sort=b.sort||[],delete this.sort):this._sort=[];this.observers=[];this._numObservers=0;this._listeners=[];this._rowIdToObject={};this.postMixInProperties&&this.postMixInProperties();this.id=c.id=c.id||this.id||"dgrid_"+t++;null===this.useTouchScroll&&(this.useTouchScroll=!n("dom-scrollbar-width"));this.buildRendering();g&&a.call(this,g);this.postCreate();delete this.srcNodeRef;this.domNode.offsetHeight&&
this.startup()},buildRendering:function(){var a=this.domNode,b=this.addUiClasses,c=this,g,f,e,h;h=this.isRTL="rtl"==(document.body.dir||document.documentElement.dir||document.body.style.direction).toLowerCase();a.className="";d(a,"[role\x3dgrid].dgrid.dgrid-"+this.listType+(b?".ui-widget":""));g=this.headerNode=d(a,"div.dgrid-header.dgrid-header-row"+(b?".ui-widget-header":"")+(this.showHeader?"":".dgrid-header-hidden"));(n("quirks")||8>n("ie"))&&d(a,"div.dgrid-spacer");f=this.bodyNode=d(a,"div.dgrid-scroller");
n("ff")&&(f.tabIndex=-1);this.headerScrollNode=d(a,"div.dgrid-header.dgrid-header-scroll.dgrid-scrollbar-width"+(b?".ui-widget-header":""));e=this.footerNode=d("div.dgrid-footer"+(this.showFooter?"":".dgrid-footer-hidden"));d(a,e);h&&(a.className+=" dgrid-rtl"+(n("dom-rtl-scrollbar-left")?" dgrid-rtl-swap":""));q(f,"scroll",function(b){c.showHeader&&(g.scrollLeft=b.scrollLeft||f.scrollLeft);b.stopPropagation();q.emit(a,"scroll",{scrollTarget:f})});this.configStructure();this.renderHeader();this.contentNode=
this.touchNode=d(this.bodyNode,"div.dgrid-content"+(b?".ui-widget-content":""));this._listeners.push(this._resizeHandle=q(window,"resize",l.throttleDelayed(y,this)))},postCreate:n("touch")?function(){this.useTouchScroll&&this.inherited(arguments)}:function(){},startup:function(){this._started||(this.inherited(arguments),this._started=!0,this.resize(),this.set("sort",this._sort))},configStructure:function(){},resize:function(){var a=this.bodyNode,b=this.headerNode,c=this.footerNode,d=b.offsetHeight,
g=this.showFooter?c.offsetHeight:0,f=n("quirks")||7>n("ie");this.headerScrollNode.style.height=a.style.marginTop=d+"px";a.style.marginBottom=g+"px";f&&(a.style.height="",a.style.height=Math.max(this.domNode.offsetHeight-d-g,0)+"px",g&&(c.style.bottom="1px",setTimeout(function(){c.style.bottom=""},0)));m||(m=n("dom-scrollbar-width"),r=n("dom-scrollbar-height"),n("ie")&&(m++,r++),l.addCssRule(".dgrid-scrollbar-width","width: "+m+"px"),l.addCssRule(".dgrid-scrollbar-height","height: "+r+"px"),17==m||
f||(l.addCssRule(".dgrid-header-row","right: "+m+"px"),l.addCssRule(".dgrid-rtl-swap .dgrid-header-row","left: "+m+"px")));f&&(b.style.width=a.clientWidth+"px",setTimeout(function(){b.scrollLeft=a.scrollLeft},0))},addCssRule:function(a,b){a=l.addCssRule(a,b);this.cleanAddedRules&&this._listeners.push(a);return a},on:function(a,b){a=q(this.domNode,a,b);n("dom-addeventlistener")||this._listeners.push(a);return a},cleanup:function(){var a=this.observers,b;for(b in this._rowIdToObject)if(this._rowIdToObject[b]!=
this.columns){var c=document.getElementById(b);c&&this.removeRow(c,!0)}for(b=0;b<a.length;b++)(c=a[b])&&c.cancel();this.observers=[];this._numObservers=0;this.preload=null},destroy:function(){if(this._listeners){for(var a=this._listeners.length;a--;)this._listeners[a].remove();delete this._listeners}this._started=!1;this.cleanup();d(this.domNode,"!");this.useTouchScroll&&this.inherited(arguments)},refresh:function(){this.cleanup();this._rowIdToObject={};this._autoId=0;this.contentNode.innerHTML="";
this.scrollTo({x:0,y:0})},newRow:function(a,b,c,g,f){if(b){var e=this.insertRow(a,b,c,g,f);d(e,".dgrid-highlight"+(this.addUiClasses?".ui-state-highlight":""));setTimeout(function(){d(e,"!dgrid-highlight!ui-state-highlight")},this.highlightDuration);return e}},adjustRowIndices:function(a){var b=a.rowIndex;if(-1<b){do-1<a.rowIndex&&(this.maintainOddEven&&-1<(a.className+" ").indexOf("dgrid-row ")&&d(a,"."+(1==b%2?"dgrid-row-odd":"dgrid-row-even")+"!"+(0==b%2?"dgrid-row-odd":"dgrid-row-even")),a.rowIndex=
b++);while((a=a.nextSibling)&&a.rowIndex!=b)}},renderArray:function(a,b,c){function d(){var b=arguments;if(-1<r)for(var d=0;d<b.length;d++){var f=b[d],e=l[f?0:l.length-1];if(e=e&&g(e)){var m=e[f?"previousSibling":"nextSibling"];m&&(m=h.row(m));m&&m.element!=e&&(f=f?"unshift":"push",a[f](m.data),l[f](m.element),c.count++)}}}function g(a){return!p.isDescendant(a,h.domNode)&&document.getElementById(a.id)?h.row(a.id.slice(h.id.length+5)).element:a}function f(a){u=h.insertRow(a,q,null,m++,c);u.observerIndex=
r;return u}function e(a){v=a.slice(0);(n=b?b.parentNode:h.contentNode)&&n.parentNode&&(n!==h.contentNode||a.length)?(n.insertBefore(q,b||null),(u=a[a.length-1])&&h.adjustRowIndices(u)):k[r]&&h.cleanEmptyObservers&&"undefined"!==typeof r&&(k[r].cancel(),k[r]=0,h._numObservers--);l=a;t&&(t.rows=l)}c=c||{};var h=this,m=c.start||0,k=this.observers,l,n,r;b||(this._lastCollection=a);if(a.observe&&this.shouldObserveStore){h._numObservers++;var t=a.observe(function(f,e,m){var k,p,t;-1<e&&l[e]&&(k=l.splice(e,
1)[0],k.parentNode==n&&((p=k.nextSibling)&&e!=m&&p.rowIndex--,h.removeRow(k)),c.count--,h._processScroll&&h._processScroll());if(-1<m){if(l.length)if(0===m)t=(t=l[m])&&g(t);else{if(t=l[m-1])t=g(t),t=(t.connected||t).nextSibling}else t=h._getFirstRowSibling&&h._getFirstRowSibling(n);k&&t&&k.id===t.id&&(t=(t.connected||t).nextSibling);t&&!t.parentNode&&(t=document.getElementById(t.id));k=b&&b.parentNode||t&&t.parentNode||h.contentNode;if(k=h.newRow(f,k,t,c.start+m,c))if(k.observerIndex=r,l.splice(m,
0,k),!p||m<e)p=(p=k.previousSibling)&&p.rowIndex+1!=k.rowIndex&&0!=k.rowIndex?p:k;c.count++}0===e?d(1,1):e===a.length-(-1===m?0:1)&&d(0,0);e!=m&&p&&h.adjustRowIndices(p);h._onNotification(l,f,e,m)},!0);r=k.push(t)-1}var q=document.createDocumentFragment(),u,v;if(a.map){if(l=a.map(f,console.error),l.then)return a.then(function(b){a=b;return l.then(function(a){e(a);d(1,1,0,0);return v})})}else{l=[];for(var w=0,y=a.length;w<y;w++)l[w]=f(a[w])}e(l);d(1,1,0,0);return v},_onNotification:function(a,b,c,
d){},renderHeader:function(){},_autoId:0,insertRow:function(a,b,c,d,g){var f=g.parentId,f=this.id+"-row-"+(f?f+"-":"")+(this.store&&this.store.getIdentity?this.store.getIdentity(a):this._autoId++),e=document.getElementById(f),h=e&&e.previousSibling;e&&(e===c&&(c=(c.connected||c).nextSibling),this.removeRow(e));e=this.renderRow(a,g);e.className=(e.className||"")+" dgrid-row "+(1==d%2?"dgrid-row-odd":"dgrid-row-even")+(this.addUiClasses?" ui-state-default":"");this._rowIdToObject[e.id=f]=a;b.insertBefore(e,
c||null);h&&this.adjustRowIndices(h);e.rowIndex=d;return e},renderRow:function(a,b){return d("div",""+a)},removeRow:function(a,b){a=a.element||a;delete this._rowIdToObject[a.id];b||d(a,"!")},row:function(a){var b;if(a instanceof this._Row)return a;a.target&&a.target.nodeType&&(a=a.target);if(a.nodeType){do{var c=a.id;if(b=this._rowIdToObject[c])return new this._Row(c.substring(this.id.length+5),b,a);a=a.parentNode}while(a&&a!=this.domNode)}else return"object"==typeof a?b=this.store.getIdentity(a):
(b=a,a=this._rowIdToObject[this.id+"-row-"+b]),new this._Row(b,a,document.getElementById(this.id+"-row-"+b))},cell:function(a){return{row:this.row(a)}},_move:function(a,b,c,d){var g,f;f=g=a.element;b=b||1;do if(a=g[0>b?"previousSibling":"nextSibling"]){do if((g=a)&&-1<(g.className+" ").indexOf(c+" ")){f=g;b+=0>b?1:-1;break}while(a=(!d||!g.hidden)&&g[0>b?"lastChild":"firstChild"])}else if(g=g.parentNode,!g||g===this.bodyNode||g===this.headerNode)break;while(b);return f},up:function(a,b,c){a.element||
(a=this.row(a));return this.row(this._move(a,-(b||1),"dgrid-row",c))},down:function(a,b,c){a.element||(a=this.row(a));return this.row(this._move(a,b||1,"dgrid-row",c))},scrollTo:n("touch")?function(a){return this.useTouchScroll?this.inherited(arguments):u.call(this,a)}:u,getScrollPosition:n("touch")?function(){return this.useTouchScroll?this.inherited(arguments):g.call(this)}:g,get:function(a){var b="_get"+a.charAt(0).toUpperCase()+a.slice(1);return"function"===typeof this[b]?this[b].apply(this,[].slice.call(arguments,
1)):this[a]},set:function(a,b){if("object"===typeof a)for(var c in a)this.set(c,a[c]);else c="_set"+a.charAt(0).toUpperCase()+a.slice(1),"function"===typeof this[c]?this[c].apply(this,[].slice.call(arguments,1)):this[a]=b;return this},_getClass:b,_setClass:a,_getClassName:b,_setClassName:a,_setSort:function(a,b){this._sort="string"!=typeof a?a:[{attribute:a,descending:b}];this.refresh();this._lastCollection&&(a.length&&("string"!=typeof a&&(b=a[0].descending,a=a[0].attribute),this._lastCollection.sort(function(c,
d){c=c[a];d=d[a];void 0===c&&(c="");void 0===d&&(d="");return c==d?0:c>d==!b?1:-1})),this.renderArray(this._lastCollection))},sort:function(a,b){k.deprecated("sort(...)",'use set("sort", ...) instead',"dgrid 0.4");this.set("sort",a,b)},_getSort:function(){return this._sort},_setShowHeader:function(a){var b=this.headerNode;this.showHeader=a;d(b,(a?"!":".")+"dgrid-header-hidden");this.renderHeader();this.resize();a&&(b.scrollLeft=this.getScrollPosition().x)},setShowHeader:function(a){k.deprecated("setShowHeader(...)",
'use set("showHeader", ...) instead',"dgrid 0.4");this.set("showHeader",a)},_setShowFooter:function(a){this.showFooter=a;d(this.footerNode,(a?"!":".")+"dgrid-footer-hidden");this.resize()}})})},"dgrid/util/misc":function(){define(["dojo/has","put-selector/put"],function(k,e){k.add("dom-contains",function(d,c,a){return!!a.contains});var p=[],q,n,l,h=/([^A-Za-z0-9_\u00A0-\uFFFF-])/g,f={defaultDelay:15,throttle:function(d,c,a){var b=!1;a=a||f.defaultDelay;return function(){b||(b=!0,d.apply(c,arguments),
setTimeout(function(){b=!1},a))}},throttleDelayed:function(d,c,a){var b=!1;a=a||f.defaultDelay;return function(){if(!b){b=!0;var g=arguments;setTimeout(function(){b=!1;d.apply(c,g)},a)}}},debounce:function(d,c,a){var b;a=a||f.defaultDelay;return function(){b&&(clearTimeout(b),b=null);var g=arguments;b=setTimeout(function(){d.apply(c,g)},a)}},each:function(d,c,a){var b,g;if(d)if("number"===typeof d.length)for(b=0,g=d.length;b<g;b++)c.call(a,d[b],b,d);else for(b in d)c.call(a,d[b],b,d)},contains:function(d,
c){return k("dom-contains")?d.contains(c):d.compareDocumentPosition(c)&8},addCssRule:function(d,c){q||(q=e(document.getElementsByTagName("head")[0],"style"),q=q.sheet||q.styleSheet,n=q.deleteRule?"deleteRule":"removeRule",l=q.cssRules?"cssRules":"rules");var a=p.length;p[a]=(q.cssRules||q.rules).length;q.addRule?q.addRule(d,c):q.insertRule(d+"{"+c+"}",p[a]);return{get:function(b){return q[l][p[a]].style[b]},set:function(b,c){"undefined"!==typeof p[a]&&(q[l][p[a]].style[b]=c)},remove:function(){var b=
p[a],c,d;if(void 0!==b)for(q[n](b),p[a]=void 0,c=a+1,d=p.length;c<d;c++)p[c]>b&&p[c]--}}},escapeCssIdentifier:function(d,c){return"string"===typeof d?d.replace(h,c||"\\$1"):d}};return f})},"xstyle/has-class":function(){define(["dojo/has"],function(k){var e={};return function(){for(var p,q=arguments,n=0;n<q.length;n++)if(p=q[n],!e[p]){e[p]=!0;var l=p.match(/^(no-)?(.+?)((-[\d\.]+)(-[\d\.]+)?)?$/),h=k(l[2]),f=-l[4];(0<f?f<=h&&(-l[5]||f)>=h:!!h)==!l[1]&&(document.documentElement.className+=" has-"+p)}}})},
"xstyle/css":function(){define(["require"],function(k){function e(e,k,n){var l=document.documentElement;e=l.insertBefore(document.createElement(e),l.firstChild);e.id=k;k=(e.currentStyle||getComputedStyle(e,null)||{})[n];l.removeChild(e);return k}return{load:function(p,q,n,l){function h(a){var b=e("x-parse",null,"content"),c=a&&(a.sheet||a.styleSheet);b&&"none"!=b&&"normal"!=b?q([eval(b)],function(b){a?b.process(a,n):(b.processAll(),n(c))}):n(c)}var f=q.toUrl(p),d;f.match(/!$/)&&(d={wait:!1},f=f.slice(0,
-1));var c=q.cache&&q.cache["url:"+f];if(c)c.xCss&&(c=c.cssText),k(["./core/load-css"],function(a){h(a.insertCss(c))});else{if("none"==e("div",p.replace(/\//g,"-").replace(/\..*/,"")+"-loaded","display"))return h();k(["./core/load-css"],function(a){a(f,h,d)})}}}})},"dgrid/OnDemandList":function(){define("./List ./_StoreMixin dojo/_base/declare dojo/_base/lang dojo/_base/Deferred dojo/dom dojo/on ./util/misc put-selector/put".split(" "),function(k,e,p,q,n,l,h,f,d){return p("dgrid.OnDemandList",[k,
e],{minRowsPerPage:25,maxRowsPerPage:250,maxEmptySpace:Infinity,bufferRows:10,farOffRemoval:2E3,queryRowsOverlap:0,pagingMethod:"debounce",pagingDelay:f.defaultDelay,keepScrollPosition:!1,rowHeight:22,postCreate:function(){this.inherited(arguments);var c=this;h(this.bodyNode,"scroll",f[this.pagingMethod](function(a){c._processScroll(a)},null,this.pagingDelay))},destroy:function(){this.inherited(arguments);this._refreshTimeout&&clearTimeout(this._refreshTimeout)},renderQuery:function(c,a){function b(a){d(w,
"!");if(a)throw g._refreshDeferred&&(g._refreshDeferred.reject(a),delete g._refreshDeferred),a;}var g=this,e=a&&a.container||this.contentNode,f={query:c,count:0,options:a},h,k=this.preload,l,p={node:d(e,"div.dgrid-preload",{rowIndex:0}),count:0,query:c,next:f,options:a};p.node.style.height="0";f.node=h=d(e,"div.dgrid-preload");f.previous=p;h.rowIndex=this.minRowsPerPage;k?((f.next=k.next)&&h.offsetTop>=k.node.offsetTop?f.previous=k:(f.next=k,f.previous=k.previous),f.previous.next=f,f.next.previous=
f):this.preload=f;var w=d(h,"-div.dgrid-loading");d(w,"div.dgrid-below").innerHTML=this.loadingMessage;a=q.mixin(this.get("queryOptions"),a,{start:0,count:this.minRowsPerPage},"level"in c?{queryLevel:c.level}:null);this._trackError(function(){return l=c(a)});if("undefined"===typeof l)b();else return n.when(g.renderArray(l,h,a),function(c){return n.when("undefined"===typeof l.total?l.length:l.total,function(b){var e=c.length,m=h.parentNode,k=g.noDataNode;d(w,"!");"queryLevel"in a||(g._total=b);0===
b&&m&&(k&&(d(k,"!"),delete g.noDataNode),g.noDataNode=k=d("div.dgrid-no-data"),m.insertBefore(k,g._getFirstRowSibling(m)),k.innerHTML=g.noDataMessage);for(k=m=0;k<e;k++)m+=g._calcRowHeight(c[k]);e&&m&&(g.rowHeight=m/e);m=g.rowHeight*g.bufferRows;m>g.farOffRemoval&&(g.farOffRemoval=m);b-=e;f.count=b;h.rowIndex=e;b?h.style.height=Math.min(b*g.rowHeight,g.maxEmptySpace)+"px":(h.style.display="none",a.count++);g._previousScrollPosition&&(g.scrollTo(g._previousScrollPosition),delete g._previousScrollPosition);
g._processScroll();g._refreshDeferred&&(g._refreshDeferred.resolve(l),delete g._refreshDeferred);return c},b)},b),l},refresh:function(c){var a=this,b=c&&c.keepScrollPosition,d;"undefined"===typeof b&&(b=this.keepScrollPosition);b&&(this._previousScrollPosition=this.getScrollPosition());this.inherited(arguments);if(this.store)return b=this._refreshDeferred=new n,d=a.renderQuery(function(b){return a.store.query(a.query,b)}),"undefined"===typeof d&&b.reject(),b.then(function(b){a._refreshTimeout=setTimeout(function(){h.emit(a.domNode,
"dgrid-refresh-complete",{bubbles:!0,cancelable:!1,grid:a,results:b});a._refreshTimeout=null},0);delete a._refreshDeferred;return b},function(b){delete a._refreshDeferred;throw b;})},resize:function(){this.inherited(arguments);this._processScroll()},_getFirstRowSibling:function(c){return c.lastChild},_calcRowHeight:function(c){var a=c.nextSibling;return a&&!/\bdgrid-preload\b/.test(a.className)?a.offsetTop-c.offsetTop:c.offsetHeight},lastScrollTop:0,_processScroll:function(c){function a(a,c,g,e){var h=
f.farOffRemoval,m=a.node;if(c>2*h){for(var k,l=m[g],n=0,p=0,r=[];k=l;){var t=f._calcRowHeight(k);if(n+t+h>c||0>l.className.indexOf("dgrid-row")&&0>l.className.indexOf("dgrid-loading"))break;l=k[g];n+=t;p+=k.count||1;f.removeRow(k,!0);r.push(k)}a.count+=p;e?(m.rowIndex-=p,b(a)):m.style.height=m.offsetHeight+n+"px";var q=d("div",r);setTimeout(function(){d(q,"!")},1)}}function b(a,b){a.node.style.height=Math.min(a.count*f.rowHeight,b?Infinity:f.maxEmptySpace)+"px"}function g(a,b){do a=b?a.next:a.previous;
while(a&&!a.node.offsetWidth);return a}var f=this,e=f.bodyNode;c=c&&c.scrollTop||this.getScrollPosition().y;var e=e.offsetHeight+c,h,k,l=f.preload,p=f.lastScrollTop,w=f.bufferRows*f.rowHeight,z=w-f.rowHeight,x,A,C,B=!0;for(f.lastScrollTop=c;l&&!l.node.offsetWidth;)l=l.previous;for(;l&&l!=h;){h=f.preload;f.preload=l;k=l.node;var E=k.offsetTop;if(e+1+z<E)l=g(l,B=!1);else if(c-1-z>E+k.offsetHeight)l=g(l,B=!0);else{var D=((k.rowIndex?c-w:e)-E)/f.rowHeight,E=(e-c+2*w)/f.rowHeight,E=E+Math.min(Math.abs(Math.max(Math.min((c-
p)*f.rowHeight,f.maxRowsPerPage/2),f.maxRowsPerPage/-2)),10);0==k.rowIndex&&(D-=E);D=Math.max(D,0);10>D&&0<D&&E+D<f.maxRowsPerPage&&(E+=Math.max(0,D),D=0);E=Math.min(Math.max(E,f.minRowsPerPage),f.maxRowsPerPage,l.count);if(0==E)l=g(l,B);else{var E=Math.ceil(E),D=Math.min(Math.floor(D),l.count-E),F=q.mixin(f.get("queryOptions"),l.options);l.count-=E;var I=k,M,L=f.queryRowsOverlap,J=(0<k.rowIndex||k.offsetTop>c)&&l;if(J){var P=l.previous;P&&(a(P,c-(P.node.offsetTop+P.node.offsetHeight),"nextSibling"),
0<D&&P.node==k.previousSibling?(D=Math.min(l.count,D),l.previous.count+=D,b(l.previous,!0),k.rowIndex+=D,L=0):E+=D,l.count-=D);F.start=k.rowIndex-L;F.count=Math.min(E+L,f.maxRowsPerPage);k.rowIndex=F.start+F.count}else l.next&&(a(l.next,l.next.node.offsetTop-e,"previousSibling",!0),I=k.nextSibling,I==l.next.node?(l.next.count+=l.count-D,l.next.node.rowIndex=D+E,b(l.next),l.count=D,L=0):M=!0),F.start=l.count,F.count=Math.min(E+L,f.maxRowsPerPage);M&&I&&I.offsetWidth&&(M=I.offsetTop);b(l);"level"in
l.query&&(F.queryLevel=l.query.level);if("queryLevel"in F||!(F.start>f._total||0>F.count)){k=d(I,"-div.dgrid-loading[style\x3dheight:"+E*f.rowHeight+"px]");d(k,"div.dgrid-"+(J?"below":"above")).innerHTML=f.loadingMessage;k.count=E;var K=l.query(F);if(void 0===f._trackError(function(){return K})){d(k,"!");return}(function(a,c,g,e){C=n.when(f.renderArray(e,a,F),function(h){A=e;I=a.nextSibling;d(a,"!");if(g&&I&&I.offsetWidth){var m=f.getScrollPosition();f.scrollTo({x:m.x,y:m.y+I.offsetTop-g,preserveMomentum:!0})}n.when(e.total||
e.length,function(a){"queryLevel"in F||(f._total=a);c&&(c.count=a-c.node.rowIndex,0===c.count&&F.count++,b(c))});f._processScroll();return h},function(b){d(a,"!");throw b;})}).call(this,k,J,M,K);l=l.previous}}}}C&&(x=this._refreshDeferred)&&(delete this._refreshDeferred,n.when(C,function(){x.resolve(A)}))},removeRow:function(c,a){if(c){var b=c.previousSibling,d=c.nextSibling,f;if(f=b)f=b.observerIndex,f=null!=f?f:b.previousObserverIndex;b=f;if(f=d)f=d.observerIndex,f=null!=f?f:d.nextObserverIndex;
d=c.observerIndex;c.observerIndex=void 0;a&&(c.nextObserverIndex=f,c.previousObserverIndex=b);if(this.cleanEmptyObservers&&-1<d&&d!==b&&d!==f&&(b=this.observers,f=b[d])){if(!a)for(var e=f.rows,h=0;h<e.length;h++)if(e[h]!=c&&l.isDescendant(e[h],this.domNode))return this.inherited(arguments);f.cancel();this._numObservers--;b[d]=0}}this.inherited(arguments)}})})},"dgrid/_StoreMixin":function(){define("dojo/_base/kernel dojo/_base/declare dojo/_base/lang dojo/_base/Deferred dojo/on dojo/aspect put-selector/put".split(" "),
function(k,e,p,q,n,l,h){function f(c){return c}function d(c){if("object"!==typeof c)c=Error(c);else if("cancel"===c.dojoType)return;c.grid=this;n.emit(this.domNode,"dgrid-error",{grid:this,error:c,cancelable:!0,bubbles:!0})&&console.error(c)}return e("dgrid._StoreMixin",null,{store:null,query:null,queryOptions:null,getBeforePut:!0,noDataMessage:"",loadingMessage:"",constructor:function(){this.query={};this.queryOptions={};this.dirty={};this._updating={};this._columnsWithSet={};l.before(this,"configStructure",
p.hitch(this,function(){this._columnsWithSet={}}))},postCreate:function(){this.inherited(arguments);this.store&&this._updateNotifyHandle(this.store)},destroy:function(){this.inherited(arguments);this._notifyHandle&&this._notifyHandle.remove()},_configColumn:function(c){c.set&&(this._columnsWithSet[c.field]=c);this.inherited(arguments)},_updateNotifyHandle:function(c){this._notifyHandle&&(this._notifyHandle.remove(),delete this._notifyHandle);c&&"function"===typeof c.notify&&this.shouldObserveStore&&
(this._notifyHandle=l.after(c,"notify",p.hitch(this,"_onNotify"),!0),(c=this.get("sort"))&&c.length||console.warn("Observable store detected, but no sort order specified. You may experience quirks when adding/updating items.  These can be resolved by setting a sort order on the list or grid."))},_setStore:function(c,a,b){this._updateNotifyHandle(c);this.store=c;this.dirty={};this.set("query",a,b)},_setQuery:function(c,a){var b=a&&a.sort;this.query=void 0!==c?c:this.query;this.queryOptions=a||this.queryOptions;
this._started&&(b?this.set("sort",b):this.refresh())},setStore:function(c,a,b){k.deprecated("setStore(...)",'use set("store", ...) instead',"dgrid 0.4");this.set("store",c,a,b)},setQuery:function(c,a){k.deprecated("setQuery(...)",'use set("query", ...) instead',"dgrid 0.4");this.set("query",c,a)},_getQueryOptions:function(){var c=p.delegate(this.queryOptions,{});if("function"===typeof this._sort||this._sort.length)c.sort=this._sort;return c},_getQuery:function(){var c=this.query;return"object"==typeof c&&
null!=c?p.delegate(c,{}):c},_setSort:function(c,a){this.store&&(this._lastCollection=null);this.inherited(arguments)},_onNotify:function(c,a){this.inherited(arguments);c&&1>this._numObservers&&this.refresh({keepScrollPosition:!0})},refresh:function(){var c=this.inherited(arguments);this.store||(this.noDataNode=h(this.contentNode,"div.dgrid-no-data"),this.noDataNode.innerHTML=this.noDataMessage);return c},renderArray:function(){var c=this,a=this.inherited(arguments);this.store||q.when(a,function(a){a.length&&
c.noDataNode&&h(c.noDataNode,"!")});return a},insertRow:function(c,a,b,d,f){var g=this.store,e=this.dirty,g=g&&g.getIdentity(c),h;g in e&&!(g in this._updating)&&(h=e[g]);h&&(c=p.delegate(c,h));return this.inherited(arguments)},updateDirty:function(c,a,b){var d=this.dirty,f=d[c];f||(f=d[c]={});f[a]=b},setDirty:function(c,a,b){k.deprecated("setDirty(...)","use updateDirty() instead","dgrid 0.4");this.updateDirty(c,a,b)},save:function(){function c(c,g){return function(f){var e=a._columnsWithSet,h=a._updating,
m,k;if("function"===typeof f.set)f.set(g);else for(m in g)f[m]=g[m];for(m in e)k=e[m].set(f),void 0!==k&&(f[m]=k);h[c]=!0;return q.when(b.put(f),function(){delete d[c];delete h[c]})}}var a=this,b=this.store,d=this.dirty,f=new q,e=f.promise,h=function(c){var d;return a.getBeforePut||!(d=a.row(c).data)?function(){return b.get(c)}:function(){return d}},k;for(k in d)var l=c(k,d[k]),e=e.then(h(k)).then(l);f.resolve();return e},revert:function(){this.dirty={};this.refresh()},_trackError:function(c){var a;
"string"==typeof c&&(c=p.hitch(this,c));try{a=c()}catch(b){d.call(this,b)}return q.when(a,f,p.hitch(this,d))},newRow:function(){var c=this.inherited(arguments);this.noDataNode&&(h(this.noDataNode,"!"),delete this.noDataNode);return c},removeRow:function(c,a){var b={element:c};!a&&this.noDataMessage&&this.up(b).element===c&&this.down(b).element===c&&(this.noDataNode=h(this.contentNode,"div.dgrid-no-data"),this.noDataNode.innerHTML=this.noDataMessage);return this.inherited(arguments)}})})},"dgrid/Selection":function(){define("dojo/_base/kernel dojo/_base/declare dojo/_base/Deferred dojo/on dojo/has dojo/aspect ./List dojo/has!touch?./util/touch put-selector/put dojo/query dojo/_base/sniff".split(" "),
function(k,e,p,q,n,l,h,f,d){function c(a,b){b=a.unselectable=b?"on":"";a=a.getElementsByTagName("*");for(var c=a.length;--c;)"INPUT"!==a[c].tagName&&"TEXTAREA"!==a[c].tagName&&(a[c].unselectable=b)}function a(a,b){var d=a.bodyNode,f=b?"text":21>n("ff")?"-moz-none":"none";g&&"msUserSelect"!==g?d.style[g]=f:n("dom-selectstart")?b||a._selectstartHandle?b&&a._selectstartHandle&&(a._selectstartHandle.remove(),delete a._selectstartHandle):a._selectstartHandle=q(d,"selectstart",function(a){var b=a.target&&
a.target.tagName;"INPUT"!==b&&"TEXTAREA"!==b&&a.preventDefault()}):(c(d,!b),b||a._unselectableHandle)?b&&a._unselectableHandle&&(a._unselectableHandle.remove(),delete a._unselectableHandle):a._unselectableHandle=l.after(a,"renderRow",function(a){c(a,!0);return a})}n.add("dom-comparedocumentposition",function(a,b,c){return!!c.compareDocumentPosition});n.add("pointer",function(a){return"PointerEvent"in a?"pointer":"MSPointerEvent"in a?"MSPointer":!1});n.add("css-user-select",function(a,b,c){a=c.style;
b=["Khtml","O","ms","Moz","Webkit"];c=b.length;var d="userSelect";do if("undefined"!==typeof a[d])return d;while(c--&&(d=b[c]+"UserSelect"));return!1});n.add("dom-selectstart","undefined"!==typeof document.onselectstart);var b=n("mac")?"metaKey":"ctrlKey",g=n("css-user-select"),u=(h=n("pointer"))&&"MS"===h.slice(0,2),m=h?h+(u?"Down":"down"):"mousedown",r=h?h+(u?"Up":"up"):"mouseup";"WebkitUserSelect"===g&&"undefined"!==typeof document.documentElement.style.msUserSelect&&(g=!1);return e("dgrid.Selection",
null,{selectionDelegate:".dgrid-row",selectionEvents:m+","+r+",dgrid-cellfocusin",selectionTouchEvents:n("touch")?f.tap:null,deselectOnRefresh:!0,allowSelectAll:!1,selection:{},selectionMode:"extended",allowTextSelection:void 0,_selectionTargetType:"rows",create:function(){this.selection={};return this.inherited(arguments)},postCreate:function(){this.inherited(arguments);this._initSelectionEvents();var a=this.selectionMode;this.selectionMode="";this._setSelectionMode(a)},destroy:function(){this.inherited(arguments);
this._selectstartHandle&&this._selectstartHandle.remove();this._unselectableHandle&&this._unselectableHandle.remove();this._removeDeselectSignals&&this._removeDeselectSignals()},_setSelectionMode:function(a){a!=this.selectionMode&&(this.clearSelection(),this.selectionMode=a,this._selectionHandlerName="_"+a+"SelectionHandler",this._setAllowTextSelection(this.allowTextSelection))},setSelectionMode:function(a){k.deprecated("setSelectionMode(...)",'use set("selectionMode", ...) instead',"dgrid 0.4");
this.set("selectionMode",a)},_setAllowTextSelection:function(b){"undefined"!==typeof b?a(this,b):a(this,"none"===this.selectionMode);this.allowTextSelection=b},_handleSelect:function(a,b){if(this[this._selectionHandlerName]&&this.allowSelect(this.row(b))&&("dgrid-cellfocusin"!==a.type||"mousedown"!==a.parentType)&&(a.type!==r||b==this._waitForMouseUp)){this._waitForMouseUp=null;this._selectionTriggerEvent=a;if(!a.keyCode||!a.ctrlKey||32==a.keyCode)if(!a.shiftKey&&a.type===m&&this.isSelected(b))this._waitForMouseUp=
b;else this[this._selectionHandlerName](a,b);this._selectionTriggerEvent=null}},_singleSelectionHandler:function(a,c){a=a.keyCode?a.ctrlKey:a[b];this._lastSelected===c?this.select(c,null,!a||!this.isSelected(c)):(this.clearSelection(),this.select(c),this._lastSelected=c)},_multipleSelectionHandler:function(a,c){var d=this._lastSelected,g=a.keyCode?a.ctrlKey:a[b],f;a.shiftKey||(f=g?null:!0,d=null);this.select(c,d,f);d||(this._lastSelected=c)},_extendedSelectionHandler:function(a,c){(2===a.button?this.isSelected(c):
a.keyCode?a.ctrlKey:a[b])||this.clearSelection(null,!0);this._multipleSelectionHandler(a,c)},_toggleSelectionHandler:function(a,b){this.select(b,null,null)},_initSelectionEvents:function(){var a=this,c=this.contentNode,d=this.selectionDelegate;this._selectionEventQueues={deselect:[],select:[]};n("touch")&&!n("pointer")&&this.selectionTouchEvents?(q(c,f.selector(d,this.selectionTouchEvents),function(b){a._handleSelect(b,this);a._ignoreMouseSelect=this}),q(c,q.selector(d,this.selectionEvents),function(b){a._ignoreMouseSelect!==
this?a._handleSelect(b,this):b.type===r&&(a._ignoreMouseSelect=null)})):q(c,q.selector(d,this.selectionEvents),function(b){a._handleSelect(b,this)});this.addKeyHandler&&this.addKeyHandler(32,function(b){a._handleSelect(b,b.target)});if(this.allowSelectAll)this.on("keydown",function(c){c[b]&&65==c.keyCode&&!/\bdgrid-input\b/.test(c.target.className)&&(c.preventDefault(),a[a.allSelected?"clearSelection":"selectAll"]())});this._setStore&&l.after(this,"_setStore",function(){a._updateDeselectionAspect()});
this._updateDeselectionAspect()},_updateDeselectionAspect:function(){function a(a,c,d){a=c||a&&a[b.idProperty||"id"];if(null!=a&&(c=(a=b.row(a))&&b.selection[a.id]))b[d](a,null,c)}var b=this,c=this.store,d,g;this._removeDeselectSignals&&this._removeDeselectSignals();c&&c.notify?(d=l.before(c,"notify",function(b,c){b||a(b,c,"deselect")}),g=l.after(c,"notify",function(b,c){a(b,c,"select")},!0),this._removeDeselectSignals=function(){d.remove();g.remove()}):(d=l.before(this,"removeRow",function(a,b){b||
(a=this.row(a))&&a.id in this.selection&&this.deselect(a)}),this._removeDeselectSignals=function(){d.remove()})},allowSelect:function(a){return!0},_fireSelectionEvent:function(a){var b=this._selectionEventQueues[a],c=this._selectionTriggerEvent,d;d={bubbles:!0,grid:this};c&&(d.parentType=c.type);d[this._selectionTargetType]=b;this._selectionEventQueues[a]=[];q.emit(this.contentNode,"dgrid-"+a,d)},_fireSelectionEvents:function(){var a=this._selectionEventQueues,b;for(b in a)a[b].length&&this._fireSelectionEvent(b)},
_select:function(a,b,c){var g,f,e;"undefined"===typeof c&&(c=!0);a.element||(a=this.row(a));if(!1===c||this.allowSelect(a))if(g=this.selection,f=!!g[a.id],null===c&&(c=!f),e=a.element,c||this.allSelected?g[a.id]=c:delete this.selection[a.id],e&&(c?d(e,".dgrid-selected"+(this.addUiClasses?".ui-state-active":"")):d(e,"!dgrid-selected!ui-state-active")),c!==f&&e&&this._selectionEventQueues[(c?"":"de")+"select"].push(a),b)if(b.element||(b=this.row(b)),b){if(b=b.element)for(g=this._determineSelectionDirection(e,
b),g||(b=document.getElementById(b.id),g=this._determineSelectionDirection(e,b));a.element!=b&&(a=this[g](a));)this._select(a,null,c)}else this._lastSelected=e,console.warn("The selection range has been reset because the beginning of the selection is no longer in the DOM. If you are using OnDemandList, you may wish to increase farOffRemoval to avoid this, but note that keeping more nodes in the DOM may impact performance.")},_determineSelectionDirection:n("dom-comparedocumentposition")?function(a,
b){a=b.compareDocumentPosition(a);return a&1?!1:2===a?"down":"up"}:function(a,b){return 1>b.sourceIndex?!1:b.sourceIndex>a.sourceIndex?"down":"up"},select:function(a,b,c){this._select(a,b,c);this._fireSelectionEvents()},deselect:function(a,b){this.select(a,b,!1)},clearSelection:function(a,b){this.allSelected=!1;for(var c in this.selection)a!==c&&this._select(c,null,!1);b||(this._lastSelected=null);this._fireSelectionEvents()},selectAll:function(){this.allSelected=!0;this.selection={};for(var a in this._rowIdToObject){var b=
this.row(this._rowIdToObject[a]);this._select(b.id,null,!0)}this._fireSelectionEvents()},isSelected:function(a){if("undefined"===typeof a||null===a)return!1;a.element||(a=this.row(a));return a.id in this.selection?!!this.selection[a.id]:this.allSelected&&(!a.data||this.allowSelect(a))},refresh:function(){this.deselectOnRefresh&&this.clearSelection();this._lastSelected=null;return this.inherited(arguments)},renderArray:function(){var a=this,b=this.inherited(arguments);p.when(b,function(b){var c=a.selection,
d,g,f;for(d=0;d<b.length;d++)g=a.row(b[d]),(f=g.id in c?c[g.id]:a.allSelected)&&a._select(g,null,f);a._fireSelectionEvents()});return b}})})},"dgrid/Keyboard":function(){define("dojo/_base/declare dojo/aspect dojo/on dojo/_base/lang dojo/has put-selector/put ./util/misc dojo/_base/Deferred dojo/_base/sniff".split(" "),function(k,e,p,q,n,l,h,f){function d(a){a.preventDefault()}var c={checkbox:1,radio:1,button:1},a=/\bdgrid-cell\b/,b=/\bdgrid-row\b/,g=k("dgrid.Keyboard",null,{pageSkip:10,tabIndex:0,
keyMap:null,headerKeyMap:null,postMixInProperties:function(){this.inherited(arguments);this.keyMap||(this.keyMap=q.mixin({},g.defaultKeyMap));this.headerKeyMap||(this.headerKeyMap=q.mixin({},g.defaultHeaderKeyMap))},postCreate:function(){function d(a){var b=a.target;return b.type&&(!c[b.type]||32==a.keyCode)}function g(c){function g(){m._focusedHeaderNode&&(m._focusedHeaderNode.tabIndex=-1);if(m.showHeader){if(k)for(var a=0,b,c=m.headerNode.getElementsByTagName("th");b=c[a];++a){if(l.test(b.className)){m._focusedHeaderNode=
r=b;break}}else m._focusedHeaderNode=r=m.headerNode;r&&(r.tabIndex=m.tabIndex)}}var k=m.cellNavigation,l=k?a:b,n=c===m.headerNode,r=c;n?(g(),e.after(m,"renderHeader",g,!0)):e.after(m,"renderArray",function(a){return f.when(a,function(a){var b=m._focusedNode||r;if(l.test(b.className)&&h.contains(c,b))return a;for(var d=0,g=c.getElementsByTagName("*"),f;f=g[d];++d)if(l.test(f.className)){b=m._focusedNode=f;break}b.tabIndex=m.tabIndex;return a})});m._listeners.push(p(c,"mousedown",function(a){d(a)||
m._focusOnNode(a.target,n,a)}));m._listeners.push(p(c,"keydown",function(a){if(!a.metaKey&&!a.altKey){var b=m[n?"headerKeyMap":"keyMap"][a.keyCode];b&&!d(a)&&b.call(m,a)}}))}this.inherited(arguments);var m=this;this.tabableHeader&&(g(this.headerNode),p(this.headerNode,"dgrid-cellfocusin",function(){m.scrollTo({x:this.scrollLeft})}));g(this.contentNode);this._debouncedEnsureRowScroll=h.debounce(this._ensureRowScroll,this)},removeRow:function(a){if(!this._focusedNode)return this.inherited(arguments);
var b=this,c=document.activeElement===this._focusedNode,d=this[this.cellNavigation?"cell":"row"](this._focusedNode),g=d.row||d,f;a=a.element||a;a===g.element&&((f=this.down(g,!0))&&f.element!==a||(f=this.up(g,!0)),this._removedFocus={active:c,rowId:g.id,columnId:d.column&&d.column.id,siblingId:f&&f.element!==a?f.id:void 0},setTimeout(function(){b._removedFocus&&b._restoreFocus(g.id)},0),this._focusedNode=null);this.inherited(arguments)},insertRow:function(a){var b=this.inherited(arguments);this._removedFocus&&
!this._removedFocus.wait&&this._restoreFocus(b);return b},_restoreFocus:function(a){var b=this._removedFocus,c;if((a=(a=a&&this.row(a))&&a.element&&a.id===b.rowId?a:"undefined"!==typeof b.siblingId&&this.row(b.siblingId))&&a.element){if(!a.element.parentNode.parentNode){b.wait=!0;return}"undefined"!==typeof b.columnId&&(c=this.cell(a,b.columnId))&&c.element&&(a=c);b.active&&0!==a.element.offsetHeight?this._focusOnNode(a,!1,null):(l(a.element,".dgrid-focus"),a.element.tabIndex=this.tabIndex,this._focusedNode=
a.element)}delete this._removedFocus},addKeyHandler:function(a,b,c){return e.after(this[c?"headerKeyMap":"keyMap"],a,b,!0)},_ensureRowScroll:function(a){var b=this.getScrollPosition().y;b>a.offsetTop?this.scrollTo({y:a.offsetTop}):b+this.contentNode.offsetHeight<a.offsetTop+a.offsetHeight&&this.scrollTo({y:a.offsetTop-this.contentNode.offsetHeight+a.offsetHeight})},_focusOnNode:function(c,d,g){var f="_focused"+(d?"Header":"")+"Node",e=this[f],h=this.cellNavigation?"cell":"row",m=this[h](c),k,r,t,
u,v;if(c=m&&m.element){if(this.cellNavigation)for(k=c.getElementsByTagName("input"),v=0,t=k.length;v<t;v++)if(r=k[v],(-1!=r.tabIndex||"_dgridLastValue"in r)&&!r.disabled){8>n("ie")&&(r.style.position="relative");r.focus();8>n("ie")&&(r.style.position="");u=!0;break}null!==g&&(g=q.mixin({grid:this},g),g.type&&(g.parentType=g.type),g.bubbles||(g.bubbles=!0));e&&(l(e,"!dgrid-focus[!tabIndex]"),8>n("ie")&&(e.style.position=""),g&&(g[h]=this[h](e),p.emit(e,"dgrid-cellfocusout",g)));e=this[f]=c;g&&(g[h]=
m);f=this.cellNavigation?a:b;!u&&f.test(c.className)&&(8>n("ie")&&(c.style.position="relative"),c.tabIndex=this.tabIndex,c.focus());l(c,".dgrid-focus");g&&p.emit(e,"dgrid-cellfocusin",g);this.cellNavigation&&(this.columnSets||1<this.subRows.length)&&!d&&this._debouncedEnsureRowScroll(m.row.element)}},focusHeader:function(a){this._focusOnNode(a||this._focusedHeaderNode,!0)},focus:function(a){(a=a||this._focusedNode)?this._focusOnNode(a,!1):this.contentNode.focus()}}),u=g.moveFocusVertical=function(a,
b){var c=this.cellNavigation,d=this[c?"cell":"row"](a),d=c&&d.column.id;b=this.down(this._focusedNode,b,!0);c&&(b=this.cell(b,d));this._focusOnNode(b,!1,a);a.preventDefault()};k=g.moveFocusUp=function(a){u.call(this,a,-1)};var m=g.moveFocusDown=function(a){u.call(this,a,1)},r=g.moveFocusPageUp=function(a){u.call(this,a,-this.pageSkip)},t=g.moveFocusPageDown=function(a){u.call(this,a,this.pageSkip)},v=g.moveFocusHorizontal=function(a,b){if(this.cellNavigation){var c=!this.row(a);this._focusOnNode(this.right(this["_focused"+
(c?"Header":"")+"Node"],b),c,a);a.preventDefault()}},y=g.moveFocusLeft=function(a){v.call(this,a,-1)},w=g.moveFocusRight=function(a){v.call(this,a,1)},z=g.moveHeaderFocusEnd=function(a,b){var c;this.cellNavigation&&(c=this.headerNode.getElementsByTagName("th"),this._focusOnNode(c[b?0:c.length-1],!0,a));a.preventDefault()},x=g.moveHeaderFocusHome=function(a){z.call(this,a,!0)},A=g.moveFocusEnd=function(a,b){var c=this,d=this.cellNavigation,g=this.contentNode,h=g.scrollTop+(b?0:g.scrollHeight),g=g[b?
"firstChild":"lastChild"],m=-1<g.className.indexOf("dgrid-preload"),k=m?g[(b?"next":"previous")+"Sibling"]:g,l=k.offsetTop+(b?0:k.offsetHeight),p;if(m){for(;k&&0>k.className.indexOf("dgrid-row");)k=k[(b?"next":"previous")+"Sibling"];if(!k)return}!m||1>g.offsetHeight?(d&&(k=this.cell(k,this.cell(a).column.id)),this._focusOnNode(k,!1,a)):(n("dom-addeventlistener")||(a=q.mixin({},a)),p=e.after(this,"renderArray",function(g){p.remove();return f.when(g,function(g){g=g[b?0:g.length-1];d&&(g=c.cell(g,c.cell(a).column.id));
c._focusOnNode(g,!1,a)})}));h===l&&a.preventDefault()},C=g.moveFocusHome=function(a){A.call(this,a,!0)};g.defaultKeyMap={32:d,33:r,34:t,35:A,36:C,37:y,38:k,39:w,40:m};g.defaultHeaderKeyMap={32:d,35:z,36:x,37:y,39:w};return g})},"dojo/NodeList-manipulate":function(){define("./query ./_base/lang ./_base/array ./dom-construct ./dom-attr ./NodeList-dom".split(" "),function(k,e,p,q,n){function l(d){for(;d.childNodes[0]&&1==d.childNodes[0].nodeType;)d=d.childNodes[0];return d}function h(d,c){"string"==
typeof d?(d=q.toDom(d,c&&c.ownerDocument),11==d.nodeType&&(d=d.childNodes[0])):1==d.nodeType&&d.parentNode&&(d=d.cloneNode(!1));return d}var f=k.NodeList;e.extend(f,{_placeMultiple:function(d,c){d="string"==typeof d||d.nodeType?k(d):d;for(var a=[],b=0;b<d.length;b++)for(var g=d[b],f=this.length,e=f-1,h;h=this[e];e--)0<b&&(h=this._cloneNode(h),a.unshift(h)),e==f-1?q.place(h,g,c):g.parentNode.insertBefore(h,g),g=h;a.length&&(a.unshift(0),a.unshift(this.length-1),Array.prototype.splice.apply(this,a));
return this},innerHTML:function(d){return arguments.length?this.addContent(d,"only"):this[0].innerHTML},text:function(d){if(arguments.length){for(var c=0,a;a=this[c];c++)1==a.nodeType&&n.set(a,"textContent",d);return this}for(var b="",c=0;a=this[c];c++)b+=n.get(a,"textContent");return b},val:function(d){if(arguments.length){for(var c=e.isArray(d),a=0,b;b=this[a];a++){var g=b.nodeName.toUpperCase(),f=b.type,h=c?d[a]:d;if("SELECT"==g)for(g=b.options,f=0;f<g.length;f++){var k=g[f];k.selected=b.multiple?
-1!=p.indexOf(d,k.value):k.value==h}else"checkbox"==f||"radio"==f?b.checked=b.value==h:b.value=h}return this}if((b=this[0])&&1==b.nodeType){d=b.value||"";if("SELECT"==b.nodeName.toUpperCase()&&b.multiple){d=[];g=b.options;for(f=0;f<g.length;f++)k=g[f],k.selected&&d.push(k.value);d.length||(d=null)}return d}},append:function(d){return this.addContent(d,"last")},appendTo:function(d){return this._placeMultiple(d,"last")},prepend:function(d){return this.addContent(d,"first")},prependTo:function(d){return this._placeMultiple(d,
"first")},after:function(d){return this.addContent(d,"after")},insertAfter:function(d){return this._placeMultiple(d,"after")},before:function(d){return this.addContent(d,"before")},insertBefore:function(d){return this._placeMultiple(d,"before")},remove:f.prototype.orphan,wrap:function(d){if(this[0]){d=h(d,this[0]);for(var c=0,a;a=this[c];c++){var b=this._cloneNode(d);a.parentNode&&a.parentNode.replaceChild(b,a);l(b).appendChild(a)}}return this},wrapAll:function(d){if(this[0]){d=h(d,this[0]);this[0].parentNode.replaceChild(d,
this[0]);d=l(d);for(var c=0,a;a=this[c];c++)d.appendChild(a)}return this},wrapInner:function(d){if(this[0]){d=h(d,this[0]);for(var c=0;c<this.length;c++){var a=this._cloneNode(d);this._wrap(e._toArray(this[c].childNodes),null,this._NodeListCtor).wrapAll(a)}}return this},replaceWith:function(d){d=this._normalize(d,this[0]);for(var c=0,a;a=this[c];c++)this._place(d,a,"before",0<c),a.parentNode.removeChild(a);return this},replaceAll:function(d){d=k(d);for(var c=this._normalize(this,this[0]),a=0,b;b=
d[a];a++)this._place(c,b,"before",0<a),b.parentNode.removeChild(b);return this},clone:function(){for(var d=[],c=0;c<this.length;c++)d.push(this._cloneNode(this[c]));return this._wrap(d,this,this._NodeListCtor)}});f.prototype.html||(f.prototype.html=f.prototype.innerHTML);return f})},"jimu/dijit/ImageChooser":function(){define("dojo/Evented dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dojo/_base/lang dojo/_base/html dojo/on dojo/text!./templates/ImageChooser.html dojo/sniff esri/lang ../utils ./_CropImage jimu/dijit/Popup jimu/dijit/Message jimu/dijit/LoadingShelter".split(" "),
function(k,e,p,q,n,l,h,f,d,c,a,b,g,u,m){var r=0;k=e([p,q,k],{templateString:f,declaredClass:"jimu.dijit.ImageChooser",cropImage:!0,displayImg:null,stretchImg:!0,defaultSelfSrc:null,showSelfImg:!1,label:null,showTip:!0,goldenWidth:400,goldenHeight:400,maxSize:1024,format:null,imageData:null,postMixInProperties:function(){this.inherited(arguments);this.nls=window.jimuNls.imageChooser;this.nls.common=window.jimuNls.common;this.nls.readError=this.nls.readError||"Failed to read the file."},postCreate:function(){this._initial();
a.file.supportHTML5()||d("safari")||!a.file.isEnabledFlash()||a.file.loadFileAPI().then(n.hitch(this,function(){l.setStyle(this.mask,"zIndex",1)}))},setImageSize:function(a){this.goldenWidth=a.width;this.goldenHeight=a.height},disableChooseImage:function(){l.setStyle(this.fileForm,"display","none");this.label&&"string"===typeof this.label&&l.addClass(this.displayText,"disable-label");l.removeAttr(this.domNode,"title")},enableChooseImage:function(){l.setStyle(this.fileForm,"display","block");this.label&&
"string"===typeof this.label&&l.removeClass(this.displayText,"disable-label");this._addTip()},setDefaultSelfSrc:function(a){this.defaultSelfSrc=a;this.imageData=this.selfImg.src=a},getImageData:function(){return this.imageData},_initial:function(){this._initFileForm();this._processProperties();this._addTip()},_processProperties:function(){this.fileProperty={};this.label&&"string"===typeof this.label&&(this.displayText.innerHTML=this.label,l.setStyle(this.hintText,"display","block"));this.showSelfImg&&
l.setStyle(this.hintImage,"display","block");!1===this.stretchImg?l.addClass(this.selfImg,"no-stretch-img"):l.removeClass(this.selfImg,"no-stretch-img");this.defaultSelfSrc&&(this.imageData=this.selfImg.src=this.defaultSelfSrc);if(this.format){var b="image/*";"string"===typeof this.format&&/^image\/./.test(this.format)?b=this.format:"[object Array]"===Object.prototype.toString.call(this.format)&&0<this.format.length&&(b=this.format.join(","));l.setAttr(this.fileInput,"accept",b)}a.file.supportHTML5()||
d("safari")||!a.file.isEnabledFlash()||l.setStyle(this.fileInput,{width:"100%",height:"100%",position:"absolute",left:0,top:0,opacity:0,zIndex:9})},_porcessMaskClick:function(){l.setAttr(this.fileInput,"id","imageChooser_"+r);l.setAttr(this.mask,"for","imageChooser_"+r);r++;h.once(this.mask,"click",n.hitch(this,function(b){b.stopPropagation();if(d("safari")&&7>d("safari"))new u({message:this.nls.unsupportReaderAPI}),b.preventDefault();else{if(!a.file.supportHTML5()){if(!a.file.isEnabledFlash()){var c=
l.create("a",{href:"http://helpx.adobe.com/flash-player.html",innerHTML:this.nls.enableFlash,target:"_blank"});new u({message:c});b.preventDefault();return}if(!a.file.supportFileAPI()){new u({message:this.nls.unsupportReaderAPI});b.preventDefault();return}}l.setStyle(this.fileInput,"display","none");setTimeout(n.hitch(this,function(){l.setStyle(this.fileInput,"display","block")}),200)}}))},_addTip:function(){if(this.showTip){var a=c.substitute({width:this.goldenWidth||40,height:this.goldenHeight||
40},this.nls.toolTip);l.setAttr(this.domNode,"title",a)}else l.setAttr(this.domNode,"title","")},_onFileInputChange:function(b){var c=b.target.files&&b.target.files[0]||b.files&&b.files[0];if(this.format&&-1===this.format.indexOf(c.type))new u({message:this.nls.invalidType}),this._initFileForm();else{var d=1024*this.maxSize;a.file.readFile(b,"image/*",d,n.hitch(this,function(a,b,g){a?(b=this.nls[a.errCode],"exceed"===a.errCode&&(b=b.replace("1024",d/1024)),new u({message:b})):(this.fileProperty.fileName=
b,this.cropImage&&"image/gif"!==c.type?this._cropImageByUser(g,c.type):this._readFileData(g));this._initFileForm()}))}},_initFileForm:function(){this.mask&&l.destroy(this.mask);this.fileInput&&l.destroy(this.fileInput);this.fileForm&&l.destroy(this.fileForm);this.fileForm=l.create("form",{"data-dojo-attach-point":"fileForm"},this.domNode);this.mask=l.create("label",{"data-dojo-attach-point":"mask"},this.fileForm);this.fileInput=l.create("input",{type:"file","data-dojo-attach-point":"fileInput"},this.fileForm);
this._porcessMaskClick();h.once(this.fileInput,"change",n.hitch(this,this._onFileInputChange))},_readFileData:function(a){this.onImageChange(a,this.fileProperty);this.displayImg&&l.setAttr(this.displayImg,"src",a);this.showSelfImg&&(this.selfImg?l.setAttr(this.selfImg,"src",a):this.selfImg.src=a,(a=l.getMarginBox(this.hintImage))&&a.w&&a.h&&(l.style(this.selfImg,"maxWidth",a.w+"px"),l.style(this.selfImg,"maxHeight",a.h+"px")))},_cropImageByUser:function(a,c){var d=new b({imageSrc:a,type:c,nls:n.clone(this.nls),
goldenWidth:this.goldenWidth,goldenHeight:this.goldenHeight}),f=new m({hidden:!0}),e=new g({titleLabel:this.nls.cropImage,content:d,width:500,height:480,buttons:[{label:this.nls.common.ok,onClick:n.hitch(this,function(){f.show();var a=d.getData();this._readFileData(a);e.close();d.destroy();f.hide()})}]});f.placeAt(e.domNode);d.startup();l.addClass(e.domNode,"image-chooser-crop-popup")},onImageChange:function(a){this.imageData=a;this.emit("imageChange",this.imageData,this.fileProperty);this.emit("change",
this.imageData,this.fileProperty)}});k.GIF="image/gif";k.JPEG="image/jpeg";k.PNG="image/png";return k})},"jimu/dijit/_CropImage":function(){define("dojo/_base/declare dojo/_base/html dojo/_base/lang dojo/on jimu/utils dijit/_WidgetBase dijit/_TemplatedMixin dojo/text!./templates/_CropImage.html dojo/NodeList-dom".split(" "),function(k,e,p,q,n,l,h,f){var d=window.Cropper;return k([l,h],{templateString:f,imageSrc:null,type:null,goldenWidth:4,goldenHeight:3,postCreate:function(){this.type||(this.type=
"image/jpeg");this.setImageSrc(this.imageSrc);this.loadingImg.src=require.toUrl("jimu")+"/images/loading.gif";this.own(q(this.baseImage,"load",p.hitch(this,function(){e.setStyle(this.loadingImg,"display","none");this._initCropper()})))},_initCropper:function(){this.cropper&&this.cropper.destroy&&this.cropper.destroy();this.cropper=new d(this.baseImage,{aspectRatio:this.goldenWidth/this.goldenHeight,preview:".img-preview"})},setImageSrc:function(c){e.setAttr(this.baseImage,"src",c)},getData:function(){return this.cropper.getCroppedCanvas().toDataURL(this.type||
"image/jpeg")},destroy:function(){this.cropper&&this.cropper.destroy&&this.cropper.destroy();this.inherited(arguments)}})})},"builder/dijit/template-config/utils":function(){define("dojo/_base/lang dojo/Deferred jimu/utils jimu/dijit/Message jimu/WidgetManager dojo/promise/all dojo/json builder/serviceUtils".split(" "),function(k,e,p,q,n,l,h,f){return{loadAllWidgetConfigs:function(d){var c=new e,a=[];d.visitElement(function(b){if(b.uri){var c=n.getInstance().tryLoadWidgetConfig(b).then(function(a){a&&
(b.config=a,d._originConfig&&(p.getConfigElementById(d._originConfig,b.id).config=a))});a.push(c)}});l(a).then(function(){c.resolve(d)},function(a){c.reject(a)});return c},saveAgolTemplate:function(d,c,a){var b=new e,g={itemId:a?a:this.app.agolTemplateInfo?this.app.agolTemplateInfo.itemId:null,json:c};f.saveAgolTemplate(this.app,g).then(k.hitch(this,function(){this.app.agolTemplateInfo=g;this.lastTemplateJson=this.categoryManager.getTemplateJson();b.resolve()}),function(a){new q({message:a});b.reject()});
return b}}})},"builder/plugins/app-list/_build-generate_module":function(){define(["builder/plugins/app-list/Plugin","dojo/text!builder/plugins/app-list/Plugin.html","dojo/text!builder/plugins/app-list/css/style.css","dojo/i18n!builder/plugins/app-list/nls/strings"],function(){})},"builder/plugins/app-list/Plugin":function(){define("dojo/_base/declare dojo/_base/html dojo/_base/array dojo/_base/Deferred dijit/_WidgetsInTemplateMixin dojo/text!./Plugin.html dojo/on dojo/_base/lang dojo/query dojo/topic ./Import ./AppCatalogPage ./CardPageWithBigThumbnail ./CardPageWithSmallThumbnail builder/serviceUtils jimu/dijit/LoadingShelter jimu/utils builder/BasePlugin esri/lang dojox/form/Uploader dojo/NodeList-dom".split(" "),
function(k,e,p,q,n,l,h,f,d,c,a,b,g,u,m,r,t,v,y){var w=k([v,n],{baseClass:"plugin-app-list",templateString:l,label:"applist",apps:null,templates:null,_appPages:null,_tempaltePage:null,_appPageState:null,_tempaltePageState:null,_currentPageState:null,_refreshImageFlag:null,postMixInProperties:function(){this.inherited(arguments);this.nls=f.mixin(this.nls,builderNls)},constructor:function(){this.apps=[];this.templates=[];this._appPages=[];this._appPageState={name:w.APP_PAGE,shownType:w.APP_TYPE_ALL,
sortBy:w.SORT_BY_MODIFIED_TIME,searchKey:""};this._tempaltePageState={name:w.TEMPLATE_PAGE,shownType:w.APP_TYPE_ALL,sortBy:w.SORT_BY_MODIFIED_TIME,searchKey:""};this._currentPageState=this._appPageState;this._refreshImageFlag=new Date},startup:function(){this.inherited(arguments);this.loading=new r({hidden:!0});this.loading.placeAt(this.domNode);this.importDijit=(new a({appListWidget:this})).placeAt(this.importBtn);var c=new g({appListWidget:this});this._addAppPage(c,"card-page2",this.nls.gridView);
c=new b({appListWidget:this});this._addAppPage(c,"catalog-page",this.nls.listView);this.refreshAppPage();this._tempaltePage=new u({appListWidget:this});this._tempaltePage.placeAt(this.templateContent);this.refreshTemplatePage();this._bindEvent()},_addAppPage:function(a,b,c){var g=e.create("div",{"class":"app-page-box"},this.appContent);a.placeAt(g);var m=e.create("div",{"class":"switch-app-page-btn jimu-float-leading "+b,title:c},this.switchAppPapgeBox);this.own(h(m,"click",f.hitch(this,function(){d(".app-page-box",
this.contentBox).removeClass("selected");e.addClass(g,"selected");d(".switch-app-page-btn",this.switchAppPapgeBox).removeClass("selected");e.addClass(m,"selected")})));0===this._appPages.length&&(e.addClass(g,"selected"),e.addClass(m,"selected"));this._appPages.push(a)},refreshAppPage:function(a){var b=new q;a?b.resolve():this.getAppList().then(f.hitch(this,function(a){this._currentPageState.sortBy!==w.SORT_BY_MODIFIED_TIME&&(a=this._sort(a));this.initApps(a);b.resolve()}));b.then(f.hitch(this,function(){var a=
this.filter(this.apps),b=this.filter(this.templates);p.forEach(this._appPages,function(c){c.refresh(a,b)},this)}))},refreshTemplatePage:function(a){var b=new q;a?b.resolve():this.getTemplateList().then(f.hitch(this,function(a){this._currentPageState.sortBy!==w.SORT_BY_MODIFIED_TIME&&(a=this._sort(a));this.initTemplates(a);b.resolve()}));b.then(f.hitch(this,function(){var a=this.filter(this.templates);this._tempaltePage.refresh(a)}))},refreshCurrentPage:function(a,b){this._currentPageState.name===
w.APP_PAGE?this.refreshAppPage(a):this._currentPageState.name===w.TEMPLATE_PAGE&&this.refreshTemplatePage(b)},getRefreshImageFlag:function(){return this._refreshImageFlag.getTime()},resetRefreshImageFlag:function(){this._refreshImageFlag=new Date},initApps:function(a){this.apps=this._filterItemByCondition(a);this.apps=this._mixinExtraProperties(this.apps)},initTemplates:function(a){this.templates=this._filterItemByCondition(a);this.templates=this._mixinExtraProperties(this.templates)},setApps:function(a){this.apps=
a},setTemplates:function(a){this.templates=a},_filterItemByCondition:function(a){var b=[];return b=p.filter(a,function(a){return window.isPortalSupport3D||a.appType!==w.APP_TYPE_3D?!0:!1},this)},_mixinExtraProperties:function(a){p.forEach(a,function(a){a.isTemplate||a.icon||(a.icon=a.themeName?"/webappbuilder/apps/"+a.id+"/themes/"+a.themeName+"/images/icon.png":"/webappbuilder/builder/images/logo.png",a._defaultIconClass="default-icon");a.downloadUrl="/webappbuilder/rest/apps/"+a.id+"/download";
var b="stemapp/index.html?id\x3d"+a.id;a.isPredefined&&(b+="\x26ispredefined\x3dtrue");a.appUrl=b;a.styleColor||(a.styleColor=w.DEFAULT_APP_STYLE_COLOR);a.id===w.ID_OF_BASIC_VIEWER_TEMPLATE?a.description=this.nls.basicViewerTemplateDesc:a.id===w.ID_OF_EDITOR_TEMPLATE?a.description=this.nls.editorTemplateDesc:a.id===w.ID_OF_SIMPLE_MAP_VIEWER_TEMPLATE&&(a.description=this.nls.simpleMapViewerTemplateDesc)},this);return a},getAppList:function(){return m.getAppList()},getTemplateList:function(){return m.getTemplateList().then(function(a){return p.filter(a,
function(a){return a.isTemplate})})},updateApp:function(a){return m.updateApp(a)},_getLocaleDateTime:function(a){return t.localizeDate(new Date(a),{fullYear:!0,selector:"date",formatLength:"medium"})},filter:function(a){a=this._filterByType(a);return a=this._filterBySearch(a)},_filterByType:function(a){var b=[];return b=this._currentPageState.shownType===w.APP_TYPE_ALL?a:p.filter(a,function(a){return a.appType===this._currentPageState.shownType},this)},_filterBySearch:function(a){var b=[],c=this._currentPageState.searchKey.toLowerCase();
return c?(p.forEach(a,function(a){0<=(a.name+" "+a.description+""+this._getLocaleDateTime(a.lastUpdated)+" "+a.creator+" "+a.modified).toLowerCase().indexOf(c)&&b.push(a)},this),b):a},_sort:function(a){var b=this._currentPageState.sortBy;a.sort(function(a,c){return a[b]&&c[b]?b===w.SORT_BY_MODIFIED_TIME?a[b]>c[b]?-1:1:a[b].localeCompare(c[b],window.dojoConfig.locale):a[b]?-1:1});return a},_resetAppStateUI:function(){d(".filter",this.filterBox).removeClass("selected");var a=d("#"+this._currentPageState.shownType,
this.filterBox)[0];a&&e.addClass(a,"selected");d(".sort",this.sortBox).removeClass("selected");(a=d("#"+this._currentPageState.sortBy,this.sortBox)[0])&&e.addClass(a,"selected");this.searchBox.setValue(this._currentPageState.searchKey)},_addEmptyDescription:function(a,b){a=e.create("div",{"class":"empty-description-box "+(b?b:"")},a);var c=this.nls.appCreate;b=y.substitute({action:"\x3cspan\x3e"+c+"\x3c/span\x3e"},this.nls.emptyDescForCreate);c=this.nls.appImport;c=y.substitute({action:"\x3cspan\x3e"+
c+"\x3c/span\x3e"},this.nls.emptyDescForImport);e.create("div",{"class":"empty-description",innerHTML:b+"\x3cbr\x3e"+c},a)},_bindEvent:function(){this.own(c.subscribe("switchToAppListApps",f.hitch(this,this._onSwitchToAppContent)));this.own(c.subscribe("switchToAppListTemplates",f.hitch(this,this._onSwitchToTemplateContent)))},_onSwitchToAppContent:function(){e.removeClass(this.templateContent,"selected");e.addClass(this.appContent,"selected");this._currentPageState=this._appPageState;this._resetAppStateUI();
e.removeClass(this.switchAppPapgeBox,"hidden");e.setStyle(this.importDijit.itemImportBtn,"display","block");e.setStyle(this.createNewBtn,"display","block");e.setStyle(this.sortByAuthorBtn,"display","none")},_onSwitchToTemplateContent:function(){e.removeClass(this.appContent,"selected");e.addClass(this.templateContent,"selected");this._currentPageState=this._tempaltePageState;this._resetAppStateUI();e.addClass(this.switchAppPapgeBox,"hidden");e.setStyle(this.importDijit.itemImportBtn,"display","none");
e.setStyle(this.createNewBtn,"display","none");e.setStyle(this.sortByAuthorBtn,"display","block")},_onSearchBoxChange:function(){this._currentPageState.searchKey=this.searchBox.getValue();this.refreshCurrentPage(!0,!0)},_filterAllBtnClick:function(){this._filterAppTypeBtnClick(this.filterAllBtn,w.APP_TYPE_ALL)},_filter2dBtnClick:function(){this._filterAppTypeBtnClick(this.filter2dBtn,w.APP_TYPE_2D)},_filter3dBtnClick:function(){this._filterAppTypeBtnClick(this.filter3dBtn,w.APP_TYPE_3D)},_filterAppTypeBtnClick:function(a,
b){this._currentPageState.shownType!==b&&(d(".filter",this.filterBox).removeClass("selected"),e.addClass(a,"selected"),this._currentPageState.shownType=b,this.refreshCurrentPage(!0,!0))},_sortByModifiedTimeBtnClick:function(){this._sortBtnClick(this.sortByModifiedTimeBtn,w.SORT_BY_MODIFIED_TIME)},_sortByNameBtnClick:function(){this._sortBtnClick(this.sortByNameBtn,w.SORT_BY_NAME)},_sortByAuthorBtnClick:function(){this._sortBtnClick(this.sortByAuthorBtn,w.SORT_BY_AUTHOR)},_sortBtnClick:function(a,
b){this._currentPageState.sortBy!==b&&(this._currentPageState.sortBy=b,d(".sort",this.sortBox).removeClass("selected"),e.addClass(a,"selected"),this._currentPageState.name===w.APP_PAGE?this.setApps(this._sort(this.apps)):this._currentPageState.name===w.TEMPLATE_PAGE&&this.setTemplates(this._sort(this.templates)),this.refreshCurrentPage(!0,!0))},_onCreateClick:function(){var a=this.pluginManager.getExtensions("startup.creation-entry")[0],a=this.pluginsMeta[a.pluginName];this.loading.show("");this.pluginManager.loadPlugin(a).then(f.hitch(this,
function(a){a.popupNewCreateDlg();this.loading.hide()}),f.hitch(this,function(){this.loading.hide()}))}});f.mixin(w,{APP_TYPE_ALL:"ALL",APP_TYPE_2D:"HTML",APP_TYPE_3D:"HTML3D",SORT_BY_MODIFIED_TIME:"lastUpdated",SORT_BY_NAME:"name",SORT_BY_AUTHOR:"creator",APP_PAGE:"appPage",TEMPLATE_PAGE:"templatePage",DEFAULT_APP_STYLE_COLOR:"#596679",ID_OF_BASIC_VIEWER_TEMPLATE:"HTML_basic_viewer",ID_OF_EDITOR_TEMPLATE:"HTML_editor",ID_OF_SIMPLE_MAP_VIEWER_TEMPLATE:"HTML_simple_map_viewer"});return w})},"builder/plugins/app-list/Import":function(){define("dojo/_base/declare dojo/_base/html dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./Import.html dojo/on dojo/_base/lang dojo/sniff builder/serviceUtils dojo/query jimu/dijit/Message jimu/dijit/ItemSelector jimu/dijit/Popup builder/portalUtils esri/lang builder/dijit/FullScreenPopup dojox/form/Uploader dojo/NodeList-dom".split(" "),
function(k,e,p,q,n,l,h,f,d,c,a,b,g,u,m,r,t){return k([p,q,n],{baseClass:"import-app",templateString:l,_itemSelector:null,_importPopup:null,nls:null,postMixInProperties:function(){this.inherited(arguments);this.nls=this.appListWidget.nls;this.loading=this.appListWidget.loading},startup:function(){this.inherited(arguments);this.own(h(window.document,"click",f.hitch(this,function(a){a.clickFromSelf||setTimeout(f.hitch(this,function(){e.setStyle(this.actionsMenu,"display","none");window.isRTL?e.setStyle(this.actionsMenu,
{left:"auto",right:0}):e.setStyle(this.actionsMenu,{right:"auto",left:0});e.removeClass(this.actionsNode,"actions-drop-down")}),50)})));this._applyZipToFileInput();this.appPortalUrlInputNode&&(this.appPortalUrlInputNode.value=window.portalUrl);this._keepFileChooserOverItem()},_applyZipToFileInput:function(){a('input[type\x3d"file"]',this.appFileInputNode.domNode).forEach(f.hitch(this,function(a){e.setAttr(a,"accept",".zip")}))},_keepFileChooserOverItem:function(){9>=d("ie")&&a("span.dijitUploader input:first-child",
this.domNode).forEach(f.hitch(this,function(a){window.isRTL?e.setStyle(a,{left:"33px",right:"auto"}):e.setStyle(a,"right","33px")}))},_onActionsLabelClick:function(a){var b=e.getMarginBox(window.jimuConfig.layoutId),c=null;"none"===e.getStyle(this.actionsMenu,"display")?(e.setStyle(this.actionsMenu,"display","block"),c=e.position(this.actionsMenu),window.isRTL?0>c.x&&e.setStyle(this.actionsMenu,{right:"auto",left:0}):c.x+c.w>b.w&&e.setStyle(this.actionsMenu,{left:"auto",right:0})):(e.setStyle(this.actionsMenu,
"display","none"),c=e.position(this.actionsMenu),window.isRTL?e.setStyle(this.actionsMenu,{left:"auto",right:0}):e.setStyle(this.actionsMenu,{right:"auto",left:0}));a.clickFromSelf=!0},_onMenuItemClick:function(a){setTimeout(f.hitch(this,function(){e.setStyle(this.actionsMenu,"display","none");e.removeClass(this.actionsNode,"actions-drop-down");a.stopPropagation()}),50)},_onAppFileUploadError:function(a){console.error(a);new b({message:a.message||a});this._keepFileChooserOverItem();this._applyZipToFileInput();
this.loading.hide()},_onAppFileUploadComplete:function(a){a.success?(this._refreshAppOrTemplatePage(),this._keepFileChooserOverItem(),this._applyZipToFileInput(),this.loading.hide()):this._onAppFileUploadError(a)},_onAppFileChange:function(){var a=this.appFileInputNode.getFileList();a&&0<a.length&&(/.+(\.zip)$/.test(a[0].name)?(this.loading.show(this.nls.uploading),m.getPortal(window.portalUrl).getUser().then(f.hitch(this,function(a){e.setAttr(this.appFileCreatorInputNode,"value",a.username);e.setAttr(this.fromListNode,
"value",this._currentShownList);this.appFileInputNode.submit(this.uploadAppFileFormNode)}),function(a){console.error(a);new b({message:a.message||a});this.loading.hide()})):new b({message:this.nls.fileTypeError}))},_onImportClick:function(){this._itemSelector=new g({portalUrl:window.portalUrl,itemTypes:["Web Mapping Application"],onlyShowOnlineFeaturedItems:!1,typeKeywords:["Web AppBuilder"],showOnlineItems:!1});this.own(h(this._itemSelector,"item-selected",f.hitch(this,function(){this._importPopup.enableButton(0)})));
this.own(h(this._itemSelector,"none-item-selected",f.hitch(this,function(){this._importPopup.disableButton(0)})));var b=a("#main-page")[0];this._importPopup=new t({zIndex:101,titleStr:this.nls.importApp,blurContainer:b.firstElementChild,content:this._itemSelector.domNode,buttons:[{label:this.nls.ok,isHighLight:!0,onClick:f.hitch(this,this._onImportOkClick)},{label:this.nls.cancel,isHighLight:!1,onClick:f.hitch(this,this._onImportCancelClick)}],contentAutoHeight:!0});this._importPopup.placeAt(b);this._importPopup.show();
this._importPopup.disableButton(0);this._itemSelector.startup();this.own(h(this._itemSelector.tab,"tabChanged",f.hitch(this,function(){window.setTimeout(f.hitch(this,function(){this._importPopup.resize()},100))})));this.own(h(this._itemSelector,"update",f.hitch(this,function(){this._importPopup.resize()})))},_onImportOkClick:function(){var a=this._itemSelector.getSelectedItem(),b=a.id;this.loading.show();m.getPortal(window.portalUrl).getUser().then(f.hitch(this,function(d){a.getItemData().then(f.hitch(this,
function(g){this.loading.hide();this._importPopup.close();g=f.clone(g);c.switchImageFormatOfAppConfig({appConfig:g,appId:b},"import").then(f.hitch(this,function(b){this._checkAppVersion(b.appConfig,{creator:d.username,name:a.title,description:a.description||"",appType:a.typeKeywords&&0<=a.typeKeywords.indexOf("WAB3D")?"HTML3D":"HTML",stemappPath:this.appListWidget.pluginManager.getStemappInfo("HTML").appPath,portalUrl:window.portalUrl,isTemplate:!1,isTemplateApp:!1,isPredefined:!1})}),f.hitch(this,
function(b){this.loading.hide();this._checkAppInfoError(a.title,b)}))}),f.hitch(this,function(b){this.loading.hide();this._checkAppInfoError(a.title,b)}))}),f.hitch(this,function(b){this.loading.hide();this._checkAppInfoError(a.title,b)}))},_checkAppVersion:function(a,b){this.loading.show(this.nls.importing);c.checkAppVersion(a,b).then(f.hitch(this,function(c){this.loading.hide();c=c.versionInfo;"old"===c.wabVersionStatus?this._doAction("upgrade",a,b):"new"===c.wabVersionStatus?this._showNewer(b.name,
c.appVersion):"same"===c.wabVersionStatus&&this._doAction("import",a,b)}),f.hitch(this,function(b){this.loading.hide();this._checkAppInfoError(a.title,b)}))},_checkAppInfoError:function(a,c){new b({message:r.substitute({APP_NAME:a},this.nls.checkVersionError)});console.error(c)},_showUpgrade:function(a,b,c){c="\x3cdiv style\x3d'font-size:14px;'\x3e"+r.substitute({OLD_VERSION:c.appVersion,LATEST_VERSION:c.latestVersion},this.nls.upgradeContent)+"\x3cdiv style\x3d'height:24px;'\x3e\x3c/div\x3e"+this.nls.upgradeContentFooter+
"\x3c/div\x3e";var d=new u({titleLabel:this.nls.upgradeApp,content:e.toDom(c),width:640,autoHeight:!0,buttons:[{label:this.nls.upgradeBtn,onClick:f.hitch(this,function(){d.close();this._doAction("upgrade",a,b)})},{label:this.nls.cancel,classNames:["jimu-btn-vacation"],onClick:f.hitch(this,function(){d.close()})}]})},_showNewer:function(a,b){a="\x3cdiv style\x3d'font-size:14px;'\x3e"+r.substitute({APP_NAME:a,VERSION_NUMBER:b},this.nls.importUpperVertion)+"\x3c/div\x3e";new u({titleLabel:this.nls.importApp,
content:e.toDom(a),width:640,autoHeight:!0,buttons:[{label:this.nls.ok}]})},_doAction:function(a,b,d){"import"===a?this.loading.show(this.nls.importing):"upgrade"===a&&this.loading.show(this.nls.upgrading);c.importPortalApp(b,d).then(f.hitch(this,function(){this._importSuccess(d.appName)}),f.hitch(this,function(a){this.loading.hide();this._importError(d.appName,a)}))},_importSuccess:function(a){this.appListWidget.getAppList().then(f.hitch(this,function(){this._refreshAppOrTemplatePage();var b="\x3cdiv style\x3d'font-size:14px;'\x3e"+
r.substitute({APP_NAME:a},this.nls.importSuccess)+"\x3c/div\x3e";new u({titleLabel:this.nls.importApp,content:e.toDom(b),width:640,autoHeight:!0,buttons:[{label:this.nls.ok}]})}),f.hitch(this,function(a){console.error(a)})).always(f.hitch(this,function(){this.loading.hide()}))},_importError:function(a,b){a="\x3cdiv style\x3d'font-size:14px;'\x3e"+r.substitute({APP_NAME:a},this.nls.upgradeFailure)+"\x3c/div\x3e";new u({titleLabel:this.nls.importApp,content:e.toDom(a),width:640,autoHeight:!0,buttons:[{label:this.nls.ok}]});
console.error(b)},_onImportCancelClick:function(){this._importPopup.close()},_refreshAppOrTemplatePage:function(){this.appListWidget.refreshTemplatePage();this.appListWidget.refreshAppPage()}})})},"jimu/dijit/ItemSelector":function(){define("dojo/_base/declare dojo/topic dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/ItemSelector.html dojo/Evented dojo/_base/lang dojo/_base/config dojo/_base/array dojo/_base/html dojo/_base/Deferred dojo/promise/all dojo/query dojo/on jimu/utils jimu/portalUtils jimu/tokenUtils jimu/portalUrlUtils jimu/dijit/ViewStack jimu/dijit/Search jimu/dijit/TabContainer3 jimu/dijit/_ItemTable".split(" "),
function(k,e,p,q,n,l,h,f,d,c,a,b,g,u,m,r,t,v,y,w,z,x,A){return k([p,q,n,h],{templateString:l,declaredClass:"jimu.dijit.ItemSelector",baseClass:"jimu-item-selector",tab:null,_user:null,_group:null,_allPublicPortalQuery:null,_filterPublicPortalQuery:null,_allPublicOnlineQuery:null,_filterPublicOnlineQuery:null,_allOrganizationQuery:null,_filterOrganizationQuery:null,_allMyContentQuery:null,_filterMyContentQuery:null,_allGroupQuery:null,_filterGroupQuery:null,_isPublicTabShow:!1,_signIn:!1,_itemTypeQueryString:"",
_typeKeywordQueryString:"",portalUrl:null,itemTypes:"",typeKeywords:"",showOnlineItems:!0,onlyShowOnlineFeaturedItems:!1,postMixInProperties:function(){this.portalUrl=y.getStandardPortalUrl(this.portalUrl);this.showOnlineItems=!1===this.showOnlineItems?!1:!0;this.itemTypes&&0<this.itemTypes.length||(this.itemTypes=[]);this._itemTypes="";c.forEach(this.itemTypes,f.hitch(this,function(a,b){this._itemTypes+='"'+a+'"';b!==this.itemTypes.length-1&&(this._itemTypes+=",")}));this._itemTypes="["+this._itemTypes+
"]";this.typeKeywords&&0<this.typeKeywords.length||(this.typeKeywords=[]);this._typeKeywords="";c.forEach(this.typeKeywords,f.hitch(this,function(a,b){this._typeKeywords+='"'+a+'"';b!==this.typeKeywords.length-1&&(this._typeKeywords+=",")}));this._typeKeywords="["+this._typeKeywords+"]";this.nls=window.jimuNls.itemSelector},postCreate:function(){this.inherited(arguments);var a=this._getPortalUrl();this.portal=t.getPortal(a);this._initOptions();this._initSearchQuery();this._initTabs();this._initPortalRadio();
this._initItemTables();this._initPublic();this._initPrivate();this._updateUIbySignIn()},_initOptions:function(){this._itemTypeQueryString=r.getItemQueryStringByTypes(this.itemTypes);this._typeKeywordQueryString=r.getItemQueryStringByTypeKeywords(this.typeKeywords)},_initTabs:function(){this.tab=new x({tabs:[{title:this.nls.myContent,content:this.mycontentTabNode},{title:this.nls.myOrganization,content:this.organizationTabNode},{title:this.nls.myGroup,content:this.groupTabNode},{title:this.nls.publicMap,
content:this.publicTabNode}]},this.tabNode);this.own(m(this.tab,"tabChanged",f.hitch(this,function(b){a.setStyle(this.signinSection,"display","none");b!==this.nls.publicMap?(this._isPublicTabShow=!1,this._updateUIbySignIn()):this._isPublicTabShow=!0})))},_updateUIbySignIn:function(){a.setStyle(this.signinSection,"display","none");var b=u(".organization-tab-content-main,.group-tab-content-main,.mycontent-tab-content-main",this.domNode);v.userHaveSignInPortal(this._getPortalUrl())?b.style("display",
"block"):(b.style("display","none"),this._isPublicTabShow||a.setStyle(this.signinSection,"display","block"))},_initPortalRadio:function(){r.combineRadioCheckBoxWithLabel(this.portalPublicRaido,this.portalPublicLabel);r.combineRadioCheckBoxWithLabel(this.onlinePublicRaido,this.onlinePublicLabel);var b=this._getPortalUrl(),b=y.getServerByUrl(b);this.portalPublicRaido.disabled=!1;this.onlinePublicRaido.disabled=!1;this.portalPublicRaido.checked=!0;var c=!1;y.isArcGIScom(b)?(c=!0,this.portalPublicLabel.innerHTML=
"ArcGIS.com"):(this.portalPublicLabel.innerHTML=b,c=this.showOnlineItems?!1:!0);c&&(this.onlinePublicRaido.disabled=!0,a.setStyle(this.onlinePublicRaido,"display","none"),a.setStyle(this.onlinePublicLabel,"display","none"))},_initSearchQuery:function(){var a="esri_"+(d.locale&&d.locale.slice(0,2)||"en").toLowerCase(),b=c.filter("esri_he esri_fr esri_ja esri_nl esri_th esri_tr esri_nb esri_ro esri_it esri_pl esri_po esri_ru esri_pt esri_en esri_ar esri_et esri_es esri_ko esri_cs esri_da esri_zh esri_sv esri_lt esri_fi esri_lv esri_de esri_vi".split(" "),
f.hitch(this,function(b){return b!==a})),g="";c.forEach(b,f.hitch(this,function(a){g+=" -owner:"+a+" "}));b=" ";this.portal&&this.portal.user&&this.portal.user.orgId&&(b=" orgid:"+this.portal.user.orgId+" ");b=b+this._itemTypeQueryString+" AND access:public "+g+" "+this._typeKeywordQueryString;this._allPublicPortalQuery=this._getQuery({sortField:"numViews",sortOrder:"desc",q:b});this._filterPublicPortalQuery=this._getQuery({q:b,basicQ:b});this._allPublicOnlineQuery=this._getQuery({sortField:"numViews",
sortOrder:"desc",q:(this.onlyShowOnlineFeaturedItems?' (group:"c755678be14e4a0984af36a15f5b643e"  OR group:"b8787a74b4d74f7fb9b8fac918735153") ':" ")+this._itemTypeQueryString+" AND access:public "+this._typeKeywordQueryString});this._filterPublicOnlineQuery=this._getQuery({q:this._itemTypeQueryString+" AND access:public "+this._typeKeywordQueryString});this._allOrganizationQuery=this._getQuery();this._filterOrganizationQuery=this._getQuery();this._allMyContentQuery=this._getQuery();this._filterMyContentQuery=
this._getQuery();this._allGroupQuery=this._getQuery();this._filterGroupQuery=this._getQuery()},_getQuery:function(a){return f.mixin({start:1,num:16,f:"json"},a||{})},_getPortalUrl:function(){return y.getStandardPortalUrl(this.portalUrl)},_initItemTables:function(){"function"===typeof this.onCreateItemContent&&(this.mycontentItemTable.onCreateItemContent=this.onCreateItemContent,this.organizationItemTable.onCreateItemContent=this.onCreateItemContent,this.groupItemTable.onCreateItemContent=this.onCreateItemContent,
this.publicPortalItemTable.onCreateItemContent=this.onCreateItemContent,this.publicOnlineItemTable.onCreateItemContent=this.onCreateItemContent);this.own(m(this.publicPortalItemTable,"item-dom-clicked",f.hitch(this,this._onItemDomClicked)));this.own(m(this.publicOnlineItemTable,"item-dom-clicked",f.hitch(this,this._onItemDomClicked)));this.own(m(this.organizationItemTable,"item-dom-clicked",f.hitch(this,this._onItemDomClicked)));this.own(m(this.groupItemTable,"item-dom-clicked",f.hitch(this,this._onItemDomClicked)));
this.own(m(this.mycontentItemTable,"item-dom-clicked",f.hitch(this,this._onItemDomClicked)));this.own(m(this.publicPortalItemTable,"update",f.hitch(this,this._onItemTableUpdate)));this.own(m(this.publicOnlineItemTable,"update",f.hitch(this,this._onItemTableUpdate)));this.own(m(this.organizationItemTable,"update",f.hitch(this,this._onItemTableUpdate)));this.own(m(this.groupItemTable,"update",f.hitch(this,this._onItemTableUpdate)));this.own(m(this.mycontentItemTable,"update",f.hitch(this,this._onItemTableUpdate)));
var a=this._getPortalUrl();this.portalPublicRaido.disabled||(this.publicPortalItemTable.set("portalUrl",a),this.publicPortalItemTable.searchAllItems(this._allPublicPortalQuery),this.publicPortalItemTable.set("filteredQuery",this._filterPublicPortalQuery));this.onlinePublicRaido.disabled||(this.publicOnlineItemTable.set("portalUrl",window.location.protocol+"//www.arcgis.com"),this.publicOnlineItemTable.searchAllItems(this._allPublicOnlineQuery),this.publicOnlineItemTable.set("filteredQuery",this._filterPublicOnlineQuery))},
_initPublic:function(){this.own(m(this.portalPublicRaido,"click",f.hitch(this,this._onPublicRaidoClicked)));this.own(m(this.onlinePublicRaido,"click",f.hitch(this,this._onPublicRaidoClicked)));this._onPublicRaidoClicked()},_onPublicRaidoClicked:function(){this.portalPublicRaido.checked?(this.publicPortalItemTable.show(),this.publicOnlineItemTable.hide()):this.onlinePublicRaido.checked&&(this.publicPortalItemTable.hide(),this.publicOnlineItemTable.show())},_onPublicSearch:function(a){(a=a&&f.trim(a))?
(this.publicPortalItemTable.showFilterItemsSection(),this.publicOnlineItemTable.showFilterItemsSection(),this.portalPublicRaido.checked?(this._filterPublicPortalQuery.q=a+" "+this._filterPublicPortalQuery.basicQ,this._filterPublicPortalQuery.start=1,this.publicPortalItemTable.searchFilteredItems(this._filterPublicPortalQuery)):this.onlinePublicRaido.checked&&(this._filterPublicOnlineQuery.q=a+" "+this._itemTypeQueryString+" AND access:public "+this._typeKeywordQueryString,this._filterPublicOnlineQuery.start=
1,this.publicOnlineItemTable.searchFilteredItems(this._filterPublicOnlineQuery))):(this.publicPortalItemTable.showAllItemsSection(),this.publicOnlineItemTable.showAllItemsSection())},_initPrivate:function(){this._resetPortalMaps();this.own(m(this.groupsSelect,"change",f.hitch(this,this._onGroupsSelectChange)));var a=y.getServerByUrl(this._getPortalUrl());y.isArcGIScom(a)&&(a="ArcGIS.com");v.userHaveSignInPortal(this._getPortalUrl())&&this._onSignIn()},_onOrganizationSearch:function(a){if(a=a&&f.trim(a)){if(this._allOrganizationQuery){var b=
this._allOrganizationQuery.q;b&&(this._filterOrganizationQuery.q=a+" "+b,this._filterOrganizationQuery.start=1,this.organizationItemTable.searchFilteredItems(this._filterOrganizationQuery))}}else this.organizationItemTable.showAllItemsSection()},_onMyContentSearch:function(a){if(a=a&&f.trim(a)){if(this._allMyContentQuery){var b=this._allMyContentQuery.q;b&&(this._filterMyContentQuery.q=a+" "+b,this._filterMyContentQuery.start=1,this.mycontentItemTable.searchFilteredItems(this._filterMyContentQuery))}}else this.mycontentItemTable.showAllItemsSection()},
_onGroupSearch:function(a){if(a=a&&f.trim(a)){if(this._allGroupQuery){var b=this._allGroupQuery.q;b&&(this._filterGroupQuery.q=a+" "+b,this._filterGroupQuery.start=1,this.groupItemTable.searchFilteredItems(this._filterGroupQuery))}}else this.groupItemTable.showAllItemsSection()},_onSignIn:function(){this._updateUIbySignIn();if(!this._signIn){this._signIn=!0;var a=this._getPortalUrl();t.getPortal(a).getUser().then(f.hitch(this,function(a){this.domNode&&(this._resetPortalMaps(),this._searchOrganization(a),
this._searchMyContent(a),this._searchGroups(a))}))}},_onSignOut:function(){this._signIn=!1;this._resetPortalMaps();this._updateUIbySignIn()},_resetPortalMaps:function(){this.organizationItemTable.clear();this.mycontentItemTable.clear();this._resetGroupsSection()},_searchOrganization:function(a){this.organizationItemTable.clear();a=" orgid:"+a.orgId+" AND "+this._itemTypeQueryString+" AND (access:org OR access:public) "+this._typeKeywordQueryString;var b=this._getPortalUrl();this._allOrganizationQuery=
this._getQuery({q:a});this._filterOrganizationQuery=this._getQuery({q:a});this.organizationItemTable.set("portalUrl",b);this.organizationItemTable.searchAllItems(this._allOrganizationQuery)},_searchMyContent:function(a){this.mycontentItemTable.clear();var b=this._getPortalUrl();a="owner:"+a.username+" AND "+this._itemTypeQueryString+" "+this._typeKeywordQueryString;this._allMyContentQuery=this._getQuery({q:a});this._filterMyContentQuery=this._getQuery({q:a});this.mycontentItemTable.set("portalUrl",
b);this.mycontentItemTable.searchAllItems(this._allMyContentQuery)},_searchGroups:function(b){this._resetGroupsSection();a.setStyle(this.groupsSection,"display","block");b=b.getGroups();if(0<b.length){a.setStyle(this.groupSearch.domNode,"display","block");this.groupItemTable.show();a.empty(this.groupsSelect);for(var c=0;c<b.length;c++){var d=b[c];a.create("option",{value:d.id,innerHTML:d.title},this.groupsSelect)}this._onGroupsSelectChange()}this._updateUIbyGroups(b.length)},_resetGroupsSection:function(){a.setStyle(this.groupsSection,
"display","none");a.empty(this.groupsSelect);a.create("option",{value:"nodata",innerHTML:this.nls.noneGroups},this.groupsSelect);this.groupItemTable.clear();a.setStyle(this.groupSearch.domNode,"display","none");this.groupItemTable.hide();this._updateUIbyGroups(0)},_updateUIbyGroups:function(b){0===b?a.setStyle(this.groupsSection,"top","15px"):a.setStyle(this.groupsSection,"top","50px")},_onGroupsSelectChange:function(){var b=this.groupsSelect.value;this.groupItemTable.clear();if("nodata"===b)a.setStyle(this.groupSearch,
"display","none"),this.groupItemTable.hide();else{a.setStyle(this.groupSearch,"display","block");this.groupItemTable.show();var c=this._getPortalUrl(),b="group:"+b+" AND "+this._itemTypeQueryString+" "+this._typeKeywordQueryString;this._allGroupQuery=this._getQuery({q:b});this._filterGroupQuery=this._getQuery({q:b});this.groupItemTable.set("portalUrl",c);this.groupItemTable.searchAllItems(this._allGroupQuery)}},_onItemTableUpdate:function(){this.emit("update")},_onItemDomClicked:function(b){var c=
a.hasClass(b,"jimu-state-active");u(".item.jimu-state-active",this.domNode).removeClass("jimu-state-active");c&&a.addClass(b,"jimu-state-active");(b=this.getSelectedItem())?this.emit("item-selected",b):this.emit("none-item-selected")},getSelectedItem:function(){var a=null,b=u(".item.jimu-state-active",this.domNode);0<b.length&&(a=f.mixin({},b[0].item));return a}})})},"jimu/dijit/Search":function(){define(["dojo/_base/declare","dojo/_base/html","dojo/string","dijit/_WidgetBase","dijit/_TemplatedMixin"],
function(k,e,p,q,n){return k([q,n],{baseClass:"jimu-search",declaredClass:"jimu.dijit.Search",templateString:'\x3cdiv\x3e\x3cspan class\x3d"jimu-input-wrapper" style\x3d"left:0;right:0;"\x3e\x3cinput class\x3d"jimu-input" style\x3d"background:#fafafc;" data-dojo-attach-point\x3d"inputSearch" data-dojo-attach-event\x3d"onKeydown: _onKeyDown, onKeyUp: _onKeyUp"/\x3e\x3c/span\x3e\x3cdiv class\x3d"search-btn jimu-icon jimu-icon-search" data-dojo-attach-point\x3d"searchBtn" data-dojo-attach-event\x3d"onClick: _onBtnClick"\x3e\x3c/div\x3e\x3c/div\x3e',
placeholder:"",onSearch:null,searchWhenInput:!1,postCreate:function(){this.inherited(arguments);this.placeholder&&e.setAttr(this.inputSearch,"placeholder",this.placeholder)},getValue:function(){return p.trim(this.inputSearch.value)},doSearch:function(){if(this.onSearch)this.onSearch(this.getValue())},_onKeyDown:function(e){this.doChange();13===(void 0!==e.keyCode?e.keyCode:e.which)&&this.doSearch();e.stopPropagation()},_onKeyUp:function(){this.searchWhenInput&&this.doSearch()},_onBtnClick:function(){this.doSearch()},
doChange:function(){if(this.onChange)this.onChange(this.getValue())}})})},"jimu/dijit/TabContainer3":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/html dojo/on dojo/Evented dojo/query dijit/_WidgetBase dijit/_TemplatedMixin dojo/text!./templates/TabContainer3.html jimu/dijit/ViewStack".split(" "),function(k,e,p,q,n,l,h,f,d,c,a){return k([f,d,l],{templateString:c,baseClass:"jimu-tab3",declaredClass:"jimu.dijit.TabContainer3",_currentIndex:-1,selected:"",tabs:null,
average:!0,postCreate:function(){this.inherited(arguments);this._initSelf();this.selected?this.selectTab(this.selected):0<this.tabs.length&&this.selectTab(this.tabs[0].title)},selectTab:function(a){var b=h("td",this.tabTr);p.forEach(b,e.hitch(this,function(b,c){q.removeClass(b,"jimu-state-active");b.label===a&&(q.addClass(b,"jimu-state-active"),this._currentIndex=c)}));this.controlNode.removeChild(this.controlTable);q.place(this.controlTable,this.controlNode);this.viewStack.switchView(a);this.emit("tabChanged",
a)},addTab:function(a){if(!this.average){var b=h("td:last-child",this.tabTr);0<b.length&&q.destroy(b[0])}0<p.filter(this.tabs,function(b){return b.title===a.title}).length?console.error("tab title conflict: "+a.title):(this.tabs.push(a),this._createTab(a),this.average||(b=q.toDom('\x3ctd nowrap class\x3d"tab-item-td" style\x3d"border-bottom:1px solid #ccc;"\x3e\x3cdiv class\x3d"tab-item-div"\x3e\x3c/div\x3e\x3c/td\x3e'),q.place(b,this.tabTr)))},removeTab:function(a){var b=-1;if(p.some(this.tabs,function(c,
d){if(c.title===a)return b=d,!0})){var c=this.tabs.splice(b,1)[0],d=h("td",this.tabTr),f;p.some(d,function(b){if(b.label===a)return f=b,!0})&&q.destroy(f);this.viewStack.removeView(c.content)}},showShelter:function(){q.setStyle(this.shelter,"display","block")},hideShelter:function(){q.setStyle(this.shelter,"display","none")},getSelectedIndex:function(){return this._currentIndex},getSelectedTitle:function(){return this.viewStack.getSelectedLabel()},_initSelf:function(){this.viewStack=new a(null,this.containerNode);
p.forEach(this.tabs,function(a){this._createTab(a)},this);if(this.average)this.controlTable.style.tableLayout="fixed",q.addClass(this.domNode,"average");else{var b=q.toDom('\x3ctd nowrap class\x3d"tab-item-td" style\x3d"border-bottom:1px solid #ccc;"\x3e\x3cdiv class\x3d"tab-item-div"\x3e\x3c/div\x3e\x3c/td\x3e');q.place(b,this.tabTr)}},startup:function(){this.inherited(arguments);this._started=!0},_createTab:function(a){var b=q.toDom('\x3ctd nowrap class\x3d"tab-item-td"\x3e\x3cdiv class\x3d"tab-item-div"\x3e\x3c/div\x3e\x3c/td\x3e');
b.label=a.title||"";q.place(b,this.tabTr);var c=h(".tab-item-div",b)[0];c.innerHTML=b.label;c.label=b.label;a.content.label=b.label;this.viewStack.addView(a.content);this.own(n(b,"click",e.hitch(this,this._onSelect,a.title)))},_onSelect:function(a){this.selectTab(a)}})})},"jimu/dijit/_ItemTable":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/_ItemTable.html dojo/Evented dojo/_base/lang dojo/_base/array dojo/_base/html dojo/_base/Deferred dojo/query dojo/on jimu/utils jimu/portalUtils jimu/portalUrlUtils jimu/dijit/LoadingIndicator".split(" "),
function(k,e,p,q,n,l,h,f,d,c,a,b,g,u,m,r){return k([e,p,q,l],{templateString:n,declaredClass:"jimu.dijit.ItemTable",baseClass:"jimu-item-table",query:null,filteredQuery:null,portalUrl:null,hidden:!1,nls:null,types:"",typeKeywords:"",_defaultThumbnail:{"Web Mapping Application":"webapp.png","Mobile Application":"mobileapp.png"},postMixInProperties:function(){this.nls=window.jimuNls.itemSelector},postCreate:function(){this.inherited(arguments);this._initSelf()},_initSelf:function(){this.types&&0<this.types.length||
(this.types=[]);(this.hidden=!0===this.hidden)&&this.hide();this.portalUrl&&(this.portalUrl=m.getStandardPortalUrl(this.portalUrl));this.showAllItemsSection();this.searchAllItems()},show:function(){d.setStyle(this.domNode,"display","block")},hide:function(){d.setStyle(this.domNode,"display","none")},searchAllItems:function(a){this.showAllItemsSection();a&&(this.query=h.mixin({},a),this.query.start=1,this.clearAllItemsSection());this.portalUrl&&this.query&&0<this.query.start&&(this.allItemsShelter.show(),
u.getPortal(this.portalUrl).queryItems(this.query).then(h.hitch(this,function(a){this.domNode&&(this.allItemsShelter.hide(),this.query.start=a.nextStart,this._createItems(a,this.allItemTbody))}),h.hitch(this,function(a){console.error(a);this.domNode&&this.allItemsShelter.hide()})))},searchFilteredItems:function(a){this.showFilterItemsSection();a&&(this.filteredQuery=h.clone(a),this.filteredQuery.start=1,this.clearFilteredItemsSection());this.portalUrl&&this.filteredQuery&&0<this.filteredQuery.start&&
(this.filteredItemShelter.show(),u.getPortal(this.portalUrl).queryItems(this.filteredQuery).then(h.hitch(this,function(b){this.domNode&&(this.showFilterItemsSection(),a&&this.clearFilteredItemsSection(),this.filteredQuery.start=b.nextStart,this._createItems(b,this.filteredItemsTbody),this._filterItemCallback())}),h.hitch(this,function(a){console.error(a);this.domNode&&this._filterItemCallback()})))},_filterItemCallback:function(){this.filteredItemShelter.hide();0<this._getItemCount(this.filteredItemsTbody)?
(d.setStyle(this.filteredItemsTableDiv,"display","block"),d.setStyle(this.searchNoneTipSection,"display","none")):(d.setStyle(this.filteredItemsTableDiv,"display","none"),d.setStyle(this.searchNoneTipSection,"display","block"))},clear:function(){this.clearAllItemsSection();this.clearFilteredItemsSection()},clearAllItemsSection:function(){d.empty(this.allItemTbody)},clearFilteredItemsSection:function(){d.empty(this.filteredItemsTbody)},showAllItemsSection:function(){d.setStyle(this.allItemsSection,
"display","block");d.setStyle(this.filteredItemsSection,"display","none")},showFilterItemsSection:function(){d.setStyle(this.allItemsSection,"display","none");d.setStyle(this.filteredItemsSection,"display","block");d.setStyle(this.filteredItemsTableDiv,"display","block");d.setStyle(this.searchNoneTipSection,"display","none")},_onAllItemsSectionScroll:function(){this._isScrollToBottom(this.allItemsTableDiv)&&this.searchAllItems()},_onFilteredItemsSectionScroll:function(){this._isScrollToBottom(this.filteredItemsTableDiv)&&
this.searchFilteredItems()},_isScrollToBottom:function(a){return g.isScrollToBottom(a)},_createItems:function(b,c){b=b.results;var g=f.map(this.types,h.hitch(this,function(a){return a.toLowerCase()}));b=f.filter(b,h.hitch(this,function(a){a=a.type&&a.type.toLowerCase()||"";return 0<=f.indexOf(g,a)}));if(0!==b.length){var e,m=a("td.empty",c),k;if(0<m.length){var l=Math.min(b.length,m.length),n=b.splice(0,l);for(k=0;k<l;k++){var p=m[k];e=this._createItem(n[k]);d.place(e,p);d.removeClass(p,"empty")}}if(0!==
b.length){m=Math.ceil(b.length/2);for(k=0;k<m;k++)for(e=d.toDom("\x3ctr\x3e\x3ctd\x3e\x3c/td\x3e\x3ctd\x3e\x3c/td\x3e\x3c/tr\x3e"),d.place(e,c),l=a("td",e),n=0;n<l.length;n++)p=l[n],(e=b[2*k+n])?(e=this._createItem(e),d.place(e,p)):d.addClass(p,"empty");this.emit("update")}}},_getItemCount:function(b){return a(".item",b).length},_createItem:function(b){var c=d.toDom('\x3cdiv class\x3d"item"\x3e\x3cdiv class\x3d"item-border"\x3e\x3c/div\x3e\x3cdiv class\x3d"item-thumbnail jimu-auto-vertical"\x3e\x3cdiv class\x3d"none-thumbnail-tip jimu-auto-vertical-content"\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d"item-info"\x3e\x3cdiv class\x3d"item-name"\x3e\x3c/div\x3e\x3cdiv class\x3d"item-type-owner"\x3e\x3c/div\x3e\x3cdiv class\x3d"item-date"\x3e\x3c/div\x3e\x3ca class\x3d"item-details" target\x3d"_blank"\x3e\x3c/a\x3e\x3c/div\x3e\x3c/div\x3e');
c.item=b;var g=a(".item-thumbnail",c)[0],f=a(".item-name",c)[0],e=a(".item-type-owner",c)[0],h=a(".item-date",c)[0],m=a(".item-details",c)[0],k=a(".none-thumbnail-tip",c)[0];if(!b.thumbnailUrl){var l=this._defaultThumbnail[b.type];l&&(b.thumbnailUrl=require.toUrl("jimu")+"/images/"+l)}b.thumbnailUrl?d.setStyle(g,"backgroundImage","url("+b.thumbnailUrl+")"):k.innerHTML=this.nls.noneThumbnail;"function"===typeof this.onCreateItemContent?(h=a(".item-info",c)[0],this.onCreateItemContent(b,h)):(f.innerHTML=
b.title,f.title=f.innerHTML,e.innerHTML=b.type+" by "+b.owner,e.title=e.innerHTML,g=new Date,g.setTime(b.modified),h.innerHTML=g.toLocaleString(),h.title=h.innerHTML,m.innerHTML=this.nls.moreDetails,m.href=b.detailsPageUrl||"#");return c},_onItemsTableClicked:function(b){var c=b.target||b.srcElement;b=null;d.hasClass(c,"item-thumbnail")?b=c.parentNode:d.hasClass(c,"none-thumbnail-tip")&&(b=c.parentNode.parentNode);b&&(c=d.hasClass(b,"jimu-state-active"),a(".item.jimu-state-active",this.domNode).removeClass("jimu-state-active"),
c?d.removeClass(b,"jimu-state-active"):d.addClass(b,"jimu-state-active"),this.emit("item-dom-clicked",b))},getSelectedItem:function(){var b=null,c=a(".item.jimu-state-active",this.domNode);0<c.length&&(b=h.mixin({},c[0].item));return b}})})},"jimu/dijit/LoadingIndicator":function(){define(["dojo/_base/declare","dijit/_WidgetBase","dojo/dom-style","dojo/dom-construct"],function(k,e,p,q){return k(e,{baseClass:"jimu-loading-indicator",declaredClass:"jimu.dijit.LoadingIndicator",hidden:!1,postCreate:function(){this.inherited(arguments);
(this.hidden=!0===this.hidden)&&p.set(this.domNode,{display:"none"});p.set(this.domNode,{width:"100%",height:"100%"});q.place('\x3cdiv class\x3d"jimu-loading"\x3e\x3c/div\x3e',this.domNode)},show:function(){this.domNode&&p.set(this.domNode,"display","block")},hide:function(){this.domNode&&p.set(this.domNode,"display","none")}})})},"builder/dijit/FullScreenPopup":function(){define("dojo/_base/lang dojo/_base/declare dojo/_base/html dojo/dom-class dojo/dom-construct dojo/dom-style dojo/dom-attr dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/FullScreenPopup.html dojo/on dojo/throttle".split(" "),
function(k,e,p,q,n,l,h,f,d,c,a,b,g){return e([f,d,c],{templateString:a,baseClass:"fullscreen-popup-container",isShow:!1,position:{},_zIndexIncrease:0,_btns:[],postCreate:function(){this.inherited(arguments);this._btns=[];this.outerMainPage=this.blurContainer?this.blurContainer:null;this._zIndexIncrease=this.zIndex?this.zIndex:1;l.set(this.domNode,"z-index",this._zIndexIncrease++);l.set(this.background,"display","block");l.set(this.background,"z-index",this._zIndexIncrease++);l.set(this.main,"z-index",
this._zIndexIncrease++);l.set(this.fullscreenPopupBtns,"z-index",this._zIndexIncrease++);if(this.buttons)for(var a=0,c=this.buttons.length;a<c;a++){var d=this.buttons[a],f=p.create("input",{"class":"btn",type:"button",value:d.label},this.fullscreenPopupBtns);d.isHighLight&&q.add(f,"light");d.onClick&&this.own(b(f,"click",d.onClick));this._btns.push(f)}this.contentAutoHeight&&q.add(this.main,"autoHeight");this.own(b(window,"resize",g(k.hitch(this,this.resize)),50));this.own(b(this.fullscreenPopupContent,
"DOMNodeInserted,DOMNodeRemoved",g(k.hitch(this,this.resize)),100))},startup:function(){this.hide();this.refresh()},destroy:function(){this.subDijit&&(this.subDijit.destroy(),this.subDijit=null);this._btns=[];p.destroy(this.domNode);this.inherited(arguments)},refresh:function(){this.fullscreenPopupTitle.innerHTML=this.titleStr;n.place(this.content,this.fullscreenPopupContent);this.resize()},show:function(){p.setStyle(this.domNode,"display","block");this.isShow=!0;this.refresh()},hide:function(){p.setStyle(this.domNode,
"display","none");q.remove(this.outerMainPage,"glass-blur");this.isShow=!1;this.destroy()},enableButton:function(a){a=this._btns[a];h.remove(a,"disabled");p.removeClass(a,"disabled");return a},disableButton:function(a){a=this._btns[a];h.set(a,{disabled:"disabled"});p.addClass(a,"disabled");return a},close:function(){this._onCloseClick()},setTitle:function(a){a&&(this.fullscreenPopupTitle.innerHTML=a)},setSubTitle:function(a){},resize:function(){this.btnsAtuoBottom&&this._setBtnsAutoBottom();this.contentAutoHeight&&
this._setContentAutoHeight()},_onContainerClick:function(a){a.stopPropagation();return!1},_onCloseClick:function(){this.hide()},_ieBlurPolyfill:function(){},_setBtnsAutoBottom:function(){var a=this.head;this._footerMarginTop||(this._footerMarginTop=l.get(this.fullscreenPopupBtns,"margin-top"));this._footerPaddingTopHeight||(this._footerPaddingTopHeight=l.get(this.fullscreenPopupBtnsContainer,"padding-top"));this._footerPaddingBottomHeight||(this._footerPaddingBottomHeight=l.get(this.fullscreenPopupBtnsContainer,
"padding-bottom"));this._footerHeight||(this._footerHeight=l.get(this.fullscreenPopupBtns,"height"));document.body.clientHeight-a.clientHeight-(this._footerMarginTop+this._footerHeight+this._footerPaddingTopHeight+this._footerPaddingBottomHeight)<this.fullscreenPopupContent.scrollHeight?(l.set(this.contentScroller,"height",document.body.clientHeight-a.clientHeight-this._footerMarginTop-this._footerPaddingTopHeight-this._footerPaddingBottomHeight+"px"),l.set(this.fullscreenPopupBtns,"margin-top","0")):
(l.set(this.contentScroller,"height",this.fullscreenPopupContent.scrollHeight+"px"),l.set(this.fullscreenPopupBtns,"margin-top",this._footerMarginTop+"px"))},_setContentAutoHeight:function(){q.add(this.main,"autoHeight");var a=this.head.scrollHeight,b=this.fullscreenPopupBtnsContainer.scrollHeight,c=l.get(this.fullscreenPopupBtns,"margin-top");l.set(this.contentScroller,"height",document.body.clientHeight-a-b-c+"px")}})})},"dojo/throttle":function(){define([],function(){return function(k,e){var p=
!0;return function(){p&&(p=!1,k.apply(this,arguments),setTimeout(function(){p=!0},e))}}})},"dojox/form/Uploader":function(){define("dojo/_base/kernel dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/_base/window dojo/dom-style dojo/dom-class dojo/dom-geometry dojo/dom-attr dojo/dom-construct dojo/dom-form dijit dijit/form/Button ./uploader/_Base ./uploader/_HTML5 ./uploader/_IFrame ./uploader/_Flash dojo/i18n!./nls/Uploader dojo/text!./resources/Uploader.html".split(" "),
function(k,e,p,q,n,l,h,f,d,c,a,b,g,u,m,r,t,v,y,w){return e("dojox.form.Uploader",[m,u,r,t,v],{uploadOnSelect:!1,tabIndex:0,multiple:!1,label:y.label,url:"",name:"uploadedfile",flashFieldName:"",force:"",uploadType:"",showInput:"",focusedClass:"dijitButtonHover",_nameIndex:0,templateString:w,baseClass:"dijitUploader "+u.prototype.baseClass,postMixInProperties:function(){this._inputs=[];this._cons=[];this.force=this.force.toLowerCase();this.supports("multiple")?this.uploadType="form"===this.force?"form":
"html5":this.uploadType="flash"===this.force?"flash":"iframe";this.inherited(arguments)},buildRendering:function(){this.inherited(arguments);h.set(this.domNode,{overflow:"hidden",position:"relative"});this._buildDisplay();c.set(this.titleNode,"tabIndex",-1)},_buildDisplay:function(){this.showInput&&(this.displayInput=a.create("input",{"class":"dijitUploadDisplayInput",tabIndex:-1,autocomplete:"off",role:"presentation"},this.containerNode,this.showInput),this._attachPoints.push("displayInput"),this.connect(this,
"onChange",function(a){for(var b=0,c,d=[];c=a[b++];)c&&c.name&&d.push(c.name);this.displayInput.value=d.join(", ")}),this.connect(this,"reset",function(){this.displayInput.value=""}))},startup:function(){this._buildInitialized||(this._buildInitialized=!0,this._getButtonStyle(this.domNode),this._setButtonStyle(),this.inherited(arguments))},onChange:function(a){},onBegin:function(a){},onProgress:function(a){},onComplete:function(a){this.reset()},onCancel:function(){},onAbort:function(){},onError:function(a){},
upload:function(a){a=a||{};a.uploadType=this.uploadType;this.inherited(arguments)},submit:function(a){a=a?a.tagName?a:this.getForm():this.getForm();a=b.toObject(a);a.uploadType=this.uploadType;this.upload(a)},reset:function(){delete this._files;this._disconnectButton();q.forEach(this._inputs,a.destroy);this._inputs=[];this._nameIndex=0;this._createInput()},getFileList:function(){var a=[];this.supports("multiple")?q.forEach(this._files,function(b,c){a.push({index:c,name:b.name,size:b.size,type:b.type})},
this):q.forEach(this._inputs,function(b,c){b.value&&a.push({index:c,name:b.value.substring(b.value.lastIndexOf("\\")+1),size:0,type:b.value.substring(b.value.lastIndexOf(".")+1)})},this);return a},_getValueAttr:function(){return this.getFileList()},_setValueAttr:function(a){console.error("Uploader value is read only")},_setDisabledAttr:function(a){this.disabled!=a&&this.inputNode&&(this.inherited(arguments),h.set(this.inputNode,"display",a?"none":""))},_getButtonStyle:function(a){this.btnSize={w:h.get(a,
"width"),h:h.get(a,"height")}},_setButtonStyle:function(){this.inputNodeFontSize=Math.max(2,Math.max(Math.ceil(this.btnSize.w/60),Math.ceil(this.btnSize.h/15)));this._createInput()},_getFileFieldName:function(){return this.supports("multiple")&&this.multiple?this.name+"s[]":this.name+(this.multiple?this._nameIndex:"")},_createInput:function(){this._inputs.length&&(h.set(this.inputNode,{top:"500px"}),this._disconnectButton(),this._nameIndex++);var b=this._getFileFieldName();this.focusNode=this.inputNode=
a.create("input",{type:"file",name:b,"aria-labelledby":this.id+"_label"},this.domNode,"first");this.supports("multiple")&&this.multiple&&c.set(this.inputNode,"multiple",!0);this._inputs.push(this.inputNode);h.set(this.inputNode,{position:"absolute",fontSize:this.inputNodeFontSize+"em",top:"-3px",right:"-3px",opacity:0});this._connectButton()},_connectButton:function(){this._cons.push(n.connect(this.inputNode,"change",this,function(a){this._files=this.inputNode.files;this.onChange(this.getFileList(a));
!this.supports("multiple")&&this.multiple&&this._createInput()}));-1<this.tabIndex&&(this.inputNode.tabIndex=this.tabIndex,this._cons.push(n.connect(this.inputNode,"focus",this,function(){f.add(this.domNode,this.focusedClass)})),this._cons.push(n.connect(this.inputNode,"blur",this,function(){f.remove(this.domNode,this.focusedClass)})))},_disconnectButton:function(){q.forEach(this._cons,n.disconnect);this._cons.splice(0,this._cons.length)}})})},"dojox/form/uploader/_Base":function(){define("dojo/dom-form dojo/dom-style dojo/dom-construct dojo/dom-attr dojo/has dojo/_base/declare dojo/_base/event dijit/_Widget dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin".split(" "),
function(k,e,p,q,n,l,h,f,d,c){n.add("FormData",function(){return!!window.FormData});n.add("xhr-sendAsBinary",function(){var a=window.XMLHttpRequest&&new window.XMLHttpRequest;return a&&!!a.sendAsBinary});n.add("file-multiple",function(){return!!{"true":1,"false":1}[q.get(document.createElement("input",{type:"file"}),"multiple")]});return l("dojox.form.uploader._Base",[f,d,c],{getForm:function(){if(!this.form)for(var a=this.domNode;a&&a.tagName&&a!==document.body;){if("form"==a.tagName.toLowerCase()){this.form=
a;break}a=a.parentNode}return this.form},getUrl:function(){this.uploadUrl&&(this.url=this.uploadUrl);if(this.url)return this.url;this.getForm()&&(this.url=this.form.action);return this.url},connectForm:function(){this.url=this.getUrl();!this._fcon&&this.getForm()&&(this._fcon=!0,this.connect(this.form,"onsubmit",function(a){console.log("SUBMIT");h.stop(a);this.submit(this.form)}))},supports:function(a){switch(a){case "multiple":if("flash"==this.force||"iframe"==this.force)break;return n("file-multiple");
case "FormData":return n(a);case "sendAsBinary":return n("xhr-sendAsBinary")}return!1},getMimeType:function(){return"application/octet-stream"},getFileType:function(a){return a.substring(a.lastIndexOf(".")+1).toUpperCase()},convertBytes:function(a){var b=Math.round(a/1024*1E5)/1E5,c=Math.round(a/1048576*1E5)/1E5,d=Math.round(a/1073741824*1E5)/1E5,f=a;1<b&&(f=b.toFixed(1)+" kb");1<c&&(f=c.toFixed(1)+" mb");1<d&&(f=d.toFixed(1)+" gb");return{kb:b,mb:c,gb:d,bytes:a,value:f}}})})},"dojox/form/uploader/_HTML5":function(){define(["dojo/_base/declare",
"dojo/_base/lang","dojo/_base/array","dojo"],function(k,e,p,q){return k("dojox.form.uploader._HTML5",[],{errMsg:"Error uploading files. Try checking permissions",uploadType:"html5",postMixInProperties:function(){this.inherited(arguments)},postCreate:function(){this.connectForm();this.inherited(arguments);this.uploadOnSelect&&this.connect(this,"onChange",function(e){this.upload(e[0])})},_drop:function(e){q.stopEvent(e);this._files=e.dataTransfer.files;this.onChange(this.getFileList())},upload:function(e){this.onBegin(this.getFileList());
this.uploadWithFormData(e)},addDropTarget:function(e,k){k||(this.connect(e,"dragenter",q.stopEvent),this.connect(e,"dragover",q.stopEvent),this.connect(e,"dragleave",q.stopEvent));this.connect(e,"drop","_drop")},uploadWithFormData:function(e){if(this.getUrl()){var k=new FormData,h=this._getFileFieldName();p.forEach(this._files,function(d,c){k.append(h,d)},this);if(e){e.uploadType=this.uploadType;for(var f in e)k.append(f,e[f])}this.createXhr().send(k)}else console.error("No upload url found.",this)},
_xhrProgress:function(e){if(e.lengthComputable){var k={bytesLoaded:e.loaded,bytesTotal:e.total,type:e.type,timeStamp:e.timeStamp};"load"==e.type?(k.percent="100%",k.decimal=1):(k.decimal=e.loaded/e.total,k.percent=Math.ceil(e.loaded/e.total*100)+"%");this.onProgress(k)}},createXhr:function(){var k=new XMLHttpRequest,l;k.upload.addEventListener("progress",e.hitch(this,"_xhrProgress"),!1);k.addEventListener("load",e.hitch(this,"_xhrProgress"),!1);k.addEventListener("error",e.hitch(this,function(e){this.onError(e);
clearInterval(l)}),!1);k.addEventListener("abort",e.hitch(this,function(e){this.onAbort(e);clearInterval(l)}),!1);k.onreadystatechange=e.hitch(this,function(){if(4===k.readyState){clearInterval(l);try{this.onComplete(JSON.parse(k.responseText.replace(/^\{\}&&/,"")))}catch(h){console.error("Error parsing server result:",h),console.error(k.responseText),this.onError("Error parsing server result:",h)}}});k.open("POST",this.getUrl());k.setRequestHeader("Accept","application/json");l=setInterval(e.hitch(this,
function(){}),250);return k}})})},"dojox/form/uploader/_IFrame":function(){define("dojo/query dojo/dom-construct dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/dom-form dojo/request/iframe".split(" "),function(k,e,p,q,n,l,h){return p("dojox.form.uploader._IFrame",[],{postMixInProperties:function(){this.inherited(arguments);"iframe"===this.uploadType&&(this.uploadType="iframe",this.upload=this.uploadIFrame)},uploadIFrame:function(f){var d={},c;this.getForm();var a=this.getUrl(),b=this;f=
f||{};f.uploadType=this.uploadType;c=e.place('\x3cform enctype\x3d"multipart/form-data" method\x3d"post"\x3e\x3c/form\x3e',this.domNode);n.forEach(this._inputs,function(a,b){""!==a.value&&(c.appendChild(a),d[a.name]=a.value)},this);if(f)for(nm in f)void 0===d[nm]&&e.create("input",{name:nm,value:f[nm],type:"hidden"},c);h.post(a,{form:c,handleAs:"json",content:f}).then(function(a){e.destroy(c);if(a.ERROR||a.error)b.onError(a);else b.onComplete(a)},function(a){console.error("error parsing server result",
a);e.destroy(c);b.onError(a)})}})})},"dojox/form/uploader/_Flash":function(){define("dojo/dom-form dojo/dom-style dojo/dom-construct dojo/dom-attr dojo/_base/declare dojo/_base/config dojo/_base/connect dojo/_base/lang dojo/_base/array dojox/embed/Flash".split(" "),function(k,e,p,q,n,l,h,f,d,c){return n("dojox.form.uploader._Flash",[],{swfPath:l.uploaderPath||require.toUrl("dojox/form/resources/uploader.swf"),preventCache:!0,skipServerCheck:!0,serverTimeout:2E3,isDebug:!1,devMode:!1,deferredUploading:0,
postMixInProperties:function(){"flash"===this.uploadType&&(this._files=[],this._fileMap={},this._createInput=this._createFlashUploader,this.getFileList=this.getFlashFileList,this.reset=this.flashReset,this.upload=this.uploadFlash,this.fieldname="flashUploadFiles");this.inherited(arguments)},onReady:function(a){},onLoad:function(a){},onFileChange:function(a){},onFileProgress:function(a){},getFlashFileList:function(){return this._files},flashReset:function(){this.flashMovie.reset();this._files=[];this._fileMap=
{}},uploadFlash:function(a){this.onBegin(this.getFileList());a=a||{};a.returnType="F";a.uploadType=this.uploadType;console.log("flas upload",a);this.flashMovie.doUpload(a)},_change:function(a){this._files=this._files.concat(a);d.forEach(a,function(a){a.bytesLoaded=0;a.bytesTotal=a.size;this._fileMap[a.name+"_"+a.size]=a},this);this.onChange(this._files);this.onFileChange(a)},_complete:function(a){this._getCustomEvent().type="load";this.onComplete(a)},_progress:function(a){this._fileMap[a.name+"_"+
a.bytesTotal].bytesLoaded=a.bytesLoaded;var b=this._getCustomEvent();this.onFileProgress(a);this.onProgress(b)},_error:function(a){this.onError(a)},_onFlashBlur:function(a){},_getCustomEvent:function(){var a={bytesLoaded:0,bytesTotal:0,type:"progress",timeStamp:(new Date).getTime()},b;for(b in this._fileMap)a.bytesTotal+=this._fileMap[b].bytesTotal,a.bytesLoaded+=this._fileMap[b].bytesLoaded;a.decimal=a.bytesLoaded/a.bytesTotal;a.percent=Math.ceil(a.bytesLoaded/a.bytesTotal*100)+"%";return a},_connectFlash:function(){this._subs=
[];this._cons=[];var a=f.hitch(this,function(a,c){this._subs.push(h.subscribe(this.id+a,this,c))});a("/filesSelected","_change");a("/filesUploaded","_complete");a("/filesProgress","_progress");a("/filesError","_error");a("/filesCanceled","onCancel");a("/stageBlur","_onFlashBlur");this.connect(this.domNode,"focus",function(){this.flashMovie.focus();this.flashMovie.doFocus()});0<=this.tabIndex&&q.set(this.domNode,"tabIndex",this.tabIndex)},_createFlashUploader:function(){var a=this.btnSize.w,b=this.btnSize.h;
if(a){var d=this.getUrl();if(d){if(0>d.toLowerCase().indexOf("http")&&0!=d.indexOf("/")){var h=window.location.href.split("/");h.pop();h=h.join("/")+"/";d=h+d}}else console.warn("Warning: no uploadUrl provided.");this.inputNode=p.create("div",{className:"dojoxFlashNode"},this.domNode,"first");e.set(this.inputNode,{position:"absolute",top:"-2px",width:a+"px",height:b+"px",opacity:0});a={expressInstall:!0,path:(this.swfPath.uri||this.swfPath)+(this.preventCache?"?cb_"+(new Date).getTime():""),width:a,
height:b,allowScriptAccess:"always",allowNetworking:"all",vars:{uploadDataFieldName:this.flashFieldName||this.name+"Flash",uploadUrl:d,uploadOnSelect:this.uploadOnSelect,deferredUploading:this.deferredUploading||0,selectMultipleFiles:this.multiple,id:this.id,isDebug:this.isDebug,noReturnCheck:this.skipServerCheck,serverTimeout:this.serverTimeout},params:{scale:"noscale",wmode:"opaque",allowScriptAccess:"always",allowNetworking:"all"}};this.flashObject=new c(a,this.inputNode);this.flashObject.onError=
f.hitch(function(a){console.error("Flash Error: "+a)});this.flashObject.onReady=f.hitch(this,function(){this.onReady(this)});this.flashObject.onLoad=f.hitch(this,function(a){this.flashMovie=a;this.flashReady=!0;this.onLoad(this)});this._connectFlash()}else setTimeout(dojo.hitch(this,function(){this._getButtonStyle(this.domNode);this._createFlashUploader()}),200)}})})},"dojox/embed/Flash":function(){define("dojo/_base/lang dojo/_base/unload dojo/_base/array dojo/query dojo/has dojo/dom dojo/on dojo/window dojo/string".split(" "),
function(k,e,p,q,n,l,h,f,d){function c(a){a=k.delegate(u,a);if(!("path"in a))return console.error("dojox.embed.Flash(ctor):: no path reference to a Flash movie was provided."),null;"id"in a||(a.id="dojox-embed-flash-"+g++);return a}var a,b,g=0,u={expressInstall:!1,width:320,height:240,swLiveConnect:"true",allowScriptAccess:"sameDomain",allowNetworking:"all",style:null,redirect:null};n("ie")?(a=function(a){a=c(a);if(!a)return null;var b,g=a.path;if(a.vars){var f=[];for(b in a.vars)f.push(encodeURIComponent(b)+
"\x3d"+encodeURIComponent(a.vars[b]));a.params.FlashVars=f.join("\x26");delete a.vars}g='\x3cobject id\x3d"'+d.escape(String(a.id))+'" classid\x3d"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" width\x3d"'+d.escape(String(a.width))+'" height\x3d"'+d.escape(String(a.height))+'"'+(a.style?' style\x3d"'+d.escape(String(a.style))+'"':"")+'\x3e\x3cparam name\x3d"movie" value\x3d"'+d.escape(String(g))+'" /\x3e';if(a.params)for(b in a.params)g+='\x3cparam name\x3d"'+d.escape(b)+'" value\x3d"'+d.escape(String(a.params[b]))+
'" /\x3e';return{id:a.id,markup:g+"\x3c/object\x3e"}},b=function(){for(var a=10,b=null;!b&&7<a;)try{b=new ActiveXObject("ShockwaveFlash.ShockwaveFlash."+a--)}catch(v){}return b?(a=b.GetVariable("$version").split(" ")[1].split(","),{major:null!=a[0]?parseInt(a[0]):0,minor:null!=a[1]?parseInt(a[1]):0,rev:null!=a[2]?parseInt(a[2]):0}):{major:0,minor:0,rev:0}}(),e.addOnWindowUnload(function(){console.warn("***************UNLOAD");var a=function(){};q("object").reverse().style("display","none").forEach(function(b){for(var c in b)if("FlashVars"!=
c&&"function"==typeof b[c])try{b[c]=a}catch(y){}})})):(a=function(a){a=c(a);if(!a)return null;var b,g=a.path;if(a.vars){var f=[];for(b in a.vars)f.push(encodeURIComponent(b)+"\x3d"+encodeURIComponent(a.vars[b]));a.params.flashVars=f.join("\x26");delete a.vars}g='\x3cembed type\x3d"application/x-shockwave-flash" src\x3d"'+d.escape(String(g))+'" id\x3d"'+d.escape(String(a.id))+'" width\x3d"'+d.escape(String(a.width))+'" height\x3d"'+d.escape(String(a.height))+'"'+(a.style?' style\x3d"'+d.escape(String(a.style))+
'" ':"")+'pluginspage\x3d"'+window.location.protocol+'//www.adobe.com/go/getflashplayer" ';if(a.params)for(b in a.params)g+=" "+d.escape(b)+'\x3d"'+d.escape(String(a.params[b]))+'"';return{id:a.id,markup:g+" /\x3e"}},b=function(){var a=navigator.plugins["Shockwave Flash"];return a&&a.description?(a=a.description.replace(/([a-zA-Z]|\s)+/,"").replace(/(\s+r|\s+b[0-9]+)/,".").split("."),{major:null!=a[0]?parseInt(a[0]):0,minor:null!=a[1]?parseInt(a[1]):0,rev:null!=a[2]?parseInt(a[2]):0}):{major:0,minor:0,
rev:0}}());var m=function(a,c){if(-1<location.href.toLowerCase().indexOf("file://"))throw Error("dojox.embed.Flash can't be run directly from a file. To instatiate the required SWF correctly it must be run from a server, like localHost.");this.available=b.major;this.minimumVersion=a.minimumVersion||9;this.domNode=this.movie=this.id=null;c&&(c=l.byId(c));setTimeout(k.hitch(this,function(){if(a.expressInstall||this.available&&this.available>=this.minimumVersion)if(a&&c)this.init(a,c);else this.onError("embed.Flash was not provided with the proper arguments.");
else if(this.available)this.onError("Flash version detected: "+this.available+" is out of date. Minimum required: "+this.minimumVersion);else this.onError("Flash is not installed.")}),100)};k.extend(m,{onReady:function(a){},onLoad:function(a){},onError:function(a){},_onload:function(){clearInterval(this._poller);delete this._poller;delete this._pollCount;delete this._pollMax;this.onLoad(this.movie)},init:function(a,b){this.destroy();b=l.byId(b||this.domNode);if(!b)throw Error("dojox.embed.Flash: no domNode reference has been passed.");
var c=0;this._poller=null;this._pollCount=0;this._pollMax=15;this.pollTime=100;m.initialized&&(this.id=m.place(a,b),this.domNode=b,setTimeout(k.hitch(this,function(){this.movie=this.byId(this.id,a.doc);this.onReady(this.movie);this._poller=setInterval(k.hitch(this,function(){try{c=this.movie.PercentLoaded()}catch(y){console.warn("this.movie.PercentLoaded() failed",y,this.movie)}if(100==c)this._onload();else if(0==c&&this._pollCount++>this._pollMax)throw clearInterval(this._poller),Error("Building SWF failed.");
}),this.pollTime)}),1))},_destroy:function(){try{this.domNode.removeChild(this.movie)}catch(r){}this.id=this.movie=this.domNode=null},destroy:function(){if(this.movie){var a=k.delegate({id:!0,movie:!0,domNode:!0,onReady:!0,onLoad:!0}),b;for(b in this)a[b]||delete this[b];this._poller?h(this,"Load",this,"_destroy"):this._destroy()}},byId:function(a,b){b=b||document;return b.embeds[a]?b.embeds[a]:b[a]?b[a]:window[a]?window[a]:document[a]?document[a]:null}});k.mixin(m,{minSupported:8,available:b.major,
supported:b.major>=b.required,minimumRequired:b.required,version:b,initialized:!1,onInitialize:function(){m.initialized=!0},__ie_markup__:function(b){return a(b)},proxy:function(a,b){p.forEach(b instanceof Array?b:[b],function(a){this[a]=k.hitch(this,function(){return function(){return eval(this.movie.CallFunction('\x3cinvoke name\x3d"'+a+'" returntype\x3d"javascript"\x3e\x3carguments\x3e'+p.map(arguments,function(a){return __flash__toXML(a)}).join("")+"\x3c/arguments\x3e\x3c/invoke\x3e"))}.apply(this,
arguments||[])})},a)}});m.place=function(b,c){b=a(b);c=l.byId(c);c||(c=f.doc.createElement("div"),c.id=b.id+"-container",f.body().appendChild(c));return b?(c.innerHTML=b.markup,b.id):null};m.onInitialize();k.setObject("dojox.embed.Flash",m);return m})},"builder/plugins/app-list/AppCatalogPage":function(){define("dojo/_base/declare dojo/_base/html dojo/dom-style dojo/dom dojo/_base/array dojo/on dojo/_base/lang dojo/query dojo/dom-attr dojo/topic dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./AppCatalogPage.html ./AppOperMenu".split(" "),
function(k,e,p,q,n,l,h,f,d,c,a,b,g,u,m){return k([a,b,g],{baseClass:"app-catalog-page",templateString:u,_defaultStyleColor:"#31aacd",loading:null,folderUrl:null,appListWidget:null,_eventHandles:null,_appOperMenus:null,postMixInProperties:function(){this.inherited(arguments);this.nls=this.appListWidget.nls;this.loading=this.appListWidget.loading;this.folderUrl=this.appListWidget.folderUrl},constructor:function(){this._appOperMenus=[];this._eventHandles=[]},startup:function(){this.inherited(arguments)},
refresh:function(a,b){this.createAppList(a,b);e.setSelectable(this.appContent,!1)},createAppList:function(a){var b;this.cleanAppList();e.setStyle(this.listSectionBodyContent,"display","block");if(0<a.length)for(b=0;b<a.length;b++)this.createAppNode(a[b],b);else this.appListWidget._addEmptyDescription(this.listTableBody)},cleanAppList:function(){e.empty(this.listTableBody);n.forEach(this._appOperMenus,function(a){a.destroy()});this._appOperMenus=[];n.forEach(this._eventHandles,function(a){a.remove()});
this._eventHandles=[]},createAppNode:function(a,b){return this._createItem(a,b)},_createItem:function(a,b){b=e.create("tr",{"class":"app-catalogs list-table-item"+(b%2?" list-table-item-add ":" "),"data-app-id":a.id,"data-app-name":a.name},this.listTableBody);var d=e.create("td",{"class":"item-td"},b),d=e.create("div",{"class":"catalog"},d),g=e.create("div",{"class":"content-theme jimu-float-leading"},d),f=e.create("div",{"class":"content-theme-icon "+(a._defaultIconClass?a._defaultIconClass:""),
title:this.nls.launch},g);a.thumbnail&&p.set(f,"backgroundImage","url("+a.thumbnail+"?date\x3d"+this.appListWidget.getRefreshImageFlag()+")");e.create("div",{"class":"content-theme-flagImg content-theme-flagImg-"+this._getType(a.appType)},f);var f=e.create("div",{"class":"content-opers jimu-float-trailing"},d),k=e.create("div",{"class":"content-opers-btns"},f),f=e.create("div",{"class":"content-opers-btn content-opers-btns-edit",title:this.nls.configApp},k),n=e.create("div",{"class":"content-opers-btn content-opers-btns-launch",
title:this.nls.launch},k),r=e.create("div",{"class":"content-opers-btn content-opers-btns-download",title:this.nls.download},k),k=e.create("div",{"class":"content-opers-btn content-opers-btns-more","data-appid":a.id},k),t=(new m({app:a,posNode:k,appListWidget:this.appListWidget,nls:this.nls,isTemplate:!1,appContentNode:this.appContent,height:122,offset:{top:42,left:-16,right:-16}})).placeAt(k);this._appOperMenus.push(t);this._eventHandles.push(l(g,"click",h.hitch(this,this._onAppLaunchClick,a)));
this._eventHandles.push(l(r,"click",h.hitch(this,this._onAppDownloadClick,a)));this._eventHandles.push(l(f,"click",h.hitch(this,this._onAppEditClick,a)));this._eventHandles.push(l(n,"click",h.hitch(this,this._onAppLaunchClick,a)));this._eventHandles.push(l(k,"click",h.hitch(this,this._onAppMoreClick,a,t,k)));d=e.create("div",{"class":"catalog-content"},d);g=e.create("div",{"class":"catalog-content-head"},d);e.create("p",{"class":"catalog-content-appname long-text-ellipsis",innerHTML:a.name,title:a.name},
g);g=e.create("p",{"class":"catalog-content-appinfo long-text-ellipsis jimu-float-trailing"},g);e.create("span",{"class":"catalog-content-appinfo-time jimu-float-leading",innerHTML:this.appListWidget._getLocaleDateTime(a.lastUpdated)},g);e.create("span",{"class":"catalog-content-appinfo-owner jimu-float-leading",innerHTML:"\x3cp class\x3d'catalog-content-appinfo-owner-name long-text-ellipsis'title\x3d'"+a.creator+"'\x3e"+a.creator+"\x3c/p\x3e"},g);e.create("p",{"class":"catalog-content-dis "+(a.description?
"":"place-holder-class"),innerHTML:a.description?a.description:this.nls.defaultDesc,title:a.description},d);this._eventHandles.push(l(q.byId("content-box"),"click",h.hitch(this,this.resetStatus)));this._eventHandles.push(l(this.ownerDocument,"click",h.hitch(this,this.resetStatus)));this._eventHandles.push(c.subscribe("menuAll/hide",h.hitch(this,this.resetStatus)));return b},_getType:function(a){var b="";switch(a){case "HTML":b="2D";break;case "HTML3D":b="3D";break;default:console.error("AppCatalogPage Error _getType")}return b},
resetStatus:function(a){this._hideAllAppOperMenus(a);this._hideBtnsSelect(a)},_hideAllAppOperMenus:function(a){n.forEach(this._appOperMenus,function(b){!b.isShow||"undefined"!==typeof a&&"undefined"!==typeof a.itemId&&a.itemId===b.app.id||b.hide()})},_hideBtnsSelect:function(a){for(var b=f(".content-opers-btns-more"),c=0,g=b.length;c<g;c++){var h=b[c];"undefined"!==typeof a&&"undefined"!==typeof a.itemId&&a.itemId===parseInt(d.get(h,"data-appid"),10)||e.removeClass(h,"content-opers-btns-more-selected")}},
_onAppDownloadClick:function(a){window.open(a.downloadUrl,"downloadTargetFrame")},_onAppEditClick:function(a){this.appListWidget.pluginManager.getPluginByName("startup").switchToAppConfig(a)},_onAppLaunchClick:function(a){window.open(a.appUrl,"_blank")},_onAppMoreClick:function(a,b,d,g){g&&(g.itemId=a.id);b.isShow?b.hide():(c.publish("menuAll/hide"),b.set("app",a),b.show(),e.addClass(d,"content-opers-btns-more-selected"))}})})},"builder/plugins/app-list/AppOperMenu":function(){define("dojo/_base/declare dojo/_base/html dijit/_WidgetBase dijit/_TemplatedMixin dojo/text!./AppOperMenu.html dojo/on dojo/query dojo/keys dojo/_base/lang jimu/dijit/Popup jimu/dijit/Message builder/serviceUtils jimu/dijit/QRCode builder/dijit/FullScreenPopup builder/dijit/EditItemInfo".split(" "),
function(k,e,p,q,n,l,h,f,d,c,a,b,g,u,m){return k([p,q],{templateString:n,baseClass:"app-oper-menu white-style",app:void 0,isShow:!1,position:{},itemDefaultColor:"#ffffff",appListWidget:void 0,loadingDiv:null,_loading:null,_downloadUrl:null,constructor:function(){this.height||(this.height=0);this.offset||(this.offset={top:0,left:0,right:0})},postCreate:function(){this.inherited(arguments);this._loading=this.appListWidget.loading;this._initMenu();this.hide();this._downloadUrl="/webappbuilder/rest/apps/"+
this.app.id+"/download";e.setAttr(this.downloadLinkNode,"href",this._downloadUrl);this.own(l(this.downloadLinkNode,"click",d.hitch(this,function(){this.hide()})));this.app.isTemplate&&e.setAttr(this.editAppInfo,"innerHTML",this.nls.editTemplateInfo)},refresh:function(){var a="",b="";if(this.appContentNode){var a=e.position(this.posNode),b=e.position(this.appContentNode),c=e.getStyle(this.appContentNode,"height");a.y+this.height+25>b.y+c?(b=this.offset.top,a="",e.setStyle(this.upTriangle,"display",
"none"),e.setStyle(this.downTriangle,"top",this.height-4+"px"),e.setStyle(this.downTriangle,"display","block")):(a=this.offset.top,b="")}e.setStyle(this.domNode,isRTL?{top:a+"px",bottom:b+"px",left:this.offset.left+"px"}:{top:a+"px",bottom:b+"px",right:this.offset.right+"px"})},_refreshAppOrTempaltePage:function(){this.appListWidget.resetRefreshImageFlag();this.app.isTemplate?this.appListWidget.refreshTemplatePage():this.appListWidget.refreshAppPage()},show:function(){this.refresh();e.setStyle(this.domNode,
"display","block");this.isShow=!0},hide:function(){e.setStyle(this.domNode,"display","none");this.isShow=!1},_initMenu:function(){this.isTemplate?(e.addClass(this.editAppInfo,"border-top-radius"),this._disableItem(this.createAppFromTemplate),this.app.isPredefined&&(this._disableItem(this.duplicate),this._disableItem(this.editAppInfo),this._disableItem(this.remove),this._disableItem(this.download),this._disableItem(this.duplicate))):(e.addClass(this.editAppInfo,"border-top-radius"),this._disableItem(this.createAppFromTemplate),
this._disableItem(this.download))},_disableItem:function(a){e.setStyle(a,"display","none")},_onMenuClick:function(a){a.stopPropagation()},_onRemoveClick:function(){var a,g;this.app.isTemplate?(a=this.nls.confirmDeleteTemplate,g=this.nls.deleteTemplateTitle):(a=this.nls.confirmDeleteApp,g=this.nls.deleteAppTitle);var f=new c({content:a,titleLabel:g,width:"425",autoHeight:!0,"class":"jimu-popup-in-home",buttons:[{label:this.nls.ok,onClick:d.hitch(this,function(){this._loading.show(this.nls.deleting);
f.close();b.removeApp(this.app.id).then(d.hitch(this,function(a){a.success?(console.log("Removed app successfully, id\x3d"+this.app.id),this._refreshAppOrTempaltePage()):console.error(this.nls.deleteFalse);this._loading.hide()}),function(){console.error(this.nls.deleteError);this._loading.hide()})})},{label:this.nls.cancel,classNames:["jimu-btn-vacation"],onClick:d.hitch(this,function(){f.close()})}]})},_onDuplicateClick:function(){this._loading.show(this.nls.duplicating);b.duplicateApp({name:this.app.name,
description:this.app.description,fromAppId:this.app.id,appType:this.app.appType,isTemplate:this.app.isTemplate,isPredefined:this.app.isPredefined}).then(d.hitch(this,function(a){this._loading.hide();a.success?(console.log("Duplicated app successfully, app id\x3d"+this.app.id),this._refreshAppOrTempaltePage()):console.error(this.nls.duplicateFalse)}),function(){console.error(this.nls.duplicateError);this._loading.hide()});this.hide()},_onEditClick:function(){this.itemInfoDijit=new m({itemInfo:this.app,
nls:this.nls});var a;a=this.app.isTemplate?this.nls.editTemplateInfo:this.nls.editAppInfo;var b=h("#main-page")[0];this._EditPopup=new u({zIndex:101,titleStr:a,blurContainer:b.firstElementChild,content:this.itemInfoDijit.domNode,subDijit:this.itemInfoDijit,buttons:[{label:this.nls.ok,isHighLight:!0,onClick:d.hitch(this,this._onEditOKClick)},{label:this.nls.cancel,isHighLight:!1,onClick:d.hitch(this,this._onEditCancelClick)}],btnsAtuoBottom:!0});this._EditPopup.placeAt(b);this._EditPopup.show();this.itemInfoDijit.focusItemByName("appName");
this.hide();this.posNode&&e.removeClass(this.posNode,"item-more-selected")},_onEditOKClick:function(){var b=d.clone(this.app),c=this.itemInfoDijit.getProperties();b.name=c.name;b.description=c.description;!0!==this.app.isTemplate&&c.icon&&(b.icon=c.icon);c.thumbnail&&(b.thumbnail=c.thumbnail);this.appListWidget.updateApp(b).then(d.hitch(this,function(b){!0===b.success?(this._refreshAppOrTempaltePage(),this._EditPopup.close()):(console.error(b.message),new a({message:this.nls.editAppFalse}))}),d.hitch(this,
function(b){console.error(b);new a({message:this.nls.editError})}))},_onEditCancelClick:function(){this._EditPopup&&this._EditPopup.close()},_onDownloadClick:function(){},_onAgolTemplateClick:function(){var a=this.appListWidget.pluginsMeta["popup-actions.popup-agoltemplate"];a&&this.appListWidget.pluginManager.loadPlugin(a).then(d.hitch(this,function(a){a.onClickBeforeConfigPage(this.app)}))},_onCreateAppFromTempalteClick:function(){var a=this.appListWidget.pluginManager.getExtensions("startup.creation-entry")[0],
a=this.appListWidget.pluginsMeta[a.pluginName];this._loading.show("");this.appListWidget.pluginManager.loadPlugin(a).then(d.hitch(this,function(a){a.popupNewCreateDlg("",this.app,700);this._loading.hide()}),d.hitch(this,function(){this._loading.hide()}))},_onQRCodeClick:function(){new c({content:new g({text:"http://"+window.location.host+path+"apps/"+this.app.id,width:128,height:128}),container:"main-page",titleLabel:"qrcode-nonls",width:300,autoHeight:!0,buttons:[{label:this.nls.cancel,key:f.ESCAPE}]})}})})},
"builder/dijit/EditItemInfo":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/html dojo/Deferred dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dijit/dijit dojo/text!./templates/EditItemInfo.html dojo/dom-style dojo/dom-class dojo/_base/lang dojo/on dojo/mouse dojo/query dojo/dom-attr dojo/promise/all builder/portalUtils jimu/portalUrlUtils jimu/utils ./Tags dijit/form/SimpleTextarea jimu/dijit/ImageChooser dojo/has dojo/sniff dijit/form/TextBox dijit/form/Select dijit/form/CheckBox".split(" "),
function(k,e,p,q,n,l,h,f,d,c,a,b,g,u,m,r,t,v,y,w,z,x,A,C){return k([n,l,h],{templateString:d,baseClass:"dijit-item-info",_isTemplate:"",postMixInProperties:function(){this.inherited(arguments);this.nls=b.mixin(this.nls,builderNls)},postCreate:function(){this.inherited(arguments);this._init(this.itemInfo);r.set(this.publishWebmapSummary,"placeholder",this.nls.summaryLabelPlaceHolder)},_init:function(c){var d="";this._isTemplate=!1===c.isTemplate?!1:!0;d="imageChooserTemplate";this.imageChooser=new A({cropImage:!0,
showSelfImg:!0,format:[A.GIF,A.JPEG,A.PNG],goldenWidth:300,goldenHeight:180,maxSize:2048});p.place(this.imageChooser.domNode,this.imageChooserBase);a.add(this.imageChooserContainer,d);a.add(this.imageChooserMasker,d);this.own(g(this.imageChooserContainer,u.enter,b.hitch(this,this._onImageChooserBaseMouseEnter)));this.own(g(this.imageChooserContainer,u.leave,b.hitch(this,this._onImageChooserBaseMouseLeave)));this.own(g(this.imageChooserMasker,"click",b.hitch(this,this._onEmitUploadPic)));this.setProperties(c)},
_onImageChooserBaseMouseEnter:function(a){c.set(this.imageChooserMasker,"display","block");a.stopPropagation();return!1},_onImageChooserBaseMouseLeave:function(a){c.set(this.imageChooserMasker,"display","none");a.stopPropagation();return!1},_onEmitUploadPic:function(){var a=m("form",this.imageChooserBase)[0],a=m("label",a)[0];3<C("ff")||C("chrome")?a.click():g.emit(a,"click",{bubbles:!0,cancelable:!0})},setProperties:function(a){f.byId("publish-webmap-name").set("value",a.name);f.byId("publish-webmap-summary").set("value",
a.description);if(this.imageChooser){var b="",b=a.thumbnail;"undefined"!==typeof b&&this.imageChooser.setDefaultSelfSrc(b)}},getProperties:function(){var a={name:w.stripHTML(f.byId("publish-webmap-name").get("value")),description:w.stripHTML(f.byId("publish-webmap-summary").get("value"))};!0!==this._isTemplate&&(a.icon=this.imageChooser&&this.imageChooser.imageData);a.thumbnail=this.imageChooser&&this.imageChooser.imageData;return a},focusItemByName:function(a){a&&this[a]?this[a].focus():console.log("Error name")}})})},
"builder/plugins/app-list/CardPageWithBigThumbnail":function(){define("dojo/_base/declare dojo/_base/html dojo/_base/array dojo/_base/lang dojo/on dojo/dom ./AppOperMenu dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./CardPageWithBigThumbnail.html dojox/form/Uploader dojo/NodeList-dom".split(" "),function(k,e,p,q,n,l,h,f,d,c,a){return k([f,d,c],{baseClass:"card-page",templateString:a,loading:null,folderUrl:null,appListWidget:null,_eventHandles:null,_appOperMenus:null,
postMixInProperties:function(){this.inherited(arguments);this.nls=this.appListWidget.nls;this.loading=this.appListWidget.loading;this.folderUrl=this.appListWidget.folderUrl},constructor:function(){this._eventHandles=[];this._appOperMenus=[]},startup:function(){this.inherited(arguments);e.setSelectable(this.domNode,!1)},refresh:function(a){this.createItemList(a)},cleanItemList:function(){e.empty(this.cardPageContent);p.forEach(this._appOperMenus,function(a){a.destroy()});this._appOperMenus=[];p.forEach(this._eventHandles,
function(a){a.remove()});this._eventHandles=[]},createItemList:function(a){this.cleanItemList();0<a.length?p.forEach(a,function(a){this.createItemCard(a)},this):this.appListWidget._addEmptyDescription(this.cardPageContent,"card-page")},createItemCard:function(a){var b=a.isTemplate?this.nls.preview:this.nls.launch,c=e.create("div",{"class":"item-card jimu-float-leading"},this.cardPageContent),d=e.create("a",{"class":"thumbnail-part",style:"background-image: url("+a.thumbnail+"?date\x3d"+this.appListWidget.getRefreshImageFlag()+
")",href:a.appUrl,target:"_blank",title:b},c);e.create("div",{"class":"item-type-div "+("HTML"===a.appType?"item-type-2d":"item-type-3d")},d);d=e.create("div",{"class":"appInfo-part"},c);e.create("div",{"class":"item-name-div",innerHTML:a.name,title:a.name},d);var f=e.create("div",{"class":"item-info-div"},d);e.create("div",{"class":"app-time-div jimu-float-leading",innerHTML:this.appListWidget._getLocaleDateTime(a.lastUpdated)},f);e.create("div",{"class":"app-creator-div jimu-float-trailing",innerHTML:a.creator},
f);e.create("div",{"class":"item-des-div "+(a.description?"":"place-holder-class"),innerHTML:a.description?a.description:this.nls.defaultDesc,title:a.description},d);c=e.create("div",{"class":"item-operation-part"},c);e.create("div",{innerHTML:'\x3ca href\x3d"'+a.appUrl+'" target\x3d"_blank"\x3e\x3c/a\x3e',"class":"item-operation launch-operation jimu-float-leading",title:b},c);a.isTemplate||e.create("div",{innerHTML:'\x3ca href\x3d"'+a.downloadUrl+'" target\x3d"downloadTargetFrame"\x3e\x3c/a\x3e',
"class":"item-operation download-operation jimu-float-leading",title:this.nls.download},c);var b=e.create("div",{"class":"item-operation edit-operation jimu-float-leading "+(a.isPredefined?"disable":""),title:a.isTemplate?this.nls.configTemplate:this.nls.configApp},c),k=e.create("div",{"class":"item-operation more-operation jimu-float-trailing "+(a.isPredefined?"disable":"")},c),v=(new h({app:a,posNode:k,appListWidget:this.appListWidget,nls:this.nls,isTemplate:a.isTemplate,appContentNode:this.cardPageContent,
height:a.isTemplate?a.isPredefined?45:162:122,offset:{top:44,left:-10,right:-10}})).placeAt(k);this._appOperMenus.push(v);d=n(k,"click",q.hitch(this,function(b){v.isShow?(v.hide(),e.removeClass(k,"item-more-selected")):(p.forEach(this._appOperMenus,function(a){a.hide();e.removeClass(a.posNode,"item-more-selected")}),v.show(),e.addClass(k,"item-more-selected"));b.itemId=a.id}));this._eventHandles.push(d);d=n(b,"click",q.hitch(this,function(){this.appListWidget.pluginManager.getPluginByName("startup").switchToAppConfig(a)}));
this._eventHandles.push(d);a.isTemplate&&(b=e.create("div",{"class":"item-operation create-app-from-item-operation jimu-float-leading",title:this.nls.createApp},c),d=n(b,"click",q.hitch(this,function(){v._onCreateAppFromTempalteClick()})),this._eventHandles.push(d));d=n(l.byId("content-box"),"click",q.hitch(this,function(b){b.itemId!==a.id&&(v.hide(),e.removeClass(k,"item-more-selected"))}));this._eventHandles.push(d)}})})},"builder/plugins/app-list/CardPageWithSmallThumbnail":function(){define("dojo/_base/declare dojo/_base/html dojo/_base/array dojo/_base/lang dojo/on dojo/dom ./AppOperMenu dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./CardPageWithSmallThumbnail.html dojox/form/Uploader dojo/NodeList-dom".split(" "),
function(k,e,p,q,n,l,h,f,d,c,a){return k([f,d,c],{baseClass:"card-page-with-small-thumbnail",templateString:a,loading:null,folderUrl:null,appListWidget:null,_eventHandles:null,_appOperMenus:null,postMixInProperties:function(){this.inherited(arguments);this.nls=this.appListWidget.nls;this.loading=this.appListWidget.loading;this.folderUrl=this.appListWidget.folderUrl},constructor:function(){this._eventHandles=[];this._appOperMenus=[]},startup:function(){this.inherited(arguments);e.setSelectable(this.domNode,
!1)},refresh:function(a){this.createAppList(a)},cleanAppList:function(){e.empty(this.appCardPageContent);p.forEach(this._appOperMenus,function(a){a.destroy()});this._appOperMenus=[];p.forEach(this._eventHandles,function(a){a.remove()});this._eventHandles=[]},createAppList:function(a){this.cleanAppList();p.forEach(a,function(a){this.createAppCard(a)},this)},createAppCard:function(a){var b=a.isTemplate?this.nls.preview:this.nls.launch,c=e.create("div",{"class":"app-card-box jimu-float-leading"},this.appCardPageContent),
c=e.create("div",{"class":"card app-info-card"},c),d=e.create("div",{"class":"app-title-part"},c);e.create("div",{"class":"app-type-div "+("HTML"===a.appType?"app-type-2d":"app-type-3d")},d);var d=e.create("table",{"class":"app-title-table"},d),d=e.create("tbody",{"class":"app-title-table-body"},d),d=e.create("tr",{"class":"app-title-table-tr"},d),f=e.create("td",{"class":"app-thumbnail-td"},d);e.create("a",{"class":"app-thumbnail",style:"background-image: url("+a.thumbnail+"?date\x3d"+this.appListWidget.getRefreshImageFlag()+
")",href:a.appUrl,target:"_blank",title:b},f);d=e.create("td",{"class":"app-title-td"},d);e.create("div",{"class":"app-title-div",innerHTML:a.name,title:a.name},d);e.create("div",{"class":"app-time-div",innerHTML:this.appListWidget._getLocaleDateTime(a.lastUpdated)},d);e.create("div",{"class":"app-creator-div",innerHTML:a.creator},d);d=e.create("div",{"class":"app-desc-box"},c);e.create("div",{"class":"app-desc-part "+(a.description?"":"place-holder-class"),innerHTML:a.description?a.description:this.nls.defaultDesc,
title:a.description},d);c=e.create("div",{"class":"app-operation-part"},c);e.create("div",{innerHTML:'\x3ca href\x3d"'+a.appUrl+'" target\x3d"_blank"\x3e\x3c/a\x3e',"class":"app-operation launch-operation jimu-float-leading",title:b},c);a.isTemplate||e.create("div",{innerHTML:'\x3ca href\x3d"'+a.downloadUrl+'" target\x3d"downloadTargetFrame"\x3e\x3c/a\x3e',"class":"app-operation download-operation jimu-float-leading",title:this.nls.download},c);var b=e.create("div",{"class":"app-operation edit-operation jimu-float-leading "+
(a.isPredefined?"disable":""),title:a.isTemplate?this.nls.configTemplate:this.nls.configApp},c),k=e.create("div",{"class":"app-operation more-operation jimu-float-trailing "+(a.isPredefined?"disable":"")},c),v=(new h({app:a,posNode:k,appListWidget:this.appListWidget,nls:this.nls,isTemplate:a.isTemplate,appContentNode:this.appCardPageContent,height:a.isTemplate?a.isPredefined?45:162:122,offset:{top:44,left:-10,right:-10}})).placeAt(k);this._appOperMenus.push(v);d=n(k,"click",q.hitch(this,function(b){v.isShow?
(v.hide(),e.removeClass(k,"item-more-selected")):(p.forEach(this._appOperMenus,function(a){a.isShow&&(a.hide(),e.removeClass(a.posNode,"item-more-selected"))}),v.show(),e.addClass(k,"item-more-selected"));b.itemId=a.id}));this._eventHandles.push(d);d=n(b,"click",q.hitch(this,function(){this.appListWidget.pluginManager.getPluginByName("startup").switchToAppConfig(a)}));this._eventHandles.push(d);a.isTemplate&&(b=e.create("div",{"class":"app-operation create-app-from-item-operation jimu-float-leading",
title:this.nls.createApp},c),d=n(b,"click",q.hitch(this,function(){v._onCreateAppFromTempalteClick()})),this._eventHandles.push(d));d=n(l.byId("content-box"),"click",q.hitch(this,function(b){b.itemId!==a.id&&(e.removeClass(v.posNode,"item-more-selected"),v.hide())}));this._eventHandles.push(d)}})})},"builder/plugins/attribute-config/_build-generate_module":function(){define(["builder/plugins/attribute-config/Plugin","dojo/text!builder/plugins/attribute-config/Plugin.html","dojo/text!builder/plugins/attribute-config/css/style.css",
"dojo/i18n!builder/plugins/attribute-config/nls/strings"],function(){})},"builder/plugins/attribute-config/Plugin":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/_base/Color dojo/topic dojo/on dojo/query dojo/sniff dojo/Deferred dijit/_WidgetsInTemplateMixin dojo/text!./Plugin.html ./AttrbuteLogoChooser dojo/dom-style dojo/dom-construct dojo/_base/array builder/portalUtils builder/BasePlugin jimu/utils jimu/portalUrlUtils jimu/dijit/CheckBox jimu/dijit/ImageChooser jimu/dijit/Message jimu/dijit/LoadingIndicator esri/arcgis/AppProxyManager esri/arcgis/utils ./AppProxyUtil ./MapProxyItem ./UrlProxyItem builder/dijit/LinkEditor jimu/dijit/Popup dijit/Editor ./dataSource/AdditionalDataSources dojo/NodeList-dom dojo/NodeList-data jimu/dijit/ColorPicker dijit/form/Select dijit/_editor/plugins/FontChoice dijit/_editor/plugins/TextColor dijit/ToolbarSeparator jimu/dijit/EditorTextColor jimu/dijit/EditorBackgroundColor".split(" "),
function(k,e,p,q,n,l,h,f,d,c,a,b,g,u,m,r,t,v,y,w,z,x,A,C,B,E,D,F,I,M,L,J){return k([t,c],{templateString:a,appConfig:null,selectLinkNode:null,selectProxyRuleNode:null,initedLinks:!1,initedProxy:!1,_currentPortalUrl:null,showProxySetting:!1,showAlwaysUseProxy:!1,keepAppState:!0,titleNodeClickHandler:null,subtitleNodeClickHandler:null,postMixInProperties:function(){this.inherited(arguments)},postCreate:function(){this.inherited(arguments);this.own(n.subscribe("app/appConfigLoaded",e.hitch(this,this._onAppConfigLoaded)));
this.own(n.subscribe("app/appConfigChanged",e.hitch(this,this._onAppConfigChanged)));this.own(n.subscribe("app/mapLoaded",e.hitch(this,this._setMap)));this.own(n.subscribe("app/mapChanged",e.hitch(this,this._setMap)));this.useProxySetting=new w({label:this.nls.useProxySetting,checked:!1},this.useProxySetting);this.alwaysUseProxy=new w({label:this.nls.alwaysUseProxyLabel,checked:!1},this.alwaysUseProxy);this._is3D()?(g.set(this.appStateController,"display","none"),g.set(this.dataSourceSection,"display",
"none")):(g.set(this.appStateController,"display",""),this.appStateSetting=new w({label:this.nls.keepAppState,checked:!0,onChange:e.hitch(this,this._onAppStateSettingChange)},this.appStateSetting));window.isXT?(g.set(this.loadingPageController,"display",""),this.bgImageCheckBox=new w({label:this.nls.backgroundImage,checked:!0,onChange:e.hitch(this,this._onBackgroundImageStatusChange)},this.bgCheckBoxDiv),this.gifImageCheckBox=new w({label:this.nls.loadingGifImage,checked:!0,onChange:e.hitch(this,
this._onGifImageStatusChange)},this.gifCheckBoxDiv),this._onSelectGifMode()):g.set(this.loadingPageController,"display","none");this.linksEditor=new I({nls:this.nls,linkList:[],btnLabel:this.nls.addLink,canEdit:!0,canDelete:!0,isRest:!1,afterAdd:e.hitch(this,this._publishLinksChange),afterUpdate:e.hitch(this,this._publishLinksChange),afterDelete:e.hitch(this,this._publishLinksChange)});this.linksEditor.placeAt(this.linksSection);this.bgImageChooser=new z({cropImage:!1,label:this.nls.selectFile,format:["image/png",
"image/jpeg"]},this.bgImageChooser);p.addClass(this.bgImageChooser.domNode,"jimu-trailing-margin1 loading-image-chooser");this.bgImageChooser.startup();this.gifImageChooser=new z({cropImage:!1,label:this.nls.selectFile,format:["image/gif"]},this.gifImageChooser);p.addClass(this.gifImageChooser.domNode,"jimu-float-leading jimu-trailing-margin1 loading-image-chooser");this.gifImageChooser.startup();h(".header-section .label",this.domNode).style("display","none");this._bindEvents();window.isRTL?(h(".arrow-forward",
this.domNode).addClass("icon-arrow-left"),h(".arrow-forward",this.domNode).removeClass("icon-arrow-right"),h(".arrow-back",this.domNode).addClass("icon-arrow-forward")):(h(".arrow-forward",this.domNode).addClass("icon-arrow-right"),h(".arrow-forward",this.domNode).removeClass("icon-arrow-left"),h(".arrow-back",this.domNode).addClass("icon-arrow-back"));this.loading=new A({hidden:!0},this.loadingNode);this.loading.startup()},startup:function(){this.inherited(arguments);this._keepOrder()},destroy:function(){this.inherited(arguments);
this.subtitleNodeClickHandler&&(this.subtitleNodeClickHandler.remove(),this.subtitleNodeClickHandler=null);this.titleNodeClickHandler&&(this.titleNodeClickHandler.remove(),this.titleNodeClickHandler=null)},_setMap:function(a){this.map=a;this.additionalDataSources&&this.additionalDataSources.setMap(this.map)},_bindEvents:function(){this.titleChangeHandle=l(this.titleNode,"change",e.hitch(this,this.onTitleChange));this.subtitleChangeHandle=l(this.subtitleNode,"change",e.hitch(this,this.onSubtitleChange));
this.own(this.titleChangeHandle);this.own(this.subtitleChangeHandle);this.own(l(this.useProxySetting,"click",e.hitch(this,this._onUseProxySettingChange)));this.own(l(this.alwaysUseProxy,"click",e.hitch(this,this._onAlwaysUseProxyChange)));this.own(l(this.proxyUrlNode,"change",e.hitch(this,this._onProxyUrlChange)));this.own(l(this.proxyUrlNode,"blur",e.hitch(this,this._onProxyUrlBlur)));this.own(l(this.appIdNode,"change",e.hitch(this,this._onAppIdChange)));this.own(l(this.domNode,"click",e.hitch(this,
function(){h(".header-button",this.domNode).removeClass("highlight-button");this.selectLinkNode&&(p.removeClass(this.selectLinkNode,"selected-item"),this.selectLinkNode=null);this.selectProxyRuleNode&&(p.removeClass(this.selectProxyRuleNode,"selected-item"),this.selectProxyRuleNode=null)})));window.isXT&&(this.own(l(this.loadingPageController,"click",e.hitch(this,this._switchToLoading))),this.own(l(this.backController,"click",e.hitch(this,this._switchToApp))),this.own(l(this.bgColorPicker,"change",
e.hitch(this,this._onBackgroundColorChange))),this.own(l(this.gifSelect,"change",e.hitch(this,this._onGifSelectChange))),this.own(l(this.bgImageChooser,"change",e.hitch(this,this._onBackgroundImageUpload))),this.own(l(this.gifImageChooser,"change",e.hitch(this,this._onLoadingGifUpload))));this.own(l(this.appProxyController,"click",e.hitch(this,this._switchToAppProxy)));this.own(l(this.backController2,"click",e.hitch(this,this._switchToApp)))},_createAppProxySection:function(a){this.appProxyManager.loaded?
(a&&this._checkMapProxy(),this._checkUrlProxy()):this.own(l.once(this.appProxyManager,"load",e.hitch(this,function(){a&&this._checkMapProxy();this._checkUrlProxy()})))},init:function(a,b){this.appConfig=a||{};this.initHeader(a,b);this.initLinks(a);this._is3D()||this.initAppStateSetting(a);this.initedProxy||(this.initProxy(a),this.initedProxy=!0);this._currentPortalUrl!==a.portalUrl&&(this.initAppId(a),this._currentPortalUrl=a.portalUrl);window.isXT&&this.initLoadingPage(a);if(this._is3D()||!this._isOnline()||
window.isXT)g.set(this.appProxyController,"display","none");else{var c=!b||"appProxyChange"===b||"mapChange"===b,d=window.appInfo.id;this.appProxyManager?this._createAppProxySection(c):B.getItem(d).then(e.hitch(this,function(a){var b=document.createElement("a");b.href=a.item.url;a=b.pathname.substring(0,b.pathname.lastIndexOf("/"));a="/"===a.charAt(0)?a:"/"+a;this.appProxyManager=new C({appid:d,referrers:["http://www.arcgis.com"+a,"https://www.arcgis.com"+a]});this._createAppProxySection(c)}));g.set(this.appProxyController,
"display","")}},_isOnline:function(){var a=y.getStandardPortalUrl(window.portalUrl);return y.isOnline(a)},_checkMapProxy:function(){this.appConfig&&this.appConfig.map&&this._refreshMapProxy()},_refreshMapProxy:function(){E.queryForSecureServicesInMap(this.appConfig.map.portalUrl,this.appConfig.map.itemId).then(e.hitch(this,function(a){"appProxy"in this.appConfig.map&&this.appConfig.map.appProxy.mapItemId===this.appConfig.map.itemId?this._createMapProxyTable(a):this._publishAppProxy(a)}))},_createMapProxyTable:function(a){p.empty(this.mapProxyContent);
a&&0!==a.length?(p.setStyle(this.mapSection,"display",""),p.addClass(this.urlSection,"double-margin"),m.forEach(a,e.hitch(this,function(a){a=this._checkMapProxyItem(a);a=new D({appProxyManager:this.appProxyManager,sourceUrl:a.sourceUrl,title:a.title,premium:!0===a.premium,consumeCredits:!0===a.consumeCredits,useProxy:!0===a.useProxy,proxyUrl:a.proxyUrl||"",proxyId:a.proxyId||"",hitsPerInterval:a.hitsPerInterval,intervalSeconds:a.intervalSeconds,nls:this.nls});this.own(l(a,D.PROCESS_START,e.hitch(this,
function(){this.loading.show()})));this.own(l(a,D.PROCESS_END,e.hitch(this,function(){this.loading.hide()})));this.own(l(a,D.PROXY_CREATED,e.hitch(this,function(a){this._publishAppProxy([a])})));this.own(l(a,D.PROXY_DELETED,e.hitch(this,function(a){this._publishAppProxy([a])})));this.own(l(a,D.PROCESS_ERROR,e.hitch(this,function(a){new x({message:a})})));p.place(a.domNode,this.mapProxyContent)}))):(p.setStyle(this.mapSection,"display","none"),p.removeClass(this.urlSection,"double-margin"))},_checkMapProxyItem:function(a){var b=
!1,c=e.clone(a);this.appConfig.map&&this.appConfig.map.appProxy&&m.some(this.appConfig.map.appProxy.proxyItems,function(b){if(b.sourceUrl===a.sourceUrl)return c.useProxy=b.useProxy,c.proxyUrl=b.proxyUrl||"",c.proxyId=b.proxyId||"",c.hitsPerInterval=b.hitsPerInterval,c.intervalSeconds=b.intervalSeconds,!0});c.useProxy&&(b=this._proxyExists(c),b||(c.useProxy=!1,c.proxyUrl="",c.proxyId="",this._publishAppProxy([{sourceUrl:c.sourceUrl,useProxy:!1}])));return c},_proxyExists:function(a){if(this.appProxyManager){var b=
this.appProxyManager.get("proxies");if(E.findProxy(b,a))return!0}return!1},_checkUrlProxy:function(){this.proxyLinkEditor||(this.proxyLinkEditor=new I({nls:this.nls,linkList:[],btnLabel:this.nls.addUrlProxy,canEdit:!1,canDelete:!0,isRest:!0,isProxy:!0,beforeAdd:e.hitch(this,this._createUrlAppProxy),afterDelete:e.hitch(this,this._deleteUrlAppProxy)}),this.proxyLinkEditor.placeAt(this.linkEditorNode));if(this.appConfig&&this.appConfig.appProxies){var a=[];m.forEach(this.appConfig.appProxies,function(b){this._proxyExists(b)?
a.push({label:b.title,url:b.sourceUrl,hitsPerInterval:b.hitsPerInterval,intervalSeconds:b.intervalSeconds}):this._deleteUrlProxy(b.sourceUrl)},this);this.proxyLinkEditor.setItems(a)}},_createUrlAppProxy:function(a){a=new F({appProxyManager:this.appProxyManager,sourceUrl:a.url,title:a.label,hitsPerInterval:a.hitsPerInterval,intervalSeconds:a.intervalSeconds,nls:this.nls});var b=new d;this.own(l(a,F.PROCESS_START,e.hitch(this,function(){this.loading.show()})));this.own(l(a,F.PROCESS_END,e.hitch(this,
function(){this.loading.hide()})));this.own(l(a,F.PROXY_CREATED,e.hitch(this,function(a){this._addUrlProxy(a);b.resolve(a)})));this.own(l(a,F.PROCESS_ERROR,e.hitch(this,function(a){b.resolve(null);new x({message:a})})));a.createProxy();return b},_deleteUrlAppProxy:function(a){var b={appProxyManager:this.appProxyManager,sourceUrl:a.url,title:a.label,nls:this.nls};m.some(this.appConfig.appProxies,function(c){if(c.sourceUrl===a.url)return e.mixin(b,{proxyId:c.proxyId,proxyUrl:c.proxyUrl,useProxy:c.useProxy}),
!0});(new F(b)).deleteProxy();this._deleteUrlProxy(b)},_publishAppProxy:function(a){n.publish("appProxyForMapChanged",{mapItemId:this.appConfig.map.itemId,proxyItems:a})},_addUrlProxy:function(a){var b=[];this.appConfig.appProxies&&0<this.appConfig.appProxies.length&&(b=e.clone(this.appConfig.appProxies));b.push(a);setTimeout(function(){n.publish("appProxyForUrlChanged",b)},100)},_deleteUrlProxy:function(a){var b=m.filter(this.appConfig.appProxies,function(b){return b.proxyId!==a.proxyId});setTimeout(function(){n.publish("appProxyForUrlChanged",
b)},100)},_onAppConfigLoaded:function(a){this._setAppConfig(a)},_onAppConfigChanged:function(a,b){this._setAppConfig(a,b)},_setAppConfig:function(a,b){this.init(a,b)},_publishLinksChange:function(){n.publish("appAttributeChanged",{links:this.getLinks()})},initHeader:function(a,c){var d=e.getObject("theme.sharedTheme",!1,a);this.logoChooser||(this.logoChooser=new b({nls:this.nls,isPortalSupport:d.isPortalSupport}),this.logoChooser.placeAt(this.logoNodeDiv),this.logoChooser.startup(),this.own(l(this.logoChooser,
"sharedThemeChanged",e.hitch(this,function(a){a=e.mixin(this.appConfig.theme.sharedTheme,a);n.publish("sharedThemeChanged",a)}))),this.own(l(this.logoChooser,"appAttributeChanged",e.hitch(this,function(a){n.publish("appAttributeChanged",a)}))));if("undefined"===typeof c||"attributeChange"===c||"sharedThemeChange"===c)this.logoChooser.setLogo(a.logo||""),this.logoChooser.setLink(a.logoLink||"");"undefined"!==typeof c&&"sharedThemeChange"!==c||this.logoChooser.setSharedThemeConfig(d);c="";a.title&&
(c=v.stripHTML(a.title),h(this.titleNode).data("config",a.title),/<([a-z]+)\s*.*>/ig.test(a.title)&&(this.titleNode.disabled=!0,this.titleNode.title=c,this.titleNodeClickHandler||(this.titleNodeClickHandler=l(this.titleNodeDiv,"click",e.hitch(this,this.onTitleEditorClick)))),p.setAttr(this.titleNode,"value",c));a.subtitle&&(c=v.stripHTML(a.subtitle),h(this.subtitleNode).data("config",a.subtitle),/<([a-z]+)\s*.*>/ig.test(a.subtitle)&&(this.subtitleNode.disabled=!0,this.subtitleNode.title=c,this.subtitleNodeClickHandler||
(this.subtitleNodeClickHandler=l(this.subtitleNodeDiv,"click",e.hitch(this,this.onSubtitleEditorClick)))),p.setAttr(this.subtitleNode,"value",c))},onTitleChange:function(a){n.publish("appAttributeChanged",{title:a.target.disabled?h(a.target).data("config")[0]:a.target.value})},onSubtitleChange:function(a){n.publish("appAttributeChanged",{subtitle:a.target.disabled?h(a.target).data("config")[0]:a.target.value})},onTitleEditorClick:function(a){a.stopPropagation();this._editText(this.titleNode)},onSubtitleEditorClick:function(a){a.stopPropagation();
this._editText(this.subtitleNode)},_editText:function(a){this.editor=new L({plugins:["bold","italic","underline",v.getEditorTextColor("attributeConfig",!0)],extraPlugins:["|",{name:"dijit._editor.plugins.FontChoice",command:"fontName",custom:"Arial;Comic Sans MS;Courier New;Garamond;Tahoma;Times New Roman;Verdana".split(";")},"fontSize"],style:"font-family:Verdana;"});var b=p.position(a),c=new M({titleLabel:this.nls.formatStyle,width:window.isRTL?695:680,height:250,content:this.editor.domNode,buttons:[{label:window.jimuNls.common.reset,
title:this.nls.restoreStyle,onClick:e.hitch(this,function(){var a=this.editor.get("value"),a=v.stripHTML(a);this.editor.set("value",a)})},{label:window.jimuNls.common.ok,onClick:e.hitch(this,function(){var b=this.editor.get("value");/"attribute-custom-style"/g.test(b)||(b='\x3cdiv class\x3d"attribute-custom-style"\x3e'+b+"\x3c/div\x3e");h(a).data("config",b);var d=v.stripHTML(b);/<([a-z]+)\s*.*>/ig.test(b)?(a.disabled=!0,a.title=d,a!==this.titleNode||this.titleNodeClickHandler)?a!==this.subtitleNode||
this.subtitleNodeClickHandler||(this.subtitleNodeClickHandler=l(this.subtitleNodeDiv,"click",e.hitch(this,this.onSubtitleEditorClick))):this.titleNodeClickHandler=l(this.titleNodeDiv,"click",e.hitch(this,this.onTitleEditorClick)):""===d&&(a.disabled=!1,a.title="",a===this.titleNode&&this.titleNodeClickHandler?(this.titleNodeClickHandler.remove(),this.titleNodeClickHandler=null):a===this.subtitleNode&&this.subtitleNodeClickHandler&&(this.subtitleNodeClickHandler.remove(),this.subtitleNodeClickHandler=
null));a.value=d;if(a===this.titleNode)this.onTitleChange({target:a});else if(a===this.subtitleNode)this.onSubtitleChange({target:a});this.editor.destroy();this.editor=null;c.close()})},{label:window.jimuNls.common.cancel,classNames:["jimu-btn-vacation"],onClick:e.hitch(this,function(){this.editor.destroy();this.editor=null;c.close()})}],onClose:e.hitch(this,function(){this.editor&&this.editor.destroy();return!0})});window.isRTL?p.setStyle(c.domNode,{top:b.y+b.h+5+"px",left:b.x+b.w-(window.isRTL?
695:680)+"px"}):p.setStyle(c.domNode,{top:b.y+b.h+5+"px",left:b.x+"px"});p.addClass(c.domNode,"format-font-style");p.setStyle(this.editor.domNode,{width:"100%",height:"100%"});this.editor.startup();8!==f("ie")&&this.editor.resize({w:"100%",h:"100%"});this.editor.set("value",h(a).data("config")[0])},initLinks:function(a){a.links&&this.linksEditor.setItems(a.links)},initProxy:function(a){if(a=a.httpProxy)this.useProxySetting.setValue(a.useProxy),this.showProxySetting=!!a.useProxy,this._onUseProxySettingChange(),
this.alwaysUseProxy.setValue(a.alwaysUseProxy),this.showAlwaysUseProxy=!!a.alwaysUseProxy,this._onAlwaysUseProxyChange(),a.url&&p.setAttr(this.proxyUrlNode,"value",a.url),a.rules&&(p.empty(this.proxyRulesListNode),m.forEach(a.rules,e.hitch(this,function(a){this.createProxyRuleNode(a)})))},initAppStateSetting:function(a){this.appStateSetting.setValue(!!a.keepAppState)},initAppId:function(a){r.getPortal(a.portalUrl).loadSelfInfo().then(e.hitch(this,function(b){b.supportsOAuth?(p.setStyle(this.appIdSection,
"display","none"),p.setAttr(this.appIdNode,"value",a.appId)):p.setStyle(this.appIdSection,"display","none")}),e.hitch(this,function(a){this.shelter.hide();console.error(a)}))},getLinks:function(){var a=[];m.forEach(this.linksEditor.getItems(),function(b){a.push({label:b.label,url:b.url})});return a},getProxy:function(){var a=[],b=p.getAttr(this.proxyUrlNode,"value");h(".proxy-rule-list .list-item",this.domNode).forEach(e.hitch(this,function(b){var c=h(".first input",b).attr("value")[0];b=h(".second input",
b).attr("value")[0];c&&a.push({urlPrefix:c,proxyUrl:b})}));return{useProxy:this.useProxySetting.getValue(),alwaysUseProxy:this.alwaysUseProxy.getValue(),url:b,rules:a}},_bindNodeEvents:function(a,b,c,d,f,g){this.own(l(a,"click",e.hitch(this,function(b){h(".header-button",this.domNode).addClass("highlight-button");"links"===g?(this.selectLinkNode&&p.removeClass(this.selectLinkNode,"selected-item"),p.addClass(a,"selected-item"),this.selectLinkNode=a):"proxyRules"===g&&(this.selectProxyRuleNode&&p.removeClass(this.selectProxyRuleNode,
"selected-item"),p.addClass(a,"selected-item"),this.selectProxyRuleNode=a);b.stopPropagation()})));this.own(l(b,"dblclick",e.hitch(this,function(){p.setStyle(b,"display","none");p.setStyle(c,"display","block");c.focus();c.select()})));this.own(l(d,"dblclick",e.hitch(this,function(){p.setStyle(d,"display","none");p.setStyle(f,"display","block");f.focus();f.select()})));this.own(l(f,"focus",function(a){a.target.value||(a.target.value="http://")}));this.own(l(c,"blur",e.hitch(this,function(a){p.setAttr(b,
{innerHTML:a.target.value||b.innerHTML,style:{display:"block"}});p.setStyle(c,"display","none");"links"===g?n.publish("appAttributeChanged",{links:this.getLinks()}):"proxyRules"===g&&this._publishProxy()})));this.own(l(f,"blur",e.hitch(this,function(a){p.setAttr(d,{innerHTML:a.target.value||d.innerHTML,style:{display:"block"}});p.setStyle(f,"display","none");"links"===g?(a=this._formatLinkValue(a.target.value),p.setAttr(d,"innerHTML",a),p.setAttr(f,"value",a),n.publish("appAttributeChanged",{links:this.getLinks()})):
"proxyRules"===g&&this._publishProxy()})))},_formatLinkValue:function(a){var b="";return b=/^http(s?):\/\//.test(a)?a:/^\/\//.test(a)?"http:"+a:"http://"+a},_createListItem:function(a,b,c,d,f){var g=p.create("div",{"class":"list-item"}),e=p.create("div",{"class":"first jimu-float-leading"},g);c=p.create("div",{"class":"mask",innerHTML:b||c,title:c},e);var e=p.create("input",{style:{display:"none"}},e),h=p.create("div",{"class":"second jimu-float-leading"},g);f=p.create("div",{"class":"mask",innerHTML:d||
f,title:f},h);h=p.create("input",{style:{display:"none"}},h);p.setAttr(e,"value",b);p.setAttr(h,"value",d);this._bindNodeEvents(g,c,e,f,h,a);b||this.focusNewItem(g,c,e,a);return g},focusNewItem:function(a,b,c,d){"links"===d?(this.selectLinkNode&&p.removeClass(this.selectLinkNode,"selected-item"),p.addClass(a,"selected-item"),this.selectLinkNode=a):"proxyRules"===d&&(this.selectProxyRuleNode&&p.removeClass(this.selectProxyRuleNode,"selected-item"),p.addClass(a,"selected-item"),this.selectProxyRuleNode=
a);p.setStyle(b,"display","none");p.setStyle(c,"display","block");c.value=b.innerHTML;setTimeout(function(){c.focus();c.select()},0)},createProxyRuleNode:function(a){a=this._createListItem("proxyRules",a.urlPrefix,this.nls.prefixPlaceholder,a.proxyUrl,this.nls.proxyUrlPlaceholder);p.place(a,this.proxyRulesListNode)},_keepOrder:function(){var a=p.getMarginBox(this.headerSection),b=p.getMarginBox(this.linksSection),c=p.getMarginBox(this.appIdSection),d=p.getMarginBox(this.useProxySection),a=a.h+b.h+
c.h+d.h,b=p.getMarginBox(this.domNode).h;a>b&&p.setStyle(this.domNode,"paddingRight","10px")},_onEditItemClick:function(a){var b=h(".first .mask",a)[0];a=h(".first input",a)[0];p.setStyle(b,"display","none");p.setStyle(a,"display","block");a.focus();a.select()},onAddProxyRuleClick:function(a){this.createProxyRuleNode({urlPrefix:"",proxyUrl:""});this._keepOrder();a.stopPropagation()},onEditProxyRuleClick:function(){this.selectProxyRuleNode&&this._onEditItemClick(this.selectProxyRuleNode)},onDeleteProxyRuleClick:function(){this.selectProxyRuleNode&&
(p.destroy(this.selectProxyRuleNode),n.publish("appAttributeChanged",{httpProxy:this.getProxy()}))},_onUseProxySettingChange:function(){this.useProxySetting.checked?p.setStyle(this.proxySection,"display","block"):p.setStyle(this.proxySection,"display","none");this.showProxySetting!==this.useProxySetting.checked&&(this._publishProxy(),this.showProxySetting=this.useProxySetting.checked)},_onAlwaysUseProxyChange:function(){this.showAlwaysUseProxy!==this.alwaysUseProxy.checked&&(this._publishProxy(),
this.showAlwaysUseProxy=this.alwaysUseProxy.checked)},_onProxyUrlChange:function(){this._publishProxy()},_onProxyUrlBlur:function(){this.proxyUrlNode.value?p.removeClass(this.proxyUrlNode,"error-status"):p.addClass(this.proxyUrlNode,"error-status")},_onAppIdChange:function(){n.publish("appAttributeChanged",{appId:this.appIdNode.value})},_onAppStateSettingChange:function(){this.keepAppState!==this.appStateSetting.checked&&(this.keepAppState=this.appStateSetting.checked,n.publish("appAttributeChanged",
{keepAppState:this.keepAppState}))},_publishProxy:function(){n.publish("appAttributeChanged",{httpProxy:this.getProxy()})},initLoadingPage:function(a){this.showLoadingGif=this.showBackgroundImage=!0;"object"===typeof a.loadingPage&&(a=a.loadingPage,/^#([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/.test(a.backgroundColor)&&this.bgColorPicker.setColor(new q(a.backgroundColor)),this._initBackgroundImage(a),this._initLoadingGif(a))},_switchToLoading:function(){g.set(this.attributeSection,"display","none");g.set(this.loadingPageSection,
"display","");n.publish("actionTriggered",{action:"showLoading"})},_switchToAppProxy:function(){g.set(this.attributeSection,"display","none");g.set(this.appProxySection,"display","")},_switchToApp:function(){g.set(this.attributeSection,"display","");g.set(this.loadingPageSection,"display","none");g.set(this.appProxySection,"display","none");n.publish("actionTriggered",{action:"showApp"})},_initBackgroundImage:function(a){a.backgroundImage?a.backgroundImage.visible?(this.showBackgroundImage=!0,this.bgImageCheckBox.check(),
g.set(this.bgUploaderDiv,"display","")):(this.showBackgroundImage=!1,this.bgImageCheckBox.uncheck(),g.set(this.bgUploaderDiv,"display","none")):(this.showBackgroundImage=!1,this.bgImageCheckBox.uncheck(),g.set(this.bgUploaderDiv,"display","none"))},_initLoadingGif:function(a){var b=0;a.loadingGif?(a.loadingGif.visible?(this.showLoadingGif=!0,this.gifImageCheckBox.check(),g.set(this.gifModeSection,"display","")):(this.showLoadingGif=!1,this.gifImageCheckBox.uncheck(),g.set(this.gifModeSection,"display",
"none")),/^data:image\/.*;base64,/.test(a.loadingGif.uri)||/loading\.gif$/.test(a.loadingGif.uri)?(this.uploadMode.checked=!0,this._onUploadGifMode()):(this.selectMode.checked=!0,this._onSelectGifMode(),a=a.loadingGif.uri.match(/images\/(.*)/)[1],b=a.match(/\d+/),this.gifSelect.set("value",b[0]))):(this.showLoadingGif=!1,this.gifImageCheckBox.uncheck(),g.set(this.gifModeSection,"display","none"))},_getLoadingGifSetting:function(){var a={};this.appConfig&&this.appConfig.loadingPage&&this.appConfig.loadingPage.loadingGif&&
(a=this.appConfig.loadingPage.loadingGif);return a},_getLoadingBackgroundColor:function(){return this.appConfig&&this.appConfig.loadingPage&&this.appConfig.loadingPage.backgroundColor?this.appConfig.loadingPage.backgroundColor:""},_onBackgroundColorChange:function(a){u.empty(this.bgColorPicker.domNode);u.create("span",{innerHTML:a.toHex(),style:{color:v.invertColor(a.toHex())}},this.bgColorPicker.domNode);a.toHex()!==this._getLoadingBackgroundColor()&&n.publish("loadingPageChanged",{backgroundColor:this.bgColorPicker.getColor().toHex()})},
_onBackgroundImageStatusChange:function(a){a!==this.showBackgroundImage&&(this.showBackgroundImage=a,n.publish("loadingPageChanged",{backgroundImage:{visible:this.showBackgroundImage}}))},_onBackgroundImageUpload:function(a){var b=new Image;b.src=a;this.own(l(b,"load",e.hitch(this,function(){n.publish("loadingPageChanged",{backgroundImage:{uri:a,width:b.width,height:b.height}})})))},_onSelectGifMode:function(){g.set(this.predefinedGif,"display","");g.set(this.customGif,"display","none")},_onUploadGifMode:function(){g.set(this.predefinedGif,
"display","none");g.set(this.customGif,"display","")},_onGifImageStatusChange:function(a){a!==this.showLoadingGif&&(this.showLoadingGif=a,n.publish("loadingPageChanged",{loadingGif:{visible:this.showLoadingGif}}))},_onGifSelectChange:function(a){if("0"!==a){var b=this._getLoadingGifSetting(),c=null;b.uri&&/images\/.*/.test(b.uri)&&(b=b.uri.match(/images\/(.*)/)[1],c=b.match(/\d+/));if(null===c||a!==c[0])b=[{width:58,height:58},{width:58,height:10},{width:32,height:32},{width:34,height:34}][a-1],n.publish("loadingPageChanged",
{loadingGif:{uri:window.appInfo.appPath+"configs/loading/images/predefined_loading_"+a+".gif",width:b?b.width:0,height:b?b.height:0}})}},_onLoadingGifUpload:function(a){var b=new Image;b.src=a;this.own(l(b,"load",e.hitch(this,function(){n.publish("loadingPageChanged",{loadingGif:{uri:a,width:b.width,height:b.height}});this.gifSelect.set("value",0)})))},_is3D:function(){return"HTML3D"===window.appInfo.appType},_openDataSourcesPage:function(){g.set(this.attributeSection,{display:"none"});g.set(h(".datasources-section")[0],
{display:"block"});this.additionalDataSources=new J({nls:this.nls,map:this.map,appConfig:this.appConfig});this.additionalDataSources.placeAt(this.additionalDataSourcesDiv)},_closeDataSourcesPage:function(){this.additionalDataSources.destroy();this.additionalDataSources=null;g.set(this.attributeSection,{display:"block"});g.set(h(".datasources-section")[0],{display:"none"})}})})},"builder/plugins/attribute-config/AttrbuteLogoChooser":function(){define("dojo/Evented dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/_base/lang dojo/_base/html dojo/on dojo/text!./AttrbuteLogoChooser.html jimu/dijit/Popup builder/dijit/SharedThemeChooserPopup ./CustomLogoPage dojo/sniff jimu/dijit/ImageChooser".split(" "),
function(k,e,p,q,n,l,h,f,d,c,a,b,g){return e([p,q,n,k],{baseClass:"logo-container no-logo",declaredClass:"jimu.dijit.AttrbuteLogoChooser",templateString:d,isPortalSupport:!1,_wabDefaultLogo:!0,postCreate:function(){this.inherited(arguments);h.setAttr(this.removeLogoNode,"title",this.nls.removeLogo)},startup:function(){this._createTooltipDialog();this.own(f(this.imageChooser,"imageChange",l.hitch(this,"_onLogoChoosed")));this.own(f(this.maskerNode,"mouseenter",l.hitch(this,function(){this.popup.showPopup()})));
this.own(f(this.maskerNode,"mouseleave",l.hitch(this,function(){this.popup.hidePopup()})))},setLogo:function(a){this._wabDefaultLogo="images/app-logo.png"===a?!0:!1;a?(!a||a.startWith("/")||a.startWith("http")||a.startWith("data")||(a=window.appInfo.appPath+a),this.imageChooser.setDefaultSelfSrc(a),h.addClass(this.logoContainer,"logo"),h.removeClass(this.logoContainer,"no-logo"),h.addClass(this.addLogoNode,"hide"),this._resetLogoBox(50)):(this.imageChooser.setDefaultSelfSrc(a),h.addClass(this.logoContainer,
"no-logo"))},setLink:function(a){this.link=a},setSharedThemeConfig:function(a){a&&"undefined"!==typeof a.useLogo&&(this._useLogo=a.useLogo,this.popup.setIsPortalSupport(a.isPortalSupport),this._isNoChooseState()||(!0===a.useLogo?this.showSharedThemeLogo(!1):this.setCustomLogo(!1)))},_isNoChooseState:function(){return!1===this._useLogo&&!0===this._wabDefaultLogo?!0:!1},onRemoveLogoHandler:function(a){a.stopPropagation();a.preventDefault();this.imageChooser.imageData&&(this.imageChooser.setDefaultSelfSrc(""),
h.removeClass(this.logoContainer,"logo"),h.removeClass(this.addLogoNode,"hide"),h.addClass(this.logoContainer,"no-logo"),this.setCustomLogo(),this.emit("appAttributeChanged",{logo:""}))},onChangeLogoHandler:function(a){a.stopPropagation();a.preventDefault();this.popup.showTooltipDialog()},setDiskLogo:function(){var a=this.imageChooser.mask;if(g("safari")){var b=document.createEvent("MouseEvents");b.initEvent("click",!0,!0);a.dispatchEvent(b)}else a.click();this.popup.hideTooltipDialog()},_onLogoChoosed:function(a){this._changeLogo();
this.emit("appAttributeChanged",{logo:a});this.setCustomLogo()},_onLinkChange:function(a){this.emit("appAttributeChanged",{logoLink:a});this.setCustomLogo()},showSharedThemeLogo:function(a){this.popup.setChecked(this.popup.ACTION.SHARED);this.emitSharedThemeChangedEvent(!0,a)},showCustomLogo:function(){this.popup.setChecked(this.popup.ACTION.CUSTOM)},setCustomLogo:function(a){this.emitSharedThemeChangedEvent(!1,a)},emitSharedThemeChangedEvent:function(a,b){!1!==b&&this.emit("sharedThemeChanged",{useLogo:a});
this.popup.hideTooltipDialog()},_changeLogo:function(){h.setStyle(this.imageChooser.selfImg,{width:"auto",height:"auto",marginLeft:"auto",marginRight:"auto",marginTop:"auto",marginBottom:"auto"});h.removeClass(this.logoContainer,"no-logo");h.addClass(this.logoContainer,"logo");h.addClass(this.addLogoNode,"hide");h.removeClass(this.imageChooser.domNode,"hide");setTimeout(l.hitch(this,this._resetLogoBox,4),4)},_resetLogoBox:function(a){if(this.domNode&&this.imageChooser){var b=h.getContentBox(this.imageChooser.selfImg);
0<b.w?(a=h.getContentBox(this.imageChooser.domNode),b=b.w/b.h,1>=b?(h.setStyle(this.imageChooser.selfImg,"height",a.h+"px"),b=(a.w-a.h*b)/2,h.setStyle(this.imageChooser.selfImg,{marginLeft:b+"px",marginRight:b+"px"})):(h.setStyle(this.imageChooser.selfImg,"width",a.w+"px"),b=(a.h-a.w/b)/2,h.setStyle(this.imageChooser.selfImg,{marginTop:b+"px",marginBottom:b+"px"}))):setTimeout(l.hitch(this,this._resetLogoBox,a),a)}},onMouseEnterHandler:function(){10>g("ie")&&(this._hasEntered?h.setStyle(this.removeLogoNode,
{display:"block"}):setTimeout(l.hitch(this,function(){var a=h.position(this.logoContainer);h.place(this.removeLogoNode,this.ownerDocumentBody);h.addClass(this.removeLogoNode,"attribute-config-plugin-logo-options");h.setStyle(this.removeLogoNode,{position:"absolute",display:"block",left:(window.isRTL?a.x+5:a.x+a.w-35)+"px",top:a.y+5+"px"});this._hasEntered=!0})))},onMouseLeaveHandler:function(){10>g("ie")&&(h.setStyle(this.removeLogoNode,{display:"none"}),this._hasEntered=!1)},destroy:function(){this.popup.destroy();
this.inherited(arguments)},_createTooltipDialog:function(){this.popup=new a({isPortalSupport:this.isPortalSupport,placeAt:this.getParent(),around:this.domNode});this.own(f(this.popup,"btnClick",l.hitch(this,function(a){a===this.popup.ACTION.SHARED?this.showSharedThemeLogo():a===this.popup.ACTION.CUSTOM&&this.showCustomPopup()})));this.own(f(this.popup,"showPopup",l.hitch(this,function(){this._isNoChooseState()||this.popup.setChecked(this._useLogo?this.popup.ACTION.SHARED:this.popup.ACTION.CUSTOM)})))},
showCustomPopup:function(){this.popup.hideTooltipDialog();this.customLogoPage=new b({nls:this.nls,link:this.link,imageChooser:this.imageChooser});this.customPopup=new c({content:this.customLogoPage,titleLabel:this.nls.setLogo,width:669,autoHeight:!0,buttons:[{label:this.nls.ok,onClick:l.hitch(this,function(){if(this.customLogoPage.isValid()){var a=this.customLogoPage.getLink();this.setLink(a);this._onLinkChange(a);this.customPopup.close()}})},{label:this.nls.cancel,onClick:l.hitch(this,function(){this.customPopup.close()})}]})}})})},
"builder/dijit/SharedThemeChooserPopup":function(){define("dojo/Evented dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/_base/lang dojo/_base/html dojo/on dijit/TooltipDialog dojo/text!./templates/SharedThemeChooserPopup.html dijit/popup".split(" "),function(k,e,p,q,n,l,h,f,d,c,a){return e([p,q,n,k],{declaredClass:"shared-theme-chooser-popup",templateString:c,isPortalSupport:!1,_DISAPPEAR_TIMER:null,_isTooltipDialogOpened:!1,placeAt:null,ACTION:null,postMixInProperties:function(){this.inherited(arguments);
this.nls=l.mixin(this.nls,builderNls);this.ACTION={SHARED:"shared",CUSTOM:"custom"}},postCreate:function(){this.inherited(arguments);this.setIsPortalSupport(this.isPortalSupport);this._createTooltipDialog();this.own(f(this.sharedItem,"click",l.hitch(this,function(a){a.stopPropagation();a.preventDefault();!0===this.isPortalSupport&&this.sharedClickHanlder(a)})));this.own(f(this.customItem,"click",l.hitch(this,function(a){this.customClickHanlder(a)})));this.own(f(document,"click",l.hitch(this,function(a){this.isPartOfPopup(a.srcElement||
a.target)||this._hideTooltipDialog()})));this._hideTooltipDialog()},destroy:function(){a.close(this.tooltipDialog);this.tooltipDialog.destroy();this.inherited(arguments)},isPartOfPopup:function(b){var c=this.tooltipDialog.domNode,c=b===c||h.isDescendant(b,c),d=!1,f=a.getTopPopup();f&&f.wrapper&&(d=f.wrapper,d=b===d||h.isDescendant(b,d));return c||d},hideTooltipDialog:function(){this._hideTooltipDialog()},showTooltipDialog:function(){this._showTooltipDialog()},getTooltipDialog:function(){return this.tooltipDialog&&
this.tooltipDialog.domNode?this.tooltipDialog:null},_showTooltipDialog:function(){!0!==this._isTooltipDialogOpened&&(a.open({parent:this.placeAt||this.getParent(),popup:this.tooltipDialog,around:this.around}),this._isTooltipDialogOpened=!0,this.emit("showPopup"))},_hideTooltipDialog:function(){a.close(this.tooltipDialog);this._isTooltipDialogOpened=!1},_createTooltipDialog:function(){this.tooltipDialog=new d({content:this.domNode});h.addClass(this.tooltipDialog.domNode,"shared-theme-chooser-popup-container");
var a=this.getTooltipDialog();this.own(f(a.domNode,"mouseover",l.hitch(this,function(a){this.showPopup(a)})));this.own(f(a.domNode,"mouseleave",l.hitch(this,function(a){this.hidePopup(a)})))},setIsPortalSupport:function(a){this.isPortalSupport=a;!0!==this.isPortalSupport?h.addClass(this.sharedItem,"no-support"):h.removeClass(this.sharedItem,"no-support")},sharedClickHanlder:function(a){this.emit("btnClick",this.ACTION.SHARED,a)},customClickHanlder:function(a){this.emit("btnClick",this.ACTION.CUSTOM,
a)},setChecked:function(a){h.removeClass(this.sharedCheck,"check");h.removeClass(this.customCheck,"check");a===this.ACTION.SHARED&&h.addClass(this.sharedCheck,"check");a===this.ACTION.CUSTOM&&h.addClass(this.customCheck,"check")},showPopup:function(a){a&&(a.stopPropagation(),a.preventDefault());this._clearDisappearTimer();!1===this._isTooltipDialogOpened&&(this.showTooltipDialog(),this._isTooltipDialogOpened=!0)},hidePopup:function(a){a&&(a.stopPropagation(),a.preventDefault());this.hideTooltipDialog();
this._isTooltipDialogOpened=!1},_clearDisappearTimer:function(){this._miniModeTimer&&clearTimeout(this._miniModeTimer)}})})},"dijit/TooltipDialog":function(){define("dojo/_base/declare dojo/dom-class dojo/has dojo/keys dojo/_base/lang dojo/on ./focus ./layout/ContentPane ./_DialogMixin ./form/_FormMixin ./_TemplatedMixin dojo/text!./templates/TooltipDialog.html ./main".split(" "),function(k,e,p,q,n,l,h,f,d,c,a,b,g){k=k("dijit.TooltipDialog",[f,a,c,d],{title:"",doLayout:!1,autofocus:!0,baseClass:"dijitTooltipDialog",
_firstFocusItem:null,_lastFocusItem:null,templateString:b,_setTitleAttr:"containerNode",postCreate:function(){this.inherited(arguments);this.own(l(this.domNode,"keydown",n.hitch(this,"_onKey")))},orient:function(a,b,c){a={"MR-ML":"dijitTooltipRight","ML-MR":"dijitTooltipLeft","TM-BM":"dijitTooltipAbove","BM-TM":"dijitTooltipBelow","BL-TL":"dijitTooltipBelow dijitTooltipABLeft","TL-BL":"dijitTooltipAbove dijitTooltipABLeft","BR-TR":"dijitTooltipBelow dijitTooltipABRight","TR-BR":"dijitTooltipAbove dijitTooltipABRight",
"BR-BL":"dijitTooltipRight","BL-BR":"dijitTooltipLeft","BR-TL":"dijitTooltipBelow dijitTooltipABLeft","BL-TR":"dijitTooltipBelow dijitTooltipABRight","TL-BR":"dijitTooltipAbove dijitTooltipABRight","TR-BL":"dijitTooltipAbove dijitTooltipABLeft"}[b+"-"+c];e.replace(this.domNode,a,this._currentOrientClass||"");this._currentOrientClass=a},focus:function(){this._getFocusItems();h.focus(this._firstFocusItem)},onOpen:function(a){this.orient(this.domNode,a.aroundCorner,a.corner);var b=a.aroundNodePos;"M"==
a.corner.charAt(0)&&"M"==a.aroundCorner.charAt(0)?(this.connectorNode.style.top=b.y+(b.h-this.connectorNode.offsetHeight>>1)-a.y+"px",this.connectorNode.style.left=""):"M"==a.corner.charAt(1)&&"M"==a.aroundCorner.charAt(1)&&(this.connectorNode.style.left=b.x+(b.w-this.connectorNode.offsetWidth>>1)-a.x+"px");this._onShow()},onClose:function(){this.onHide()},_onKey:function(a){if(a.keyCode==q.ESCAPE)this.defer("onCancel"),a.stopPropagation(),a.preventDefault();else if(a.keyCode==q.TAB){var b=a.target;
this._getFocusItems();this._firstFocusItem==this._lastFocusItem?(a.stopPropagation(),a.preventDefault()):b==this._firstFocusItem&&a.shiftKey?(h.focus(this._lastFocusItem),a.stopPropagation(),a.preventDefault()):b!=this._lastFocusItem||a.shiftKey?a.stopPropagation():(h.focus(this._firstFocusItem),a.stopPropagation(),a.preventDefault())}}});p("dojo-bidi")&&k.extend({_setTitleAttr:function(a){this.containerNode.title=this.textDir&&this.enforceTextDirWithUcc?this.enforceTextDirWithUcc(null,a):a;this._set("title",
a)},_setTextDirAttr:function(a){this._created&&this.textDir==a||(this._set("textDir",a),this.textDir&&this.title&&(this.containerNode.title=this.enforceTextDirWithUcc(null,this.title)))}});return k})},"builder/plugins/attribute-config/CustomLogoPage":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/on dojo/sniff builder/BasePlugin dijit/_WidgetsInTemplateMixin dojo/text!./CustomLogoPage.html".split(" "),function(k,e,p,q,n,l,h,f){return k([l,h],{templateString:f,baseClass:"custom-logo-page",
nls:null,imageChooser:null,postMixInProperties:function(){this.inherited(arguments);this.nls=e.mixin(this.nls,window.jimuNls);this.nls=e.mixin(this.nls,builderNls)},postCreate:function(){this.inherited(arguments);this.noImage.innerHTML=this.nls.symbolChooser.noFileChoosen;var d=this.imageChooser.getImageData();this.setImage(d);this.link&&this.setLink(this.link);this.own(q(this.chooseImageBtn,"click",e.hitch(this,this.chooseImage)));this.own(q(this.imageChooser,"imageChange",e.hitch(this,function(c){this.setImage(c)})))},
setImage:function(d){p.addClass(this.image,"hide");p.addClass(this.noImage,"hide");""===d?p.removeClass(this.noImage,"hide"):(p.removeClass(this.image,"hide"),p.attr(this.image,"src",d))},chooseImage:function(){var d=this.imageChooser.mask;if(n("safari")){var c=document.createEvent("MouseEvents");c.initEvent("click",!0,!0);d.dispatchEvent(c)}else d.click()},setLink:function(d){this.linkText.setValue(d)},getLink:function(){var d=this.linkText.getValue();!1===/^\/\//.test(d)&&!1===/(^(.+):\/\/)/.test(d)&&
(d="http://"+d);return d},isValid:function(){return!1===this.linkText.isValid()?!1:!0}})})},"jimu/dijit/CheckBox":function(){define("dojo/_base/declare dijit/_WidgetBase dojo/_base/lang dojo/_base/html dojo/dom-class dojo/on dojo/Evented dojo/keys".split(" "),function(k,e,p,q,n,l,h,f){return k([e,h],{baseClass:"jimu-checkbox",declaredClass:"jimu.dijit.CheckBox",checked:!1,status:!0,label:"",postCreate:function(){this.checkNode=q.create("div",{"class":"checkbox jimu-float-leading jimu-icon jimu-icon-checkbox"},
this.domNode);this.labelNode=q.create("div",{"class":"label jimu-float-leading",innerHTML:this.label||""},this.domNode);this.checked&&(q.addClass(this.checkNode,"checked"),q.addClass(this.checkNode,"jimu-icon-checked"));this.status||(q.addClass(this.domNode,"jimu-state-disabled"),q.addClass(this.checkNode,"jimu-state-disabled"));this.own(l(this.checkNode,"click",p.hitch(this,function(){this.status&&(this.checked?this.uncheck():this.check())})));this.own(l(this.labelNode,"click",p.hitch(this,function(){this.checked&&
this.status?this.uncheck():this.status&&this.check()})));this._udpateLabelClass();this._initSection508()},setLabel:function(d){this.label=d;this.labelNode.innerHTML=this.label;this._udpateLabelClass()},_udpateLabelClass:function(){this.labelNode&&(this.labelNode.innerHTML?q.removeClass(this.labelNode,"not-visible"):q.addClass(this.labelNode,"not-visible"))},_initSection508:function(){"undefined"!==typeof this.tabindex&&(q.setAttr(this.checkNode,"tabindex",this.tabindex),this.own(l(this.checkNode,
"focus",p.hitch(this,function(){q.addClass(this.checkNode,"dijitCheckBoxFocused")}))),this.own(l(this.checkNode,"blur",p.hitch(this,function(){q.removeClass(this.checkNode,"dijitCheckBoxFocused")}))),this.own(l(this.checkNode,"keypress",p.hitch(this,function(d){d=d.charCode||d.keyCode;q.hasClass(this.checkNode,"dijitCheckBoxFocused")&&f.SPACE===d&&this.status&&(this.checked?this.uncheck():this.check())}))))},setValue:function(d){this.status&&(!0===d?this.check():this.uncheck())},getValue:function(){return this.checked},
setStatus:function(d){d=!!d;var c=this.status!==d;(this.status=d)?(n.remove(this.domNode,"jimu-state-disabled"),q.removeClass(this.checkNode,"jimu-state-disabled")):(n.add(this.domNode,"jimu-state-disabled"),q.addClass(this.checkNode,"jimu-state-disabled"));c&&this.emit("status-change",d)},getStatus:function(){return this.status},check:function(d){if(this.status&&(this.checked=!0,q.addClass(this.checkNode,"checked jimu-icon-checked"),q.removeClass(this.checkNode,"checked jimu-icon-checkbox"),!d))this.onStateChange()},
uncheck:function(d){if(this.status&&(this.checked=!1,q.removeClass(this.checkNode,"checked"),q.removeClass(this.checkNode,"jimu-icon-checked"),q.addClass(this.checkNode,"jimu-icon-checkbox"),!d))this.onStateChange()},onStateChange:function(){if(this.onChange&&p.isFunction(this.onChange))this.onChange(this.checked);this.emit("change",this.checked)},focus:function(){this.checkNode&&this.checkNode.focus&&this.checkNode.focus()}})})},"esri/arcgis/AppProxyManager":function(){define("dojo/_base/declare dojo/_base/lang ../kernel dojo/uacss dojo/Deferred dojo/promise/all dojo/json dojo/Evented dojo/Stateful ../request ./utils".split(" "),
function(k,e,p,q,n,l,h,f,d,c,a){return k([f,d],{constructor:function(a){this.defaults={appid:"",referrers:[],proxies:[]};a=e.mixin({},this.defaults,a);this.set(a);this._init()},updateProxy:function(a){var b=new n;if(!a||!a.proxyId)return b.reject("A proxyId is required to update a proxy"),b.promise;var d={sourceUrl:a.sourceUrl};a.intervalSeconds&&!isNaN(a.intervalSeconds)&&(d.intervalSeconds=a.intervalSeconds);a.hitsPerInterval&&!isNaN(a.hitsPerInterval)&&(d.hitsPerInterval=a.hitsPerInterval);var f=
this._sharingBaseUrl+"content/users/"+this._owner+"/";this._folderId&&(f+=this._folderId+"/");f+="items/"+this.appid+"/proxies/"+a.proxyId+"/update";c({url:f,content:{proxy:h.stringify(d),f:"json"},callbackParamName:"callback"},{usePost:!0}).then(e.hitch(this,function(a){a=a&&a.appProxies||[];this.set("proxies",a);b.resolve(a)}),b.reject);return b.promise},createProxies:function(a){var b=new n;this._registerApp(this._appItem).then(e.hitch(this,function(){for(var d={referrers:this.referrers},f=[],
g=0;g<a.length;g++){var k=a[g],l={sourceUrl:k.sourceUrl};k.intervalSeconds&&!isNaN(k.intervalSeconds)&&(l.intervalSeconds=k.intervalSeconds);k.hitsPerInterval&&!isNaN(k.hitsPerInterval)&&(l.hitsPerInterval=k.hitsPerInterval);f.push(l)}g=this._sharingBaseUrl+"content/users/"+this._owner+"/";this._folderId&&(g+=this._folderId+"/");g+="items/"+this.appid+"/createProxies";c({url:g,content:{proxies:h.stringify(f),serviceProxyParams:h.stringify(d),f:"json"},callbackParamName:"callback"},{usePost:!0}).then(e.hitch(this,
function(a){a=a&&a.appProxies||[];this.set("proxies",a);b.resolve(a)}),b.reject)}),b.reject);return b.promise},deleteProxies:function(a){var b=new n,d={f:"json"},f=[];if(a&&a.length)for(var h=0;h<a.length;h++)f.push(a[h].proxyId);f&&f.length&&(d.proxies=f.toString());a=this._sharingBaseUrl+"content/users/"+this._owner+"/";this._folderId&&(a+=this._folderId+"/");a+="items/"+this.appid+"/deleteProxies";c({url:a,content:d,callbackParamName:"callback"},{usePost:!0}).then(e.hitch(this,function(a){var c=
this.proxies.slice();a=a&&a.results||[];if(c&&c.length&&a&&a.length)for(var d=0;d<c.length;d++)for(var f=c[d],g=f.proxyId,e=0;e<a.length;e++){var h=a[e].proxyId;h&&g&&h===g&&(f.proxied=!1)}this.set("proxies",c);b.resolve(c)}),b.reject);return b.promise},_parseUrl:function(a){var b=document.createElement("a");b.href=a;return b},_init:function(){this.appid?a.getItem(this.appid).then(e.hitch(this,function(a){this._appItem=a;this._folderId=a.item.ownerFolder;var b=this._parseUrl(a.item.url);this._sharingBaseUrl=
"https://"+b.hostname+"/sharing/rest/";var c=b.pathname.substring(0,b.pathname.lastIndexOf("/")),c="/"===c.charAt(0)?c:"/"+c,d=b.hostname+c;this.referrers.push("http://"+d,"https://"+d,"http://www.arcgis.com"+c,"https://www.arcgis.com"+c);-1!==b.hostname.indexOf("mapsdevext.arcgis.com")&&this.referrers.push("http://devext.arcgis.com"+c,"https://devext.arcgis.com"+c);-1!==b.hostname.indexOf("mapsqaext.arcgis.com")&&this.referrers.push("http://qaext.arcgis.com"+c,"https://qaext.arcgis.com"+c);this._owner=
a.item.owner;-1!==a.item.typeKeywords.indexOf("App Proxy")&&a.item.appProxies&&this.set("proxies",a.item.appProxies);this.emit("load",{});this.set("loaded",!0)})):console.error("AppProxyManager: appid required.")},_registerApp:function(a){var b=new n,d=a.item.id,f=this._sharingBaseUrl+"oauth2/",k=this.referrers;this._registered&&this._registered===this.appid?b.resolve(a):-1!==a.item.typeKeywords.indexOf("Registered App")?b.resolve(a):c({url:f+"/registerApp",content:{itemId:d,appType:"browser",redirect_uris:h.stringify(k),
f:"json"},callbackParamName:"callback"},{usePost:!0}).then(e.hitch(this,function(a){this._registered=this.appid;b.resolve(a)}),b.reject);return b.promise}})})},"builder/plugins/attribute-config/AppProxyUtil":function(){define(["dojo/_base/array","dojo/Deferred","jimu/portalUtils"],function(k,e,p){function q(c){return k.some(h,function(a){return-1<c.search(a)})}function n(c){return k.some(f,function(a){return-1<c.search(a)})}function l(c){var a=new e;if(c){var b=[],d={},f;k.forEach(c.operationalLayers,
function(a){var c,g;c=a.url;g=document.createElement("a");g.href=c;c=q(g.host);g=n(g.host);if(c||g)d[a.url]?(f=d[a.url],f.title=f.title+", "+(a.title||a.name)):(f={sourceUrl:a.url,title:a.title||a.name,premium:c,consumeCredits:g,useProxy:!1},b.push(f),d[a.url]=f)});a.resolve(b)}else a.resolve([]);return a}var h=[/traffic\w*\.arcgis\.com/i,/elevation\w*\.arcgis\.com/i,/geoenrich\w*\.arcgis\.com/i,/hydro\w*\.arcgis\.com/i,/naip\w*\.arcgis\.com/i,/livefeeds\w*\.arcgis\.com/i,/demographics\w*\.arcgis\.com/i,
/landscape\w*\.arcgis\.com/i,/historical\w*\.arcgis\.com/i,/earthobs\w*\.arcgis\.com/i],f=[/demographics\w*\.arcgis\.com/i,/geoenrich\w*\.arcgis\.com/i,/route\w*\.arcgis\.com/i,/logistics\w*\.arcgis\.com/i,/analysis\w*\.arcgis\.com/i,/elevation\w*\.arcgis\.com/i],d={queryForSecureServicesInMap:function(c,a){try{return p.getPortal(c).getItemData(a).then(function(a){return l(a)},function(){return[]})}catch(b){return c=new e,c.resolve([]),c}},isLimitedProxy:function(c){return c?!isNaN(c.hitsPerInterval)&&
!isNaN(c.intervalSeconds)&&0<c.intervalSeconds&&0<c.hitsPerInterval:!1},findProxy:function(c,a){var b=d.isLimitedProxy(a),f;c=c||[];a=a||{};k.some(c,function(c){if(c.sourceUrl===a.sourceUrl&&!1!==c.proxied&&c.proxyId&&c.proxyUrl){var g=!1;b&&c.hitsPerInterval===a.hitsPerInterval&&c.intervalSeconds===a.intervalSeconds?g=!0:b||d.isLimitedProxy(c)||(g=!0);g&&(f=c);return g}});return f},urlExists:function(c,a){return k.some(c.proxies,function(b){return b.sourceUrl===a&&!1!==b.proxied})},createProxy:function(c,
a,b,f){var g,h,k,l=new e,p={};g=q(a);h=n(a);(k=d.findProxy(c.proxies,{sourceUrl:a,hitsPerInterval:b,intervalSeconds:f}))?(k.premium=g,k.consumeCredits=h,l.resolve(k)):(p.sourceUrl=a,d.isLimitedProxy({hitsPerInterval:b,intervalSeconds:f})&&(p.hitsPerInterval=b,p.intervalSeconds=f),c.createProxies([p]).then(function(c){(k=d.findProxy(c,{sourceUrl:a,hitsPerInterval:b,intervalSeconds:f}))?(k.premium=g,k.consumeCredits=h,l.resolve(k)):l.reject("create proxy failed.")}).otherwise(function(a){l.reject(a)}));
return l}};d.isPremium=q;d.consumesCredits=n;return d})},"builder/plugins/attribute-config/MapProxyItem":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/Evented dojo/on dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./MapProxyItem.html ./AppProxyUtil jimu/dijit/CheckBox dijit/form/NumberSpinner dijit/form/Select".split(" "),function(k,e,p,q,n,l,h,f,d,c){k=k([l,h,f,q],{baseClass:"map-proxy-item",templateString:d,appProxyManager:null,sourceUrl:"",
title:"",useProxy:!1,proxyUrl:"",proxyId:"",premium:!0,consumeCredits:!1,intervalSeconds:0,hitsPerInterval:0,postMixInProperties:function(){this.inherited(arguments);this.nls=e.mixin(this.nls,window.jimuNls.common);this.nls=e.mixin(this.nls,window.jimuNls.timeUnit)},postCreate:function(){this.inherited(arguments);!0===this.consumeCredits?p.setStyle(this.consumeCreditsContent,"visibility","visible"):p.setStyle(this.consumeCreditsContent,"visibility","hidden");p.setStyle(this.loading,"display","none");
this.useProxyCheckBox.setStatus(!0);!0===this.useProxy&&this.proxyId&&this.proxyUrl?this.useProxyCheckBox.setValue(!0):this.useProxyCheckBox.setValue(!1);isNaN(this.hitsPerInterval)||this.limitSpinner.set("value",this.hitsPerInterval);isNaN(this.intervalSeconds)||this.intervalSelect.set("value",this.intervalSeconds);this._updateLimitLabel();this.own(n(this.useProxyCheckBox,"change",e.hitch(this,this._onUseProxyChange)));this.own(n(this.cancelBtn,"click",e.hitch(this,function(){this._hideDialog()})));
this.own(n(this.okBtn,"click",e.hitch(this,function(){this._hideDialog();this._updateProxy()})));this.own(n(document.body,"click",e.hitch(this,function(a){if(!p.hasClass(this.settingDialog,"hidden")){var b=a.target||a.srcElement,c;a=b===this.settingDialog;c=p.isDescendant(b,this.settingDialog);b=p.isDescendant(b,this.settingBtn);a||c||b||this._hideDialog()}})));this.own(n(this.settingBtn,"click",e.hitch(this,function(){this._toggleDialog()})))},_hideDialog:function(){p.addClass(this.settingDialog,
"hidden");p.removeClass(this.settingBtn,"highight")},_showDialog:function(){p.removeClass(this.settingDialog,"hidden");p.addClass(this.settingBtn,"highight")},_toggleDialog:function(){p.hasClass(this.settingDialog,"hidden")?this._showDialog():this._hideDialog()},_updateLimitLabel:function(){!isNaN(this.hitsPerInterval)&&0<this.hitsPerInterval?this.requestLimitNode.innerHTML=this.hitsPerInterval:this.requestLimitNode.innerHTML=this.nls.unlimit;switch(this.intervalSeconds){case 1:this.intervalNode.innerHTML=
this.nls.second;break;case 60:this.intervalNode.innerHTML=this.nls.minute;break;case 3600:this.intervalNode.innerHTML=this.nls.hour;break;case 86400:this.intervalNode.innerHTML=this.nls.day;break;default:this.intervalNode.innerHTML=this.nls.none}},_updateProxy:function(){var a=this.hitsPerInterval,b=this.intervalSeconds;this.intervalSeconds=+this.intervalSelect.get("value");this.hitsPerInterval=+this.limitSpinner.get("value");this._updateLimitLabel();this.useProxy&&this.appProxyManager&&(a!==this.hitsPerInterval||
b!==this.previousIntervalSeconds)&&(this._startProcess("update proxy"),this.appProxyManager.deleteProxies([{proxyId:this.proxyId}]).then(e.hitch(this,function(){this._createProxy()})).otherwise(e.hitch(this,function(){this._stopProcess()})))},_onUseProxyChange:function(a){a&&!this.proxyId&&this._createProxy();!a&&this.proxyId&&this._deleteProxy()},_createProxy:function(){this._startProcess("Create Proxy");this.intervalSeconds=+this.intervalSelect.get("value");this.hitsPerInterval=+this.limitSpinner.get("value");
try{c.createProxy(this.appProxyManager,this.sourceUrl,this.hitsPerInterval,this.intervalSeconds).then(e.hitch(this,function(a){this.proxyUrl=a.proxyUrl;this.proxyId=a.proxyId;this.useProxy=!0;this._stopProcess("Create Proxy",!0);this.emit("proxyCreated",{sourceUrl:this.sourceUrl,proxyUrl:this.proxyUrl,proxyId:this.proxyId,hitsPerInterval:this.hitsPerInterval,intervalSeconds:this.intervalSeconds,title:this.title,useProxy:!0})})).otherwise(e.hitch(this,function(a){this._createProxiesFail(a)}))}catch(a){this._createProxiesFail(a)}},
_createProxiesFail:function(a){this.proxyUrl=this.proxyId="";this.useProxy=!1;this.emit("processError",this.nls.createProxyFailed+" "+this.sourceUrl);this._stopProcess(a||"Create Proxy",!1)},_deleteProxy:function(){var a=this.proxyId;this.proxyId=this.proxyUrl="";this.useProxy=!1;this.emit("proxyDeleted",{sourceUrl:this.sourceUrl,useProxy:!1});this.useProxyCheckBox.setValue(!1);if(this.appProxyManager)try{this.appProxyManager.deleteProxies([{proxyId:a}])}catch(b){console.error(b)}},_startProcess:function(a){p.setStyle(this.loading,
"display","");this.useProxyCheckBox.setStatus(!1);this.emit("processStart",a)},_stopProcess:function(a,b){p.setStyle(this.loading,"display","none");this.useProxyCheckBox.setStatus(!0);"undefined"!==typeof b&&this.useProxyCheckBox.setValue(b);this.emit("processEnd",a)}});k.PROXY_CREATED="proxyCreated";k.PROXY_DELETED="proxyDeleted";k.PROCESS_START="processStart";k.PROCESS_END="processEnd";k.PROCESS_ERROR="processError";return k})},"dijit/form/NumberSpinner":function(){define(["dojo/_base/declare",
"dojo/keys","./_Spinner","./NumberTextBox"],function(k,e,p,q){return k("dijit.form.NumberSpinner",[p,q.Mixin],{baseClass:"dijitTextBox dijitSpinner dijitNumberTextBox",adjust:function(e,k){var h=this.constraints,f=isNaN(e),d=!isNaN(h.max),c=!isNaN(h.min);f&&0!=k&&(e=0<k?c?h.min:d?h.max:0:d?this.constraints.max:c?h.min:0);k=e+k;if(f||isNaN(k))return e;d&&k>h.max&&(k=h.max);c&&k<h.min&&(k=h.min);return k},_onKeyDown:function(k){if(!(this.disabled||this.readOnly||k.keyCode!=e.HOME&&k.keyCode!=e.END||
k.ctrlKey||k.altKey||k.metaKey||"undefined"==typeof this.get("value"))){var l=this.constraints[k.keyCode==e.HOME?"min":"max"];"number"==typeof l&&this._setValueAttr(l,!1);k.stopPropagation();k.preventDefault()}}})})},"dijit/form/_Spinner":function(){define("dojo/_base/declare dojo/keys dojo/_base/lang dojo/sniff dojo/mouse dojo/on ../typematic ./RangeBoundTextBox dojo/text!./templates/Spinner.html ./_TextBoxMixin".split(" "),function(k,e,p,q,n,l,h,f,d,c){return k("dijit.form._Spinner",f,{defaultTimeout:500,
minimumTimeout:10,timeoutChangeRate:.9,smallDelta:1,largeDelta:10,templateString:d,baseClass:"dijitTextBox dijitSpinner",cssStateNodes:{upArrowNode:"dijitUpArrowButton",downArrowNode:"dijitDownArrowButton"},adjust:function(a){return a},_arrowPressed:function(a,b,d){this.disabled||this.readOnly||(this._setValueAttr(this.adjust(this.get("value"),b*d),!1),c.selectInputText(this.textbox,this.textbox.value.length))},_arrowReleased:function(){this._wheelTimer=null},_typematicCallback:function(a,b,c){var d=
this.smallDelta;b==this.textbox&&(b=c.keyCode,d=b==e.PAGE_UP||b==e.PAGE_DOWN?this.largeDelta:this.smallDelta,b=b==e.UP_ARROW||b==e.PAGE_UP?this.upArrowNode:this.downArrowNode);-1==a?this._arrowReleased(b):this._arrowPressed(b,b==this.upArrowNode?1:-1,d)},_wheelTimer:null,_mouseWheeled:function(a){if(this.focused){a.stopPropagation();a.preventDefault();var b=a.wheelDelta/120;Math.floor(b)!=b&&(b=0<a.wheelDelta?1:-1);a=a.detail?-1*a.detail:b;if(0!==a){var c=this[0<a?"upArrowNode":"downArrowNode"];this._arrowPressed(c,
a,this.smallDelta);this._wheelTimer&&this._wheelTimer.remove();this._wheelTimer=this.defer(function(){this._arrowReleased(c)},50)}}},_setConstraintsAttr:function(a){this.inherited(arguments);this.focusNode&&(void 0!==this.constraints.min?this.focusNode.setAttribute("aria-valuemin",this.constraints.min):this.focusNode.removeAttribute("aria-valuemin"),void 0!==this.constraints.max?this.focusNode.setAttribute("aria-valuemax",this.constraints.max):this.focusNode.removeAttribute("aria-valuemax"))},_setValueAttr:function(a,
b){this.focusNode.setAttribute("aria-valuenow",a);this.inherited(arguments)},postCreate:function(){this.inherited(arguments);this.own(l(this.domNode,n.wheel,p.hitch(this,"_mouseWheeled")),h.addListener(this.upArrowNode,this.textbox,{keyCode:e.UP_ARROW,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1},this,"_typematicCallback",this.timeoutChangeRate,this.defaultTimeout,this.minimumTimeout),h.addListener(this.downArrowNode,this.textbox,{keyCode:e.DOWN_ARROW,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1},this,
"_typematicCallback",this.timeoutChangeRate,this.defaultTimeout,this.minimumTimeout),h.addListener(this.upArrowNode,this.textbox,{keyCode:e.PAGE_UP,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1},this,"_typematicCallback",this.timeoutChangeRate,this.defaultTimeout,this.minimumTimeout),h.addListener(this.downArrowNode,this.textbox,{keyCode:e.PAGE_DOWN,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1},this,"_typematicCallback",this.timeoutChangeRate,this.defaultTimeout,this.minimumTimeout))}})})},"builder/plugins/attribute-config/UrlProxyItem":function(){define(["dojo/_base/declare",
"dojo/_base/array","dojo/_base/lang","dojo/Evented","./AppProxyUtil"],function(k,e,p,q,n){k=k([q],{appProxyManager:null,title:"",sourceUrl:"",proxyUrl:"",proxyId:"",premium:!0,consumeCredits:!1,hitsPerInterval:0,intervalSeconds:0,constructor:function(e){p.mixin(this,e);this.premium=n.isPremium(this.sourceUrl);this.consumeCredits=n.consumesCredits(this.sourceUrl)},createProxy:function(){if(this.premium||this.consumeCredits)if(n.urlExists(this.appProxyManager,this.sourceUrl))this.emit("processError",
this.nls.alreadyProxied);else{this._startProcess();try{n.createProxy(this.appProxyManager,this.sourceUrl,this.hitsPerInterval,this.intervalSeconds).then(p.hitch(this,function(e){this.proxyUrl=e.proxyUrl;this.proxyId=e.proxyId;this.useProxy=!0;this.premium=e.premium;this.consumeCredits=e.consumeCredits;this._stopProcess();this.emit("proxyCreated",{sourceUrl:this.sourceUrl,proxyUrl:this.proxyUrl,proxyId:this.proxyId,hitsPerInterval:this.hitsPerInterval,intervalSeconds:this.intervalSeconds,premium:this.premium,
consumeCredits:this.consumeCredits,title:this.title,useProxy:!0})})).otherwise(p.hitch(this,function(){this._stopProcess()}))}catch(l){this.emit("processError",l),this._stopProcess()}}else this.emit("processError",this.nls.notValidPremiumUrl)},deleteProxy:function(){this._startProcess();if(this.appProxyManager&&this.proxyId)try{this.appProxyManager.deleteProxies([{proxyId:this.proxyId}]).then(p.hitch(this,function(k){var h=e.some(k,p.hitch(this,function(f){return f.sourceUrl===this.sourceUrl&&!1===
f.proxied}));h||(h=e.every(k,p.hitch(this,function(f){return f.sourceUrl!==this.sourceUrl})));h?(this.proxyId=this.proxyUrl="",this.emit("proxyDeleted",this.sourceUrl)):this.emit("processError",this.nls.deleteProxyFailed+" "+this.sourceUrl);this._stopProcess()}),p.hitch(this,function(){this.emit("processError",this.nls.deleteProxyFailed+" "+this.sourceUrl);this._stopProcess()}))}catch(l){this.emit("processError",this.nls.deleteProxyFailed+" "+this.sourceUrl),this._stopProcess()}else this.emit("processError",
this.nls.deleteProxyFailed+" "+this.sourceUrl),this._stopProcess()},_startProcess:function(){this.emit("processStart")},_stopProcess:function(){this.emit("processEnd")}});k.PROXY_CREATED="proxyCreated";k.PROCESS_START="processStart";k.PROXY_DELETED="proxyDeleted";k.PROCESS_END="processEnd";k.PROCESS_ERROR="processError";return k})},"builder/dijit/LinkEditor":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/_base/array dijit/_WidgetBase dijit/_TemplatedMixin dojo/text!./templates/LinkEditor.html dojo/on dojo/dom-geometry dojo/Evented ./LinkItemEditor ./LinkItem".split(" "),
function(k,e,p,q,n,l,h,f,d,c,a,b){return k([n,l,c],{templateString:h,baseClass:"link-editor",btnLabel:"",linkList:[],canEdit:!0,canDelete:!0,isRest:!1,isProxy:!1,beforeAdd:null,afterAdd:null,beforeUpdate:null,afterUpdate:null,beforeDelete:null,afterDelete:null,postMixInProperties:function(){this.nls=e.mixin(this.nls,window.jimuNls.common);""===this.btnLabel&&(this.btnLabel="Add Link")},postCreate:function(){this.inherited(arguments);this.labelNode.innerHTML=this.btnLabel;this.setItems(this.linkList);
this.editor=new a({nls:this.nls,isRest:this.isRest,isProxy:this.isProxy});this.editor.placeAt(this.domNode);this.editor.startup();this.editor.hide();this.own(f(this.editor,"updated",e.hitch(this,this._updateLinkItem)));this.own(f(this.addLinkBtn,"click",e.hitch(this,function(){this._showEditor(null)})))},clearItems:function(){this.linkItems=[];p.empty(this.linkListNode)},setItems:function(a){this.clearItems();this.linkList=a;q.forEach(this.linkList,e.hitch(this,function(a){this._addItem(a,!1)}))},
getItems:function(){return this.linkItems},_showEditor:function(a){var b;null!==a?b=d.position(a.domNode):(b=d.position(this.addLinkBtn),b.y+=b.h);this.editor.show(-1E3,0);var c=d.getMarginBox(this.editor.contentNode),f=d.getMarginBox(jimuConfig.layoutId);b.y+c.h+50>f.h&&(b.y=f.h-c.h-50);this.editor.setLinkItem(a);this.editor.show(b.x,b.y)},_addItem:function(a,b){b&&"function"===typeof this.beforeAdd?this.beforeAdd(a).then(e.hitch(this,function(b){b&&(this.isProxy&&(a.proxyId=b.proxyId,a.proxyUrl=
b.proxyUrl,a.premium=b.premium,a.consumeCredits=b.consumeCredits,a.hitsPerInterval=b.hitsPerInterval,a.intervalSeconds=b.intervalSeconds),this._doAddItem(a))})):this._doAddItem(a,b)},_doAddItem:function(a,c){a=new b({nls:this.nls,label:a.label,url:a.url,isProxy:this.isProxy,proxyId:a.proxyId,proxyUrl:a.proxyUrl,premium:a.premium,consumeCredits:a.consumeCredits,hitsPerInterval:a.hitsPerInterval,intervalSeconds:a.intervalSeconds,canEdit:this.canEdit,canDelete:this.canDelete});a.placeAt(this.linkListNode);
a.startup();this.linkItems.push(a);this.own(f(a,"delete",e.hitch(this,this._deleteItem)));this.own(f(a,"edit",e.hitch(this,function(a){this._showEditor(a)})));c&&"function"===typeof this.afterAdd&&this.afterAdd(a)},_updateLinkItem:function(a){if(null===a.linkItem){var b={label:a.newValue.label,url:a.newValue.url};this.isProxy&&(b.hitsPerInterval=a.newValue.hitsPerInterval,b.intervalSeconds=a.newValue.intervalSeconds);this._addItem(b,!0)}else"function"===typeof this.beforeUpdate?this.beforeUpdate(a.linkItem,
a.newValue.label,a.newValue.url).then(e.hitch(this,function(b){!0===b&&this._doUpdateItem(a.linkItem,a.newValue.label,a.newValue.url)})):this._doUpdateItem(a.linkItem,a.newValue.label,a.newValue.url)},_doUpdateItem:function(a,b,c){a.update(b,c);"function"===typeof this.afterUpdate&&this.afterUpdate(a,b,c)},_deleteItem:function(a){"function"===typeof this.beforeDelete?this.beforeDelete(a).then(e.hitch(this,function(b){!0===b&&this._doDeleteItem(a)})):this._doDeleteItem(a)},_doDeleteItem:function(a){this.linkItems=
q.filter(this.linkItems,function(b){return b!==a});p.destroy(a.domNode);"function"===typeof this.afterDelete&&this.afterDelete(a)}})})},"builder/dijit/LinkItemEditor":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dijit/form/ValidationTextBox jimu/dijit/URLInput dojo/text!./templates/LinkItemEditor.html dojo/on dojo/dom-style dojo/Evented dijit/form/NumberSpinner dijit/form/Select".split(" "),function(k,e,
p,q,n,l,h,f,d,c,a,b){return k([q,n,l,b],{templateString:d,baseClass:"link-item-editor",linkItem:null,isRest:!1,isProxy:!1,postMixInProperties:function(){this.inherited(arguments);this.nls=e.mixin(this.nls,window.jimuNls.common);this.nls=e.mixin(this.nls,window.jimuNls.timeUnit)},postCreate:function(){this.inherited(arguments);this.isProxy&&p.addClass(this.domNode,"proxy-editor");this.urlInput=new f({required:!0,rest:this.isRest,placeHolder:this.nls.inputURL,value:this.linkItem?this.linkItem.url:"",
style:"width:100%"});this.urlInput.placeAt(this.urlNode);this.urlInput.startup();this.titleInput=new h({required:!0,trim:!0,placeHolder:this.nls.inputTitle,value:this.linkItem?this.linkItem.label:"",style:"width: 100%"});this.titleInput.placeAt(this.titleNode);this.titleInput.startup();this.isProxy?(p.setStyle(this.proxyNode,"display","block"),this.limitSpinner.set("value",this.linkItem?this.linkItem.hitsPerInterval:0),this.intervalSelect.set("value",this.linkItem?this.linkItem.intervalSeconds:0)):
p.setStyle(this.proxyNode,"display","none");this.own(c(this.okBtn,"click",e.hitch(this,this._onOkClicked)));this.own(c(this.cancelBtn,"click",e.hitch(this,this.hide)));this.own(c(this.domNode,"click",e.hitch(this,this._onDomClicked)))},setLinkItem:function(a){this.linkItem=a;this.titleInput.set("value",a?a.label:"");this.urlInput.set("value",a?a.url:"");this.isProxy&&(this.limitSpinner.set("value",a?a.hitsPerInterval:0),this.intervalSelect.set("value",a?a.intervalSeconds:0))},_onDomClicked:function(a){p.isDescendant(a.target||
a.srcElement,this.contentNode)||this.hide()},show:function(b,c){a.set(this.domNode,"display","");a.set(this.contentNode,{left:b+"px",top:c+"px"})},hide:function(){a.set(this.domNode,"display","none")},_onOkClicked:function(){if(this.urlInput.isValid()&&this.titleInput.isValid()){var a={},b=this.titleInput.get("value"),c=this.urlInput.get("value");a.label=b;a.url=c;this.isProxy&&(a.hitsPerInterval=+this.limitSpinner.get("value"),a.intervalSeconds=+this.intervalSelect.get("value"));this.linkItem&&b===
this.linkItem.label&&c===this.linkItem.url||(this.emit("updated",{linkItem:this.linkItem,newValue:a,hitsPerInterval:+this.limitSpinner.get("value"),intervalSeconds:+this.intervalSelect.get("value")}),this.hide())}}})})},"jimu/dijit/URLInput":function(){define(["dojo/_base/declare","dojo/_base/html","dijit/form/ValidationTextBox","dojox/validate/regexp"],function(k,e,p,q){return k([p],{declaredClass:"jimu.dijit.URLInput",required:!0,invalidMessage:"Invalid url.",trim:!0,rest:!0,allowNamed:!0,allowLocal:!0,
postMixInProperties:function(){this.inherited(arguments);this.invalidMessage=(this.nls=window.jimuNls.urlInput)?this.nls.invalidUrl:"Invalid Url"},postCreate:function(){this.inherited(arguments);e.addClass(this.domNode,"jimu-url-input")},validator:function(e){if(!1===this.required&&""===e)return!0;if(isFinite(e))return!1;var k="^"+q.url({allowNamed:this.allowNamed,allowLocal:this.allowLocal}),k=new RegExp(k,"g");k.lastIndex=0;k=k.test(e);return this.rest?(e=/\/rest\/services/gi.test(e),k&&e):k}})})},
"dojox/validate/regexp":function(){define(["dojo/_base/lang","dojo/regexp","dojox/main"],function(k,e,p){var q=k.getObject("validate.regexp",!0,p);return q=p.validate.regexp={ipAddress:function(e){e="object"==typeof e?e:{};"boolean"!=typeof e.allowDottedDecimal&&(e.allowDottedDecimal=!0);"boolean"!=typeof e.allowDottedHex&&(e.allowDottedHex=!0);"boolean"!=typeof e.allowDottedOctal&&(e.allowDottedOctal=!0);"boolean"!=typeof e.allowDecimal&&(e.allowDecimal=!0);"boolean"!=typeof e.allowHex&&(e.allowHex=
!0);"boolean"!=typeof e.allowIPv6&&(e.allowIPv6=!0);"boolean"!=typeof e.allowHybrid&&(e.allowHybrid=!0);var k=[];e.allowDottedDecimal&&k.push("((\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])\\.){3}(\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])");e.allowDottedHex&&k.push("(0[xX]0*[\\da-fA-F]?[\\da-fA-F]\\.){3}0[xX]0*[\\da-fA-F]?[\\da-fA-F]");e.allowDottedOctal&&k.push("(0+[0-3][0-7][0-7]\\.){3}0+[0-3][0-7][0-7]");e.allowDecimal&&k.push("(0|[1-9]\\d{0,8}|[1-3]\\d{9}|4[01]\\d{8}|42[0-8]\\d{7}|429[0-3]\\d{6}|4294[0-8]\\d{5}|42949[0-5]\\d{4}|429496[0-6]\\d{3}|4294967[01]\\d{2}|42949672[0-8]\\d|429496729[0-5])");
e.allowHex&&k.push("0[xX]0*[\\da-fA-F]{1,8}");e.allowIPv6&&k.push("([\\da-fA-F]{1,4}\\:){7}[\\da-fA-F]{1,4}");e.allowHybrid&&k.push("([\\da-fA-F]{1,4}\\:){6}((\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])\\.){3}(\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])");e="";0<k.length&&(e="("+k.join("|")+")");return e},host:function(e){e="object"==typeof e?e:{};"boolean"!=typeof e.allowIP&&(e.allowIP=!0);"boolean"!=typeof e.allowLocal&&(e.allowLocal=!1);"boolean"!=typeof e.allowPort&&(e.allowPort=!0);"boolean"!=typeof e.allowNamed&&
(e.allowNamed=!1);var k=e.allowPort?"(\\:\\d+)?":"",h="((?:(?:[\\da-zA-Z](?:[-\\da-zA-Z]{0,61}[\\da-zA-Z])?)\\.)+(?:[a-zA-Z](?:[-\\da-zA-Z]{0,61}[\\da-zA-Z])?)\\.?)";e.allowIP&&(h+="|"+q.ipAddress(e));e.allowLocal&&(h+="|localhost");e.allowNamed&&(h+="|^[^-][a-zA-Z0-9_-]*");return"("+h+")"+k},url:function(k){k="object"==typeof k?k:{};"scheme"in k||(k.scheme=[!0,!1]);return e.buildGroupRE(k.scheme,function(e){return e?"(https?|ftps?)\\://":""})+q.host(k)+"(/(?:[^?#\\s/]+/)*(?:[^?#\\s/]+(?:\\?[^?#\\s/]*)?(?:#[A-Za-z][\\w.:-]*)?)?)?"},
emailAddress:function(e){e="object"==typeof e?e:{};"boolean"!=typeof e.allowCruft&&(e.allowCruft=!1);e.allowPort=!1;var k="([!#-'*+\\-\\/-9\x3d?A-Z^-~]+[.])*[!#-'*+\\-\\/-9\x3d?A-Z^-~]+@"+q.host(e);e.allowCruft&&(k="\x3c?(mailto\\:)?"+k+"\x3e?");return k},emailAddressList:function(e){e="object"==typeof e?e:{};"string"!=typeof e.listSeparator&&(e.listSeparator="\\s;,");var k=q.emailAddress(e);return"("+k+"\\s*["+e.listSeparator+"]\\s*)*"+k+"\\s*["+e.listSeparator+"]?\\s*"},numberFormat:function(k){k=
"object"==typeof k?k:{};"undefined"==typeof k.format&&(k.format="###-###-####");return e.buildGroupRE(k.format,function(k){return e.escapeString(k,"?").replace(/\?/g,"\\d?").replace(/#/g,"\\d")})},ca:{postalCode:function(){return"([A-Z][0-9][A-Z] [0-9][A-Z][0-9])"},province:function(){return"(AB|BC|MB|NB|NL|NS|NT|NU|ON|PE|QC|SK|YT)"}},us:{state:function(e){e="object"==typeof e?e:{};"boolean"!=typeof e.allowTerritories&&(e.allowTerritories=!0);"boolean"!=typeof e.allowMilitary&&(e.allowMilitary=!0);
var k="AL|AK|AZ|AR|CA|CO|CT|DE|DC|FL|GA|HI|ID|IL|IN|IA|KS|KY|LA|ME|MD|MA|MI|MN|MS|MO|MT|NE|NV|NH|NJ|NM|NY|NC|ND|OH|OK|OR|PA|RI|SC|SD|TN|TX|UT|VT|VA|WA|WV|WI|WY";e.allowTerritories&&(k+="|AS|FM|GU|MH|MP|PW|PR|VI");e.allowMilitary&&(k+="|AA|AE|AP");return"("+k+")"}}}})},"builder/dijit/LinkItem":function(){define("dojo/_base/declare dojo/_base/lang dijit/_WidgetBase dijit/_TemplatedMixin dojo/on dojo/mouse dojo/dom-style dojo/dom-class dojo/Evented".split(" "),function(k,e,p,q,n,l,h,f,d){return k([p,
q,d],{templateString:'\x3cdiv\x3e\x3cdiv class\x3d"label" data-dojo-attach-point\x3d"titleNode" title\x3d"${url}"\x3e${label}\x3c/div\x3e\x3cdiv class\x3d"action" data-dojo-attach-point\x3d"actionSection" style\x3d"display:none;"\x3e\x3cdiv class\x3d"btn delete-btn" data-dojo-attach-point\x3d"deleteBtn" title\x3d"${nls.deleteLink}"\x3e\x3c/div\x3e\x3cdiv class\x3d"btn edit-btn" data-dojo-attach-point\x3d"editBtn" title\x3d"${nls.editLink}"\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d"access-limit" data-dojo-attach-point\x3d"accessLimitNode"\x3e${nls.requestLimit}: \x3cspan data-dojo-attach-point\x3d"requestLimitNode"\x3e\x3c/span\x3e\x26nbsp;\x26nbsp;${nls.interval}: \x3cspan data-dojo-attach-point\x3d"intervalNode"\x3e\x3c/span\x3e\x3c/div\x3e\x3c/div\x3e',
baseClass:"link-item",label:"",url:"",isProxy:!1,proxyId:"",proxyUrl:"",hitsPerInterval:0,intervalSeconds:0,canEdit:!0,canDelete:!0,_tooltipTimeout:200,postCreate:function(){this.inherited(arguments);this.canDelete?(h.set(this.deleteBtn,"display","inline-block"),this.own(n(this.deleteBtn,"click",e.hitch(this,this._deleteLink)))):h.set(this.deleteBtn,"display","none");this.canEdit?(h.set(this.editBtn,"display","inline-block"),this.own(n(this.editBtn,"click",e.hitch(this,this._editLink)))):h.set(this.editBtn,
"display","none");this.own(n(this.domNode,l.enter,e.hitch(this,function(){h.set(this.actionSection,"display","")})));this.own(n(this.domNode,l.leave,e.hitch(this,function(){h.set(this.actionSection,"display","none")})));this.isProxy?(f.add(this.domNode,"is-proxy"),this._updateLabel(),h.set(this.accessLimitNode,"display","block")):h.set(this.accessLimitNode,"display","none")},update:function(c,a){this.label=c;this.url=a;this.titleNode.innerHTML=this.label;this.titleNode.title=this.url;this.isProxy&&
this._updateLabel()},_updateLabel:function(){!isNaN(this.hitsPerInterval)&&0<this.hitsPerInterval?this.requestLimitNode.innerHTML=this.hitsPerInterval:this.requestLimitNode.innerHTML=this.nls.unlimit;switch(this.intervalSeconds){case 1:this.intervalNode.innerHTML=this.nls.second;break;case 60:this.intervalNode.innerHTML=this.nls.minute;break;case 3600:this.intervalNode.innerHTML=this.nls.hour;break;case 86400:this.intervalNode.innerHTML=this.nls.day;break;default:this.intervalNode.innerHTML=this.nls.none}},
_deleteLink:function(){this.emit("delete",this)},_editLink:function(){this.emit("edit",this)}})})},"builder/plugins/attribute-config/dataSource/AdditionalDataSources":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./AdditionalDataSources.html dojo/on dojo/mouse dojo/query dojo/topic dojo/_base/lang dojo/_base/html jimu/dijit/_QueryableLayerSourcePopup jimu/dijit/Message jimu/utils ./DataSourceConfigPopup ./utils builder/dijit/RefreshInterval dijit/form/Select dijit/form/ValidationTextBox".split(" "),
function(k,e,p,q,n,l,h,f,d,c,a,b,g,u,m,r,t){var v=h.enter,y=h.leave;return k([e,p,q],{templateString:n,baseClass:"additional-data-sources",_layerId:"",_serviceType:"",_targetSourceId:"",layerType:"Features",_sourceType:"",postMixInProperties:function(){this.nls=c.mixin(this.nls,window.jimuNls.common,window.builderNls)},postCreate:function(){this.inherited(arguments);this._initRefreshInterval();this._renderUIByConfig();this._initEvent();this.own(d.subscribe("app/appConfigChanged",c.hitch(this,this._onAppConfigChanged)))},
setMap:function(a){a&&(this.map=a)},_onAppConfigChanged:function(b){var c=u.isEqual(this.appConfig.dataSource,b.dataSource);this.appConfig&&!c&&(this.appConfig=b,a.empty(this.sourcesList),this._renderUIByConfig())},_initRefreshInterval:function(){this.refreshIntervalDijit=new t({defaultRefreshTip:this.nls.defaultRefreshTip_dataSource,singleRefreshTip:this.nls.singleRefreshTip_dataSource});this.refreshIntervalDijit.placeAt(this.refreshIntervalDiv)},_renderUIByConfig:function(){var b=c.clone(this.appConfig.dataSource),
d=b.dataSources,e;for(e in d)"widget"!==e.split("~")[0]&&this._addSourceTr(d[e]);b=b.settings||{};d={};"undefined"!==typeof b.unifiedRefreshInterval?(d.useWebMapRefreshInterval=!1,d.minutes=b.unifiedRefreshInterval):d.useWebMapRefreshInterval=!0;this.refreshIntervalDijit.setValue(d);this._isNotEmptySourceList()?(a.setStyle(this.refreshIntervalDiv,"display",""),a.setStyle(this.tabelHeader,"display",""),a.setStyle(this.noDataSourceTip,"display","none")):(a.setStyle(this.refreshIntervalDiv,"display",
"none"),a.setStyle(this.tabelHeader,"display","none"),a.setStyle(this.noDataSourceTip,"display",""))},_onAddNewClick:function(b){b.stopPropagation();a.hasClass(this.dsOptions,"hide")?this._showDsOption():this._hiddenDsOption()},_showDsOption:function(){a.removeClass(this.dsOptions,"hide")},_hiddenDsOption:function(){a.addClass(this.dsOptions,"hide")},_onAddNewLayerClick:function(a){a.stopPropagation();this._sourceType="Features";this._addNewSource()},_onAddNewStatisticsClick:function(a){a.stopPropagation();
this._sourceType="FeatureStatistics";this._addNewSource()},_addNewSource:function(){this._hiddenDsOption();var a=new b({titleLabel:this.nls.setDataSource,dijitArgs:{multiple:!1,createMapResponse:this.map.webMapResponse,mustSupportStatistics:"FeatureStatistics"===this._sourceType,portalUrl:this.appConfig.portalUrl,style:{height:"100%"}}});this.own(l(a,"ok",c.hitch(this,function(b){"FeatureStatistics"!==this._sourceType||this._isSupportStatistics(b.definition)?(this._setLayerId(b),b.label=b.name,this._serviceType=
a.getSelectedRadioType(),a.close(),a=null,this._createSourceConfigPopup(b,"add")):new g({message:this.nls.notSupportStatistics})})));this.own(l(a,"cancel",c.hitch(this,function(){a.close();a=null})))},_createSourceConfigPopup:function(a,b){c.mixin(a,{type:this._sourceType,serviceType:this._serviceType});this.sourceConfigPopup=new m({titleLabel:this.nls.configDataSource,dijitArgs:{nls:this.nls,map:this.map,config:a}});this.own(l(this.sourceConfigPopup,"ok",c.hitch(this,function(a){this.sourceConfigPopup.close();
this.sourceConfigPopup=null;"add"===b?this._addDataSourceToAppConfig(a):this._updateDataSourceOfAppConfig(a)})));this.own(l(this.sourceConfigPopup,"cancel",c.hitch(this,function(){this.sourceConfigPopup.close();this.sourceConfigPopup=null})))},_addDataSourceToAppConfig:function(a){a.id=this._generateSourceId();var b=c.clone(this.appConfig.dataSource);b.dataSources||(b.dataSources={});b.dataSources[a.id]=a;this._updateAppConfig(b)},_addSourceTr:function(b){this._sourceType=b.type;var c;"Features"===
this._sourceType?c=this.nls.layer:"FeatureStatistics"===this._sourceType&&(c=this.nls.statistics);c='\x3cdiv style\x3d"width: 100%;"\x3e\x3cdiv class\x3d"source-tr"\x3e\x3cdiv class\x3d"source-td source-tr-name textOverFlow" title\x3d"'+b.label+'"\x3e'+b.label+'\x3c/div\x3e\x3cdiv class\x3d"source-td source-tr-type textOverFlow" title\x3d"'+c+'"\x3e'+c+'\x3c/div\x3e\x3cdiv class\x3d"source-td source-tr-action"\x3e\x3cdiv class\x3d"edit hidden"\x3e\x3c/div\x3e\x3cdiv class\x3d"delete hidden"\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d"mid-line"\x3e\x3c/div\x3e\x3c/div\x3e';
c=a.toDom(c);var d=f(".source-tr",c)[0];d.source=b;a.place(c,this.sourcesList,"last");this._bindTrEvent(d)},_bindTrEvent:function(b){this.own(l(b,["click",v,y],c.hitch(this,function(b){b.stopPropagation();var c=b.type;b=b.target||b.srcElement;var d=null;if("click"===c)a.hasClass(b,"edit")?(d=b.parentElement.parentElement,this._targetSourceId=d.source.id,this._editSourceTr(d)):a.hasClass(b,"delete")&&(d=b.parentElement.parentElement,this._targetSourceId=d.source.id,this._deleteSourceTr(d));else{var e=
null,g=null;a.hasClass(b,"edit")?(e=b,d=e.parentElement.parentElement):a.hasClass(b,"delete")?(g=b,d=g.parentElement.parentElement):a.hasClass(b,"source-tr")&&(d=b);if(e||g||d)"mouseover"===c?(a.removeClass(f(".source-td .edit",d)[0],"hidden"),a.removeClass(f(".source-td .delete",d)[0],"hidden")):"mouseout"===c&&(a.addClass(f(".source-td .edit",d)[0],"hidden"),a.addClass(f(".source-td .delete",d)[0],"hidden"))}})))},_editSourceTr:function(a){a=a.source;this._sourceType=a.type;var b={id:a.id,label:a.label,
url:a.url,filter:a.filter,filterByExtent:a.filterByExtent,isDynamic:a.isDynamic,resultRecordType:a.resultRecordType,refreshInterval:a.refreshInterval,dataSchema:a.dataSchema};"undefined"!==typeof a.resultRecordCount&&(b.resultRecordCount=a.resultRecordCount);"undefined"!==typeof a.portalUrl&&(b.portalUrl=a.portalUrl);"undefined"!==typeof a.itemId&&(b.itemId=a.itemId);this._createSourceConfigPopup(b)},_updateDataSourceOfAppConfig:function(a){a.id=this._targetSourceId;var b=c.clone(this.appConfig.dataSource),
d;for(d in b.dataSources)d===this._targetSourceId&&(b.dataSources[d]=a);this._updateAppConfig(b)},_deleteSourceTr:function(){var a=new g({message:this.nls.removeSourceMessage,buttons:[{label:this.nls.ok,onClick:c.hitch(this,function(){this._deleteDataSourceOfAppConfig();a.content=null;a.close()})},{label:this.nls.cancel,classNames:["jimu-btn-vacation"],onClick:c.hitch(this,function(){a.content=null;a.close()})}]})},_deleteDataSourceOfAppConfig:function(){var a=c.clone(this.appConfig.dataSource);delete a.dataSources[this._targetSourceId];
this._updateAppConfig(a)},_updateDataSettingsOfAppConfig:function(){var a={},b=c.clone(this.appConfig.dataSource),d=this.refreshIntervalDijit.getValue();"undefined"!==typeof d.minutes&&(a.unifiedRefreshInterval=d.minutes);b.settings=a;this._updateAppConfig(b)},_updateAppConfig:function(a){d.publish("dataSourceChanged",a)},_generateSourceId:function(){if(this._serviceType)return r.createDataSourceId(this._serviceType,this._layerId)},_setLayerId:function(a){a.layerInfo&&a.layerInfo.id&&(this._layerId=
a.layerInfo.id)},_initEvent:function(){this.own(l(document.body,"click",c.hitch(this,function(){this._hiddenDsOption()})));this.own(l(this.refreshIntervalDijit,"user-input-change",c.hitch(this,function(){this._isNotEmptySourceList()&&this._updateDataSettingsOfAppConfig()})));this.own(l(this.addNewDs,[v,y],c.hitch(this,function(b){b.stopPropagation();var c=b.type;f("div",this.addNewDs).forEach(function(b){a.hasClass(b,"img_add")?"mouseover"===c?a.addClass(b,"img_add_hover"):"mouseout"===c&&a.removeClass(b,
"img_add_hover"):a.hasClass(b,"text_add")&&("mouseover"===c?a.addClass(b,"text_add_hover"):"mouseout"===c&&a.removeClass(b,"text_add_hover"))}.bind(this))})))},_isNotEmptySourceList:function(){return 0<f(".source-tr",this.sourcesList).length},_isSupportStatistics:function(a){return a&&"object"===typeof a?a.advancedQueryCapabilities?!!a.advancedQueryCapabilities.supportsStatistics:!!a.supportsStatistics:!1},destroy:function(){this.refreshIntervalDijit&&this.refreshIntervalDijit.destroy();this.inherited(arguments)}})})},
"jimu/dijit/_QueryableLayerSourcePopup":function(){define("dojo/on dojo/Evented dojo/_base/lang dojo/_base/html dojo/_base/declare jimu/dijit/Popup jimu/dijit/QueryableLayerSource jimu/dijit/LoadingIndicator esri/request".split(" "),function(k,e,p,q,n,l,h,f,d){return n([l,e],{width:830,height:560,titleLabel:"",dijitArgs:null,postCreate:function(){this.inherited(arguments);q.addClass(this.domNode,"jimu-queryable-layer-source-popup");this._initFls();this._initLoading()},getSelectedRadioType:function(){return this.sourceDijit.getSelectedRadioType()},
_initFls:function(){this.sourceDijit=new h(this.dijitArgs);this.sourceDijit.placeAt(this.contentContainerNode);this.sourceDijit.startup();this.own(k(this.sourceDijit,"ok",p.hitch(this,function(c){if(0!==c.length){var a=c[0];if(a.definition)try{a.definition.name=a.name,a.definition.url=a.url,this.emit("ok",a)}catch(b){console.error(b)}else this.loading.show(),d({url:a.url,content:{f:"json"},handleAs:"json",callbackParamName:"callback"}).then(p.hitch(this,function(b){if(this.domNode){this.loading.hide();
a.definition=b;try{a.definition.name=a.name,a.definition.url=a.url,this.emit("ok",a)}catch(g){console.error(g)}}}),p.hitch(this,function(a){console.error(a);this.domNode&&this.loading.hide()}))}})));this.own(k(this.sourceDijit,"cancel",p.hitch(this,function(){try{this.emit("cancel")}catch(c){console.error(c)}})))},_initLoading:function(){this.loading=new f({hidden:!0});this.loading.placeAt(this.domNode);this.loading.startup()}})})},"jimu/dijit/QueryableLayerSource":function(){define("dojo/on dojo/Evented dojo/_base/lang dojo/_base/html dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/QueryableLayerSource.html jimu/dijit/RadioBtn jimu/dijit/_QueryableLayerChooserWithButtons jimu/dijit/QueryableServiceChooserFromPortal jimu/dijit/_QueryableServiceChooserContent jimu/portalUrlUtils".split(" "),
function(k,e,p,q,n,l,h,f,d,c,a,b,g,u){return n([l,h,f,e],{templateString:d,baseClass:"jimu-layer-source jimu-queryable-layer-source",declaredClass:"jimu.dijit.QueryableLayerSource",nls:null,multiple:!1,createMapResponse:null,mustSupportStatistics:!1,portalUrl:null,postMixInProperties:function(){this.nls=window.jimuNls.queryableLayerSource;this.portalUrl=u.getStandardPortalUrl(this.portalUrl)},postCreate:function(){this.inherited(arguments);this._initSelf()},getSelectedRadioType:function(){if(this.mapRadio.checked)return"map";
if(this.portalRadio.checked)return"portal";if(this.urlRadio.checked)return"url"},getSelectedItems:function(){var a=[];this.mapRadio.checked?a=this.queryableLayerChooserFromMap.getSelectedItems():this.portalRadio.checked?a=this.queryableServiceChooserFromPortal.getSelectedItems():this.urlRadio.checked&&(a=this.queryableServiceChooserContent.getSelectedItems());return a},startup:function(){this.inherited(arguments);this.queryableLayerChooserFromMap.startup();this.queryableServiceChooserFromPortal.startup();
this.queryableServiceChooserContent.startup()},_initSelf:function(){this._initRadios();this._createQueryableLayerChooserWithButtons();this._createQueryableServiceChooserFromPortal();this._createQueryableServiceChooserContent();this._onRadioClicked()},_createQueryableLayerChooserWithButtons:function(){this.queryableLayerChooserFromMap=new a({style:{width:"100%",height:"100%"},multiple:this.multiple,createMapResponse:this.createMapResponse,mustSupportStatistics:this.mustSupportStatistics,onlyShowWebMapLayers:!0});
this.queryableLayerChooserFromMap.operationTip=this.nls.selectLayer;this.queryableLayerChooserFromMap.placeAt(this.mapDijitContainer);this.own(k(this.queryableLayerChooserFromMap,"ok",p.hitch(this,function(a){a&&0<a.length&&this.emit("ok",a)})));this.own(k(this.queryableLayerChooserFromMap,"cancel",p.hitch(this,function(){this.emit("cancel")})))},_createQueryableServiceChooserFromPortal:function(){this.queryableServiceChooserFromPortal=new b({multiple:this.multiple,portalUrl:this.portalUrl,style:{width:"100%",
height:"100%"}});this.queryableServiceChooserFromPortal.operationTip=this.nls.chooseItem;this.queryableServiceChooserFromPortal.placeAt(this.portalDijitContainer);this.own(k(this.queryableServiceChooserFromPortal,"next",p.hitch(this,function(){this.queryableServiceChooserFromPortal.operationTip=this.nls.chooseItem+" -\x3e "+this.nls.chooseLayer;this._updateOperationTip()})));this.own(k(this.queryableServiceChooserFromPortal,"back",p.hitch(this,function(){this.queryableServiceChooserFromPortal.operationTip=
this.nls.chooseItem;this._updateOperationTip()})));this.own(k(this.queryableServiceChooserFromPortal,"ok",p.hitch(this,function(a){a&&0<a.length&&this.emit("ok",a)})));this.own(k(this.queryableServiceChooserFromPortal,"cancel",p.hitch(this,function(){this.emit("cancel")})));0<=(this.portalUrl||"").toLowerCase().indexOf(".arcgis.com")?this.portalLabel.innerHTML=this.nls.selectFromOnline:this.portalLabel.innerHTML=this.nls.selectFromPortal},_createQueryableServiceChooserContent:function(){this.queryableServiceChooserContent=
new g({multiple:this.multiple,style:{width:"100%",height:"100%"}});this.queryableServiceChooserContent.operationTip=this.nls.setServiceUrl;this.queryableServiceChooserContent.placeAt(this.urlDijitContainer);this.own(k(this.queryableServiceChooserContent,"ok",p.hitch(this,function(a){a&&0<a.length&&this.emit("ok",a)})));this.own(k(this.queryableServiceChooserContent,"cancel",p.hitch(this,function(){this.emit("cancel")})))},_initRadios:function(){var a="queryableLayerSourceRadios_"+this._getRandomString(),
b=p.hitch(this,this._onRadioClicked);this.mapRadio=new c({group:a,onStateChange:b,checked:!0});this.mapRadio.placeAt(this.mapTd,"first");this.portalRadio=new c({group:a,onStateChange:b,checked:!1});this.portalRadio.placeAt(this.portalTd,"first");this.urlRadio=new c({group:a,onStateChange:b,checked:!1});this.urlRadio.placeAt(this.urlTd,"first");this.own(k(this.mapLabel,"click",p.hitch(this,function(){this.mapRadio.check()})));this.own(k(this.portalLabel,"click",p.hitch(this,function(){this.portalRadio.check()})));
this.own(k(this.urlLabel,"click",p.hitch(this,function(){this.urlRadio.check()})))},_getRandomString:function(){var a=Math.random().toString();return a=a.slice(2,a.length)},_onRadioClicked:function(){q.setStyle(this.mapDijitContainer,"display","none");q.setStyle(this.portalDijitContainer,"display","none");q.setStyle(this.urlDijitContainer,"display","none");this.mapRadio.checked?(q.setStyle(this.mapDijitContainer,"display","block"),this.operationTip.innerHTML=this.nls.selectLayer):this.portalRadio.checked?
(q.setStyle(this.portalDijitContainer,"display","block"),this.operationTip.innerHTML=this.nls.chooseItem):this.urlRadio.checked&&(q.setStyle(this.urlDijitContainer,"display","block"),this.operationTip.innerHTML=this.nls.setServiceUrl);this._updateOperationTip()},_updateOperationTip:function(){this.mapRadio.checked?this.operationTip.innerHTML=this.queryableLayerChooserFromMap.operationTip:this.portalRadio.checked?this.operationTip.innerHTML=this.queryableServiceChooserFromPortal.operationTip:this.urlRadio.checked&&
(this.operationTip.innerHTML=this.queryableServiceChooserContent.operationTip)}})})},"jimu/dijit/RadioBtn":function(){define("dojo/_base/declare dijit/_WidgetBase dojo/_base/lang dojo/_base/array dojo/on dojo/dom-class dojo/dom-construct dijit/registry".split(" "),function(k,e,p,q,n,l,h,f){return k(e,{baseClass:"jimu-radio",declaredClass:"jimu.dijit.RadioBtn",checked:!1,group:null,constructor:function(){},postCreate:function(){h.create("div",{"class":"jimu-radio-inner"},this.domNode);this.checked&&
l.add(this.domNode,"jimu-radio-checked");this.own(n(this.domNode,"click",p.hitch(this,function(){this.checked||this.check()})))},check:function(d){void 0===d&&(d=!0);this.checked=!0;l.add(this.domNode,"jimu-radio-checked");d&&this._changeOthersState(!1);this.onStateChange()},uncheck:function(d){void 0===d&&(d=!0);this.checked=!1;l.remove(this.domNode,"jimu-radio-checked");d&&this._changeOthersState(!1);this.onStateChange()},_changeOthersState:function(d){null!==this.group&&q.forEach(f.toArray(),function(c){c.id!==
this.id&&c["class"]===this["class"]&&c.group===this.group&&(d?c.check(!1):c.uncheck(!1))},this)},onStateChange:function(){}})})},"jimu/dijit/_QueryableLayerChooserWithButtons":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/_base/lang dojo/_base/html dojo/on dojo/Evented jimu/dijit/QueryableLayerChooserFromMap".split(" "),function(k,e,p,q,n,l,h,f,d){return k([e,p,q,f],{baseClass:"jimu-layer-chooser-with-buttons jimu-queryable-layer-chooser-with-buttons",
declaredClass:"jimu.dijit.QueryableLayerChooserWithButtons",templateString:'\x3cdiv\x3e\x3cdiv class\x3d"chooser-container" data-dojo-attach-point\x3d"chooserContainer"\x3e\x3c/div\x3e\x3cdiv class\x3d"footer"\x3e\x3cdiv class\x3d"jimu-btn jimu-float-trailing cancel jimu-btn-vacation" data-dojo-attach-point\x3d"btnCancel"\x3e${nls.cancel}\x3c/div\x3e\x3cdiv class\x3d"jimu-btn jimu-float-trailing ok jimu-trailing-margin1 jimu-state-disabled" data-dojo-attach-point\x3d"btnOk"\x3e${nls.ok}\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e',
constructor:function(c){this.options=c},postMixInProperties:function(){this.nls=n.clone(window.jimuNls.common)},postCreate:function(){this.inherited(arguments);this.queryableLayerChooserFromMap=new d(this.options);this.queryableLayerChooserFromMap.placeAt(this.chooserContainer);l.setStyle(this.queryableLayerChooserFromMap.domNode,{width:"100%",height:"100%"});this.own(h(this.queryableLayerChooserFromMap,"tree-click",n.hitch(this,function(){0<this.getSelectedItems().length?l.removeClass(this.btnOk,
"jimu-state-disabled"):l.addClass(this.btnOk,"jimu-state-disabled")})));this.own(h(this.btnOk,"click",n.hitch(this,function(){var c=this.getSelectedItems();0<c.length&&this.emit("ok",c)})));this.own(h(this.btnCancel,"click",n.hitch(this,function(){this.emit("cancel")})))},getSelectedItems:function(){return this.queryableLayerChooserFromMap.getSelectedItems()},startup:function(){this.inherited(arguments);this.queryableLayerChooserFromMap.startup()}})})},"jimu/dijit/QueryableLayerChooserFromMap":function(){define(["dojo/_base/lang",
"dojo/_base/html","dojo/_base/declare","./LayerChooserFromMap"],function(k,e,p,q){return p([q],{baseClass:"jimu-queryable-layer-chooser-from-map",declaredClass:"jimu.dijit.QueryableLayerChooserFromMap",showImageLayer:!0,mustSupportStatistics:!1,ignoreVirtualLayer:!1,postMixInProperties:function(){this.inherited(arguments);this.filter=this.showImageLayer?q.createQueryableLayerFilter(this.mustSupportStatistics):q.createFeaturelayerFilter(["point","polyline","polygon"],!1,!0,this.mustSupportStatistics);
this.ignoreVirtualLayer&&(this.filter=q.andCombineFilters([this.filter,k.hitch(this,this._ignoreVirtualLayerFilter)]))},_ignoreVirtualLayerFilter:function(e){return e.getLayerType().then(function(e){return!("ArcGISDynamicMapServiceLayer"===e||"ArcGISTiledMapServiceLayer"===e||"GroupLayer"===e)})},postCreate:function(){this.inherited(arguments);e.addClass(this.domNode,"jimu-basic-layer-chooser-from-map")},getHandledItem:function(e){var k=this.inherited(arguments),h=e&&e.layerInfo,h=h&&h.layerObject;
k.url=h&&h.url||"";return k}})})},"jimu/dijit/LayerChooserFromMap":function(){define("dojo/on dojo/Evented dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/store/Memory dojo/Deferred dojo/store/Observable dijit/tree/ObjectStoreModel dojo/promise/all dojo/_base/lang dojo/_base/html dojo/_base/array jimu/utils jimu/dijit/_Tree jimu/LayerInfos/LayerInfos jimu/dijit/LoadingIndicator".split(" "),function(k,e,p,q,n,l,h,f,d,c,a,b,g,u,m,r,t,v){var y=p([q,n,l,e],
{templateString:'\x3cdiv style\x3d"width:100%;"\x3e\x3cdiv data-dojo-attach-point\x3d"errorTipSection" class\x3d"error-tip-section"\x3e\x3cspan class\x3d"jimu-icon jimu-icon-error"\x3e\x3c/span\x3e\x3cspan class\x3d"jimu-state-error-text" data-dojo-attach-point\x3d"errTip"\x3e${nls.noLayersTip}\x3c/span\x3e\x3c/div\x3e\x3c/div\x3e',_store:null,_id:0,_treeClass:"layer-chooser-tree",createMapResponse:null,multiple:!1,onlyShowVisible:!1,updateWhenLayerInfosIsShowInMapChanged:!1,onlyShowWebMapLayers:!1,
displayTooltipForTreeNode:!1,postMixInProperties:function(){this.nls=window.jimuNls.basicLayerChooserFromMap},postCreate:function(){this.inherited(arguments);g.addClass(this.domNode,"jimu-basic-layer-chooser-from-map");this.multiple=!!this.multiple;this.shelter=new v({hidden:!0});this.shelter.placeAt(this.domNode);this.shelter.startup();this._createTree();this.basicFilter=b.hitch(this,this.basicFilter);this.filter=y.andCombineFilters([this.basicFilter,this.filter]);this.createMapResponse&&this.setCreateMapResponse(this.createMapResponse)},
basicFilter:function(a){var b=new f;this.onlyShowVisible?b.resolve(a.isShowInMap()):b.resolve(!0);return b},filter:function(a){a=new f;a.resolve(!0);return a},getSelectedItems:function(){var a=this.tree.getSelectedItems();return u.map(a,b.hitch(this,function(a){return this.getHandledItem(a)}))},getAllItems:function(){var a=this.tree.getAllItems(),c=[];u.forEach(a,b.hitch(this,function(a){"root"!==a.id&&(a=this.getHandledItem(a),c.push(a))}));return c},getHandledItem:function(a){return{name:a.name,
layerInfo:a.layerInfo}},_isLeafItem:function(a){return a.isLeaf},setCreateMapResponse:function(a){this.createMapResponse=a;t.getInstance(this.createMapResponse.map,this.createMapResponse.itemInfo).then(b.hitch(this,function(a){this.layerInfosObj=a;this.own(k(this.layerInfosObj,"layerInfosChanged",b.hitch(this,this._onLayerInfosChanged)));this.updateWhenLayerInfosIsShowInMapChanged&&this.own(k(this.layerInfosObj,"layerInfosIsShowInMapChanged",b.hitch(this,this._onLayerInfosIsShowInMapChanged)));this._buildTree(this.layerInfosObj)}))},
_onLayerInfosChanged:function(a,b){this._buildTree(this.layerInfosObj);this.emit("update")},_onLayerInfosIsShowInMapChanged:function(a){this._buildTree(this.layerInfosObj);this.emit("update")},_buildTree:function(a){this._clear();g.setStyle(this.errorTipSection,"display","block");var c=[];this.onlyShowWebMapLayers?(c=a.getLayerInfoArrayOfWebmap(),c=c.concat(a.getTableInfoArrayOfWebmap())):(c=a.getLayerInfoArray(),c=c.concat(a.getTableInfoArray()));0!==c.length&&(g.setStyle(this.errorTipSection,"display",
"none"),u.forEach(c,b.hitch(this,function(a){this._addDirectLayerInfo(a)})))},_addDirectLayerInfo:function(a){a&&a.getLayerObject().then(b.hitch(this,function(){this._addItem("root",a)}),b.hitch(this,function(a){console.error(a)}))},_clear:function(){var a=this._store.query({parent:"root"});u.forEach(a,b.hitch(this,function(a){a&&"root"!==a.id&&this._store.remove(a.id)}))},_addItem:function(c,d){var e=null,f=d.getLayerType(),g=this.filter(d);a({layerType:f,valid:g}).then(b.hitch(this,function(f){if(f.valid){var g=
b.hitch(this,function(a,b){this._id++;e={name:d.title||"",parent:c,layerInfo:d,type:f.layerType,layerClass:d.layerObject.declaredClass,id:this._id.toString(),isLeaf:a,hasChildren:b};this._store.add(e)}),h=d.getSubLayers(),m=0===h.length;m?g(m,!1):(h=u.map(h,b.hitch(this,function(a){return this.filter(a)})),a(h).then(b.hitch(this,function(a){(a=u.some(a,function(a){return a}))&&g(m,a)})))}}))},_getRootItem:function(){return{id:"root",name:"Map Root",type:"root",isLeaf:!1,hasChildren:!0}},_createTree:function(){var a=
this._getRootItem(),a=new h({data:[a],getChildren:function(a){return this.query({parent:a.id})}});this._store=new d(a);a=new c({store:this._store,query:{id:"root"},mayHaveChildren:b.hitch(this,this._mayHaveChildren)});this.tree=new r({multiple:this.multiple,model:a,showRoot:!1,isLeafItem:b.hitch(this,this._isLeafItem),style:{width:"100%"},onOpen:b.hitch(this,function(a,b){"root"!==a.id&&this._onTreeOpen(a,b)}),onClick:b.hitch(this,function(a,b,c){this._onTreeClick(a,b,c);this.emit("tree-click",a,
b,c)}),getIconStyle:b.hitch(this,function(a,b){var c=null;if(!a||"root"===a.id)return null;var d={width:"20px",height:"20px",backgroundRepeat:"no-repeat",backgroundPosition:"center center",backgroundImage:""},e=window.location.protocol+"//"+window.location.host+require.toUrl("jimu");if(a=this._getIconImageName(a,b))d.backgroundImage="url("+e+"/css/images/"+a+")",c=d;return c}),getTooltip:b.hitch(this,function(a){return this.displayTooltipForTreeNode?a.layerInfo.title:""})});g.addClass(this.tree.domNode,
this._treeClass);this.tree.placeAt(this.shelter.domNode,"before")},_mayHaveChildren:function(a){return a.hasChildren},_getIconImageName:function(a,b){var c="";"ArcGISDynamicMapServiceLayer"===a.type||"ArcGISTiledMapServiceLayer"===a.type?c=b?"mapserver_open.png":"mapserver_close.png":"GroupLayer"===a.type?c=b?"group_layer2.png":"group_layer1.png":"FeatureLayer"===a.type?(a=m.getTypeByGeometryType(a.layerInfo.layerObject.geometryType),"point"===a?c="point_layer1.png":"polyline"===a?c="line_layer1.png":
"polygon"===a&&(c="polygon_layer1.png")):c="Table"===a.type?"table.png":"ArcGISImageServiceLayer"===a.type||"ArcGISImageServiceVectorLayer"===a.type?"image_layer.png":b?"mapserver_open.png":"mapserver_close.png";return c},_onTreeOpen:function(c,d){if("root"!==c.id){var e=[];d=[];e=c.layerInfo.getSubLayers();c.checked||(this.shelter.show(),d=u.map(e,b.hitch(this,function(a){return a.getLayerObject()})),a(d).then(b.hitch(this,function(){this.domNode&&(u.forEach(e,b.hitch(this,function(a){this._addItem(c.id,
a)})),c.checked=!0,this.shelter.hide())}),b.hitch(this,function(a){console.error(a);this.shelter.hide()})))}},_onTreeClick:function(a,b,c){},destroy:function(){this.shelter&&(this.shelter.destroy(),this.shelter=null);this.tree&&this.tree.destroy();this.inherited(arguments)}});y.createFilterByLayerType=function(c){b.isArrayLike(c)||(c=[]);return function(b){var d=new f;if(0===c.length)d.resolve(!0);else{var e=[];b.traversal(function(a){e.push(a.getLayerType())});a(e).then(function(a){for(var b=0;b<
a.length;b++)for(var e=0;e<c.length;e++)if(a[b]===c[e]){d.resolve(!0);return}d.resolve(!1)},function(a){console.error(a);d.reject(a)})}return d}};y.createFeaturelayerFilter=function(b,c,d,e){var f=["point","polyline","polygon"];b&&0<b.length?(b=u.filter(b,function(a){return 0<=f.indexOf(a)}),0===b.length&&(b=f)):b=f;return function(f){var g=f.getLayerType();f=f.getLayerObject();return a({layerType:g,layerObject:f}).then(function(a){var f=a.layerType;a=a.layerObject;if("ArcGISDynamicMapServiceLayer"===
f||"ArcGISTiledMapServiceLayer"===f||"GroupLayer"===f||"FeatureCollection"===f)return!0;if("FeatureLayer"===f){var f=m.getTypeByGeometryType(a.geometryType),f=0<=u.indexOf(b,f),g=y._shouldPassStatisticsCheck(e,a);return a.url?(a=m.isFeaturelayerUrlSupportQuery(a.url,a.capabilities),f&&a&&g):c&&f}return"Table"===f?(f=m.isFeaturelayerUrlSupportQuery(a.url,a.capabilities),a=y._shouldPassStatisticsCheck(e,a),d&&f&&a):!1})}};y.createImageServiceLayerFilter=function(b,c){return function(d){var e=d.getLayerType();
d=d.getLayerObject();return a({layerType:e,layerObject:d}).then(function(a){var d=a.layerType,e=a.layerObject;return"ArcGISImageServiceLayer"===d||"ArcGISImageServiceVectorLayer"===d?b?m.isImageServiceSupportQuery(a.layerObject.capabilities)?c?y._shouldPassStatisticsCheck(c,e):!0:!1:!0:!1})}};y._shouldPassStatisticsCheck=function(a,b){return a?(a=!1,a=b.advancedQueryCapabilities?!!b.advancedQueryCapabilities.supportsStatistics:!!b.supportsStatistics):!0};y.createQueryableLayerFilter=function(a){var b=
y.createFeaturelayerFilter(["point","polyline","polygon"],!1,!0,a);a=y.createImageServiceLayerFilter(!0,a);return y.orCombineFilters([b,a])};y.andCombineFilters=function(a){return y._combineFilters(a,!0)};y.orCombineFilters=function(a){return y._combineFilters(a,!1)};y._combineFilters=function(b,c){return function(d){var e=new f,g=u.map(b,function(a){return a(d)});a(g).then(function(a){var b=!1,b=c?u.every(a,function(a){return a}):u.some(a,function(a){return a});e.resolve(b)},function(a){console.error(a);
e.reject(a)});return e}};return y})},"dojo/store/Observable":function(){define(["../_base/kernel","../_base/lang","../when","../_base/array"],function(k,e,p,q){k=function(k){function l(a,b){var d=k[a];d&&(k[a]=function(e){var f;"put"===a&&(f=k.getIdentity(e));if(c)return d.apply(this,arguments);c=!0;try{var g=d.apply(this,arguments);p(g,function(a){b("object"==typeof a&&a||e,f)});return g}finally{c=!1}})}var h=[],f=0;k=e.delegate(k);k.notify=function(a,b){f++;for(var c=h.slice(),d=0,e=c.length;d<
e;d++)c[d](a,b)};var d=k.query;k.query=function(a,b){b=b||{};var c=d.apply(this,arguments);if(c&&c.forEach){var l=e.mixin({},b);delete l.start;delete l.count;var m=k.queryEngine&&k.queryEngine(a,l),n=f,t=[],v;c.observe=function(a,d){1==t.push(a)&&h.push(v=function(a,e){p(c,function(c){var g=c.length!=b.count,h,l;if(++n!=f)throw Error("Query is out of date, you must observe() the query prior to any data modifications");var p,r=-1,u=-1;if(void 0!==e){var v=[].concat(c);m&&!a&&(v=m(c));h=0;for(l=c.length;h<
l;h++){var w=c[h];if(k.getIdentity(w)==e&&!(0>v.indexOf(w))){p=w;r=h;!m&&a||c.splice(h,1);break}}}m?a&&(m.matches?m.matches(a):m([a]).length)&&(h=-1<r?r:c.length,c.splice(h,0,a),u=q.indexOf(m(c),a),c.splice(h,1),b.start&&0==u||!g&&u==c.length?u=-1:c.splice(u,0,a)):a&&(void 0!==e?u=r:b.start||(u=k.defaultIndex||0,c.splice(u,0,a)));if((-1<r||-1<u)&&(d||!m||r!=u))for(g=t.slice(),h=0;c=g[h];h++)c(a||p,r,u)})});var e={};e.remove=e.cancel=function(){var b=q.indexOf(t,a);-1<b&&(t.splice(b,1),t.length||h.splice(q.indexOf(h,
v),1))};return e}}return c};var c;l("put",function(a,b){k.notify(a,b)});l("add",function(a){k.notify(a)});l("remove",function(a){k.notify(void 0,a)});return k};e.setObject("dojo.store.Observable",k);return k})},"dijit/tree/ObjectStoreModel":function(){define("dojo/_base/array dojo/aspect dojo/_base/declare dojo/Deferred dojo/_base/lang dojo/when ../Destroyable".split(" "),function(k,e,p,q,n,l,h){return p("dijit.tree.ObjectStoreModel",h,{store:null,labelAttr:"name",labelType:"text",root:null,query:null,
constructor:function(e){n.mixin(this,e);this.childrenCache={}},getRoot:function(e,d){if(this.root)e(this.root);else{var c=this.store.query(this.query);c.then&&this.own(c);l(c,n.hitch(this,function(a){if(1!=a.length)throw Error("dijit.tree.ObjectStoreModel: root query returned "+a.length+" items, but must return exactly one");this.root=a[0];e(this.root);c.observe&&c.observe(n.hitch(this,function(a){this.onChange(a)}),!0)}),d)}},mayHaveChildren:function(){return!0},getChildren:function(e,d,c){var a=
this.store.getIdentity(e);if(this.childrenCache[a])l(this.childrenCache[a],d,c);else{var b=this.childrenCache[a]=this.store.getChildren(e);b.then&&this.own(b);b.observe&&this.own(b.observe(n.hitch(this,function(a,c,d){this.onChange(a);c!=d&&l(b,n.hitch(this,"onChildrenChange",e))}),!0));l(b,d,c)}},isItem:function(){return!0},getIdentity:function(e){return this.store.getIdentity(e)},getLabel:function(e){return e[this.labelAttr]},newItem:function(e,d,c,a){return this.store.put(e,{parent:d,before:a})},
pasteItem:function(e,d,c,a,b,g){var f=new q;if(d===c&&!a&&!g)return f.resolve(!0),f;d&&!a?this.getChildren(d,n.hitch(this,function(a){a=[].concat(a);var b=k.indexOf(a,e);a.splice(b,1);this.onChildrenChange(d,a);f.resolve(this.store.put(e,{overwrite:!0,parent:c,oldParent:d,before:g}))})):f.resolve(this.store.put(e,{overwrite:!0,parent:c,oldParent:d,before:g}));return f},onChange:function(){},onChildrenChange:function(){},onDelete:function(){}})})},"jimu/dijit/_Tree":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dojo/text!./templates/_TreeNode.html dojo/_base/lang dojo/_base/html dojo/_base/array dojo/_base/event dojo/query dojo/aspect dojo/on dojo/Evented dijit/registry dijit/Tree jimu/utils".split(" "),
function(k,e,p,q,n,l,h,f,d,c,a,b,g,u,m){var r=k([u._TreeNode,b],{templateString:q,declaredClass:"jimu._TreeNode",isLeaf:!1,groupId:"",postCreate:function(){this.inherited(arguments);l.addClass(this.domNode,"jimu-tree-node");this.isLeaf=!!this.isLeaf;this.groupId?(this.checkNode=l.toDom('\x3cinput type\x3d"radio" /\x3e'),this.checkNode.name=this.groupId):this.checkNode=l.toDom('\x3cinput type\x3d"checkbox" /\x3e');l.addClass(this.checkNode,"jimu-tree-check-node");l.place(this.checkNode,this.contentNode,
"first");this.own(a(this.checkNode,"click",n.hitch(this,this._onClick)));this.isLeaf?this.groupId?l.setStyle(this.checkNode,"display","none"):l.setStyle(this.checkNode,"display","inline"):l.setStyle(this.checkNode,"display","none");this.isLeaf?l.addClass(this.domNode,"jimu-tree-leaf-node"):l.addClass(this.domNode,"jimu-tree-not-leaf-node")},select:function(){this.isLeaf&&(this.checkNode.checked=!0,l.addClass(this.domNode,"jimu-tree-selected-leaf-node"))},unselect:function(){this.isLeaf&&(this.checkNode.checked=
!1,l.removeClass(this.domNode,"jimu-tree-selected-leaf-node"))},toggleSelect:function(){this.isLeaf&&(this.checkNode.checked?this.unselect():this.select())},_onClick:function(a){(a.target||a.srcElement)===this.checkNode?this.tree._onCheckNodeClick(this,this.checkNode.checked,a):this.tree._onClick(this,a)},_onChange:function(){this.isLeaf&&setTimeout(n.hitch(this,function(){this.checkNode.checked?this.emit("tn-select",this):this.emit("tn-unselect",this)}),100)},destroy:function(){delete this.tree;
this.inherited(arguments)}});return k([u,b],{declaredClass:"jimu._Tree",openOnClick:!0,multiple:!0,uniqueId:"",showRoot:!1,postMixInProperties:function(){this.inherited(arguments);this.uniqueId="tree_"+m.getRandomString()},postCreate:function(){this.inherited(arguments);l.addClass(this.domNode,"jimu-tree");this.own(c.before(this,"onClick",n.hitch(this,this._jimuBeforeClick)));this.rootLoadingIndicator&&l.setStyle(this.rootLoadingIndicator,"display","none");this.dndController.singular=!0},removeItem:function(a){this.model.store.remove(a)},
getAllItems:function(){var a=this.getAllTreeNodeWidgets();return h.map(a,n.hitch(this,function(a){var b=a.item;b.selected=a.checkNode.checked;return b}))},getSelectedItems:function(){var a=this.getAllTreeNodeWidgets(),a=h.filter(a,n.hitch(this,function(a){return a.checkNode.checked}));return h.map(a,n.hitch(this,function(a){return a.item}))},getFilteredItems:function(a){var b=this.getAllTreeNodeWidgets(),b=h.map(b,n.hitch(this,function(a){var b=a.item;b.selected=a.checkNode.checked;return b}));return h.filter(b,
n.hitch(this,function(b){return a(b)}))},getTreeNodeByItemId:function(a){for(var b=this._getAllTreeNodeDoms(),c=0;c<b.length;c++){var d=g.byNode(b[c]);if(d.item.id.toString()===a.toString())return d}return null},selectItem:function(a){(a=this.getTreeNodeByItemId(a))&&a.isLeaf&&this.selectNodeWidget(a)},unselectItem:function(a){(a=this.getTreeNodeByItemId(a))&&a.isLeaf&&a.unselect()},getAllLeafTreeNodeWidgets:function(){var a=this.getAllTreeNodeWidgets();return h.filter(a,n.hitch(this,function(a){return a.isLeaf}))},
getAllTreeNodeWidgets:function(){var a=this._getAllTreeNodeDoms();return h.map(a,n.hitch(this,function(a){return g.byNode(a)}))},isLeafItem:function(a){return a&&a.isLeaf},_getAllTreeNodeDoms:function(){return d(".dijitTreeNode",this.domNode)},_createTreeNode:function(a){a.isLeaf=this.isLeafItem(a.item);this.multiple||(a.groupId=this.uniqueId);return new r(a)},_onTreeNodeSelect:function(a){this.emit("item-select",{item:a.item,treeNode:a})},_onTreeNodeUnselect:function(a){this.emit("item-unselect",
{item:a.item,treeNode:a})},selectNodeWidget:function(a){this.multiple||this.unselectAllLeafNodeWidgets();a.select()},_jimuBeforeClick:function(a,b,c){b.isLeaf&&(l.hasClass(c.target||c.srcElement,"jimu-tree-check-node")||(this.multiple?b.toggleSelect():this.selectNodeWidget(b)));return arguments},_onCheckNodeClick:function(a,b,c){!this.multiple&&b&&this.unselectAllLeafNodeWidgets();f.stop(c);this.focusNode(a);setTimeout(n.hitch(this,function(){b?this.selectNodeWidget(a):a.unselect();this.onClick(a.item,
a,c)}),0)},unselectAllLeafNodeWidgets:function(){var a=this.getAllLeafTreeNodeWidgets();h.forEach(a,n.hitch(this,function(a){a.unselect()}))}})})},"dijit/Tree":function(){define("dojo/_base/array dojo/aspect dojo/cookie dojo/_base/declare dojo/Deferred dojo/promise/all dojo/dom dojo/dom-class dojo/dom-geometry dojo/dom-style dojo/errors/create dojo/fx dojo/has dojo/_base/kernel dojo/keys dojo/_base/lang dojo/on dojo/topic dojo/touch dojo/when ./a11yclick ./focus ./registry ./_base/manager ./_Widget ./_TemplatedMixin ./_Container ./_Contained ./_CssStateMixin ./_KeyNavMixin dojo/text!./templates/TreeNode.html dojo/text!./templates/Tree.html ./tree/TreeStoreModel ./tree/ForestStoreModel ./tree/_dndSelector dojo/query!css2".split(" "),
function(k,e,p,q,n,l,h,f,d,c,a,b,g,u,m,r,t,v,y,w,z,x,A,C,B,E,D,F,I,M,L,J,P,K,U){function O(a){return r.delegate(a.promise||a,{addCallback:function(a){this.then(a)},addErrback:function(a){this.otherwise(a)}})}var S=q("dijit._TreeNode",[B,E,D,F,I],{item:null,isTreeNode:!0,label:"",_setLabelAttr:function(a){this.labelNode["html"==this.labelType?"innerHTML":"innerText"in this.labelNode?"innerText":"textContent"]=a;this._set("label",a);g("dojo-bidi")&&this.applyTextDir(this.labelNode)},labelType:"text",
isExpandable:null,isExpanded:!1,state:"NotLoaded",templateString:L,baseClass:"dijitTreeNode",cssStateNodes:{rowNode:"dijitTreeRow"},_setTooltipAttr:{node:"rowNode",type:"attribute",attribute:"title"},buildRendering:function(){this.inherited(arguments);this._setExpando();this._updateItemClasses(this.item);this.isExpandable&&this.labelNode.setAttribute("aria-expanded",this.isExpanded);this.setSelected(!1)},_setIndentAttr:function(a){var b=Math.max(a,0)*this.tree._nodePixelIndent+"px";c.set(this.domNode,
"backgroundPosition",b+" 0px");c.set(this.rowNode,this.isLeftToRight()?"paddingLeft":"paddingRight",b);k.forEach(this.getChildren(),function(b){b.set("indent",a+1)});this._set("indent",a)},markProcessing:function(){this.state="Loading";this._setExpando(!0)},unmarkProcessing:function(){this._setExpando(!1)},_updateItemClasses:function(a){var b=this.tree,c=b.model;b._v10Compat&&a===c.root&&(a=null);this._applyClassAndStyle(a,"icon","Icon");this._applyClassAndStyle(a,"label","Label");this._applyClassAndStyle(a,
"row","Row");this.tree._startPaint(!0)},_applyClassAndStyle:function(a,b,d){var e="_"+b+"Class";b+="Node";var g=this[e];this[e]=this.tree["get"+d+"Class"](a,this.isExpanded);f.replace(this[b],this[e]||"",g||"");c.set(this[b],this.tree["get"+d+"Style"](a,this.isExpanded)||{})},_updateLayout:function(){var a=this.getParent(),a=!a||!a.rowNode||"none"==a.rowNode.style.display;f.toggle(this.domNode,"dijitTreeIsRoot",a);f.toggle(this.domNode,"dijitTreeIsLast",!a&&!this.getNextSibling())},_setExpando:function(a){var b=
["dijitTreeExpandoLoading","dijitTreeExpandoOpened","dijitTreeExpandoClosed","dijitTreeExpandoLeaf"];a=a?0:this.isExpandable?this.isExpanded?1:2:3;f.replace(this.expandoNode,b[a],b);this.expandoNodeText.innerHTML=["*","-","+","*"][a]},expand:function(){if(this._expandDeferred)return O(this._expandDeferred);this._collapseDeferred&&(this._collapseDeferred.cancel(),delete this._collapseDeferred);this.isExpanded=!0;this.labelNode.setAttribute("aria-expanded","true");(this.tree.showRoot||this!==this.tree.rootNode)&&
this.containerNode.setAttribute("role","group");f.add(this.contentNode,"dijitTreeContentExpanded");this._setExpando();this._updateItemClasses(this.item);this==this.tree.rootNode&&this.tree.showRoot&&this.tree.domNode.setAttribute("aria-expanded","true");var a=b.wipeIn({node:this.containerNode,duration:C.defaultDuration}),c=this._expandDeferred=new n(function(){a.stop()});e.after(a,"onEnd",function(){c.resolve(!0)},!0);a.play();return O(c)},collapse:function(){if(this._collapseDeferred)return O(this._collapseDeferred);
this._expandDeferred&&(this._expandDeferred.cancel(),delete this._expandDeferred);this.isExpanded=!1;this.labelNode.setAttribute("aria-expanded","false");this==this.tree.rootNode&&this.tree.showRoot&&this.tree.domNode.setAttribute("aria-expanded","false");f.remove(this.contentNode,"dijitTreeContentExpanded");this._setExpando();this._updateItemClasses(this.item);var a=b.wipeOut({node:this.containerNode,duration:C.defaultDuration}),c=this._collapseDeferred=new n(function(){a.stop()});e.after(a,"onEnd",
function(){c.resolve(!0)},!0);a.play();return O(c)},indent:0,setChildItems:function(a){var b=this.tree,c=b.model,d=[],e=b.focusedChild,f=this.getChildren();k.forEach(f,function(a){D.prototype.removeChild.call(this,a)},this);this.defer(function(){k.forEach(f,function(a){if(!a._destroyed&&!a.getParent()){var d=function(a){var e=c.getIdentity(a.item),f=b._itemNodesMap[e];1==f.length?delete b._itemNodesMap[e]:(e=k.indexOf(f,a),-1!=e&&f.splice(e,1));k.forEach(a.getChildren(),d)};b.dndController.removeTreeNode(a);
d(a);if(b.persist){var f=k.map(a.getTreePath(),function(a){return b.model.getIdentity(a)}).join("/"),g;for(g in b._openedNodes)g.substr(0,f.length)==f&&delete b._openedNodes[g];b._saveExpandedNodes()}b.lastFocusedChild&&!h.isDescendant(b.lastFocusedChild.domNode,b.domNode)&&delete b.lastFocusedChild;e&&!h.isDescendant(e.domNode,b.domNode)&&b.focus();a.destroyRecursive()}})});this.state="Loaded";a&&0<a.length?(this.isExpandable=!0,k.forEach(a,function(a){var e=c.getIdentity(a),f=b._itemNodesMap[e],
g;if(f)for(var h=0;h<f.length;h++)if(f[h]&&!f[h].getParent()){g=f[h];g.set("indent",this.indent+1);break}g||(g=this.tree._createTreeNode({item:a,tree:b,isExpandable:c.mayHaveChildren(a),label:b.getLabel(a),labelType:b.model&&b.model.labelType||"text",tooltip:b.getTooltip(a),ownerDocument:b.ownerDocument,dir:b.dir,lang:b.lang,textDir:b.textDir,indent:this.indent+1}),f?f.push(g):b._itemNodesMap[e]=[g]);this.addChild(g);(this.tree.autoExpand||this.tree._state(g))&&d.push(b._expandNode(g))},this),k.forEach(this.getChildren(),
function(a){a._updateLayout()})):this.isExpandable=!1;this._setExpando&&this._setExpando(!1);this._updateItemClasses(this.item);a=l(d);this.tree._startPaint(a);return O(a)},getTreePath:function(){for(var a=this,b=[];a&&a!==this.tree.rootNode;)b.unshift(a.item),a=a.getParent();b.unshift(this.tree.rootNode.item);return b},getIdentity:function(){return this.tree.model.getIdentity(this.item)},removeChild:function(a){this.inherited(arguments);var b=this.getChildren();0==b.length&&(this.isExpandable=!1,
this.collapse());k.forEach(b,function(a){a._updateLayout()})},makeExpandable:function(){this.isExpandable=!0;this._setExpando(!1)},setSelected:function(a){this.labelNode.setAttribute("aria-selected",a?"true":"false");f.toggle(this.rowNode,"dijitTreeRowSelected",a)},focus:function(){x.focus(this.focusNode)}});g("dojo-bidi")&&S.extend({_setTextDirAttr:function(a){!a||this.textDir==a&&this._created||(this._set("textDir",a),this.applyTextDir(this.labelNode),k.forEach(this.getChildren(),function(b){b.set("textDir",
a)},this))}});var Y=q("dijit.Tree",[B,M,E,I],{baseClass:"dijitTree",store:null,model:null,query:null,label:"",showRoot:!0,childrenAttr:["children"],paths:[],path:[],selectedItems:null,selectedItem:null,openOnClick:!1,openOnDblClick:!1,templateString:J,persist:!1,autoExpand:!1,dndController:U,dndParams:"onDndDrop itemCreator onDndCancel checkAcceptance checkItemAcceptance dragThreshold betweenThreshold".split(" "),onDndDrop:null,itemCreator:null,onDndCancel:null,checkAcceptance:null,checkItemAcceptance:null,
dragThreshold:5,betweenThreshold:0,_nodePixelIndent:19,_publish:function(a,b){v.publish(this.id,r.mixin({tree:this,event:a},b||{}))},postMixInProperties:function(){this.tree=this;this.autoExpand&&(this.persist=!1);this._itemNodesMap={};!this.cookieName&&this.id&&(this.cookieName=this.id+"SaveStateCookie");this.expandChildrenDeferred=new n;this.pendingCommandsPromise=this.expandChildrenDeferred.promise;this.inherited(arguments)},postCreate:function(){this._initState();var a=this;this.own(t(this.containerNode,
t.selector(".dijitTreeNode",y.enter),function(b){a._onNodeMouseEnter(A.byNode(this),b)}),t(this.containerNode,t.selector(".dijitTreeNode",y.leave),function(b){a._onNodeMouseLeave(A.byNode(this),b)}),t(this.containerNode,t.selector(".dijitTreeRow",z.press),function(b){a._onNodePress(A.getEnclosingWidget(this),b)}),t(this.containerNode,t.selector(".dijitTreeRow",z),function(b){a._onClick(A.getEnclosingWidget(this),b)}),t(this.containerNode,t.selector(".dijitTreeRow","dblclick"),function(b){a._onDblClick(A.getEnclosingWidget(this),
b)}));this.model||this._store2model();this.own(e.after(this.model,"onChange",r.hitch(this,"_onItemChange"),!0),e.after(this.model,"onChildrenChange",r.hitch(this,"_onItemChildrenChange"),!0),e.after(this.model,"onDelete",r.hitch(this,"_onItemDelete"),!0));this.inherited(arguments);if(this.dndController){r.isString(this.dndController)&&(this.dndController=r.getObject(this.dndController));for(var b={},c=0;c<this.dndParams.length;c++)this[this.dndParams[c]]&&(b[this.dndParams[c]]=this[this.dndParams[c]]);
this.dndController=new this.dndController(this,b)}this._load();this.onLoadDeferred=O(this.pendingCommandsPromise);this.onLoadDeferred.then(r.hitch(this,"onLoad"))},_store2model:function(){this._v10Compat=!0;u.deprecated("Tree: from version 2.0, should specify a model object rather than a store/query");var a={id:this.id+"_ForestStoreModel",store:this.store,query:this.query,childrenAttrs:this.childrenAttr};this.params.mayHaveChildren&&(a.mayHaveChildren=r.hitch(this,"mayHaveChildren"));this.params.getItemChildren&&
(a.getChildren=r.hitch(this,function(a,b,c){this.getItemChildren(this._v10Compat&&a===this.model.root?null:a,b,c)}));this.model=new K(a);this.showRoot=!!this.label},onLoad:function(){},_load:function(){this.model.getRoot(r.hitch(this,function(a){var b=this.rootNode=this.tree._createTreeNode({item:a,tree:this,isExpandable:!0,label:this.label||this.getLabel(a),labelType:this.model.labelType||"text",textDir:this.textDir,indent:this.showRoot?0:-1});this.showRoot?(this.domNode.setAttribute("aria-multiselectable",
!this.dndController.singular),this.rootLoadingIndicator.style.display="none"):(b.rowNode.style.display="none",this.domNode.setAttribute("role","presentation"),this.domNode.removeAttribute("aria-expanded"),this.domNode.removeAttribute("aria-multiselectable"),this["aria-label"]?(b.containerNode.setAttribute("aria-label",this["aria-label"]),this.domNode.removeAttribute("aria-label")):this["aria-labelledby"]&&(b.containerNode.setAttribute("aria-labelledby",this["aria-labelledby"]),this.domNode.removeAttribute("aria-labelledby")),
b.labelNode.setAttribute("role","presentation"),b.labelNode.removeAttribute("aria-selected"),b.containerNode.setAttribute("role","tree"),b.containerNode.setAttribute("aria-expanded","true"),b.containerNode.setAttribute("aria-multiselectable",!this.dndController.singular));this.containerNode.appendChild(b.domNode);a=this.model.getIdentity(a);this._itemNodesMap[a]?this._itemNodesMap[a].push(b):this._itemNodesMap[a]=[b];b._updateLayout();this._expandNode(b).then(r.hitch(this,function(){this._destroyed||
(this.rootLoadingIndicator.style.display="none",this.expandChildrenDeferred.resolve(!0))}))}),r.hitch(this,function(a){console.error(this,": error loading root: ",a)}))},getNodesByItem:function(a){if(!a)return[];a=r.isString(a)?a:this.model.getIdentity(a);return[].concat(this._itemNodesMap[a])},_setSelectedItemAttr:function(a){this.set("selectedItems",[a])},_setSelectedItemsAttr:function(a){var b=this;return this.pendingCommandsPromise=this.pendingCommandsPromise.always(r.hitch(this,function(){var c=
k.map(a,function(a){return!a||r.isString(a)?a:b.model.getIdentity(a)}),d=[];k.forEach(c,function(a){d=d.concat(b._itemNodesMap[a]||[])});this.set("selectedNodes",d)}))},_setPathAttr:function(a){return a.length?O(this.set("paths",[a]).then(function(a){return a[0]})):O(this.set("paths",[]).then(function(a){return a[0]}))},_setPathsAttr:function(a){function b(a,d){var e=a.shift(),f=k.filter(d,function(a){return a.getIdentity()==e})[0];if(f)return a.length?c._expandNode(f).then(function(){return b(a,
f.getChildren())}):f;throw new Y.PathError("Could not expand path at "+e);}var c=this;return O(this.pendingCommandsPromise=this.pendingCommandsPromise.always(function(){return l(k.map(a,function(a){a=k.map(a,function(a){return a&&r.isObject(a)?c.model.getIdentity(a):a});if(a.length)return b(a,[c.rootNode]);throw new Y.PathError("Empty path");}))}).then(function(a){c.set("selectedNodes",a);return c.paths}))},_setSelectedNodeAttr:function(a){this.set("selectedNodes",[a])},_setSelectedNodesAttr:function(a){this.dndController.setSelection(a)},
expandAll:function(){function a(c){return b._expandNode(c).then(function(){var b=k.filter(c.getChildren()||[],function(a){return a.isExpandable});return l(k.map(b,a))})}var b=this;return O(a(this.rootNode))},collapseAll:function(){function a(c){var d=k.filter(c.getChildren()||[],function(a){return a.isExpandable}),d=l(k.map(d,a));return!c.isExpanded||c==b.rootNode&&!b.showRoot?d:d.then(function(){return b._collapseNode(c)})}var b=this;return O(a(this.rootNode))},mayHaveChildren:function(){},getItemChildren:function(){},
getLabel:function(a){return this.model.getLabel(a)},getIconClass:function(a,b){return!a||this.model.mayHaveChildren(a)?b?"dijitFolderOpened":"dijitFolderClosed":"dijitLeaf"},getLabelClass:function(){},getRowClass:function(){},getIconStyle:function(){},getLabelStyle:function(){},getRowStyle:function(){},getTooltip:function(){return""},_onDownArrow:function(a,b){(a=this._getNext(b))&&a.isTreeNode&&this.focusNode(a)},_onUpArrow:function(a,b){if(a=b.getPreviousSibling())for(b=a;b.isExpandable&&b.isExpanded&&
b.hasChildren();)b=b.getChildren(),b=b[b.length-1];else if(a=b.getParent(),this.showRoot||a!==this.rootNode)b=a;b&&b.isTreeNode&&this.focusNode(b)},_onRightArrow:function(a,b){b.isExpandable&&!b.isExpanded?this._expandNode(b):b.hasChildren()&&(b=b.getChildren()[0])&&b.isTreeNode&&this.focusNode(b)},_onLeftArrow:function(a,b){b.isExpandable&&b.isExpanded?this._collapseNode(b):(a=b.getParent())&&a.isTreeNode&&(this.showRoot||a!==this.rootNode)&&this.focusNode(a)},focusLastChild:function(){var a=this._getLast();
a&&a.isTreeNode&&this.focusNode(a)},_getFirst:function(){return this.showRoot?this.rootNode:this.rootNode.getChildren()[0]},_getLast:function(){for(var a=this.rootNode;a.isExpanded;){var b=a.getChildren();if(!b.length)break;a=b[b.length-1]}return a},_getNext:function(a){if(a.isExpandable&&a.isExpanded&&a.hasChildren())return a.getChildren()[0];for(;a&&a.isTreeNode;){var b=a.getNextSibling();if(b)return b;a=a.getParent()}return null},childSelector:".dijitTreeRow",isExpandoNode:function(a,b){return h.isDescendant(a,
b.expandoNode)||h.isDescendant(a,b.expandoNodeText)},_onNodePress:function(a,b){this.focusNode(a)},__click:function(a,b,c,d){var e=this.isExpandoNode(b.target,a);a.isExpandable&&(c||e)?this._onExpandoClick({node:a}):(this._publish("execute",{item:a.item,node:a,evt:b}),this[d](a.item,a,b),this.focusNode(a));b.stopPropagation();b.preventDefault()},_onClick:function(a,b){this.__click(a,b,this.openOnClick,"onClick")},_onDblClick:function(a,b){this.__click(a,b,this.openOnDblClick,"onDblClick")},_onExpandoClick:function(a){a=
a.node;this.focusNode(a);a.isExpanded?this._collapseNode(a):this._expandNode(a)},onClick:function(){},onDblClick:function(){},onOpen:function(){},onClose:function(){},_getNextNode:function(a){u.deprecated(this.declaredClass+"::_getNextNode(node) is deprecated. Use _getNext(node) instead.","","2.0");return this._getNext(a)},_getRootOrFirstNode:function(){u.deprecated(this.declaredClass+"::_getRootOrFirstNode() is deprecated. Use _getFirst() instead.","","2.0");return this._getFirst()},_collapseNode:function(a){a._expandNodeDeferred&&
delete a._expandNodeDeferred;if("Loading"!=a.state&&a.isExpanded){var b=a.collapse();this.onClose(a.item,a);this._state(a,!1);this._startPaint(b);return b}},_expandNode:function(a){if(a._expandNodeDeferred)return a._expandNodeDeferred;var b=this.model,c=a.item,d=this;a._loadDeferred||(a.markProcessing(),a._loadDeferred=new n,b.getChildren(c,function(b){a.unmarkProcessing();a.setChildItems(b).then(function(){a._loadDeferred.resolve(b)})},function(b){console.error(d,": error loading "+a.label+" children: ",
b);a._loadDeferred.reject(b)}));b=a._loadDeferred.then(r.hitch(this,function(){var b=a.expand();this.onOpen(a.item,a);this._state(a,!0);return b}));this._startPaint(b);return b},focusNode:function(a){var b=this.domNode.scrollLeft;this.focusChild(a);this.domNode.scrollLeft=b},_onNodeMouseEnter:function(){},_onNodeMouseLeave:function(){},_onItemChange:function(a){var b=this.model.getIdentity(a);if(b=this._itemNodesMap[b]){var c=this.getLabel(a),d=this.getTooltip(a);k.forEach(b,function(b){b.set({item:a,
label:c,tooltip:d});b._updateItemClasses(a)})}},_onItemChildrenChange:function(a,b){a=this.model.getIdentity(a);(a=this._itemNodesMap[a])&&k.forEach(a,function(a){a.setChildItems(b)})},_onItemDelete:function(a){a=this.model.getIdentity(a);var b=this._itemNodesMap[a];b&&(k.forEach(b,function(a){this.dndController.removeTreeNode(a);var b=a.getParent();b&&b.removeChild(a);this.lastFocusedChild&&!h.isDescendant(this.lastFocusedChild.domNode,this.domNode)&&delete this.lastFocusedChild;this.focusedChild&&
!h.isDescendant(this.focusedChild.domNode,this.domNode)&&this.focus();a.destroyRecursive()},this),delete this._itemNodesMap[a])},_initState:function(){this._openedNodes={};if(this.persist&&this.cookieName){var a=p(this.cookieName);a&&k.forEach(a.split(","),function(a){this._openedNodes[a]=!0},this)}},_state:function(a,b){if(!this.persist)return!1;var c=k.map(a.getTreePath(),function(a){return this.model.getIdentity(a)},this).join("/");if(1===arguments.length)return this._openedNodes[c];b?this._openedNodes[c]=
!0:delete this._openedNodes[c];this._saveExpandedNodes()},_saveExpandedNodes:function(){if(this.persist&&this.cookieName){var a=[],b;for(b in this._openedNodes)a.push(b);p(this.cookieName,a.join(","),{expires:365})}},destroy:function(){this._curSearch&&(this._curSearch.timer.remove(),delete this._curSearch);this.rootNode&&this.rootNode.destroyRecursive();this.dndController&&!r.isString(this.dndController)&&this.dndController.destroy();this.rootNode=null;this.inherited(arguments)},destroyRecursive:function(){this.destroy()},
resize:function(a){a&&d.setMarginBox(this.domNode,a);this._nodePixelIndent=d.position(this.tree.indentDetector).w||this._nodePixelIndent;this.expandChildrenDeferred.then(r.hitch(this,function(){this.rootNode.set("indent",this.showRoot?0:-1);this._adjustWidths()}))},_outstandingPaintOperations:0,_startPaint:function(a){this._outstandingPaintOperations++;this._adjustWidthsTimer&&(this._adjustWidthsTimer.remove(),delete this._adjustWidthsTimer);var b=r.hitch(this,function(){this._outstandingPaintOperations--;
0>=this._outstandingPaintOperations&&!this._adjustWidthsTimer&&this._started&&(this._adjustWidthsTimer=this.defer("_adjustWidths"))});w(a,b,b)},_adjustWidths:function(){this._adjustWidthsTimer&&(this._adjustWidthsTimer.remove(),delete this._adjustWidthsTimer);this.containerNode.style.width="auto";this.containerNode.style.width=this.domNode.scrollWidth>this.domNode.offsetWidth?"auto":"100%"},_createTreeNode:function(a){return new S(a)},focus:function(){this.lastFocusedChild?this.focusNode(this.lastFocusedChild):
this.focusFirstChild()}});g("dojo-bidi")&&Y.extend({_setTextDirAttr:function(a){a&&this.textDir!=a&&(this._set("textDir",a),this.rootNode.set("textDir",a))}});Y.PathError=a("TreePathError");Y._TreeNode=S;return Y})},"dijit/tree/TreeStoreModel":function(){define(["dojo/_base/array","dojo/aspect","dojo/_base/declare","dojo/_base/lang"],function(k,e,p,q){return p("dijit.tree.TreeStoreModel",null,{store:null,childrenAttrs:["children"],newItemIdAttr:"id",labelAttr:"",root:null,query:null,deferItemLoadingUntilExpand:!1,
constructor:function(k){q.mixin(this,k);this.connects=[];k=this.store;if(!k.getFeatures()["dojo.data.api.Identity"])throw Error("dijit.tree.TreeStoreModel: store must support dojo.data.Identity");k.getFeatures()["dojo.data.api.Notification"]&&(this.connects=this.connects.concat([e.after(k,"onNew",q.hitch(this,"onNewItem"),!0),e.after(k,"onDelete",q.hitch(this,"onDeleteItem"),!0),e.after(k,"onSet",q.hitch(this,"onSetItem"),!0)]))},destroy:function(){for(var e;e=this.connects.pop();)e.remove()},getRoot:function(e,
k){this.root?e(this.root):this.store.fetch({query:this.query,onComplete:q.hitch(this,function(h){if(1!=h.length)throw Error("dijit.tree.TreeStoreModel: root query returned "+h.length+" items, but must return exactly one");this.root=h[0];e(this.root)}),onError:k})},mayHaveChildren:function(e){return k.some(this.childrenAttrs,function(k){return this.store.hasAttribute(e,k)},this)},getChildren:function(e,l,h){var f=this.store;if(f.isItemLoaded(e)){for(var d=[],c=0;c<this.childrenAttrs.length;c++)var a=
f.getValues(e,this.childrenAttrs[c]),d=d.concat(a);var b=0;this.deferItemLoadingUntilExpand||k.forEach(d,function(a){f.isItemLoaded(a)||b++});0==b?l(d):k.forEach(d,function(a,c){f.isItemLoaded(a)||f.loadItem({item:a,onItem:function(a){d[c]=a;0==--b&&l(d)},onError:h})})}else{var g=q.hitch(this,arguments.callee);f.loadItem({item:e,onItem:function(a){g(a,l,h)},onError:h})}},isItem:function(e){return this.store.isItem(e)},fetchItemByIdentity:function(e){this.store.fetchItemByIdentity(e)},getIdentity:function(e){return this.store.getIdentity(e)},
getLabel:function(e){return this.labelAttr?this.store.getValue(e,this.labelAttr):this.store.getLabel(e)},newItem:function(e,k,h){var f={parent:k,attribute:this.childrenAttrs[0]},d;this.newItemIdAttr&&e[this.newItemIdAttr]?this.fetchItemByIdentity({identity:e[this.newItemIdAttr],scope:this,onItem:function(c){c?this.pasteItem(c,null,k,!0,h):(d=this.store.newItem(e,f))&&void 0!=h&&this.pasteItem(d,k,k,!1,h)}}):(d=this.store.newItem(e,f))&&void 0!=h&&this.pasteItem(d,k,k,!1,h)},pasteItem:function(e,l,
h,f,d){var c=this.store,a=this.childrenAttrs[0];l&&k.forEach(this.childrenAttrs,function(b){if(c.containsValue(l,b,e)){if(!f){var d=k.filter(c.getValues(l,b),function(a){return a!=e});c.setValues(l,b,d)}a=b}});if(h)if("number"==typeof d){var b=c.getValues(h,a).slice();b.splice(d,0,e);c.setValues(h,a,b)}else c.setValues(h,a,c.getValues(h,a).concat(e))},onChange:function(){},onChildrenChange:function(){},onDelete:function(){},onNewItem:function(e,k){k&&this.getChildren(k.item,q.hitch(this,function(e){this.onChildrenChange(k.item,
e)}))},onDeleteItem:function(e){this.onDelete(e)},onSetItem:function(e,l){if(-1!=k.indexOf(this.childrenAttrs,l))this.getChildren(e,q.hitch(this,function(h){this.onChildrenChange(e,h)}));else this.onChange(e)}})})},"dijit/tree/ForestStoreModel":function(){define(["dojo/_base/array","dojo/_base/declare","dojo/_base/kernel","dojo/_base/lang","./TreeStoreModel"],function(k,e,p,q,n){return e("dijit.tree.ForestStoreModel",n,{rootId:"$root$",rootLabel:"ROOT",query:null,constructor:function(e){this.root=
{store:this,root:!0,id:e.rootId,label:e.rootLabel,children:e.rootChildren}},mayHaveChildren:function(e){return e===this.root||this.inherited(arguments)},getChildren:function(e,h,f){e===this.root?this.root.children?h(this.root.children):this.store.fetch({query:this.query,onComplete:q.hitch(this,function(d){this.root.children=d;h(d)}),onError:f}):this.inherited(arguments)},isItem:function(e){return e===this.root?!0:this.inherited(arguments)},fetchItemByIdentity:function(e){if(e.identity==this.root.id){var h=
e.scope||p.global;e.onItem&&e.onItem.call(h,this.root)}else this.inherited(arguments)},getIdentity:function(e){return e===this.root?this.root.id:this.inherited(arguments)},getLabel:function(e){return e===this.root?this.root.label:this.inherited(arguments)},newItem:function(e,h,f){return h===this.root?(this.onNewRootItem(e),this.store.newItem(e)):this.inherited(arguments)},onNewRootItem:function(){},pasteItem:function(e,h,f,d,c){if(h===this.root&&!d)this.onLeaveRoot(e);this.inherited(arguments,[e,
h===this.root?null:h,f===this.root?null:f,d,c]);if(f===this.root)this.onAddToRoot(e)},onAddToRoot:function(e){console.log(this,": item ",e," added to root")},onLeaveRoot:function(e){console.log(this,": item ",e," removed from root")},_requeryTop:function(){var e=this.root.children||[];this.store.fetch({query:this.query,onComplete:q.hitch(this,function(h){this.root.children=h;if(e.length!=h.length||k.some(e,function(e,d){return h[d]!=e}))this.onChildrenChange(this.root,h)})})},onNewItem:function(e,
h){this._requeryTop();this.inherited(arguments)},onDeleteItem:function(e){-1!=k.indexOf(this.root.children,e)&&this._requeryTop();this.inherited(arguments)},onSetItem:function(e,h,f,d){this._requeryTop();this.inherited(arguments)}})})},"dijit/tree/_dndSelector":function(){define("dojo/_base/array dojo/_base/declare dojo/_base/kernel dojo/_base/lang dojo/dnd/common dojo/dom dojo/mouse dojo/on dojo/touch ../a11yclick ./_dndContainer".split(" "),function(k,e,p,q,n,l,h,f,d,c,a){return e("dijit.tree._dndSelector",
a,{constructor:function(){this.selection={};this.anchor=null;this.events.push(f(this.tree.domNode,d.press,q.hitch(this,"onMouseDown")),f(this.tree.domNode,d.release,q.hitch(this,"onMouseUp")),f(this.tree.domNode,d.move,q.hitch(this,"onMouseMove")),f(this.tree.domNode,c.press,q.hitch(this,"onClickPress")),f(this.tree.domNode,c.release,q.hitch(this,"onClickRelease")))},singular:!1,getSelectedTreeNodes:function(){var a=[],c=this.selection,d;for(d in c)a.push(c[d]);return a},selectNone:function(){this.setSelection([]);
return this},destroy:function(){this.inherited(arguments);this.selection=this.anchor=null},addTreeNode:function(a,c){this.setSelection(this.getSelectedTreeNodes().concat([a]));c&&(this.anchor=a);return a},removeTreeNode:function(a){var b=k.filter(this.getSelectedTreeNodes(),function(b){return!l.isDescendant(b.domNode,a.domNode)});this.setSelection(b);return a},isTreeNodeSelected:function(a){return a.id&&!!this.selection[a.id]},setSelection:function(a){var b=this.getSelectedTreeNodes();k.forEach(this._setDifference(b,
a),q.hitch(this,function(a){a.setSelected(!1);this.anchor==a&&delete this.anchor;delete this.selection[a.id]}));k.forEach(this._setDifference(a,b),q.hitch(this,function(a){a.setSelected(!0);this.selection[a.id]=a}));this._updateSelectionProperties()},_setDifference:function(a,c){k.forEach(c,function(a){a.__exclude__=!0});a=k.filter(a,function(a){return!a.__exclude__});k.forEach(c,function(a){delete a.__exclude__});return a},_updateSelectionProperties:function(){var a=this.getSelectedTreeNodes(),c=
[],d=[];k.forEach(a,function(a){var b=a.getTreePath();d.push(a);c.push(b)},this);a=k.map(d,function(a){return a.item});this.tree._set("paths",c);this.tree._set("path",c[0]||[]);this.tree._set("selectedNodes",d);this.tree._set("selectedNode",d[0]||null);this.tree._set("selectedItems",a);this.tree._set("selectedItem",a[0]||null)},onClickPress:function(a){if(!(this.current&&this.current.isExpandable&&this.tree.isExpandoNode(a.target,this.current))){"mousedown"==a.type&&h.isLeft(a)&&a.preventDefault();
var b="keydown"==a.type?this.tree.focusedChild:this.current;if(b){var c=n.getCopyKeyState(a),d=b.id;this.singular||a.shiftKey||!this.selection[d]?(this._doDeselect=!1,this.userSelect(b,c,a.shiftKey)):this._doDeselect=!0}}},onClickRelease:function(a){this._doDeselect&&(this._doDeselect=!1,this.userSelect("keyup"==a.type?this.tree.focusedChild:this.current,n.getCopyKeyState(a),a.shiftKey))},onMouseMove:function(){this._doDeselect=!1},onMouseDown:function(){},onMouseUp:function(){},_compareNodes:function(a,
c){if(a===c)return 0;if("sourceIndex"in document.documentElement)return a.sourceIndex-c.sourceIndex;if("compareDocumentPosition"in document.documentElement)return a.compareDocumentPosition(c)&2?1:-1;if(document.createRange){var b=doc.createRange();b.setStartBefore(a);a=doc.createRange();a.setStartBefore(c);return b.compareBoundaryPoints(b.END_TO_END,a)}throw Error("dijit.tree._compareNodes don't know how to compare two different nodes in this browser");},userSelect:function(a,c,d){if(this.singular)this.anchor==
a&&c?this.selectNone():(this.setSelection([a]),this.anchor=a);else if(d&&this.anchor){c=this._compareNodes(this.anchor.rowNode,a.rowNode);d=this.anchor;0>c?c=d:(c=a,a=d);for(d=[];c!=a;)d.push(c),c=this.tree._getNext(c);d.push(a);this.setSelection(d)}else this.selection[a.id]&&c?this.removeTreeNode(a):c?this.addTreeNode(a,!0):(this.setSelection([a]),this.anchor=a)},getItem:function(a){return{data:this.selection[a],type:["treeNode"]}},forInSelectedItems:function(a,c){c=c||p.global;for(var b in this.selection)a.call(c,
this.getItem(b),b,this)}})})},"dijit/tree/_dndContainer":function(){define("dojo/aspect dojo/_base/declare dojo/dom-class dojo/_base/lang dojo/on dojo/touch".split(" "),function(k,e,p,q,n,l){return e("dijit.tree._dndContainer",null,{constructor:function(e,f){this.tree=e;this.node=e.domNode;q.mixin(this,f);this.containerState="";p.add(this.node,"dojoDndContainer");this.events=[n(this.node,l.enter,q.hitch(this,"onOverEvent")),n(this.node,l.leave,q.hitch(this,"onOutEvent")),k.after(this.tree,"_onNodeMouseEnter",
q.hitch(this,"onMouseOver"),!0),k.after(this.tree,"_onNodeMouseLeave",q.hitch(this,"onMouseOut"),!0),n(this.node,"dragstart, selectstart",function(d){d.preventDefault()})]},destroy:function(){for(var e;e=this.events.pop();)e.remove();this.node=this.parent=null},onMouseOver:function(e){this.current=e},onMouseOut:function(){this.current=null},_changeState:function(e,f){var d="dojoDnd"+e;e=e.toLowerCase()+"State";p.replace(this.node,d+f,d+this[e]);this[e]=f},_addItemClass:function(e,f){p.add(e,"dojoDndItem"+
f)},_removeItemClass:function(e,f){p.remove(e,"dojoDndItem"+f)},onOverEvent:function(){this._changeState("Container","Over")},onOutEvent:function(){this._changeState("Container","")}})})},"jimu/dijit/QueryableServiceChooserFromPortal":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/QueryableServiceChooserFromPortal.html dojo/_base/lang dojo/_base/html dojo/_base/array dojo/on dojo/query dojo/Deferred dojo/Evented dojo/promise/all jimu/dijit/ItemSelector jimu/dijit/QueryableServiceBrowser jimu/portalUrlUtils esri/request".split(" "),
function(k,e,p,q,n,l,h,f,d,c,a,b,g,u,m,r,t){return k([e,p,q,b],{templateString:n,declaredClass:"jimu.dijit.QueryableServiceChooserFromPortal",baseClass:"jimu-service-chooser-from-portal jimu-queryable-service-chooser-from-portal",_serviceBrowserDef:null,portalUrl:null,multiple:!1,postMixInProperties:function(){this.nls=l.mixin({},window.jimuNls.common);this.nls=l.mixin(this.nls,window.jimuNls.featureLayerChooserFromPortal);this.portalUrl=r.getStandardPortalUrl(this.portalUrl);this.multiple=!0===this.multiple?
!0:!1},postCreate:function(){this.inherited(arguments);this._initSelf()},getSelectedItems:function(){return this.serviceBrowser.getSelectedItems()},_initSelf:function(){this.selector=new u({portalUrl:this.portalUrl,itemTypes:["Feature Service","Map Service","Image Service"],onlyShowOnlineFeaturedItems:!1});this.own(d(this.selector,"item-selected",l.hitch(this,this._onItemSelected)));this.own(d(this.selector,"none-item-selected",l.hitch(this,this._onNoneItemSelected)));this.selector.placeAt(this.selectorContainer);
this.selector.startup();this.serviceBrowser=new m({multiple:this.multiple});this.own(d(this.serviceBrowser,"tree-click",l.hitch(this,this._onServiceBrowserClicked)));this.serviceBrowser.placeAt(this.serviceBrowserContainer);this.serviceBrowser.startup()},_onItemSelected:function(){h.removeClass(this.btnNext,"jimu-state-disabled")},_onNoneItemSelected:function(){h.addClass(this.btnNext,"jimu-state-disabled")},_onBtnBackClicked:function(){this._serviceBrowserDef&&!this._serviceBrowserDef.isFulfilled()&&
this._serviceBrowserDef.cancel();h.setStyle(this.btnOk,"display","none");h.setStyle(this.btnNext,"display","block");h.setStyle(this.btnBack,"display","none");h.addClass(this.btnOk,"jimu-state-disabled");h.setStyle(this.selectorContainer,"display","block");h.setStyle(this.serviceBrowserContainer,"display","none");this.serviceBrowser.reset();this.emit("back")},_onBtnOkClicked:function(){var a=this.selector.getSelectedItem(),b=this.getSelectedItems();a&&0<b.length&&(f.forEach(b,l.hitch(this,function(b){b.portalUrl=
a.portalUrl;b.itemId=a.id})),this.emit("ok",b))},_onBtnNextClicked:function(){var a=this.selector.getSelectedItem();a&&(h.setStyle(this.btnNext,"display","none"),h.setStyle(this.btnBack,"display","block"),h.setStyle(this.btnOk,"display","block"),h.addClass(this.btnOk,"jimu-state-disabled"),h.setStyle(this.selectorContainer,"display","none"),h.setStyle(this.serviceBrowserContainer,"display","block"),this.serviceBrowser.reset(),this._serviceBrowserDef=this.serviceBrowser.setUrl(a.url||a.item),this._serviceBrowserDef.then(l.hitch(this,
function(){this._serviceBrowserDef=null;this._setOkStateBySelectedItems()}),l.hitch(this,function(){this._serviceBrowserDef=null})),this.emit("next"))},_setOkStateBySelectedItems:function(){0<this.serviceBrowser.getSelectedItems().length?h.removeClass(this.btnOk,"jimu-state-disabled"):h.addClass(this.btnOk,"jimu-state-disabled")},_onServiceBrowserClicked:function(){this._setOkStateBySelectedItems()},_onBtnCancelClicked:function(){this.emit("cancel")}})})},"jimu/dijit/QueryableServiceBrowser":function(){define(["dojo/_base/declare",
"./_BasicServiceBrowser","dojo/_base/lang","dojo/_base/array","jimu/serviceBrowserRuleUtils"],function(k,e,p,q,n){return k([e],{declaredClass:"jimu.dijit.QueryableServiceBrowser",baseClass:"jimu-queryable-service-browser",url:"",multiple:!1,postMixInProperties:function(){this.inherited(arguments);this.rule=n.getQueryableServiceBrowserRule()},getSelectedItems:function(){var e=this.inherited(arguments);return e=q.map(e,p.hitch(this,function(e){return{name:e.name,url:e.url,definition:e.definition}}))}})})},
"jimu/dijit/_BasicServiceBrowser":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/Evented dojo/_base/lang dojo/_base/html dojo/_base/array dojo/Deferred dojo/promise/all dojo/store/Memory dojo/store/Observable dijit/tree/ObjectStoreModel jimu/utils jimu/dijit/_Tree jimu/dijit/LoadingShelter".split(" "),function(k,e,p,q,n,l,h,f,d,c,a,b,g,u,m){return k([e,p,q,n],{templateString:'\x3cdiv style\x3d"width:100%;"\x3e\x3cdiv data-dojo-attach-point\x3d"shelter"  data-dojo-type\x3d"jimu/dijit/LoadingShelter" data-dojo-props\x3d"hidden:true"\x3e\x3c/div\x3e\x3c/div\x3e',
_store:null,_id:0,_currentUrl:"",_treeClass:"service-browser-tree",_def:null,url:"",multiple:!1,rule:null,postMixInProperties:function(){this.nls=window.jimuNls.basicServiceBrowser},postCreate:function(){this.inherited(arguments);h.addClass(this.domNode,"jimu-basic-service-browser");this.multiple=!!this.multiple;this._createTree();this.url&&"string"===typeof this.url&&this.setUrl(this.url)},reset:function(){this.url="";this._clear()},getSelectedItems:function(){return this.tree.getSelectedItems()},
setUrl:function(a){this._def&&(this._def.isFulfilled()||this._def.cancel(),this._def=null);this._def=new d;a&&"string"===typeof a&&a.replace(/\/*$/g,"")||this._def.reject();a=a.replace(/\/*$/g,"");a=l.trim(a);var b=a.match(/^http(s?):\/\//gi);b&&0<b.length||(a="http://"+a);if(!(0>=a.search(/\/rest\/services/i))&&(this._clear(),this._currentUrl=a))return a=this._getRootItem(),a=u.isStringEndWith(this._currentUrl,"rest/services")?this._searchBaseServiceUrl(this._currentUrl,a):this._isUrlContainsServiceType(this._currentUrl)?
this._searchServiceUrl(this._currentUrl,a):this._searchFolderServiceUrl(this._currentUrl,a),this.shelter.show(),a.then(l.hitch(this,function(a){this.domNode&&this.shelter.hide();var b=this.tree.getAllLeafTreeNodeWidgets();1===b.length&&b[0].select();this._def.resolve(a)}),l.hitch(this,function(a){this.domNode&&this.shelter.hide();this._showRequestError();this._def.reject(a)})),this._def;this._def.reject()},_getItem:function(a){return this.rule.getItem(a)},_getSubItemUrls:function(a){return this.rule.getSubItemUrls(a)},
_getSubItems:function(a){var b=new d;this._getSubItemUrls(a).then(l.hitch(this,function(a){a=f.map(a,l.hitch(this,function(a){return this._getItem(a)}));c(a).then(l.hitch(this,function(a){a=f.filter(a,l.hitch(this,function(a){return a&&"object"===typeof a}));b.resolve(a)}),l.hitch(this,function(a){b.reject(a)}))}),l.hitch(this,function(a){b.reject(a)}));return b},_selectFirstLeafTreeNodeWidget:function(){var a=this.tree.getAllLeafTreeNodeWidgets();1===a.length&&a[0].select()},isLeafItem:function(a){return 0<=
this.rule.leafTypes.indexOf(a.type)},isServiceTypeSupported:function(a){return this.rule.isServiceTypeSupported(a)},_getStringEndWith:function(a,b){var c="",d=a.indexOf(b);0<=d&&(c=a.slice(0,d+b.length));return c},_isUrlContainsServiceType:function(a){return this.rule.isUrlContainsServiceType(a)},_getBaseServiceUrl:function(){return this._getStringEndWith(this._currentUrl,"rest/services")},_getServiceName:function(a){var b="";a=a.split("/");return b=a[a.length-1]},_searchBaseServiceUrl:function(a,
b){var e=new d;this._getRestInfo(a).then(l.hitch(this,function(g){if(this.domNode){var h=[];f.map(g.folders,l.hitch(this,function(c){var e={name:c,type:"folder",url:a+"/"+c,parent:b.id};this._addItem(e);var g=new d;this._doSearchFolderServiceUrl(e.url,e.id).then(l.hitch(this,function(a){0<a.length?f.forEach(a,l.hitch(this,function(a){a.parent=e.id;this._addItem(a)})):this._removeItem(e.id);g.resolve()}),l.hitch(this,function(a){g.reject(a)}));h.push(g);return g}));f.forEach(g.services,l.hitch(this,
function(c){if(this.isServiceTypeSupported(c.type)){c=a+"/"+c.name+"/"+c.type;var e=new d;this.rule.getItem(c).then(l.hitch(this,function(a){a&&(a.parent=b.id,this._addItem(a));e.resolve()}),l.hitch(this,function(a){console.error(a);e.reject(a)}));h.push(e)}}));c(h).then(l.hitch(this,function(){this.domNode&&e.resolve()}),l.hitch(this,function(a){console.error(a);this.domNode&&e.reject(a)}))}}),l.hitch(this,function(a){console.error(a);this.domNode&&e.reject({errorCode:"NETWORK_ERROR",error:a})}));
return e},_searchFolderServiceUrl:function(a,b){var c=new d;this._doSearchFolderServiceUrl(a,b).then(l.hitch(this,function(a){this.domNode&&(f.forEach(a,l.hitch(this,function(a){a.parent=b.id;this._addItem(a)})),c.resolve())}),l.hitch(this,function(a){console.error(a);this.domNode&&c.reject({errorCode:"NETWORK_ERROR",error:a})}));return c},_doSearchFolderServiceUrl:function(a){var b=new d,e=this._getBaseServiceUrl();this._getRestInfo(a).then(l.hitch(this,function(a){a=a.services;var d=[];a&&0<a.length&&
f.forEach(a,l.hitch(this,function(a){this.isServiceTypeSupported(a.type)&&(a=this.rule.getItem(e+"/"+a.name+"/"+a.type),d.push(a))}));c(d).then(l.hitch(this,function(a){a=f.filter(a,l.hitch(this,function(a){return a}));b.resolve(a)}),l.hitch(this,function(a){console.error(a);b.reject(a)}))}),l.hitch(this,function(a){console.error(a);b.reject(a)}));return b},_searchServiceUrl:function(a,b){var c=new d;this._getSubItems(a).then(l.hitch(this,function(d){d&&0<d.length?(f.forEach(d,l.hitch(this,function(a){a.parent=
b.id;this._addItem(a)})),c.resolve()):this._getItem(a).then(l.hitch(this,function(a){a&&(a.parent=b.id,this._addItem(a));c.resolve()}),l.hitch(this,function(a){c.reject(a)}))}),l.hitch(this,function(a){c.reject(a)}));return c},_getRestInfo:function(a){var b=new d;this.rule.getRestInfo(a).then(l.hitch(this,function(a){this.domNode&&b.resolve(a)}),l.hitch(this,function(a){this.domNode&&b.reject(a)}));return b},_clear:function(){var a=this._store.query({parent:"root"});f.forEach(a,l.hitch(this,function(a){a&&
"root"!==a.id&&this._store.remove(a.id)}))},_showRequestError:function(){this.emit("error",this.nls.invalidUrlTip)},_addItem:function(a){this._id++;a.id=this._id.toString();this._store.add(a);return a},_removeItem:function(a){this._store.remove(a)},_getRootItem:function(){return{id:"root",name:"Services Root",type:"root"}},_createTree:function(){var c=this._getRootItem(),c=new a({data:[c],getChildren:function(a){return this.query({parent:a.id})}});this._store=new b(c);c=new g({store:this._store,query:{id:"root"},
mayHaveChildren:l.hitch(this,this._mayHaveChildren)});this.tree=new m({multiple:this.multiple,model:c,showRoot:!1,style:{width:"100%"},isLeafItem:l.hitch(this,this.isLeafItem),onOpen:l.hitch(this,function(a,b){this._onTreeOpen(a,b);this.emit("tree-open",a,b)}),onClick:l.hitch(this,function(a,b,c){this._onTreeClick(a,b,c);this.emit("tree-click",a,b,c)}),getIconStyle:l.hitch(this,function(a,b){var c=null;if(!a)return null;var d={width:"20px",height:"20px",backgroundRepeat:"no-repeat",backgroundPosition:"center center",
backgroundImage:""},e=window.location.protocol+"//"+window.location.host+require.toUrl("jimu"),f=this._getIconImageName(a,b);f||("folder"===a.type?f=b?"folder_open_default.png":"folder_close_default.png":this.isServiceTypeSupported(a.type)&&(f=b?"folder_open_default.png":"folder_close_default.png"));f&&(d.backgroundImage="url("+e+"/css/images/"+f+")",c=d);return c})});h.addClass(this.tree.domNode,this._treeClass);this.tree.placeAt(this.domNode)},_getIconImageName:function(a,b){var c="";"function"===
typeof this.rule.getIconImageName&&(c=this.rule.getIconImageName(a,b));return c},_mayHaveChildren:function(a){return"root"===a.type?!0:!this.isLeafItem(a)},_onTreeOpen:function(a,b){"root"===a.id||0<this._store.query({parent:a.id}).length||a.checking||a.checked||(a.checking=!0,this._getSubItems(a.url).then(l.hitch(this,function(b){f.forEach(b,l.hitch(this,function(b){b.parent=a.id;this._addItem(b)}));a.checking=!1;a.checked=!0}),l.hitch(this,function(b){console.error(b);a.checking=!1;a.checked=!0})))},
_onTreeClick:function(a,b,c){},destroy:function(){this.shelter&&(this.shelter.destroy(),this.shelter=null);this.inherited(arguments)}})})},"jimu/serviceBrowserRuleUtils":function(){define(["dojo/_base/lang","dojo/_base/array","dojo/Deferred","jimu/utils","jimu/ServiceBrowserRule"],function(k,e,p,q,n){var l={combineRules:function(h){var f=new n;e.forEach(h,function(d){e.forEach(d.leafTypes,function(c){0>f.leafTypes.indexOf(c)&&f.leafTypes.push(c)});e.forEach(d.serviceTypes,function(c){0>f.serviceTypes.indexOf(c)&&
f.serviceTypes.push(c)})});f.getMatchedRule=function(d){var c=null;e.some(h,function(a){return a.isUrlContainsServiceType(d)?(c=a,!0):!1});return c};f.getItem=function(d){var c=null;return c=(c=f.getMatchedRule(d))?c.getItem(d):f.defaultGetItem(d)};f.getSubItemUrls=function(d){var c=null;return c=(c=f.getMatchedRule(d))?c.getSubItemUrls(d):f.defaultGetSubItemUrls(d)};f.getIconImageName=function(d,c){var a="";if(d.url){var b=f.getMatchedRule(d.url);b&&"function"===typeof b.getIconImageName&&(a=b.getIconImageName(d,
c))}return a};return f},getFeaturelayerServiceBrowserRule:function(h,f){h=k.clone(h);var d=["point","polyline","polygon"];k.isArrayLike(h)&&0<h.length?(h=e.filter(h,function(c){return 0<=d.indexOf(c)}),0===h.length&&(h=d)):h=d;return l._getFeaturelayerServiceBrowserRule(h,f)},_getFeaturelayerServiceBrowserRule:function(h,f){return new n({types:h,leafTypes:["Feature Layer","Table"],serviceTypes:["MapServer","FeatureServer"],_groupLayerType:"Group Layer",_featureLayerType:"Feature Layer",_tableType:"Table",
getItem:function(d){var c=new p;this.isUrlEndWithServiceType(d,this.serviceTypes)?c=this.defaultGetItem(d):this.getRestInfo(d).then(k.hitch(this,function(a){a=this._getItemByLayerDefinition(d,a);c.resolve(a)}),k.hitch(this,function(a){c.reject(a)}));return c},getSubItemUrls:function(d){var c=new p;return c=this.isUrlEndWithServiceType(d)?this._getSubUrlsByServiceUrl(d):this._getSubUrlsByGroupUrl(d)},getIconImageName:function(d,c){var a="";"MapServer"===d.type||"FeatureServer"===d.type?a=c?"mapserver_open.png":
"mapserver_close.png":d.type===this._groupLayerType?a=c?"group_layer2.png":"group_layer1.png":d.type===this._featureLayerType?(d=q.getTypeByGeometryType(d.definition&&d.definition.geometryType),"point"===d?a="point_layer1.png":"polyline"===d?a="line_layer1.png":"polygon"===d&&(a="polygon_layer1.png")):d.type===this._tableType?a="table.png":"root"===d.type&&this._currentUrl&&e.some(this.serviceTypes,k.hitch(this,function(a){return q.isStringEndWith(this._currentUrl,"/"+a)}))&&(a=c?"mapserver_open.png":
"mapserver_close.png");return a},_getSubUrlsByServiceUrl:function(d){var c=new p;this.getRestInfo(d).then(k.hitch(this,function(a){var b=[];e.forEach(a.layers,k.hitch(this,function(a){0<=a.parentLayerId||b.push(d+"/"+a.id)}));c.resolve(b)}),k.hitch(this,function(a){c.reject(a)}));return c},_getSubUrlsByGroupUrl:function(d){var c=new p;this.getRestInfo(d).then(k.hitch(this,function(a){var b=[];if(a.type===this._groupLayerType)var f=this._getServiceUrlByLayerUrl(d),b=e.map(a.subLayers||[],k.hitch(this,
function(a){return f+"/"+a.id}));c.resolve(b)}),k.hitch(this,function(a){c.reject(a)}));return c},_getItemByLayerDefinition:function(d,c){var a=null,b=c.type;if(b===this._groupLayerType)a={name:c.name,type:b,url:d,definition:c};else if(b===this._featureLayerType||b===this._tableType){var e=!1;b===this._featureLayerType?e=this._validateEsriGeometryType(c.geometryType):b===this._tableType&&(e=!0);e&&(e=!1,(e=f?q.isFeaturelayerUrlSupportQuery(d,c.capabilities):!0)&&(a={name:c.name,type:b,url:d,definition:c}))}return a},
_validateEsriGeometryType:function(d){d=q.getTypeByGeometryType(d);return 0<=this.types.indexOf(d)},_getServiceUrlByLayerUrl:function(d){for(var c="",a=0;a<this.serviceTypes.length;a++){var b=this.serviceTypes[a].toLowerCase(),e=d.toLowerCase().lastIndexOf("/"+b+"/");if(0<=e){c=d.slice(0,e+b.length+1);break}}return c}})},getGeocodeServiceBrowserRule:function(){return new n({leafTypes:["GeocodeServer"],serviceTypes:["GeocodeServer"]})},getGpServiceBrowserRule:function(){return new n({leafTypes:["GPTask"],
serviceTypes:["GPServer"],getItem:function(e){var f=new p;this.isUrlEndWithServiceType(e)?f=this.defaultGetItem(e):this.getRestInfo(e).then(k.hitch(this,function(d){f.resolve({name:d.displayName||d.name,type:"GPTask",url:e,definition:d})}),k.hitch(this,function(d){f.reject(d)}));return f},getSubItemUrls:function(h){var f=new p;this.isUrlEndWithServiceType(h)?this.getRestInfo(h).then(k.hitch(this,function(d){d=e.map(d.tasks||[],k.hitch(this,function(c){return h+"/"+c}));f.resolve(d)}),k.hitch(this,
function(d){f.reject(d)})):f.resolve([]);return f},getIconImageName:function(e,f){f="";"GPServer"===e.type?f="toolbox.png":"GPTask"===e.type&&(f="tool.png");return f}})},getImageServiceBrowserRule:function(e){return new n({leafTypes:["ImageServer"],serviceTypes:["ImageServer"],getItem:function(f){var d=new p;this.isUrlEndWithServiceType(f)?this.defaultGetItem(f).then(k.hitch(this,function(c){e?q.isImageServiceSupportQuery(c.definition.capabilities)?d.resolve(c):d.resolve(null):d.resolve(c)}),k.hitch(this,
function(c){d.reject(c)})):d.resolve(null);return d},getIconImageName:function(e,d){d="";"ImageServer"===e.type&&(d="image_layer.png");return d}})},getQueryableServiceBrowserRule:function(){var e=l.getFeaturelayerServiceBrowserRule(["point","polyline","polygon"],!0),f=l.getImageServiceBrowserRule(!0);return l.combineRules([e,f])}};return l})},"jimu/ServiceBrowserRule":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/Deferred jimu/utils esri/request esri/IdentityManager".split(" "),
function(k,e,p,q,n,l,h){return k([],{leafTypes:null,serviceTypes:null,_restInfoCache:{},constructor:function(f){e.mixin(this,f);e.isArrayLike(this.leafTypes)||(this.leafTypes=[]);e.isArrayLike(this.serviceTypes)||(this.serviceTypes=[])},getItem:function(e){return this.defaultGetItem(e)},getSubItemUrls:function(e){return this.defaultGetSubItemUrls(e)},getIconImageName:function(e,d){return""},defaultGetItem:function(f){var d=new q;f=f.replace(/\/*$/g,"");if(this.isUrlEndWithServiceType(f)){var c=f.split("/"),
a=c[c.length-1],b=c[c.length-2];this.getRestInfo(f).then(e.hitch(this,function(c){d.resolve({name:b,type:a,url:f,definition:c})}),e.hitch(this,function(a){console.error(a);d.reject({errorCode:"NETWORK_ERROR",error:a})}))}else d.resolve(null);return d},defaultGetSubItemUrls:function(e){e=new q;e.resolve([]);return e},getRestInfo:function(f){var d=new q;f=f.replace(/\/*$/g,"");var c=this._restInfoCache[f];if(c)d.resolve(c);else{var c={url:f,content:{f:"json"},handleAs:"json",callbackParamName:"callback",
timeout:2E4},a=h.findCredential(f);a&&a.token&&(c.content.token=a.token);l(c).then(e.hitch(this,function(a){this._restInfoCache[f]=a;d.resolve(a)}),function(a){d.reject(a)})}return d},isServiceTypeSupported:function(f){f=f.toLowerCase();return p.some(this.serviceTypes,e.hitch(this,function(d){return d.toLowerCase()===f}))},isUrlEndWithServiceType:function(f){return p.some(this.serviceTypes,e.hitch(this,function(d){return n.isStringEndWith(f,"/"+d)}))},isUrlContainsServiceType:function(f){f=f.toLowerCase();
return p.some(this.serviceTypes,e.hitch(this,function(d){d=d.toLowerCase();return 0<=f.indexOf("/"+d)}))}})})},"jimu/dijit/_QueryableServiceChooserContent":function(){define(["dojo/_base/declare","./_BasicServiceChooserContent","./QueryableServiceBrowser"],function(k,e,p){return k([e],{baseClass:"jimu-queryable-service-chooser-content",_examples:["http://myserver/arcgis/rest/services","http://myserver/arcgis/rest/services/myservice/MapServer","http://myserver/arcgis/rest/services/myservice/FeatureServer",
"http://myserver/arcgis/rest/services/myservice/ImageServer"],_createServiceBrowser:function(e){return new p(e)}})})},"jimu/dijit/_BasicServiceChooserContent":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/_BasicServiceChooserContent.html dojo/Evented dojo/Deferred dojo/_base/html dojo/_base/array dojo/_base/lang dojo/on dojo/aspect dojo/promise/all jimu/dijit/URLInput jimu/dijit/LoadingIndicator".split(" "),function(k,
e,p,q,n,l,h,f,d,c,a,b,g,u,m){return k([e,p,q,l],{templateString:n,_examples:["http://myserver/arcgis/rest/services","http://myserver/arcgis/rest/services/folder","http://myserver/arcgis/rest/services/myservice/servicetype"],multiple:!1,url:"",getSelectedItems:function(){return this.serviceBrowser.getSelectedItems()},postMixInProperties:function(){this.nls=c.mixin({},window.jimuNls.common);this.nls=c.mixin(this.nls,window.jimuNls.basicServiceChooser)},postCreate:function(){this.inherited(arguments);
f.addClass(this.domNode,"jimu-basic-service-chooser-content");this.multiple=!!this.multiple;this._initSelf();this.exampleTd.innerHTML=this.exampleTd.innerHTML},setUrl:function(a){var b=new h;(this.url=a)&&"string"===typeof this.url?(this.urlInput.set("value",this.url),b=this._onBtnValidateClick()):b.reject();return b},focusInput:function(){this.urlInput.focus()},_initSelf:function(){this._examples&&0<this._examples.length?d.forEach(this._examples,c.hitch(this,function(a){f.create("div",{innerHTML:a,
"class":"example-url"},this.exampleTd)})):f.setStyle(this.exampleTr,"display","none");var e={multiple:this.multiple,_onTreeClick:c.hitch(this,this._onTreeClick)};this.serviceBrowser=this._createServiceBrowser(e);this.serviceBrowser.placeAt(this.serviceBrowserContainer);this.serviceBrowser.startup();this.own(b.after(this.urlInput,"validator",c.hitch(this,this._afterUrlValidate)));this.url&&"string"===typeof this.url&&this.urlInput.set("value",this.url);this.own(a(this.serviceBrowser,"error",c.hitch(this,
this._onServiceBrowserError)))},_createServiceBrowser:function(a){},_validateUrl:function(a){a=a.replace(/\/*$/g,"");if((a=a.match(/\/rest\/services\/*(.*)/gi))&&0<a.length)if(a=a[0].replace(/\/rest\/services\/*/,"")){var b=a.split("/");if(1===b.length)return!0;if(2===b.length)return this.serviceBrowser.isServiceTypeSupported(b[1]);if(3<=b.length)return a=this.serviceBrowser.isServiceTypeSupported(b[1]),b=this.serviceBrowser.isServiceTypeSupported(b[2]),a||b}else return!0;else return!1},_afterUrlValidate:function(a){a&&
(a=this.urlInput.get("value"),a=this._validateUrl(a));a?f.removeClass(this.btnValidate,"jimu-state-disabled"):f.addClass(this.btnValidate,"jimu-state-disabled");return a},_onServiceBrowserError:function(a){this._showErrorMessage(a)},_showErrorMessage:function(a){a&&"string"===typeof a?(this.errorNode.innerHTML=a,f.addClass(this.errorSection,"visible")):f.removeClass(this.errorSection,"visible")},_clearErrorMessage:function(){this.errorNode.innerHTML="";f.removeClass(this.errorSection,"visible")},
_onBtnValidateClick:function(){this._clearErrorMessage();var a=new h;if(this.urlInput.validate()){var b=this.urlInput.get("value");this.serviceBrowser.setUrl(b).then(c.hitch(this,function(){this.domNode&&this._checkSelectedItemsNumber();a.resolve()}),c.hitch(this,function(){this.domNode&&this._checkSelectedItemsNumber();a.reject()}));this.emit("validate-click")}else a.reject();return a},_checkSelectedItemsNumber:function(){0<this.getSelectedItems().length?f.removeClass(this.btnOk,"jimu-state-disabled"):
f.addClass(this.btnOk,"jimu-state-disabled")},_onTreeClick:function(){this._checkSelectedItemsNumber()},_onBtnOkClick:function(){var a=this.getSelectedItems();0<a.length&&this.emit("ok",a)},_onBtnCancelClick:function(){this.emit("cancel")}})})},"builder/plugins/attribute-config/dataSource/DataSourceConfigPopup":function(){define("dojo/_base/declare dojo/Evented dojo/on dojo/_base/lang dojo/_base/html jimu/dijit/Popup ./DataSourceConfig".split(" "),function(k,e,p,q,n,l,h){return k([l,e],{width:830,
height:580,titleLabel:"",dijitArgs:null,postCreate:function(){this.inherited(arguments);n.addClass(this.domNode,"data-source-config-popup");this._initDataSourceConfig()},_initDataSourceConfig:function(){this.dataSourceConfig=new h(this.dijitArgs);this.dataSourceConfig.placeAt(this.contentContainerNode);this.dataSourceConfig.startup();this.own(p(this.dataSourceConfig,"ok",q.hitch(this,function(e){this.emit("ok",e)})));this.own(p(this.dataSourceConfig,"cancel",q.hitch(this,function(){this.emit("cancel")})))}})})},
"builder/plugins/attribute-config/dataSource/DataSourceConfig":function(){define("dojo/_base/declare dojo/Evented dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./DataSourceConfig.html dojo/on dojo/_base/html dojo/_base/query dojo/dom-style jimu/dijit/Popup jimu/dijit/Filter dojo/_base/lang dojo/_base/array dojo/Deferred esri/request esri/tasks/query esri/tasks/QueryTask jimu/dijit/CheckBox jimu/dijit/Message jimu/utils jimu/Query jimu/LayerInfos/LayerInfos ./DataFields ./utils jimu/DataSourceManager jimu/dijit/DataPreviewTable jimu/dijit/LoadingIndicator dijit/form/ValidationTextBox dijit/form/Select dijit/form/NumberTextBox".split(" "),
function(k,e,p,q,n,l,h,f,d,c,a,b,g,u,m,r,t,v,y,w,z,x,A,C,B,E,D,F){return k([p,e,q,n],{templateString:l,baseClass:"data-sources-config",_layerDefinition:null,_filterObj:null,_filterByExtent:!1,_numberFieldTypes:["esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble"],postMixInProperties:function(){this.nls=g.mixin(this.nls,window.jimuNls.common)},postCreate:function(){this.inherited(arguments);this.setConfig(this.config);this._initEvent()},setConfig:function(a){a&&
(this.config=a,"Features"===this.config.type?(c.set(this.layerOnlyOption,{display:"block"}),this._initFeaturesFields()):"FeatureStatistics"===this.config.type&&(c.set(this.statisticsOnlyOption,{display:"block"}),this._initFeatureStatisticsFields()),this.reset(),this.sourceName.setValue(this.config.label||""),this.sourceUrl.set("value",this.config.url||""),this.sourceUrl.title=this.config.url||"",this.config.filter&&(this._filterObj=this.config.filter),"FeatureStatistics"!==this.config.type&&"undefined"!==
typeof this.config.filterByExtent&&(this._filterByExtent=this.config.filterByExtent),this._refreshFilterBtnDisplay(),this._setFilterExpr(),this._getDefinition().then(g.hitch(this,function(){this.queryType=x.getQueryType(this._layerDefinition);this._setRefreshInterval();"Features"===this.config.type?(this._setFeaturesFields(),this._setRecords(),this._setOrderByFieldForRecords()):"FeatureStatistics"===this.config.type&&(this._setStatisticsFields(),this._setGroupByFields())})))},_setFilterExpr:function(){var a=
"";this._filterObj&&(a=this._filterObj.expr);this._filterByExtent&&(a&&(a+="\x26"),a+="Extent\x3d"+!!this._filterByExtent);a||(a=this.nls.noFilter);this.filterExpr.innerText=""},_initFeaturesFields:function(){this.featuresFields=new C({nls:{moveUp:window.jimuNls.simpleTable.moveUp,moveDown:window.jimuNls.simpleTable.moveDown}});this.featuresFields.placeAt(this.fieldsOption);this.featuresFields.startup();this.own(h(this.featuresFields,"change",g.hitch(this,function(){this._layerDefinition&&this._setOrderByFieldForRecords()})))},
_setFeaturesFields:function(){var a=this._getFilteredFields(this._layerDefinition.fields,"esriFieldTypeGeometry");this.featuresFields.setFields(this._keepRequiredFields(a,!0));this.config.dataSchema&&z.isNotEmptyObject(this.config.dataSchema.fields)&&this.featuresFields.selectFields(this._getFieldsNames(this.config.dataSchema.fields,!1))},_setRecords:function(){3===this.queryType?(this._updateOptions(this.resultRecordType,null,"serviceLimitation"),this.resultRecordType.set("disabled",!0)):(this.resultRecordType.set("disabled",
!1),this.config.resultRecordType&&(this._updateOptions(this.resultRecordType,null,this.config.resultRecordType),"undefined"!==typeof this.config.resultRecordCount&&"custom"===this.config.resultRecordType&&this.customNumber.setValue(this.config.resultRecordCount)))},_setOrderByFieldForRecords:function(){if(1===this.queryType){this.orderFields.set("disabled",!1);var a=this._getFieldsForOrderBy();this._updateOptions(this.orderFields,a);if(this.config.dataSchema&&z.isNotEmptyObject(this.config.dataSchema.orderByFields)){var a=
this.config.dataSchema.orderByFields[0].split(" ")[0],a=this._getFieldLabelByFieldName(a),b=this.config.dataSchema.orderByFields[0].split(" ")[1];this._updateOptions(this.orderFields,null,a);"DESC"===b?this._onOrderClick(!1):this._onOrderClick(!0)}}else this.orderFields.set("disabled",!0)},_initFeatureStatisticsFields:function(){this.statisticsFields=new C({nls:{moveUp:window.jimuNls.simpleTable.moveUp,moveDown:window.jimuNls.simpleTable.moveDown}});this.statisticsFields.placeAt(this.statisticsFieldsOption);
this.statisticsFields.startup()},_setStatisticsFields:function(){var a=this._hasNumberFields(this._layerDefinition);a&&(a=this._getFilteredFields(a,"esriFieldTypeOID"),a=this._getFilteredFields(a,"esriFieldTypeGeometry"),this.statisticsFields.setFields(a),this.config.dataSchema&&z.isNotEmptyObject(this.config.dataSchema.fields)&&(a=this._getFieldsNames(this.config.dataSchema.fields,!1),this.config.dataSchema.groupByFields&&0<this.config.dataSchema.groupByFields.length&&a.splice(a.indexOf(this.config.dataSchema.groupByFields[0]),
1),this.statisticsFields.selectFields(a)))},_setGroupByFields:function(){if(this._layerDefinition&&this._layerDefinition.fields){var a=this._getFilteredFields(this._layerDefinition.fields,"esriFieldTypeGeometry"),a=this._handleFieldsForSelectOption(a);a.unshift({label:"-",value:"-"});this._updateOptions(this.groupFields,a);this.config.dataSchema&&this.config.dataSchema.groupByFields&&(a=this._getFieldLabelByFieldName(this.config.dataSchema.groupByFields[0]),this._updateOptions(this.groupFields,null,
a))}},_createFilterPopup:function(b){this.filterDomNode=f.toDom('\x3cdiv class\x3d"data-sources-filter"\x3e\x3cdiv class\x3d"filter-label"\x3e'+this.nls.extent+'\x3c/div\x3e\x3cdiv class\x3d"filterByExtent" style\x3d"margin-top: 10px;"\x3e\x3c/div\x3e\x3cdiv style\x3d"margin-top: 20px;" class\x3d"filter-label queryCritiera"\x3e'+this.nls.queryCritiera+'\x3c/div\x3e\x3cdiv style\x3d"margin-top: 15px;" class\x3d"filterDiv"\x3e\x3c/div\x3e\x3cdiv class\x3d"footer"\x3e\x3cdiv class\x3d"jimu-float-leading sample-btn data-preview textOverFlow"\x3e'+
this.nls.sampleData+'\x3c/div\x3e\x3cdiv class\x3d"jimu-btn jimu-float-trailing cancel btnCancel"\x3e'+this.nls.cancel+'\x3c/div\x3e\x3cdiv class\x3d"jimu-btn jimu-float-trailing ok jimu-trailing-margin1 btnOk"\x3e'+this.nls.ok+"\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e");if("FeatureStatistics"!==this.config.type){f.setStyle(d(".filter-label",this.filterDomNode)[0],"display","block");f.setStyle(d(".filterByExtent",this.filterDomNode)[0],"display","block");f.setStyle(d(".queryCritiera",this.filterDomNode)[0],
"margin-top","20px");var c=d(".filterByExtent",this.filterDomNode)[0];this.cbxFilterByExtent=new y({label:this.nls.filterByExtentLabel});this.cbxFilterByExtent.placeAt(c)}else f.setStyle(d(".filter-label",this.filterDomNode)[0],"display","none"),f.setStyle(d(".filterByExtent",this.filterDomNode)[0],"display","none"),f.setStyle(d(".queryCritiera",this.filterDomNode)[0],"margin-top","0");this.popup=new a({titleLabel:this.nls.dataSourceFilter,width:680,height:485,content:this.filterDomNode});c=this.sourceUrl.getValue().trim();
"set"===b?this._createNewFilter(c,"1\x3d1"):"config"===b&&this._editFilter(c,this._filterObj);b=d(".footer .btnOk",this.filterDomNode)[0];this.own(h(b,"click",g.hitch(this,function(){var a=this.filter.toJson();if(!a||!a.expr)return new w({message:window.jimuNls.filterBuilder.setFilterTip}),null;"FeatureStatistics"!==this.config.type&&(this._filterByExtent=this.cbxFilterByExtent.checked);this._filterObj=a;this._setFilterExpr();this.filter.destroy();this.filter=null;this.popup.close();this.popup=null;
this._refreshFilterBtnDisplay()})));b=d(".footer .btnCancel",this.filterDomNode)[0];this.own(h(b,"click",g.hitch(this,function(){this.filter.destroy();this.filter=null;this.popup.close();this.popup=null})));b=d(".sample-btn",this.filterDomNode)[0];this.own(h(b,"click",g.hitch(this,this._onSampleDataClick)))},_createFilter:function(){this.filter=new b({nls:this.nls,enableAskForValues:!1,style:"width:100%;"});var a=d(".filterDiv",this.filterDomNode)[0];this.filter.placeAt(a)},_editFilter:function(a,
b){this._createFilter();this.filter.buildByFilterObj(a,b,this._layerDefinition);this._filterByExtent&&this.cbxFilterByExtent.check()},_createNewFilter:function(a,b){this._createFilter();this.filter.buildByExpr(a,b,this._layerDefinition)},getConfig:function(){var a={};a.type=this.config.type;this.config.portalUrl&&(a.portalUrl=this.config.portalUrl);this.config.itemId&&(a.itemId=this.config.itemId);var b=!!this.isDynamic.checked;if(b){var c=this.refreshInterval.getValue();c&&(a.refreshInterval=Number(c))}a.isDynamic=
b;a.label=this.sourceName.getValue();a.url=this.sourceUrl.getValue().trim();"FeatureStatistics"!==this.config.type&&(a.filterByExtent=this._filterByExtent);this._filterObj&&(a.filter=this._filterObj);this.useLayerFilterCbx&&(a.useLayerFilter=this._useLayerFilter);"Features"===this.config.type&&(a=this._getFeaturesRecord(a));b=this._getVaildDataSchema();a.dataSchema=b;return a},_getFeaturesRecord:function(a){var b=this.resultRecordType.getValue();a.resultRecordType=b;"custom"===b&&(b=this.customNumber.getValue())&&
(a.resultRecordCount=parseInt(b,10));return a},_getVaildDataSchema:function(){var a={},b,c;b=z.getDataSchemaFromLayerDefinition(this._layerDefinition);b.objectIdField&&(a.objectIdFieldName=b.objectIdField.name||"");a.geometryType=b.geometryType||"";a.displayFieldName=b.displayField||"";a.typeIdField=b.typeIdField||"";if("Features"===this.config.type){if(b=this.featuresFields.getSelectedFieldNames(),b=this._getFieldsByFieldNames(b),a.fields=b||[],b=this.orderFields.getValue())b=this._getFieldNameByFieldLabel(b),
c=[],c.push(b+" "+this._getSelectedOrder()),a.orderByFields=c}else"FeatureStatistics"===this.config.type&&(c=this.statisticsFields.getSelectedFieldNames(),0===c.length&&a.objectIdFieldName&&c.push(a.objectIdFieldName),b=this._getFieldsByFieldNames(c),a.statistics=this._getStatisticDefinition(b,a.objectIdFieldName),b=g.clone(c),(c=this._getFieldNameByFieldLabel(this.groupFields.getValue()))?(b.push(c),a.groupByFields=[c]):a.groupByFields=[],a.fields=this._getFieldsByFieldNames(b)||[]);return a},_getFieldsByFieldNames:function(a){if(a)return 0===
a.length?[]:a.map(g.hitch(this,function(a){return this._getFieldByFieldName(a)}))},_getStatisticFields:function(a){var b=[];if(0>=a.length)return b;"count sum min max avg stddev".split(" ").forEach(g.hitch(this,function(c){"count"===c?b.push(this._getFormatStatisticField(a[0],c)):a.forEach(g.hitch(this,function(a){b.push(this._getFormatStatisticField(a,c))}))}));return b},_getFormatStatisticField:function(a,b){if(z.isNotEmptyObject(a)&&!Array.isArray(a))return a=g.clone(a),a.name=a.name+"_"+b,a},
_getStatisticDefinition:function(a,b){var c=[];["count","sum","min","max","avg"].forEach(g.hitch(this,function(d){"count"===d?c.push(this._getFormatStatisticDefinition(d,b)):a.forEach(g.hitch(this,function(a){c.push(this._getFormatStatisticDefinition(d,b,a))}))}));return c},_getFormatStatisticDefinition:function(a,b,c){var d={};if("count"===a)return d.onStatisticField=b||"*",d.outStatisticFieldName="count",d.statisticType=a,d;d.onStatisticField=c.name;d.outStatisticFieldName=c.name+"_"+a;d.statisticType=
a;return d},_getDefinition:function(){var a=new m;z.isObject(this.config.definition)?(this._layerDefinition=this.config.definition,a.resolve()):(this.loading.show(),r({url:this.config.url,content:{f:"json"},handleAs:"json"}).then(g.hitch(this,function(b){this.domNode?(this.loading.hide(),this._layerDefinition=b,a.resolve(b)):a.reject()}),g.hitch(this,function(b){console.error(b);a.reject();this.domNode&&this.loading.hide()})));return a},reset:function(){this.sourceName.setValue("");this.sourceUrl.set("value",
"");this.isDynamic.checked=!1;this.isDynamic.setStatus(!0);this.refreshInterval.set("disabled",!1);this.resultRecordType.set("disabled",!1);this.orderFields.set("disabled",!1);this._layerDefinition=null;this._filterByExtent=!1;this._filterObj=null;this.filterExpr.innerText="";this._refreshFilterBtnDisplay();"Features"===this.config.type?(this.featuresFields.setFields([]),this._updateOptions(this.resultRecordType),this._updateOptions(this.orderFields,[]),this._onOrderClick(!0),f.addClass(this.customNumberDiv,
"hide")):"FeatureStatistics"===this.config.type&&(this._updateOptions(this.groupFields,[{label:"-",value:"-"}]),this.statisticsFields.setFields([]))},_onFeaturesFieldsClick:function(a){a.stopPropagation();f.hasClass(this.fieldsOptionDiv,"hide")?f.removeClass(this.fieldsOptionDiv,"hide"):f.addClass(this.fieldsOptionDiv,"hide")},_showStatisticsFieldsList:function(){f.removeClass(this.statisticsFieldsOptionDiv,"hide")},_hideStatisticsFieldsList:function(){f.addClass(this.statisticsFieldsOptionDiv,"hide")},
_onStatisticsFieldsClick:function(a){a.stopPropagation();f.hasClass(this.statisticsFieldsOptionDiv,"hide")?this._showStatisticsFieldsList():this._hideStatisticsFieldsList()},_getFieldsNames:function(a,b){return a&&0!==a.length?a.map(function(a){return b?a.alias||a.name:a.name}):[]},_getStatisticsFieldRealNames:function(a){if(!a||0===a.length)return[];a=a.map(function(a){return a.replace(/(_count|_sum|_max|_min|_avg|_stddev)$/,"")});a=z.uniqueArray(a);if(this.config.dataSchema.groupByFields){var b=
this.config.dataSchema.groupByFields[0];b&&"-"!==b&&(a=a.filter(function(a){return a!==b}))}return a},_getFieldsForOrderBy:function(){var a=[],b=this.featuresFields.getSelectedFieldNames();b&&0<b.length&&(a=this._getFieldsByFieldNames(b),a=this._getFilteredFields(a,"esriFieldTypeGeometry"),a=this._handleFieldsForSelectOption(a));return a},_getFieldByFieldName:function(a){if(this._layerDefinition&&this._layerDefinition.fields){var b;this._layerDefinition.fields.forEach(function(c){c.name===a&&(b=c)});
return b}},_getFieldNameByFieldLabel:function(a){if(this._layerDefinition&&this._layerDefinition.fields){var b;this._layerDefinition.fields.forEach(function(c){if(c.alias===a||c.name===a)b=c.name});return b}},_getFieldLabelByFieldName:function(a){if(this._layerDefinition&&this._layerDefinition.fields){var b;this._layerDefinition.fields.forEach(function(c){c.name===a&&(b=c.alias||c.name)});return b}},_handleFieldsForSelectOption:function(a){return!a||0>=a.length?[]:a=a.map(function(b){var c;"object"===
typeof a[0]?c=b.alias||b.name:"string"===typeof a[0]&&(c=b);return{label:c,value:c}})},_updateOptions:function(a,b,c){b?(a.removeOption(a.getOptions()),a.addOption(b)):b=[];!c&&0<b.length&&(c=b[0].value);c&&a.set("value",c)},_setRefreshInterval:function(){this._settingRefreshIntervalFromMapLayer()||(this.config.isDynamic?(this.isDynamic.check(),this.config.refreshInterval&&this.refreshInterval.setValue(this.config.refreshInterval)):this.isDynamic.uncheck())},_settingRefreshIntervalFromMapLayer:function(){var a;
this.config.layerInfo?a=this.config.layerInfo:this.config.id&&"map"===this.config.id.split("~")[0]&&(a=this.config.id.split("~")[1],a=A.getInstanceSync().getLayerInfoById(a));if(a&&a.layerObject&&a.layerObject.refreshInterval)return this.isDynamic.check(),this.refreshInterval.setValue(a.layerObject.refreshInterval),this.refreshInterval.set("disabled",!0),this.isDynamic.setStatus(!1),!0},_checkConfigValue:function(){var a=!0;this.sourceName.getValue()&&this.sourceUrl.getValue().trim()||(a=!1);!this.isDynamic.checked||
this.refreshInterval.isValid()&&this.refreshInterval.getValue()||(a=!1);"custom"!==this.resultRecordType.getValue()||this.customNumber.isValid()||(a=!1);if("FeatureStatistics"===this.config.type){var b=this.statisticsFields.getSelectedFieldNames(),c=this._getFieldNameByFieldLabel(this.groupFields.getValue());-1<b.indexOf(c)&&(new w({message:this.nls.groupFieldIsNotAllowedInStatistics}),a=!1)}return a},_hasNumberFields:function(a){var b=!1;(a=a.fields)&&0<a.length&&(b=u.filter(a,g.hitch(this,function(a){return 0<=
this._numberFieldTypes.indexOf(a.type)})));return b},_refreshFilterBtnDisplay:function(){this._filterObj||this._filterByExtent?(f.addClass(this.btnConfig,"visible"),f.addClass(this.btnRemove,"visible"),f.removeClass(this.btnSet,"visible")):(f.removeClass(this.btnConfig,"visible"),f.removeClass(this.btnRemove,"visible"),f.addClass(this.btnSet,"visible"))},_initEvent:function(){this.own(h(document.body,"click",g.hitch(this,function(a){var b=a.target||a.srcElement;this.featuresFields?(a=b===this.featuresFields.domNode,
b=f.isDescendant(b,this.featuresFields.domNode),a||b||f.addClass(this.fieldsOptionDiv,"hide")):this.statisticsFields&&(a=b===this.statisticsFields.domNode,b=f.isDescendant(b,this.statisticsFields.domNode),a||b||f.addClass(this.statisticsFieldsOptionDiv,"hide"))})));this.own(h(this.resultRecordType,"change",g.hitch(this,function(a){"custom"===a?f.removeClass(this.customNumberDiv,"hide"):f.addClass(this.customNumberDiv,"hide")})));this.own(h(this.btnOk,"click",g.hitch(this,function(){this._checkConfigValue()&&
this.emit("ok",this.getConfig())})));this.own(h(this.btnCancel,"click",g.hitch(this,function(){this.emit("cancel")})));this.own(h(this.ascBtn,"click",g.hitch(this,function(){this._onOrderClick(!0)})));this.own(h(this.descBtn,"click",g.hitch(this,function(){this._onOrderClick()})));this._initFilterBtnEvent()},_onOrderClick:function(a){a?(f.addClass(this.ascBtn,"selected"),f.removeClass(this.descBtn,"selected")):(f.removeClass(this.ascBtn,"selected"),f.addClass(this.descBtn,"selected"))},_getSelectedOrder:function(){var a;
f.hasClass(this.ascBtn,"selected")?a="ASC":f.hasClass(this.descBtn,"selected")&&(a="DESC");return a},_initFilterBtnEvent:function(){this.own(h(this.btnSet,"click",g.hitch(this,function(){this._createFilterPopup("set")})));this.own(h(this.btnConfig,"click",g.hitch(this,function(){this._createFilterPopup("config")})));this.own(h(this.btnRemove,"click",g.hitch(this,function(){var a=new w({message:this.nls.removeFilterMessage,buttons:[{label:this.nls.ok,onClick:g.hitch(this,function(){this._filterObj=
null;this._filterByExtent=!1;this._setFilterExpr();this._refreshFilterBtnDisplay();a.content=null;a.close()})},{label:this.nls.cancel,onClick:g.hitch(this,function(){a.content=null;a.close()})}]})})))},_keepRequiredFields:function(a,b){return a?a=a.map(function(a){"undefined"!==typeof a.nullable?(a.checked=!a.nullable,a.disabled=!a.nullable):(a.checked="esriFieldTypeOID"===a.type,a.disabled="esriFieldTypeOID"===a.type);b&&(a.checked=!0);return a}):[]},_getFilteredFields:function(a,b){return a?a=a.filter(function(a){return a.type!==
b}):[]},_isServiceSupportsOrderBy:function(a){var b=!1;a.advancedQueryCapabilities&&a.advancedQueryCapabilities.supportsOrderBy&&(b=!0);return b},_onSampleDataClick:function(){var a=new v(this.config.url),b=new t;b.where="1\x3d1";b.outFields=["*"];b.returnGeometry=!1;a.execute(b).then(g.hitch(this,function(a){a.features=a.features.slice(0,10);this._showDataPreviewTable(a,"sampleData")}))},_onPreviewClick:function(){if(this._checkConfigValue()){this.dataPreviewTableLoading||(this.dataPreviewTableLoading=
new F,this.dataPreviewTableLoading.placeAt(this.domNode));this.dataPreviewTableLoading.show();var a=g.clone(this.getConfig());a.id=this.config.id?this.config.id:B.createDataSourceId(this.config.serviceType,this.config.layerInfo?this.config.layerInfo.id:null);E.getInstance().doQuery(a).then(g.hitch(this,function(b){if(a.dataSchema.groupByFields&&0<a.dataSchema.groupByFields.length)var c=a.dataSchema.groupByFields.length[0];b.fields&&(b.fields=b.fields.sort(function(a,b){return a.name===c?1:a.name-
b.name}));this._showDataPreviewTable(b,"preview")}),g.hitch(this,function(){this.dataPreviewTableLoading.hide()}))}},_showDataPreviewTable:function(b,c){this.dataPreviewPopup=new a({titleLabel:"preview"===c?this.nls.preview:this.nls.sampleData,width:800,height:610,content:new D({height:610,featureSet:b,loadingIndicator:this.dataPreviewTableLoading}),onClose:g.hitch(this,function(){this.dataPreviewTableLoading&&this.dataPreviewTableLoading.hide&&this.dataPreviewTableLoading.hide()})});f.addClass(this.dataPreviewPopup.domNode,
"data-preview-popup")},destroy:function(){this.filter&&this.filter.destroy();this.dataPreviewTableLoading&&this.dataPreviewTableLoading.destroy();this.dataPreviewPopup&&this.dataPreviewPopup.destroy();this.inherited(arguments)}})})},"dojo/_base/query":function(){define(["../query","./NodeList"],function(k){return k})},"jimu/dijit/Filter":function(){define("dojo/on dojo/Evented dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/Filter.html jimu/filterUtils jimu/utils jimu/LayerInfos/LayerInfos jimu/dijit/_filter/ValueProviderFactory dijit/registry dojo/_base/lang dojo/_base/html dojo/_base/array dojo/aspect dojo/Deferred esri/request ./_SingleFilter ./_FilterSet ./LoadingIndicator".split(" "),
function(k,e,p,q,n,l,h,f,d,c,a,b,g,u,m,r,t,v,y,w){return p([q,n,l,f,e],{templateString:h,baseClass:"jimu-filter",declaredClass:"jimu.dijit.Filter",nls:null,autoSwitchMode:!0,_validOptions:!1,_layerDefinition:null,_def:null,valueProviderFactory:null,featureLayerId:null,layerInfosObj:null,mode:"desktop",noFilterTip:"",enableAskForValues:!1,mobileBreakWidth:600,postMixInProperties:function(){this.nls=window.jimuNls.filterBuilder;var a=this.nls.matchMsg.split("${any_or_all}");this.nls.strMatchMsgPart1=
a[0]||"";this.nls.strMatchMsgPart2=a[1]||"";this.nls.add=window.jimuNls.common.add;this.nls.apply=window.jimuNls.common.apply;this.layerInfosObj=c.getInstanceSync();this.inherited(arguments)},postCreate:function(){this.inherited(arguments);this._setDesktopMode();this.noFilterTip&&"string"===typeof this.noFilterTip&&(this.noFilterTipSection.innerHTML=this.noFilterTip)},startup:function(){this.inherited(arguments);this.autoUpdateMode()},resize:function(){this.autoUpdateMode()},autoUpdateMode:function(){this.autoSwitchMode&&
(this._clearMode(),this.domNode.clientWidth>=this.mobileBreakWidth?this._setDesktopMode():this._setMobileMode())},setMode:function(a){"desktop"===a?this._setDesktopMode():"mobile"===a&&this._setMobileMode()},_setMode:function(a){this.mode=a;this._setModeClass(this.mode)},_setModeClass:function(a){u.removeClass(this.domNode,"desktop-mode");u.removeClass(this.domNode,"mobile-mode");u.addClass(this.desktopAddSection,"hidden");u.addClass(this.mobileAddSection,"hidden");a&&u.addClass(this.domNode,a+"-mode")},
_clearMode:function(){this._setModeClass("")},_setDesktopMode:function(){this._setMode("desktop");u.removeClass(this.desktopAddSection,"hidden")},_setMobileMode:function(){this._setMode("mobile");u.removeClass(this.mobileAddSection,"hidden")},reset:function(){this.isBuilding()||(this.removeAllFilters(),this.url=null,this.isHosted=!1,this.valueProviderFactory=this.partsObj=this.expr=this.featureLayerId=this._layerDefinition=null)},isBuilding:function(){return this._def&&!this._def.isFulfilled()},build:function(a){var b=
new t;this.isBuilding()?b.reject("Filter is already building."):(this._def=null,this.reset(),this.url=a.url,this.isHosted=d.isHostedService(this.url),this._layerDefinition=a.layerDefinition,this.featureLayerId=a.featureLayerId,a.partsObj?(this.partsObj=this._updatePartsObj(a.partsObj),this._def=this._init("partsObj")):(this.expr=a.expr||"1\x3d1",this._def=this._init("expr")),b=this._def);return b},buildByExpr:function(a,b,c){console.warn("Filter#buildByExpr() method is deprecated, please use Filter#build() instead.");
return this.build({url:a,expr:b,layerDefinition:c,featureLayerId:this.featureLayerId})},buildByFilterObj:function(a,b,c){console.warn("Filter#buildByFilterObj() method is deprecated, please use Filter#build() instead.");return this.build({url:a,partsObj:b,layerDefinition:c,featureLayerId:this.featureLayerId})},_updatePartsObj:function(a){m.forEach(a,g.hitch(this,function(a){a.parts?m.forEach(a.parts,g.hitch(this,function(a){a.interactiveObj&&!0===a.interactiveObj.cascade?a.interactiveObj.cascade=
"previous":!1===a.interactiveObj.cascade&&(a.interactiveObj.cascade="none")})):a.interactiveObj&&!0===a.interactiveObj.cascade?a.interactiveObj.cascade="previous":!1===a.interactiveObj.cascade&&(a.interactiveObj.cascade="none")}));return a},removeAllFilters:function(){this._destroyAllFilters()},_getLayerDefinitionRaw:function(a,b){var c=new t;b?c.resolve(b):(this.loading.show(),v({url:a,content:{f:"json"},handleAs:"json",callbackParamName:"callback"}).then(g.hitch(this,function(a){this.domNode?(this.loading.hide(),
c.resolve(a)):c.reject()}),g.hitch(this,function(a){console.error(a);c.reject();this.domNode&&this.loading.hide()})));return c},_validateLayerDefinition:function(a){return this._isObject(a)},_init:function(b){var c=new t;if(!this._isString(this.url))return c.reject(),c;var d=g.hitch(this,function(){setTimeout(g.hitch(this,function(){this.emit("change");c.resolve()}),1500)}),e=g.hitch(this,function(){u.addClass(this.errorSection,"hidden");this.removeAllFilters();this.featureLayerId&&this._tryOverrideFieldAliases(this.featureLayerId,
this._layerDefinition);var e=this._layerDefinition.fields;e&&0<e.length?(e=m.filter(e,g.hitch(this,function(a){return 0<=this._supportFieldTypes.indexOf(a.type)})))&&0<e.length?(this._validOptions=!0,u.removeClass(this.btnAddSetDesktop,"jimu-state-disabled"),u.removeClass(this.btnAddExpDesktop,"jimu-state-disabled"),u.removeClass(this.btnAddSetMobile,"jimu-state-disabled"),u.removeClass(this.btnAddExpMobile,"jimu-state-disabled"),this.createFieldsStore(),this.valueProviderFactory=new a({url:this.url,
layerDefinition:this._layerDefinition,featureLayerId:this.featureLayerId}),"expr"===b?this._isString(this.expr)?("1\x3d1"===this.expr.replace(/\s/gi,"")&&this.removeAllFilters(),this._parseExpr(this.expr)?d():c.reject()):c.reject():"partsObj"===b?this._validatePartsObj(this.partsObj)?(this._parsePartsObj(this.partsObj),d()):c.reject():this._validatePartsObj(this.partsObj)?(this._parsePartsObj(this.partsObj),d()):this._isString(this.expr)?this._parseExpr(this.expr)?d():c.reject():(this.removeAllFilters(),
d())):(this._showErrorOptions(this.nls.error.noFilterFields),c.reject()):c.reject()});this._validateLayerDefinition(this._layerDefinition)?e():(this.loading.show(),v({url:this.url,content:{f:"json"},handleAs:"json",callbackParamName:"callback"}).then(g.hitch(this,function(a){this.domNode?(this.loading.hide(),this._layerDefinition=a,e()):c.reject()}),g.hitch(this,function(a){console.error(a);c.reject();this.domNode&&this.loading.hide()})));return c},_tryOverrideFieldAliases:function(a,b){if(a=this.layerInfosObj.getLayerOrTableInfoById(a))if(a=
a.getPopupInfo())if(a=a.fieldInfos,b=b.fields,a&&0<a.length&&b&&0<b.length){var c={};m.forEach(a,g.hitch(this,function(a){a.fieldName&&(c[a.fieldName]=a)}));m.forEach(b,g.hitch(this,function(a){var b=c[a.name];b&&b.label&&(a.alias=b.label)}))}},toJson:function(){var a={logicalOperator:this.allAnySelect.value,parts:[]},b=this._getAllSingleFiltersAndFilterSets();if(0===b.length)return a.expr="1\x3d1",a;m.forEach(b,g.hitch(this,function(b){b=b.toJson();a.parts.push(b)}));return m.every(a.parts,g.hitch(this,
function(a){return!!a}))&&0<a.parts.length?(a.expr=this.getExprByFilterObj(a),a):null},createFieldsStore:function(){if(this._layerDefinition.fields&&0!==this._layerDefinition.fields.length){var a=g.clone(this._layerDefinition).fields;0===this.setFieldsStoreByFieldInfos(a)&&this._showErrorOptions(this.nls.error.noFilterFields)}else this._showErrorOptions(this.nls.error.noFilterFields)},_parsePartsObj:function(a){this._validatePartsObj(a)&&(this.removeAllFilters(),this._buildEditUIByPartsObj(a))},_parseExpr:function(a){this._destroyAllFilters();
var b=null;if(!this._validateLayerDefinition(this._layerDefinition))return b;if(!a||"string"!==typeof a)return this._showErrorOptions(this.nls.error.invalidSQL),b;if("1\x3d1"===this.expr.replace(/\s/gi,""))return b={expr:"1\x3d1",parts:[],logicalOperator:"AND"};try{b=this.getFilterObjByExpr(a)}catch(A){b=null,console.error(A)}b?this._buildEditUIByPartsObj(b):this._showErrorOptions(this.nls.error.cantParseSQL);return b},_buildEditUIByPartsObj:function(a){a&&(this._destroyAllFilters(),this.allAnySelect.value=
a.logicalOperator,m.forEach(a.parts,g.hitch(this,function(a){a.parts?this._addFilterSet(a):a.fieldObj&&a.operator&&a.valueObj&&this._addSingleFilter(a)})))},_addSingleFilter:function(a){a={url:this.url,layerInfo:this._layerDefinition,stringFieldType:this._stringFieldType,dateFieldType:this._dateFieldType,numberFieldTypes:this._numberFieldTypes,part:a,OPERATORS:g.mixin({},this.OPERATORS),enableAskForValues:this.enableAskForValues,isHosted:this.isHosted,valueProviderFactory:this.valueProviderFactory};
a=new y(a);a.placeAt(this.allExpsBox);a.startup();this.own(r.after(a,"_destroySelf",g.hitch(this,function(){this._checkFilterNumbers();this.emit("change")})));this.own(k(a,"change",g.hitch(this,function(){this.emit("change")})));this._checkFilterNumbers();return a},_addFilterSet:function(a){a={url:this.url,layerInfo:this._layerDefinition,stringFieldType:this._stringFieldType,dateFieldType:this._dateFieldType,numberFieldTypes:this._numberFieldTypes,partsObj:a,OPERATORS:g.mixin({},this.OPERATORS),enableAskForValues:this.enableAskForValues,
isHosted:this.isHosted,valueProviderFactory:this.valueProviderFactory};a=new w(a);a.placeAt(this.allExpsBox);a.startup();this.own(r.after(a,"_destroySelf",g.hitch(this,function(){this._checkFilterNumbers();this.emit("change")})));this.own(k(a,"change",g.hitch(this,function(){this.emit("change")})));this._checkFilterNumbers();return a},_destroyAllFilters:function(){for(var a=this._getAllSingleFiltersAndFilterSets();0<a.length;)a[0].destroy(),a.splice(0,1);this._checkFilterNumbers()},_getAllSingleFiltersAndFilterSetsDoms:function(){var a=
[];this.allExpsBox.childNodes&&0<this.allExpsBox.childNodes.length&&m.forEach(this.allExpsBox.childNodes,g.hitch(this,function(b){(u.hasClass(b,"jimu-single-filter")||u.hasClass(b,"jimu-filter-set"))&&a.push(b)}));return a},_getAllSingleFiltersAndFilterSets:function(){var a=this._getAllSingleFiltersAndFilterSetsDoms();return m.map(a,g.hitch(this,function(a){return b.byNode(a)}))},_checkFilterNumbers:function(){0<this._getAllSingleFiltersAndFilterSetsDoms().length?u.addClass(this.noFilterTipSection,
"hidden"):u.removeClass(this.noFilterTipSection,"hidden");this.emit("filter-number-change")},_showErrorOptions:function(a){console.error(a);u.addClass(this.errorSection,"hidden");this.errorTip.innerHTML=a;this.loading.hide()},_onBtnApplyClicked:function(){this.emit("apply")},_onBtnAddSetClick:function(){this._layerDefinition&&this._validOptions&&(this._addFilterSet(),this.emit("change"))},_onBtnAddExpClick:function(){this._layerDefinition&&this._validOptions&&(this._addSingleFilter(),this.emit("change"))}})})},
"jimu/dijit/_filter/ValueProviderFactory":function(){define("dojo/_base/lang dojo/_base/array dojo/_base/declare ./BlankValueProvider ./SimpleValueProvider ./TwoNumbersValueProvider ./TwoDatesValueProvider ./ListValueProvider ./NumberListValueProvider ./DateIsInValueProvider jimu/LayerInfos/LayerInfos".split(" "),function(k,e,p,q,n,l,h,f,d,c,a){var b={stringOperatorIs:{value:{normalProviderType:"SIMPLE_VALUE_PROVIDER",codedValueProviderType:"LIST_VALUE_PROVIDER",supportAskForValue:!0},field:{normalProviderType:"LIST_VALUE_PROVIDER"},
unique:{normalProviderType:"LIST_VALUE_PROVIDER",supportAskForValue:!0,filterCodedValueIfPossible:!0}},stringOperatorIsNot:{value:{normalProviderType:"SIMPLE_VALUE_PROVIDER",supportAskForValue:!0},field:{normalProviderType:"LIST_VALUE_PROVIDER"},unique:{normalProviderType:"LIST_VALUE_PROVIDER",supportAskForValue:!0,filterCodedValueIfPossible:!0}},stringOperatorStartsWith:{value:{normalProviderType:"SIMPLE_VALUE_PROVIDER",supportAskForValue:!0,supportCaseSensitive:!0}},stringOperatorEndsWith:{value:{normalProviderType:"SIMPLE_VALUE_PROVIDER",
supportAskForValue:!0,supportCaseSensitive:!0}},stringOperatorContains:{value:{normalProviderType:"SIMPLE_VALUE_PROVIDER",supportAskForValue:!0,supportCaseSensitive:!0}},stringOperatorDoesNotContain:{value:{normalProviderType:"SIMPLE_VALUE_PROVIDER",supportAskForValue:!0,supportCaseSensitive:!0}},stringOperatorIsBlank:{value:{normalProviderType:"BLANK_VALUE_PROVIDER"}},stringOperatorIsNotBlank:{value:{normalProviderType:"BLANK_VALUE_PROVIDER"}},numberOperatorIs:{value:{normalProviderType:"SIMPLE_VALUE_PROVIDER",
codedValueProviderType:"LIST_VALUE_PROVIDER",supportAskForValue:!0},field:{normalProviderType:"LIST_VALUE_PROVIDER"},unique:{normalProviderType:"LIST_VALUE_PROVIDER",supportAskForValue:!0,filterCodedValueIfPossible:!0}},numberOperatorIsNot:{value:{normalProviderType:"SIMPLE_VALUE_PROVIDER",supportAskForValue:!0},field:{normalProviderType:"LIST_VALUE_PROVIDER"},unique:{normalProviderType:"LIST_VALUE_PROVIDER",supportAskForValue:!0,filterCodedValueIfPossible:!0}},numberOperatorIsAtLeast:{value:{normalProviderType:"SIMPLE_VALUE_PROVIDER",
supportAskForValue:!0},field:{normalProviderType:"LIST_VALUE_PROVIDER"},unique:{normalProviderType:"LIST_VALUE_PROVIDER",supportAskForValue:!0,filterCodedValueIfPossible:!0}},numberOperatorIsLessThan:{value:{normalProviderType:"SIMPLE_VALUE_PROVIDER",supportAskForValue:!0},field:{normalProviderType:"LIST_VALUE_PROVIDER"},unique:{normalProviderType:"LIST_VALUE_PROVIDER",supportAskForValue:!0,filterCodedValueIfPossible:!0}},numberOperatorIsAtMost:{value:{normalProviderType:"SIMPLE_VALUE_PROVIDER",supportAskForValue:!0},
field:{normalProviderType:"LIST_VALUE_PROVIDER"},unique:{normalProviderType:"LIST_VALUE_PROVIDER",supportAskForValue:!0,filterCodedValueIfPossible:!0}},numberOperatorIsGreaterThan:{value:{normalProviderType:"SIMPLE_VALUE_PROVIDER",supportAskForValue:!0},field:{normalProviderType:"LIST_VALUE_PROVIDER"},unique:{normalProviderType:"LIST_VALUE_PROVIDER",supportAskForValue:!0,filterCodedValueIfPossible:!0}},numberOperatorIsBetween:{value:{normalProviderType:"TWO_NUMBERS_VALUE_PROVIDER",supportAskForValue:!0}},
numberOperatorIsNotBetween:{value:{normalProviderType:"TWO_NUMBERS_VALUE_PROVIDER",supportAskForValue:!0}},numberOperatorIsBlank:{value:{normalProviderType:"BLANK_VALUE_PROVIDER"}},numberOperatorIsNotBlank:{value:{normalProviderType:"BLANK_VALUE_PROVIDER"}},dateOperatorIsOn:{value:{normalProviderType:"SIMPLE_VALUE_PROVIDER",supportAskForValue:!0},field:{normalProviderType:"LIST_VALUE_PROVIDER"}},dateOperatorIsNotOn:{value:{normalProviderType:"SIMPLE_VALUE_PROVIDER",supportAskForValue:!0},field:{normalProviderType:"LIST_VALUE_PROVIDER"}},
dateOperatorIsIn:{value:{normalProviderType:"DATE_IS_IN_VALUE_PROVIDER",supportAskForValue:!0}},dateOperatorIsNotIn:{value:{normalProviderType:"DATE_IS_IN_VALUE_PROVIDER",supportAskForValue:!0}},dateOperatorIsBefore:{value:{normalProviderType:"SIMPLE_VALUE_PROVIDER",supportAskForValue:!0},field:{normalProviderType:"LIST_VALUE_PROVIDER"}},dateOperatorIsAfter:{value:{normalProviderType:"SIMPLE_VALUE_PROVIDER",supportAskForValue:!0},field:{normalProviderType:"LIST_VALUE_PROVIDER"}},dateOperatorIsOnOrBefore:{value:{normalProviderType:"SIMPLE_VALUE_PROVIDER",
supportAskForValue:!0},field:{normalProviderType:"LIST_VALUE_PROVIDER"}},dateOperatorIsOnOrAfter:{value:{normalProviderType:"SIMPLE_VALUE_PROVIDER",supportAskForValue:!0},field:{normalProviderType:"LIST_VALUE_PROVIDER"}},dateOperatorInTheLast:{value:{normalProviderType:"NUMBER_LIST_VALUE_PROVIDER",supportAskForValue:!0}},dateOperatorNotInTheLast:{value:{normalProviderType:"NUMBER_LIST_VALUE_PROVIDER",supportAskForValue:!0}},dateOperatorIsBetween:{value:{normalProviderType:"TWO_DATES_VALUE_PROVIDER",
supportAskForValue:!0}},dateOperatorIsNotBetween:{value:{normalProviderType:"TWO_DATES_VALUE_PROVIDER",supportAskForValue:!0}},dateOperatorIsBlank:{value:{normalProviderType:"BLANK_VALUE_PROVIDER"}},dateOperatorIsNotBlank:{value:{normalProviderType:"BLANK_VALUE_PROVIDER"}}},g=p([],{nls:null,layerInfo:null,popupInfo:null,url:null,layerDefinition:null,featureLayerId:null,constructor:function(b){k.mixin(this,b);this.nls=window.jimuNls.filterBuilder;b=a.getInstanceSync();this.featureLayerId&&(this.layerInfo=
b.getLayerOrTableInfoById(this.featureLayerId))&&(this.popupInfo=this.layerInfo.getPopupInfo())},getSupportedValueTypes:function(a,c){var d=[];if(c=b[c])c.value&&d.push("value"),c.field&&0<this._getSameShortTypeFieldNames(a).length&&d.push("field"),c.unique&&this.url&&(this._isStreamServer(this.url)||10.1<=parseFloat(this.layerDefinition.currentVersion)&&d.push("unique"));return d},_isStreamServer:function(a){a=(a||"").replace(/\/*$/g,"");return/\/StreamServer$/gi.test(a)},_getSameShortTypeFieldNames:function(a){var b=
[],c=this._getFieldInfo(this.layerDefinition,a),d=g.getShortTypeByEsriType(c.type);e.forEach(this.layerDefinition.fields,k.hitch(this,function(c){c.name!==a&&g.getShortTypeByEsriType(c.type)===d&&b.push(c.name)}));return b},getValueProvider:function(a,g){var m=null,p=k.clone(b[a.operator]);if(p){var u=a.valueObj.type,y=a.fieldObj.name,w=this._getFieldInfo(this.layerDefinition,y),z=p[u],x=z.normalProviderType,A=null,C=this._getCodedValues(w);C||this.layerDefinition.typeIdField&&this.layerDefinition.typeIdField.toUpperCase()===
y.toUpperCase()&&(C=this._getSubTypes(this.layerDefinition));"field"===u?(u=this._getSameShortTypeFieldNames(y),0<u.length&&(A=e.map(u,k.hitch(this,function(a){return{value:a,label:a}})))):C&&0<C.length&&z.codedValueProviderType&&(x=z.codedValueProviderType);a={nls:this.nls,url:this.url,layerDefinition:this.layerDefinition,partObj:a,fieldInfo:w,codedValues:C,staticValues:A,layerInfo:this.layerInfo,popupInfo:this.popupInfo,operatorInfo:p,filterCodedValueIfPossible:!!z.filterCodedValueIfPossible,runtime:g};
"BLANK_VALUE_PROVIDER"===x?m=new q(a):"SIMPLE_VALUE_PROVIDER"===x?m=new n(a):"TWO_NUMBERS_VALUE_PROVIDER"===x?m=new l(a):"TWO_DATES_VALUE_PROVIDER"===x?m=new h(a):"LIST_VALUE_PROVIDER"===x?(a.showNullValues=!1,m=new f(a)):"NUMBER_LIST_VALUE_PROVIDER"===x?m=new d(a):"DATE_IS_IN_VALUE_PROVIDER"===x&&(m=new c(a))}return m},_getFieldInfo:function(a,b){a=a.fields;for(var c=0;c<a.length;c++){var d=a[c];if(b===d.name)return d}return null},_getCodedValues:function(a){var b=null;(a=a.domain)&&"codedValue"===
a.type&&a.codedValues&&0<a.codedValues.length&&(b=a.codedValues,b=e.map(b,k.hitch(this,function(a){return{value:a.code,label:a.name}})));return b},_getSubTypes:function(a){var b=null;a.typeIdField&&a.types&&0<a.types.length&&(b=e.map(a.types,k.hitch(this,function(a){return{value:a.id,label:a.name}})));return b}});g.getOperatorInfo=function(a){return k.clone(b[a])};g.getOperatorsByShortType=function(a){var b=[];"string"===a?b="stringOperatorIs stringOperatorIsNot stringOperatorStartsWith stringOperatorEndsWith stringOperatorContains stringOperatorDoesNotContain stringOperatorIsBlank stringOperatorIsNotBlank".split(" "):
"number"===a?b="numberOperatorIs numberOperatorIsNot numberOperatorIsAtLeast numberOperatorIsLessThan numberOperatorIsAtMost numberOperatorIsGreaterThan numberOperatorIsBetween numberOperatorIsNotBetween numberOperatorIsBlank numberOperatorIsNotBlank".split(" "):"date"===a&&(b="dateOperatorIsOn dateOperatorIsNotOn dateOperatorIsIn dateOperatorIsNotIn dateOperatorIsBefore dateOperatorIsAfter dateOperatorIsOnOrBefore dateOperatorIsOnOrAfter dateOperatorInTheLast dateOperatorNotInTheLast dateOperatorIsBetween dateOperatorIsNotBetween dateOperatorIsBlank dateOperatorIsNotBlank".split(" "));
return b};g.getShortTypeByEsriType=function(a){var b=null;"esriFieldTypeString"===a?b="string":"esriFieldTypeDate"===a?b="date":0<=["esriFieldTypeOID","esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble"].indexOf(a)&&(b="number");return b};return g})},"jimu/dijit/_filter/BlankValueProvider":function(){define(["dojo/_base/html","dojo/_base/declare","./ValueProvider"],function(k,e,p){return e([p],{templateString:"\x3cdiv\x3e\x3c/div\x3e",postCreate:function(){this.inherited(arguments);
k.addClass(this.domNode,"jimu-filter-blank-value-provider")},getDijits:function(){return[]},getStatus:function(){return 1},setValueObject:function(){},getValueObject:function(){return{isValid:!0,type:this.partObj.valueObj.type,value:null}},isBlankValueProvider:function(){return!0}})})},"jimu/dijit/_filter/ValueProvider":function(){define("dojo/on dojo/Evented dojo/_base/lang dojo/_base/html dojo/_base/array dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin jimu/utils esri/lang".split(" "),
function(k,e,p,q,n,l,h,f,d,c){return l([h,f,e],{baseClass:"jimu-filter-value-provider",fieldName:null,shortType:null,_enabled:!1,cascade:"none",filterCodedValue:!1,fieldPopupInfo:null,nls:null,url:null,layerDefinition:null,fieldInfo:null,partObj:null,runtime:!0,staticValues:null,codedValues:null,layerInfo:null,popupInfo:null,operatorInfo:null,filterCodedValueIfPossible:!1,postMixInProperties:function(){this.inherited(arguments);this.shortType=this.partObj.fieldObj.shortType;this.fieldName=this.partObj.fieldObj.name;
this.cascade=this.partObj.interactiveObj&&this.partObj.interactiveObj.cascade;this.runtime&&this.codedValues&&this.filterCodedValueIfPossible&&d.isCodedValuesSupportFilter(this.layerDefinition,this.codedValues.length)?this.filterCodedValue=!0:this.filterCodedValue=!1;this.popupInfo&&this.popupInfo.fieldInfos&&0<this.popupInfo.fieldInfos.length&&n.some(this.popupInfo.fieldInfos,p.hitch(this,function(a){return a.fieldName===this.fieldName?(this.fieldPopupInfo=a,!0):!1}))},getDijits:function(){return[]},
bindChangeEvents:function(){var a=this.getDijits();n.forEach(a,p.hitch(this,function(a){a.declaredClass&&0===a.declaredClass.indexOf("dijit.")&&q.addClass(a.domNode,a.declaredClass.replace(/\./g,"-"));this.own(k(a,"change",p.hitch(this,this._onChanged)));this.own(k(a,"enter",p.hitch(this,this._onEnter)))}))},_onChanged:function(){this._onEnterTriggered||this.emit("change")},_onEnterTriggered:!1,_onEnter:function(){this._onEnterTriggered=!0;this.emit("change");setTimeout(p.hitch(this,function(){this._onEnterTriggered=
!1}),100)},tryLocaleNumber:function(a){var b=d.localizeNumber(a);if(null===b||void 0===b)b=a;return b},getPartObject:function(){var a=this.getValueObject();if(!a)return null;var b=p.clone(this.partObj);b.valueObj=a;return b},setValueObject:function(){},getValueObject:function(){},tryGetValueObject:function(){return this.getValueObject()},setRequired:function(){},getStatus:function(){var a=1,b=this.getDijits();0<b.length&&(a=n.map(b,p.hitch(this,function(a){return"function"===typeof a.getStatus?a.getStatus():
this.getStatusForDijit(a)})),a=Math.min.apply(a,a));return a},getStatusForDijit:function(a){return a.validate()?a.get("DisplayedValue")?1:0:-1},isInvalidValue:function(){return 0>this.getStatus()},isEmptyValue:function(){return 0===this.getStatus()},isValidValue:function(){return 0<this.getStatus()},isBlankValueProvider:function(){return!1},getFilterExpr:function(){var a="1\x3d1",a=this.getLayerFilterExpr();if("all"===this.cascade||"previous"===this.cascade)var b=this.getCascadeFilterExpr(),a="("+
a+") AND ("+b+")";return a},getLayerFilterExpr:function(){var a="1\x3d1";this.layerInfo&&(a=this.layerInfo.getFilter());a||(a="1\x3d1");return a},_getWebMapFilterExpr:function(){var a="";this.layerInfo&&(a=this.layerInfo.getFilterOfWebmap());a||(a="1\x3d1");return a},getDropdownFilterExpr:function(){var a="1\x3d1",a=this._getWebMapFilterExpr();if("all"===this.cascade||"previous"===this.cascade)var b=this.getCascadeFilterExpr(),a="("+a+") AND ("+b+")";return a},getCascadeFilterExpr:function(){return"1\x3d1"},
isDefined:function(a){return c.isDefined(a)},disable:function(){this._enabled=!1},enable:function(){this._enabled=!0},isEnabled:function(){return this._enabled}})})},"jimu/dijit/_filter/SimpleValueProvider":function(){define("dojo/_base/html dojo/_base/declare dojo/on ./ValueProvider dijit/form/ValidationTextBox dijit/form/NumberTextBox ./DateValueSelector".split(" "),function(k,e,p,q,n,l,h){return e([q],{templateString:"\x3cdiv\x3e\x3c/div\x3e",_dijit:null,postCreate:function(){this.inherited(arguments);
k.addClass(this.domNode,"jimu-filter-simple-value-provider");"string"===this.shortType?(this._dijit=new n({required:!1,trim:!0,intermediateChanges:!1}),this._dijit.startup(),this._dijit.on("keydown",function(e){13===(e.keyCode||e.which)&&(this._dijit.textbox.blur(),this._dijit.emit("enter"))}.bind(this))):"number"===this.shortType?(this._dijit=new l({required:!1,intermediateChanges:!1,constraints:{pattern:"#####0.##########"}}),this._dijit.startup(),this._dijit.on("keydown",function(e){13===(e.keyCode||
e.which)&&(this._dijit.textbox.blur(),this._dijit.emit("enter"))}.bind(this))):this._dijit=new h({popupInfo:this.popupInfo,_fieldInfo:this.fieldInfo});k.setStyle(this._dijit.domNode,"width","100%");this._dijit.placeAt(this.domNode)},getDijits:function(){return[this._dijit]},setValueObject:function(e){this.isDefined(e.value)&&("date"===this.shortType?this._dijit.setValueObject(e):this._dijit.set("value",e.value))},getValueObject:function(){if(this.isValidValue())if("date"===this.shortType){var e=this._dijit.getValueObject();
if(e&&e.value)return e.isValid=!0,e.type=this.partObj.valueObj.type,e}else return e=this._dijit.get("value"),"number"===this.shortType&&(e=parseFloat(e)),{isValid:!0,type:this.partObj.valueObj.type,value:e};return null},tryGetValueObject:function(){return this.isValidValue()?this.getValueObject():this.isEmptyValue()?{isValid:!0,type:this.partObj.valueObj.type,value:null}:null},setRequired:function(e){this._dijit.set("required",e)}})})},"jimu/dijit/_filter/DateValueSelector":function(){define("dojo/aspect dojo/Evented dojo/on dojo/_base/html dojo/_base/lang dojo/_base/array dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./DateValueSelector.html jimu/filterUtils jimu/utils dijit/form/Select dijit/form/DateTextBox".split(" "),
function(k,e,p,q,n,l,h,f,d,c,a,b,g){return h([f,d,c,e],{templateString:a,virtualDates:null,postMixInProperties:function(){this.inherited(arguments);this.nls=window.jimuNls.filterBuilder},postCreate:function(){this.inherited(arguments);q.addClass(this.domNode,"jimu-date-value-selector");this.virtualDates&&0<this.virtualDates.length||(this.virtualDates=[b.VIRTUAL_DATE_TODAY,b.VIRTUAL_DATE_YESTERDAY,b.VIRTUAL_DATE_TOMORROW]);this.dateTypeSelect.addOption({value:"",label:"\x26nbsp;"});this.dateTypeSelect.addOption({value:"custom",
label:this.nls.custom});l.map(this.virtualDates,n.hitch(this,function(a){var c={value:a,label:a};switch(a){case b.VIRTUAL_DATE_TODAY:c.label=this.nls.today;break;case b.VIRTUAL_DATE_YESTERDAY:c.label=this.nls.yesterday;break;case b.VIRTUAL_DATE_TOMORROW:c.label=this.nls.tomorrow}this.dateTypeSelect.addOption(c)}));this._showDateTypeSelect();this.own(p(q.byId("main-page"),"click",n.hitch(this,function(){this.dateTextBox&&this.dateTextBox.closeDropDown()})));this.own(k.before(this.dateTypeSelect,"openDropDown",
n.hitch(this,function(){"custom"===this.dateTypeSelect.getValue()&&this.dateTextBox.getValue()&&(this.dateTypeSelect.textDirNode.innerText=this._formatDate(this.dateTextBox.getValue()))})));this.own(k.after(this.dateTypeSelect,"closeDropDown",n.hitch(this,function(){"custom"===this.dateTypeSelect.getValue()&&this.dateTextBox.getValue()&&(this.dateTypeSelect.textDirNode.innerText=this._formatDate(this.dateTextBox.getValue()))})));this.own(k.after(this.dateTypeSelect.dropDown,"onItemClick",n.hitch(this,
function(a,b){a&&"custom"===a.option.value&&this._showDateTextBox()}),!0));this.popupInfo&&this.popupInfo.fieldInfos&&(this.fieldInfo=this.popupInfo.fieldInfos.filter(n.hitch(this,function(a){return a.fieldName===this._fieldInfo.name}))[0])},getDijits:function(){return[]},setValueObject:function(a){a.virtualDate&&"custom"!==a.virtualDate?this.dateTypeSelect.set("value",a.virtualDate,!1):(this.dateTypeSelect.set("value","custom",!1),a.value&&(this.dateTextBox.set("value",new Date(a.value),!1),this.dateTypeSelect.textDirNode.innerText=
this._formatDate(new Date(a.value))))},getValueObject:function(){return this.isValidValue()?this.tryGetValueObject():null},tryGetValueObject:function(){if(this.isInvalidValue())return null;var a={value:null,virtualDate:""},c=this.dateTypeSelect.get("value"),d=null;"custom"===c?(d=this.dateTextBox.get("value"),a.value=d?d.toDateString():null,a.virtualDate=""):(d=b.getRealDateByVirtualDate(c),a.virtualDate=c,d?a.value=d.toDateString():a=null);return a},setRequired:function(a){this.dateTextBox.set("required",
a)},getStatus:function(){return"custom"===this.dateTypeSelect.get("value")?this._getStatusForDijit(this.dateTextBox):""===this.dateTypeSelect.get("value")?0:1},_getStatusForDijit:function(a){return a.validate()?a.get("DisplayedValue")?1:0:-1},isInvalidValue:function(){return 0>this.getStatus()},isEmptyValue:function(){return 0===this.getStatus()},isValidValue:function(){return 0<this.getStatus()},_showDateTypeSelect:function(){this.dateTextBox.closeDropDown()},_showDateTextBox:function(){this.dateTextBox.openDropDown();
this.dateTextBoxClickBinded=!0},_onDateTypeSelectChanged:function(){"custom"===this.dateTypeSelect.get("value")&&this._showDateTextBox();this.emit("change")},_onDateTextBoxChanged:function(a){this.dateTypeSelect.textDirNode.innerText=this._formatDate(a);this.emit("change")},_formatDate:function(a){return this.fieldInfo?g.localizeDateByFieldInfo(a,this.fieldInfo):a.toDateString()}})})},"dijit/form/DateTextBox":function(){define(["dojo/_base/declare","../Calendar","./_DateTimeTextBox"],function(k,e,
p){return k("dijit.form.DateTextBox",p,{baseClass:"dijitTextBox dijitComboBox dijitDateTextBox",popupClass:e,_selector:"date",maxHeight:Infinity,value:new Date("")})})},"dijit/Calendar":function(){define("dojo/_base/array dojo/date dojo/date/locale dojo/_base/declare dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/_base/kernel dojo/keys dojo/_base/lang dojo/on dojo/sniff ./CalendarLite ./_Widget ./_CssStateMixin ./_TemplatedMixin ./form/DropDownButton".split(" "),function(k,e,p,q,n,l,h,f,d,c,
a,b,g,u,m,r,t){var v=q("dijit.Calendar",[g,u,m],{baseClass:"dijitCalendar",cssStateNodes:{decrementMonth:"dijitCalendarArrow",incrementMonth:"dijitCalendarArrow",previousYearLabelNode:"dijitCalendarPreviousYear",nextYearLabelNode:"dijitCalendarNextYear"},setValue:function(a){f.deprecated("dijit.Calendar:setValue() is deprecated.  Use set('value', ...) instead.","","2.0");this.set("value",a)},_createMonthWidget:function(){return new v._MonthDropDownButton({id:this.id+"_mddb",tabIndex:-1,onMonthSelect:c.hitch(this,
"_onMonthSelect"),lang:this.lang,dateLocaleModule:this.dateLocaleModule},this.monthNode)},postCreate:function(){this.inherited(arguments);this.own(a(this.domNode,"keydown",c.hitch(this,"_onKeyDown")),a(this.dateRowsNode,"mouseover",c.hitch(this,"_onDayMouseOver")),a(this.dateRowsNode,"mouseout",c.hitch(this,"_onDayMouseOut")),a(this.dateRowsNode,"mousedown",c.hitch(this,"_onDayMouseDown")),a(this.dateRowsNode,"mouseup",c.hitch(this,"_onDayMouseUp")))},_onMonthSelect:function(a){var b=new this.dateClassObj(this.currentFocus);
b.setDate(1);b.setMonth(a);a=this.dateModule.getDaysInMonth(b);var c=this.currentFocus.getDate();b.setDate(Math.min(c,a));this._setCurrentFocusAttr(b)},_onDayMouseOver:function(a){(a=l.contains(a.target,"dijitCalendarDateLabel")?a.target.parentNode:a.target)&&(a.dijitDateValue&&!l.contains(a,"dijitCalendarDisabledDate")||a==this.previousYearLabelNode||a==this.nextYearLabelNode)&&(l.add(a,"dijitCalendarHoveredDate"),this._currentNode=a)},_onDayMouseOut:function(a){!this._currentNode||a.relatedTarget&&
a.relatedTarget.parentNode==this._currentNode||(a="dijitCalendarHoveredDate",l.contains(this._currentNode,"dijitCalendarActiveDate")&&(a+=" dijitCalendarActiveDate"),l.remove(this._currentNode,a),this._currentNode=null)},_onDayMouseDown:function(a){(a=a.target.parentNode)&&a.dijitDateValue&&!l.contains(a,"dijitCalendarDisabledDate")&&(l.add(a,"dijitCalendarActiveDate"),this._currentNode=a)},_onDayMouseUp:function(a){(a=a.target.parentNode)&&a.dijitDateValue&&l.remove(a,"dijitCalendarActiveDate")},
handleKey:function(a){var b=-1,c,e=this.currentFocus;switch(a.keyCode){case d.RIGHT_ARROW:b=1;case d.LEFT_ARROW:c="day";this.isLeftToRight()||(b*=-1);break;case d.DOWN_ARROW:b=1;case d.UP_ARROW:c="week";break;case d.PAGE_DOWN:b=1;case d.PAGE_UP:c=a.ctrlKey||a.altKey?"year":"month";break;case d.END:e=this.dateModule.add(e,"month",1),c="day";case d.HOME:e=new this.dateClassObj(e);e.setDate(1);break;default:return!0}c&&(e=this.dateModule.add(e,c,b));this._setCurrentFocusAttr(e);return!1},_onKeyDown:function(a){this.handleKey(a)||
(a.stopPropagation(),a.preventDefault())},onValueSelected:function(){},onChange:function(a){this.onValueSelected(a)},getClassForDate:function(){}});v._MonthDropDownButton=q("dijit.Calendar._MonthDropDownButton",t,{onMonthSelect:function(){},postCreate:function(){this.inherited(arguments);this.dropDown=new v._MonthDropDown({id:this.id+"_mdd",onChange:this.onMonthSelect})},_setMonthAttr:function(a){var c=this.dateLocaleModule.getNames("months","wide","standAlone",this.lang,a);this.dropDown.set("months",
c);this.containerNode.innerHTML=(6==b("ie")?"":"\x3cdiv class\x3d'dijitSpacer'\x3e"+this.dropDown.domNode.innerHTML+"\x3c/div\x3e")+"\x3cdiv class\x3d'dijitCalendarMonthLabel dijitCalendarCurrentMonthLabel'\x3e"+c[a.getMonth()]+"\x3c/div\x3e"}});v._MonthDropDown=q("dijit.Calendar._MonthDropDown",[u,r,m],{months:[],baseClass:"dijitCalendarMonthMenu dijitMenu",templateString:"\x3cdiv data-dojo-attach-event\x3d'ondijitclick:_onClick'\x3e\x3c/div\x3e",_setMonthsAttr:function(a){this.domNode.innerHTML=
"";k.forEach(a,function(a,b){h.create("div",{className:"dijitCalendarMonthLabel",month:b,innerHTML:a},this.domNode)._cssState="dijitCalendarMonthLabel"},this)},_onClick:function(a){this.onChange(n.get(a.target,"month"))},onChange:function(){}});return v})},"dijit/CalendarLite":function(){define("dojo/_base/array dojo/_base/declare dojo/cldr/supplemental dojo/date dojo/date/locale dojo/date/stamp dojo/dom dojo/dom-class dojo/dom-attr dojo/_base/lang dojo/on dojo/sniff dojo/string ./_WidgetBase ./_TemplatedMixin dojo/text!./templates/Calendar.html ./a11yclick ./hccss".split(" "),
function(k,e,p,q,n,l,h,f,d,c,a,b,g,u,m,r){var t=e("dijit.CalendarLite",[u,m],{templateString:r,dowTemplateString:'\x3cth class\x3d"dijitReset dijitCalendarDayLabelTemplate" role\x3d"columnheader" scope\x3d"col"\x3e\x3cspan class\x3d"dijitCalendarDayLabel"\x3e${d}\x3c/span\x3e\x3c/th\x3e',dateTemplateString:'\x3ctd class\x3d"dijitReset" role\x3d"gridcell" data-dojo-attach-point\x3d"dateCells"\x3e\x3cspan class\x3d"dijitCalendarDateLabel" data-dojo-attach-point\x3d"dateLabels"\x3e\x3c/span\x3e\x3c/td\x3e',
weekTemplateString:'\x3ctr class\x3d"dijitReset dijitCalendarWeekTemplate" role\x3d"row"\x3e${d}${d}${d}${d}${d}${d}${d}\x3c/tr\x3e',value:new Date(""),datePackage:"",dayWidth:"narrow",tabIndex:"0",dayOffset:-1,currentFocus:new Date,_setSummaryAttr:"gridNode",baseClass:"dijitCalendar dijitCalendarLite",_isValidDate:function(a){return a&&!isNaN(a)&&"object"==typeof a&&a.toString()!=this.constructor.prototype.value.toString()},_getValueAttr:function(){var a=this._get("value");if(a&&!isNaN(a)){var b=
new this.dateClassObj(a);b.setHours(0,0,0,0);b.getDate()<a.getDate()&&(b=this.dateModule.add(b,"hour",1));return b}return null},_setValueAttr:function(a,b){"string"==typeof a&&(a=l.fromISOString(a));a=this._patchDate(a);if(this._isValidDate(a)&&!this.isDisabledDate(a,this.lang)){if(this._set("value",a),this.set("currentFocus",a),this._markSelectedDates([a]),this._created&&(b||"undefined"==typeof b))this.onChange(this.get("value"))}else this._set("value",null),this._markSelectedDates([])},_patchDate:function(a){if(a||
0===a)a=new this.dateClassObj(a),a.setHours(1,0,0,0);return a},_setText:function(a,b){for(;a.firstChild;)a.removeChild(a.firstChild);a.appendChild(a.ownerDocument.createTextNode(b))},_populateGrid:function(){var a=new this.dateClassObj(this.currentFocus);a.setDate(1);var a=this._patchDate(a),b=a.getDay(),c=this.dateModule.getDaysInMonth(a),e=this.dateModule.getDaysInMonth(this.dateModule.add(a,"month",-1)),f=new this.dateClassObj,g=0<=this.dayOffset?this.dayOffset:p.getFirstDayOfWeek(this.lang);g>
b&&(g-=7);if(!this.summary){var h=this.dateLocaleModule.getNames("months","wide","standAlone",this.lang,a);this.gridNode.setAttribute("summary",h[a.getMonth()])}this._date2cell={};k.forEach(this.dateCells,function(h,m){var k=m+g,l=new this.dateClassObj(a),p="dijitCalendar",r=0;k<b?(k=e-b+k+1,r=-1,p+="Previous"):k>=b+c?(k=k-b-c+1,r=1,p+="Next"):(k=k-b+1,p+="Current");r&&(l=this.dateModule.add(l,"month",r));l.setDate(k);this.dateModule.compare(l,f,"date")||(p="dijitCalendarCurrentDate "+p);this.isDisabledDate(l,
this.lang)?(p="dijitCalendarDisabledDate "+p,h.setAttribute("aria-disabled","true")):(p="dijitCalendarEnabledDate "+p,h.removeAttribute("aria-disabled"),h.setAttribute("aria-selected","false"));(r=this.getClassForDate(l,this.lang))&&(p=r+" "+p);h.className=p+"Month dijitCalendarDateTemplate";p=l.valueOf();this._date2cell[p]=h;h.dijitDateValue=p;p=l.getDateLocalized?l.getDateLocalized(this.lang):l.getDate();this._setText(this.dateLabels[m],p);d.set(h,"aria-label",n.format(l,{selector:"date",formatLength:"long"}))},
this)},_populateControls:function(){var a=new this.dateClassObj(this.currentFocus);a.setDate(1);this.monthWidget.set("month",a);var b=a.getFullYear()-1,c=new this.dateClassObj;k.forEach(["previous","current","next"],function(a){c.setFullYear(b++);this._setText(this[a+"YearLabelNode"],this.dateLocaleModule.format(c,{selector:"year",locale:this.lang}))},this)},goToToday:function(){this.set("value",new this.dateClassObj)},constructor:function(a){this.dateModule=a.datePackage?c.getObject(a.datePackage,
!1):q;this.dateClassObj=this.dateModule.Date||Date;this.dateLocaleModule=a.datePackage?c.getObject(a.datePackage+".locale",!1):n},_createMonthWidget:function(){return t._MonthWidget({id:this.id+"_mddb",lang:this.lang,dateLocaleModule:this.dateLocaleModule},this.monthNode)},buildRendering:function(){var a=this.dowTemplateString,b=this.dateLocaleModule.getNames("days",this.dayWidth,"standAlone",this.lang),c=0<=this.dayOffset?this.dayOffset:p.getFirstDayOfWeek(this.lang);this.dayCellsHtml=g.substitute([a,
a,a,a,a,a,a].join(""),{d:""},function(){return b[c++%7]});a=g.substitute(this.weekTemplateString,{d:this.dateTemplateString});this.dateRowsHtml=[a,a,a,a,a,a].join("");this.dateCells=[];this.dateLabels=[];this.inherited(arguments);h.setSelectable(this.domNode,!1);a=new this.dateClassObj(this.currentFocus);this.monthWidget=this._createMonthWidget();this.set("currentFocus",a,!1)},postCreate:function(){this.inherited(arguments);this._connectControls()},_connectControls:function(){var b=c.hitch(this,function(b,
d,e){this[b].dojoClick=!0;return a(this[b],"click",c.hitch(this,function(){this._setCurrentFocusAttr(this.dateModule.add(this.currentFocus,d,e))}))});this.own(b("incrementMonth","month",1),b("decrementMonth","month",-1),b("nextYearLabelNode","year",1),b("previousYearLabelNode","year",-1))},_setCurrentFocusAttr:function(a,c){var d=this.currentFocus,e=this._getNodeByDate(d);a=this._patchDate(a);this._set("currentFocus",a);this._date2cell&&0==this.dateModule.difference(d,a,"month")||(this._populateGrid(),
this._populateControls(),this._markSelectedDates([this.value]));a=this._getNodeByDate(a);a.setAttribute("tabIndex",this.tabIndex);(this.focused||c)&&a.focus();e&&e!=a&&(b("webkit")?e.setAttribute("tabIndex","-1"):e.removeAttribute("tabIndex"))},focus:function(){this._setCurrentFocusAttr(this.currentFocus,!0)},_onDayClick:function(a){a.stopPropagation();a.preventDefault();for(a=a.target;a&&!a.dijitDateValue&&0!==a.dijitDateValue;a=a.parentNode);a&&!f.contains(a,"dijitCalendarDisabledDate")&&this.set("value",
a.dijitDateValue)},_getNodeByDate:function(a){return(a=this._patchDate(a))&&this._date2cell?this._date2cell[a.valueOf()]:null},_markSelectedDates:function(a){function b(a,b){f.toggle(b,"dijitCalendarSelectedDate",a);b.setAttribute("aria-selected",a?"true":"false")}k.forEach(this._selectedCells||[],c.partial(b,!1));this._selectedCells=k.filter(k.map(a,this._getNodeByDate,this),function(a){return a});k.forEach(this._selectedCells,c.partial(b,!0))},onChange:function(){},isDisabledDate:function(){},getClassForDate:function(){}});
t._MonthWidget=e("dijit.CalendarLite._MonthWidget",u,{_setMonthAttr:function(a){var c=this.dateLocaleModule.getNames("months","wide","standAlone",this.lang,a),d=6==b("ie")?"":"\x3cdiv class\x3d'dijitSpacer'\x3e"+k.map(c,function(a){return"\x3cdiv\x3e"+a+"\x3c/div\x3e"}).join("")+"\x3c/div\x3e";this.domNode.innerHTML=d+"\x3cdiv class\x3d'dijitCalendarMonthLabel dijitCalendarCurrentMonthLabel'\x3e"+c[a.getMonth()]+"\x3c/div\x3e"}});return t})},"dijit/form/_DateTimeTextBox":function(){define("dojo/date dojo/date/locale dojo/date/stamp dojo/_base/declare dojo/_base/lang ./RangeBoundTextBox ../_HasDropDown dojo/text!./templates/DropDownBox.html".split(" "),
function(k,e,p,q,n,l,h,f){new Date("X");return q("dijit.form._DateTimeTextBox",[l,h],{templateString:f,hasDownArrow:!0,cssStateNodes:{_buttonNode:"dijitDownArrowButton"},_unboundedConstraints:{},pattern:e.regexp,datePackage:"",postMixInProperties:function(){this.inherited(arguments);this._set("type","text")},compare:function(d,c){var a=this._isInvalidDate(d),b=this._isInvalidDate(c);if(a||b)return a&&b?0:a?-1:1;d=this.format(d,this._unboundedConstraints);c=this.format(c,this._unboundedConstraints);
a=this.parse(d,this._unboundedConstraints);b=this.parse(c,this._unboundedConstraints);return d==c?0:k.compare(a,b,this._selector)},autoWidth:!0,format:function(d,c){return d?this.dateLocaleModule.format(d,c):""},parse:function(d,c){return this.dateLocaleModule.parse(d,c)||(this._isEmpty(d)?null:void 0)},serialize:function(d,c){d.toGregorian&&(d=d.toGregorian());return p.toISOString(d,c)},dropDownDefaultValue:new Date,value:new Date(""),_blankValue:null,popupClass:"",_selector:"",constructor:function(d){d=
d||{};this.dateModule=d.datePackage?n.getObject(d.datePackage,!1):k;this.dateClassObj=this.dateModule.Date||Date;this.dateClassObj instanceof Date||(this.value=new this.dateClassObj(this.value));this.dateLocaleModule=d.datePackage?n.getObject(d.datePackage+".locale",!1):e;this._set("pattern",this.dateLocaleModule.regexp);this._invalidDate=this.constructor.prototype.value.toString()},buildRendering:function(){this.inherited(arguments);this.hasDownArrow||(this._buttonNode.style.display="none");this.hasDownArrow||
(this._buttonNode=this.domNode,this.baseClass+=" dijitComboBoxOpenOnClick")},_setConstraintsAttr:function(d){d.selector=this._selector;d.fullYear=!0;var c=p.fromISOString;"string"==typeof d.min&&(d.min=c(d.min),this.dateClassObj instanceof Date||(d.min=new this.dateClassObj(d.min)));"string"==typeof d.max&&(d.max=c(d.max),this.dateClassObj instanceof Date||(d.max=new this.dateClassObj(d.max)));this.inherited(arguments);this._unboundedConstraints=n.mixin({},this.constraints,{min:null,max:null})},_isInvalidDate:function(d){return!d||
isNaN(d)||"object"!=typeof d||d.toString()==this._invalidDate},_setValueAttr:function(d,c,a){void 0!==d&&("string"==typeof d&&(d=p.fromISOString(d)),this._isInvalidDate(d)&&(d=null),d instanceof Date&&!(this.dateClassObj instanceof Date)&&(d=new this.dateClassObj(d)));this.inherited(arguments,[d,c,a]);this.value instanceof Date&&(this.filterString="");!1!==c&&this.dropDown&&this.dropDown.set("value",d,!1)},_set:function(d,c){if("value"==d){c instanceof Date&&!(this.dateClassObj instanceof Date)&&
(c=new this.dateClassObj(c));var a=this._get("value");if(a instanceof this.dateClassObj&&0==this.compare(c,a))return}this.inherited(arguments)},_setDropDownDefaultValueAttr:function(d){this._isInvalidDate(d)&&(d=new this.dateClassObj);this._set("dropDownDefaultValue",d)},openDropDown:function(d){this.dropDown&&this.dropDown.destroy();var c=n.isString(this.popupClass)?n.getObject(this.popupClass,!1):this.popupClass,a=this,b=this.get("value");this.dropDown=new c({onChange:function(b){a.set("value",
b,!0)},id:this.id+"_popup",dir:a.dir,lang:a.lang,value:b,textDir:a.textDir,currentFocus:this._isInvalidDate(b)?this.dropDownDefaultValue:b,constraints:a.constraints,filterString:a.filterString,datePackage:a.datePackage,isDisabledDate:function(b){return!a.rangeCheck(b,a.constraints)}});this.inherited(arguments)},_getDisplayedValueAttr:function(){return this.textbox.value},_setDisplayedValueAttr:function(d,c){this._setValueAttr(this.parse(d,this.constraints),c,d)}})})},"jimu/dijit/_filter/TwoNumbersValueProvider":function(){define("dojo/_base/html dojo/_base/declare ./ValueProvider dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./TwoNumbersValueProvider.html dijit/form/NumberTextBox".split(" "),
function(k,e,p,q,n,l){return e([p,q,n],{templateString:l,postCreate:function(){this.inherited(arguments);k.addClass(this.domNode,"jimu-two-numbers-filter-value-provider")},_onRangeNumberBlur:function(){if(this._dijit1.validate()&&this._dijit2.validate()){var e=parseFloat(this._dijit1.get("value")),f=parseFloat(this._dijit2.get("value"));e>f&&(this._dijit1.set("value",f),this._dijit2.set("value",e))}},getDijits:function(){return[this._dijit1,this._dijit2]},setValueObject:function(e){this.isDefined(e.value1)&&
this._dijit1.set("value",e.value1);this.isDefined(e.value2)&&this._dijit2.set("value",e.value2)},getValueObject:function(){return this.isValidValue()?{isValid:!0,type:this.partObj.valueObj.type,value1:parseFloat(this._dijit1.get("value")),value2:parseFloat(this._dijit2.get("value"))}:null},tryGetValueObject:function(){if(this.isValidValue())return this.getValueObject();if(this.isEmptyValue()){var e={isValid:!0,type:this.partObj.valueObj.type,value1:parseFloat(this._dijit1.get("value")),value2:parseFloat(this._dijit2.get("value"))};
isNaN(e.value1)&&(e.value1=null);isNaN(e.value2)&&(e.value2=null);return e}return null},setRequired:function(e){this._dijit1.set("required",e);this._dijit2.set("required",e)}})})},"jimu/dijit/_filter/TwoDatesValueProvider":function(){define("dojo/Evented dojo/_base/html dojo/_base/declare ./ValueProvider dijit/_WidgetsInTemplateMixin dojo/text!./TwoDatesValueProvider.html jimu/dijit/_filter/DateValueSelector".split(" "),function(k,e,p,q,n,l){return p([q,n,k],{templateString:l,postCreate:function(){this.inherited(arguments);
e.addClass(this.domNode,"jimu-two-dates-filter-value-provider")},_onDateValueSelectorChanged:function(){this.emit("change")},getDijits:function(){return[this._dijit1,this._dijit2]},setValueObject:function(e){this._setValueObject(this._dijit1,e,"value1","virtualDate1");this._setValueObject(this._dijit2,e,"value2","virtualDate2")},_setValueObject:function(e,f,d,c){if(this.isDefined(f[d])){var a={value:null,virtualDate:""};a.value=f[d];a.virtualDate=f[c];e.setValueObject(a)}},getValueObject:function(){if(this.isValidValue()){var e=
this._dijit1.getValueObject(),f=this._dijit2.getValueObject();if(e.value&&f.value)return{isValid:!0,type:this.partObj.valueObj.type,value1:e.value,value2:f.value,virtualDate1:e.virtualDate,virtualDate2:f.virtualDate}}return null},tryGetValueObject:function(){return this.isValidValue()?this.getValueObject():this.isEmptyValue()?{isValid:!0,type:this.partObj.valueObj.type,value1:null,value2:null,virtualDate1:null,virtualDate2:null}:null},getStatus:function(){return 1===this._dijit1.getStatus()&&1===
this._dijit2.getStatus()?1:-1===this._dijit1.getStatus()||-1===this._dijit2.getStatus()?-1:0},setRequired:function(e){this._dijit1.set("required",e);this._dijit2.set("required",e)}})})},"jimu/dijit/_filter/ListValueProvider":function(){define("dojo/aspect dojo/Deferred dojo/_base/lang dojo/_base/html dojo/_base/array dojo/_base/declare ./ValueProvider dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./ListValueProvider.html dojo/store/Memory jimu/utils dijit/form/FilteringSelect".split(" "),
function(k,e,p,q,n,l,h,f,d,c,a,b){return l([h,f,d],{templateString:c,codedValues:null,staticValues:null,showNullValues:!1,postCreate:function(){this.inherited(arguments);q.addClass(this.domNode,"jimu-filter-list-value-provider");this._uniqueValueCache={};var b=new a({idProperty:"id",data:[]});this.valuesSelect.set("store",b);this.staticValues||"function"!==typeof this.valuesSelect._onDropDownMouseDown||(!this.codedValues||this.codedValues&&this.filterCodedValue)&&this.own(k.before(this.valuesSelect,
"_onDropDownMouseDown",p.hitch(this,this._onBeforeDropDownMouseDown)))},_onFilteringSelectInput:function(){this.emit("change")},_onBeforeDropDownMouseDown:function(){this._tryUpdatingUniqueValues(void 0,!0);return arguments},getDijits:function(){return[this.valuesSelect]},setValueObject:function(a){return this.staticValues?this._setValueForStaticValues(a.value,this.staticValues):this.codedValues?this.filterCodedValue?this._tryUpdatingUniqueValues(a.value,!1):this._setValueForStaticValues(a.value,
this.codedValues):this._tryUpdatingUniqueValues(a.value,!1)},getValueObject:function(){if(this.isValidValue()){var a=this.valuesSelect.get("item").value;return{isValid:!0,type:this.partObj.valueObj.type,value:a}}return null},tryGetValueObject:function(){return this.isValidValue()?this.getValueObject():this.isEmptyValue()?{isValid:!0,type:this.partObj.valueObj.type,value:"string"===this.shortType?"":null}:null},setRequired:function(a){this.valuesSelect.set("required",a)},_setValueForStaticValues:function(a,
b){var c=null,d=-1,c=null;b&&(c=n.map(b,p.hitch(this,function(b,c){b={id:c,value:b.value,label:b.label};b.value===a&&(d=c);return b})),this.valuesSelect.store.setData(c),0<=d&&(c=this.valuesSelect.store.get(d))&&this.valuesSelect.set("item",c))},_uniqueValueLoadingDef:null,_uniqueValueLoadingExpr:"",_uniqueValueCache:null,_tryUpdatingUniqueValues:function(a,b){var c=new e;if(this.valuesSelect._opened)c.resolve();else{var d=this.getDropdownFilterExpr();d!==this._uniqueValueLoadingExpr?(this.valuesSelect.readOnly=
!0,this._uniqueValueLoadingDef&&(this._uniqueValueLoadingDef.reject(),this._uniqueValueLoadingDef=null),this._uniqueValueLoadingExpr=d,this._uniqueValueLoadingDef=this._getUniqueValues(d),this._uniqueValueLoadingDef.then(p.hitch(this,function(d){this.domNode&&(this._uniqueValueLoadingDef=null,this.valuesSelect.readOnly=!1,this._setValueForUniqueValues(a,d),this._hideLoadingIcon(),b&&this.valuesSelect.toggleDropDown(),c.resolve())}),p.hitch(this,function(a){console.error(a);this.domNode&&(this._uniqueValueLoadingDef=
null,this.valuesSelect.readOnly=!1,this._hideLoadingIcon(),c.reject(a))}))):c.resolve()}return c},_setValueForUniqueValues:function(a,b){b.sort(function(a,b){return a.value<b.value?-1:a.value===b.value?0:1});this.showNullValues||(b=n.filter(b,p.hitch(this,function(a){return"\x3cNull\x3e"!==a.value&&null!==a.value})));if(void 0===a){var c=this.getValueObject();c&&(a=c.value)}var d=-1,c=null;b=n.map(b,p.hitch(this,function(b,c){var e={id:c,value:b.value,label:b.label};b.value===a&&(d=c);return e}));
this.valuesSelect.store.setData(b);0<=d&&(c=this.valuesSelect.store.get(d));this.valuesSelect.set("item",c)},_showLoadingIcon:function(){q.addClass(this.valuesSelect.domNode,"loading")},_hideLoadingIcon:function(){q.removeClass(this.valuesSelect.domNode,"loading")},_getUniqueValues:function(a){var c=new e;this._uniqueValueCache[a]?c.resolve(this._uniqueValueCache[a]):(this._showLoadingIcon(),b.getUniqueValues(this.url,this.fieldName,a,this.layerDefinition,this.fieldPopupInfo).then(p.hitch(this,function(b){this.domNode&&
(this._uniqueValueCache[a]=b,c.resolve(b),this._hideLoadingIcon())}),p.hitch(this,function(a){this.domNode&&(c.reject(a),this._hideLoadingIcon())})));return c}})})},"dijit/form/FilteringSelect":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/when","./MappedTextBox","./ComboBoxMixin"],function(k,e,p,q,n){return k("dijit.form.FilteringSelect",[q,n],{required:!0,_lastDisplayedValue:"",_isValidSubset:function(){return this._opened},isValid:function(){return!!this.item||!this.required&&
""==this.get("displayedValue")},_refreshState:function(){this.searchTimer||this.inherited(arguments)},_callbackSetLabel:function(e,h,f,d){h&&h[this.searchAttr]!==this._lastQuery||!h&&e.length&&this.store.getIdentity(e[0])!=this._lastQuery||(e.length?this.set("item",e[0],d):this.set("value","",d||void 0===d&&!this.focused,this.textbox.value,null))},_openResultList:function(e,h,f){h[this.searchAttr]===this._lastQuery&&(this.inherited(arguments),void 0===this.item&&this.validate(!0))},_getValueAttr:function(){return this.valueNode.value},
_getValueField:function(){return"value"},_setValueAttr:function(k,h,f,d){this._onChangeActive||(h=null);if(void 0===d){if(null===k||""===k)if(k="",!e.isString(f)){this._setDisplayedValueAttr(f||"",h);return}var c=this;this._lastQuery=k;p(this.store.get(k),function(a){c._callbackSetLabel(a?[a]:[],void 0,void 0,h)})}else this.valueNode.value=k,this.inherited(arguments,[k,h,f,d])},_setItemAttr:function(e,h,f){this.inherited(arguments);this._lastDisplayedValue=this.textbox.value},_getDisplayQueryString:function(e){return e.replace(/([\\\*\?])/g,
"\\$1")},_setDisplayedValueAttr:function(k,h){null==k&&(k="");if(!this._created){if(!("displayedValue"in this.params))return;h=!1}if(this.store){this.closeDropDown();var f=e.clone(this.query),d=this._getDisplayQueryString(k),c;this.store._oldAPI?c=d:(c=this._patternToRegExp(d),c.toString=function(){return d});this._lastQuery=f[this.searchAttr]=c;this._lastDisplayedValue=this.textbox.value=k;this._set("displayedValue",k);var a=this,b={queryOptions:{ignoreCase:this.ignoreCase,deep:!0}};e.mixin(b,this.fetchProperties);
this._fetchHandle=this.store.query(f,b);p(this._fetchHandle,function(c){a._fetchHandle=null;a._callbackSetLabel(c||[],f,b,h)},function(b){a._fetchHandle=null;a._cancelingQuery||console.error("dijit.form.FilteringSelect: "+b.toString())})}},undo:function(){this.set("displayedValue",this._lastDisplayedValue)}})})},"dijit/form/ComboBoxMixin":function(){define("dojo/_base/declare dojo/Deferred dojo/_base/kernel dojo/_base/lang dojo/store/util/QueryResults ./_AutoCompleterMixin ./_ComboBoxMenu ../_HasDropDown dojo/text!./templates/DropDownBox.html".split(" "),
function(k,e,p,q,n,l,h,f,d){return k("dijit.form.ComboBoxMixin",[f,l],{dropDownClass:h,hasDownArrow:!0,templateString:d,baseClass:"dijitTextBox dijitComboBox",cssStateNodes:{_buttonNode:"dijitDownArrowButton"},_setHasDownArrowAttr:function(c){this._set("hasDownArrow",c);this._buttonNode.style.display=c?"":"none"},_showResultList:function(){this.displayMessage("");this.inherited(arguments)},_setStoreAttr:function(c){c.get||q.mixin(c,{_oldAPI:!0,get:function(a){var b=new e;this.fetchItemByIdentity({identity:a,
onItem:function(a){b.resolve(a)},onError:function(a){b.reject(a)}});return b.promise},query:function(a,b){var c=new e(function(){d.abort&&d.abort()});c.total=new e;var d=this.fetch(q.mixin({query:a,onBegin:function(a){c.total.resolve(a)},onComplete:function(a){c.resolve(a)},onError:function(a){c.reject(a)}},b));return n(c)}});this._set("store",c)},postMixInProperties:function(){var c=this.params.store||this.store;c&&this._setStoreAttr(c);this.inherited(arguments);if(!this.params.store&&this.store&&
!this.store._oldAPI){var a=this.declaredClass;q.mixin(this.store,{getValue:function(b,c){p.deprecated(a+".store.getValue(item, attr) is deprecated for builtin store.  Use item.attr directly","","2.0");return b[c]},getLabel:function(b){p.deprecated(a+".store.getLabel(item) is deprecated for builtin store.  Use item.label directly","","2.0");return b.name},fetch:function(b){p.deprecated(a+".store.fetch() is deprecated for builtin store.","Use store.query()","2.0");require(["dojo/data/ObjectStore"],
q.hitch(this,function(a){(new a({objectStore:this})).fetch(b)}))}})}},buildRendering:function(){this.inherited(arguments);this.focusNode.setAttribute("aria-autocomplete",this.autoComplete?"both":"list")}})})},"dijit/form/_AutoCompleterMixin":function(){define("dojo/aspect dojo/_base/declare dojo/dom-attr dojo/keys dojo/_base/lang dojo/query dojo/regexp dojo/sniff ./DataList ./_TextBoxMixin ./_SearchMixin".split(" "),function(k,e,p,q,n,l,h,f,d,c,a){e=e("dijit.form._AutoCompleterMixin",a,{item:null,
autoComplete:!0,highlightMatch:"first",labelAttr:"",labelType:"text",maxHeight:-1,_stopClickEvents:!1,_getCaretPos:function(a){var b=0;if("number"==typeof a.selectionStart)b=a.selectionStart;else if(f("ie")){var c=a.ownerDocument.selection.createRange().duplicate();a=a.createTextRange();c.move("character",0);a.move("character",0);try{a.setEndPoint("EndToEnd",c),b=String(a.text).replace(/\r/g,"").length}catch(m){}}return b},_setCaretPos:function(a,d){d=parseInt(d);c.selectInputText(a,d,d)},_setDisabledAttr:function(a){this.inherited(arguments);
this.domNode.setAttribute("aria-disabled",a?"true":"false")},_onKey:function(a){if(!(32<=a.charCode)){var b=a.charCode||a.keyCode;if(b!=q.ALT&&b!=q.CTRL&&b!=q.META&&b!=q.SHIFT){var c=this.dropDown,d=null;this._abortQuery();this.inherited(arguments);if(!(a.altKey||a.ctrlKey||a.metaKey))switch(this._opened&&(d=c.getHighlightedOption()),b){case q.PAGE_DOWN:case q.DOWN_ARROW:case q.PAGE_UP:case q.UP_ARROW:this._opened&&this._announceOption(d);a.stopPropagation();a.preventDefault();break;case q.ENTER:if(d){if(d==
c.nextButton){this._nextSearch(1);a.stopPropagation();a.preventDefault();break}else if(d==c.previousButton){this._nextSearch(-1);a.stopPropagation();a.preventDefault();break}a.stopPropagation();a.preventDefault()}else this._setBlurValue(),this._setCaretPos(this.focusNode,this.focusNode.value.length);case q.TAB:b=this.get("displayedValue");if(c&&(b==c._messages.previousMessage||b==c._messages.nextMessage))break;d&&this._selectOption(d);case q.ESCAPE:this._opened&&(this._lastQuery=null,this.closeDropDown())}}}},
_autoCompleteText:function(a){var b=this.focusNode;c.selectInputText(b,b.value.length);var d=this.ignoreCase?"toLowerCase":"substr";0==a[d](0).indexOf(this.focusNode.value[d](0))?(d=this.autoComplete?this._getCaretPos(b):b.value.length,d+1>b.value.length&&(b.value=a,c.selectInputText(b,d))):(b.value=a,c.selectInputText(b))},_openResultList:function(a,c,d){var b=this.dropDown.getHighlightedOption();this.dropDown.clearResultList();a.length||0!=d.start?(this._nextSearch=this.dropDown.onPage=n.hitch(this,
function(b){a.nextPage(-1!==b);this.focus()}),this.dropDown.createOptions(a,d,n.hitch(this,"_getMenuLabelFromItem")),this._showResultList(),"direction"in d?(d.direction?this.dropDown.highlightFirstOption():d.direction||this.dropDown.highlightLastOption(),b&&this._announceOption(this.dropDown.getHighlightedOption())):!this.autoComplete||this._prev_key_backspace||/^[*]+$/.test(c[this.searchAttr].toString())||this._announceOption(this.dropDown.containerNode.firstChild.nextSibling)):this.closeDropDown()},
_showResultList:function(){this.closeDropDown(!0);this.openDropDown();this.domNode.setAttribute("aria-expanded","true")},loadDropDown:function(){this._startSearchAll()},isLoaded:function(){return!1},closeDropDown:function(){this._abortQuery();this._opened&&(this.inherited(arguments),this.domNode.setAttribute("aria-expanded","false"))},_setBlurValue:function(){var a=this.get("displayedValue"),c=this.dropDown;!c||a!=c._messages.previousMessage&&a!=c._messages.nextMessage?"undefined"==typeof this.item?
(this.item=null,this.set("displayedValue",a)):(this.value!=this._lastValueReported&&this._handleOnChange(this.value,!0),this._refreshState()):this._setValueAttr(this._lastValueReported,!0);this.focusNode.removeAttribute("aria-activedescendant")},_setItemAttr:function(a,c,d){var b="";a&&(d||(d=this.store._oldAPI?this.store.getValue(a,this.searchAttr):a[this.searchAttr]),b=this._getValueField()!=this.searchAttr?this.store.getIdentity(a):d);this.set("value",b,c,d,a)},_announceOption:function(a){if(a){var b;
if(a==this.dropDown.nextButton||a==this.dropDown.previousButton)b=a.innerHTML,this.item=void 0,this.value="";else{var c=this.dropDown.items[a.getAttribute("item")];b=(this.store._oldAPI?this.store.getValue(c,this.searchAttr):c[this.searchAttr]).toString();this.set("item",c,!1,b)}this.focusNode.value=this.focusNode.value.substring(0,this._lastInput.length);this.focusNode.setAttribute("aria-activedescendant",p.get(a,"id"));this._autoCompleteText(b)}},_selectOption:function(a){this.closeDropDown();a&&
this._announceOption(a);this._setCaretPos(this.focusNode,this.focusNode.value.length);this._handleOnChange(this.value,!0);this.focusNode.removeAttribute("aria-activedescendant")},_startSearchAll:function(){this._startSearch("")},_startSearchFromInput:function(){this.item=void 0;this.inherited(arguments)},_startSearch:function(a){if(!this.dropDown){var b=this.id+"_popup";this.dropDown=new (n.isString(this.dropDownClass)?n.getObject(this.dropDownClass,!1):this.dropDownClass)({onChange:n.hitch(this,
this._selectOption),id:b,dir:this.dir,textDir:this.textDir})}this._lastInput=a;this.inherited(arguments)},_getValueField:function(){return this.searchAttr},postMixInProperties:function(){this.inherited(arguments);if(!this.store&&this.srcNodeRef&&(this.store=new d({},this.srcNodeRef),!("value"in this.params))){var a=this.item=this.store.fetchSelectedItem();if(a){var c=this._getValueField();this.value=this.store._oldAPI?this.store.getValue(a,c):a[c]}}},postCreate:function(){var a=l('label[for\x3d"'+
this.id+'"]');a.length&&(a[0].id||(a[0].id=this.id+"_label"),this.domNode.setAttribute("aria-labelledby",a[0].id));this.inherited(arguments);k.after(this,"onSearch",n.hitch(this,"_openResultList"),!0)},_getMenuLabelFromItem:function(a){a=this.labelFunc(a,this.store);var b=this.labelType;"none"!=this.highlightMatch&&"text"==this.labelType&&this._lastInput&&(a=this.doHighlight(a,this._lastInput),b="html");return{html:"html"==b,label:a}},doHighlight:function(a,c){var b=(this.ignoreCase?"i":"")+("all"==
this.highlightMatch?"g":""),d=this.queryExpr.indexOf("${0}");c=h.escapeString(c);return this._escapeHtml(a.replace(new RegExp((0==d?"^":"")+"("+c+")"+(d==this.queryExpr.length-4?"$":""),b),"\uffff$1\uffff")).replace(/\uFFFF([^\uFFFF]+)\uFFFF/g,'\x3cspan class\x3d"dijitComboBoxHighlightMatch"\x3e$1\x3c/span\x3e')},_escapeHtml:function(a){return a=String(a).replace(/&/gm,"\x26amp;").replace(/</gm,"\x26lt;").replace(/>/gm,"\x26gt;").replace(/"/gm,"\x26quot;")},reset:function(){this.item=null;this.inherited(arguments)},
labelFunc:function(a,c){return(c._oldAPI?c.getValue(a,this.labelAttr||this.searchAttr):a[this.labelAttr||this.searchAttr]).toString()},_setValueAttr:function(a,c,d,e){this._set("item",e||null);null==a&&(a="");this.inherited(arguments)}});f("dojo-bidi")&&e.extend({_setTextDirAttr:function(a){this.inherited(arguments);this.dropDown&&this.dropDown._set("textDir",a)}});return e})},"dijit/form/DataList":function(){define("dojo/_base/declare dojo/dom dojo/_base/lang dojo/query dojo/store/Memory ../registry".split(" "),
function(k,e,p,q,n,l){function h(e){return{id:e.value,value:e.value,name:p.trim(e.innerText||e.textContent||"")}}return k("dijit.form.DataList",n,{constructor:function(f,d){this.domNode=e.byId(d);p.mixin(this,f);this.id&&l.add(this);this.domNode.style.display="none";this.inherited(arguments,[{data:q("option",this.domNode).map(h)}])},destroy:function(){l.remove(this.id)},fetchSelectedItem:function(){var e=q("\x3e option[selected]",this.domNode)[0]||q("\x3e option",this.domNode)[0];return e&&h(e)}})})},
"dijit/form/_SearchMixin":function(){define("dojo/_base/declare dojo/keys dojo/_base/lang dojo/query dojo/string dojo/when ../registry".split(" "),function(k,e,p,q,n,l,h){return k("dijit.form._SearchMixin",null,{pageSize:Infinity,store:null,fetchProperties:{},query:{},list:"",_setListAttr:function(e){this._set("list",e)},searchDelay:200,searchAttr:"name",queryExpr:"${0}*",ignoreCase:!0,_patternToRegExp:function(e){return new RegExp("^"+e.replace(/(\\.)|(\*)|(\?)|\W/g,function(d,c,a,b){return a?".*":
b?".":c?c:"\\"+d})+"$",this.ignoreCase?"mi":"m")},_abortQuery:function(){this.searchTimer&&(this.searchTimer=this.searchTimer.remove());this._queryDeferHandle&&(this._queryDeferHandle=this._queryDeferHandle.remove());this._fetchHandle&&(this._fetchHandle.abort&&(this._cancelingQuery=!0,this._fetchHandle.abort(),this._cancelingQuery=!1),this._fetchHandle.cancel&&(this._cancelingQuery=!0,this._fetchHandle.cancel(),this._cancelingQuery=!1),this._fetchHandle=null)},_processInput:function(f){if(!this.disabled&&
!this.readOnly){f=f.charOrCode;this._prev_key_backspace=!1;if(f==e.DELETE||f==e.BACKSPACE)this._maskValidSubsetError=this._prev_key_backspace=!0;if(this.store)this.searchTimer=this.defer("_startSearchFromInput",1);else this.onSearch()}},onSearch:function(){},_startSearchFromInput:function(){this._startSearch(this.focusNode.value)},_startSearch:function(e){this._abortQuery();var d=this,c=p.clone(this.query),a={start:0,count:this.pageSize,queryOptions:{ignoreCase:this.ignoreCase,deep:!0}},b=n.substitute(this.queryExpr,
[e.replace(/([\\\*\?])/g,"\\$1")]),f,h=function(){var b=d._fetchHandle=d.store.query(c,a);d.disabled||d.readOnly||f!==d._lastQuery||l(b,function(e){d._fetchHandle=null;d.disabled||d.readOnly||f!==d._lastQuery||l(b.total,function(b){e.total=b;var f=d.pageSize;if(isNaN(f)||f>e.total)f=e.total;e.nextPage=function(b){a.direction=b=!1!==b;a.count=f;b?(a.start+=e.length,a.start>=e.total&&(a.count=0)):(a.start-=f,0>a.start&&(a.count=Math.max(f+a.start,0),a.start=0));0>=a.count?(e.length=0,d.onSearch(e,c,
a)):h()};d.onSearch(e,c,a)})},function(a){d._fetchHandle=null;d._cancelingQuery||console.error(d.declaredClass+" "+a.toString())})};p.mixin(a,this.fetchProperties);this.store._oldAPI?f=b:(f=this._patternToRegExp(b),f.toString=function(){return b});this._lastQuery=c[this.searchAttr]=f;this._queryDeferHandle=this.defer(h,this.searchDelay)},constructor:function(){this.query={};this.fetchProperties={}},postMixInProperties:function(){if(!this.store){var e=this.list;e&&(this.store=h.byId(e))}this.inherited(arguments)}})})},
"dijit/form/_ComboBoxMenu":function(){define("dojo/_base/declare dojo/dom-class dojo/dom-style dojo/keys ../_WidgetBase ../_TemplatedMixin ./_ComboBoxMenuMixin ./_ListMouseMixin".split(" "),function(k,e,p,q,n,l,h,f){return k("dijit.form._ComboBoxMenu",[n,l,f,h],{templateString:"\x3cdiv class\x3d'dijitReset dijitMenu' data-dojo-attach-point\x3d'containerNode' style\x3d'overflow: auto; overflow-x: hidden;' role\x3d'listbox'\x3e\x3cdiv class\x3d'dijitMenuItem dijitMenuPreviousButton' data-dojo-attach-point\x3d'previousButton' role\x3d'option'\x3e\x3c/div\x3e\x3cdiv class\x3d'dijitMenuItem dijitMenuNextButton' data-dojo-attach-point\x3d'nextButton' role\x3d'option'\x3e\x3c/div\x3e\x3c/div\x3e",
baseClass:"dijitComboBoxMenu",postCreate:function(){this.inherited(arguments);this.isLeftToRight()||(e.add(this.previousButton,"dijitMenuItemRtl"),e.add(this.nextButton,"dijitMenuItemRtl"));this.containerNode.setAttribute("role","listbox")},_createMenuItem:function(){var d=this.ownerDocument.createElement("div");d.className="dijitReset dijitMenuItem"+(this.isLeftToRight()?"":" dijitMenuItemRtl");d.setAttribute("role","option");return d},onHover:function(d){e.add(d,"dijitMenuItemHover")},onUnhover:function(d){e.remove(d,
"dijitMenuItemHover")},onSelect:function(d){e.add(d,"dijitMenuItemSelected")},onDeselect:function(d){e.remove(d,"dijitMenuItemSelected")},_page:function(d){var c=0,a=this.domNode.scrollTop,b=p.get(this.domNode,"height");for(this.getHighlightedOption()||this.selectNextNode();c<b;){var e=this.getHighlightedOption();if(d){if(!e.previousSibling||"none"==e.previousSibling.style.display)break;this.selectPreviousNode()}else{if(!e.nextSibling||"none"==e.nextSibling.style.display)break;this.selectNextNode()}e=
this.domNode.scrollTop;c+=(e-a)*(d?-1:1);a=e}},handleKey:function(d){switch(d.keyCode){case q.DOWN_ARROW:return this.selectNextNode(),!1;case q.PAGE_DOWN:return this._page(!1),!1;case q.UP_ARROW:return this.selectPreviousNode(),!1;case q.PAGE_UP:return this._page(!0),!1;default:return!0}}})})},"dijit/form/_ComboBoxMenuMixin":function(){define("dojo/_base/array dojo/_base/declare dojo/dom-attr dojo/has dojo/i18n dojo/i18n!./nls/ComboBox".split(" "),function(k,e,p,q,n){var l=e("dijit.form._ComboBoxMenuMixin"+
(q("dojo-bidi")?"_NoBidi":""),null,{_messages:null,postMixInProperties:function(){this.inherited(arguments);this._messages=n.getLocalization("dijit.form","ComboBox",this.lang)},buildRendering:function(){this.inherited(arguments);this.previousButton.innerHTML=this._messages.previousMessage;this.nextButton.innerHTML=this._messages.nextMessage},_setValueAttr:function(e){this._set("value",e);this.onChange(e)},onClick:function(e){if(e==this.previousButton)this._setSelectedAttr(null),this.onPage(-1);else if(e==
this.nextButton)this._setSelectedAttr(null),this.onPage(1);else this.onChange(e)},onChange:function(){},onPage:function(){},onClose:function(){this._setSelectedAttr(null)},_createOption:function(e,f){var d=this._createMenuItem();e=f(e);e.html?d.innerHTML=e.label:d.appendChild(d.ownerDocument.createTextNode(e.label));""==d.innerHTML&&(d.innerHTML="\x26#160;");return d},createOptions:function(e,f,d){this.items=e;this.previousButton.style.display=0==f.start?"none":"";p.set(this.previousButton,"id",this.id+
"_prev");k.forEach(e,function(a,b){a=this._createOption(a,d);a.setAttribute("item",b);p.set(a,"id",this.id+b);this.nextButton.parentNode.insertBefore(a,this.nextButton)},this);var c=!1;e.total&&!e.total.then&&-1!=e.total?f.start+f.count<e.total?c=!0:f.start+f.count>e.total&&f.count==e.length&&(c=!0):f.count==e.length&&(c=!0);this.nextButton.style.display=c?"":"none";p.set(this.nextButton,"id",this.id+"_next")},clearResultList:function(){for(var e=this.containerNode;2<e.childNodes.length;)e.removeChild(e.childNodes[e.childNodes.length-
2]);this._setSelectedAttr(null)},highlightFirstOption:function(){this.selectFirstNode()},highlightLastOption:function(){this.selectLastNode()},selectFirstNode:function(){this.inherited(arguments);this.getHighlightedOption()==this.previousButton&&this.selectNextNode()},selectLastNode:function(){this.inherited(arguments);this.getHighlightedOption()==this.nextButton&&this.selectPreviousNode()},getHighlightedOption:function(){return this.selected}});q("dojo-bidi")&&(l=e("dijit.form._ComboBoxMenuMixin",
l,{_createOption:function(){var e=this.inherited(arguments);this.applyTextDir(e);return e}}));return l})},"dijit/form/_ListMouseMixin":function(){define(["dojo/_base/declare","dojo/on","dojo/touch","./_ListBase"],function(k,e,p,q){return k("dijit.form._ListMouseMixin",q,{postCreate:function(){this.inherited(arguments);this.domNode.dojoClick=!0;this._listConnect("click","_onClick");this._listConnect("mousedown","_onMouseDown");this._listConnect("mouseup","_onMouseUp");this._listConnect("mouseover",
"_onMouseOver");this._listConnect("mouseout","_onMouseOut")},_onClick:function(e,k){this._setSelectedAttr(k,!1);this._deferredClick&&this._deferredClick.remove();this._deferredClick=this.defer(function(){this._deferredClick=null;this.onClick(k)})},_onMouseDown:function(e,k){this._hoveredNode&&(this.onUnhover(this._hoveredNode),this._hoveredNode=null);this._isDragging=!0;this._setSelectedAttr(k,!1)},_onMouseUp:function(e,k){this._isDragging=!1;var h=this.selected,f=this._hoveredNode;h&&k==h?this.defer(function(){this._onClick(e,
h)}):f&&this.defer(function(){this._onClick(e,f)})},_onMouseOut:function(e,k){this._hoveredNode&&(this.onUnhover(this._hoveredNode),this._hoveredNode=null);this._isDragging&&(this._cancelDrag=(new Date).getTime()+1E3)},_onMouseOver:function(e,k){this._cancelDrag&&((new Date).getTime()>this._cancelDrag&&(this._isDragging=!1),this._cancelDrag=null);this._hoveredNode=k;this.onHover(k);this._isDragging&&this._setSelectedAttr(k,!1)}})})},"dijit/form/_ListBase":function(){define(["dojo/_base/declare","dojo/on",
"dojo/window"],function(k,e,p){return k("dijit.form._ListBase",null,{selected:null,_listConnect:function(k,n){var l=this;return l.own(e(l.containerNode,e.selector(function(e,f,d){return e.parentNode==d},k),function(e){l[n](e,this)}))},selectFirstNode:function(){for(var e=this.containerNode.firstChild;e&&"none"==e.style.display;)e=e.nextSibling;this._setSelectedAttr(e,!0)},selectLastNode:function(){for(var e=this.containerNode.lastChild;e&&"none"==e.style.display;)e=e.previousSibling;this._setSelectedAttr(e,
!0)},selectNextNode:function(){var e=this.selected;if(e){for(e=e.nextSibling;e&&"none"==e.style.display;)e=e.nextSibling;e?this._setSelectedAttr(e,!0):this.selectFirstNode()}else this.selectFirstNode()},selectPreviousNode:function(){var e=this.selected;if(e){for(e=e.previousSibling;e&&"none"==e.style.display;)e=e.previousSibling;e?this._setSelectedAttr(e,!0):this.selectLastNode()}else this.selectLastNode()},_setSelectedAttr:function(e,k){if(this.selected!=e){var l=this.selected;if(l)this.onDeselect(l);
e&&(k&&p.scrollIntoView(e),this.onSelect(e));this._set("selected",e)}else if(e)this.onSelect(e)}})})},"jimu/dijit/_filter/NumberListValueProvider":function(){define("dojo/_base/lang dojo/_base/html dojo/_base/array dojo/_base/declare ./ValueProvider dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./NumberListValueProvider.html dijit/form/NumberTextBox dijit/form/Select".split(" "),function(k,e,p,q,n,l,h,f){return q([n,l,h],{templateString:f,postCreate:function(){this.inherited(arguments);
e.addClass(this.domNode,"jimu-number-list-filter-value-provider");this.rangeSelect.removeOption(this.rangeSelect.getOptions());p.forEach("dateOperatorMinutes dateOperatorHours dateOperatorDays dateOperatorWeeks dateOperatorMonths dateOperatorYears".split(" "),k.hitch(this,function(d){this.rangeSelect.addOption({value:d,label:this.nls[d]})}));this.rangeSelect.set("value","dateOperatorDays")},getDijits:function(){return[this._dijit1,this.rangeSelect]},setValueObject:function(d){this.isDefined(d.value)&&
this._dijit1.set("value",d.value);this.isDefined(d.range)&&this.rangeSelect.set("value",d.range)},getValueObject:function(){return this.isValidValue()?{isValid:!0,type:this.partObj.valueObj.type,value:parseFloat(this._dijit1.get("value")),range:this._getRangeByUI()}:null},_getRangeByUI:function(){var d=this.rangeSelect.get("value");"none"===d&&(d=null);return d},tryGetValueObject:function(){if(this.isValidValue())return this.getValueObject();if(this.isEmptyValue()){var d={isValid:!0,type:this.partObj.valueObj.type,
value:parseFloat(this._dijit1.get("value")),range:this._getRangeByUI()};isNaN(d.value)&&(d.value=null);return d}return null},setRequired:function(d){this._dijit1.set("required",d);this.rangeSelect.set("required",d)}})})},"jimu/dijit/_filter/DateIsInValueProvider":function(){define("dojo/Evented dojo/_base/html dojo/_base/lang dojo/_base/declare dijit/_WidgetsInTemplateMixin dojo/text!./DateIsInValueProvider.html ./ValueProvider jimu/filterUtils dijit/form/Select dijit/form/DateTextBox".split(" "),
function(k,e,p,q,n,l,h,f){return q([h,n,k],{templateString:l,postMixInProperties:function(){this.inherited(arguments);this.nls=window.jimuNls.filterBuilder},virtualDates:null,postCreate:function(){this.inherited(arguments);e.addClass(this.domNode,"jimu-date-is-in-value-provider");this.dateTypeSelect.addOption({value:"",label:"\x26nbsp;"});return["thisWeek","thisMonth","thisQuarter","thisYear"].forEach(p.hitch(this,function(d){this.dateTypeSelect.addOption({value:d,label:this.nls[d]})}))},getDijits:function(){return[this.dateTypeSelect]},
_setValueObject:function(d,c,a,b){if(this.isDefined(c[a])){var e={value:null,virtualDate:""};e.value=c[a];e.virtualDate=c[b];d.setValueObject(e)}},setValueObject:function(d){this.dateTypeSelect.set("value",d.virtualDate)},getValueObject:function(){return this.isValidValue()?this.tryGetValueObject():null},tryGetValueObject:function(){if(this.isInvalidValue())return null;var d={isValid:!0,type:this.partObj.valueObj.type,value:null,virtualDate:this.dateTypeSelect.get("value")},c=this.dateTypeSelect.get("value"),
a=f.getRealDateByVirtualDate(c);d.virtualDate=c;a&&(d.value1=a[0].toDateString(),d.value2=a[1].toDateString());return d},setRequired:function(d){this.dateTypeSelect.set("required",d)},getStatus:function(){return this.dateTypeSelect.get("value")?1:0},_onDateTypeSelectChanged:function(){this.emit("change")}})})},"jimu/dijit/_SingleFilter":function(){define("dojo/Evented dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/_SingleFilter.html dojo/_base/lang dojo/_base/html dojo/_base/array dojo/on dojo/query dojo/store/Memory jimu/utils jimu/dijit/_filter/ValueProviderFactory jimu/dijit/CheckBox dijit/form/Select dijit/form/FilteringSelect dijit/form/ValidationTextBox dijit/popup dijit/TooltipDialog".split(" "),
function(k,e,p,q,n,l,h,f,d,c,a,b,g,u,m,r){return e([p,q,n,k],{templateString:l,baseClass:"jimu-single-filter",declaredClass:"jimu.dijit._SingleFilter",nls:null,url:null,layerInfo:null,stringFieldType:"",dateFieldType:"",numberFieldTypes:[],supportFieldTypes:[],part:null,OPERATORS:null,enableAskForValues:!1,isHosted:!1,valueProviderFactory:null,valueProvider:null,postMixInProperties:function(){this.supportFieldTypes=[];this.supportFieldTypes.push(this.stringFieldType);this.supportFieldTypes.push(this.dateFieldType);
this.supportFieldTypes=this.supportFieldTypes.concat(this.numberFieldTypes);this.nls=window.jimuNls.filterBuilder},postCreate:function(){this.inherited(arguments);this._initSelf();this.own(c(document,"click",h.hitch(this,function(){f.setStyle(this.valueTypePopupNode,"display","none")})))},toJson:function(){var a={fieldObj:"",operator:"",valueObj:"",interactiveObj:"",caseSensitive:!1},b=this._getFieldObjByUI();if(!b)return null;a.fieldObj=b;b=this._getOperatorByUI();if(!b)return null;a.operator=b;
a.caseSensitive=this.cbxCaseSensitive.getStatus()&&this.cbxCaseSensitive.getValue();if(b=this._isUseAskForValues()){if(!this.promptTB.validate())return this._showValidationErrorTip(this.promptTB),null;a.interactiveObj={prompt:this.promptTB.get("value"),hint:this.hintTB.get("value"),cascade:"none"};"unique"===this._getValueTypeByUI()&&(a.interactiveObj.cascade=this.cascadeSelect.get("value"))}a.valueObj={isValid:!0,type:""};b=b?this.valueProvider.tryGetValueObject():this.valueProvider.getValueObject();
if(!b)return null;b.type=this._getValueTypeByUI();a.valueObj=b;return a},_getFieldObjByUI:function(){var a=this._getSelectedFilteringItem(this.fieldsSelect);return a?{name:a.name,label:a.name,shortType:a.shortType,type:a.type}:null},_getOperatorByUI:function(){var a=this.operatorsSelect.get("value");"none"===a&&(a=null);return a},showDelteIcon:function(){f.setStyle(this.btnDelete,"display","inline-block")},hideDeleteIcon:function(){f.setStyle(this.btnDelete,"display","none")},_showAndEnableCaseSensitive:function(){this.cbxCaseSensitive.setStatus(!0);
f.setStyle(this.cbxCaseSensitive.domNode,"display","inline-block")},_hideAndDisableCaseSensitive:function(){this.cbxCaseSensitive.setStatus(!1);f.setStyle(this.cbxCaseSensitive.domNode,"display","none")},_initSelf:function(){this.layerInfo=h.mixin({},this.layerInfo);this.isHosted&&(this.cbxCaseSensitive.setValue(!1),this.cbxCaseSensitive.setStatus(!1),this.cbxCaseSensitive.domNode.title=this.nls.notSupportCaseSensitiveTip);this.own(c(this.fieldsSelect,"MouseEnter",h.hitch(this,this._updateFieldsSelectTitle)));
this.own(c(this.operatorsSelect,"MouseEnter",h.hitch(this,this._updateOperatorsSelectTitle)));this.enableAskForValues?(f.setStyle(this.cbxAskValues.domNode,"display","inline-block"),f.setStyle(this.promptSection,"display","block"),this.own(c(this.cbxAskValues,"status-change",h.hitch(this,this._onCbxAskValuesStatusChanged))),this.cbxAskValues.onChange=h.hitch(this,this._onCbxAskValuesClicked)):(f.setStyle(this.cbxAskValues.domNode,"display","none"),f.setStyle(this.promptSection,"display","none"));
var a=this.layerInfo.fields;a&&0<a.length&&(a=d.filter(a,h.hitch(this,function(a){return 0<=this.supportFieldTypes.indexOf(a.type)})),0<a.length&&(this._enableAllValueTypeOptions(),this._initFieldsSelect(a),this.part?this._showPart(this.part):this._resetByFieldAndOperator(),setTimeout(h.hitch(this,function(){this._bindFieldsSelectChangeAndOperatorChangeEvents()}),10)))},_bindFieldsSelectChangeAndOperatorChangeEvents:function(){this._removeFieldsSelectChangeAndOperatorChangeEvents();this._handle1=
c(this.fieldsSelect,"change",h.hitch(this,this._onFieldsSelectChange));this._handle2=c(this.operatorsSelect,"change",h.hitch(this,this._onOperatorsSelectChange))},_removeFieldsSelectChangeAndOperatorChangeEvents:function(){this._handle1&&this._handle1.remove();this._handle2&&this._handle2.remove();this._handle2=this._handle1=null},_isServiceSupportDistinctValues:function(a,b){return this._isStreamServer(a)?!1:10.1<=parseFloat(b.currentVersion)},_isStreamServer:function(a){a=(a||"").replace(/\/*$/g,
"");return/\/StreamServer$/gi.test(a)},_updateFieldsSelectTitle:function(){this.fieldsSelect.domNode.title="";var a=this._getSelectedFilteringItem(this.fieldsSelect);a&&(this.fieldsSelect.domNode.title=a.displayName||a.alias||a.name)},_updateOperatorsSelectTitle:function(){this.operatorsSelect.domNode.title="";var a=this.operatorsSelect.get("value");a&&(a=this.operatorsSelect.getOptions(a),this.operatorsSelect.domNode.title=a.label)},_showValidationErrorTip:function(a){try{!a.validate()&&a.domNode&&
a.focusNode&&(a.focusNode.focus(),a.focusNode.blur())}catch(v){console.error(v)}},_getSelectedFilteringItem:function(a){if(a.validate()){var b=a.get("item");if(b)return b}this._showValidationErrorTip(a);return null},_getShortTypeByFieldType:function(a){return a===this.stringFieldType?"string":a===this.dateFieldType?"date":0<=this.numberFieldTypes.indexOf(a)?"number":null},_initFieldsSelect:function(a){a=d.map(a,h.hitch(this,function(a,b){var c=h.mixin({},a);c.id=b;c.shortType=this._getShortTypeByFieldType(a.type);
c.alias||(c.alias=c.name);a="";"string"===c.shortType?a=this.nls.string:"number"===c.shortType?a=this.nls.number:"date"===c.shortType&&(a=this.nls.date);c.displayName=c.alias+" ("+a+")";return c}));if(0<a.length){var c=new b({data:a});this.fieldsSelect.set("store",c);this.fieldsSelect.set("value",a[0].id)}this._updateOperatorsByFieldsSelect()},_showPart:function(a){if((this.part=a)&&this.part.fieldObj&&this.part.operator&&this.part.valueObj){this._removeFieldsSelectChangeAndOperatorChangeEvents();
var b=this.part.fieldObj.name;a=this.part.operator;this.part.caseSensitive=!!this.part.caseSensitive;b=this.fieldsSelect.store.query({name:b});0!==b.length&&(b=b[0])&&(this.fieldsSelect.set("value",b.id),this._updateOperatorsByFieldsSelect(),this.operatorsSelect.set("value",a),this._resetByFieldAndOperator(this.part),a=this.part.interactiveObj)&&(this.cbxAskValues.check(),this._updatePrompt(),this.promptTB.set("value",a.prompt||""),this.hintTB.set("value",a.hint||""),"unique"===this.part.valueObj.type?
this.cascadeSelect.set("value",a.cascade):this.cascadeSelect.set("value","none"))}},_onFieldsSelectChange:function(){this._updateOperatorsByFieldsSelect();this._resetByFieldAndOperator()},_updateOperatorsByFieldsSelect:function(){this._updateFieldsSelectTitle();this.operatorsSelect.removeOption(this.operatorsSelect.getOptions());this.operatorsSelect.addOption({value:"none",label:this.nls.none});var a=this._getSelectedFilteringItem(this.fieldsSelect);a&&(this.operatorsSelect.shortType=a.shortType,
a=u.getOperatorsByShortType(a.shortType),this.operatorsSelect.removeOption(this.operatorsSelect.getOptions()),d.forEach(a,h.hitch(this,function(a){this.operatorsSelect.addOption({value:a,label:this.nls[a]})})))},_onOperatorsSelectChange:function(){this._resetByFieldAndOperator()},_updateValueTypeClass:function(){f.removeClass(this.domNode,"value-type");f.removeClass(this.domNode,"field-type");f.removeClass(this.domNode,"unique-type");f.removeClass(this.domNode,"support-cascade");var a=this._getValueTypeByUI();
"value"===a?(f.addClass(this.domNode,"value-type"),this.cascadeSelect.set("value","none")):"field"===a?(f.addClass(this.domNode,"field-type"),this.cascadeSelect.set("value","none")):(f.addClass(this.domNode,"unique-type"),this.cascadeSelect.set("value","previous"),a=!0,a=this._getSelectedFilteringItem(this.fieldsSelect),a=this._getCodedValuesOrTypesCount(a),(a=0<a?g.isCodedValuesSupportFilter(this.layerInfo,a):!0)?(this.cascadeSelect.set("value","previous"),f.addClass(this.domNode,"support-cascade")):
this.cascadeSelect.set("value","none"))},_getCodedValuesOrTypesCount:function(a){if(a){if(a.domain&&"codedValue"===a.domain.type&&a.domain.codedValues)return a.domain.codedValues.length;if(this.layerInfo.typeIdField===a.name&&this.layerInfo.types)return this.layerInfo.types.length}return 0},_enableValueTypeSelectOption:function(b,c){b=a("li[data-type\x3d"+b+"]",this.valueTypePopupNode)[0];c?f.removeClass(b,"disabled"):f.addClass(b,"disabled")},_onValueTypeSetClick:function(b){var c=f.position(b.target),
e;e=this.isInFilterSet?this.domNode.parentNode.parentNode.parentNode:this.domNode.parentNode;var g=f.position(e);if("none"!==f.getStyle(this.valueTypePopupNode,"display"))f.setStyle(this.valueTypePopupNode,"display","none");else{d.forEach(a(".value-type-popup",e),function(a){f.setStyle(a,"display","none")},this);f.place(this.valueTypePopupNode,e);var h;h=f.hasClass(a(".desktop-add-section",e.parentNode)[0],"hidden")?55:90;h=c.y-g.y-e.parentNode.scrollTop+h;h+170>e.parentNode.scrollHeight&&(h=e.parentNode.scrollHeight-
170);window.isRTL?c=c.x-g.x+20:(c=c.x-g.x-100,c+150>e.clientWidth&&(c=e.clientWidth-150));f.setStyle(this.valueTypePopupNode,{display:"block",left:c+"px",top:h+"px"});b.stopPropagation()}},_onValueTypeClick:function(b){var c=f.getAttr(b.currentTarget,"data-type");f.hasClass(b.currentTarget,"disabled")?b.stopPropagation():(a("li",this.valueTypePopupNode).forEach(function(a){f.removeClass(a,"selected")}),f.addClass(b.currentTarget,"selected"),this._resetByFieldAndOperator(null,c))},_enableValueTypeOption:function(a){this._enableValueTypeSelectOption("value",
a)},_enableFieldTypeOption:function(a){this._enableValueTypeSelectOption("field",a)},_enableUniqueTypeOption:function(a){this._enableValueTypeSelectOption("unique",a)},_enableAllValueTypeOptions:function(){this._enableValueTypeOption(!0);this._enableFieldTypeOption(!0);this._enableUniqueTypeOption(!0)},_disableAllValueTypeOptions:function(){this._enableValueTypeOption(!1);this._enableFieldTypeOption(!1);this._enableUniqueTypeOption(!1)},_resetByFieldAndOperator:function(a,b){this._updateOperatorsSelectTitle();
this.valueProvider&&this.valueProvider.destroy();this._hideAndDisableCaseSensitive();this._disableAllValueTypeOptions();a||(a={fieldObj:"",operator:"",valueObj:"",interactiveObj:"",caseSensitive:!1},a.fieldObj=this._getFieldObjByUI(),a.operator=this._getOperatorByUI());var d=[],e=null;a.fieldObj&&a.operator&&(d=this.valueProviderFactory.getSupportedValueTypes(a.fieldObj.name,a.operator),a.valueObj?e=a.valueObj.type:(e=b&&0<=d.indexOf(b)?b:d[0],a.valueObj={type:e}),0<=d.indexOf("value")&&this._enableValueTypeOption(!0),
0<=d.indexOf("field")&&this._enableFieldTypeOption(!0),0<=d.indexOf("unique")&&this._enableUniqueTypeOption(!0),"value"===e?this._enableValueTypeOption(!0):"field"===e?this._enableFieldTypeOption(!0):"unique"===e&&this._enableUniqueTypeOption(!0),this._updateValueTypeUI(e));0<d.length?(this.valueProvider=this.valueProviderFactory.getValueProvider(a,!1),this.valueProvider.placeAt(this.valueProviderContainer),this.valueProvider.setValueObject(a.valueObj),this.own(c(this.valueProvider,"change",h.hitch(this,
function(){this.emit("change")}))),this.valueProvider.bindChangeEvents(),this.valueProvider.isBlankValueProvider()?(f.addClass(this.valueProvider.domNode,"hidden"),f.addClass(this.attributeValueContainer,"hidden")):f.removeClass(this.attributeValueContainer,"hidden"),(b=u.getOperatorInfo(a.operator))&&e&&(b[e]&&b[e].supportCaseSensitive&&this._showAndEnableCaseSensitive(),a&&this.cbxCaseSensitive.setValue(a.caseSensitive))):f.addClass(this.attributeValueContainer,"hidden");this._updateWhenValueRadioChanged();
this.emit("change")},_updateWhenValueRadioChanged:function(){this._updatePrompt();this._updateValueTypeClass()},_onCbxAskValuesClicked:function(){this._updateRequiredProperty();this._updatePrompt()},_onCbxAskValuesStatusChanged:function(){this._updateRequiredProperty()},_isUseAskForValues:function(){return this.cbxAskValues.status&&this.cbxAskValues.checked},_isValueRequired:function(){return!this._isUseAskForValues()},_updateRequiredProperty:function(){var a=this._isValueRequired();this.valueProvider.setRequired(a)},
_getValueTypeByUI:function(){var b=a("li.selected",this.valueTypePopupNode)[0];return b?f.getAttr(b,"data-type"):null},_updateValueTypeUI:function(b){a("li",this.valueTypePopupNode).forEach(function(a){f.removeClass(a,"selected")});if(b=a("li[data-type\x3d"+b+"]",this.valueTypePopupNode)[0])return f.addClass(b,"selected")},_updatePrompt:function(){this.promptTB.set("value","");this.hintTB.set("value","");this.cbxAskValues.setStatus(!0);f.setStyle(this.promptTable,"display","table");var a=this.operatorsSelect.get("value"),
b=this.nls[a],c=!1,d=this._getValueTypeByUI(),e=u.getOperatorInfo(a);e&&d&&(d=e[d])&&d.supportAskForValue&&(c=!0);c||(this.cbxAskValues.uncheck(!0),this.cbxAskValues.setStatus(!1));this.cbxAskValues.status&&this.cbxAskValues.checked?(f.setStyle(this.promptTable,"display","table"),(c=this._getSelectedFilteringItem(this.fieldsSelect))&&"none"!==a&&this.promptTB.set("value",(c.alias||c.name)+" "+b)):f.setStyle(this.promptTable,"display","none")},_destroySelf:function(){this.destroy()},destroy:function(){this._removeFieldsSelectChangeAndOperatorChangeEvents();
this.inherited(arguments)}})})},"jimu/dijit/_FilterSet":function(){define("dojo/Evented dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/_FilterSet.html dijit/registry dojo/_base/lang dojo/_base/html dojo/_base/array dojo/on dojo/aspect dojo/query ./_SingleFilter".split(" "),function(k,e,p,q,n,l,h,f,d,c,a,b,g,u){return e([p,q,n,k],{templateString:l,baseClass:"jimu-filter-set",nls:null,url:null,layerInfo:null,stringFieldType:"",dateFieldType:"",
numberFieldTypes:[],partsObj:null,OPERATORS:null,enableAskForValues:!1,isHosted:!1,valueProviderFactory:null,postMixInProperties:function(){this.nls=window.jimuNls.filterBuilder;var a=this.nls.matchMsgSet.split("${any_or_all}");this.nls.strMatchMsgPart1=a[0]||"";this.nls.strMatchMsgPart2=a[1]||"";this.inherited(arguments)},postCreate:function(){this.inherited(arguments);this._initSelf()},toJson:function(){var a=g(".jimu-single-filter",this.allExpsBox),a=c.map(a,f.hitch(this,function(a){return h.byNode(a).toJson()}));
return c.every(a,f.hitch(this,function(a){return!!a}))&&0<a.length?{logicalOperator:this.allAnySelect.value,parts:a}:null},showDelteIcon:function(){d.setStyle(this.btnDelete,"display","block")},hideDeleteIcon:function(){d.setStyle(this.btnDelete,"display","none")},_initSelf:function(){this.own(a(this.btnAdd,"click",f.hitch(this,function(){this._addSingleFilter();this.emit("change")})));if(this.partsObj){this.allAnySelect.value=this.partsObj.logicalOperator;var b=this.partsObj.parts||[];0===b.length?
(this._addSingleFilter(),this._addSingleFilter()):1===b.length?(this._addSingleFilter(b[0]),this._addSingleFilter()):c.forEach(b,f.hitch(this,function(a){this._addSingleFilter(a)}))}else this._addSingleFilter(),this._addSingleFilter()},_addSingleFilter:function(c){c=new u({url:this.url,layerInfo:this.layerInfo,stringFieldType:this.stringFieldType,dateFieldType:this.dateFieldType,numberFieldTypes:this.numberFieldTypes,part:c,OPERATORS:this.OPERATORS,enableAskForValues:this.enableAskForValues,isHosted:this.isHosted,
valueProviderFactory:this.valueProviderFactory,isInFilterSet:!0});c.placeAt(this.allExpsBox);c.startup();this.own(b.after(c,"_destroySelf",f.hitch(this,this._checkFilterNumbers)));this.own(a(c,"change",f.hitch(this,function(){this.emit("change")})));this._checkFilterNumbers();return c},_checkFilterNumbers:function(){var a=g(".jimu-single-filter",this.allExpsBox),b=2<a.length;c.forEach(a,f.hitch(this,function(a){a=h.byNode(a);b?a.showDelteIcon():a.hideDeleteIcon()}))},_destroySelf:function(){this.destroy()}})})},
"builder/plugins/attribute-config/dataSource/DataFields":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/html dojo/_base/query dojo/on dijit/_WidgetBase dijit/_TemplatedMixin dojo/Evented dojo/text!./DataFields.html".split(" "),function(k,e,p,q,n,l,h,f,d,c){return k([h,d,f],{baseClass:"jimu-widget-chart-setting-data-fields",templateString:c,postCreate:function(){this.inherited(arguments);this.own(l(this.domNode,"click",e.hitch(this,this._onDomClicked)))},clear:function(){q.empty(this.fieldsContent);
this.emit("change")},setFields:function(a){this.clear();p.forEach(a,e.hitch(this,function(a){var b=q.toDom('\x3cdiv class\x3d"field-item"\x3e\x3cinput type\x3d"checkbox" /\x3e\x3cspan class\x3d"jimu-ellipsis" /\x3e\x3c/div\x3e'),c=n("input",b)[0],d=n("span",b)[0];c.checked=!!a.checked;c.disabled=!!a.disabled;d.innerHTML=a.alias||a.name;d.title=a.alias||a.name;b.fieldName=a.name;q.place(b,this.fieldsContent);this.own(l(c,"change",e.hitch(this,function(){this.emit("change")})))}));this.emit("change")},
selectFields:function(a){e.isArrayLike(a)&&(a=e.clone(a),a.reverse(),p.forEach(a,e.hitch(this,function(a){if(a=this._getFieldItemDivByName(a))q.place(a,a.parentNode,"first"),n("input",a)[0].checked=!0})));this.emit("change")},getSelectedFieldNames:function(){var a=n(".field-item",this.fieldsContent),b=[];p.forEach(a,e.hitch(this,function(a){n("input",a)[0].checked&&b.push(a.fieldName)}));return b},_getFieldItemDivByName:function(a){var b=n(".field-item",this.fieldsContent);return p.filter(b,e.hitch(this,
function(b){return b.fieldName===a}))[0]},_onDomClicked:function(a){a=a.target||a.srcElement;if(q.isDescendant(a,this.fieldsContent)&&a!==this.fieldsContent){var b=a.tagName.toLowerCase(),c=null;q.hasClass(a,"field-item")?this._selectFieldItemDom(a):"span"===b?(c=a.parentNode,this._selectFieldItemDom(c)):"input"===b&&(c=a.parentNode,a.checked?this._selectFieldItemDom(c):q.removeClass(c,"selected"));this._updateHighLightIcons()}},_updateHighLightIcons:function(){var a=this._getSelectedFieldItemDiv();
a&&q.hasClass(a,"selected")&&(a.previousSibling?q.addClass(this.btnUp,"high-light"):q.removeClass(this.btnUp,"high-light"),a.nextSibling?q.addClass(this.btnDown,"high-light"):q.removeClass(this.btnDown,"high-light"))},_selectFieldItemDom:function(a){n(".field-item",this.fieldsContent).removeClass("selected");q.addClass(a,"selected")},_getSelectedFieldItemDiv:function(){var a=null,b=n(".field-item.selected",this.fieldsContent);0<b.length&&(a=b[0]);return a},_moveUp:function(){var a=this._getSelectedFieldItemDiv();
a&&a.previousSibling&&q.place(a,a.previousSibling,"before");this._updateHighLightIcons()},_moveDown:function(){var a=this._getSelectedFieldItemDiv();a&&a.nextSibling&&q.place(a,a.nextSibling,"after");this._updateHighLightIcons()}})})},"builder/plugins/attribute-config/dataSource/utils":function(){define(["jimu/utils"],function(k){return{createDataSourceId:function(e,p){var q="";return q="map"===e&&p?"map~"+p+"~"+k.getRandomString():"external~"+k.getRandomString()}}})},"jimu/dijit/DataPreviewTable":function(){define("dojo/_base/declare dojo/_base/html dijit/_WidgetBase dojo/_base/lang dojo/_base/array jimu/utils dgrid/OnDemandGrid dgrid/extensions/ColumnResizer dgrid/extensions/ColumnReorder".split(" "),
function(k,e,p,q,n,l,h,f,d){return k([p],{declaredClass:"jimu.dijit.DataPreviewTable",baseClass:"jimu-data-preview-table",featureSet:null,loadingIndicator:null,_AUTO_WIDTH_COLS:6,postCreate:function(){this.inherited(arguments);l.loadStyleLink("dgrid",apiUrl+"dgrid/css/dgrid.css");this.tableContainer=e.create("div",{"class":"table-container"},this.domNode);this.height&&e.style(this.tableContainer,"height",this.height-80+"px");var c=this._getColumns();this.grid=new (k([h,f,d]))({columns:c},this.tableContainer);
c=this._getData();this.grid.renderArray(c)},_getColumns:function(){var c="auto";this.featureSet.fields&&this.featureSet.fields.length&&this.featureSet.fields.length>this._AUTO_WIDTH_COLS&&(c=120);var a={};n.forEach(this.featureSet.fields,function(b){a[b.name]={label:b.alias,width:c}});return a},_getData:function(){var c=[];n.forEach(this.featureSet.features,function(a,b){var d={};n.forEach(this.featureSet.fields,function(b){d[b.name]=a.attributes[b.name]},this);c.push(q.clone(q.mixin({id:b+1},d)))},
this);return c}})})},"dgrid/extensions/ColumnResizer":function(){define("dojo/_base/declare dojo/on dojo/query dojo/_base/lang dojo/dom dojo/dom-geometry dojo/has ../util/misc put-selector/put dojo/_base/html xstyle/css!../css/extensions/ColumnResizer.css".split(" "),function(k,e,p,q,n,l,h,f,d){function c(a){for(var b=a.length,c=b,d=a[0].length,e=Array(b);b--;)e[b]=Array(d);for(var f={},b=0;b<c;b++)for(var g=e[b],h=a[b],k=0,m=0;k<d;k++){var l=h[m],n;if("undefined"==typeof g[k]){g[k]=l.id;if(l.rowSpan&&
1<l.rowSpan){n=e;for(var p=l.rowSpan,q=b,u=k,M=l.id,L=1;L<p;L++)n[q+L][u]=M}if(0<b&&l.colSpan&&1<l.colSpan)for(n=1;n<l.colSpan;n++)if(g[++k]=l.id,l.rowSpan&&1<l.rowSpan)for(var p=e,q=l.rowSpan,u=b,M=k,L=l.id,J=1;J<q;J++)p[u+J][M]=L;f[l.id]=a[0][k].id;m++}}return f}function a(a,b,c,d,g){if(!(0>=c)){var h=a.columns[b],k;if(h&&(k={grid:a,columnId:b,width:c,bubbles:!0,cancelable:!0},d&&(k.parentType=d),!a._resizedColumns||e.emit(a.headerNode,"dgrid-columnresize",k)))return"auto"===c?delete h.width:(h.width=
c,c+="px"),(d=a._columnSizes[b])?d.set("width",c):d=f.addCssRule("#"+f.escapeCssIdentifier(a.domNode.id)+" .dgrid-column-"+f.escapeCssIdentifier(b,"-"),"width: "+c+";"),a._columnSizes[b]=d,!1!==g&&a.resize(),!0}}var b,g=0,u={create:function(){b=d("div.dgrid-column-resizer")},destroy:function(){d(b,"!");b=null},show:function(a){a=l.position(a.domNode,!0);b.style.top=a.y+"px";b.style.height=a.h+"px";d(document.body,b)},move:function(a){b.style.left=a+"px"},hide:function(){b.parentNode.removeChild(b)}};
return k("dgrid.extensions.ColumnResizer",null,{resizeNode:null,minWidth:40,adjustLastColumn:!0,_resizedColumns:!1,buildRendering:function(){this.inherited(arguments);g++||u.create()},destroy:function(){this.inherited(arguments);for(var a in this._columnSizes)this._columnSizes[a].remove();--g||u.destroy()},resizeColumnWidth:function(b,c){return a(this,b,c)},configStructure:function(){var a=this._oldColumnSizes=q.mixin({},this._columnSizes),b;this._resizedColumns=!1;this._columnSizes={};this.inherited(arguments);
for(b in a)b in this._columnSizes||a[b].remove();delete this._oldColumnSizes},_configColumn:function(a){this.inherited(arguments);var b=a.id,c;"width"in a&&((c=this._oldColumnSizes[b])?c.set("width",a.width+"px"):c=f.addCssRule("#"+f.escapeCssIdentifier(this.domNode.id)+" .dgrid-column-"+f.escapeCssIdentifier(b,"-"),"width: "+a.width+"px;"),this._columnSizes[b]=c)},renderHeader:function(){this.inherited(arguments);var a=this,b;if(this.columnSets&&this.columnSets.length)for(var g=this.columnSets.length;g--;)b=
q.mixin(b||{},c(this.columnSets[g]));else this.subRows&&1<this.subRows.length&&(b=c(this.subRows));for(var g=p(".dgrid-cell",a.headerNode),k=g.length;k--;){var l=g[k],n=l.columnId,u=a.columns[n],x=l.childNodes;if(u&&!1!==u.resizable){u=d("div.dgrid-resize-header-container");for(l.contents=u;0<x.length;)d(u,x[0]);d(l,u,"div.dgrid-resize-handle.resizeNode-"+f.escapeCssIdentifier(n,"-")).columnId=b&&b[n]||n}}a.mouseMoveListen||(e(a.headerNode,".dgrid-resize-handle:mousedown"+(h("touch")?",.dgrid-resize-handle:touchstart":
""),function(b){a._resizeMouseDown(b,this);a.mouseMoveListen.resume();a.mouseUpListen.resume()}),a._listeners.push(a.mouseMoveListen=e.pausable(document,"mousemove"+(h("touch")?",touchmove":""),f.throttleDelayed(function(b){a._updateResizerPosition(b)}))),a._listeners.push(a.mouseUpListen=e.pausable(document,"mouseup"+(h("touch")?",touchend":""),function(b){a._resizeMouseUp(b);a.mouseMoveListen.pause();a.mouseUpListen.pause()})),a.mouseMoveListen.pause(),a.mouseUpListen.pause())},_resizeMouseDown:function(a,
b){a.preventDefault();n.setSelectable(this.domNode,!1);this._startX=this._getResizeMouseLocation(a);this._targetCell=p(".dgrid-column-"+f.escapeCssIdentifier(b.columnId,"-"),this.headerNode)[0];this._updateResizerPosition(a);u.show(this)},_resizeMouseUp:function(b){var c=this._columnSizes,d,e,g;this.adjustLastColumn&&(g=this.headerNode.clientWidth-1);this._resizedColumns||(d=p(".dgrid-cell",this.headerNode),this.columnSets&&this.columnSets.length?d=d.filter(function(a){return"0"==a.columnId.split("-")[0]&&
!(a.columnId in c)}):this.subRows&&1<this.subRows.length&&(d=d.filter(function(a){return"0"==a.columnId.charAt(0)&&!(a.columnId in c)})),e=d.map(function(a){return a.offsetWidth}),d.forEach(function(b,c){a(this,b.columnId,e[c],null,!1)},this),this._resizedColumns=!0);n.setSelectable(this.domNode,!0);d=this._targetCell;var h=this._getResizeMouseLocation(b)-this._startX,k=d.offsetWidth+h,m=this._getResizedColumnWidths(),l=m.totalWidth,m=m.lastColId,q=p(".dgrid-column-"+f.escapeCssIdentifier(m,"-"),
this.headerNode)[0].offsetWidth;k<this.minWidth&&(k=this.minWidth);a(this,d.columnId,k,b.type)&&d.columnId!=m&&this.adjustLastColumn&&(l+h<g?a(this,m,"auto",b.type):q-h<=this.minWidth&&a(this,m,this.minWidth,b.type));u.hide();delete this._startX;delete this._targetCell},_updateResizerPosition:function(a){if(this._targetCell){a=this._getResizeMouseLocation(a);var b=this._targetCell.offsetWidth,c=a;b+(a-this._startX)<this.minWidth&&(c=this._startX-(b-this.minWidth));u.move(c)}},_getResizeMouseLocation:function(a){var b=
0;a.pageX?b=a.pageX:a.clientX&&(b=a.clientX+document.body.scrollLeft+document.documentElement.scrollLeft);return b},_getResizedColumnWidths:function(){var a=0,b=p((this.columnSets?".dgrid-column-set-cell ":"")+"tr:first-child .dgrid-cell",this.headerNode),c=b.length;if(!c)return{};for(var d=b[c-1].columnId;c--;)a+=b[c].offsetWidth;return{totalWidth:a,lastColId:d}}})})},"dgrid/extensions/ColumnReorder":function(){define("dojo/_base/lang dojo/_base/declare dojo/_base/array dojo/on dojo/query dojo/dnd/Source put-selector/put xstyle/css!../css/extensions/ColumnReorder.css".split(" "),
function(k,e,p,q,n,l,h){function f(a,c){var b=c[2];a=a[b?"columnSets":"subRows"][c[1]];return b?a[c[2]]:a}function d(a,c,d){c[2]?a.columnSets[c[1]][c[2]]=d:a.subRows[c[1]]=d}function c(a,c){return c.slice(("dgrid-"+a+"-").length)}var a=/(\d+)(?:-(\d+))?$/;k=e(l,{copyState:function(){return!1},checkAcceptance:function(a,c){return a==this},_legalMouseDown:function(a){return-1<a.target.className.indexOf("dgrid-resize-handle")?!1:this.inherited(arguments)},onDropInternal:function(b){var e=this.grid,h=
a.exec(c(e.id,b[0].getAttribute("dndType"))),k=h[2]?"columnSets":"subRows",l=f(e,h),n=e.columns;this.inherited(arguments);h&&setTimeout(function(){var a=p.map(b[0].parentNode.childNodes,function(a){return n[a.columnId]});d(e,h,a);a={grid:e,subRow:a,column:n[b[0].columnId],bubbles:!0,cancelable:!0,parentType:"dnd"};a[k]=e[k];q.emit(e.domNode,"dgrid-columnreorder",a)?e.set(k,e[k]):(d(e,h,l),e.renderHeader(),this._sort&&this._sort.length&&this.updateSortArrow(this._sort))},0)}});e=e("dgrid.extensions.ColumnReorder",
null,{columnDndConstructor:k,_initSubRowDnd:function(a,c){var b,d,e,f;d=0;for(e=a.length;d<e;d++)f=a[d],!1!==f.reorderable&&(f=f.headerNode,"TH"!=f.tagName&&(f=f.parentNode),h(f,".dojoDndItem[dndType\x3d"+c+"]"),b||(b=f.parentNode));b&&this._columnDndSources.push(new this.columnDndConstructor(b,{horizontal:!0,grid:this}))},renderHeader:function(){var a="dgrid-"+this.id+"-",c,d;this.inherited(arguments);this._columnDndSources=[];if(this.columnSets)for(d=0,c=this.columnSets.length;d<c;d++)p.forEach(this.columnSets[d],
function(b,c){this._initSubRowDnd(b,a+d+"-"+c)},this);else p.forEach(this.subRows,function(b,c){this._initSubRowDnd(b,a+c)},this)},_destroyColumns:function(){this._columnDndSources&&p.forEach(this._columnDndSources,function(a){a.destroy()});this.inherited(arguments)}});e.ColumnDndSource=k;return e})},"dojo/dnd/Source":function(){define("../_base/array ../_base/declare ../_base/kernel ../_base/lang ../dom-class ../dom-geometry ../mouse ../ready ../topic ./common ./Selector ./Manager".split(" "),function(k,
e,p,q,n,l,h,f,d,c,a,b){p.isAsync||f(0,function(){require(["dojo/dnd/AutoSource","dojo/dnd/Target"])});var g=e("dojo.dnd.Source",a,{isSource:!0,horizontal:!1,copyOnly:!1,selfCopy:!1,selfAccept:!0,skipForm:!1,withHandles:!1,autoSync:!1,delay:0,accept:["text"],generateText:!0,constructor:function(a,b){q.mixin(this,q.mixin({},b));a=this.accept;if(a.length)for(this.accept={},b=0;b<a.length;++b)this.accept[a[b]]=1;this.mouseDown=this.isDragging=!1;this.targetBox=this.targetAnchor=null;this.before=!0;this._lastY=
this._lastX=0;this.sourceState="";this.isSource&&n.add(this.node,"dojoDndSource");this.targetState="";this.accept&&n.add(this.node,"dojoDndTarget");this.horizontal&&n.add(this.node,"dojoDndHorizontal");this.topics=[d.subscribe("/dnd/source/over",q.hitch(this,"onDndSourceOver")),d.subscribe("/dnd/start",q.hitch(this,"onDndStart")),d.subscribe("/dnd/drop",q.hitch(this,"onDndDrop")),d.subscribe("/dnd/cancel",q.hitch(this,"onDndCancel"))]},checkAcceptance:function(a,b){if(this==a)return!this.copyOnly||
this.selfAccept;for(var c=0;c<b.length;++c){for(var d=a.getItem(b[c].id).type,e=!1,f=0;f<d.length;++f)if(d[f]in this.accept){e=!0;break}if(!e)return!1}return!0},copyState:function(a,c){if(a)return!0;2>arguments.length&&(c=this==b.manager().target);if(c){if(this.copyOnly)return this.selfCopy}else return this.copyOnly;return!1},destroy:function(){g.superclass.destroy.call(this);k.forEach(this.topics,function(a){a.remove()});this.targetAnchor=null},onMouseMove:function(a){if(!this.isDragging||"Disabled"!=
this.targetState){g.superclass.onMouseMove.call(this,a);var d=b.manager();if(!this.isDragging&&this.mouseDown&&this.isSource&&(Math.abs(a.pageX-this._lastX)>this.delay||Math.abs(a.pageY-this._lastY)>this.delay)){var e=this.getSelectedNodes();e.length&&d.startDrag(this,e,this.copyState(c.getCopyKeyState(a),!0))}this.isDragging&&(e=!1,this.current&&(this.targetBox&&this.targetAnchor==this.current||(this.targetBox=l.position(this.current,!0)),e=this.horizontal?a.pageX-this.targetBox.x<this.targetBox.w/
2==l.isBodyLtr(this.current.ownerDocument):a.pageY-this.targetBox.y<this.targetBox.h/2),this.current!=this.targetAnchor||e!=this.before)&&(this._markTargetAnchor(e),d.canDrop(!this.current||d.source!=this||!(this.current.id in this.selection)))}},onMouseDown:function(a){this.mouseDown||!this._legalMouseDown(a)||this.skipForm&&c.isFormElement(a)||(this.mouseDown=!0,this._lastX=a.pageX,this._lastY=a.pageY,g.superclass.onMouseDown.call(this,a))},onMouseUp:function(a){this.mouseDown&&(this.mouseDown=
!1,g.superclass.onMouseUp.call(this,a))},onDndSourceOver:function(a){this!==a?(this.mouseDown=!1,this.targetAnchor&&this._unmarkTargetAnchor()):this.isDragging&&(a=b.manager(),a.canDrop("Disabled"!=this.targetState&&(!this.current||a.source!=this||!(this.current.id in this.selection))))},onDndStart:function(a,c,d){this.autoSync&&this.sync();this.isSource&&this._changeState("Source",this==a?d?"Copied":"Moved":"");c=this.accept&&this.checkAcceptance(a,c);this._changeState("Target",c?"":"Disabled");
this==a&&b.manager().overSource(this);this.isDragging=!0},onDndDrop:function(a,b,c,d){if(this==d)this.onDrop(a,b,c);this.onDndCancel()},onDndCancel:function(){this.targetAnchor&&(this._unmarkTargetAnchor(),this.targetAnchor=null);this.before=!0;this.mouseDown=this.isDragging=!1;this._changeState("Source","");this._changeState("Target","")},onDrop:function(a,b,c){if(this!=a)this.onDropExternal(a,b,c);else this.onDropInternal(b,c)},onDropExternal:function(a,b,d){var e=this._normalizedCreator;this._normalizedCreator=
this.creator?function(b,c){return e.call(this,a.getItem(b.id).data,c)}:d?function(b){var d=a.getItem(b.id);b=b.cloneNode(!0);b.id=c.getUniqueId();return{node:b,data:d.data,type:d.type}}:function(b){var c=a.getItem(b.id);a.delItem(b.id);return{node:b,data:c.data,type:c.type}};this.selectNone();d||this.creator||a.selectNone();this.insertNodes(!0,b,this.before,this.current);!d&&this.creator&&a.deleteSelectedNodes();this._normalizedCreator=e},onDropInternal:function(a,b){var d=this._normalizedCreator;
if(!(this.current&&this.current.id in this.selection)){if(b)this._normalizedCreator=this.creator?function(a,b){return d.call(this,this.getItem(a.id).data,b)}:function(a){var b=this.getItem(a.id);a=a.cloneNode(!0);a.id=c.getUniqueId();return{node:a,data:b.data,type:b.type}};else{if(!this.current)return;this._normalizedCreator=function(a){var b=this.getItem(a.id);return{node:a,data:b.data,type:b.type}}}this._removeSelection();this.insertNodes(!0,a,this.before,this.current);this._normalizedCreator=d}},
onDraggingOver:function(){},onDraggingOut:function(){},onOverEvent:function(){g.superclass.onOverEvent.call(this);b.manager().overSource(this);if(this.isDragging&&"Disabled"!=this.targetState)this.onDraggingOver()},onOutEvent:function(){g.superclass.onOutEvent.call(this);b.manager().outSource(this);if(this.isDragging&&"Disabled"!=this.targetState)this.onDraggingOut()},_markTargetAnchor:function(a){if(this.current!=this.targetAnchor||this.before!=a)this.targetAnchor&&this._removeItemClass(this.targetAnchor,
this.before?"Before":"After"),this.targetAnchor=this.current,this.targetBox=null,this.before=a,this.targetAnchor&&this._addItemClass(this.targetAnchor,this.before?"Before":"After")},_unmarkTargetAnchor:function(){this.targetAnchor&&(this._removeItemClass(this.targetAnchor,this.before?"Before":"After"),this.targetBox=this.targetAnchor=null,this.before=!0)},_markDndStatus:function(a){this._changeState("Source",a?"Copied":"Moved")},_legalMouseDown:function(a){if("touchstart"!=a.type&&!h.isLeft(a))return!1;
if(!this.withHandles)return!0;for(a=a.target;a&&a!==this.node;a=a.parentNode){if(n.contains(a,"dojoDndHandle"))return!0;if(n.contains(a,"dojoDndItem")||n.contains(a,"dojoDndIgnore"))break}return!1}});return g})},"dojo/dnd/Selector":function(){define("../_base/array ../_base/declare ../_base/kernel ../_base/lang ../dom ../dom-construct ../mouse ../_base/NodeList ../on ../touch ./common ./Container".split(" "),function(k,e,p,q,n,l,h,f,d,c,a,b){var g=e("dojo.dnd.Selector",b,{constructor:function(a,b){b||
(b={});this.singular=b.singular;this.autoSync=b.autoSync;this.selection={};this.anchor=null;this.simpleSelection=!1;this.events.push(d(this.node,c.press,q.hitch(this,"onMouseDown")),d(this.node,c.release,q.hitch(this,"onMouseUp")))},singular:!1,getSelectedNodes:function(){var b=new f,c=a._empty,d;for(d in this.selection)d in c||b.push(n.byId(d));return b},selectNone:function(){return this._removeSelection()._removeAnchor()},selectAll:function(){this.forInItems(function(a,b){this._addItemClass(n.byId(b),
"Selected");this.selection[b]=1},this);return this._removeAnchor()},deleteSelectedNodes:function(){var b=a._empty,c;for(c in this.selection)if(!(c in b)){var d=n.byId(c);this.delItem(c);l.destroy(d)}this.anchor=null;this.selection={};return this},forInSelectedItems:function(b,c){c=c||p.global;var d=this.selection,e=a._empty,f;for(f in d)f in e||b.call(c,this.getItem(f),f,this)},sync:function(){g.superclass.sync.call(this);this.anchor&&!this.getItem(this.anchor.id)&&(this.anchor=null);var b=[],c=a._empty,
d;for(d in this.selection)d in c||this.getItem(d)||b.push(d);k.forEach(b,function(a){delete this.selection[a]},this);return this},insertNodes:function(a,b,c,d){var e=this._normalizedCreator;this._normalizedCreator=function(b,c){b=e.call(this,b,c);a?(this.anchor?this.anchor!=b.node&&(this._removeItemClass(b.node,"Anchor"),this._addItemClass(b.node,"Selected")):(this.anchor=b.node,this._removeItemClass(b.node,"Selected"),this._addItemClass(this.anchor,"Anchor")),this.selection[b.node.id]=1):(this._removeItemClass(b.node,
"Selected"),this._removeItemClass(b.node,"Anchor"));return b};g.superclass.insertNodes.call(this,b,c,d);this._normalizedCreator=e;return this},destroy:function(){g.superclass.destroy.call(this);this.selection=this.anchor=null},onMouseDown:function(b){this.autoSync&&this.sync();if(this.current)if(!this.singular&&!a.getCopyKeyState(b)&&!b.shiftKey&&this.current.id in this.selection)this.simpleSelection=!0,h.isLeft(b)&&(b.stopPropagation(),b.preventDefault());else{if(!this.singular&&b.shiftKey){a.getCopyKeyState(b)||
this._removeSelection();var c=this.getAllNodes();if(c.length&&(this.anchor||(this.anchor=c[0],this._addItemClass(this.anchor,"Anchor")),this.selection[this.anchor.id]=1,this.anchor!=this.current)){for(var d=0,e;d<c.length&&(e=c[d],e!=this.anchor&&e!=this.current);++d);for(++d;d<c.length;++d){e=c[d];if(e==this.anchor||e==this.current)break;this._addItemClass(e,"Selected");this.selection[e.id]=1}this._addItemClass(this.current,"Selected");this.selection[this.current.id]=1}}else this.singular?this.anchor==
this.current?a.getCopyKeyState(b)&&this.selectNone():(this.selectNone(),this.anchor=this.current,this._addItemClass(this.anchor,"Anchor"),this.selection[this.current.id]=1):a.getCopyKeyState(b)?this.anchor==this.current?(delete this.selection[this.anchor.id],this._removeAnchor()):this.current.id in this.selection?(this._removeItemClass(this.current,"Selected"),delete this.selection[this.current.id]):(this.anchor&&(this._removeItemClass(this.anchor,"Anchor"),this._addItemClass(this.anchor,"Selected")),
this.anchor=this.current,this._addItemClass(this.current,"Anchor"),this.selection[this.current.id]=1):this.current.id in this.selection||(this.selectNone(),this.anchor=this.current,this._addItemClass(this.current,"Anchor"),this.selection[this.current.id]=1);b.stopPropagation();b.preventDefault()}},onMouseUp:function(){this.simpleSelection&&(this.simpleSelection=!1,this.selectNone(),this.current&&(this.anchor=this.current,this._addItemClass(this.anchor,"Anchor"),this.selection[this.current.id]=1))},
onMouseMove:function(){this.simpleSelection=!1},onOverEvent:function(){this.onmousemoveEvent=d(this.node,c.move,q.hitch(this,"onMouseMove"))},onOutEvent:function(){this.onmousemoveEvent&&(this.onmousemoveEvent.remove(),delete this.onmousemoveEvent)},_removeSelection:function(){var b=a._empty,c;for(c in this.selection)if(!(c in b)){var d=n.byId(c);d&&this._removeItemClass(d,"Selected")}this.selection={};return this},_removeAnchor:function(){this.anchor&&(this._removeItemClass(this.anchor,"Anchor"),
this.anchor=null);return this}});return g})},"dojo/dnd/Container":function(){define("../_base/array ../_base/declare ../_base/kernel ../_base/lang ../_base/window ../dom ../dom-class ../dom-construct ../Evented ../has ../on ../query ../touch ./common".split(" "),function(k,e,p,q,n,l,h,f,d,c,a,b,g,u){e=e("dojo.dnd.Container",d,{skipForm:!1,allowNested:!1,constructor:function(b,c){this.node=l.byId(b);c||(c={});this.creator=c.creator||null;this.skipForm=c.skipForm;this.parent=c.dropParent&&l.byId(c.dropParent);
this.map={};this.current=null;this.containerState="";h.add(this.node,"dojoDndContainer");c&&c._skipStartup||this.startup();this.events=[a(this.node,g.over,q.hitch(this,"onMouseOver")),a(this.node,g.out,q.hitch(this,"onMouseOut")),a(this.node,"dragstart",q.hitch(this,"onSelectStart")),a(this.node,"selectstart",q.hitch(this,"onSelectStart"))]},creator:function(){},getItem:function(a){return this.map[a]},setItem:function(a,b){this.map[a]=b},delItem:function(a){delete this.map[a]},forInItems:function(a,
b){b=b||p.global;var c=this.map,d=u._empty,e;for(e in c)e in d||a.call(b,c[e],e,this);return b},clearItems:function(){this.map={}},getAllNodes:function(){return b((this.allowNested?"":"\x3e ")+".dojoDndItem",this.parent)},sync:function(){var a={};this.getAllNodes().forEach(function(b){if(b.id){var c=this.getItem(b.id);if(c){a[b.id]=c;return}}else b.id=u.getUniqueId();var c=b.getAttribute("dndType"),d=b.getAttribute("dndData");a[b.id]={data:d||b.innerHTML,type:c?c.split(/\s*,\s*/):["text"]}},this);
this.map=a;return this},insertNodes:function(a,b,c){this.parent.firstChild?b?c||(c=this.parent.firstChild):c&&(c=c.nextSibling):c=null;var d;if(c)for(b=0;b<a.length;++b)d=this._normalizedCreator(a[b]),this.setItem(d.node.id,{data:d.data,type:d.type}),c.parentNode.insertBefore(d.node,c);else for(b=0;b<a.length;++b)d=this._normalizedCreator(a[b]),this.setItem(d.node.id,{data:d.data,type:d.type}),this.parent.appendChild(d.node);return this},destroy:function(){k.forEach(this.events,function(a){a.remove()});
this.clearItems();this.node=this.parent=this.current=null},markupFactory:function(a,b,c){a._skipStartup=!0;return new c(b,a)},startup:function(){if(!this.parent&&(this.parent=this.node,"table"==this.parent.tagName.toLowerCase())){var a=this.parent.getElementsByTagName("tbody");a&&a.length&&(this.parent=a[0])}this.defaultCreator=u._defaultCreator(this.parent);this.sync()},onMouseOver:function(a){for(var b=a.relatedTarget;b&&b!=this.node;)try{b=b.parentNode}catch(t){b=null}b||(this._changeState("Container",
"Over"),this.onOverEvent());b=this._getChildByEvent(a);this.current!=b&&(this.current&&this._removeItemClass(this.current,"Over"),b&&this._addItemClass(b,"Over"),this.current=b)},onMouseOut:function(a){for(a=a.relatedTarget;a;){if(a==this.node)return;try{a=a.parentNode}catch(r){a=null}}this.current&&(this._removeItemClass(this.current,"Over"),this.current=null);this._changeState("Container","");this.onOutEvent()},onSelectStart:function(a){this.withHandles||this.skipForm&&u.isFormElement(a)||(a.stopPropagation(),
a.preventDefault())},onOverEvent:function(){},onOutEvent:function(){},_changeState:function(a,b){var c="dojoDnd"+a;a=a.toLowerCase()+"State";h.replace(this.node,c+b,c+this[a]);this[a]=b},_addItemClass:function(a,b){h.add(a,"dojoDndItem"+b)},_removeItemClass:function(a,b){h.remove(a,"dojoDndItem"+b)},_getChildByEvent:function(a){if(a=a.target)for(var b=a.parentNode;b;a=b,b=a.parentNode)if((b==this.parent||this.allowNested)&&h.contains(a,"dojoDndItem"))return a;return null},_normalizedCreator:function(a,
b){a=(this.creator||this.defaultCreator).call(this,a,b);q.isArray(a.type)||(a.type=["text"]);a.node.id||(a.node.id=u.getUniqueId());h.add(a.node,"dojoDndItem");return a}});u._createNode=function(a){return a?function(b){return f.create(a,{innerHTML:b})}:u._createSpan};u._createTrTd=function(a){var b=f.create("tr");f.create("td",{innerHTML:a},b);return b};u._createSpan=function(a){return f.create("span",{innerHTML:a})};u._defaultCreatorNodes={ul:"li",ol:"li",div:"div",p:"div"};u._defaultCreator=function(a){a=
a.tagName.toLowerCase();var b="tbody"==a||"thead"==a?u._createTrTd:u._createNode(u._defaultCreatorNodes[a]);return function(a,c){var d=a&&q.isObject(a),e;d&&a.tagName&&a.nodeType&&a.getAttribute?(e=a.getAttribute("dndData")||a.innerHTML,d=(d=a.getAttribute("dndType"))?d.split(/\s*,\s*/):["text"]):(e=d&&a.data?a.data:a,d=d&&a.type?a.type:["text"],a=("avatar"==c?u._createSpan:b)(String(e)));a.id||(a.id=u.getUniqueId());return{node:a,data:e,type:d}}};return e})},"dojo/dnd/Manager":function(){define("../_base/array ../_base/declare ../_base/lang ../_base/window ../dom-class ../Evented ../has ../keys ../on ../topic ../touch ./common ./autoscroll ./Avatar".split(" "),
function(k,e,p,q,n,l,h,f,d,c,a,b,g,u){var m=e("dojo.dnd.Manager",[l],{constructor:function(){this.source=this.avatar=null;this.nodes=[];this.copy=!0;this.target=null;this.canDropFlag=!1;this.events=[]},OFFSET_X:h("touch")?4:16,OFFSET_Y:h("touch")?4:16,overSource:function(a){this.avatar&&(this.target=a&&"Disabled"!=a.targetState?a:null,this.canDropFlag=!!this.target,this.avatar.update());c.publish("/dnd/source/over",a)},outSource:function(a){this.avatar?this.target==a&&(this.target=null,this.canDropFlag=
!1,this.avatar.update(),c.publish("/dnd/source/over",null)):c.publish("/dnd/source/over",null)},startDrag:function(b,e,f){function h(a){a.preventDefault();a.stopPropagation()}g.autoScrollStart(q.doc);this.source=b;this.nodes=e;this.copy=!!f;this.avatar=this.makeAvatar();q.body().appendChild(this.avatar.node);c.publish("/dnd/start",b,e,this.copy);this.events=[d(q.doc,a.move,p.hitch(this,"onMouseMove")),d(q.doc,a.release,p.hitch(this,"onMouseUp")),d(q.doc,"keydown",p.hitch(this,"onKeyDown")),d(q.doc,
"keyup",p.hitch(this,"onKeyUp")),d(q.doc,"dragstart",h),d(q.body(),"selectstart",h)];b="dojoDnd"+(f?"Copy":"Move");n.add(q.body(),b)},canDrop:function(a){a=!(!this.target||!a);this.canDropFlag!=a&&(this.canDropFlag=a,this.avatar.update())},stopDrag:function(){n.remove(q.body(),["dojoDndCopy","dojoDndMove"]);k.forEach(this.events,function(a){a.remove()});this.events=[];this.avatar.destroy();this.source=this.target=this.avatar=null;this.nodes=[]},makeAvatar:function(){return new u(this)},updateAvatar:function(){this.avatar.update()},
onMouseMove:function(a){var c=this.avatar;c&&(g.autoScrollNodes(a),c=c.node.style,c.left=a.pageX+this.OFFSET_X+"px",c.top=a.pageY+this.OFFSET_Y+"px",c=!!this.source.copyState(b.getCopyKeyState(a)),this.copy!=c&&this._setCopyStatus(c));h("touch")&&a.preventDefault()},onMouseUp:function(a){if(this.avatar){if(this.target&&this.canDropFlag){var d=!!this.source.copyState(b.getCopyKeyState(a));c.publish("/dnd/drop/before",this.source,this.nodes,d,this.target,a);c.publish("/dnd/drop",this.source,this.nodes,
d,this.target,a)}else c.publish("/dnd/cancel");this.stopDrag()}},onKeyDown:function(a){if(this.avatar)switch(a.keyCode){case f.CTRL:a=!!this.source.copyState(!0);this.copy!=a&&this._setCopyStatus(a);break;case f.ESCAPE:c.publish("/dnd/cancel"),this.stopDrag()}},onKeyUp:function(a){this.avatar&&a.keyCode==f.CTRL&&(a=!!this.source.copyState(!1),this.copy!=a&&this._setCopyStatus(a))},_setCopyStatus:function(a){this.copy=a;this.source._markDndStatus(this.copy);this.updateAvatar();n.replace(q.body(),"dojoDnd"+
(this.copy?"Copy":"Move"),"dojoDnd"+(this.copy?"Move":"Copy"))}});b._manager=null;m.manager=b.manager=function(){b._manager||(b._manager=new m);return b._manager};return m})},"dojo/dnd/Avatar":function(){define("../_base/declare ../_base/window ../dom ../dom-attr ../dom-class ../dom-construct ../hccss ../query".split(" "),function(k,e,p,q,n,l,h,f){return k("dojo.dnd.Avatar",null,{constructor:function(d){this.manager=d;this.construct()},construct:function(){var d=l.create("table",{"class":"dojoDndAvatar",
style:{position:"absolute",zIndex:"1999",margin:"0px"}}),c=this.manager.source,a,b=l.create("tbody",null,d),e=l.create("tr",null,b),f=l.create("td",null,e),k=Math.min(5,this.manager.nodes.length),n=0;h("highcontrast")&&l.create("span",{id:"a11yIcon",innerHTML:this.manager.copy?"+":"\x3c"},f);l.create("span",{innerHTML:c.generateText?this._generateText():""},f);for(q.set(e,{"class":"dojoDndAvatarHeader",style:{opacity:.9}});n<k;++n)c.creator?a=c._normalizedCreator(c.getItem(this.manager.nodes[n].id).data,
"avatar").node:(a=this.manager.nodes[n].cloneNode(!0),"tr"==a.tagName.toLowerCase()&&(e=l.create("table"),l.create("tbody",null,e).appendChild(a),a=e)),a.id="",e=l.create("tr",null,b),f=l.create("td",null,e),f.appendChild(a),q.set(e,{"class":"dojoDndAvatarItem",style:{opacity:(9-n)/10}});this.node=d},destroy:function(){l.destroy(this.node);this.node=!1},update:function(){n.toggle(this.node,"dojoDndAvatarCanDrop",this.manager.canDropFlag);if(h("highcontrast")){var d=p.byId("a11yIcon"),c="+";this.manager.canDropFlag&&
!this.manager.copy?c="\x3c ":this.manager.canDropFlag||this.manager.copy?this.manager.canDropFlag||(c="x"):c="o";d.innerHTML=c}f("tr.dojoDndAvatarHeader td span"+(h("highcontrast")?" span":""),this.node).forEach(function(a){a.innerHTML=this.manager.source.generateText?this._generateText():""},this)},_generateText:function(){return this.manager.nodes.length.toString()}})})},"builder/dijit/RefreshInterval":function(){define("dojo/on dojo/Evented dojo/_base/html dojo/_base/lang dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/RefreshInterval.html jimu/utils dijit/form/Select dijit/form/NumberTextBox".split(" "),
function(k,e,p,q,n,l,h,f,d,c){return n([l,h,f,e],{templateString:d,baseClass:"refresh-interval",handle1:null,handle2:null,lastRefreshInterval:null,defaultRefreshInterval:{useWebMapRefreshInterval:!0},defaultRefreshTip:"",singleRefreshTip:"",postMixInProperties:function(){this.nls=window.builderNls;this.defaultRefreshTip||(this.defaultRefreshTip=this.nls.defaultRefreshTip);this.singleRefreshTip||(this.singleRefreshTip=this.nls.singleRefreshTip)},postCreate:function(){this.inherited(arguments);this.refreshSelect.dropDown&&
this.refreshSelect.dropDown.domNode&&p.addClass(this.refreshSelect.dropDown.domNode,"refresh-interval-select-dropdown");this.lastRefreshInterval=this.defaultRefreshInterval;this._bindEvents()},getValue:function(){var a=null;"defaultRefresh"===this.refreshSelect.get("value")?(a={useWebMapRefreshInterval:!0},p.addClass(this.refreshIntervalInputs,"hidden")):(p.removeClass(this.refreshIntervalInputs,"hidden"),a=this.refreshIntervalNTB.get("value"),a=0<=a&&this.refreshIntervalNTB.validate()?{useWebMapRefreshInterval:!1,
minutes:a}:null);return a},setValue:function(a){a||(a=this.defaultRefreshInterval);this.lastRefreshInterval=a;this._releaseEvents();a.useWebMapRefreshInterval?this.refreshSelect.set("value","defaultRefresh"):(this.refreshSelect.set("value","singleRefresh"),this.refreshIntervalNTB.set("value",a.minutes));this._bindEvents()},reset:function(){this.setValue(this.defaultRefreshInterval)},_releaseEvents:function(){this.handle1&&this.handle1.remove();this.handle2&&this.handle2.remove();this.handle2=this.handle1=
null},_bindEvents:function(){this._releaseEvents();this.handle1=k(this.refreshSelect,"change",q.hitch(this,this._onChanged));this.handle2=k(this.refreshIntervalNTB,"change",q.hitch(this,this._onChanged))},_onChanged:function(){var a=this.getValue();a&&!c.isEqual(a,this.lastRefreshInterval)&&(this.lastRefreshInterval=a,this.emit("user-input-change",a))},destroy:function(){this._releaseEvents();this.inherited(arguments)}})})},"dojo/NodeList-data":function(){define(["./_base/kernel","./query","./_base/lang",
"./_base/array","./dom-attr"],function(k,e,p,q,n){var l=e.NodeList,h={},f=0,d=function(a){var b=n.get(a,"data-dojo-dataid");b||(b="pid"+f++,n.set(a,"data-dojo-dataid",b));return b},c=k._nodeData=function(a,c,e){var b=d(a),f;h[b]||(h[b]={});if(1==arguments.length)return h[b];"string"==typeof c?2<arguments.length?h[b][c]=e:f=h[b][c]:f=p.mixin(h[b],c);return f},a=k._removeNodeData=function(a,c){a=d(a);h[a]&&(c?delete h[a][c]:delete h[a])};l._gcNodeData=k._gcNodeData=function(){var a=e("[data-dojo-dataid]").map(d),
c;for(c in h)0>q.indexOf(a,c)&&delete h[c]};p.extend(l,{data:l._adaptWithCondition(c,function(a){return 0===a.length||1==a.length&&"string"==typeof a[0]}),removeData:l._adaptAsForEach(a)});return l})},"jimu/dijit/ColorPicker":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dojo/_base/lang dojo/_base/html dojo/on dojo/_base/Color dijit/TooltipDialog dijit/popup dojox/widget/ColorPicker jimu/utils".split(" "),function(k,e,p,q,n,l,h,f,d,c,a){return k([e,p],{baseClass:"jimu-color-picker",
declaredClass:"jimu.dijit.ColorPicker",templateString:"\x3cdiv\x3e\x3c/div\x3e",_isTooltipDialogOpened:!1,color:null,showHex:!0,showHsv:!0,showRgb:!0,ensureMode:!1,showLabel:!1,postMixInProperties:function(){this.nls=window.jimuNls.common},postCreate:function(){this.inherited(arguments);this.color?this.color instanceof h||(this.color=new h(this.color)):this.color=new h("#ccc");n.setStyle(this.domNode,"backgroundColor",this.color.toHex());this.showLabel&&this._changeLabel(this.color);this._createTooltipDialog(this.domNode);
this._hideTooltipDialog()},destroy:function(){d.close(this.tooltipDialog);this.picker.destroy();this.tooltipDialog.destroy();this.inherited(arguments)},isPartOfPopup:function(a){var b=this.tooltipDialog.domNode;return a===b||n.isDescendant(a,b)},hideTooltipDialog:function(){this._hideTooltipDialog()},_showTooltipDialog:function(){d.open({parent:this.getParent(),popup:this.tooltipDialog,around:this.domNode});this._isTooltipDialogOpened=!0},_hideTooltipDialog:function(){this._isTooltipDialogOpened=
!1;this.onClose();d.close(this.tooltipDialog)},_createTooltipDialog:function(){var a=n.create("div");this.tooltipDialog=new f({content:a});n.addClass(this.tooltipDialog.domNode,"jimu-color-picker-dialog");var d=new c({showHex:this.showHex,showRgb:this.showRgb,showHsv:this.showHsv,value:this.color.toHex(),onChange:q.hitch(this,function(a){this.ensureMode||(a=new h(a),this.setColor(a))})});d.placeAt(a);d.startup();if(this.ensureMode){var e=n.create("div",{"class":"jimu-btn jimu-btn-vacation jimu-float-trailing",
title:this.nls.cancel,innerHTML:this.nls.cancel},a);this.own(l(e,"click",q.hitch(this,function(){this._hideTooltipDialog()})));"undefined"===typeof this.showOk&&(e=n.create("div",{"class":"jimu-btn jimu-float-trailing ok",title:this.nls.ok,innerHTML:this.nls.ok},a),this.own(l(e,"click",q.hitch(this,function(){var a=this.picker.get("value");this.setColor(new h(a));this._hideTooltipDialog()}))));a=n.create("div",{"class":"jimu-btn jimu-float-trailing",title:this.nls.apply,innerHTML:this.nls.apply},
a);this.own(l(a,"click",q.hitch(this,function(){var a=this.picker.get("value");this.setColor(new h(a))})))}this.own(l(this.domNode,"click",q.hitch(this,function(a){a.stopPropagation();a.preventDefault();this._isTooltipDialogOpened?this._hideTooltipDialog():this._showTooltipDialog()})));this.own(l(document.body,"click",q.hitch(this,function(a){this.isPartOfPopup(a.target||a.srcElement)||this._hideTooltipDialog()})));this.picker=d},setColor:function(a,c){if(a instanceof h){var b=this.color,d="";b&&
(d=b.toHex());b=a.toHex();this.color=a;n.setStyle(this.domNode,"backgroundColor",b);if(d!==b&&(this.picker.set("value",b),!1!==c))this.onChange(new h(b))}},getColor:function(){return this.color},_changeLabel:function(b){n.empty(this.domNode);n.create("span",{innerHTML:b.toHex(),className:"color-label",style:{color:a.invertColor(b.toHex())}},this.domNode)},onChange:function(a){this.showLabel&&this._changeLabel(a)},onClose:function(){},getPopup:function(){return this.tooltipDialog||null},setLabel:function(a){n.empty(this.domNode);
n.create("span",{innerHTML:a||"",className:"text-label"},this.domNode)},isTooltipDialogOpened:function(){return this._isTooltipDialogOpened}})})},"dojox/widget/ColorPicker":function(){define("dojo/_base/kernel dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/html dojo/_base/connect dojo/_base/sniff dojo/_base/window dojo/_base/event dojo/dom dojo/dom-class dojo/keys dojo/fx dojo/dnd/move dijit/registry dijit/_base/focus dijit/form/_FormWidget dijit/typematic dojox/color dojo/i18n dojo/i18n!./nls/ColorPicker dojo/i18n!dojo/cldr/nls/number dojo/text!./ColorPicker/ColorPicker.html".split(" "),
function(k,e,p,q,n,l,h,f,d,c,a,b,g,u,m,r,t,v,y,w,z,x,A){k.experimental("dojox.widget.ColorPicker");return e("dojox.widget.ColorPicker",t,{showRgb:!0,showHsv:!0,showHex:!0,webSafe:!0,animatePoint:!0,slideDuration:250,liveUpdate:!1,PICKER_HUE_H:150,PICKER_SAT_VAL_H:150,PICKER_SAT_VAL_W:150,PICKER_HUE_SELECTOR_H:8,PICKER_SAT_SELECTOR_H:10,PICKER_SAT_SELECTOR_W:10,value:"#ffffff",_underlay:require.toUrl("dojox/widget/ColorPicker/images/underlay.png"),_hueUnderlay:require.toUrl("dojox/widget/ColorPicker/images/hue.png"),
_pickerPointer:require.toUrl("dojox/widget/ColorPicker/images/pickerPointer.png"),_huePickerPointer:require.toUrl("dojox/widget/ColorPicker/images/hueHandle.png"),_huePickerPointerAlly:require.toUrl("dojox/widget/ColorPicker/images/hueHandleA11y.png"),templateString:A,postMixInProperties:function(){a.contains(f.body(),"dijit_a11y")&&(this._huePickerPointer=this._huePickerPointerAlly);this._uId=m.getUniqueId(this.id);p.mixin(this,w.getLocalization("dojox.widget","ColorPicker"));p.mixin(this,w.getLocalization("dojo.cldr",
"number"));this.inherited(arguments)},postCreate:function(){this.inherited(arguments);7>h("ie")&&(this.colorUnderlay.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src\x3d'"+this._underlay+"', sizingMethod\x3d'scale')",this.colorUnderlay.src=this._blankGif.toString());this.showRgb||(this.rgbNode.style.visibility="hidden");this.showHsv||(this.hsvNode.style.visibility="hidden");this.showHex||(this.hexNode.style.visibility="hidden");this.webSafe||(this.safePreviewNode.style.visibility=
"hidden")},startup:function(){this._started||(this._started=!0,this.set("value",this.value),this._mover=new u.boxConstrainedMoveable(this.cursorNode,{box:{t:-(this.PICKER_SAT_SELECTOR_H/2),l:-(this.PICKER_SAT_SELECTOR_W/2),w:this.PICKER_SAT_VAL_W,h:this.PICKER_SAT_VAL_H}}),this._hueMover=new u.boxConstrainedMoveable(this.hueCursorNode,{box:{t:-(this.PICKER_HUE_SELECTOR_H/2),l:0,w:0,h:this.PICKER_HUE_H}}),this._subs=[],this._subs.push(l.subscribe("/dnd/move/stop",p.hitch(this,"_clearTimer"))),this._subs.push(l.subscribe("/dnd/move/start",
p.hitch(this,"_setTimer"))),this._keyListeners=[],this._connects.push(v.addKeyListener(this.hueCursorNode,{charOrCode:b.UP_ARROW,shiftKey:!1,metaKey:!1,ctrlKey:!1,altKey:!1},this,p.hitch(this,this._updateHueCursorNode),25,25)),this._connects.push(v.addKeyListener(this.hueCursorNode,{charOrCode:b.DOWN_ARROW,shiftKey:!1,metaKey:!1,ctrlKey:!1,altKey:!1},this,p.hitch(this,this._updateHueCursorNode),25,25)),this._connects.push(v.addKeyListener(this.cursorNode,{charOrCode:b.UP_ARROW,shiftKey:!1,metaKey:!1,
ctrlKey:!1,altKey:!1},this,p.hitch(this,this._updateCursorNode),25,25)),this._connects.push(v.addKeyListener(this.cursorNode,{charOrCode:b.DOWN_ARROW,shiftKey:!1,metaKey:!1,ctrlKey:!1,altKey:!1},this,p.hitch(this,this._updateCursorNode),25,25)),this._connects.push(v.addKeyListener(this.cursorNode,{charOrCode:b.LEFT_ARROW,shiftKey:!1,metaKey:!1,ctrlKey:!1,altKey:!1},this,p.hitch(this,this._updateCursorNode),25,25)),this._connects.push(v.addKeyListener(this.cursorNode,{charOrCode:b.RIGHT_ARROW,shiftKey:!1,
metaKey:!1,ctrlKey:!1,altKey:!1},this,p.hitch(this,this._updateCursorNode),25,25)))},_setValueAttr:function(a,b){this._started&&this.setColor(a,b)},setColor:function(a,b){a=y.fromString(a);this._updatePickerLocations(a);this._updateColorInputs(a);this._updateValue(a,b)},_setTimer:function(a){if(a.node==this.cursorNode||a.node==this.hueCursorNode)r.focus(a.node),c.setSelectable(this.domNode,!1),this._timer=setInterval(p.hitch(this,"_updateColor"),45)},_clearTimer:function(a){this._timer&&(clearInterval(this._timer),
this._timer=null,this.onChange(this.value),c.setSelectable(this.domNode,!0))},_setHue:function(a){n.style(this.colorUnderlay,"backgroundColor",y.fromHsv(a,100,100).toHex())},_updateHueCursorNode:function(a,c,d){if(-1!==a){a=n.style(this.hueCursorNode,"top");c=this.PICKER_HUE_SELECTOR_H/2;a+=c;var e=!1;d.charOrCode==b.UP_ARROW?0<a&&(--a,e=!0):d.charOrCode==b.DOWN_ARROW&&a<this.PICKER_HUE_H&&(a+=1,e=!0);e&&n.style(this.hueCursorNode,"top",a-c+"px")}else this._updateColor(!0)},_updateCursorNode:function(a,
c,d){c=this.PICKER_SAT_SELECTOR_H/2;var e=this.PICKER_SAT_SELECTOR_W/2;if(-1!==a){a=n.style(this.cursorNode,"top");var f=n.style(this.cursorNode,"left");a+=c;var f=f+e,g=!1;d.charOrCode==b.UP_ARROW?0<a&&(--a,g=!0):d.charOrCode==b.DOWN_ARROW?a<this.PICKER_SAT_VAL_H&&(a+=1,g=!0):d.charOrCode==b.LEFT_ARROW?0<f&&(--f,g=!0):d.charOrCode==b.RIGHT_ARROW&&f<this.PICKER_SAT_VAL_W&&(f+=1,g=!0);g&&(f-=e,n.style(this.cursorNode,"top",a-c+"px"),n.style(this.cursorNode,"left",f+"px"))}else this._updateColor(!0)},
_updateColor:function(a){var b=this.PICKER_HUE_SELECTOR_H/2,c=this.PICKER_SAT_SELECTOR_H/2,d=this.PICKER_SAT_SELECTOR_W/2,b=n.style(this.hueCursorNode,"top")+b,c=n.style(this.cursorNode,"top")+c,d=n.style(this.cursorNode,"left")+d,b=Math.round(360-b/this.PICKER_HUE_H*360),d=y.fromHsv(b,d/this.PICKER_SAT_VAL_W*100,100-c/this.PICKER_SAT_VAL_H*100);this._updateColorInputs(d);this._updateValue(d,a);b!=this._hue&&this._setHue(b)},_colorInputChange:function(a){var b,c=!1;switch(a.target){case this.hexCode:b=
y.fromString(a.target.value);c=!0;break;case this.Rval:case this.Gval:case this.Bval:b=y.fromArray([this.Rval.value,this.Gval.value,this.Bval.value]);c=!0;break;case this.Hval:case this.Sval:case this.Vval:b=y.fromHsv(this.Hval.value,this.Sval.value,this.Vval.value),c=!0}c&&(this._updatePickerLocations(b),this._updateColorInputs(b),this._updateValue(b,!0))},_updateValue:function(a,b){a=a.toHex();this.value=this.valueNode.value=a;if(b&&(!this._timer||this.liveUpdate))this.onChange(a)},_updatePickerLocations:function(a){var b=
this.PICKER_HUE_SELECTOR_H/2,c=this.PICKER_SAT_SELECTOR_H/2,d=this.PICKER_SAT_SELECTOR_W/2;a=a.toHsv();b=Math.round(this.PICKER_HUE_H-a.h/360*this.PICKER_HUE_H)-b;d=Math.round(a.s/100*this.PICKER_SAT_VAL_W)-d;c=Math.round(this.PICKER_SAT_VAL_H-a.v/100*this.PICKER_SAT_VAL_H)-c;this.animatePoint?(g.slideTo({node:this.hueCursorNode,duration:this.slideDuration,top:b,left:0}).play(),g.slideTo({node:this.cursorNode,duration:this.slideDuration,top:c,left:d}).play()):(n.style(this.hueCursorNode,"top",b+"px"),
n.style(this.cursorNode,{left:d+"px",top:c+"px"}));a.h!=this._hue&&this._setHue(a.h)},_updateColorInputs:function(a){var b=a.toHex();this.showRgb&&(this.Rval.value=a.r,this.Gval.value=a.g,this.Bval.value=a.b);this.showHsv&&(a=a.toHsv(),this.Hval.value=Math.round(a.h),this.Sval.value=Math.round(a.s),this.Vval.value=Math.round(a.v));this.showHex&&(this.hexCode.value=b);this.previewNode.style.backgroundColor=b;this.webSafe&&(this.safePreviewNode.style.backgroundColor=b)},_setHuePoint:function(a){var b=
this.PICKER_HUE_SELECTOR_H/2;a=a.layerY||a.y-a.target.getBoundingClientRect().top;a-=b;this.animatePoint?g.slideTo({node:this.hueCursorNode,duration:this.slideDuration,top:a,left:0,onEnd:p.hitch(this,function(){this._updateColor(!0);r.focus(this.hueCursorNode)})}).play():(n.style(this.hueCursorNode,"top",a+"px"),this._updateColor(!0))},_setPoint:function(a){var b=this.PICKER_SAT_SELECTOR_H/2,c=this.PICKER_SAT_SELECTOR_W/2,d=a.layerY||a.y-a.target.getBoundingClientRect().top,d=d-b,b=a.layerX||a.x-
a.target.getBoundingClientRect().left,b=b-c;a&&r.focus(a.target);this.animatePoint?g.slideTo({node:this.cursorNode,duration:this.slideDuration,top:d,left:b,onEnd:p.hitch(this,function(){this._updateColor(!0);r.focus(this.cursorNode)})}).play():(n.style(this.cursorNode,{left:b+"px",top:d+"px"}),this._updateColor(!0))},_handleKey:function(a){},focus:function(){this.focused||r.focus(this.focusNode)},_stopDrag:function(a){d.stop(a)},destroy:function(){this.inherited(arguments);q.forEach(this._subs,function(a){l.unsubscribe(a)});
delete this._subs}})})},"dojox/color":function(){define(["./color/_base"],function(k){return k})},"dojox/color/_base":function(){define(["../main","dojo/_base/lang","dojo/_base/Color","dojo/colors"],function(k,e,p,q){k=e.getObject("color",!0,k);k.Color=p;k.blend=p.blendColors;k.fromRgb=p.fromRgb;k.fromHex=p.fromHex;k.fromArray=p.fromArray;k.fromString=p.fromString;k.greyscale=q.makeGrey;e.mixin(k,{fromCmy:function(k,l,h){e.isArray(k)?(l=k[1],h=k[2],k=k[0]):e.isObject(k)&&(l=k.m,h=k.y,k=k.c);return new p({r:Math.round(255*
(1-k/100)),g:Math.round(255*(1-l/100)),b:Math.round(255*(1-h/100))})},fromCmyk:function(k,l,h,f){e.isArray(k)?(l=k[1],h=k[2],f=k[3],k=k[0]):e.isObject(k)&&(l=k.m,h=k.y,f=k.b,k=k.c);f/=100;return new p({r:Math.round(255*(1-Math.min(1,k/100*(1-f)+f))),g:Math.round(255*(1-Math.min(1,l/100*(1-f)+f))),b:Math.round(255*(1-Math.min(1,h/100*(1-f)+f)))})},fromHsl:function(k,l,h){e.isArray(k)?(l=k[1],h=k[2],k=k[0]):e.isObject(k)&&(l=k.s,h=k.l,k=k.h);l/=100;for(h/=100;0>k;)k+=360;for(;360<=k;)k-=360;var f,d;
120>k?(f=(120-k)/60,d=k/60,k=0):240>k?(f=0,d=(240-k)/60,k=(k-120)/60):(f=(k-240)/60,d=0,k=(360-k)/60);f=2*l*Math.min(f,1)+(1-l);d=2*l*Math.min(d,1)+(1-l);k=2*l*Math.min(k,1)+(1-l);.5>h?(f*=h,d*=h,k*=h):(f=(1-h)*f+2*h-1,d=(1-h)*d+2*h-1,k=(1-h)*k+2*h-1);return new p({r:Math.round(255*f),g:Math.round(255*d),b:Math.round(255*k)})}});k.fromHsv=function(k,l,h){e.isArray(k)?(l=k[1],h=k[2],k=k[0]):e.isObject(k)&&(l=k.s,h=k.v,k=k.h);360==k&&(k=0);l/=100;h/=100;var f,d,c;if(0==l)d=c=f=h;else{var a=k/60;k=Math.floor(a);
var b=a-k,a=h*(1-l),g=h*(1-l*b);l=h*(1-l*(1-b));switch(k){case 0:f=h;d=l;c=a;break;case 1:f=g;d=h;c=a;break;case 2:f=a;d=h;c=l;break;case 3:f=a;d=g;c=h;break;case 4:f=l;d=a;c=h;break;case 5:f=h,d=a,c=g}}return new p({r:Math.round(255*f),g:Math.round(255*d),b:Math.round(255*c)})};e.extend(p,{toCmy:function(){return{c:Math.round(100*(1-this.r/255)),m:Math.round(100*(1-this.g/255)),y:Math.round(100*(1-this.b/255))}},toCmyk:function(){var e,k=this.r/255,h=this.g/255,f=this.b/255;e=Math.min(1-k,1-h,1-
f);return{c:Math.round((1-k-e)/(1-e)*100),m:Math.round((1-h-e)/(1-e)*100),y:Math.round((1-f-e)/(1-e)*100),b:Math.round(100*e)}},toHsl:function(){var e=this.r/255,k=this.g/255,h=this.b/255,f=Math.min(e,h,k),d=Math.max(e,k,h),c=d-f,a=0,b=0,f=(f+d)/2;0<f&&1>f&&(b=c/(.5>f?2*f:2-2*f));0<c&&(d==e&&d!=k&&(a+=(k-h)/c),d==k&&d!=h&&(a+=2+(h-e)/c),d==h&&d!=e&&(a+=4+(e-k)/c),a*=60);return{h:a,s:Math.round(100*b),l:Math.round(100*f)}},toHsv:function(){var e=this.r/255,k=this.g/255,h=this.b/255,f=Math.max(e,k,
h),d=f-Math.min(e,h,k),c=null,a=0==f?0:d/f;0==a?c=0:(c=e==f?60*(k-h)/d:k==f?120+60*(h-e)/d:240+60*(e-k)/d,0>c&&(c+=360));return{h:c,s:Math.round(100*a),v:Math.round(100*f)}}});return k})},"dijit/_editor/plugins/FontChoice":function(){define("require dojo/_base/array dojo/_base/declare dojo/dom-construct dojo/i18n dojo/_base/lang dojo/store/Memory ../../registry ../../_Widget ../../_TemplatedMixin ../../_WidgetsInTemplateMixin ../../form/FilteringSelect ../_Plugin ../range dojo/i18n!../nls/FontChoice".split(" "),
function(k,e,p,q,n,l,h,f,d,c,a,b,g,u){k=p("dijit._editor.plugins._FontDropDown",[d,c,a],{label:"",plainText:!1,templateString:"\x3cspan style\x3d'white-space: nowrap' class\x3d'dijit dijitReset dijitInline'\x3e\x3clabel class\x3d'dijitLeft dijitInline' for\x3d'${selectId}'\x3e${label}\x3c/label\x3e\x3cinput data-dojo-type\x3d'../../form/FilteringSelect' required\x3d'false' data-dojo-props\x3d'labelType:\"html\", labelAttr:\"label\", searchAttr:\"name\"' class\x3d'${comboClass}' tabIndex\x3d'-1' id\x3d'${selectId}' data-dojo-attach-point\x3d'select' value\x3d''/\x3e\x3c/span\x3e",
contextRequire:k,postMixInProperties:function(){this.inherited(arguments);this.strings=n.getLocalization("dijit._editor","FontChoice");this.label=this.strings[this.command];this.id=f.getUniqueId(this.declaredClass.replace(/\./g,"_"));this.selectId=this.id+"_select";this.inherited(arguments)},postCreate:function(){this.select.set("store",new h({idProperty:"value",data:e.map(this.values,function(a){var b=this.strings[a]||a;return{label:this.getLabel(a,b),name:b,value:a}},this)}));this.select.set("value",
"",!1);this.disabled=this.select.get("disabled")},_setValueAttr:function(a,b){b=!1!==b;this.select.set("value",0>e.indexOf(this.values,a)?"":a,b);b||(this.select._lastValueReported=null)},_getValueAttr:function(){return this.select.get("value")},focus:function(){this.select.focus()},_setDisabledAttr:function(a){this._set("disabled",a);this.select.set("disabled",a)}});var m=p("dijit._editor.plugins._FontNameDropDown",k,{generic:!1,command:"fontName",comboClass:"dijitFontNameCombo",postMixInProperties:function(){this.values||
(this.values=this.generic?["serif","sans-serif","monospace","cursive","fantasy"]:["Arial","Times New Roman","Comic Sans MS","Courier New"]);this.inherited(arguments)},getLabel:function(a,b){return this.plainText?b:"\x3cdiv style\x3d'font-family: "+a+"'\x3e"+b+"\x3c/div\x3e"},_setValueAttr:function(a,b){this.generic&&(a={Arial:"sans-serif",Helvetica:"sans-serif",Myriad:"sans-serif",Times:"serif","Times New Roman":"serif","Comic Sans MS":"cursive","Apple Chancery":"cursive",Courier:"monospace","Courier New":"monospace",
Papyrus:"fantasy","Estrangelo Edessa":"cursive",Gabriola:"fantasy"}[a]||a);this.inherited(arguments,[a,!1!==b])}}),r=p("dijit._editor.plugins._FontSizeDropDown",k,{command:"fontSize",comboClass:"dijitFontSizeCombo",values:[1,2,3,4,5,6,7],getLabel:function(a,b){return this.plainText?b:"\x3cfont size\x3d"+a+"'\x3e"+b+"\x3c/font\x3e"},_setValueAttr:function(a,b){b=!1!==b;a.indexOf&&-1!=a.indexOf("px")&&(a={10:1,13:2,16:3,18:4,24:5,32:6,48:7}[parseInt(a,10)]||a);this.inherited(arguments,[a,b])}}),t=p("dijit._editor.plugins._FormatBlockDropDown",
k,{command:"formatBlock",comboClass:"dijitFormatBlockCombo",values:"noFormat p h1 h2 h3 pre".split(" "),postCreate:function(){this.inherited(arguments);this.set("value","noFormat",!1)},getLabel:function(a,b){return this.plainText||"noFormat"==a?b:"\x3c"+a+"\x3e"+b+"\x3c/"+a+"\x3e"},_execCommand:function(a,b,c){if("noFormat"===c){var d;if((b=u.getSelection(a.window))&&0<b.rangeCount){c=b.getRangeAt(0);var f;if(c){b=c.startContainer;for(d=c.endContainer;b&&b!==a.editNode&&b!==a.document.body&&1!==b.nodeType;)b=
b.parentNode;for(;d&&d!==a.editNode&&d!==a.document.body&&1!==d.nodeType;)d=d.parentNode;var g=l.hitch(this,function(b,c){if(b.childNodes&&b.childNodes.length){var d;for(d=0;d<b.childNodes.length;d++){var f=b.childNodes[d];if(1==f.nodeType&&a.selection.inSelection(f)){var h=f.tagName?f.tagName.toLowerCase():"";-1!==e.indexOf(this.values,h)&&c.push(f);g(f,c)}}}});c=l.hitch(this,function(b){if(b&&b.length){for(a.beginEditing();b.length;)this._removeFormat(a,b.pop());a.endEditing()}});var h=[];if(b==
d){var k;for(d=b;d&&d!==a.editNode&&d!==a.document.body;){if(1==d.nodeType&&(f=d.tagName?d.tagName.toLowerCase():"",-1!==e.indexOf(this.values,f))){k=d;break}d=d.parentNode}g(b,h);k&&(h=[k].concat(h))}else for(d=b;a.selection.inSelection(d);)1==d.nodeType&&(f=d.tagName?d.tagName.toLowerCase():"",-1!==e.indexOf(this.values,f)&&h.push(d),g(d,h)),d=d.nextSibling;c(h);a.onDisplayChanged()}}}else a.execCommand(b,c)},_removeFormat:function(a,b){if(a.customUndo){for(;b.firstChild;)q.place(b.firstChild,b,
"before");b.parentNode.removeChild(b)}else{a.selection.selectElementChildren(b);var c=a.selection.getSelectedHtml();a.selection.selectElement(b);a.execCommand("inserthtml",c||"")}}}),v=p("dijit._editor.plugins.FontChoice",g,{useDefaultCommand:!1,_initButton:function(){var a={fontName:m,fontSize:r,formatBlock:t}[this.command],b=this.params;this.params.custom&&(b.values=this.params.custom);var c=this.editor;this.button=new a(l.delegate({dir:c.dir,lang:c.lang},b));this.own(this.button.select.on("change",
l.hitch(this,function(a){this.editor.focused&&this.editor.focus();"fontName"==this.command&&-1!=a.indexOf(" ")&&(a="'"+a+"'");this.button._execCommand?this.button._execCommand(this.editor,this.command,a):this.editor.execCommand(this.command,a)})))},updateState:function(){var a=this.editor,b=this.command;if(a&&a.isLoaded&&b.length&&this.button){var c=this.get("disabled");this.button.set("disabled",c);if(!c){var d;try{d=a.queryCommandValue(b)||""}catch(C){d=""}(c=l.isString(d)&&(d.match(/'([^']*)'/)||
d.match(/"([^"]*)"/)))&&(d=c[1]);if("formatBlock"===b)if(d&&"p"!=d)0>e.indexOf(this.button.values,d)&&(d="noFormat");else{d=null;var f;(b=u.getSelection(this.editor.window))&&0<b.rangeCount&&(b=b.getRangeAt(0))&&(f=b.endContainer);for(;f&&f!==a.editNode&&f!==a.document;){if((b=f.tagName?f.tagName.toLowerCase():"")&&-1<e.indexOf(this.button.values,b)){d=b;break}f=f.parentNode}d||(d="noFormat")}d!==this.button.get("value")&&this.button.set("value",d,!1)}}}});e.forEach(["fontName","fontSize","formatBlock"],
function(a){g.registry[a]=function(b){return new v({command:a,plainText:b.plainText})}});v._FontDropDown=k;v._FontNameDropDown=m;v._FontSizeDropDown=r;v._FormatBlockDropDown=t;return v})},"jimu/dijit/EditorTextColor":function(){define("require dojo dijit dojo/_base/declare dijit/_editor/_Plugin dijit/form/DropDownButton".split(" "),function(k,e,p,q,n,l){e.experimental("dijit.editor.plugins.EditorTextColor");var h=q("dijit.editor.plugins.EditorTextColor",n,{buttonClass:l,colorPicker:"jimu/dijit/ColorPalette",
useDefaultCommand:!1,_initButton:function(){this.command="editorTextColor";this.hackCommand="foreColor";this.inherited(arguments);var e="",d=!1;this.params.custom&&(this.params.custom.recordUID&&(e=this.params.custom.recordUID),this.params.custom.forceAttr&&(d=this.params.custom.forceAttr));var c=this;this.button.set("iconClass",this.iconClassPrefix+" "+this.iconClassPrefix+"ForeColor");this.button.set("title",this.getLabel(this.hackCommand));this.button.loadDropDown=function(a){function b(b){c.button.dropDown=
new b({dir:c.editor.dir,ownerDocument:c.editor.ownerDocument,value:c.value,appearance:{showTransparent:!1,showColorPalette:!0,showCoustom:!0,showColorPickerApply:!1,showCoustomRecord:!0},recordUID:e,onChange:function(a){c.editor.execCommand("useCSS",d);c.editor.execCommand("styleWithCSS",!d);c.editor.execCommand(c.hackCommand,a)},onClose:function(){c.button.closeDropDown()}});a()}"string"===typeof c.colorPicker?k([c.colorPicker],b):b(c.colorPicker)}},updateState:function(){var e=this.editor,d=this.hackCommand;
if(e&&e.isLoaded&&d.length){var c;if(this.button){var a=this.get("disabled");this.button.set("disabled",a);if(a)return;try{c=e.queryCommandValue(d)||""}catch(b){c=""}}""===c?c="#000000":"transparent"===c&&(c="rgba(0, 0, 0, 0)");this.value=c;(e=this.button.dropDown)&&e.getColor&&c!==e.getColor()&&(e.refreshRecords(),e.setColor(c))}}});e.subscribe(p._scopeName+".Editor.getPlugin",null,function(e){if(!e.plugin)switch(e.args.name){case "editorTextColor":e.plugin=new h}});return h})},"jimu/dijit/EditorBackgroundColor":function(){define("require dojo dijit dojo/_base/declare dijit/_editor/_Plugin dijit/form/DropDownButton".split(" "),
function(k,e,p,q,n,l){e.experimental("dijit.editor.plugins.EditorBackgroundColor");var h=q("dijit.editor.plugins.EditorBackgroundColor",n,{buttonClass:l,colorPicker:"jimu/dijit/ColorPalette",useDefaultCommand:!1,_initButton:function(){this.command="editorBackgroundColor";this.hackCommand="hiliteColor";this.inherited(arguments);var e="";this.params.custom&&this.params.custom.recordUID&&(e=this.params.custom.recordUID);var d=this;this.button.set("iconClass",this.iconClassPrefix+" "+this.iconClassPrefix+
"HiliteColor");this.button.set("title",this.getLabel(this.hackCommand));this.button.loadDropDown=function(c){function a(a){d.button.dropDown=new a({dir:d.editor.dir,ownerDocument:d.editor.ownerDocument,value:d.value,appearance:{showTransparent:!0,showColorPalette:!0,showCoustom:!0,showColorPickerOK:!0,showColorPickerApply:!1,showCoustomRecord:!0},recordUID:e,onChange:function(a){d.editor.execCommand("useCSS",!1);d.editor.execCommand("styleWithCSS",!0);d.editor.execCommand(d.hackCommand,a)},onExecute:function(){d.editor.execCommand(d.hackCommand,
this.get("value"))},onClose:function(){d.button.closeDropDown()}});c()}"string"===typeof d.colorPicker?k([d.colorPicker],a):a(d.colorPicker)}},updateState:function(){var e=this.editor,d=this.hackCommand;if(e&&e.isLoaded&&d.length){var c;if(this.button){var a=this.get("disabled");this.button.set("disabled",a);if(a)return;try{c=e.queryCommandValue(d)||""}catch(b){c=""}}""===c?c="#000000":"transparent"===c&&(c="rgba(0, 0, 0, 0)");this.value=c;(e=this.button.dropDown)&&e.getColor&&c!==e.getColor()&&(e.refreshRecords(),
e.setColor(c))}}});e.subscribe(p._scopeName+".Editor.getPlugin",null,function(e){if(!e.plugin)switch(e.args.name){case "editorBackgroundColor":e.plugin=new h}});return h})},"builder/plugins/creation-entry/_build-generate_module":function(){define(["builder/plugins/creation-entry/Plugin","dojo/text!builder/plugins/creation-entry/Plugin.html","dojo/text!builder/plugins/creation-entry/css/style.css","dojo/i18n!builder/plugins/creation-entry/nls/strings"],function(){})},"builder/plugins/creation-entry/Plugin":function(){define("dojo/_base/declare dojo/_base/html dojo/Deferred dojo/keys builder/BasePlugin dijit/_WidgetsInTemplateMixin dojo/text!./Plugin.html dojo/_base/lang dojo/query dojo/promise/all jimu/dijit/Message jimu/dijit/Popup builder/portalUtils jimu/portalUrlUtils jimu/dijit/LoadingShelter builder/serviceUtils ./SaveAsPage ./CreateNewAppPage builder/dijit/FullScreenPopup".split(" "),
function(k,e,p,q,n,l,h,f,d,c,a,b,g,u,m,r,t,v,y){return k([n,l],{templateString:h,baseClass:"plugin-creation-app",fromAppId:null,postMixInProperties:function(){this.inherited(arguments);this.nls=f.mixin(this.nls,builderNls)},postCreate:function(){this.inherited(arguments)},popupNewCreateDlg:function(a,b){this._getInitAppInfo().then(f.hitch(this,function(c){this.createAppPage=new v({appInfo:c,pluginManager:this.pluginManager,createFromAppInfo:b,nls:this.nls,creationEntryPlugin:this,isPortalSupport3D:window.isPortalSupport3D});
c=d("#main-page")[0];this.createAppPopup=new y({zIndex:101,subDijit:this.createAppPage,titleStr:a||this.nls.appCreateNewAppTitle,content:this.createAppPage.domNode,blurContainer:c.firstElementChild,buttons:[{label:this.nls.next,key:q.ENTER,isHighLight:!0,onClick:f.hitch(this.createAppPage,this.createAppPage._onNextClick)},{label:this.nls.back,key:q.ENTER,isHighLight:!0,onClick:f.hitch(this.createAppPage,this.createAppPage._onBackClick)},{label:this.nls.ok,key:q.ENTER,isHighLight:!0,onClick:f.hitch(this,
this._onCreateNewClick)},{label:this.nls.cancel,key:q.ESCAPE,isHighLight:!1,onClick:f.hitch(this,this._onCreateNewCancelClick)}],btnsAtuoBottom:!0});this.createAppPopup.placeAt(c);this.createAppPopup.show();this.createAppPage.setPopup(this.createAppPopup);this.createAppPage.startup()}))},createNewApp:function(c){var d=new p;r.createApp(c).then(f.hitch(this,function(a){if(a.success){var g=f.clone(c);g.id=a.newAppId;this.pluginManager.getPluginByName("startup").switchToAppConfig(g);d.resolve();c.sharing&&
(c.webmap?this._shareAppWithWebmapOrWebscene(a.newAppId,c.folderId,c.webmap):c.webscene&&this._shareAppWithWebmapOrWebscene(a.newAppId,c.folderId,c.webscene))}else{var h=new b({content:a.message,container:"main-page",titleLabel:builderNls.createError||"",width:400,autoHeight:!0,buttons:[{label:this.nls.ok,key:q.ENTER,onClick:f.hitch(this,function(){a.href&&(e.setStyle(h.domNode,"display","none"),window.location.href=a.href);h.close()})}]});d.reject()}}),f.hitch(this,function(b){new a({message:b.message});
d.reject(b)}));return d},popupSaveAsDlg:function(a,c,d){this._getInitAppInfo(c).then(f.hitch(this,function(e){this.saveAsPage=new t({fromAppId:c,appInfo:e,nls:this.nls});this.saveAsPage.startup();this.saveAsPopup=new b({content:this.saveAsPage,container:"main-page",titleLabel:a||"",width:669,autoHeight:!0,buttons:[{label:this.nls.ok,key:q.ENTER,onClick:f.hitch(this,this._onSaveAsPopupNextClick,d)},{label:this.nls.cancel,classNames:["jimu-btn-vacation"],key:q.ESCAPE,onClick:f.hitch(this,this._onSaveAsPopupCancelClick)}]})}))},
_onSaveAsPopupCancelClick:function(){this._close()},_onSaveAsPopupNextClick:function(b){var c=this.saveAsPage._getAppInfoFromDlg(),d=this.pluginManager.getPluginByName("app-list");if(c.name){var e=new m;e.placeAt(this.saveAsPopup.domNode);e.startup();this._saveAs(c,b).then(f.hitch(this,function(){d&&window.isXT&&(c.isTemplate?d.refreshTemplatePage():d.refreshAppPage());e.destroy()}),function(){e.destroy()})}else new a({message:this.nls.noAppName})},_close:function(){this.saveAsPopup?(this.saveAsPopup.close(),
this.saveAsPopup=null):this.saveAsPage&&this.saveAsPage.destroy();this.createAppPopup&&(this.createAppPopup.close(),this.createAppPopup=null,this.createAppPage.destroy())},_saveAs:function(b,c){var d=new p;r.saveAs(b,c).then(f.hitch(this,function(c){if(c.success){var e=f.clone(b);e.id=c.newAppId;e.name=b.name;this._close();this.pluginManager.getPluginByName("startup").switchToAppConfig(e);d.resolve()}else new a({message:c.message}),d.reject()}),f.hitch(this,function(b){new a({message:b.message});
d.reject()}));return d},_onCreateNewClick:function(){var b=this.createAppPage._getAppInfoFromDlg(),c=this.pluginManager.getPluginByName("app-list");if(b.name){var d=new m;d.placeAt(this.createAppPopup.domNode);d.startup();this.createNewApp(b).then(f.hitch(this,function(){c&&window.isXT&&c.refreshAppPage();d.destroy();setTimeout(f.hitch(this,function(){this._close()}),300)}),function(){d.destroy()})}else new a({message:this.nls.noAppName})},_onCreateNewCancelClick:function(){this._close()},_getInitAppInfo:function(a){var b=
new p,c=this._getEmptyAppInfo();window.isXT?a?r.getAppInfo(a).then(f.hitch(this,function(a){c.name=a.name+this.nls._copy;c.description=a.description;c.appType=a.appType;c.isTemplate=a.isTemplate;c.thumbnail=a.thumbnail;b.resolve(c)}),f.hitch(this,function(a){console.error(this.nls.saveAsFaied,a);b.reject()})):b.resolve(c):a?g.getPortal(u.getPortalUrlFromLocation()).getItemById(a).then(f.hitch(this,function(a){c.name=a.title+this.nls._copy;c.tags=a.tags;c.description=a.snippet;b.resolve(c)}),f.hitch(this,
function(a){console.error(this.nls.saveAsFaied,a);b.reject()})):b.resolve(c);return b},_getEmptyAppInfo:function(){return{name:"",description:"",tags:["AppBuilder App"],folderId:"",sharing:!1,appType:window.appInfo.appType,webmap:null,fromAppId:null,creator:null,isPredefined:!0,isTemplate:!1,thumbnail:"/webappbuilder/builder/images/appthumbnail_2d.jpg",icon:"/webappbuilder/builder/images/logo.png"}},_shareAppWithWebmapOrWebscene:function(b,d,e){var h=g.getPortal(u.getPortalUrlFromLocation()),k=new p,
m=new p,l=new p,n=new p;h.getUser().then(f.hitch(this,function(a){k.resolve(a)}),f.hitch(this,function(b){new a({message:this.nls.createAppUrlError});console.error(b.message);k.reject()}));h.getItemById(e).then(f.hitch(this,function(a){m.resolve(a)}),f.hitch(this,function(b){new a({message:this.nls.createAppUrlError});console.error(b.message);m.reject(b)}));c({user:k,userItem:l}).then(f.hitch(this,function(c){var e={};switch(c.userItem.sharing.access){case "public":e.everyone=!0;e.groups=c.userItem.sharing.groups.toString();
break;case "account":case "org":e.org=!0;e.groups=c.userItem.sharing.groups.toString();break;case "shared":e.groups=c.userItem.sharing.groups.toString()}c.user.shareItem(e,b,d).then(f.hitch(this,function(a){n.resolve(a)}),f.hitch(this,function(b){new a({message:this.nls.createAppUrlError});console.error(b.message);n.reject()}))}));c({user:k,webmapItem:m}).then(f.hitch(this,function(c){if(c.webmapItem.owner===c.user.username)c.user.getItemById(e,c.webmapItem.ownerFolder).then(f.hitch(this,function(a){l.resolve(a)}),
f.hitch(this,function(b){new a({message:this.nls.createAppUrlError});console.error(b.message);l.reject(b)}));else{var g={};switch(c.webmapItem.access){case "public":g.everyone=!0;break;case "account":case "org":g.org=!0}c.user.shareItem(g,b,d).then(f.hitch(this,function(a){n.resolve(a)}),f.hitch(this,function(b){new a({message:this.nls.createAppUrlError});console.error(b.message);n.reject()}))}}))}})})},"builder/plugins/creation-entry/SaveAsPage":function(){define(["dojo/_base/declare","builder/BasePlugin",
"dijit/_WidgetsInTemplateMixin","dojo/text!./SaveAsPage.html","builder/dijit/ItemInfo"],function(k,e,p,q,n){return k([e,p],{templateString:q,baseClass:"saveas-app-page",fromAppId:null,appInfo:null,appType:null,_stemappExtensions:null,webmap:null,postMixInProperties:function(){this.inherited(arguments)},postCreate:function(){this.inherited(arguments)},startup:function(){window.isXT?(this.appInfo.tags=void 0,this.appInfo.folderId=void 0,this.appInfo.sharing=void 0):this.fromAppId&&(this.appInfo.sharing=
void 0,this.appInfo.thumbnail=void 0);this.itemInfoDijit=new n({itemInfo:this.appInfo});this.itemInfoDijit.placeAt(this.itemInfoBox)},_getAppInfoFromDlg:function(){var e=this.itemInfoDijit.getProperties();e.appType=this.appInfo.appType;e.webmap=this.webmap;e.fromAppId=this.fromAppId;e.isPredefined="default"!==this.fromAppId&&this.fromAppId?!1:!0;e.isTemplate=this.appInfo.isTemplate?!0:!1;e.saveAsTemplate=!1;return e}})})},"builder/plugins/creation-entry/CreateNewAppPage":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/html builder/BasePlugin dojo/dom-style dijit/_WidgetsInTemplateMixin dojo/text!./CreateNewAppPage.html dojo/query dojo/on dojo/dom-class dojo/_base/lang dojo/Evented builder/dijit/EditItemInfo builder/serviceUtils jimu/portalUrlUtils builder/portalUtils jimu/utils".split(" "),
function(k,e,p,q,n,l,h,f,d,c,a,b,g,u,m,r,t){return k([q,l,b],{templateString:h,baseClass:"create-app-page",appInfo:null,pluginManager:null,postMixInProperties:function(){this.inherited(arguments)},postCreate:function(){this.inherited(arguments)},startup:function(){"undefined"===typeof this.isPortalSupport3D&&(this.isPortalSupport3D=!1);this.isPortalSupport3D=!!this.isPortalSupport3D;this.initAppInfoPage();this.createFromAppInfo?(this.selectedApp=this.createFromAppInfo,this._displaySecondPage(),this._hideButton(1)):
(this.initAppSelectPage(),this._displayFirstPage())},destroy:function(){this.itemInfoDijit&&(this.itemInfoDijit.destroy(),this.itemInfoDijit=null);this.popup&&(this.popup=null);p.destroy(this.domNode);this.inherited(arguments)},initAppSelectPage:function(){this._stemappExtensions=this.pluginManager.getExtensions("startup.stemapps");this._stemappExtensions.sort(function(a,b){return a.parameters.index-b.parameters.index});u.getTemplateList(!0).then(a.hitch(this,function(b){var c=this._filterInfosByIsPortalSupport3D(b);
e.forEach(c,function(a){!a.id||"HTML_default"!==a.id&&"HTML3D_default"!==a.id?this._createAppNodeAndBindEvent(a,this.othersApps):("HTML_default"===a.id?a.name=this.nls.Default2D:"HTML3D_default"===a.id&&(a.name=this.nls.Default3D),this._createAppNodeAndBindEvent(a,this.defaultApps))},this);this._selecteApp(f(".app-image-border-div",this.allAppContent)[0]);c=m.getStandardPortalUrl(window.portalUrl);r.getPortal(c).getUser().then(a.hitch(this,function(a){var c=e.filter(b,function(b){return b.isTemplate&&
b.creator===a.username}),c=this._filterInfosByIsPortalSupport3D(c);e.forEach(c,function(a){this._createAppNodeAndBindEvent(a,this.ownAppContent)},this)}))}))},_filterInfosByIsPortalSupport3D:function(a){var b=this.isPortalSupport3D;return e.filter(a,function(a){return!1===b?"HTML3D"!==a.appType:!0})},initAppInfoPage:function(){this.itemInfoDijit=new g({itemInfo:this.appInfo,nls:this.nls});this.itemInfoDijit.placeAt(this.appInfoTable)},_createAppNode:function(a,b,c){this.zIndex=10;b=p.create("div",
{"class":"app-node jimu-float-leading",style:c},b);c=p.create("div",{"class":"app-image-border-div",title:t.stripHTML(a.description)},b);p.create("div",{"class":"app-image-div",style:{backgroundImage:"url("+a.thumbnail+")"}},c);var d;"HTML"===a.appType?d="2D":"HTML3D"===a.appType&&(d="3D");d=p.create("div",{"class":"flag-image flag-image-"+d},c);n.set(d,"z-index",this.zIndex++);p.create("div",{"class":"app-name",innerHTML:t.stripHTML(a.name),title:t.stripHTML(a.name)},b);return c},_createAppNodeAndBindEvent:function(b,
c){c=this._createAppNode(b,c);this.own(d(c,"click",a.hitch(this,this._onAppNodeClick,c)));c.appInfo=b;return c},_onAppNodeClick:function(a){var b=f(".app-image-border-div",this.appSelectPage);e.forEach(b,function(a){this._unselecteApp(a)},this);this._selecteApp(a)},_selecteApp:function(a){this.selectedApp=a.appInfo;c.add(a,"jimu-state-active")},_unselecteApp:function(a){c.remove(a,"jimu-state-active")},_onAllAppBtnClick:function(){var a=f(".app-image-border-div",this.allAppContent)[0];a&&(this._onAppNodeClick(a),
this.creationEntryPlugin.createAppPopup.enableButton(0));p.setStyle(this.allAppContent,"display","block");p.setStyle(this.ownAppContent,"display","none");p.addClass(this.allAppBtn,"selected");p.removeClass(this.ownAppBtn,"selected")},_onOwnAppBtnClick:function(){var a=f(".app-image-border-div",this.ownAppContent)[0];a?(this._onAppNodeClick(a),this.creationEntryPlugin.createAppPopup.enableButton(0)):this.creationEntryPlugin.createAppPopup.disableButton(0);p.setStyle(this.allAppContent,"display","none");
p.setStyle(this.ownAppContent,"display","block");p.addClass(this.ownAppBtn,"selected");p.removeClass(this.allAppBtn,"selected")},_onNextClick:function(){this._displaySecondPage();"HTML"===this.selectedApp.appType?this.itemInfoDijit.imageChooser.setDefaultSelfSrc("/webappbuilder/builder/images/appthumbnail_2d.jpg"):this.itemInfoDijit.imageChooser.setDefaultSelfSrc("/webappbuilder/builder/images/appthumbnail_3d.jpg")},_onBackClick:function(){this._displayFirstPage()},_displayFirstPage:function(){p.setStyle(this.appInfoPage,
"display","none");p.setStyle(this.appSelectPage,"display","block");this._displayButtion(0);this._hideButton(1);this._hideButton(2);this.popup&&this.popup.resize()},_displaySecondPage:function(){p.setStyle(this.appSelectPage,"display","none");p.setStyle(this.appInfoPage,"display","block");this._hideButton(0);this._displayButtion(1);this._displayButtion(2);this.popup&&this.popup.resize();this.itemInfoDijit&&this.itemInfoDijit.focusItemByName("appName")},setPopup:function(a){this.popup=a},_hideButton:function(a){p.setStyle(this.popup.enableButton(a),
"display","none")},_displayButtion:function(a){p.setStyle(this.popup.enableButton(a),"display","inline-block")},_getAppInfoFromDlg:function(){var a=this.itemInfoDijit.getProperties();a.appType=this.selectedApp.appType;a.webmap=this.webmap;a.fromAppId=this.selectedApp.id;a.isPredefined=!1;a.isTemplateApp=this.selectedApp.isTemplate;0===a.icon.indexOf("/webappbuilder/builder/images/")&&(a.icon=null);0===a.thumbnail.indexOf("/webappbuilder/builder/images/")&&(a.thumbnail=null);return a}})})},"builder/plugins/header/_build-generate_module":function(){define(["builder/plugins/header/Plugin",
"dojo/text!builder/plugins/header/Plugin.html","dojo/text!builder/plugins/header/css/style.css","dojo/i18n!builder/plugins/header/nls/strings"],function(){})},"builder/plugins/header/Plugin":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/on dojo/topic dojo/Deferred dojo/request dojo/request/script builder/portalUtils jimu/portalUrlUtils builder/tokenUtils jimu/utils builder/BasePlugin dojo/_base/config".split(" "),function(k,e,p,q,n,l,h,f,d,c,a,b,g,u){return k([g],{baseClass:"plugin-header",
_trainingUrls:{administrator:"//www.esri.com/training/main/arcgis-online-administrators",publisher:"//www.esri.com/training/main/arcgis-online-publishers",user:"//www.esri.com/training/main/arcgis-online-users","public":"//www.esri.com/training/main/arcgis-online-training",custom:"//www.esri.com/training/main/arcgis-online-training"},_esriCommunityLink:"https://community.esri.com",_myEsriLink:"https://my.esri.com",postCreate:function(){this.inherited(arguments);this._initSelf()},_initSelf:function(){this._isWebTier(window.portalUrl).then(e.hitch(this,
function(a){a&&p.setStyle(this.signOutItem,"display","none")}));window.isXT?(p.addClass(this.domNode,"xt"),p.destroy(this.homeSection),this._bindXtEvents()):(p.addClass(this.homeLabel,"js-home-dropdown"),p.destroy(this.switchSection),this._bindIntegratedEvents(window.portalUrl));var a=d.getPortal(window.portalUrl);a.haveSignIn()&&a.getUser().then(e.hitch(this,function(a){if(a){!window.isXT&&a.privileges&&0<=a.privileges.indexOf("portal:user:viewOrgUsers")&&p.removeClass(this.organizationItem,"hidden");
var b=a.firstName||a.username;b&&(this.userNameNode.innerHTML=b);if(a.thumbnail&&(b=c.getUserThumbnailUrl(window.portalUrl,a.username,a.thumbnail))){var d=a.credential&&a.credential.token;d&&(b+="?token\x3d"+d);this.userIcon.src=b;this.profileImg.src=b}this.profileNameNode.innerHTML=a.username;c.isOnline(window.portalUrl)?"both"===a.userType&&(this.communityNode.href=this._esriCommunityLink,this.myesriNode.href=this._myEsriLink,p.removeClass(this.communityNode,"hidden"),p.removeClass(this.myesriNode,
"hidden"),b="",b=a.isAdminRole()?this._trainingUrls.administrator:a.isPublisherRole()?this._trainingUrls.publisher:a.isUserRole()?this._trainingUrls.user:this._trainingUrls.custom,this.trainingNode.href=b,p.removeClass(this.trainingNode,"hidden")):a.isAdminRole()&&(this.adminHelpNode.href=c.getPortalAdminHelpUrl(window.portalUrl,u.locale),p.removeClass(this.adminHelpNode,"hidden"))}}),e.hitch(this,function(a){console.error(a)}))},_isWebTier:function(b){var c=new l,d=esri.id.findServerInfo(b);d&&d.webTierAuth?
c.resolve(!0):c=a.isWebTierPortal(b);return c},_isUserMenuShow:function(){return p.hasClass(this.userSection,"is-active")},_showUserMenu:function(){p.addClass(this.userSection,"is-active")},_hideUserMenu:function(){p.removeClass(this.userSection,"is-active")},_bindXtEvents:function(){this.own(q(document.body,"click",e.hitch(this,function(a){a=a.target||a.srcElement;a===this.userSection||p.isDescendant(a,this.userSection)||this._hideUserMenu()})));this.own(n.subscribe("iframeClick",e.hitch(this,function(){this._hideUserMenu()})));
this.own(n.subscribe("userSignOut",e.hitch(this,function(){this.userNameNode.innerHTML=""})));this.own(n.subscribe("userSignIn",e.hitch(this,function(a){this.userNameNode.innerHTML=a.userId||""})));this.logoTitle.title=this.nls.backToHomePage||"";this.own(q(this.logoTitle,"click",e.hitch(this,function(a){a.preventDefault();p.hasClass(this.domNode,"app-opened")&&this.pluginManager.getPluginByName("startup").switchToAppList()})));this.own(q(this.profileItem,"click",e.hitch(this,function(){var a=e.hitch(this,
function(){window.location.href=c.getHomeUserUrl(window.portalUrl)});this._isInConfig()?n.publish("closeAppConfigPage",a):a()})));this.helpNode.href="help";this.signOutItem&&this.own(q(this.signOutItem,"click",e.hitch(this,function(){var d=e.hitch(this,function(){this.userNameNode.innerHTML="";a.signOutAll();var d=c.getOAuth2SignOutUrl(window.portalUrl),d=c.setHttpsProtocol(d),e=function(){var a=b.getLocationUrlWithoutHashAndQueryParams(),a=b.url.addQueryParamToUrl(a,"action","setportalurl");window.location.href=
a};this._getSigninInfo(window.portalUrl).then(function(a){if(a.success&&a.info&&a.info.portalUrl&&a.info.supportsOAuth)try{f.get(d).always(function(){e()})}catch(y){console.error(y),e()}else e()},function(){e()})});this._isInConfig()?n.publish("closeAppConfigPage",d):d()})));this.own(q(window,"resize",e.hitch(this,function(){this._calculateWidth()})));this.own(q(this.appSwitch,"click",e.hitch(this,this._onAppsClicked)));this.own(q(this.templateSwitch,"click",e.hitch(this,this._onTemplatesClicked)));
this._calculateWidth()},_calculateWidth:function(){1816>=window.innerWidth?p.addClass(this.domNode,"width-less1816"):p.removeClass(this.domNode,"width-less1816")},_getSigninInfo:function(a){return h("/webappbuilder/rest/signininfo/getsignininfo",{handleAs:"json",query:"portalUrl\x3d"+a,method:"GET"})},_bindIntegratedEvents:function(b){c.isOnline(window.portalUrl)&&(p.removeClass(this.switchAccountsNode,"hidden"),this.switchAccountsNode.href=c.getSwitchAccoutnsUrl(window.portalUrl,"arcgisonline",""));
this.own(q(document.body,"click",e.hitch(this,function(a){a=a.target||a.srcElement;a!==this.homeLabel&&p.removeClass(this.homeSection,"is-active");a===this.userSection||p.isDescendant(a,this.userSection)||this._hideUserMenu()})));this.own(n.subscribe("iframeClick",e.hitch(this,function(){p.removeClass(this.homeSection,"is-active");this._hideUserMenu()})));this.own(q(this.homeLabel,"click",e.hitch(this,function(a){a.preventDefault();p.hasClass(this.homeSection,"is-active")?p.removeClass(this.homeSection,
"is-active"):p.addClass(this.homeSection,"is-active")})));this.own(q(this.homeItem,"click",e.hitch(this,function(){n.publish("closeAppConfigPage",function(){window.location.href=c.getHomeIndexUrl(b)})})));this.own(q(this.galleryItem,"click",e.hitch(this,function(){n.publish("closeAppConfigPage",function(){window.location.href=c.getHomeGalleryUrl(b)})})));this.own(q(this.mapItem,"click",e.hitch(this,function(){window.appConfig&&window.appConfig.map&&n.publish("closeAppConfigPage",function(){window.location.href=
c.getHomeMapViewerUrl(window.appConfig.map.portalUrl||window.appConfig.portalUrl,window.appConfig.map.itemId)})})));this.own(q(this.sceneItem,"click",e.hitch(this,function(){window.appConfig&&window.appConfig.map&&n.publish("closeAppConfigPage",function(){window.location.href=c.getHomeSceneViewerUrl(window.appConfig.map.portalUrl||window.appConfig.portalUrl)})})));this.own(q(this.groupsItem,"click",e.hitch(this,function(){n.publish("closeAppConfigPage",function(){window.location.href=c.getHomeGroupsUrl(b)})})));
this.own(q(this.contentItem,"click",e.hitch(this,function(){n.publish("closeAppConfigPage",function(){window.location.href=c.getHomeMyContentUrl(b)})})));this.own(q(this.organizationItem,"click",e.hitch(this,function(){n.publish("closeAppConfigPage",function(){window.location.href=c.getHomeMyOrganizationUrl(b)})})));this.own(q(this.profileItem,"click",e.hitch(this,function(){n.publish("closeAppConfigPage",function(){window.location.href=c.getHomeUserUrl(b)})})));0<=b.toLowerCase().indexOf(".arcgis.com")?
this.helpNode.href="http://doc.arcgis.com/en/web-appbuilder/":this.helpNode.href=c.getPortalHelpUrl(b,u.locale);this.signOutItem&&this.own(q(this.signOutItem,"click",e.hitch(this,function(){n.publish("closeAppConfigPage",function(){if(c.isOnline(window.portalUrl)){var b=c.getSwitchAccoutnsUrl(window.portalUrl,"arcgisonline","");window.location.href=b+"\x26signout\x3dtrue"}else a.signOutAll(),window.location.href=c.getPortalSignInUrlFromLocation()})})))},setAppName:function(a){a=a||"";(this.appName.innerHTML=
a)?(window.isXT?this.logoTitle.title=this.nls.backToHomePage||"":p.setStyle(this.logoTitle,"color","#4c4c4c"),p.addClass(this.domNode,"app-opened"),p.removeClass(this.domNode,"app-not-opened"),window.isXT||(p.setAttr(this.appName,"href",window.portalUrl+"/home/item.html?id\x3d"+window.appInfo.id),p.setAttr(this.appName,"title",this.nls.showItemDetails),p.addClass(this.appName,"highlight"))):(this.logoTitle.title="",p.removeClass(this.domNode,"app-opened"),p.addClass(this.domNode,"app-not-opened"))},
getAppName:function(){return this.appName.innerHTML||""},_isInConfig:function(){return"appconfig"===this.pluginManager.getPluginByName("startup").getCurrentView().label},_onUserSectionClicked:function(a){a=a.target||a.srcElement;var b=!0;if(p.isDescendant(a,this.userInfoDom)||a===this.userInfoDom)this._isUserMenuShow()||(b=!1);b?this._hideUserMenu():this._showUserMenu()},_onAppsClicked:function(){p.removeClass(this.templateSwitch,"selected");p.addClass(this.appSwitch,"selected");n.publish("switchToAppListApps")},
_onTemplatesClicked:function(){p.removeClass(this.appSwitch,"selected");p.addClass(this.templateSwitch,"selected");n.publish("switchToAppListTemplates")}})})},"builder/plugins/map-config/_build-generate_module":function(){define(["builder/plugins/map-config/Plugin","dojo/text!builder/plugins/map-config/Plugin.html","dojo/text!builder/plugins/map-config/css/style.css","dojo/i18n!builder/plugins/map-config/nls/strings"],function(){})},"builder/plugins/map-config/Plugin":function(){define("dojo/on dojo/keys dojo/json dojo/topic dojo/Deferred dojo/_base/lang dojo/_base/array dojo/_base/html dojo/_base/query dojo/_base/event dojo/promise/all dojo/dom-construct dojo/_base/declare dojo/text!./Plugin.html dijit/_WidgetsInTemplateMixin builder/BasePlugin builder/portalUtils jimu/Role jimu/utils jimu/dijit/Popup jimu/portalUrlUtils jimu/dijit/Message ./MapSelector ./CustomizeScale builder/dijit/RefreshInterval".split(" "),
function(k,e,p,q,n,l,h,f,d,c,a,b,g,u,m,r,t,v,y,w,z,x,A,C){return g([r,m],{templateString:u,baseClass:"map-config",appConfig:null,map:null,sceneView:null,item:null,widgetsConfigCache:null,postMixInProperties:function(){var a=l.clone(window.builderNls);this.nls=l.mixin(a,this.nls);this.nls.scaleDisabledTip2=this.nls.scaleDisabledTip.replace("${scaleTitle}",'"'+this.nls.scaleTitle+'"');this._is3D()?(this.nls.clickChooseWebMapOrWebScene=this.nls.clickChooseWebScene,this.nls.chooseWebMapOrWebScene=this.nls.chooseWebScene):
(this.nls.clickChooseWebMapOrWebScene=this.nls.clickChooseWebMap,this.nls.chooseWebMapOrWebScene=this.nls.selectWebMap)},postCreate:function(){this.inherited(arguments);this._init()},destroy:function(){this.appConfigPlugin=null;this.inherited(arguments)},_is3D:function(){return"HTML3D"===window.appInfo.appType},_init:function(){this.widgetsConfigCache={};this.own(q.subscribe("app/appConfigChanged",l.hitch(this,this.appConfigChanged)));this.own(q.subscribe("app/appConfigLoaded",l.hitch(this,this.appConfigLoaded)));
this.own(q.subscribe("app/mapLoaded",l.hitch(this,function(a){this._setMap(a)})));this.own(q.subscribe("app/mapChanged",l.hitch(this,function(a){this._setMap(a);this.refreshIntervalDijit.reset()})));this.own(q.subscribe("app/sceneViewLoaded",l.hitch(this,function(a){this.sceneView=a})));this.own(q.subscribe("app/sceneViewChanged",l.hitch(this,function(a){this.sceneView=a})));this.appConfigPlugin=this.pluginManager.getPluginByName("app-config");this.embeddedMapViewerHelper={portalUrl:void 0,container:void 0,
popup:void 0,webmapId:void 0,frameName:"embeddedMapViewer",hideItems:"hide\x3dshare,lnk,analysis,directions",params:"embedded\x3d1\x26locale\x3d"+dojoConfig.locale,loadingShelter:void 0,loaded:void 0,hasUnsavedChanged:void 0,readyToClose:void 0,loadInterval:void 0,unsavedInterval:void 0,webmapIdInterval:void 0,isClosing:!1};this.own(k(window,"message",l.hitch(this,this.receiveViewerMessage)));this._is3D()?f.addClass(this.mapOptions3D,"enabled"):(f.addClass(this.mapOptions2D,"enabled"),this.own(k(this.refreshIntervalDijit,
"user-input-change",l.hitch(this,this._onRefreshIntervalChange))))},_onRefreshIntervalChange:function(a){q.publish("mapRefreshIntervalChanged",a)},_setInitialExtent:function(){try{q.publish("mapOptionsChanged",{extent:this.map.extent.toJson()})}catch(B){console.error(B)}},_blinkMapContainer:function(){var a=null;if(a=this._is3D()?this.sceneView.container:this.map.container){var b=f.create("div");f.addClass(b,"blink-map-border");f.place(b,a);var c=0,d=setInterval(l.hitch(this,function(){f.toggleClass(b,
"blink-map-border-show");c++;6===c&&(b.parentNode.removeChild(b),clearInterval(d))}),200)}},_useCurrentMapExtent:function(){this.map&&(this._setInitialExtent(),this._blinkMapContainer())},_useDefaultMapExtent:function(a){y.restoreToDefaultWebMapExtent(this.map,this.map.webMapResponse,this.appConfig&&this.appConfig.geometryService).then(l.hitch(this,function(){this._setInitialExtent();a&&this._blinkMapContainer()}),l.hitch(this,function(a){"string"===typeof a&&new x({message:a});console.error(a)}))},
showMapSelector:function(){this.hideMapOptions();var a=new A({nls:this.nls,type:"HTML3D"===window.appInfo.appType?"Web Scene":"Web Map"}),b=new w({width:1024,titleLabel:this.nls.chooseWebMapOrWebScene,content:a,container:"main-page",onClose:l.hitch(this,function(){try{a&&a.domNode&&a.destroy()}catch(D){console.error(D)}a=null;return!0}),buttons:[{label:this.nls.ok,key:e.ENTER,classNames:["map-selector-btn-ok"],onClick:l.hitch(this,function(){var c=a.getSelectedMapItem();this._selectItem(c,b)})},{label:this.nls.cancel,
key:e.ESCAPE,classNames:["map-selector-btn-cancel","jimu-btn-vacation"],onClick:l.hitch(this,function(){b.close()})}]})},embedWebMap:function(a,c,d){this.embeddedMapViewerHelper.portalUrl=z.getStandardPortalUrl(a);a=this.embeddedMapViewerHelper.portalUrl+"/home/webmap/viewer.html?"+(d?"webmap\x3d"+d+"\x26":"")+this.embeddedMapViewerHelper.params+"\x26"+this.embeddedMapViewerHelper.hideItems;d=t.getPortal(this.embeddedMapViewerHelper.portalUrl);a+="#"+d.credential.token;this.embeddedMapViewerHelper.container=
b.create("div",{"class":"embed-mapviewer-content"});b.create("iframe",{src:a,name:this.embeddedMapViewerHelper.frameName,style:"width:100%;height:99%"},this.embeddedMapViewerHelper.container);this.embeddedMapViewerHelper.loadingShelter=b.create("div",{"class":"load-container map-loading"},this.embeddedMapViewerHelper.container);f.setStyle(this.embeddedMapViewerHelper.loadingShelter,"display","block");c=new w({titleLabel:c,content:this.embeddedMapViewerHelper.container,container:"main-page",onClose:l.hitch(this,
function(){if(!0===this.embeddedMapViewerHelper.readyToClose)return!0;this._closeEmbeddedMapViewer();return!1})});f.setStyle(c.domNode,{top:"5%",left:"5%",width:"90%",height:"90%"});c.startup();this.embeddedMapViewerHelper.popup=c;this.embeddedMapViewerHelper.loaded=!1;this.embeddedMapViewerHelper.readyToClose=!1;this.embeddedMapViewerHelper.isClosing=!1;this.embeddedMapViewerHelper.loadInterval=setInterval(l.hitch(this,function(){this.embeddedMapViewerHelper.loaded?(f.setStyle(this.embeddedMapViewerHelper.loadingShelter,
"display","none"),clearInterval(this.embeddedMapViewerHelper.loadInterval),this.embeddedMapViewerHelper.loadInterval=null):this.sendPostMessage({type:"isLoaded"})}),500)},showMapOptions:function(a){c.stop(a);f.setStyle(this.webMapEditOptions,"display","");f.setStyle(this.webMapOptionsMask,"display","")},hideMapOptions:function(){f.setStyle(this.webMapEditOptions,"display","none");f.setStyle(this.webMapOptionsMask,"display","none")},editWebMap:function(){this.hideMapOptions();this.embedWebMap(this.appConfig.map.portalUrl,
this.nls.editMap,this.appConfig.map.itemId)},createWebMap:function(){this.hideMapOptions();this.embedWebMap(this.appConfig.portalUrl,this.nls.createMap)},_closeEmbeddedMapViewer:function(){this.embeddedMapViewerHelper.isClosing||(this.embeddedMapViewerHelper.isClosing=!0,f.setStyle(this.embeddedMapViewerHelper.loadingShelter,"display",""),this.embeddedMapViewerHelper.loaded?(this.embeddedMapViewerHelper.hasUnsavedChanged=void 0,this.embeddedMapViewerHelper.unsavedInterval=setInterval(l.hitch(this,
function(){if("undefined"===typeof this.embeddedMapViewerHelper.hasUnsavedChanged)this.sendPostMessage({type:"hasUnsavedChanges"});else if(clearInterval(this.embeddedMapViewerHelper.unsavedInterval),this.embeddedMapViewerHelper.unsavedInterval=null,this.embeddedMapViewerHelper.hasUnsavedChanged)var a=new w({content:this.nls.hasUnsavedChanges,titleLabel:this.nls.customMap,autoHeight:!0,width:600,buttons:[{label:this.nls.ok,onClick:l.hitch(this,function(){a.close();this._doCloseEmbeddedMapViewer()})},
{label:this.nls.cancel,onClick:l.hitch(this,function(){f.setStyle(this.embeddedMapViewerHelper.loadingShelter,"display","none");this.embeddedMapViewerHelper.isClosing=!1;a.close()})}]});else this._doCloseEmbeddedMapViewer()}),500)):this._doCloseEmbeddedMapViewer())},_doCloseEmbeddedMapViewer:function(){f.setStyle(this.embeddedMapViewerHelper.loadingShelter,"display","none");this.embeddedMapViewerHelper.loadInterval&&(clearInterval(this.embeddedMapViewerHelper.loadInterval),this.embeddedMapViewerHelper.loadInterval=
null);this.embeddedMapViewerHelper.unsavedInterval&&(clearInterval(this.embeddedMapViewerHelper.unsavedInterval),this.embeddedMapViewerHelper.unsavedInterval=null);this.embeddedMapViewerHelper.loaded?(this.embeddedMapViewerHelper.webmapId=void 0,this.sendPostMessage({type:"getWebmapId"}),this.embeddedMapViewerHelper.webmapIdInterval=setInterval(l.hitch(this,function(){"undefined"!==typeof this.embeddedMapViewerHelper.webmapId&&(clearInterval(this.embeddedMapViewerHelper.webmapIdInterval),this.embeddedMapViewerHelper.webmapIdInterval=
null,b.destroy(this.embeddedMapViewerHelper.container),this.embeddedMapViewerHelper.container=null,this.embeddedMapViewerHelper.readyToClose=!0,this.embeddedMapViewerHelper.popup.close(),this.embeddedMapViewerHelper.webmapId&&t.getPortal(this.embeddedMapViewerHelper.portalUrl).getItemById(this.embeddedMapViewerHelper.webmapId).then(l.hitch(this,function(a){this._updateWebMap(a)})))}),500)):(b.destroy(this.embeddedMapViewerHelper.container),this.embeddedMapViewerHelper.container=null,this.embeddedMapViewerHelper.readyToClose=
!0,this.embeddedMapViewerHelper.popup.close())},sendPostMessage:function(a){this.embeddedMapViewerHelper.portalUrl&&window.frames[this.embeddedMapViewerHelper.frameName]&&window.frames[this.embeddedMapViewerHelper.frameName].postMessage(p.stringify(a),this.embeddedMapViewerHelper.portalUrl)},receiveViewerMessage:function(a){console.log("received",a.origin,a.data);if(!(0>this.embeddedMapViewerHelper.portalUrl.indexOf(a.origin)))switch(a=p.parse(a.data),a.type){case "webmapId":this.embeddedMapViewerHelper.webmapId=
a.webmapId;break;case "loaded":this.embeddedMapViewerHelper.loaded=a.value;break;case "unsavedChanges":this.embeddedMapViewerHelper.hasUnsavedChanged=a.value;break;case "message":console.log(a.message)}},_selectItem:function(a,b){a&&(this._hasSameWebMap(this.appConfig,{map:{portalUrl:a.portalUrl,itemId:a.id}})?b.close():this._updateWebMap(a,b))},_updateWebMap:function(a,b){var c=this.appConfig,c=this._getHttpWebMapItemUrl(c.map.portalUrl||c.portalUrl,c.map.itemId);this.widgetsConfigCache[c]||(this.widgetsConfigCache[c]=
{});var e=this.widgetsConfigCache[c],g=l.clone(this.appConfig);g.map.portalUrl=a.portalUrl;g.map.itemId=a.id;var k=this._tryResetWidgetsConfigWhenMapSwitched(g);if(0<k.length){var c=h.map(k,l.hitch(this,function(a){return a.label})),m=f.toDom("\x3cdiv style\x3d'font-size:14px;line-height:22px;'\x3e\x3cdiv\x3e"+this.nls.mapChangeConfimationTip+"\x3c/div\x3e\x3cdiv style\x3d'margin-top:25px;margin-bottom:20px;color:#596679;'\x3e"+this.nls.theseWidgetsAre+":\x3c/div\x3e\x3cul class\x3d'reset-widget-list' style\x3d'color:#596679;'\x3e\x3c/ul\x3e\x3cdiv style\x3d'margin-top:25px;'\x3e"+
this.nls.sureToSwitch+"\x3c/div\x3e\x3c/div\x3e"),n=d(".reset-widget-list",m)[0];h.forEach(c,l.hitch(this,function(a,b){a=f.create("li",{innerHTML:a},n);0!==b&&(a.style.marginTop="8px")}));var p=new w({content:m,titleLabel:this.nls.mapSwitchConfimation,autoHeight:!0,width:640,buttons:[{label:this.nls.ok,onClick:l.hitch(this,function(){b&&b.close();p.close();this.appConfigPlugin.showLoadingCover();q.publish("new-webmap-item-selected",a);q.publish("setAppConfig",g);h.forEach(k,l.hitch(this,function(a){e[a.id]=
a.config}))})},{label:this.nls.cancel,onClick:l.hitch(this,function(){p.close()})}]})}else b&&b.close(),this.appConfigPlugin.showLoadingCover(),this._publishMapChange(a)},_publishMapChange:function(a){q.publish("new-webmap-item-selected",a);this._is3D()?q.publish("sceneViewChanged",{portalUrl:a.portalUrl,itemId:a.id}):q.publish("mapChanged",{portalUrl:a.portalUrl,itemId:a.id})},_hasSameWebMap:function(a,b){var c=(a=a&&a.map)&&a.itemId,d=(b=b&&b.map)&&b.itemId;return z.isSamePortalUrl(a&&a.portalUrl,
b&&b.portalUrl)&&c===d},_setMap:function(a){this.map=a;this._checkCustomScaleAvailablity()},_updateChoseMapButtons:function(b){var c=this._checkUpdatePrivileges(b.map.portalUrl);b=this._checkUpdatePrivileges(b.portalUrl);a([c,b]).then(l.hitch(this,function(a){var b=a[0];a=a[1];b||a?(f.setStyle(this.mapOptions,"display",""),f.setStyle(this.chooseMapButton,"width","140px"),f.setStyle(this.chooseMapButton,"max-width","140px"),b?f.setStyle(this.btnEditWebMap,"display",""):f.setStyle(this.btnEditWebMap,
"display","none"),a?f.setStyle(this.btnCreateWebMap,"display",""):f.setStyle(this.btnCreateWebMap,"display","none")):(f.setStyle(this.mapOptions,"display","none"),f.setStyle(this.chooseMapButton,"width","100%"),f.setStyle(this.chooseMapButton,"max-width","100%"))}),l.hitch(this,function(){f.setStyle(this.mapOptions,"display","none");f.setStyle(this.chooseMapButton,"width","100%");f.setStyle(this.chooseMapButton,"max-width","100%")}))},_checkUpdatePrivileges:function(a){var b=new n;this._is3D()||!z.isSameServer(a,
window.location.host)?b.resolve(!1):t.getPortal(a).getUser().then(l.hitch(this,function(a){var c=!1;if(a){var d=new v({id:a.roleId?a.roleId:a.role,role:a.role});a.privileges&&(d.setPrivileges(a.privileges),c=d.canCreateItem())}b.resolve(c)}),l.hitch(this,function(a){console.error(a);b.resolve(!1)}));return b},appConfigLoaded:function(a){this.setAppConfig(a);this._is3D()||this.refreshIntervalDijit.setValue(a.map.mapRefreshInterval)},appConfigChanged:function(a){this.setAppConfig(a)},setAppConfig:function(a){if(this.appConfig){var b=
this._hasSameWebMap(this.appConfig,a);this.appConfig=a;b||this._requestCurrentItem()}else this.appConfig=a,this._requestCurrentItem();this._updateChoseMapButtons(this.appConfig)},_getHttpWebMapItemUrl:function(a,b){a=z.getItemUrl(a,b);return a=z.setHttpProtocol(a)},_tryResetWidgetsConfigWhenMapSwitched:function(a){var b=[],c=this._getHttpWebMapItemUrl(a.map.portalUrl||a.portalUrl,a.map.itemId);this.widgetsConfigCache[c]||(this.widgetsConfigCache[c]={});var d=this.widgetsConfigCache[c];a.visitElement(l.hitch(this,
function(a){if(!a.widgets&&a.uri&&!1===a.keepConfigAfterMapSwitched){var c=a.config,e=d&&d[a.id];e?a.config=e:delete a.config;if(!a.isDefaultConfig||e)a=l.clone(a),a.config=c,b.push(a)}}));return b},_requestCurrentItem:function(){var a=this.appConfig&&this.appConfig.map&&this.appConfig.map.itemId;if(a){var a={q:"id:"+a,num:1,f:"json"},b=t.getPortal(this.appConfig.map&&this.appConfig.map.portalUrl);b&&b.queryItems(a).then(l.hitch(this,function(a){this.domNode&&(a=a.results,0<a.length&&this._showSelectedItem(a[0]))}),
l.hitch(this,function(a){console.debug("query item from portal failed",a)}))}},_tryLocaleDate:function(a){var b=y.localizeDate(a,{selector:"date"});b||(b=a.toLocaleDateString());return b},_showSelectedItem:function(a){this.item=a;var b=a.type.toLowerCase();f.empty(this.thumbnailContainer);f.removeClass(this.webItemIcon,"webmap");f.removeClass(this.webItemIcon,"webscene");this.webItemType.innerHTML=a.type;var c=f.create("div",{"class":"thumbnail"},this.thumbnailContainer);a.thumbnailUrl?f.setStyle(c,
"backgroundImage","url("+a.thumbnailUrl+")"):"web map"===b?f.addClass(c,"default-webmap"):"web scene"===b&&f.addClass(c,"default-webscene");"web map"===b?f.addClass(this.webItemIcon,"webmap"):"web scene"===b&&f.addClass(this.webItemIcon,"webscene");this.snippet.innerHTML=a.snippet||"";this.lastModified.innerHTML=this._tryLocaleDate(new Date(a.modified));this.lastModified.title=this.lastModified.innerHTML;this.webMapDetails.href=a.detailsPageUrl;b=a.owner||"";this.ownerName.innerHTML=b;this.ownerName.title=
b;this.ownerName.href=a.ownerPageUrl||"";this.mapTitle.innerHTML=a.title;this.mapTitle.title=a.title},_checkCustomScaleAvailablity:function(){this._isBasemapLayerSupportLods()?(f.removeClass(this.btnScale,"jimu-state-disabled"),this.btnScale.title=""):(f.addClass(this.btnScale,"jimu-state-disabled"),this.btnScale.title=this.nls.scaleDisabledTip2)},_isBasemapLayerSupportLods:function(){var a=!1;if(this.map){var b=this.map.layerIds;b&&0<b.length&&(a=(a=this.map.getLayer(b[0]))&&a.tileInfo&&a.tileInfo.lods)}return a},
_onBtnScaleClicked:function(){if(this._isBasemapLayerSupportLods())var a=new C({nls:this.nls,map:this.map}),b=new w({width:640,height:590,titleLabel:this.nls.scaleTitle,content:a,container:"main-page",onClose:l.hitch(this,function(){try{a&&a.domNode&&a.destroy()}catch(D){console.error(D)}a=null;return!0}),buttons:[{label:this.nls.ok,onClick:l.hitch(this,function(){var c=a.getLodsFromListNode(),d=a.getLodsFromMap();b.close();var e=!1,e=c.length===d.length?h.every(c,l.hitch(this,function(a,b){b=d[b];
var c=a.scale===b.scale,e=a.resolution===b.resolution;return a.level===b.level&&c&&e})):!1;e||(this.appConfigPlugin.showLoadingCover(),q.publish("mapOptionsChanged",{lods:c}))})},{label:this.nls.cancel,classNames:["jimu-btn-vacation"],onClick:l.hitch(this,function(){b.close()})}]})},_setInitialViewpoint:function(a){try{q.publish("mapOptionsChanged",{initialState:{viewpoint:a}})}catch(E){console.error(E)}},_useCurrentViewpoint:function(){if(this.sceneView){var a=this.sceneView.viewpoint.toJSON();this._setInitialViewpoint(a);
this._blinkMapContainer()}},_useDefaultViewpoint:function(){var a=this.sceneView.map.itemInfo.itemData.initialState.viewpoint,a=l.clone(a);this._setInitialViewpoint(a);this._blinkMapContainer()}})})},"builder/plugins/map-config/MapSelector":function(){define("dojo/_base/declare dojo/topic dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./MapSelector.html dojo/_base/config dojo/_base/lang dojo/_base/array dojo/_base/html dojo/query dojo/on jimu/utils jimu/dijit/TabContainer3 jimu/portalUrlUtils jimu/dijit/Search builder/portalUtils ./MapTable dijit/form/Select".split(" "),
function(k,e,p,q,n,l,h,f,d,c,a,b,g,u,m,r,t,v){return k([p,q,n],{templateString:l,baseClass:"map-selector",tab:null,isPublicTabShow:!1,nls:null,type:"",_user:null,_group:null,_webMapQueryString:"",_allPublicPortalQuery:null,_filterPublicPortalQuery:null,_allPublicOnlineQuery:null,_filterPublicOnlineQuery:null,_allOrganizationQuery:null,_filterOrganizationQuery:null,_allMyContentQuery:null,_filterMyContentQuery:null,_allGroupQuery:null,_filterGroupQuery:null,_signIn:!1,portal:null,postCreate:function(){this.inherited(arguments);
this._webMapQueryString=" "+g.getItemQueryStringByTypes([this.type])+" ";this.portal=t.getPortal(this._getPortalUrl());this._initSearchQuery();this._initTabs();this._initPortalRadio();this._initMapTables();this._initPrivate();this._initPublic();this._bindMapTableEvents();this._updateUIbySignIn()},startup:function(){this.tab._started||(this.tab.startup(),this.tab._started=!0)},_initTabs:function(){var a={title:this.nls.myContent,content:this.mycontentTabNode},d={title:this.nls.myOrganization,content:this.organizationTabNode},
e={title:this.nls.myGroup,content:this.groupTabNode},g={title:this.nls.publicMap,content:this.publicTabNode};this.isPublicTabShow=!1;this.tab=new u({tabs:[a,d,e,g]},this.tabNode);this.own(b(this.tab,"tabChanged",f.hitch(this,function(a){c.addClass(this.signinSection,"hidden");a!==this.nls.publicMap?(this.isPublicTabShow=!1,this._updateUIbySignIn(),this.portal.getUser().then(f.hitch(this,function(b){a===this.nls.myContent?this._searchMyContent(b):a===this.nls.myOrganization?this._searchOrganization(b):
a===this.nls.myGroup&&this._searchGroups(b)}))):(this.isPublicTabShow=!0,this._searchPublic())})))},_bindMapTableEvents:function(){this.own(b(this.mycontentMapTable,"select",f.hitch(this,this._onMapSelected)));this.own(b(this.organizationMapTable,"select",f.hitch(this,this._onMapSelected)));this.own(b(this.groupMapTable,"select",f.hitch(this,this._onMapSelected)));this.own(b(this.publicPortalMapTable,"select",f.hitch(this,this._onMapSelected)));this.own(b(this.publicOnlineMapTable,"select",f.hitch(this,
this._onMapSelected)))},_onMapSelected:function(a){if(a=a&&a.selectedNode)this.mycontentMapTable.unselect(),this.organizationMapTable.unselect(),this.groupMapTable.unselect(),this.publicPortalMapTable.unselect(),this.publicOnlineMapTable.unselect(),c.addClass(a,"selected")},_updateUIbySignIn:function(){c.addClass(this.signinSection,"hidden");var b=a(".organization-tab-content-main,.group-tab-content-main,.mycontent-tab-content-main",this.domNode);this.portal.haveSignIn()?b.removeClass("hidden"):(b.addClass("hidden"),
this.isPublicTabShow||c.removeClass(this.signinSection,"hidden"))},_initPortalRadio:function(){g.combineRadioCheckBoxWithLabel(this.portalPublicRaido,this.portalNameLabel);g.combineRadioCheckBoxWithLabel(this.onlinePublicRaido,this.onlineNameLabel);var a=this._getPortalUrl(),a=m.getServerByUrl(a);m.isArcGIScom(a)?(this.portalPublicRaido.disabled=!0,this.onlinePublicRaido.checked=!0,c.addClass(this.portalPublicRaido,"hidden"),c.addClass(this.portalNameLabel,"hidden")):(this.portalPublicRaido.disabled=
!1,this.portalPublicRaido.checked=!0,this.portalNameLabel.innerHTML=a)},_initSearchQuery:function(){var a="esri_"+(h.locale&&h.locale.slice(0,2)||"en").toLowerCase(),b=d.filter("esri_he esri_fr esri_ja esri_nl esri_th esri_tr esri_nb esri_ro esri_it esri_pl esri_po esri_ru esri_pt esri_en esri_ar esri_et esri_es esri_ko esri_cs esri_da esri_zh esri_sv esri_lt esri_fi esri_lv esri_de esri_vi".split(" "),f.hitch(this,function(b){return b!==a})),c="";d.forEach(b,f.hitch(this,function(a){c+=" -owner:"+
a+" "}));b=" ";this.portal.user&&this.portal.user.orgId&&(b=" orgid:"+this.portal.user.orgId+" ");b=b+this._webMapQueryString+" AND access:public "+c;this._allPublicPortalQuery=this._getQuery({q:b});this._filterPublicPortalQuery=this._getQuery({q:b});this._allPublicOnlineQuery=this._getQuery({q:'(group:"c755678be14e4a0984af36a15f5b643e" OR  group:"b8787a74b4d74f7fb9b8fac918735153") '+this._webMapQueryString+" AND access:public"});this._filterPublicOnlineQuery=this._getQuery({q:this._webMapQueryString+
" AND access:public"});this._allOrganizationQuery=this._getQuery();this._filterOrganizationQuery=this._getQuery();this._allMyContentQuery=this._getQuery();this._filterMyContentQuery=this._getQuery();this._allGroupQuery=this._getQuery();this._filterGroupQuery=this._getQuery()},_getQuery:function(a){return f.mixin({start:1,num:16,f:"json"},a||{})},_getPortalUrl:function(){return m.getStandardPortalUrl(window.portalUrl)},_initMapTables:function(){var a=this._getPortalUrl();this.portalPublicRaido.disabled||
(this.publicPortalMapTable.set("portalUrl",a),this.publicPortalMapTable.set("filteredQuery",this._filterPublicPortalQuery));this.publicOnlineMapTable.set("portalUrl",window.location.protocol+"//www.arcgis.com");this.publicOnlineMapTable.set("filteredQuery",this._filterPublicOnlineQuery)},_initPublic:function(){this.own(b(this.portalPublicRaido,"click",f.hitch(this,function(){this._onPublicRaidoClicked();this._searchPublicByRadio()})));this.own(b(this.onlinePublicRaido,"click",f.hitch(this,function(){this._onPublicRaidoClicked();
this._searchPublicByRadio()})));this._onPublicRaidoClicked()},_onPublicRaidoClicked:function(){this.portalPublicRaido.checked?(this.publicPortalMapTable.show(),this.publicOnlineMapTable.hide()):this.onlinePublicRaido.checked&&(this.publicPortalMapTable.hide(),this.publicOnlineMapTable.show())},_onPublicSearch:function(){var a=this._getSortFieldAndSortOrder(this.publicSelect),b=this.publicSearch.getValue();(b=b&&f.trim(b))?(this.publicPortalMapTable.showFilterMapsSection(),this.publicOnlineMapTable.showFilterMapsSection(),
this._filterPublicPortalQuery.q=b+this._allPublicPortalQuery.q,this._filterPublicPortalQuery.start=1,f.mixin(this._filterPublicPortalQuery,a),this.publicPortalMapTable.searchFilteredMaps(this._filterPublicPortalQuery),this._filterPublicOnlineQuery.q=b+this._webMapQueryString+" AND access:public",this._filterPublicOnlineQuery.start=1,f.mixin(this._filterPublicOnlineQuery,a),this.publicOnlineMapTable.searchFilteredMaps(this._filterPublicOnlineQuery)):(this.publicPortalMapTable.showAllMapsSection(),
this.publicOnlineMapTable.showAllMapsSection(),this._allPublicPortalQuery.start=1,f.mixin(this._allPublicPortalQuery,a),this.publicPortalMapTable.showAllMapsSection(this._allPublicPortalQuery),this._allPublicOnlineQuery.start=1,f.mixin(this._allPublicOnlineQuery,a),this.publicOnlineMapTable.showAllMapsSection(this._allPublicOnlineQuery))},_searchPublic:function(){this.tab.getSelectedTitle()===this.nls.publicMap&&(this.publicTabNode.isSearched||this._searchPublicByRadio())},_searchPublicByRadio:function(){this.portalPublicRaido.checked?
this.publicPortalMapTable.isSearched||(this._onPublicSearch(),this.publicPortalMapTable.isSearched=!0):this.publicOnlineMapTable.isSearched||(this._onPublicSearch(),this.publicOnlineMapTable.isSearched=!0)},_initPrivate:function(){this._resetPortalMaps();this.own(e.subscribe("userSignIn",f.hitch(this,this._onSignIn)));this.own(e.subscribe("userSignOut",f.hitch(this,this._onSignOut)));this.own(b(this.groupsSelect,"change",f.hitch(this,this._onGroupsSelectChange)));var a=m.getServerByUrl(this._getPortalUrl());
m.isArcGIScom(a)&&(a="ArcGIS.com");this.portal.haveSignIn()&&this._onSignIn()},_getSortFieldAndSortOrder:function(a){var b={};a=a.get("value");b.sortField=a;"modified"===a?b.sortOrder="desc":"numviews"===a?b.sortOrder="desc":"avgrating"===a?b.sortOrder="desc":"title"===a?b.sortOrder="asc":"owner"===a&&(b.sortOrder="asc");return b},_onOrganizationSearch:function(){var a=this._getSortFieldAndSortOrder(this.organizationSelect),b=this.organizationSearch.getValue();(b=b&&f.trim(b))?(this._filterOrganizationQuery.q=
b+" "+this._allOrganizationQuery.q,this._filterOrganizationQuery.start=1,f.mixin(this._filterOrganizationQuery,a),this.organizationMapTable.searchFilteredMaps(this._filterOrganizationQuery)):(this._allOrganizationQuery.start=1,f.mixin(this._allOrganizationQuery,a),this.organizationMapTable.showAllMapsSection(this._allOrganizationQuery))},_onMyContentSearch:function(){var a=this._getSortFieldAndSortOrder(this.mycontentSelect),b=this.mycontentSearch.getValue();(b=b&&f.trim(b))?(this._filterMyContentQuery.q=
b+" "+this._allMyContentQuery.q,this._filterMyContentQuery.start=1,f.mixin(this._filterMyContentQuery,a),this.mycontentMapTable.searchFilteredMaps(this._filterMyContentQuery)):(this._allMyContentQuery.start=1,f.mixin(this._allMyContentQuery,a),this.mycontentMapTable.showAllMapsSection(this._allMyContentQuery))},_onGroupSearch:function(){var a=this._getSortFieldAndSortOrder(this.groupSelect),b=this.groupSearch.getValue();(b=b&&f.trim(b))?(this._filterGroupQuery.q=b+" "+this._allGroupQuery.q,this._filterGroupQuery.start=
1,f.mixin(this._filterGroupQuery,a),this.groupMapTable.searchFilteredMaps(this._filterGroupQuery)):(this._allGroupQuery.start=1,f.mixin(this._allGroupQuery,a),this.groupMapTable.showAllMapsSection(this._allGroupQuery))},_onSignIn:function(){this._updateUIbySignIn();this._signIn||(this._signIn=!0,this.portal.getUser().then(f.hitch(this,function(a){this.domNode&&(this._resetPortalMaps(),this._searchOrganization(a),this._searchMyContent(a),this._searchGroups(a))})))},_onSignOut:function(){this._signIn=
!1;this._resetPortalMaps();this._updateUIbySignIn()},_resetPortalMaps:function(){this.organizationMapTable.clear();this.mycontentMapTable.clear();this._resetGroupsSection()},_searchOrganization:function(a){if(this.tab.getSelectedTitle()===this.nls.myOrganization&&!this.organizationTabNode.isSearched){this.organizationMapTable.clear();a=" orgid:"+a.orgId+" AND "+this._webMapQueryString+" AND (access:org OR access:public) ";var b=this._getPortalUrl();this._allOrganizationQuery=this._getQuery({q:a});
this._filterOrganizationQuery=this._getQuery({q:a});this.organizationMapTable.set("portalUrl",b);this._onOrganizationSearch();this.organizationTabNode.isSearched=!0}},_searchMyContent:function(a){if(this.tab.getSelectedTitle()===this.nls.myContent&&!this.mycontentTabNode.isSearched){this.mycontentMapTable.clear();var b=this._getPortalUrl();a="owner:"+a.username+" AND "+this._webMapQueryString;this._allMyContentQuery=this._getQuery({q:a});this._filterMyContentQuery=this._getQuery({q:a});this.mycontentMapTable.set("portalUrl",
b);this._onMyContentSearch();this.mycontentTabNode.isSearched=!0}},_searchGroups:function(a){if(this.tab.getSelectedTitle()===this.nls.myGroup&&!this.groupTabNode.isSearched){this._resetGroupsSection();c.removeClass(this.groupsSection,"hidden");a=a.getGroups();if(0<a.length){c.removeClass(this.groupSearchSection,"hidden");this.groupMapTable.show();c.empty(this.groupsSelect);for(var b=0;b<a.length;b++){var d=a[b];c.create("option",{value:d.id,innerHTML:d.title},this.groupsSelect)}this._onGroupsSelectChange()}this._updateUIbyGroups(a.length);
this.groupTabNode.isSearched=!0}},_resetGroupsSection:function(){c.addClass(this.groupsSection,"hidden");c.empty(this.groupsSelect);c.create("option",{value:"nodata",innerHTML:this.nls.noneGroups},this.groupsSelect);this.groupMapTable.clear();c.addClass(this.groupSearchSection,"hidden");this.groupMapTable.hide();this._updateUIbyGroups(0)},_updateUIbyGroups:function(a){0===a?c.setStyle(this.groupsSection,"top","15px"):c.setStyle(this.groupsSection,"top","70px")},_onGroupsSelectChange:function(){var a=
this.groupsSelect.value;this.groupMapTable.clear();if("nodata"===a)c.addClass(this.groupSearch,"hidden"),this.groupMapTable.hide();else{c.addClass(this.groupSearch,"hidden");this.groupMapTable.show();var b=this._getPortalUrl(),a="group:"+a+" AND "+this._webMapQueryString;this._allGroupQuery=this._getQuery({q:a});this._filterGroupQuery=this._getQuery({q:a});this.groupMapTable.set("portalUrl",b);this._onGroupSearch()}},_onMyContentRefreshIconClicked:function(){this._onMyContentSearch()},_onOrgRefreshIconClicked:function(){this._onOrganizationSearch()},
_onGroupRefreshIconClicked:function(){this._onGroupSearch()},_onPublicRefreshIconClicked:function(){this._onPublicSearch()},getSelectedMapItem:function(){var b=null,c=a(".map-item-bg.selected",this.domNode);0<c.length&&(b=c[0].parentNode.item);return b}})})},"builder/plugins/map-config/MapTable":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./MapTable.html dojo/Evented dojo/_base/lang dojo/_base/array dojo/_base/html dojo/_base/Deferred dojo/query dojo/on jimu/utils builder/portalUtils jimu/portalUrlUtils jimu/dijit/LoadingIndicator dojo/i18n!./nls/strings".split(" "),
function(k,e,p,q,n,l,h,f,d,c,a,b,g,u,m,r,t){return k([e,p,q,l],{templateString:n,baseClass:"map-table",query:null,filteredQuery:null,portalUrl:null,hidden:!1,nls:null,originalSelectedId:null,type:"",postMixInProperties:function(){this.nls=t},postCreate:function(){this.inherited(arguments);(this.hidden=!0===this.hidden)&&this.hide();this.portalUrl&&(this.portalUrl=m.getStandardPortalUrl(this.portalUrl));this.own(b(this.allMapsTableDiv,"scroll",h.hitch(this,this._onAllMapsSectionScroll)));this.own(b(this.filteredMapsTableDiv,
"scroll",h.hitch(this,this._onFilteredMapsSectionScroll)));this._showAllMapsSection();this.searchAllMaps()},show:function(){d.removeClass(this.domNode,"hidden")},hide:function(){d.addClass(this.domNode,"hidden")},searchAllMaps:function(a){this._showAllMapsSection();a&&(this.query=h.clone(a),this.query.start=1,this.clearAllMapsSection());this.portalUrl&&this.query&&0<this.query.start&&(this.allMapsShelter.show(),u.getPortal(this.portalUrl).queryItems(this.query).then(h.hitch(this,function(a){this.domNode&&
(this.allMapsShelter.hide(),this.query.start=a.nextStart,this._createMapItems(a,this.allMapsTbody))}),h.hitch(this,function(a){console.error(a);this.domNode&&this.allMapsShelter.hide()})))},searchFilteredMaps:function(a){this._showFilterMapsSection();a&&(this.filteredQuery=h.clone(a),this.filteredQuery.start=1,this.clearFilteredMapsSection());this.portalUrl&&this.filteredQuery&&0<this.filteredQuery.start&&(this.filteredMapsShelter.show(),u.getPortal(this.portalUrl).queryItems(this.filteredQuery).then(h.hitch(this,
function(b){this.domNode&&(this._showFilterMapsSection(),a&&this.clearFilteredMapsSection(),this.filteredQuery.start=b.nextStart,this._createMapItems(b,this.filteredMapsTbody),this._filterMapCallback())}),h.hitch(this,function(a){console.error(a);this.domNode&&this._filterMapCallback()})))},_filterMapCallback:function(){this.filteredMapsShelter.hide();0<this._getWebMapCount(this.filteredMapsTbody)?(d.removeClass(this.filteredMapsTableDiv,"hidden"),d.addClass(this.searchNoneTipSection,"hidden")):(d.addClass(this.filteredMapsTableDiv,
"hidden"),d.removeClass(this.searchNoneTipSection,"hidden"))},clear:function(){this.clearAllMapsSection();this.clearFilteredMapsSection()},clearAllMapsSection:function(){d.empty(this.allMapsTbody)},clearFilteredMapsSection:function(){d.empty(this.filteredMapsTbody)},showAllMapsSection:function(a){this._showAllMapsSection();a&&this.searchAllMaps(a)},_showAllMapsSection:function(){d.removeClass(this.allMapsSection,"hidden");d.addClass(this.filteredMapsSection,"hidden")},showFilterMapsSection:function(a){this._showFilterMapsSection();
a&&this.searchFilteredMaps(a)},_showFilterMapsSection:function(){d.addClass(this.allMapsSection,"hidden");d.removeClass(this.filteredMapsSection,"hidden");d.removeClass(this.filteredMapsTableDiv,"hidden");d.addClass(this.searchNoneTipSection,"hidden")},_onAllMapsSectionScroll:function(){this._isScrollToBottom(this.allMapsTableDiv)&&this.searchAllMaps()},_onFilteredMapsSectionScroll:function(){this._isScrollToBottom(this.filteredMapsTableDiv)&&this.searchFilteredMaps()},_isScrollToBottom:function(a){return g.isScrollToBottom(a)},
_createMapItems:function(b,c){b=f.filter(b.results,h.hitch(this,function(a){return a.type.toLowerCase()===this.type.toLowerCase()}));if(0!==b.length){var e={},g,k=a("td.empty",c),m;if(0<k.length){var l=Math.min(b.length,k.length),n=b.splice(0,l);for(m=0;m<l;m++){var p=k[m];g=this._createMapItem(n[m]);e[g.item.id]=g;d.place(g,p);d.removeClass(p,"empty")}}if(0!==b.length){k=Math.ceil(b.length/5);for(m=0;m<k;m++)for(g=d.toDom("\x3ctr\x3e\x3ctd\x3e\x3c/td\x3e\x3ctd\x3e\x3c/td\x3e\x3ctd\x3e\x3c/td\x3e\x3ctd\x3e\x3c/td\x3e\x3ctd\x3e\x3c/td\x3e\x3c/tr\x3e"),
d.place(g,c),l=a("td",g),n=0;n<l.length;n++)p=l[n],(g=b[5*m+n])?(g=this._createMapItem(g),e[g.item.id]=g,d.place(g,p)):d.addClass(p,"empty");!this.getSelectedMapItem()&&this.appConfig&&this.appConfig.map.itemId&&(g=e[this.appConfig.itemId])&&(c=a(".map-item-bg",g),d.addClass(c,"selected"))}}},_getWebMapCount:function(b){return a(".map-item-div",b).length},_createMapItem:function(c){var e=d.toDom("\x3cdiv class\x3d'map-item-div'\x3e\x3cdiv class\x3d'map-item-bg'\x3e\x3cdiv class\x3d'map-item-thumbnail jimu-auto-vertical'\x3e\x3cdiv class\x3d'none-thumbnail-tip jimu-auto-vertical-content'\x3e\x3c/div\x3e\x3c/div\x3e\x3ca target\x3d'_blank' class\x3d'map-item-detail-icon'\x3e\x3c/a\x3e\x3c/div\x3e\x3cspan class\x3d'map-item-title'\x3e\x3c/span\x3e\x3c/div\x3e"),
f=a(".map-item-bg",e)[0],k=a(".map-item-thumbnail",e)[0],m=a(".map-item-title",e)[0],l=a(".map-item-detail-icon",e)[0];a(".none-thumbnail-tip",e);l.href=c.detailsPageUrl;l.title=this.nls.viewItemDetails||"";e.item=c;l=c.thumbnailUrl||g.getDefaultWebMapThumbnail();d.setStyle(k,"backgroundImage","url("+l+")");this.own(b(f,"click",h.hitch(this,this._onMapItemBgClick)));m.innerHTML=c.title;m.title=c.title;return e},unselect:function(){a(".map-item-bg",this.domNode).removeClass("selected")},_onMapItemBgClick:function(a){a=
a.target||a.srcElement;var b=null;d.hasClass(a,"map-item-thumbnail")?b=a.parentNode:d.hasClass(a,"none-thumbnail-tip")&&(b=a.parentNode.parentNode);b&&d.hasClass(b,"map-item-bg")&&(this.unselect(),d.addClass(b,"selected"),this.emit("select",{mapTable:this,selectedNode:b}))},getSelectedMapItem:function(){var b=null,c=a(".map-item-bg.selected",this.domNode);0<c.length&&(b=c[0].parentNode.item);return b}})})},"builder/plugins/map-config/CustomizeScale":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./CustomizeScale.html dojo/query dojo/_base/lang dojo/_base/array dojo/_base/html jimu/utils jimu/dijit/Message dijit/form/NumberTextBox".split(" "),
function(k,e,p,q,n,l,h,f,d,c,a,b){return k([e,p,q],{templateString:n,baseClass:"mapconfig-customize-scale",map:null,postCreate:function(){this.inherited(arguments);this._initSelf()},_initSelf:function(){this.scaleNumberBox=new b({placeholder:this.nls.scale,intermediateChanges:!0,trim:!0,constraints:{min:1,pattern:"###############0.################"},style:"width:550px;height:100%;"});d.addClass(this.scaleNumberBox.domNode,"jimu-float-leading");this.scaleNumberBox.placeAt(this.scaleInputDiv,"first");
var a=this.getLodsFromMap();this._resetLodListByLods(a)},getLodsFromMap:function(){var a=[];this.map._params&&this.map._params.lods&&(a=f.map(this.map._params.lods,h.hitch(this,function(a){return a.toJson()})));return a},_getLodsFromBasemapLayer:function(){var a=[],b=this.map.getLayer(this.map.layerIds[0]);b&&b.tileInfo&&b.tileInfo.lods&&(a=f.map(b.tileInfo.lods,h.hitch(this,function(a){return{level:a.level,resolution:a.resolution,scale:a.scale}})));return a},getLodsFromListNode:function(){for(var a=
this._getLodItems(),b=[],c=null,d=0;d<a.length;d++)c=a[d].lod,b.push({level:c.level,scale:c.scale,resolution:c.resolution});return b},_resetLodListByLods:function(a){d.empty(this.listNode);f.forEach(a,h.hitch(this,function(a){a=this._createLodItem(a);d.place(a,this.listNode)}))},_createLodItem:function(a){var b=d.create("div",{innerHTML:c.localizeNumber(a.scale),"class":"lod-item"});b.lod=a;return b},_getLodItems:function(){return l(".lod-item",this.listNode)},_getSelectedLodItem:function(){var a=
null,b=l(".selected",this.listNode);0<b.length&&(a=b[0]);return a},_selectLodItem:function(a){this._removeSelectedClass();d.addClass(a,"selected");d.addClass(this.btnDelete,"enabled-operation");a.previousSibling||d.setStyle(a,"borderTop","0")},_removeSelectedClass:function(){l(".lod-item",this.listNode).removeClass("selected");d.removeClass(this.btnDelete,"enabled-operation")},_onLodListClicked:function(a){a=a.target||a.srcElement;d.hasClass(a,"lod-item")&&this._selectLodItem(a)},_onBtnAddClicked:function(){if(this.scaleNumberBox.validate()){var a=
this.scaleNumberBox.get("value");this.scaleNumberBox.set("displayedValue","");var b=this._getLodItems();if(0!==b.length&&!f.some(b,h.hitch(this,function(b){return b.lod.scale===a}))){var c=b.length-1,e=b[0].lod,k=b[c].lod,l=null,l={level:null,resolution:e.resolution/e.scale*a,scale:a};if(l.scale>e.scale)l.level=e.level-1,l=this._createLodItem(l),d.place(l,this.listNode,"first");else if(l.scale<k.scale)l.level=k.level+1,l=this._createLodItem(l),d.place(l,this.listNode);else for(var n=null,e=null,k=
c;1<=k;k--)if(n=b[k],e=b[k-1],l.scale>n.lod.scale&&l.scale<e.lod.scale){l.level=n.lod.level;l=this._createLodItem(l);d.place(l,e,"after");for(l=k;l<=c;l++)b[l].lod.level+=1;break}}}},_onBtnDeleteClicked:function(){var b=this._getSelectedLodItem();if(b)if(1===this.getLodsFromListNode().length)new a({message:this.nls.atLeastOneScale});else{var c=b;if(!b.previousSibling)for(;b.nextSibling;)b=b.nextSibling,--b.lod.level;d.destroy(c);this._removeSelectedClass()}},_onBtnResetClicked:function(){this._removeSelectedClass();
var a=this._getLodsFromBasemapLayer();this._resetLodListByLods(a)}})})},"builder/plugins/popup-actions/configmode-switch/_build-generate_module":function(){define(["builder/plugins/popup-actions/configmode-switch/Plugin","dojo/i18n!builder/plugins/popup-actions/configmode-switch/nls/strings"],function(){})},"builder/plugins/popup-actions/configmode-switch/Plugin":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/topic","builder/BasePlugin"],function(k,e,p,q){return k([q],{baseClass:"plugin-app-actions-popup-saveas",
disabled:null,postCreate:function(){this.inherited(arguments);this._bindEvent();this.label=this.nls.advanceConfigLabel;this.isAdvance=!1},onClick:function(){var e=this.pluginManager.getPluginByName("app-config");this.isAdvance?(this.isAdvance=!1,this.label=this.nls.advanceConfigLabel,e.switchToTemplateConfigPart()):(this.isAdvance=!0,this.label=this.nls.templateConfigLabel,e.switchToPreviewConfig())},_bindEvent:function(){this.own(p.subscribe("app/appConfigLoaded",e.hitch(this,this._setAppConfig)))},
_setAppConfig:function(e){this.appConfig=e;e.templateConfig&&e.isTemplateApp||e.templateConfig&&e._appData?(this.visible=!0,this.isAdvance=!1):(this.visible=!1,this.isAdvance=!0)}})})},"builder/plugins/popup-actions/popup-agoltemplate/_build-generate_module":function(){define(["builder/plugins/popup-actions/popup-agoltemplate/Plugin","dojo/text!builder/plugins/popup-actions/popup-agoltemplate/css/style.css","dojo/i18n!builder/plugins/popup-actions/popup-agoltemplate/nls/strings"],function(){})},"builder/plugins/popup-actions/popup-agoltemplate/Plugin":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/promise/all dojo/Deferred dojo/on dojo/topic dojo/_base/html dojo/json builder/BasePlugin builder/serviceUtils builder/portalUtils jimu/portalUrlUtils jimu/dijit/LoadingShelter jimu/dijit/Popup jimu/Role builder/dijit/template-config/Template builder/dijit/template-config/utils builder/dijit/TemplateAttributes".split(" "),
function(k,e,p,q,n,l,h,f,d,c,a,b,g,u,m,r,t,v,y){return k([c],{baseClass:"plugin-app-actions-popup-template",disabled:null,postMixInProperties:function(){this.inherited(arguments);this.nls=p.mixin(this.nls,builderNls)},constructor:function(){"HTML"===window.appInfo.id||"HTML3D"===window.appInfo.id?this.disabled=!0:b.getPortal(window.portalUrl).getUser().then(p.hitch(this,function(a){this.user=a;var b=new r({id:a.roleId?a.roleId:a.role,role:a.role});a.privileges&&b.setPrivileges(a.privileges);b.isAdmin()?
this.disabled=!1:a.username===window.appInfo.appOwner&&(window.isXT||b.canCreateItem())?this.disabled=!1:this.disabled=!0}),p.hitch(this,function(a){this.disabled=!0;console.log(a)}))},postCreate:function(){this.inherited(arguments);this.label=this.nls.exportTitle;var a=this.pluginManager.getPluginByName("startup");this.shelter=(new u({hidden:!0})).placeAt(a.domNode);this._bindEvent()},onClick:function(){if(!this.disabled){var c=new n,d=window.appInfo.id;this.shelter.show();window.isXT?a.getAppInfo(d).then(p.hitch(this,
function(a){c.resolve(a)}),function(){c.reject()}):b.getPortal(g.getPortalUrlFromLocation()).getItemData(d).then(p.hitch(this,function(a){a=a.agolTemplateInfo;!a&&this.appConfig.agolTemplateJson&&(a={itemId:null,json:this.appConfig.agolTemplateJson});a={id:d,name:this.pluginManager.getPluginByName("header").getAppName(),agolTemplateInfo:a};c.resolve(a)}),function(){c.reject()});var e=v.loadAllWidgetConfigs(p.clone(this.appConfig)),f=this.pluginManager.getPluginByName("app-actions.save-app").saveApp();
q({app:c,appConfig:e,saveApp:f}).then(p.hitch(this,function(a){var b=a.app;this._createAGOLTemplate(b,a.appConfig);this._createAGOLTemplatePrview();this.popupDlg(b);this.shelter.hide()}),p.hitch(this,function(a){console.error(a.message);this.shelter.hide()}))}},popupDlg:function(a){var b=f.create("div",{"class":"template-popup-content"}),c=f.getMarginBox(window.document.body).w,c=.9*c;1024>c&&(c=1024);this.popup=new m({content:b,"class":"plugin-app-actions-template-popup",container:"main-page",titleLabel:this.nls.title,
width:c,height:668,buttons:[{label:this.nls.exportStr,onClick:p.hitch(this,this._onExportClick)},{label:this.nls.saved,onClick:p.hitch(this,this._onSaveClick)},{label:this.nls.close,classNames:["jimu-btn-vacation"],onClick:p.hitch(this,this._onCancelClick)}]});this._initPopup(a);this.agoltemplateDijit.loading.placeAt(this.popup.domNode);this.popup.configPart=f.create("div",{"class":"config-part jimu-float-leading"},b);a=f.create("div",{"class":"privew-part-box jimu-float-leading"},b);a=f.create("div",
{"class":"privew-part-inset-box"},a);this.popup.previewPart=f.create("div",{"class":"privew-part"},a);f.place(this.agoltemplateDijit.domNode,this.popup.configPart);f.place(this.agoltemplatePrivew.domNode,this.popup.previewPart)},_onExportClick:function(a){window.isXT?f.hasClass(this.popup.exportDrawBoxDomNode,"export-draw-box-hiden")?f.removeClass(this.popup.exportDrawBoxDomNode,"export-draw-box-hiden"):f.addClass(this.popup.exportDrawBoxDomNode,"export-draw-box-hiden"):this.agoltemplateDijit.exportOrUpdateAGOLTemplate();
a.stopPropagation()},_onExportAGOLTemplateClick:function(a){this._hasCreateItemPrivilege()?this.agoltemplateDijit.exportOrUpdateAGOLTemplate():a.stopPropagation()},_onExportWABTemplateClick:function(){this.agoltemplateDijit.exportWABTemplate()},_onSaveClick:function(){f.setAttr(this.popup.enabledButtons[1],"innerHTML",this.nls.saving);this.agoltemplateDijit.saveAgolTemplate().then(p.hitch(this,function(){this._disablePopupButton(1,this.nls.saved)}))},_onCancelClick:function(){if(this.agoltemplateDijit.hasChanged())var a=
new m({content:"\x3cdiv\x3e\x3cimg class\x3d'alert-image jimu-float-leading'src\x3d'"+this.folderUrl+"/css/images/alert.png' style\x3d'margin-left:20px;margin-right:20px;'\x3e\x3c/img\x3e\x3cspan style\x3d'display:inline-block;width:285px'\x3e"+this.nls.unSaveMeg+"\x3c/span\x3e\x3c/div\x3e",titleLabel:this.nls.cancelPopupTitle,width:"425",autoHeight:!0,buttons:[{label:this.nls.save,onClick:p.hitch(this,function(){this.agoltemplateDijit.saveAgolTemplate().then(p.hitch(this,function(){a.close();this._closePopup();
this.agoltemplateDijit.destroyRecursive()}))})},{label:this.nls.doNotSave,onClick:p.hitch(this,function(){a.close();this._closePopup();this.agoltemplateDijit.destroyRecursive()})},{label:this.nls.cancel,classNames:["jimu-btn-vacation"],onClick:p.hitch(this,function(){a.close()})}]});else this._closePopup(),this.agoltemplateDijit.destroyRecursive()},_closePopup:function(){this.popup&&(this.popup.closeTemplate=!0,this.popup.close())},_initPopup:function(a){this.popup.disableButton(1);this.popup.onClose=
p.hitch(this,function(){if(this.popup.closeTemplate)return!0;this._onCancelClick();return!1});if(window.isXT){this.popup.exportDrawBoxDomNode=f.create("div",{"class":"export-draw-box export-draw-box-hiden"});var c;c=this._hasCreateItemPrivilege()?"export-draw-box-btn":"export-draw-box-btn export-draw-box-btn-disable";this.popup.exportAGOLTemplateDomNode=f.create("div",{"class":c,innerHTML:this.nls.exportAGOLTemplate},this.popup.exportDrawBoxDomNode);this.popup.exportWABTemplateDomNode=f.create("div",
{"class":"export-draw-box-btn",innerHTML:this.nls.exportWABTemplate},this.popup.exportDrawBoxDomNode);f.addClass(this.popup.domNode,"plugin-app-actions-template-popup-for-xt");f.addClass(this.popup.enabledButtons[0],"export-btn");f.place(this.popup.exportDrawBoxDomNode,this.popup.enabledButtons[0]);this.popup.own(l(this.popup,"click",p.hitch(this,function(){f.addClass(this.popup.exportDrawBoxDomNode,"export-draw-box-hiden")})));this.popup.own(l(this.popup.exportAGOLTemplateDomNode,"click",p.hitch(this,
this._onExportAGOLTemplateClick)));this.popup.own(l(this.popup.exportWABTemplateDomNode,"click",p.hitch(this,this._onExportWABTemplateClick)))}else this._hasCreateItemPrivilege()||this.popup.disableButton(0);a.agolTemplateInfo&&a.agolTemplateInfo.itemId&&b.getPortal(window.portalUrl).getItemById(a.agolTemplateInfo.itemId).then(p.hitch(this,function(){window.isXT?f.setAttr(this.popup.exportAGOLTemplateDomNode,"innerHTML",this.nls.updateAGOLTemplate):f.setAttr(this.popup.enabledButtons[0],"innerHTML",
this.nls.update)}),p.hitch(this,function(){a.agolTemplateInfo.itemId=null;window.isXT?f.setAttr(this.popup.exportAGOLTemplateDomNode,"innerHTML",this.nls.exportAGOLTemplate):f.setAttr(this.popup.enabledButtons[0],"innerHTML",this.nls.exportStr)}))},_disablePopupButton:function(a,b){this.popup.disableButton(a);f.setAttr(this.popup.disabledButtons[a],"innerHTML",b)},_enablePopupButton:function(a,b){this.popup.enableButton(a);f.setAttr(this.popup.enabledButtons[a],"innerHTML",b)},_createAGOLTemplate:function(a,
b){var c;c=a.agolTemplateInfo&&a.agolTemplateInfo.json?d.parse(a.agolTemplateInfo.json):b.templateConfig?b.templateConfig:null;this.agoltemplateDijit=new t({appConfig:b,appInfo:a,templateConfig:c});this.own(this.agoltemplateDijit.on("hasChanged",p.hitch(this,function(a){a?this._enablePopupButton(1,this.nls.save):this._disablePopupButton(1,this.nls.saved);this._refreshAGOLTempaltePrview()})));this.own(this.agoltemplateDijit.on("exported",p.hitch(this,function(a){a&&(window.isXT&&this.popup.exportAGOLTemplateDomNode?
f.setAttr(this.popup.exportAGOLTemplateDomNode,"innerHTML",this.nls.updateAGOLTemplate):this._enablePopupButton(0,this.nls.update))})));this.agoltemplateDijit.startup()},_createAGOLTemplatePrview:function(){var a;this.agoltemplateDijit&&(a=this.agoltemplateDijit.getTemplateConfig());this.agoltemplatePrivew=new y({templateConfig:a});this.agoltemplatePrivew.startup()},_refreshAGOLTempaltePrview:function(){this.agoltemplatePrivew&&this.agoltemplatePrivew.destroy();this._createAGOLTemplatePrview();f.place(this.agoltemplatePrivew.domNode,
this.popup.previewPart)},_bindEvent:function(){this.own(h.subscribe("app/appConfigLoaded",p.hitch(this,this._setAppConfig)));this.own(h.subscribe("app/appConfigChanged",p.hitch(this,this._setAppConfig)))},_setAppConfig:function(a){this.appConfig=a;this.visible=a.templateConfig&&a.isTemplateApp||!a.templateConfig?!0:!1},_hasCreateItemPrivilege:function(){var a=!1;this.user?e.forEach(this.user.privileges,function(b){0<=b.indexOf("createItem")&&(a=!0)},this):a=!0;return a}})})},"builder/plugins/popup-actions/popup-saveas/_build-generate_module":function(){define(["builder/plugins/popup-actions/popup-saveas/Plugin",
"dojo/i18n!builder/plugins/popup-actions/popup-saveas/nls/strings"],function(){})},"builder/plugins/popup-actions/popup-saveas/Plugin":function(){define("dojo/_base/declare dojo/_base/lang builder/BasePlugin jimu/Role jimu/portalUrlUtils builder/portalUtils".split(" "),function(k,e,p,q,n,l){return k([p],{baseClass:"plugin-app-actions-popup-saveas",disabled:null,constructor:function(){if("HTML"===window.appInfo.id||"HTML3D"===window.appInfo.id)this.disabled=!0;else if(window.isXT)this.disabled=!1;
else{var h=n.getStandardPortalUrl(window.portalUrl);l.getPortal(h).getUser().then(e.hitch(this,function(e){var d=new q({id:e.roleId?e.roleId:e.role,role:e.role});e.privileges&&d.setPrivileges(e.privileges);d.canCreateItem()||(this.disabled=!0)}),e.hitch(this,function(){this.disable=!0}))}},postCreate:function(){this.inherited(arguments);this.label=this.nls.label},onClick:function(){if(!this.disabled){var h=this.pluginManager.getExtensions("startup.creation-entry")[0];this.pluginManager.loadPlugin(this.pluginsMeta[h.pluginName]).then(e.hitch(this,
function(e){e.popupSaveAsDlg(this.nls.saveAsTitle,window.appInfo.id,window.appConfig)}))}}})})},"builder/plugins/popup-actions/popup-share/_build-generate_module":function(){define(["builder/plugins/popup-actions/popup-share/Plugin"],function(){})},"builder/plugins/popup-actions/popup-share/Plugin":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/on dojo/keys jimu/dijit/Popup builder/BasePlugin jimu/portalUrlUtils jimu/dijit/ShareOptions jimu/dijit/ShareLink dojo/topic dojo/query jimu/utils".split(" "),
function(k,e,p,q,n,l,h,f,d,c,a,b){return k([h],{baseClass:"plugin-app-actions-popup-share",disabled:null,_isShowFindLocation:!0,postCreate:function(){this.inherited(arguments);this.label=window.jimuNls.common.share;this.own(a.subscribe("app/appConfigChanged",e.hitch(this,this._onAppConfigLoadedOrChanged)));this.own(a.subscribe("app/appConfigLoaded",e.hitch(this,this._onAppConfigLoadedOrChanged)));this.own(a.subscribe("ShareOptions/onClickEveryone",e.hitch(this,function(a){if(this.shareLink&&this.shareLink.onShareToPublicChanged)this.shareLink.onShareToPublicChanged(a)})));
this.own(a.subscribe("ShareLink/onHideContainer",e.hitch(this,function(){this.hide()})));this.own(a.subscribe("ShareLink/onShowContainer",e.hitch(this,function(){this.show()})));this.own(a.subscribe("ShareLink/onHideLinkOptions",e.hitch(this,function(){this._changeBtnsByShareLink("hide")})));this.own(a.subscribe("ShareLink/onShowLinkOptions",e.hitch(this,function(){this._changeBtnsByShareLink("show")})))},onClick:function(){this.disabled||this.popupDlg()},_onAppConfigLoadedOrChanged:function(a){this._isShowFindLocation=
this._findSearchWidget(a);this.shareLink&&this.shareLink.updateShareLinkOptionsUI({isShowFindLocation:this._isShowFindLocation})},_findSearchWidget:function(a){a=a.getConfigElementsByName("Search");return 0<a.length&&a[0].visible},popupDlg:function(){var a=this._initContent(),b=this._initPupupBtns(),c=this._initPopupHeight();this.sharePopup=new l({content:a,"class":"share-container",container:"main-page",titleLabel:window.jimuNls.common.share,width:640,height:c,buttons:b});this.shareLink.startup();
this.shareOptions&&this.shareOptions.startup()},_onOkClick:function(){this.shareOptions&&this.shareOptions.share();this.sharePopup.close()},_onCancelClick:function(){this.sharePopup.close()},_initContent:function(){var a=p.create("div",{"class":"template-popup-content"});p.create("div",{"class":"app-name"},a);window.isXT||(this.shareOptions=new d(window.appConfig.portalUrl),this.shareOptions.placeAt(a));this.shareLink=new c({portalUrl:window.appConfig.portalUrl,appTitle:window.appInfo.name,isOnline:f.isOnline(window.top.location.href),
isShowSocialMediaLinks:!0,isSharedToPublic:!1,isShowBackBtn:!1,isShowFindLocation:this._isShowFindLocation});this.shareLink.placeAt(a);return a},_initPupupBtns:function(){var a=[];this.shareOptions&&a.push({label:window.jimuNls.common.ok,key:n.ENTER,isHighLight:!0,onClick:e.hitch(this,this._onOkClick)});a.push({label:window.jimuNls.common.cancel,classNames:["jimu-btn-vacation"],key:n.ESCAPE,onClick:e.hitch(this,this._onCancelClick)});return a},_initPopupHeight:function(){var a=560;this.shareOptions&&
(a=600);return a},_changeBtnsByShareLink:function(a){var b=this.shareOptions?1:0;"hide"===a?(this.sharePopup.setTitleLabel(window.jimuNls.common.share),this.sharePopup.setButtonProps(b,{title:window.jimuNls.common.cancel}),this.sharePopup.setButtonProps(b,{label:window.jimuNls.common.cancel})):"show"===a&&(this.sharePopup.setTitleLabel(window.jimuNls.shareLink.linkOptions),this.sharePopup.setButtonProps(b,{label:window.jimuNls.common.back}),this.sharePopup.setButtonProps(b,{title:window.jimuNls.common.back}),
this._disableShareBtn(),this.own(q.once(this.sharePopup,"Close",e.hitch(this,function(){this.sharePopup.setTitleLabel(window.jimuNls.common.share);this.sharePopup.setButtonProps(b,{title:window.jimuNls.common.cancel});this.sharePopup.setButtonProps(b,{label:window.jimuNls.common.cancel});this._enableShareBtn();this.shareLink._toggleLinkOptions();return!1}))))},_disableShareBtn:function(){this.shareOptions&&this.sharePopup.hideButton(0)},_enableShareBtn:function(){this.shareOptions&&this.sharePopup.showButton(0)},
hide:function(){b("#main-page \x3e .jimu-overlay").style("display","none");b("#main-page \x3e .jimu-popup").style("display","none")},show:function(){b("#main-page \x3e .jimu-overlay").style("display","block");b("#main-page \x3e .jimu-popup").style("display","block")}})})},"jimu/dijit/ShareOptions":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/_base/lang esri/lang dojo/_base/array dojo/dom-style dojo/on dojo/dom dojo/query dojo/topic dojo/text!./templates/ShareOptions.html jimu/shareUtils dijit/form/Textarea dijit/form/CheckBox dijit/layout/BorderContainer".split(" "),
function(k,e,p,q,n,l,h,f,d,c,a,b,g,u){return k([e,p,q],{templateString:g,declaredClass:"jimu.dijit.ShareOptions",postMixInProperties:function(){this.inherited(arguments);this.nls=window.jimuNls.shareOptions},constructor:function(a){this.portalUrl=a},startup:function(){u.getShareInfo(this.portalUrl).then(n.hitch(this,function(a){this._initShow(a);this.own(d(c.byId("share-everyone-check"),"change",n.hitch(this,this.clickEveryone)))}))},_initShow:function(a){this.shareInfo=a;this.shareInfo.items=[this.shareInfo.item];
this.shareInfo.sortField="title";(this.shareInfo.userRole.isAdmin()||this.shareInfo._roleCanUpdateItems&&this.shareInfo._roleCanShare||this.shareInfo._roleCanShareOthersItems)&&this.shareInfo.itemUser?this.showAdmin(this.shareInfo.user.groups,this.shareInfo.itemUser,this.shareInfo.adminGroups):this.shareInfo.user&&u._isUserOwnTheApp(this.shareInfo.user)?this.show(this.shareInfo.user.groups):this.shareInfo.user&&("public"===this.shareInfo.item.access||"shared"===this.shareInfo.item.access||"org"===
this.shareInfo.item.access&&this.shareInfo.currentUser.orgId)?this.showGroups(this.shareInfo.user.groups):this.show(this.shareInfo.user.groups)},clear:function(){c.byId("share-groups-list").innerHTML="";c.byId("share-everyone-check").setAttribute("value",!1);c.byId("share-account-check").setAttribute("value",!1);c.byId("share-groups-check").setAttribute("value",!1);f.set(c.byId("share-everyone-check_div"),"display","none");f.set(c.byId("share-account-check_div"),"display","none");this.shareInfo.shareType=
"item"},showAdmin:function(a,b,c){this.shareInfo.itemUser=b;this.shareInfo.userGroups=h.filter(a||[],n.hitch(this,function(){return!this.shareInfo.item.capabilities||!this.shareInfo.item.capabilities.length}));this.shareInfo.userGroups.sort(n.hitch(this,this._sortFunc));this.shareInfo.adminGroups=this.filterAdminGroups(c);this.checkForAccount("admin")},filterAdminGroups:function(a){if(a){for(var b=[],c=0;c<this.shareInfo.user.groups.length;c++)b.push(this.shareInfo.user.groups[c].id);for(var d=[],
c=0;c<a.length;c++)-1!==h.indexOf(b,a[c].id)||a[c].capabilities&&a[c].capabilities.length||d.push(a[c]);return d}return null},showGroups:function(a){this.shareInfo.userGroups=this.filterOwnedGroups(a);this.shareInfo.userGroups&&this.shareInfo.userGroups.sort(n.hitch(this,this._sortFunc));this.clear();this.shareInfo.shareType="group";this.checkForAccount("group")},filterOwnedGroups:function(a){if(a){for(var b=[],c,d=0;d<a.length;d++)c=a[d],!c.userMembership||"owner"!==c.userMembership.memberType&&
"admin"!==c.userMembership.memberType||c.capabilities&&c.capabilities.length||b.push(c);return b}return null},show:function(a){this.shareInfo.userGroups=this.filterViewOnlyGroups(a);this.shareInfo.userGroups.sort(n.hitch(this,this._sortFunc));this.checkForAccount("item")},filterViewOnlyGroups:function(a){if(a){for(var b=[],c,d=0;d<a.length;d++)c=a[d],c.capabilities&&c.capabilities.length||(!c.userMembership||"owner"!==c.userMembership.memberType&&"admin"!==c.userMembership.memberType)&&l.isDefined(c.isViewOnly)&&
c.isViewOnly||b.push(c);return b}return null},checkForAccount:function(a){c.byId("share-account-check-label").innerHTML=this.shareInfo.organization.name;!this.shareInfo._isCustomRole||this.shareInfo._roleCanShareToOrg||this.shareInfo._roleCanShareOthersItemsToOrg||f.set(c.byId("share-account-check_div"),"display","none");this.clear();this.shareInfo.shareType=a;var b=this.shareInfo.items[0];this.shareInfo.lowestAccess=this.findLowestAccessLevel(this.shareInfo.items);u.getItemById(b,this.portalUrl).then(n.hitch(this,
function(a){b.sharing=a.sharing;"admin"===this.shareInfo.shareType?u.getItemByUserAndItemId(b,this.shareInfo.itemUser,this.shareInfo.user,this.portalUrl).then(n.hitch(this,function(a){b.sharing=a.sharing;this.buildAdminList()})):"group"===this.shareInfo.shareType?u.getItemsGroups(b,this.portalUrl).then(n.hitch(this,function(a){var c=[];if(a.admin)for(var d=0;d<a.admin.length;d++)c.push(a.admin[d].id);b.sharing={groups:c};this.buildGroupList()})):"item"===this.shareInfo.shareType&&u.getItemByUserAndItemId(b,
this.shareInfo.itemUser,this.shareInfo.user,this.portalUrl).then(n.hitch(this,function(a){b.sharing=a.sharing;this.buildList()}))}))},buildAdminList:function(){var a,b,e;if(this.shareInfo.user.groups&&0<this.shareInfo.user.groups.length||this.shareInfo.adminGroups&&0<this.shareInfo.adminGroups.length&&1<this.shareInfo.lowestAccess)!this.shareInfo._isCustomRole||this.shareInfo._roleCanShareToGroup||this.shareInfo._roleCanShareOthersItemsToGroup?f.set(c.byId("share-groups-div"),"display","block"):f.set(c.byId("share-groups-div"),
"display","none");this.shareInfo.itemsAreSharedToGroups=",";var g=[],h=null,k=null;b=[];for(a=0;a<this.shareInfo.items.length;a++)if(h=this.shareInfo.items[a],h.sharing)for(e=0;e<h.sharing.groups.length;e++)if(k=h.sharing.groups[e],-1===this.shareInfo.itemsAreSharedToGroups.indexOf(","+k+","))this.shareInfo.itemsAreSharedToGroups+=k+",",b=[],b[0]=k,b[1]=1,g[g.length]=b;else for(b=0;b<g.length;b++)if(g[b][0]===k){g[b][1]+=1;break}h="";e=!1;var l,p;for(a=0;a<this.shareInfo.user.groups.length;a++){k=
this.shareInfo.user.groups[a];l="";p=this.shareInfo.items.length;if(-1<this.shareInfo.itemsAreSharedToGroups.indexOf(","+k.id+","))for(l="checked",e=!0,b=0;b<g.length;b++)if(g[b][0]===k.id){p=g[b][1];break}h=p<this.shareInfo.items.length?h+('\x3cdiv id\x3d"img_group_'+a+"_div\" style\x3d\"display:block;\"\x3e\x3ctable cellpadding\x3d'0' cellspacing\x3d'0' class\x3d'share-groups-table'\x3e\x3ctr\x3e\x3ctd width\x3d'17' valign\x3d'bottom'\x3e\x3cimg id\x3d\"img_group_"+a+'" src\x3d"'+this._checkboxImgUrl+
'" border\x3d"0"\x3e\x3c/td\x3e\x3ctd\x3e'+k.title+'\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e\x3c/div\x3e\x3cdiv id\x3d"group_'+a+"_div\" style\x3d\"display:none;\"\x3e\x3ctable cellpadding\x3d'0' cellspacing\x3d'0' class\x3d'share-groups-table'\x3e\x3ctr\x3e\x3ctd width\x3d'17' valign\x3d'bottom'\x3e\x3cinput id\x3d\"group_"+a+'" '+l+' value\x3d"'+k.id+'" type\x3d"checkbox" class\x3d\'share-groups-input-checkbox\' dojoType\x3d"dijit.form.Checkbox" /\x3e\x3c/td\x3e\x3ctd\x3e\x3clabel for\x3d\'group_'+
a+"' class\x3d'labels'\x3e"+k.title+"\x3c/label\x3e"):h+('\x3cdiv id\x3d"group_'+a+"_div\" style\x3d\"display:block;\"\x3e\x3ctable cellpadding\x3d'0' cellspacing\x3d'0' class\x3d'share-groups-table'\x3e\x3ctr\x3e\x3ctd width\x3d'17' valign\x3d'bottom'\x3e\x3cinput id\x3d\"group_"+a+'" '+l+' value\x3d"'+k.id+'" type\x3d"checkbox" class\x3d\'share-groups-input-checkbox\' dojoType\x3d"dijit.form.Checkbox" /\x3e\x3c/td\x3e\x3ctd\x3e\x3clabel for\x3d\'group_'+a+"' class\x3d'labels'\x3e"+k.title+"\x3c/label\x3e");
h=this._addOpenDataStr(k,h);h+="\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e\x3c/div\x3e"}if(this.shareInfo.adminGroups&&this.shareInfo.adminGroups.length&&1<this.shareInfo.lowestAccess)for(h+='\x3cdiv style\x3d"display:block;"\x3e\x3chr/\x3e\x3c/div\x3e',b=0;b<this.shareInfo.adminGroups.length;b++){k=this.shareInfo.adminGroups[b];l="";p=this.shareInfo.items.length;if(-1<this.shareInfo.itemsAreSharedToGroups.indexOf(","+k.id+",")){l="checked";e=!0;for(var q=0;q<g.length;q++)if(g[q][0]===k.id){p=g[q][1];break}}h=
p<this.shareInfo.items.length?h+('\x3cdiv id\x3d"img_group_'+(b+a)+"_div\" style\x3d\"display:block;\"\x3e\x3ctable cellpadding\x3d'0' cellspacing\x3d'0' class\x3d'share-groups-table'\x3e\x3ctr\x3e\x3ctd width\x3d'17' valign\x3d'bottom'\x3e\x3cimg id\x3d\"img_group_"+(b+a)+'" src\x3d"'+this._checkboxImgUrl+'" border\x3d"0"\x3e\x3c/td\x3e\x3ctd\x3e'+k.title+'\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e\x3c/div\x3e\x3cdiv id\x3d"group_'+(b+a)+"_div\" style\x3d\"display:none;\"\x3e\x3ctable cellpadding\x3d'0' cellspacing\x3d'0'\x3e\x3ctr\x3e\x3ctd width\x3d'17' valign\x3d'bottom'\x3e\x3cinput id\x3d\"group_"+
(b+a)+'" '+l+' value\x3d"'+k.id+'" type\x3d"checkbox"class\x3d\'share-groups-input-checkbox\' dojoType\x3d"dijit.form.Checkbox" /\x3e\x3c/td\x3e\x3ctd\x3e\x3clabel for\x3d\'group_'+a+"'\x3e"+k.title+"\x3c/label\x3e"):h+('\x3cdiv id\x3d"group_'+(b+a)+"_div\" style\x3d\"display:block;\"\x3e\x3ctable cellpadding\x3d'0' cellspacing\x3d'0' class\x3d'share-groups-table'\x3e\x3ctr\x3e\x3ctd width\x3d'17' valign\x3d'bottom'\x3e\x3cinput id\x3d\"group_"+(b+a)+'" '+l+' value\x3d"'+k.id+'" type\x3d"checkbox"class\x3d\'share-groups-input-checkbox\' dojoType\x3d"dijit.form.Checkbox" /\x3e\x3c/td\x3e\x3ctd\x3e\x3clabel for\x3d\'group_'+
a+"'\x3e"+k.title+"\x3c/label\x3e");h=this._addOpenDataStr(k,h);h+="\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e\x3c/div\x3e"}this.own(d(c.byId("share-groups-list"),"click",n.hitch(this,this.checkGroup)));c.byId("share-groups-list").innerHTML=h;if(this.shareInfo.organization){for(a=g=0;a<this.shareInfo.items.length;a++)this.shareInfo.items[a].sharing&&"org"===this.shareInfo.items[a].sharing.access&&g++;!this.shareInfo._isCustomRole||this.shareInfo._roleCanShareToOrg||this.shareInfo._roleCanShareOthersItemsToOrg?
(0===g?(dijit.byId("share-account-check").set("checked",!1),dijit.byId("share-account-check").set("disabled",!1)):g===this.shareInfo.items.length?(dijit.byId("share-account-check").set("checked",!0),dijit.byId("share-account-check").set("disabled",!1)):(dijit.byId("share-account-check").set("checked",!0),dijit.byId("share-account-check").set("disabled",!0)),f.set(c.byId("share-account-check_div"),"display","block")):(dijit.byId("share-account-check").set("disabled",!0),f.set(c.byId("share-account-check_div"),
"display","none"))}if(!this.shareInfo.organization||this.shareInfo._orgUserCanSharePublicOrOverride){for(a=g=0;a<this.shareInfo.items.length;a++)this.shareInfo.items[a].sharing&&"public"===this.shareInfo.items[a].sharing.access&&g++;0===g?(dijit.byId("share-everyone-check").set("checked",!1),f.set(c.byId("share-everyone-check_div"),"display","block")):(g===this.shareInfo.items.length?(dijit.byId("share-everyone-check").set("checked",!0),f.set(c.byId("share-everyone-check_div"),"display","block")):
dijit.byId("share-everyone-check").set("checked",!0),this.shareInfo.organization&&(!this.shareInfo._isCustomRole||this.shareInfo._roleCanShareToOrg||this.shareInfo._roleCanShareOthersItemsToOrg)&&(dijit.byId("share-account-check").set("checked",!0),dijit.byId("share-account-check").set("disabled",dijit.byId("share-everyone-check").get("checked"))));this.clickEveryone()}else dijit.byId("share-everyone-check").set("checked",!1),f.set(c.byId("share-everyone-check_div"),"display","none");e?dijit.byId("share-groups-check").set("checked",
!0):dijit.byId("share-groups-check").set("checked",!1);this.own(d(c.byId("share-groups-check"),"click",n.hitch(this,this.checkGroups)));this.shareInfo.organization&&(!this.shareInfo._isCustomRole||this.shareInfo._roleCanShareToOrg||this.shareInfo._roleCanShareOthersItemsToOrg)&&this.own(d(c.byId("share-account-check"),"click",n.hitch(this,this.clickAccount)))},buildList:function(){var a,b;!this.shareInfo._isCustomRole||this.shareInfo._roleCanShareToGroup||this.shareInfo._roleCanShareOthersItemsToGroup?
this.shareInfo.userGroups&&0<this.shareInfo.userGroups.length&&f.set(c.byId("share-groups-div"),"display","block"):f.set(c.byId("share-groups-div"),"display","none");this.shareInfo.itemsAreSharedToGroups=",";var e=[];for(a=0;a<this.shareInfo.items.length;a++){var g=this.shareInfo.items[a];if(g.sharing)for(var h=0;h<g.sharing.groups.length;h++){var k=g.sharing.groups[h];if(-1===this.shareInfo.itemsAreSharedToGroups.indexOf(","+k+","))this.shareInfo.itemsAreSharedToGroups+=k+",",b=[],b[0]=k,b[1]=1,
e[e.length]=b;else for(b=0;b<e.length;b++)if(e[b][0]===k){e[b][1]+=1;break}}}h="";g=!1;for(a=0;a<this.shareInfo.userGroups.length;a++){var k=this.shareInfo.userGroups[a],l="",p=this.shareInfo.items.length;if(-1<this.shareInfo.itemsAreSharedToGroups.indexOf(","+k.id+","))for(l="checked",g=!0,b=0;b<e.length;b++)if(e[b][0]===k.id){p=e[b][1];break}h=p<this.shareInfo.items.length?h+('\x3cdiv id\x3d"img_group_'+a+"_div\" style\x3d\"display:block;\"\x3e\x3ctable cellpadding\x3d'0' cellspacing\x3d'0' class\x3d'share-groups-table'\x3e\x3ctr\x3e\x3ctd width\x3d'17' valign\x3d'bottom'\x3e\x3cimg id\x3d\"img_group_"+
a+'" src\x3d"'+this._checkboxImgUrl+'" border\x3d"0"\x3e\x3c/td\x3e\x3ctd\x3e'+k.title+'\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e\x3c/div\x3e\x3cdiv id\x3d"group_'+a+"_div\" style\x3d\"display:none;\"\x3e\x3ctable cellpadding\x3d'0' cellspacing\x3d'0'\x3e\x3ctr\x3e\x3ctd width\x3d'17' valign\x3d'bottom'\x3e\x3cinput id\x3d\"group_"+a+'" '+l+' value\x3d"'+k.id+'" type\x3d"checkbox"class\x3d\'share-groups-input-checkbox\' dojoType\x3d"dijit.form.Checkbox" /\x3e\x3c/td\x3e\x3ctd\x3e\x3clabel for\x3d\'group_'+
a+"'\x3e"+k.title+"\x3c/label\x3e"):h+('\x3cdiv id\x3d"group_'+a+"_div\" style\x3d\"display:block;\"\x3e\x3ctable cellpadding\x3d'0' cellspacing\x3d'0' class\x3d'share-groups-table'\x3e\x3ctr\x3e\x3ctd width\x3d'17' valign\x3d'bottom'\x3e\x3cinput id\x3d\"group_"+a+'" '+l+' value\x3d"'+k.id+'" type\x3d"checkbox"class\x3d\'share-groups-input-checkbox\' dojoType\x3d"dijit.form.Checkbox" /\x3e\x3c/td\x3e\x3ctd\x3e\x3clabel for\x3d\'group_'+a+"'\x3e"+k.title+"\x3c/label\x3e");h=this._addOpenDataStr(k,
h);h+="\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e\x3c/div\x3e"}this.own(d(c.byId("share-groups-list"),"click",n.hitch(this,this.checkGroup)));c.byId("share-groups-list").innerHTML=h;if(this.shareInfo.organization&&this.shareInfo.userRole&&(!this.shareInfo._isCustomRole||this.shareInfo._roleCanShareToOrg||this.shareInfo._roleCanShareOthersItemsToOrg)){for(a=e=0;a<this.shareInfo.items.length;a++)this.shareInfo.items[a].sharing&&"org"===this.shareInfo.items[a].sharing.access&&e++;0===e?dijit.byId("share-account-check").set("checked",
!1):dijit.byId("share-account-check").set("checked",!0);f.set(c.byId("share-account-check_div"),"display","block")}if(!this.shareInfo.organization||this.shareInfo._orgUserCanSharePublicOrOverride){for(a=e=0;a<this.shareInfo.items.length;a++)this.shareInfo.items[a].sharing&&"public"===this.shareInfo.items[a].sharing.access&&e++;0===e?(dijit.byId("share-everyone-check").set("checked",!1),f.set(c.byId("share-everyone-check_div"),"display","block")):(e===this.shareInfo.items.length?(dijit.byId("share-everyone-check").set("checked",
!0),f.set(c.byId("share-everyone-check_div"),"display","block")):dijit.byId("share-everyone-check").set("checked",!0),this.shareInfo.organization&&this.shareInfo.userRole&&(!this.shareInfo._isCustomRole||this.shareInfo._roleCanShareToOrg||this.shareInfo._roleCanShareOthersItemsToOrg)&&(dijit.byId("share-account-check").set("checked",!0),f.set(c.byId("share-everyone-check_div"),"display","block")));this.clickEveryone()}else if(this.shareInfo.organization&&!this.shareInfo.organization.canSharePublic){for(a=
e=0;a<this.shareInfo.items.length;a++)this.shareInfo.items[a].sharing&&"public"===this.shareInfo.items[a].sharing.access&&e++;e?(dijit.byId("share-everyone-check").set("checked",!0),this.shareInfo.organization&&this.shareInfo.userRole&&(!this.shareInfo._isCustomRole||this.shareInfo._roleCanShareToOrg||this.shareInfo._roleCanShareOthersItemsToOrg)&&(dijit.byId("share-account-check").set("checked",!0),f.set(c.byId("share-account-check_div"),"display","block"))):(dijit.byId("share-everyone-check").set("checked",
!1),f.set(c.byId("share-everyone-check_div"),"display","none"))}else dijit.byId("share-everyone-check").set("checked",!1),f.set(c.byId("share-everyone-check_div"),"display","none");g?dijit.byId("share-groups-check").set("checked",!0):dijit.byId("share-groups-check").set("checked",!1);this.own(d(c.byId("share-groups-check"),"click",n.hitch(this,this.checkGroups)));this.shareInfo.organization&&(!this.shareInfo._isCustomRole||this.shareInfo._roleCanShareToOrg||this.shareInfo._roleCanShareOthersItemsToOrg)&&
this.own(d(c.byId("share-account-check"),"click",n.hitch(this,this.clickAccount)))},buildGroupList:function(){var a,b;!this.shareInfo._isCustomRole||this.shareInfo._roleCanShareToGroup||this.shareInfo._roleCanShareOthersItemsToGroup?0<this.shareInfo.userGroups.length&&f.set(c.byId("share-groups-div"),"display","block"):f.set(c.byId("share-groups-div"),"display","none");this.shareInfo.itemsAreSharedToGroups=",";var e=[];for(a=0;a<this.shareInfo.items.length;a++){var g=this.shareInfo.items[a];if(g.sharing)for(var h=
0;h<g.sharing.groups.length;h++){var k=g.sharing.groups[h];if(-1===this.shareInfo.itemsAreSharedToGroups.indexOf(","+k+","))this.shareInfo.itemsAreSharedToGroups+=k+",",b=[],b[0]=k,b[1]=1,e[e.length]=b;else for(b=0;b<e.length;b++)if(e[b][0]===k){e[b][1]+=1;break}}}var g="",h=!1,l,p;for(a=0;a<this.shareInfo.userGroups.length;a++){k=this.shareInfo.userGroups[a];l="";p=this.shareInfo.items.length;if(-1<this.shareInfo.itemsAreSharedToGroups.indexOf(","+k.id+","))for(l="checked",h=!0,b=0;b<e.length;b++)if(e[b][0]===
k.id){p=e[b][1];break}g=p<this.shareInfo.items.length?g+('\x3cdiv id\x3d"img_group_'+a+"_div\" style\x3d\"display:block;\"\x3e\x3ctable cellpadding\x3d'0' cellspacing\x3d'0' class\x3d'share-groups-table'\x3e\x3ctr\x3e\x3ctd width\x3d'17' valign\x3d'bottom'\x3e\x3cimg id\x3d\"img_group_"+a+'" src\x3d"'+this._checkboxImgUrl+'" border\x3d"0"\x3e\x3c/td\x3e\x3ctd\x3e'+k.title+'\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e\x3c/div\x3e\x3cdiv id\x3d"group_'+a+"_div\"style\x3d\"display:none;\"\x3e\x3ctable cellpadding\x3d'0' cellspacing\x3d'0'\x3e\x3ctr\x3e\x3ctd width\x3d'17' valign\x3d'bottom'\x3e\x3cinput id\x3d\"group_"+
a+'" '+l+' value\x3d"'+k.id+'" type\x3d"checkbox"class\x3d\'share-groups-input-checkbox\' dojoType\x3d"dijit.form.Checkbox" /\x3e\x3c/td\x3e\x3ctd\x3e\x3clabel for\x3d\''+k.id+"'\x3e"+k.title+"\x3c/label\x3e"):g+('\x3cdiv id\x3d"group_'+a+"_div\" style\x3d\"display:block;\"\x3e\x3ctable cellpadding\x3d'0' cellspacing\x3d'0' class\x3d'share-groups-table'\x3e\x3ctr\x3e\x3ctd width\x3d'17' valign\x3d'bottom'\x3e\x3cinput id\x3d\"group_"+a+'" '+l+' value\x3d"'+k.id+'" type\x3d"checkbox"class\x3d\'share-groups-input-checkbox\' dojoType\x3d"dijit.form.Checkbox" /\x3e\x3c/td\x3e\x3ctd\x3e\x3clabel for\x3d\'group_'+
a+"'\x3e"+k.title+"\x3c/label\x3e");g=this._addOpenDataStr(k,g);g+="\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e\x3c/div\x3e"}this.own(d(c.byId("share-groups-list"),"click",n.hitch(this,this.checkGroup)));c.byId("share-groups-list").innerHTML=g;h?dijit.byId("share-groups-check").set("checked",!0):dijit.byId("share-groups-check").set("checked",!1);this.own(d(c.byId("share-groups-check"),"click",n.hitch(this,this.checkGroups)))},share:function(a){"group"===this.shareInfo.shareType?this.shareItemToGroups():
"admin"===this.shareInfo.shareType?this.shareItemAsAdmin(a):this.shareItem(a)},checkGroup:function(a){-1<a.target.id.indexOf("img_group_")&&(f.set(c.byId(a.target.id+"_div"),"display","none"),f.set(c.byId(a.target.id.substring(4,a.target.id.length)+"_div"),"display","block"));!0===a.target.checked&&-1<a.target.id.indexOf("group_")&&dijit.byId("share-groups-check").set("checked",!0)},checkGroups:function(){},clickEveryone:function(){var a=dijit.byId("share-everyone-check").get("checked");if(!0===a){var d=
c.byId("share-account-check_div");this.shareInfo.organization&&d&&"block"===f.get(d,"display")&&(dijit.byId("share-account-check").set("checked",!0),dijit.byId("share-account-check").set("disabled",!0))}else this.shareInfo.organization&&this.shareInfo.userRole&&(!this.shareInfo._isCustomRole||this.shareInfo._roleCanShareToOrg||this.shareInfo._roleCanShareOthersItemsToOrg)&&f.set(c.byId("share-account-check_div"),"display","block"),dijit.byId("share-account-check").set("disabled",!1);b.publish("ShareOptions/onClickEveryone",
a)},clickAccount:function(){!0===dijit.byId("share-account-check").get("checked")?(this.shareInfo._orgUserCanSharePublicOrOverride&&("none"===f.get(c.byId("share-everyone-check_div"),"display")&&f.set(c.byId("share-everyone-check_div"),"display","block"),dijit.byId("share-everyone-check").set("checked",!1)),dijit.byId("share-account-check").set("checked",!0)):dijit.byId("share-account-check").set("checked",!1)},shareItemAsAdmin:function(){var a="",b="";h.forEach(this.shareInfo.items,function(c){a+=
b+c.id;b=","});var d=!1,e=!1;c.byId("share-everyone-check_div")&&"block"===f.get(c.byId("share-everyone-check_div"),"display")&&(d=dijit.byId("share-everyone-check").get("checked"));c.byId("share-account-check_div")&&"block"===f.get(c.byId("share-account-check_div"),"display")&&(e=dijit.byId("share-account-check").get("checked"));var g="",k="",l="",p="",q=0;if(dijit.byId("share-groups-check").get("checked")){var C;if(this.shareInfo.user.groups&&this.shareInfo.user.groups.length)for(q=0;q<this.shareInfo.user.groups.length;q++)C=
this.shareInfo.user.groups[q].id,"block"===f.get(c.byId("group_"+q+"_div"),"display")&&(c.byId("group_"+q).checked?(g+=l+C,l=","):(k+=p+C,p=","));if(this.shareInfo.adminGroups&&this.shareInfo.adminGroups.length&&1<this.shareInfo.lowestAccess)for(var B=0;B<this.shareInfo.adminGroups.length;B++)C=this.shareInfo.adminGroups[B].id,"block"===f.get(c.byId("group_"+(B+q)+"_div"),"display")&&(c.byId("group_"+(B+q)).checked?(g+=l+C,l=","):(k+=p+C,p=","))}else p="",this.shareInfo.user.groups&&this.shareInfo.user.groups.length&&
h.forEach(this.shareInfo.user.groups,function(a){k+=p+a.id;p=","}),this.shareInfo.adminGroups&&this.shareInfo.adminGroups.length&&1<this.shareInfo.lowestAccess&&h.forEach(this.shareInfo.adminGroups,function(a){k+=p+a.id;p=","});if(0<k.length)for(l={items:a,groups:k},q=0;q<this.shareInfo.items.length;q++)u._unshareItemById(l,this.shareInfo.items[q].id,this.portalUrl).then(n.hitch(this,this.unShareHandler_admin,this.shareInfo.items,a,g,d,e));else this.unShareHandler_admin(this.shareInfo.items,a,g,d,
e)},unShareHandler_admin:function(a,b,c,d,e){var f=a.length,g=function(){f--};b={items:b,groups:c,everyone:d,account:e};for(c=0;c<a.length;c++)d=a[c],this.shareInfo.user.shareItem(b,d.id,d.folderId).then(n.hitch(this,g))},shareItem:function(){var a="",b="";h.forEach(this.shareInfo.items,function(c){a+=b+c.id;b=","});var d=!1,e=!1;c.byId("share-everyone-check_div")&&"block"===f.get(c.byId("share-everyone-check_div"),"display")&&(d=dijit.byId("share-everyone-check").get("checked"));c.byId("share-account-check_div")&&
"block"===f.get(c.byId("share-account-check_div"),"display")&&(e=dijit.byId("share-account-check").get("checked"));var g=dijit.byId("share-groups-check").get("checked"),k="",l="",p="",q="";this.shareInfo.userGroups=this.shareInfo.user.group;g?this.shareInfo.userGroups&&this.shareInfo.userGroups.length&&h.forEach(this.shareInfo.userGroups,function(a,b){a=a.id;"block"===f.get(c.byId("group_"+b+"_div"),"display")&&(c.byId("group_"+b).checked?(k+=p+a,p=","):(l+=q+a,q=","))}):(q="",this.shareInfo.userGroups&&
this.shareInfo.userGroups.length&&h.forEach(this.shareInfo.userGroups,function(a){l+=q+a.id;q=","}));0<l.length?(g={items:a,groups:l},this.shareInfo.itemUser&&null!==this.shareInfo.itemUser?u.unshareItemsByUser(this.shareInfo.itemUser.username?this.shareInfo.itemUser.username:this.shareInfo.itemUser.email,g,this.portalUrl).then(n.hitch(this,this.unShareHandler_item,this.shareInfo.itemUser,a,k,d,e)):u.unshareItems(this.shareInfo.itemUser,g,this.portalUrl).then(n.hitch(this,this.unShareHandler_item,
this.shareInfo.itemUser,a,k,d,e))):this.unShareHandler_item(this.shareInfo.itemUser,a,k,d,e)},unShareHandler_item:function(a,b,c,d,e){b={items:b,groups:c,everyone:d,account:e};a&&null!==a?u.shareItemsByUser(a.username?a.username:a.email,b,this.portalUrl).then(n.hitch()):u.shareItems(a,b,this.portalUrl).then()},findLowestAccessLevel:function(a){for(var b=3,c,d,e=0;e<a.length;e++)(d=a[e].access)||(d="private"),1===d.length&&(d=d[0]),"public"===d?c=3:"org"===d?c=2:"shared"===d?c=1:"private"===d&&(c=
0),c<b&&(b=c);return b},_sortFunc:function(a,b){a=a[this.shareInfo.sortField].toLowerCase();b=b[this.shareInfo.sortField].toLowerCase();return null===a||null===b||a===b?0:a<b?-1:1},_addOpenDataStr:function(a,b){a.isOpenData&&!u.portal.isPortal&&(b+=" "+this.i18n.openData);return b},_clearGroupCheckboxes:function(){if(!1===dijit.byId("share-groups-check").get("checked"))for(var b=a(".share-groups-input-checkbox"),c=0,d=b.length;c<d;c++)b[c].setAttribute("value",!1)}})})},"jimu/shareUtils":function(){define("dojo/_base/lang esri/request dojo/promise/all jimu/shared/basePortalUrlUtils dojo/Deferred esri/lang jimu/portalUtils jimu/Role jimu/utils esri/urlUtils".split(" "),
function(k,e,p,q,n,l,h,f,d,c){var a={getBaseHrefUrl:function(a){var b="HTML3D"===window.appInfo.appType?"webappviewer3d":"webappviewer",c="";window.isXT?c=window.location.protocol+"//"+window.location.host+window.appInfo.appPath:(c=d.urlToObject(window.location.href).query||{},c=c.appid?a+"apps/"+b+"/index.html?appid\x3d"+c.appid:c.id?a+"apps/"+b+"/index.html?id\x3d"+c.id:d.getAppHref());return c},addQueryParamToUrl:function(a,d,e,f){a=c.urlToObject(a);a.query||(a.query={});a.query[d]=e;d=a.path;
for(var b in a.query)e=a.query[b],!0===f&&(e=encodeURIComponent(e)),d=d===a.path?d+"?"+b+"\x3d"+e:d+"\x26"+b+"\x3d"+e;return d},removeQueryParamFromUrl:function(a,d,e){a=c.urlToObject(a);a.query&&delete a.query[d];d=a.path;for(var b in a.query){var f=a.query[b];!0===e&&(f=encodeURIComponent(f));d=d===a.path?d+"?"+b+"\x3d"+f:d+"\x26"+b+"\x3d"+f}return d},getShareUrlContent:function(a){return"\x3cdiv class\x3d'marker-feature-action-popup'\x3e\x3cdiv class\x3d'item'\x3e\x3cspan class\x3d'sub-title jimu-float-leading'\x3e"+
window.jimuNls.common.url+"\x3c/span\x3e\x3cinput type\x3d'text' class\x3d'jimu-float-leading' readonly\x3d'readonly' value\x3d"+a+"\x3e\x3c/input\x3e\x3c/div\x3e\x3c/div\x3e"},getShareUrl:function(b,c,d){var e=a.getBaseHrefUrl(window.portalUrl),f="",g,h,k,l,n;c&&(c.longitude&&c.latitude?(g=c.longitude,h=c.latitude,f=c.longitude+","+c.latitude+","):c.x&&c.y&&c.spatialReference&&c.spatialReference.wkid&&(k=c.x,l=c.y,n=c.spatialReference.wkid,f=c.x+","+c.y+","+c.spatialReference.wkid));e=a.addQueryParamToUrl(e,
"marker",f,!0);e=a.addQueryParamToUrl(e+",,,","markertemplate",encodeURIComponent(JSON.stringify({title:c.title,x:k,y:l,wkid:n,longitude:g,latitude:h,isIncludeShareUrl:d})));c=b.getLevel();return e="number"===typeof c&&-1!==c?a.addQueryParamToUrl(e,"level",b.getLevel(),!0):a.addQueryParamToUrl(e,"scale",b.getScale(),!0)},getXyContent:function(a){var b="\x3cdiv class\x3d'marker-feature-action-popup'\x3e";a.longitude&&a.latitude?b+="\x3cdiv class\x3d'item clearFix'\x3e\x3cspan class\x3d'sub-title'\x3e"+
window.jimuNls.common.longitude+"\x3c/span\x3e\x3cspan class\x3d'val'\x3e"+d.localizeNumber(parseFloat(a.longitude).toFixed(4))+"\x3c/span\x3e\x3c/div\x3e\x3cdiv class\x3d'item clearFix'\x3e\x3cspan class\x3d'sub-title'\x3e"+window.jimuNls.common.latitude+"\x3c/span\x3e\x3cspan class\x3d'val'\x3e"+d.localizeNumber(parseFloat(a.latitude).toFixed(4))+"\x3c/span\x3e\x3c/div\x3e":a.x&&a.y&&(b+="\x3cdiv class\x3d'item clearFix'\x3e\x3cspan class\x3d'sub-title'\x3ex\x3c/span\x3e\x3cspan class\x3d'val'\x3e"+
d.localizeNumber(parseFloat(a.x).toFixed(4))+"\x3c/span\x3e\x3c/div\x3e\x3cdiv class\x3d'item'\x3e\x3cspan class\x3d'sub-title'\x3ey\x3c/span\x3e\x3cspan class\x3d'val'\x3e"+d.localizeNumber(parseFloat(a.y).toFixed(4))+"\x3c/span\x3e\x3c/div\x3e");return b+"\x3c/div\x3e"},_isUserOwnTheApp:function(a){return a&&a.username&&a.username===window.appInfo.appOwner?!0:!1},getItemByUserAndItemId:function(a,c,d,f){var b=new n;f=q.getStandardPortalUrl(f);f=f+"/sharing/rest/content/users/"+(c?c.username?c.username:
c.email:d.email);if(l.isDefined(a.folderId)&&"/"!==a.folderId||l.isDefined(a.ownerFolder)&&"/"!==a.ownerFolder)f+="/"+(a.folderId||a.ownerFolder);f+="/items/"+a.id;e({url:f,handleAs:"json",content:{f:"json"},callbackParamName:"callback"}).then(k.hitch(this,function(a){b.resolve(a)}),k.hitch(this,function(a){console.error(a);b.reject(a)}));return b},_getProfile:function(a,c){var b=new n;a=q.getUserUrl(c,a.owner);e({url:a,handleAs:"json",content:{f:"json"},callbackParamName:"callback"}).then(k.hitch(this,
function(a){b.resolve(a)}),k.hitch(this,function(a){console.error(a);b.reject(a)}));return b},_unshareItemById:function(a,c,d){var b=new n;d=q.getStandardPortalUrl(d);d+="/sharing/rest/content/items/"+c+"/unshare";c={f:"json"};c=k.mixin(c,a);e({url:d,handleAs:"json",content:c,callbackParamName:"callback"},{usePost:!0}).then(k.hitch(this,function(a){b.resolve(a)}),k.hitch(this,function(a){console.error(a);b.reject(a)}));return b},canSharePublic:function(a){return!a.selfUrl||!0!==a.canSharePublic&&
!1!==a.canSharePublic?!0:a.canSharePublic},unshareItemsByUser:function(a,c,d){var b=new n;d=q.getStandardPortalUrl(d);d+="/sharing/rest/content/users/"+a+"/unshareItems";a={f:"json"};a=k.mixin(a,c);e({url:d,handleAs:"json",content:a,callbackParamName:"callback"},{usePost:!0}).then(k.hitch(this,function(a){b.resolve(a)}),k.hitch(this,function(a){console.error(a);b.reject(a)}));return b},unshareItems:function(a,c,d){var b=new n;d=q.getStandardPortalUrl(d);d+="/sharing/rest/content/users/"+(c.owner||
a.email)+"/unshareItems";a={f:"json"};a=k.mixin(a,c);e({url:d,handleAs:"json",content:a,callbackParamName:"callback"},{usePost:!0}).then(k.hitch(this,function(a){b.resolve(a)}),k.hitch(this,function(a){console.error(a);b.reject(a)}));return b},shareItemsByUser:function(a,c,d){var b=new n;d=q.getStandardPortalUrl(d);d+="/sharing/rest/content/users/"+a+"/shareItems";a={f:"json"};a=k.mixin(a,c);e({url:d,handleAs:"json",content:a,callbackParamName:"callback"},{usePost:!0}).then(k.hitch(this,function(a){b.resolve(a)}),
k.hitch(this,function(a){console.error(a);b.reject(a)}));return b},shareItems:function(a,c,d){var b=new n;d=q.getStandardPortalUrl(d);d+="/sharing/rest/content/users/"+(c.owner||a.email)+"/shareItems";a={f:"json"};a=k.mixin(a,c);e({url:d,handleAs:"json",content:a,callbackParamName:"callback"},{usePost:!0}).then(k.hitch(this,function(a){b.resolve(a)}),k.hitch(this,function(a){console.error(a);b.reject(a)}));return b},getItemsGroups:function(a,c){var b=new n;c=q.getStandardPortalUrl(c);c+="/sharing/rest/content/items/"+
a.id+"/groups";e({url:c,handleAs:"json",content:{f:"json"},callbackParamName:"callback"},{usePost:!0}).then(k.hitch(this,function(a){b.resolve(a)}),k.hitch(this,function(a){console.error(a);b.reject(a)}));return b},isSharedToPublic:function(a){return window.isXT?!1:null===a?!0:"undefined"!==typeof a&&"undefined"!==typeof a.item&&"undefined"!==typeof a.item.access&&"public"===a.item.access?!0:!1},isShowSocialMediaLinks:function(a){return window.isXT?!0:null===a?!0:"undefined"!==typeof a&&"undefined"!==
typeof a.item&&"undefined"!==typeof a.item.access&&"private"===a.item.access?!1:!0},getItemShareInfo:function(a){var b=new n,c="";if(window.isXT)return b.resolve(null);c=d.urlToObject(d.getAppHref()).query||{};c=c.id||c.appid;if("undefined"===typeof c||""===c)return b.resolve(null);h.getPortal(a).getItemById(c).then(k.hitch(this,function(a){var c={};c.item=a;c.item&&"undefined"===typeof c.item.sharing&&c.item.access&&(c.item.sharing={access:c.item.access});b.resolve(c)}),k.hitch(this,function(a){console.log(a);
b.resolve(null)}));return b},getShareInfo:function(b){var c=h.getPortal(b),e=new n,f="";if(window.isXT)return e.resolve(null);f=d.urlToObject(d.getAppHref()).query||{};f=f.id||f.appid;if("undefined"===typeof f||""===f)return e.resolve(null);p({getUser:c.getUser(),loadSelfInfo:c.loadSelfInfo(),getItem:c.getItemById(f)}).then(k.hitch(this,function(c){var d={};d.item=c.getItem;d.item&&d.item.ownerFolder&&d.item.ownerFolder.length&&"/"!==d.item.ownerFolder&&(d.item.folderId=d.item.ownerFolder);"undefined"===
typeof d.item.sharing&&d.item.access&&(d.item.sharing={access:d.item.access});d.user=c.getUser;a._setUserRole(c.loadSelfInfo,d);d.currentUser=d.user;d.isAdmin=!1;d.userRole&&(d.userRole.isAdmin()||d.userRole.isCustom()&&d.userRole.canUpdateOrgItems())?(d.isAdmin=!0,d.item.owner!==d.currentUser.name?a._getProfile(d.item,b).then(k.hitch(this,function(a){d.itemUser=a;d.itemUser.orgId!==d.currentUser.orgId&&(d.isAdmin=!1);e.resolve(d)})):(d.itemUser=d.currentUser,e.resolve(d))):(d.currentUser&&(d.itemUser=
d.currentUser),e.resolve(d))}),k.hitch(this,function(a){console.log(a);e.resolve(null)}));return e},_setUserRole:function(a,c){c.userPortalUrl=a.urlKey?a.urlKey+"."+a.customBaseUrl:this.portalUrl;!a||a.code||a.message||(c.organization=a);if(a&&a.user)c.userRole=new f({id:a.user.roleId?a.user.roleId:a.user.role,role:a.user.role}),c._isCustomRole=c.userRole.isCustom(),c._roleCanShareToGroup=c._isCustomRole&&c.userRole.canShareItemToGroup(),c._roleCanShareToOrg=c._isCustomRole&&c.userRole.canShareItemToOrg(),
c._roleCanSharePublic=c._isCustomRole&&c.userRole.canShareItemToPublic(),c._roleCanShare=c._roleCanShareToGroup||c._roleCanShareToOrg||c._roleCanShareToPublic,c._roleCanUpdateItems=c._isCustomRole&&c.userRole.canUpdateOrgItems(),c._roleCanShareOthersItemsToGroup=c._isCustomRole&&c.userRole.canShareOthersItemsToGroup(),c._roleCanShareOthersItemsToOrg=c._isCustomRole&&c.userRole.canShareOthersItemsToOrg(),c._roleCanShareOthersItemsToPublic=c._isCustomRole&&c.userRole.canShareOthersItemsToPublic(),c._roleCanShareOthersItems=
c._isCustomRole&&(c.userRole.canShareOthersItemsToGroup()||c.userRole.canShareOthersItemsToOrg()||c._roleCanShareOthersItemsToPublic),c._orgUserCanSharePublicOrOverride=c.organization&&(!0===c.organization.canSharePublic&&(!c._isCustomRole||c._roleCanSharePublic||c._roleCanShareOthersItemsToPublic)||c.userRole.isAdmin());else return!1},getItemById:function(a,c){var b=new n;c=q.getStandardPortalUrl(c);c+="/sharing/rest/content/items/"+a.id;e({url:c,handleAs:"json",content:{f:"json"},callbackParamName:"callback"}).then(k.hitch(this,
function(a){b.resolve(a)}),k.hitch(this,function(a){console.error(a);b.reject(a)}));return b}};return a})},"dijit/form/Textarea":function(){define(["dojo/_base/declare","dojo/dom-style","./_ExpandingTextAreaMixin","./SimpleTextarea"],function(k,e,p,q){return k("dijit.form.Textarea",[q,p],{baseClass:"dijitTextBox dijitTextArea dijitExpandingTextArea",cols:"",buildRendering:function(){this.inherited(arguments);e.set(this.textbox,{overflowY:"hidden",overflowX:"auto",boxSizing:"border-box",MsBoxSizing:"border-box",
WebkitBoxSizing:"border-box",MozBoxSizing:"border-box"})}})})},"dijit/form/_ExpandingTextAreaMixin":function(){define("dojo/_base/declare dojo/dom-construct dojo/has dojo/_base/lang dojo/on dojo/_base/window ../Viewport".split(" "),function(k,e,p,q,n,l,h){p.add("textarea-needs-help-shrinking",function(){var f=l.body(),d=e.create("textarea",{rows:"5",cols:"20",value:" ",style:{zoom:1,fontSize:"12px",height:"96px",overflow:"hidden",visibility:"hidden",position:"absolute",border:"5px solid white",margin:"0",
padding:"0",boxSizing:"border-box",MsBoxSizing:"border-box",WebkitBoxSizing:"border-box",MozBoxSizing:"border-box"}},f,"last"),c=d.scrollHeight>=d.clientHeight;f.removeChild(d);return c});return k("dijit.form._ExpandingTextAreaMixin",null,{_setValueAttr:function(){this.inherited(arguments);this.resize()},postCreate:function(){this.inherited(arguments);var e=this.textbox;e.style.overflowY="hidden";this.own(n(e,"focus, resize",q.hitch(this,"_resizeLater")))},startup:function(){this.inherited(arguments);
this.own(h.on("resize",q.hitch(this,"_resizeLater")));this._resizeLater()},_onInput:function(e){this.inherited(arguments);this.resize()},_estimateHeight:function(){var e=this.textbox;e.rows=(e.value.match(/\n/g)||[]).length+1},_resizeLater:function(){this.defer("resize")},resize:function(){function e(){var a=!1;""===d.value&&(d.value=" ",a=!0);var b=d.scrollHeight;a&&(d.value="");return b}var d=this.textbox;"hidden"==d.style.overflowY&&(d.scrollTop=0);if(!this.busyResizing){this.busyResizing=!0;if(e()||
d.offsetHeight){var c=e()+Math.max(d.offsetHeight-d.clientHeight,0),a=c+"px";a!=d.style.height&&(d.style.height=a,d.rows=1);if(p("textarea-needs-help-shrinking")){var b=e(),g=d.style.minHeight,h=4,k=d.scrollTop;d.style.minHeight=a;for(d.style.height="auto";0<c;){d.style.minHeight=Math.max(c-h,4)+"px";a=e();b-=a;c-=b;if(b<h)break;b=a;h<<=1}d.style.height=c+"px";d.style.minHeight=g;d.scrollTop=k}d.style.overflowY=e()>d.clientHeight?"auto":"hidden";"hidden"==d.style.overflowY&&(d.scrollTop=0)}else this._estimateHeight();
this.busyResizing=!1}}})})},"dijit/layout/BorderContainer":function(){define("dojo/_base/array dojo/cookie dojo/_base/declare dojo/dom-class dojo/dom-construct dojo/dom-geometry dojo/dom-style dojo/keys dojo/_base/lang dojo/on dojo/touch ../_WidgetBase ../_Widget ../_TemplatedMixin ./LayoutContainer ./utils".split(" "),function(k,e,p,q,n,l,h,f,d,c,a,b,g,u,m,r){var t=p("dijit.layout._Splitter",[g,u],{live:!0,templateString:'\x3cdiv class\x3d"dijitSplitter" data-dojo-attach-event\x3d"onkeydown:_onKeyDown,press:_startDrag,onmouseenter:_onMouse,onmouseleave:_onMouse" tabIndex\x3d"0" role\x3d"separator"\x3e\x3cdiv class\x3d"dijitSplitterThumb"\x3e\x3c/div\x3e\x3c/div\x3e',
constructor:function(){this._handlers=[]},postMixInProperties:function(){this.inherited(arguments);this.horizontal=/top|bottom/.test(this.region);this._factor=/top|left/.test(this.region)?1:-1;this._cookieName=this.container.id+"_"+this.region},buildRendering:function(){this.inherited(arguments);q.add(this.domNode,"dijitSplitter"+(this.horizontal?"H":"V"));if(this.container.persist){var a=e(this._cookieName);a&&(this.child.domNode.style[this.horizontal?"height":"width"]=a)}},_computeMaxSize:function(){var a=
this.horizontal?"h":"w",b=l.getMarginBox(this.child.domNode)[a],c=k.filter(this.container.getChildren(),function(a){return"center"==a.region})[0],a=l.getContentBox(c.domNode)[a]-10;return Math.min(this.child.maxSize,b+a)},_startDrag:function(b){this.cover||(this.cover=n.place("\x3cdiv class\x3ddijitSplitterCover\x3e\x3c/div\x3e",this.child.domNode,"after"));q.add(this.cover,"dijitSplitterCoverActive");this.fake&&n.destroy(this.fake);(this._resize=this.live)||((this.fake=this.domNode.cloneNode(!0)).removeAttribute("id"),
q.add(this.domNode,"dijitSplitterShadow"),n.place(this.fake,this.domNode,"after"));q.add(this.domNode,"dijitSplitterActive dijitSplitter"+(this.horizontal?"H":"V")+"Active");this.fake&&q.remove(this.fake,"dijitSplitterHover dijitSplitter"+(this.horizontal?"H":"V")+"Hover");var e=this._factor,f=this.horizontal,g=f?"pageY":"pageX",k=b[g],m=this.domNode.style,f=f?"h":"w",p=h.getComputedStyle(this.child.domNode),r=l.getMarginBox(this.child.domNode,p)[f],t=this._computeMaxSize(),u=Math.max(this.child.minSize,
l.getPadBorderExtents(this.child.domNode,p)[f]+10),f=this.region,v="top"==f||"bottom"==f?"top":"left",y=parseInt(m[v],10),L=this._resize,J=d.hitch(this.container,"_layoutChildren",this.child.id),f=this.ownerDocument;this._handlers=this._handlers.concat([c(f,a.move,this._drag=function(a,b){a=a[g]-k;var c=e*a+r,d=Math.max(Math.min(c,t),u);(L||b)&&J(d);m[v]=a+y+e*(d-c)+"px"}),c(f,"dragstart",function(a){a.stopPropagation();a.preventDefault()}),c(this.ownerDocumentBody,"selectstart",function(a){a.stopPropagation();
a.preventDefault()}),c(f,a.release,d.hitch(this,"_stopDrag"))]);b.stopPropagation();b.preventDefault()},_onMouse:function(a){a="mouseover"==a.type||"mouseenter"==a.type;q.toggle(this.domNode,"dijitSplitterHover",a);q.toggle(this.domNode,"dijitSplitter"+(this.horizontal?"H":"V")+"Hover",a)},_stopDrag:function(a){try{this.cover&&q.remove(this.cover,"dijitSplitterCoverActive"),this.fake&&n.destroy(this.fake),q.remove(this.domNode,"dijitSplitterActive dijitSplitter"+(this.horizontal?"H":"V")+"Active dijitSplitterShadow"),
this._drag(a),this._drag(a,!0)}finally{this._cleanupHandlers(),delete this._drag}this.container.persist&&e(this._cookieName,this.child.domNode.style[this.horizontal?"height":"width"],{expires:365})},_cleanupHandlers:function(){for(var a;a=this._handlers.pop();)a.remove()},_onKeyDown:function(a){this._resize=!0;var b=this.horizontal,c=1;switch(a.keyCode){case b?f.UP_ARROW:f.LEFT_ARROW:c*=-1;case b?f.DOWN_ARROW:f.RIGHT_ARROW:break;default:return}b=l.getMarginSize(this.child.domNode)[b?"h":"w"]+this._factor*
c;this.container._layoutChildren(this.child.id,Math.max(Math.min(b,this._computeMaxSize()),this.child.minSize));a.stopPropagation();a.preventDefault()},destroy:function(){this._cleanupHandlers();delete this.child;delete this.container;delete this.cover;delete this.fake;this.inherited(arguments)}}),v=p("dijit.layout._Gutter",[g,u],{templateString:'\x3cdiv class\x3d"dijitGutter" role\x3d"presentation"\x3e\x3c/div\x3e',postMixInProperties:function(){this.inherited(arguments);this.horizontal=/top|bottom/.test(this.region)},
buildRendering:function(){this.inherited(arguments);q.add(this.domNode,"dijitGutter"+(this.horizontal?"H":"V"))}});p=p("dijit.layout.BorderContainer",m,{gutters:!0,liveSplitters:!0,persist:!1,baseClass:"dijitBorderContainer",_splitterClass:t,postMixInProperties:function(){this.gutters||(this.baseClass+="NoGutter");this.inherited(arguments)},_setupChild:function(a){this.inherited(arguments);var b=a.region,c=a.isLeftToRight();"leading"==b&&(b=c?"left":"right");"trailing"==b&&(b=c?"right":"left");b&&
"center"!=b&&(a.splitter||this.gutters)&&!a._splitterWidget&&(c=a.splitter?this._splitterClass:v,d.isString(c)&&(c=d.getObject(c)),c=new c({id:a.id+"_splitter",container:this,child:a,region:b,live:this.liveSplitters}),c.isSplitter=!0,a._splitterWidget=c,b="bottom"==b||b==(this.isLeftToRight()?"right":"left"),n.place(c.domNode,a.domNode,b?"before":"after"),c.startup())},layout:function(){this._layoutChildren()},removeChild:function(a){var b=a._splitterWidget;b&&(b.destroy(),delete a._splitterWidget);
this.inherited(arguments)},getChildren:function(){return k.filter(this.inherited(arguments),function(a){return!a.isSplitter})},getSplitter:function(a){return k.filter(this.getChildren(),function(b){return b.region==a})[0]._splitterWidget},resize:function(a,b){if(!this.cs||!this.pe){var c=this.domNode;this.cs=h.getComputedStyle(c);this.pe=l.getPadExtents(c,this.cs);this.pe.r=h.toPixelValue(c,this.cs.paddingRight);this.pe.b=h.toPixelValue(c,this.cs.paddingBottom);h.set(c,"padding","0px")}this.inherited(arguments)},
_layoutChildren:function(a,b){if(this._borderBox&&this._borderBox.h){var c=[];k.forEach(this._getOrderedChildren(),function(a){c.push(a);a._splitterWidget&&c.push(a._splitterWidget)});r.layoutChildren(this.domNode,{l:this.pe.l,t:this.pe.t,w:this._borderBox.w-this.pe.w,h:this._borderBox.h-this.pe.h},c,a,b)}},destroyRecursive:function(){k.forEach(this.getChildren(),function(a){var b=a._splitterWidget;b&&b.destroy();delete a._splitterWidget});this.inherited(arguments)}});p.ChildWidgetProperties={splitter:!1,
minSize:0,maxSize:Infinity};d.mixin(p.ChildWidgetProperties,m.ChildWidgetProperties);d.extend(b,p.ChildWidgetProperties);p._Splitter=t;p._Gutter=v;return p})},"dijit/layout/LayoutContainer":function(){define("dojo/_base/array dojo/_base/declare dojo/dom-class dojo/dom-style dojo/_base/lang ../_WidgetBase ./_LayoutWidget ./utils".split(" "),function(k,e,p,q,n,l,h,f){e=e("dijit.layout.LayoutContainer",h,{design:"headline",baseClass:"dijitLayoutContainer",startup:function(){this._started||(k.forEach(this.getChildren(),
this._setupChild,this),this.inherited(arguments))},_setupChild:function(d){this.inherited(arguments);d.region&&p.add(d.domNode,this.baseClass+"Pane")},_getOrderedChildren:function(){var d=k.map(this.getChildren(),function(c,a){return{pane:c,weight:["center"==c.region?Infinity:0,c.layoutPriority,("sidebar"==this.design?1:-1)*(/top|bottom/.test(c.region)?1:-1),a]}},this);d.sort(function(c,a){c=c.weight;a=a.weight;for(var b=0;b<c.length;b++)if(c[b]!=a[b])return c[b]-a[b];return 0});return k.map(d,function(c){return c.pane})},
layout:function(){f.layoutChildren(this.domNode,this._contentBox,this._getOrderedChildren())},addChild:function(d,c){this.inherited(arguments);this._started&&this.layout()},removeChild:function(d){this.inherited(arguments);this._started&&this.layout();p.remove(d.domNode,this.baseClass+"Pane");q.set(d.domNode,{top:"auto",bottom:"auto",left:"auto",right:"auto",position:"static"});q.set(d.domNode,/top|bottom/.test(d.region)?"width":"height","auto")}});e.ChildWidgetProperties={region:"",layoutAlign:"",
layoutPriority:0};n.extend(l,e.ChildWidgetProperties);return e})},"jimu/dijit/ShareLink":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/_base/lang dojo/_base/array dojo/dom-class dojo/on dojo/topic dojo/query jimu/utils jimu/shareUtils dojo/_base/config dojo/cookie dojo/text!./templates/ShareLink.html dojo/string dijit/form/Select dijit/form/NumberTextBox dojo/dom-attr dojo/Deferred esri/request esri/tasks/query esri/tasks/QueryTask esri/symbols/PictureMarkerSymbol esri/graphic esri/layers/GraphicsLayer jimu/dijit/FeaturelayerChooserFromMap jimu/dijit/LayerChooserFromMapWithDropbox dijit/form/TextBox dijit/form/Textarea dijit/form/RadioButton dijit/form/Select dijit/form/CheckBox dijit/form/NumberTextBox dijit/form/SimpleTextarea dijit/form/ValidationTextBox".split(" "),
function(k,e,p,q,n,l,h,f,d,c,a,b,g,u,m,r,t,v,y,w,z,x,A,C,B,E,D,F){return k([e,p,q],{templateString:m,declaredClass:"jimu.dijit.ShareLink",bitlyUrl:"https://arcg.is/prod/shorten",share:{shareEmailSubject:"",shareTwitterTxt:"",languages:"ar cs da de en el es et fi fr he hr it ja ko lt lv nb nl pl pt-br pt-pt ro ru sr sv th tr zh-cn vi zh-hk zh-tw".split(" "),DEFAULT_MOBILE_LAYOUT:600},_hasZoomLevelMarkerAdded:!1,_hasMapScaleMarkerAdded:!1,_hasAddMarkerMarkerAdded:!1,HAS_INIT_URL:!1,postMixInProperties:function(){this.inherited(arguments);
this.nls=window.jimuNls.shareLink;this.nls.symbol=window.jimuNls.common.symbol;this.nls.label=window.jimuNls.common.label;this.nls.WKID=window.jimuNls.common.wkid||"wkid";this.nls.popupTitle=window.jimuNls.shareLink.popupTitle||"Pop-up title";this.nls.zoomLevel=window.jimuNls.shareLink.zoomLevel||"Zoom level";this.share.shareEmailSubject=this.nls.shareEmailSubject+" ${appTitle} ";this.share.shareTwitterTxt=this.nls.shareEmailSubject+"${appTitle}\n"},postCreate:function(){this.inherited(arguments);
this._initUI();this._initMap();this._showSocialMediaLinksByConfig()},constructor:function(a){a&&(this._portalUrl=a.portalUrl,this._isOnline=a.isOnline,this._appTitle=a.appTitle,this._isShowBackBtn=a.isShowBackBtn,this._isShowSocialMediaLinks=a.isShowSocialMediaLinks,this._isSharedToPublic=a.isSharedToPublic,this._isShowFindLocation=a.isShowFindLocation,this._config=a.config)},startup:function(){this.baseHrefUrl=b.getBaseHrefUrl(this._portalUrl);"undefined"===typeof this.optionSrc&&(this.optionSrc=
"currentMapExtent");this.updateUrl(null);this._initOptions();this._initOptionsEvent()},destroy:function(){this._cleanMarkerStatus();this._mapClickHandler&&(this._mapClickHandler=null);this.inherited(arguments)},onShareToPublicChanged:function(a){this._isSharedToPublic=a;this.updateUrl(null);this._isSharedToPublic?h.add(this.shareTips,"displaynone"):h.remove(this.shareTips,"displaynone")},onCloseContainer:function(){this._cleanMarkerStatus()},updateShareLinkOptionsUI:function(a){a&&"undefined"!==typeof a.isShowFindLocation&&
this.findLocationRow&&(!1===a.isShowFindLocation?h.add(this.findLocationRow,"displaynone"):!0===a.isShowFindLocation&&h.remove(this.findLocationRow,"displaynone"))},_initMap:function(){window.isBuilder?(this.own(d.subscribe("app/mapLoaded",n.hitch(this,this._onMapLoaded))),this.own(d.subscribe("app/mapChanged",n.hitch(this,this._onMapLoaded)))):(this.own(d.subscribe("mapLoaded",n.hitch(this,this._onMapLoaded))),this.own(d.subscribe("mapChanged",n.hitch(this,this._onMapLoaded))));window._widgetManager.map&&
(this.map=window._widgetManager.map,this._mapEventUpdateUrls(),this._addGraphicsLayer())},_onMapLoaded:function(a){this.map=a;this._mapEventUpdateUrls();this._addGraphicsLayer()},_mapEventUpdateUrls:function(){this.map&&(this.own(f(this.map,"pan-end",n.hitch(this,function(){this._mapEventHandler("pan-end")}))),this.own(f(this.map,"resize",n.hitch(this,function(){this._mapEventHandler("resize")}))),this.own(f(this.map,"zoom-end",n.hitch(this,function(){this._mapEventHandler("zoom-end")}))))},_mapEventHandler:function(){this._isShareLinkOptionsShow()&&
this.updateUrl()},_showSocialMediaLinksByConfig:function(){this._config&&this._config.socialMedias&&("undefined"!==typeof this._config.socialMedias.email&&!1===this._config.socialMedias.email&&h.add(this.emailShare,"displaynone"),"undefined"!==typeof this._config.socialMedias.facebook&&!1===this._config.socialMedias.facebook&&h.add(this.FacebookShare,"displaynone"),"undefined"!==typeof this._config.socialMedias.twitter&&!1===this._config.socialMedias.twitter&&h.add(this.TwitterShare,"displaynone"),
"undefined"!==typeof this._config.socialMedias.googlePlus&&!1===this._config.socialMedias.googlePlus&&h.add(this.googlePlusShare,"displaynone"))},_initUI:function(){this._isShowBackBtn?(y.set(this.backBtn,"title",window.jimuNls.common.back),this.own(f(this.backBtn,"click",n.hitch(this,this._toggleLinkOptions)))):h.add(this.backBtn,"displaynone");!1===this._isShowSocialMediaLinks&&h.toggle(this.socialNetworkLinks,"displaynone");!0===this._isSharedToPublic&&h.toggle(this.shareTips,"displaynone");this.own(f(this.linkOptions,
"click",n.hitch(this,this._toggleLinkOptions)));this._setInputsClicktoSelect(this._linkUrlTextBox);this.own(f(this.googlePlusShare,"click",n.hitch(this,this._toGooglePlus)));this._setInputsClicktoSelect(this._embedCodeTextArea);this._sizeOptions=new t({options:[{label:this.nls.smallSize,value:"small",selected:!0},{label:this.nls.mediumSize,value:"medium",selected:!1},{label:this.nls.largeSize,value:"large",selected:!1},{label:this.nls.customSize,value:"custom",selected:!1}],"class":"sizeOptionsSelect"});
this._sizeOptions.placeAt(this.SizeSelect);this.own(f(this._sizeOptions,"change",function(a){switch(a){case "small":this._widthTextBox.set("value",300);this._heightTextBox.set("value",200);h.add(this.CustomSizeContainer,"disable");this._updateEmbedCodeFrameSize();break;case "medium":this._widthTextBox.set("value",800);this._heightTextBox.set("value",600);h.add(this.CustomSizeContainer,"disable");this._updateEmbedCodeFrameSize();break;case "large":this._widthTextBox.set("value",1080);this._heightTextBox.set("value",
720);h.add(this.CustomSizeContainer,"disable");this._updateEmbedCodeFrameSize();break;case "custom":h.remove(this.CustomSizeContainer,"disable")}}.bind(this)));this._widthTextBox=new v({"class":"sizeTextBox inputsText",value:300,constraints:{pattern:"#",places:0}});this._widthTextBox.placeAt(this.CustomSizeContainer,1);this.own(f(this._widthTextBox,"change",function(a){200>a?this._widthTextBox.set("value",200>a?200:a):this._updateEmbedCodeFrameSize()}.bind(this)));this._heightTextBox=new v({"class":"sizeTextBox inputsText",
value:200,constraints:{pattern:"#",places:0}});this._heightTextBox.placeAt(this.CustomSizeContainer,3);this.own(f(this._heightTextBox,"change",function(a){200>a?this._heightTextBox.set("value",200>a?200:a):this._updateEmbedCodeFrameSize()}.bind(this)));this.mobileLayout.set("value",this.share.DEFAULT_MOBILE_LAYOUT);this.updateShareLinkOptionsUI({isShowFindLocation:this._isShowFindLocation});this._setInputsClicktoSelect(this.preview)},_setLinkUrl:function(a){this._linkUrlTextBox.set("value",a);y.set(this._linkUrlTextBox.domNode,
"data-old",a)},_setEmbedCode:function(a){this._embedCodeTextArea.set("value",'\x3ciframe width\x3d"'+this._widthTextBox.value+'" height\x3d"'+this._heightTextBox.value+'" frameborder\x3d"0" scrolling\x3d"no" allowfullscreen src\x3d"'+a+'"\x3e\x3c/iframe\x3e');y.set(this._embedCodeTextArea.domNode,"data-old-shortened",a)},_updateEmbedCodeFrameSize:function(a){a=this._embedCodeTextArea.get("value");a=a.replace(/width=\"[0-9]*\"/i,'width\x3d"'+this._widthTextBox.value+'"');a=a.replace(/height=\"[0-9]*\"/i,
'height\x3d"'+this._heightTextBox.value+'"');this._embedCodeTextArea.set("value",a)},_initOptions:function(){var a=[],b=this.map.getLevel();"number"===typeof b&&-1!==b?h.remove(this.chooseCenterWithLevelRow,"displaynone"):h.add(this.chooseCenterWithLevelRow,"displaynone");a=[];this.setlanguage_languages.removeOption(this.setlanguage_languages.getOptions());l.forEach(this.share.languages,function(b){var c={label:b,value:b};c.selected=b===g.locale?!0:!1;a.push(c)});this.setlanguage_languages.addOption(a);
b="";try{b=JSON.parse(u("esri_auth")).token}catch(L){console.log("ShareLink can't parse Auth:"+L)}b&&this.authtoken.set("value",b);b=new D({createMapResponse:this.map.webMapResponse,showLayerFromFeatureSet:!1,onlyShowVisible:!1,updateWhenLayerInfosIsShowInMapChanged:!1});h.add(b.domNode,"share-layerChooser-dropbox");this.layerChooserFromMapWithDropbox=new F({layerChooser:b});this.layerChooserFromMapWithDropbox.placeAt(this.queryFeature_layer);this.own(f(this.layerChooserFromMapWithDropbox,"selection-change",
n.hitch(this,this._updateQueryFeature_Layer)));"undefined"!==typeof this.map.spatialReference&&"undefined"!==typeof this.map.spatialReference.wkid&&this.addMarker_spatialReference.set("value",this.map.spatialReference.wkid)},_initOptionsEvent:function(){var b=a.has("ie")||a.has("edge")?"change":"KeyUp",d=c(".shareRadios",this.domNode);this.own(f(d,"click",n.hitch(this,function(a){this.optionSrc=y.get(a.srcElement||a.target,"data-id");this.updateUrl()})));d=c(".shareCheckBoxes",this.domNode);this.own(f(d,
"click",n.hitch(this,function(){this.updateUrl()})));this.own(f(this.chooseCenterWithLevel_levels,"change",n.hitch(this,function(){this.updateUrl()})));this.own(f(this.chooseCenterWithScale_scales,"change",n.hitch(this,function(){this.updateUrl()})));this.own(f(this.setlanguage_languages,"change",n.hitch(this,function(){this.updateUrl()})));this.own(f(this.findLocation_input,b,n.hitch(this,this.updateUrl)));this.own(f(this.queryFeature_field,"change",n.hitch(this,this._updateQueryFeature_Value)));
this.own(f(this.queryFeature_value,"change",n.hitch(this,this.updateUrl)));this.own(f(this.mobileLayout,b,n.hitch(this,this.updateUrl)));this.own(f(this.authtoken,b,n.hitch(this,this.updateUrl)));this.own(f(this.addMarker_marker,"click",n.hitch(this,function(a){this._onMarkersClick(a)})));this.own(f(this.addMarker_spatialReference,"change",n.hitch(this,this.updateUrl)));this.own(f(this.addMarker_title,b,n.hitch(this,this.updateUrl)));this.own(f(this.addMarker_symbolURL,b,n.hitch(this,this.updateUrl)));
this.own(f(this.addMarker_label,b,n.hitch(this,this.updateUrl)));this.own(f(this.addMarker_level,"change",n.hitch(this,this.updateUrl)));this.own(f(this.chooseCenterWithLevel_marker,"click",n.hitch(this,function(a){this._onMarkersClick(a)})));this.own(f(this.chooseCenterWithScale_marker,"click",n.hitch(this,function(a){this._onMarkersClick(a)})))},_onMarkersClick:function(a){this._unselectMarkerBtn();this._selectMarkerBtn(a);this._hidePopup();this._removeGraphicsLayer();this._mapClickHandler=f.once(this.map,
"click",n.hitch(this,this._onMapClick))},_onMapClick:function(a){var b=a.mapPoint;this._addGraphicsLayerMarker(a);"chooseCenterWithLevel"===this.optionSrc?this._hasZoomLevelMarkerAdded=!1:"chooseCenterWithScale"===this.optionSrc?this._hasMapScaleMarkerAdded=!1:"addMarker"===this.optionSrc&&(this._hasAddMarkerMarkerAdded=!1);this._unselectMarkerBtn();this.updateUrl(b);this._showPopup()},_hidePopup:function(){d.publish("ShareLink/onHideContainer")},_showPopup:function(){d.publish("ShareLink/onShowContainer")},
_updateResUrls:function(a){"currentMapExtent"===this.optionSrc?(a=this.getMapExtent(this.map),this.resultUrl=b.addQueryParamToUrl(this.baseHrefUrl,"extent",a,!0)):"chooseCenterWithLevel"===this.optionSrc?(!1===this._hasZoomLevelMarkerAdded&&(this.resultUrl=b.addQueryParamToUrl(this.baseHrefUrl,"center",this.getMapCenter(this.map,a),!0),a&&a.x&&a.y&&(this._hasZoomLevelMarkerAdded=!0)),this.resultUrl=b.addQueryParamToUrl(this.resultUrl,"level",this._getMapLevel(),!0)):"chooseCenterWithScale"===this.optionSrc?
(!1===this._hasMapScaleMarkerAdded&&(this.resultUrl=b.addQueryParamToUrl(this.baseHrefUrl,"center",this.getMapCenter(this.map,a),!0),a&&a.x&&a.y&&(this._hasMapScaleMarkerAdded=!0)),this.resultUrl=b.addQueryParamToUrl(this.resultUrl,"scale",this._getMapScale(),!0)):"findLocation"===this.optionSrc?(a=this.findLocation_input.get("value"),this.resultUrl=b.addQueryParamToUrl(this.baseHrefUrl,"find",a,!0)):"queryFeature"===this.optionSrc?this._updateUrlByQueryFeatures():"addMarker"===this.optionSrc&&(!1===
this._hasAddMarkerMarkerAdded?(this.resultUrl=b.addQueryParamToUrl(this.baseHrefUrl,"marker",this.getMapCenter(this.map,a,null,this._getWkid()),!0),this.resultUrl+=",",a&&a.x&&a.y&&(this._hasAddMarkerMarkerAdded=!0,this._lastAddMarkerParamObj=a)):(this.resultUrl=b.addQueryParamToUrl(this.baseHrefUrl,"marker",this.getMapCenter(this.map,this._lastAddMarkerParamObj,null,this._getWkid()),!0),this.resultUrl+=","),this.resultUrl+=encodeURIComponent(this.addMarker_title.get("value")||""),this.resultUrl+=
",",this.resultUrl+=encodeURIComponent(this.addMarker_symbolURL.get("value")||""),this.resultUrl+=",",this.resultUrl+=encodeURIComponent(this.addMarker_label.get("value")||""),a=this._getMapLevel(),this.resultUrl="number"===typeof a&&-1!==a?b.addQueryParamToUrl(this.resultUrl,"level",this._getMapLevel(),!0):b.addQueryParamToUrl(this.resultUrl,"scale",this._getMapScale(),!0));this.resultUrl=b.removeQueryParamFromUrl(this.resultUrl,"mobileBreakPoint",!0);this.resultUrl=b.removeQueryParamFromUrl(this.resultUrl,
"locale",!0);this.resultUrl=b.removeQueryParamFromUrl(this.resultUrl,"token",!0);this.overwirteMobileLayout.checked&&(this.resultUrl=b.addQueryParamToUrl(this.resultUrl,"mobileBreakPoint",this.mobileLayout.getValue(),!0));this.setlanguage.checked&&(this.resultUrl=b.addQueryParamToUrl(this.resultUrl,"locale",this.setlanguage_languages.getValue(),!0));this.auth.checked&&(this.resultUrl=b.addQueryParamToUrl(this.resultUrl,"token",this.authtoken.getValue(),!0))},_updateUrlByQueryFeatures:function(){var a=
this._getIdFromLayerChoose()||"",c=this.queryFeature_field.get("value"),d=this.queryFeature_value.get("value");this.resultUrl=b.addQueryParamToUrl(this.baseHrefUrl,"query",a,!0);c&&(this.resultUrl+=",",this.resultUrl+=c,d&&(this.resultUrl+=",",this.resultUrl+=d))},_updateQueryFeature_Layer:function(){this._updateUrlByQueryFeatures();this._updateQueryFeature_Field();this._updateQueryFeature_Value();this.updateUrl()},_updateQueryFeature_Field:function(){var a=this._getFieldsFromLayerChoose(),b=[];this.queryFeature_field.removeOption(this.queryFeature_field.getOptions());
l.forEach(a,n.hitch(this,function(a){-1<"esriFieldTypeString esriFieldTypeOID esriFieldTypeSmallInteger esriFieldTypeInteger esriFieldTypeSingle esriFieldTypeDouble".split(" ").indexOf(a.type)&&b.push({label:a.name,value:a.name})}));this.queryFeature_field.addOption(b);this._updateUrlByQueryFeatures();this._updateQueryFeature_Value();this.updateUrl()},_updateQueryFeature_Value:function(){var a=[],b=this.queryFeature_field.get("value");a.push(b);this._query(a,this._getUrlFromLayerChoose(),this.map).then(n.hitch(this,
function(a){var c=[],c=this._getQueryedValues(b,a);this.queryFeature_value.removeOption(this.queryFeature_value.getOptions());this.queryFeature_value.addOption(c);this._updateUrlByQueryFeatures();this.updateUrl()}))},_getIdFromLayerChoose:function(){var a=null,b=this.layerChooserFromMapWithDropbox.getSelectedItem();b&&b.layerInfo&&b.layerInfo.id&&(a=b.layerInfo.id);return a},_getFieldsFromLayerChoose:function(){var a=[],b=this.layerChooserFromMapWithDropbox.getSelectedItem();b&&b.layerInfo&&b.layerInfo.layerObject&&
b.layerInfo.layerObject.fields&&(a=b.layerInfo.layerObject.fields);return a},_getUrlFromLayerChoose:function(){var a="",b=this.layerChooserFromMapWithDropbox.getSelectedItem();b&&b.url&&(a=b.url);return a},_updateLinkOptionsUI:function(){c(".optionsMore",this.domNode).style("display","none");c("."+this.optionSrc+"_optionsMore",this.domNode).style("display","block");this.overwirteMobileLayout.checked&&c(".share-options-overwirteMobileLayout_optionsMore",this.domNode).style("display","block");this.setlanguage.checked&&
c(".share-options-language_optionsMore",this.domNode).style("display","block");this.auth.checked&&c(".share-options-auth_optionsMore",this.domNode).style("display","block")},_fixUrlIfIsOnline:function(a){if(this._isOnline&&this._isSharedToPublic){var b="",b=window.isBuilder?window.top.location.protocol:window.location.protocol,c=this._getUrlQueryString(a);a=this._getOnlinePublicUrl(a);a=b+"//"+a+"/apps/webappviewer/index.html"+c}return a},updateUrl:function(a){this._updateResUrls(a);this._updateLinkOptionsUI();
this.preview.set("value",this._fixUrlIfIsOnline(this.resultUrl));null===a&&this._generateShortenUrl()},_generateShortenUrl:function(){var a=this.preview.get("value");try{this.isUseShortenUrl()?this.shortenUrl(a,this.bitlyUrl).then(n.hitch(this,function(a){this._useShortenUrl(a);this.HAS_INIT_URL=!0}),n.hitch(this,function(b){this._useLengthenUrl(a,b);this.HAS_INIT_URL=!0})):(this._useLengthenUrl(a),this.HAS_INIT_URL=!0)}catch(M){console.error(M),this.HAS_INIT_URL=!0}},_useShortenUrl:function(a){this.shortenedUrl=
a;this._setLinkUrl(a);this._setEmbedCode(a)},_useLengthenUrl:function(a){a=a||"";this._setLinkUrl(a);this._setEmbedCode(a)},_toFacebook:function(){var b="http://www.facebook.com/sharer/sharer.php?s\x3d100\x26u\x3d"+encodeURIComponent(this._linkUrlTextBox.get("value"))+"\x26t\x3d"+encodeURIComponent(a.stripHTML(this.socialNetworkTitle(this._appTitle)));window.open(b,"_blank")},_toTwitter:function(){var b=r.substitute(this.share.shareTwitterTxt,{appTitle:a.stripHTML(this._appTitle)}),c=this._linkUrlTextBox.get("value");
window.open("http://twitter.com/home?status\x3d"+encodeURIComponent(b+c+"\n@ArcGISOnline"),"_blank")},_toEmail:function(){var b="mailto:?subject\x3d"+r.substitute(this.share.shareEmailSubject,{appTitle:a.stripHTML(this._appTitle)}),c=this.preview.get("value"),b=b+("\x26body\x3d"+encodeURIComponent(this.nls.shareEmailTxt1)+"%0D%0A%0D%0A"+a.stripHTML(this._appTitle)),b=b+("%0D%0A"+encodeURIComponent(c)),b=b+("%0D%0A%0D%0A"+encodeURIComponent(this.nls.shareEmailTxt2)),b=b+("%0D%0A%0D%0A"+encodeURIComponent(this.nls.shareEmailTxt3));
window.top.location.href=b},_toGooglePlus:function(){var a=this._linkUrlTextBox.get("value"),a="http://plus.google.com/share?url\x3d"+encodeURIComponent(a);window.open(a,"_blank")},_toggleLinkOptions:function(){var a=c(".shareOptionsWrapper",this.domNode.parentNode||this.domNode.parentElement),b=c(".shareUrlsWrapper",this.domNode),e=c(".shareLinkOptionsWrapper",this.domNode);this._isShareLinkOptionsShow()?(d.publish("ShareLink/onHideLinkOptions"),this._cleanMarkerStatus(),this._generateShortenUrl()):
d.publish("ShareLink/onShowLinkOptions");a&&a[0]&&h.toggle(a[0],"displaynone");h.toggle(b[0],"displaynone");h.toggle(e[0],"displaynone")},_moreOptionsExpandCollapse:function(){h.toggle(this.MoreOptionsContainer,"displaynone");h.toggle(this.MoreOptionsIcon,"rotate")},_setInputsClicktoSelect:function(a){y.set(a,"onclick","this.select()");y.set(a,"onmouseup","return false;")},isUseShortenUrl:function(){return location.hostname.endWith("esri.com")||location.hostname.endWith("arcgis.com")?!0:!1},shortenUrl:function(a,
c){var d=new w;a=b.addQueryParamToUrl(c,"longUrl",a,!0);a=b.addQueryParamToUrl(a,"format","json",!0);z({url:a,handleAs:"json",callbackParamName:"callback"}).then(n.hitch(this,function(a){a&&200===a.status_code&&a.data&&a.data.url&&0<a.data.url.length?d.resolve(a.data.url):d.reject(a)}),n.hitch(this,function(a){console.log("can't fetch shortenUrl "+a);d.reject(a)}));return d},socialNetworkTitle:function(a){100<a.length&&(a=a.substring(0,97)+"...");return a},getMapExtent:function(a){a=a.extent;var b=
"";a.spatialReference.wkid?b=a.spatialReference.wkid:!a.spatialReference.wkid&&a.spatialReference.wkt&&(b="wkt\x3d"+a.spatialReference.wkt);return null!==a?this._roundValue(a.xmin,1E4)+","+this._roundValue(a.ymin,1E4)+","+this._roundValue(a.xmax,1E4)+","+this._roundValue(a.ymax,1E4)+","+b:""},_roundValue:function(a,b){return Math.round(a*b)/b},getMapCenter:function(a,b,c,d){c=c?c:",";var e=null;b&&b.x&&b.y?e=b:a.extent.getCenter()&&(e=a.extent.getCenter());a=d||e.spatialReference.wkid;return null!==
e?this._roundValue(e.x,1E4)+c+this._roundValue(e.y,1E4)+c+a:""},_getMapLevel:function(){return this.map.getLevel()},_getMapScale:function(){return this.map.getScale()},_getWkid:function(){return this.addMarker_spatialReference.get("value")||""},_query:function(a,b,c){var d=new x;d.where="1\x3d1";d.outSpatialReference=c.spatialReference;d.outFields=a;return(new A(b)).execute(d)},_getQueryedValues:function(a,b){var c=[];l.forEach(b.features,n.hitch(this,function(b){b=b.attributes[a]+"";c.push({label:b,
value:b})}));return c},_addGraphicsLayer:function(){window.isBuilder||"undefined"!==typeof this._graphicsLayer||(this._graphicsLayer=new E,this.map.addLayer(this._graphicsLayer))},_removeGraphicsLayer:function(){window.isBuilder||"undefined"===typeof this._graphicsLayer||(this._graphicsLayer.remove(this._markerGraphic),this._markerGraphic=null)},_addGraphicsLayerMarker:function(a){window.isBuilder||"undefined"===typeof this._graphicsLayer||(this._markerGraphic=this._getMarkerGraphic(a.mapPoint),this._graphicsLayer.add(this._markerGraphic))},
_getMarkerGraphic:function(a){var b=new C(require.toUrl("jimu")+"/images/EsriBluePinCircle26.png",26,26);b.setOffset(0,12);return new B(a,b)},_unselectMarkerBtn:function(){for(var a=c(".markers",this.domNode),b=0,d=a.length;b<d;b++)h.remove(a[b],"selected")},_selectMarkerBtn:function(a){h.add(a.srcElement||a.target,"selected")},_cleanMarkerStatus:function(){this._mapClickHandler&&this._mapClickHandler.remove&&this._mapClickHandler.remove();this._unselectMarkerBtn();this._removeGraphicsLayer()},_isShareLinkOptionsShow:function(){var a=
c(".shareLinkOptionsWrapper",this.domNode);return!h.contains(a[0],"displaynone")},_getUrlQueryString:function(a){var b="";-1!==a.indexOf("?")&&(b=a.substring(a.indexOf("?")));return b},_getOnlinePublicUrl:function(){var a="www.arcgis.com",b=this._portalUrl;b&&"string"===typeof b&&(-1<b.indexOf("devext.arcgis.com")?a="devext.arcgis.com":-1<b.indexOf("qaext.arcgis.com")&&(a="qaext.arcgis.com"));return a}})})},"jimu/dijit/FeaturelayerChooserFromMap":function(){define(["dojo/_base/declare","dojo/Deferred",
"dojo/_base/html","dojo/_base/lang","./LayerChooserFromMap"],function(k,e,p,q,n){return k([n],{baseClass:"jimu-featurelayer-chooser-from-map",declaredClass:"jimu.dijit.FeaturelayerChooserFromMap",types:null,showLayerFromFeatureSet:!1,showTable:!1,onlyShowVisible:!1,ignoredFeaturelayerIds:null,mustSupportStatistics:!1,ignoreVirtualLayer:!1,postMixInProperties:function(){this.inherited(arguments);this.ignoredFeaturelayerIds||(this.ignoredFeaturelayerIds=[]);this.basicFilter=q.hitch(this,this.basicFilter);
this.filter=n.createFeaturelayerFilter(this.types,this.showLayerFromFeatureSet,this.showTable,this.mustSupportStatistics);this.ignoreVirtualLayer&&(this.filter=n.andCombineFilters([this.filter,q.hitch(this,this._ignoreVirtualLayerFilter)]))},postCreate:function(){this.inherited(arguments);p.addClass(this.domNode,"jimu-basic-layer-chooser-from-map")},_ignoreVirtualLayerFilter:function(e){return e.getLayerType().then(function(e){return!("ArcGISDynamicMapServiceLayer"===e||"ArcGISTiledMapServiceLayer"===
e||"GroupLayer"===e)})},basicFilter:function(k){var h=new e;0<=this.ignoredFeaturelayerIds.indexOf(k.id)?h.resolve(!1):this.onlyShowVisible&&"Table"!==k.getLayerType()?h.resolve(k.isShowInMap()):h.resolve(!0);return h},getHandledItem:function(e){var h=this.inherited(arguments),f=e&&e.layerInfo,f=f&&f.layerObject;h.url=f&&f.url||"";return h}})})},"jimu/dijit/LayerChooserFromMapWithDropbox":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/on dojo/Evented dojo/Deferred dijit/popup dijit/_WidgetBase dijit/_TemplatedMixin dojo/text!./templates/LayerChooserFromMapWithDropbox.html jimu/LayerInfos/LayerInfos".split(" "),
function(k,e,p,q,n,l,h,f,d,c,a){return k([f,d,n],{templateString:c,baseClass:"jimu-layer-chooser-from-map-withdropbox",declaredClass:"jimu.dijit.LayerChooserFromMapWithDropbox",_selectedItem:null,_isLayerChooserShow:!1,layerInfosObj:null,layerChooser:null,postCreate:function(){this.inherited(arguments);this.layerInfosObj=a.getInstanceSync();this.layerChooser.domNode.style.zIndex=1;this.layerChooser.tree.domNode.style.borderTop="0";this.layerChooser.tree.domNode.style.maxHeight="290px";this.own(q(this.layerChooser,
"tree-click",e.hitch(this,this._onTreeClick)));this.own(q(this.layerChooser,"update",e.hitch(this,this._onLayerChooserUpdate)));this.own(q(document.body,"click",e.hitch(this,this._onBodyClicked)))},destroy:function(){this.hideLayerChooser();this.layerChooser&&this.layerChooser.destroy();this.layerChooser=null;this.inherited(arguments)},getLayerChooser:function(){return this.layerChooser},setSelectedLayer:function(a){var b=new l;if(a){var c=this.layerInfosObj.getLayerInfoById(a.id);c?this.layerChooser.filter(c).then(e.hitch(this,
function(d){d?(this._onSelectNewItem({layerInfo:c,name:c.title,url:a.url}),b.resolve(!0)):b.resolve(!1)}),e.hitch(this,function(){b.resolve(!1)})):b.resolve(!1)}else this._onSelectNewItem(null),b.resolve(!0);return b},getSelectedItem:function(){return this._selectedItem},getSelectedItems:function(){return[this._selectedItem]},_onBodyClicked:function(a){a=a.target||a.srcElement;a===this.domNode||p.isDescendant(a,this.domNode)||a===this.layerChooser.domNode||p.isDescendant(a,this.layerChooser.domNode)||
this.hideLayerChooser()},_onDropDownClick:function(a){a.stopPropagation();a.preventDefault();this._isLayerChooserShow?this.hideLayerChooser():this.showLayerChooser()},_getSelectedItems:function(){return this.layerChooser.getSelectedItems()},showLayerChooser:function(){this.layerChooser.domNode.style.width=this.domNode.clientWidth+2+"px";h.open({parent:this,popup:this.layerChooser,around:this.domNode});var a=this.layerChooser.domNode.parentNode;a&&p.addClass(a,"jimu-layer-chooser-from-map-withdropbox-popup");
this._isLayerChooserShow=!0},hideLayerChooser:function(){h.close(this.layerChooser);this._isLayerChooserShow=!1},_onLayerChooserUpdate:function(){this._selectedItem&&this.layerChooser.onlyShowVisible&&!this._selectedItem.layerInfo.isShowInMap()&&(this._selectedItem=null,this.emit("selection-change",[]))},_onSelectNewItem:function(a){var b=e.getObject("layerInfo.id",!1,this._selectedItem)||-1,c=e.getObject("layerInfo.id",!1,a)||-1,b=b!==c;this._selectedItem=a;this.hideLayerChooser();a=e.getObject("layerInfo.title",
!1,this._selectedItem)||"";this.layerNameNode.innerHTML=a;p.setAttr(this.layerNameNode,"title",a);a=e.getObject("layerInfo.layerObject",!1,this._selectedItem);b&&this.emit("selection-change",[a])},_onTreeClick:function(){var a=this._getSelectedItems();this._onSelectNewItem(0<a.length?a[0]:null)}})})},"builder/plugins/startup/_build-generate_module":function(){define(["builder/plugins/startup/Plugin","dojo/text!builder/plugins/startup/Plugin.html","dojo/text!builder/plugins/startup/css/style.css"],
function(){})},"builder/plugins/startup/Plugin":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/topic builder/BasePlugin builder/serviceUtils jimu/dijit/ViewStack jimu/utils".split(" "),function(k,e,p,q,n,l,h,f){return k([n],{baseClass:"plugin-startup",constructor:function(){this.appTypes=["HTML","HTML3D"]},postCreate:function(){this.main=new h({viewType:"dijit",views:[]},this.viewStackNode)},startup:function(){this.main.startup();this._loadHeaderPlugin().then(e.hitch(this,
function(){this._afterHeaderLoaded()}))},getCurrentView:function(){return this.main.getSelectedView()},switchToAppList:function(){var d=e.hitch(this,function(){if(window.history&&window.history.pushState){this._switchToAppList();var c=f.url.removeQueryParamFromUrl(window.location.href,"id");window.history.pushState({path:c},"",c)}else window.location.href="index.html"});document.title="Web AppBuilder for ArcGIS";"appconfig"===this.main.getSelectedLabel()?q.publish("closeAppConfigPage",d):""===this.main.getSelectedLabel()&&
(p.empty(this.viewStackNode),d())},switchToAppConfig:function(d){var c=window.location.href;window.queryObject.id?(c=f.url.removeQueryParamFromUrl(c,"id"),c=f.url.addQueryParamToUrl(c,"id",d.id)):window.queryObject.appid?(c=f.url.removeQueryParamFromUrl(c,"appid"),c=f.url.addQueryParamToUrl(c,"appid",d.id)):(c=f.url.removeQueryParamFromUrl(c,"title"),c=f.url.removeQueryParamFromUrl(c,"tags"),c=f.url.removeQueryParamFromUrl(c,"summary"),c=f.url.removeQueryParamFromUrl(c,"folder"),c=f.url.removeQueryParamFromUrl(c,
"sharewithwebmap"),c=f.url.removeQueryParamFromUrl(c,"webmap"),c=f.url.removeQueryParamFromUrl(c,"sharewithwebscene"),c=f.url.removeQueryParamFromUrl(c,"webscene"),c=f.url.removeQueryParamFromUrl(c,"appType"),c=f.url.addQueryParamToUrl(c,"id",d.id));if(window.location.href!==c)if(window.history&&window.history.pushState)window.history.pushState({path:c},"",c);else{window.location.href=c;return}this._switchToApp(d)},_afterHeaderLoaded:function(){var d;if(window.isXT)queryObject.id?(d={id:queryObject.id.replace("#",
"")},this._switchToApp(d)):this._switchToAppList();else if(queryObject.id)d={id:queryObject.id.replace("#","")},this._switchToApp(d);else if(queryObject.appid)d={appid:queryObject.appid.replace("#","")},this._switchToApp(d);else if(queryObject.title){d={name:queryObject.title};queryObject.tags&&(d.tags=queryObject.tags);queryObject.summary&&(d.description=queryObject.summary);queryObject.folder&&(d.folderId=queryObject.folder);if(queryObject.sharewithwebmap||queryObject.sharewithwebscene)d.sharing=
"true"===queryObject.sharewithwebmap||"true"===queryObject.sharewithwebscene;queryObject.appType?(d.appType=queryObject.appType,queryObject.webmap&&(d.webmap=queryObject.webmap),queryObject.webscene&&(d.webscene=queryObject.webscene)):queryObject.webmap?(d.webmap=queryObject.webmap,d.appType="HTML"):queryObject.webscene?(d.webscene=queryObject.webscene,d.appType="HTML3D"):d.appType="HTML";this._createApp(d)}else window.location.href=window.portalUrl},_switchToApp:function(d){var c=this.main.getViewByLabel("appconfig");
c&&this.main.removeView(c);"stemapp"===d.id&&(d.id="HTML");"stemapp3d"===d.id&&(d.id="HTML3D");l.getAppInfo(d.id||d.appid).then(e.hitch(this,function(a){if("undefined"===typeof a.id)this.viewStackNode.innerHTML='\x3cimg class\x3d"image-404" src\x3d"'+this.folderUrl+'images/404.png"\x3e';else{var b=this.pluginManager.getStemappInfo(a.appType);b.name="HTML3D"===b.appType?"stemapp3d":"stemapp";var c;c=-1<this.appTypes.indexOf(d.id)?b.appPath:window.isXT?window.path+"apps/"+a.id+"/":"HTML3D"===a.appType?
window.path+"stemapp3d/":window.path+"stemapp/";window.stemappInfo=b;window.appInfo={appType:a.appType,appPath:c,appOwner:a.creator||a.owner,id:a.id,name:a.name,isPredefined:a.isPredefined,isTemplate:a.isTemplate,isTemplateApp:a.isTemplateApp};b=this.filterExtensionsByAppType("app-config",a.appType);0===b.length?console.error("Do not find app-config extension."):1<b.length?console.error("Find more than one app-config extension."):(b=this.pluginsMeta[b[0].pluginName],b.options={appInfo:a},this.pluginManager.loadPlugin(b).then(e.hitch(this,
function(a){a.label="appconfig";this.main.addView(a);this.main.switchView("appconfig")})),this._showAppName(a))}}))},_showAppName:function(d){"stemapp"===d.id?this.header.setAppName("stemapp"):d.isTemplate?this.header.setAppName(builderNls.templateLabel+" "+d.name):this.header.setAppName(d.name);document.title=d.name+" - Web AppBuilder for ArcGIS"},_hideAppName:function(){this.header.setAppName("")},_createApp:function(d){var c=this.pluginManager.getStemappInfo(d.appType);c.name="HTML3D"===c.appType?
"stemapp3d":"stemapp";window.stemappInfo=c;c=this.pluginManager.getExtensions("startup.creation-entry")[0];this.pluginManager.loadPlugin(this.pluginsMeta[c.pluginName]).then(e.hitch(this,function(a){a.createNewApp(d)}))},_switchToAppList:function(){if(this.main.getViewByLabel("applist"))this.main.switchView("applist");else{var d=this.getPluginsMetaByExtensionPoint("app-list")[0];this.pluginManager.loadPlugin(d).then(e.hitch(this,function(c){c.label="applist";this.main.addView(c);this.main.switchView("applist")}))}this._hideAppName()},
_loadHeaderPlugin:function(){var d=this.getPluginsMetaByExtensionPoint("header")[0];return this.pluginManager.loadPlugin(d).then(e.hitch(this,function(c){p.place(c.domNode,this.headerNode);c.startup();return this.header=c}))}})})},"builder/plugins/stemapps/web2d/_build-generate_module":function(){define([],function(){})},"builder/plugins/stemapps/web3d/_build-generate_module":function(){define([],function(){})},"builder/plugins/theme-config/_build-generate_module":function(){define(["builder/plugins/theme-config/Plugin",
"dojo/text!builder/plugins/theme-config/Plugin.html","dojo/text!builder/plugins/theme-config/css/style.css","dojo/i18n!builder/plugins/theme-config/nls/strings"],function(){})},"builder/plugins/theme-config/Plugin":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/_base/Color dojo/topic dojo/on dojo/dom dojo/cookie dojo/query dojo/text!./Plugin.html dojo/dom-construct dojo/dom-style dojo/_base/array dojo/Deferred dojo/promise/all jimu/dijit/Message jimu/dijit/CheckBox ./ThemeColorChooser ./ThemeManager builder/serviceUtils builder/BasePlugin jimu/utils jimu/portalUtils".split(" "),
function(k,e,p,q,n,l,h,f,d,c,a,b,g,u,m,r,t,v,y,w,z,x,A){return k([z],{baseClass:"plugin-theme-config",templateString:c,themeLoadDef:void 0,_themePageDef:void 0,_disableShowThemeSwitchMessage:null,constructor:function(){this._themePageDef=new u;this._disableShowThemeSwitchMessage=!0},postMixInProperties:function(){this.inherited(arguments);this.nls=e.mixin(this.nls,builderNls)},postCreate:function(){this.inherited(arguments);this.own(n.subscribe("app/appConfigLoaded",e.hitch(this,this._onAppConfigLoaded)));
this.own(n.subscribe("app/appConfigChanged",e.hitch(this,this._onAppConfigChanged)));this.own(n.subscribe("app/editLayout",e.hitch(this,this._onEditLayout)))},startup:function(){this.inherited(arguments);this.themeManager=new y;this.themeLoadDef=this.themeManager.loadThemes();this.themeLoadDef.then(e.hitch(this,function(a){this.initThemePage(a);this._themePageDef.resolve()}));this.portalSelfDef=A.getPortal(window.portalUrl).loadSelfInfo()},initThemePage:function(b){var c,d,f,h,k,m;g.forEach(b,function(b){h=
p.create("div",{"class":"catalog-theme-content-div jimu-float-leading"},this.themeList);c=p.create("div",{"class":"catalog-theme-div","data-themeName":b.getName()},h);p.create("div",{"class":"catalog-theme-name-div",innerHTML:b.getLabel(),title:b.getLabel()},h);k=p.create("div",{"class":"catalog-theme-img-box-div"},c);m=p.create("div",{"class":"catalog-theme-img-div"},k);a.create("img",{src:b.getIcon(),"class":"catalog-theme-img"},m);l(c,"click",e.hitch(this,this._onStartChangeTheme,b.getName()));
d=a.create("div",{"class":""},this.styleList);this.initStyle(b,d);f=a.create("div",{"class":""},this.layoutList);this.initLayout(b,f);b.domNodes.theme=c;b.domNodes.themeImgBox=k;b.domNodes.themeSL=void 0;b.domNodes.styleList=d;b.domNodes.layoutList=f},this)},initStyle:function(c,d){var f,h,k;f=a.create("div",{"class":"style-section"},d);a.create("div",{innerHTML:this.nls.styleTitle,"class":"style-text"},f);k=a.create("div",{"class":"style-color-content"},f);var m=c.getStyles().slice();f=m.pop();g.forEach(m,
function(c){h=a.create("div",{"class":"style-div jimu-float-leading"},k);b.set(h,"backgroundColor",c.styleColor);c.domNode=h;l(h,"click",e.hitch(this,this._onStyleChanged,c.name))},this);h=a.create("div",{"class":"style-div jimu-float-leading"},k);m=new v({showLabel:!0,recordUID:x.getColorRecordName("theme-config-Plugin")},h);f.domNode=m.domNode;f.isCustom=!0;m.domNode.className+=" style-div jimu-float-leading";c._wabDefaultColor=f.styleColor;m.setColor(new q(c._wabDefaultColor));m.setTitle(this.nls.setCustomColor);
m.startup();this.own(l(m,"clickContainer",e.hitch(this,function(a,b){b.toHex()!==(a.appConfig.theme.customStyles&&a.appConfig.theme.customStyles.mainBackgroundColor)&&this._setThemeStyleToColor(a,b,!0)},c)));this.own(l(m,"sharedThemeChanged",e.hitch(this,function(a,b,c){b.toHex()!==(a.appConfig.theme.customStyles&&a.appConfig.theme.customStyles.mainBackgroundColor)&&this._setThemeStyleToColor(a,b,!0);a=e.mixin(a.appConfig.theme.sharedTheme,c);n.publish("sharedThemeChanged",a)},c)));c._cp=m;c._lastStyle=
f;p.setStyle(d,"display","none")},initLayout:function(b,c){var d;d=a.create("div",{"class":"layout-section",id:b.getName()+"-layout-section"},c);a.create("div",{innerHTML:this.nls.layoutTitle,"class":"layout-text"},d);g.forEach(b.getLayouts(),function(a){this._drawLayout(b,a,d)},this);p.setStyle(c,"display","none")},_drawLayout:function(b,c,d){var f;c.domClass||(c.domClass=" ");d=a.create("div",{"class":"layout-out-div jimu-float-leading "},d);f=a.create("div",{"class":"layout-box-div "},d);d=a.create("div",
{"class":"layout-div "+c.domClass},f);b=isRTL?c.RTLIcon?b.getUrl()+c.RTLIcon:this.folderUrl+"css/images/current_layout.png":c.icon?b.getUrl()+c.icon:this.folderUrl+"css/images/current_layout.png";a.create("img",{"class":"layout-image",src:b},d);c.domNode=d;c.boxDomNode=f;l(d,"click",e.hitch(this,this._onLayoutChanged,c.name));b=a.create("div",{"class":"layout-selected-div"},d);a.create("img",{"class":"layout-selected-img",src:this.folderUrl+"css/images/check.png"},b);c.selectedNode=b},_onStyleChanged:function(a){this.changeStyle(a,
null,!0)},_onLayoutChanged:function(a){this.changeLayout(a,null,!0)},_onStartChangeTheme:function(a){if(this.themeManager.currentThemeName!==a)if(this._disableShowThemeSwitchMessage)this.changeTheme(a,!0);else if(f("disable_theme_switch_Message"))this.changeTheme(a,!0);else{var b=new r({message:"\x3cdiv\x3e"+this.nls.themeChangeMessage+"\x3c/div\x3e",width:500,buttons:[{label:this.nls.ok,onClick:e.hitch(this,function(){c.checked&&f("disable_theme_switch_Message",!0);b.close();this.changeTheme(a,!0)})},
{label:this.nls.cancel}]}),c=new t({label:this.nls.disableThemeSwitchMessage,"class":"jimu-float-leading",style:{marginTop:"10px"}});c.placeAt(b.contentContainerNode)}},changeStyle:function(a,b,c){b||(b=this.themeManager.getCurrentTheme());var d=b.getCurrentStyle();if(b.currentStyleName!==a||d&&d.name===a&&d.isCustom)b.currentStyleName&&p.removeClass(b.getCurrentStyle().domNode,"style-selected"),b.changeCurrentStyle(a),p.addClass(b.getCurrentStyle().domNode,"style-selected"),c&&n.publish("styleChanged",
e.clone(b.getCurrentStyle()))},changeLayout:function(a,b,c){b||(b=this.themeManager.getCurrentTheme());b.currentLayoutName!==a&&(b.currentLayoutName&&(p.removeClass(b.getCurrentLayout().domNode,"layout-selected"),p.removeClass(b.getCurrentLayout().boxDomNode,"layout-box-selected")),b.changeCurrentLayout(a),p.addClass(b.getCurrentLayout().domNode,"layout-selected"),p.addClass(b.getCurrentLayout().boxDomNode,"layout-box-selected"),c&&n.publish("layoutChanged",e.clone(b.getCurrentLayout())))},_copyThemeFromRepo:function(a){var b=
new u,c=this.themeManager.getThemeByName(a);c.loadLayouts().then(e.hitch(this,function(){var d=c.getLayoutByName("default");w.copyThemeToApp(window.appInfo.id,a,c.appConfig?c.appConfig.getCleanConfig():d.layoutConfig).then(e.hitch(this,function(a){a.success?b.resolve():(b.reject(),console.error("change theme error, response of 'copytheme' unsuccess"))}),function(a){b.reject(a);console.error("change theme error"+a)})}));return b},changeTheme:function(a,b){var c=new u;this.themeManager.currentThemeName!==
a?(b&&this.pluginManager.getPluginByName("app-config").showLoadingCover(),this._copyThemeFromRepo(a).then(e.hitch(this,function(){this.themeManager.currentThemeName&&(p.removeClass(this.themeManager.getCurrentTheme().domNodes.theme,"catalog-theme-selected"),p.removeClass(this.themeManager.getCurrentTheme().domNodes.themeImgBox,"selected"),p.setStyle(this.themeManager.getCurrentTheme().domNodes.styleList,"display","none"),p.setStyle(this.themeManager.getCurrentTheme().domNodes.layoutList,"display",
"none"));this.themeManager.changeCurrentTheme(a);if(b){var d=this.themeManager.getCurrentTheme(),f=d._cp;delete d._cp;n.publish("themeChanged",e.clone(d));d._cp=f}p.addClass(this.themeManager.getCurrentTheme().domNodes.theme,"catalog-theme-selected");p.addClass(this.themeManager.getCurrentTheme().domNodes.themeImgBox,"selected");p.setStyle(this.themeManager.getCurrentTheme().domNodes.styleList,"display","block");p.setStyle(this.themeManager.getCurrentTheme().domNodes.layoutList,"display","block");
d=h.byId(this.themeManager.getCurrentTheme().getName()+"-layout-section");this._toggleEditLayoutButton(this.themeManager.getCurrentTheme().getLayoutByName("default"),d);c.resolve()}))):c.resolve();return c},_onAppConfigLoaded:function(a){this._setAppConfig(a,!0);this._listenConfigPreviewWindowResizeEvent()},_listenConfigPreviewWindowResizeEvent:function(){var a=d(".preview-config\x3eiframe")[0],b=a?a.contentWindow:null;b&&(this.configWin=b,l(b,"resize",e.hitch(this,function(){this.editLayoutButton&&
(b.appInfo.isRunInMobile?p.setStyle(this.editLayoutButton,"display","none"):p.setStyle(this.editLayoutButton,"display","block"))})))},_onAppConfigChanged:function(a,b){this._setAppConfig(a,!1,b)},_setAppConfig:function(a,b,c){var d;m([this._themePageDef,this.portalSelfDef]).then(e.hitch(this,function(f){f=f[1];if(b){var h=e.getObject("portalProperties.sharedTheme.header.background",!1,f);g.forEach(this.themeManager.themes,function(b){a.theme.sharedTheme.isPortalSupport&&a.theme.sharedTheme.useHeader?
(h||(h=b._wabDefaultColor),this._setThemeStyleToColor(b,h,!1)):this.changeStyle("default",b,!1);this.changeLayout("default",b,!1);var c=e.getObject("theme.sharedTheme",!1,a);b._cp.setSharedThemeConfig(c);b.clear()},this);this.changeTheme(a.theme.name,!1).then(e.hitch(this,function(){a.theme.styles&&a.theme.styles[0]&&this.changeStyle(a.theme.styles[0],this.themeManager.getCurrentTheme(),!1);this._setLayout(a);d=this.themeManager.getCurrentTheme().getLayoutByAppConfig(a.getCleanConfig());d||(d=this.themeManager.getCurrentTheme().addLayout("appLayout",
a.getCleanConfig(),"app-layout",this.nls.appLayout),this._drawLayout(this.themeManager.getCurrentTheme(),d,void 0));this.changeLayout(d.name,this.themeManager.getCurrentTheme(),!1);this.resetStyleForOrgOrCustom(a,b,c);p.setStyle(this.themeList,"display","block")}))}else this.resetStyleForOrgOrCustom(a,b,c),this._setLayout(a)}))},_setLayout:function(a){var b,c=a.getCleanConfig();b=h.byId(this.themeManager.getCurrentTheme().getName()+"-layout-section");var d=this.themeManager.getCurrentTheme();a=d.getLayoutByAppConfig(a.getCleanConfig());
a||((a=d.getLayoutByName("appLayout"))?a.layoutConfig=c:(a=d.addLayout("appLayout",c,"app-layout",this.nls.appLayout),this._drawLayout(d,a,b)));this.changeLayout(a.name,d,!1)},_toggleEditLayoutButton:function(b,c){this._loadLayoutManager(b.layoutConfig.layoutDefinition?b.layoutConfig.layoutDefinition.manager:"jimu/layoutManagers/AbsolutePositionLayoutManager").then(e.hitch(this,function(b){b.isSupportEdit()&&!this.editLayoutButton?(this.editLayoutButton=a.create("div",{innerHTML:'\x3cspan class\x3d"modify-icon"\x3e\x3c/span\x3e\x3cspan\x3e'+
this.nls.modifyLayout+"\x3c/span\x3e","class":"layout-action"},c),this.own(l(this.editLayoutButton,"click",e.hitch(this,function(){this._editLayout()}))),this.configWin&&(this.configWin.appInfo.isRunInMobile?p.setStyle(this.editLayoutButton,"display","none"):p.setStyle(this.editLayoutButton,"display","block"))):this.editLayoutButton&&(a.destroy(this.editLayoutButton),this.editLayoutButton=null)}))},_onEditLayout:function(){this._editLayout()},_editLayout:function(){this.pluginManager.getPluginByName("app-config").showLoadingCover();
n.publish("actionTriggered",{action:"editLayout"})},_loadLayoutManager:function(a){var b=new u;require([a],e.hitch(this,function(a){a=a.getInstance();b.resolve(a)}));return b},resetStyleForOrgOrCustom:function(a,b,c){var d=this.themeManager.getCurrentTheme();d.setAppConfig(a);var f=e.getObject("theme.sharedTheme",!1,a);(f&&"sharedThemeChange"===c||"themeChange"===c||!0===b)&&d._cp.setSharedThemeConfig(f);a=e.getObject("theme.customStyles.mainBackgroundColor",!1,a);f&&!f.useHeader&&d._cp.setNoChecked(!f.useHeader&&
!a);b=!1;f&&"undefined"!==typeof f.useHeader&&!a&&"undefined"!==typeof d._wabDefaultColor&&(b=!0);a&&(d._cp.setColor(new q(a)),"sharedThemeChange"===c&&this._setThemeStyleToColor(d,a,b||d._lastStyle.styleColor!==a))},_setThemeStyleToColor:function(a,b,c){b=new q(b);a._lastStyle.styleColor=b.toHex();a._lastStyle.isCustom=!0;a._cp.setColor(b);this.changeStyle(a._lastStyle.name,a,c)}})})},"builder/plugins/theme-config/ThemeColorChooser":function(){define("dojo/Evented dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dojo/_base/lang dojo/_base/html dojo/on dojo/_base/Color builder/dijit/SharedThemeChooserPopup jimu/dijit/ColorPickerPopup jimu/utils".split(" "),
function(k,e,p,q,n,l,h,f,d,c,a){return e([p,q,k],{baseClass:"jimu-theme-color-chooser",declaredClass:"jimu.dijit.ThemeColorChooser",templateString:'\x3cdiv class\x3d"jimu-color-picker"\x3e\x3c/div\x3e',color:null,showLabel:!1,recordUID:"",isPortalSupport:!1,postCreate:function(){this.inherited(arguments)},startup:function(){this._createTooltipDialog();this.own(h(this.domNode,"click",n.hitch(this,function(a){a.stopPropagation();a.preventDefault();this.emit("clickContainer",this.getColor())})));this.own(h(this.domNode,
"mouseenter",n.hitch(this,function(){this.popup.showPopup()})));this.own(h(this.domNode,"mouseleave",n.hitch(this,function(){this.popup.hidePopup()})))},destroy:function(){this.colorPickerPopup.picker.destroy();this.popup.destroy();this.inherited(arguments)},showSharedThemeColor:function(a){this.popup.setChecked(this.popup.ACTION.SHARED);this.emitSharedThemeChangedEvent(!0,a)},showCustomColor:function(a){a&&(a.stopPropagation(),a.preventDefault());this.popup.hidePopup();this.colorPickerPopup.showTooltipDialog();
this.colorPickerPopup.initUI()},emitSharedThemeChangedEvent:function(a,c){!1!==c&&(this._useHeader=a,this.emit("sharedThemeChanged",this.getColor(),{useHeader:this._useHeader}));this.popup.hideTooltipDialog()},_createTooltipDialog:function(){this.popup=new d({isPortalSupport:this.isPortalSupport,placeAt:this.getParent(),around:this.domNode});this.own(h(this.popup,"btnClick",n.hitch(this,function(a,c){a===this.popup.ACTION.SHARED?this.showSharedThemeColor():a===this.popup.ACTION.CUSTOM&&this.showCustomColor(c)})));
this.own(h(this.popup,"showPopup",n.hitch(this,function(){this._isNoChooseState()?this.popup.setChecked("clean"):this.popup.setChecked(this._useHeader?this.popup.ACTION.SHARED:this.popup.ACTION.CUSTOM)})));this.colorPickerPopup=new c({showColorPickerOK:!0,showLabel:!1,recordUID:this.recordUID,around:this.domNode});this.colorPickerPopup.placeAt(this.getParent());this.colorPickerPopup.startup();this.own(h(this.colorPickerPopup,"change",n.hitch(this,function(a){this.setColor(a);this.emitSharedThemeChangedEvent(!1);
this.popup.setChecked(this.popup.ACTION.CUSTOM)})))},setSharedThemeConfig:function(a){a&&"undefined"!==typeof a.useHeader&&(this._useHeader=a.useHeader,this.popup.setIsPortalSupport(a.isPortalSupport),this._isNoChooseState()||!0===a.useHeader&&this.showSharedThemeColor(!1))},_isNoChooseState:function(){return!1===this._useHeader&&!0===this._isNoChecked?!0:!1},setNoChecked:function(a){this._isNoChecked=!0===a?!0:!1},setColor:function(a){if(a instanceof f){null===this.color&&!0===this.showLabel&&this._changeLabel(a);
var b=a.toHex();this.color=a;this.colorPickerPopup&&(l.setStyle(this.colorPickerPopup.domNode,"backgroundColor",b),this.colorPickerPopup.picker.refreshRecords(),this.colorPickerPopup.picker.setColor(b,!1,!0));this.showLabel&&this._changeLabel(this.color);l.setStyle(this.domNode,"backgroundColor",b)}},getColor:function(){return this.color},_changeLabel:function(b){l.empty(this.domNode);l.create("span",{innerHTML:b.toHex(),className:"color-label",style:{color:a.invertColor(b.toHex())}},this.domNode)},
onChange:function(a){a&&this.showLabel&&this._changeLabel(a)},changeColor:function(){this.colorPickerPopup&&this.colorPickerPopup.picker.changeColor();this.showLabel&&this._changeLabel(this.color)},setTitle:function(a){this.domNode.title=a}})})},"jimu/dijit/ColorPickerPopup":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dojo/_base/lang dojo/_base/html dojo/on dojo/_base/Color dijit/TooltipDialog dijit/popup jimu/dijit/ColorPalette jimu/utils".split(" "),function(k,
e,p,q,n,l,h,f,d,c,a){return k([e,p],{baseClass:"jimu-color-pickerPopup",declaredClass:"jimu.dijit.ColorPickerPopup",templateString:'\x3cdiv class\x3d"jimu-color-picker"\x3e\x3c/div\x3e',_isTooltipDialogOpened:!1,color:null,showLabel:!1,around:null,_ENABLE:!0,recordUID:"",postCreate:function(){this.inherited(arguments);this._createTooltipDialog(this.domNode);this._hideTooltipDialog()},destroy:function(){d.close(this.tooltipDialog);this.picker.destroy();this.tooltipDialog.destroy();this.inherited(arguments)},
enable:function(){this._ENABLE=!0;n.removeClass(this.domNode,"disable")},disable:function(){this._ENABLE=!1;n.addClass(this.domNode,"disable")},isPartOfPopup:function(a){var b=this.tooltipDialog.domNode;return a===b||n.isDescendant(a,b)},hideTooltipDialog:function(){this._hideTooltipDialog()},showTooltipDialog:function(){this._showTooltipDialog()},initUI:function(){this.picker.initUI()},_showTooltipDialog:function(){d.open({parent:this.getParent(),popup:this.tooltipDialog,around:this.around?this.around:
this.domNode,orient:this.orient});this._isTooltipDialogOpened=!0},_hideTooltipDialog:function(){d.hide(this.tooltipDialog);this._isTooltipDialogOpened=!1},_createTooltipDialog:function(){var a=n.create("div");this.tooltipDialog=new f({content:a});n.addClass(this.tooltipDialog.domNode,"jimu-color-picker-popup-dialog");var d=new c({appearance:{showTransparent:!1,showColorPalette:!0,showCoustom:!0,showColorPickerOK:!0,showColorPickerApply:!0,showCoustomRecord:!0,closeDialogWhenChange:!0},recordUID:this.recordUID,
onChange:q.hitch(this,function(a){a&&(a=new h(a),this.setColor(a),this.onChange(a))})});d.placeAt(a);d.startup();this.own(l(d,"close",q.hitch(this,function(){this._hideTooltipDialog()})));this.own(l(d,"change-style",q.hitch(this,function(){this._hideTooltipDialog();this._showTooltipDialog()})));this.own(l(this.domNode,"click",q.hitch(this,function(a){a.stopPropagation();a.preventDefault();this._isTooltipDialogOpened?this._hideTooltipDialog():!1!==this._ENABLE&&this._showTooltipDialog()})));this.own(l(document,
"click",q.hitch(this,function(a){this.isPartOfPopup(a.srcElement||a.target)||this._hideTooltipDialog()})));this.picker=d},setColor:function(a){if(a instanceof h){null===this.color&&!0===this.showLabel&&this._changeLabel(a);var b=a.toHex();this.color=a;n.setStyle(this.domNode,"backgroundColor",b);this.picker&&(this.picker.refreshRecords(),this.picker.setColor(b,!1,!0));this.showLabel&&this._changeLabel(this.color)}},getColor:function(){return this.color},_changeLabel:function(b){n.empty(this.domNode);
n.create("span",{innerHTML:b.toHex(),className:"color-label",style:{color:a.invertColor(b.toHex())}},this.domNode)},onChange:function(a){a&&this.showLabel&&this._changeLabel(a)},changeColor:function(){this.picker&&this.picker.changeColor();this.showLabel&&this._changeLabel(this.color)},setTitle:function(a){this.domNode.title=a},getTooltipDialog:function(){return this.tooltipDialog||null}})})},"jimu/dijit/ColorPalette":function(){define("dojo/Evented dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/_base/lang dojo/_base/html dojo/on dojo/_base/Color dojo/query jimu/dijit/ColorChooser jimu/dijit/CustomColorPicker jimu/dijit/ColorRecords dijit/popup jimu/utils dijit/a11yclick".split(" "),
function(k,e,p,q,n,l,h,f,d,c,a,b,g,u,m,r){return e([p,n,q,k],{templateString:"\x3cdiv\x3e\x3c/div\x3e",baseClass:"jimu-color-palette",declaredClass:"jimu.dijit.ColorPalette",_TRANSPARENT_STR:"rgba(0, 0, 0, 0)",value:"",_defaultAppearance:{showTransparent:!0,showColorPalette:!0,showCoustom:!0,showColorPickerOK:!1,showColorPickerApply:!0,showCoustomRecord:!0,closeDialogWhenChange:!1},recordUID:"",postMixInProperties:function(){this.nls=window.jimuNls.colorPalette},postCreate:function(){this.inherited(arguments);
this.value=this.value?new d(this.value):new d("#fff");this._createContent()},initUI:function(){this._toggleCustomColorPicker("init",!1)},_createContent:function(){this.appearance=l.mixin(this._defaultAppearance,this.appearance);var a=h.create("div",{"class":"jimu-colorpalette"},this.domNode);this.initPanel=h.create("div",{"class":"init-panel"},a);this.customPanel=h.create("div",{"class":"custom-panel hide"},a);this.appearance.showTransparent&&this._createSpecialColors(this.initPanel);this.appearance.showColorPalette&&
this._createColorChooser(this.initPanel);this.appearance.showCoustom&&this._createCustomColorPicker(this.initPanel);this.appearance.showCoustom&&this.appearance.showCoustomRecord&&this._createCoustomRecord(this.initPanel)},setColor:function(a){this._isColorEqual(a)||(this.value=new d(a),this._setSpatialColor(this.value),"undefined"!==typeof this.value.a&&0===this.value.a?(this.colorChooser.setColor(new d("transparent"),!1),this.picker.setColor(new d("#fff"),!1)):(this.colorChooser.setColor(this.value.toHex(),
!1),this.picker.setColor(this.value,!1)),this.colorRecords&&this.colorRecords.selecteColor(this.value))},getColor:function(){return this.value},changeColor:function(a){if("undefined"!==typeof this.value.a&&0===this.value.a)this.onChange(this.value);else this.onChange(this.value.toHex());this.emit("change",this.value);!0===this.appearance.closeDialogWhenChange&&!1!==a&&this._closeDialog()},refreshRecords:function(){this.colorRecords&&this.colorRecords.refresh()},destroy:function(){u.close(this.tooltipDialog);
this.picker.destroy();this.inherited(arguments)},_createSpecialColors:function(a){a=h.create("div",{"class":"special-color"},a);this.transparentBtn=h.create("div",{"class":"transparent btn",innerHTML:'\x3cdiv class\x3d"btn-wapper"\x3e\x3cdiv class\x3d"transparent icon jimu-float-leading"\x3e\x3c/div\x3e\x3cdiv class\x3d"transparent text jimu-float-leading"\x3e'+this.nls.transparent+"\x3c/div\x3e\x3c/div\x3e"},a);this.own(f(this.transparentBtn,r,l.hitch(this,this._onTransparentClick)))},_onTransparentClick:function(){this.setColor(new d("transparent"));
this.changeColor()},_setSpatialColor:function(a){if(this.transparentBtn){var b=c(".btn-wapper",this.transparentBtn)[0];h.removeClass(b,"selected");a&&a.toString&&a.toString()===this._TRANSPARENT_STR&&h.addClass(b,"selected")}},_createColorChooser:function(b){this.colorChooser=new a({});this.colorChooser.placeAt(b);this.own(f(this.colorChooser,"change",l.hitch(this,function(a){a=new d(a);this.setColor(a);this.changeColor()})))},_createCustomColorPicker:function(){this.coustomtBtn=h.create("div",{"class":"coustom btn",
innerHTML:'\x3cdiv class\x3d"btn-wapper"\x3e\x3cdiv class\x3d"custom icon jimu-float-leading"\x3e\x3c/div\x3e\x3cdiv class\x3d"custom text jimu-float-leading"\x3e'+this.nls.custom+"\x3c/div\x3e\x3c/div\x3e"},this.initPanel);this.own(f(this.coustomtBtn,"click",l.hitch(this,function(){this._toggleCustomColorPicker("custom")})));this.picker=new b({showOk:this.appearance.showColorPickerOK,showApply:this.appearance.showColorPickerApply,value:this.value.toHex()});this.picker.placeAt(this.customPanel);this.picker.setColor(this.value);
this.own(f(this.picker,"ok",l.hitch(this,function(a){this.setColor(new d(a));this.changeColor();this._addAColorRecord(a);this._toggleCustomColorPicker("init");this._closeDialog()})));this.own(f(this.picker,"apply",l.hitch(this,function(a){this.setColor(new d(a));this.changeColor(!1);this._addAColorRecord(a)})));this.own(f(this.picker,"cancel",l.hitch(this,function(){this._toggleCustomColorPicker("init");this._closeDialog()})))},_toggleCustomColorPicker:function(a,b){"custom"===a?(h.removeClass(this.customPanel,
"hide"),h.addClass(this.initPanel,"hide")):(h.addClass(this.customPanel,"hide"),h.removeClass(this.initPanel,"hide"));"undefined"!==typeof b&&!1===b||this.emit("change-style")},_createCoustomRecord:function(a){this.colorRecords=new g({recordsLength:10,uid:this.recordUID||""});this.colorRecords.placeAt(a);this.own(f(this.colorRecords,"choose",l.hitch(this,function(a){this.setColor(new d(a));this.changeColor()})))},_addAColorRecord:function(a){this.colorRecords&&this.colorRecords.push&&this.colorRecords.push(a)},
_isColorEqual:function(a){return this.value.toString()===(new d(a)).toString()?!0:!1},_changeLabel:function(a){h.empty(this.domNode);h.create("span",{innerHTML:a.toHex(),className:"color-label",style:{color:m.invertColor(a.toHex())}},this.domNode)},onOpen:function(){this.openDialog()},openDialog:function(){this.initUI()},_closeDialog:function(){this.emit("close")},onClose:function(){this._closeDialog()}})})},"jimu/dijit/ColorChooser":function(){define("dojo/Evented dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/_base/lang dojo/_base/html dojo/on dojo/query dojo/i18n dojo/_base/Color dijit/a11yclick dojo/i18n!dojo/nls/colors".split(" "),
function(k,e,p,q,n,l,h,f,d,c,a,b){return e([p,q,n,k],{templateString:'\x3cdiv\x3e\x3cdiv class\x3d"dijitInline dijitColorPalette" role\x3d"grid"\x3e\x3ctable class\x3d"dijitPaletteTable" cellspacing\x3d"0" cellpadding\x3d"0" role\x3d"presentation"\x3e\x3ctbody data-dojo-attach-point\x3d"gridNode"\x3e\x3c/tbody\x3e\x3c/table\x3e\x3c/div\x3e\x3c/div\x3e',baseClass:"jimu-color-chooser",declaredClass:"jimu.dijit.ColorChooser",uid:"",colorsArray:["white seashell cornsilk lemonchiffon lightyellow palegreen paleturquoise lightcyan lavender plum".split(" "),
"lightgray pink bisque moccasin khaki lightgreen lightseagreen lightskyblue cornflowerblue violet".split(" "),"silver lightcoral sandybrown orange palegoldenrod chartreuse mediumturquoise skyblue mediumslateblue orchid".split(" "),"gray red orangered darkorange yellow limegreen darkseagreen royalblue slateblue mediumorchid".split(" "),"dimgray crimson chocolate coral gold forestgreen seagreen blue blueviolet darkorchid".split(" "),"darkslategray firebrick saddlebrown sienna olive green darkcyan mediumblue darkslateblue darkmagenta".split(" "),
"rgb(0,0,1) darkred maroon brown darkolivegreen darkgreen midnightblue navy indigo purple".split(" ")],postCreate:function(){this.inherited(arguments);this.colorTitleNls=c.getLocalization("dojo","colors");this._createColorsBlocks()},_createColorsBlocks:function(){this._row=this.colorsArray.length;this._col=this.colorsArray[0].length;for(var c=0;c<this._row;c++)for(var d=h.create("tr",{role:"row"},this.gridNode),e=0;e<this._col;e++){var k=this.colorsArray[c][e],n=a.named[k],p="";n?p=k:"rgb(0,0,1)"===
k&&(p="black",n="rgb(0,0,1)");k=this.colorTitleNls[p];n=(new a(n)).toString();this["record"+e]=h.create("td",{"class":"dijitPaletteCell","data-title":n,role:"gridcell"},d);var q=h.create("span",{"class":"dijitInline dijitPaletteImg"},this["record"+e]);h.create("img",{"class":"dijitColorPaletteSwatch",src:require.toUrl("dojo/resources/blank.gif"),alt:k,title:k,"data-title":p,width:"16px",height:"16px",style:"background-color: "+n},q)}this.own(f(this.gridNode,b,l.hitch(this,this.onColorClick)))},onColorClick:function(b){for(var c=
b.target;"TD"!==c.tagName;){if(!c.parentNode||c===this.gridNode)return;c=c.parentNode}c=h.getAttr(c,"data-title");c=(new a(c)).toString();this.setColor(c);b.stopPropagation();b.preventDefault()},_onChange:function(a){this.emit("change",a)},setColor:function(b,c){b=new a(b);for(var e=null,f=d("td",this.domNode),g=0,k=f.length;g<k;g++)h.removeClass(f[g],"dijitPaletteCellSelected");g=0;for(k=f.length;g<k;g++)if(b.toString()===h.getAttr(f[g],"data-title")){e=f[g];break}e&&h.addClass(e,"dijitPaletteCellSelected");
(e&&"undefined"===typeof c||!0===c)&&this._onChange(b)}})})},"jimu/dijit/CustomColorPicker":function(){define("dojo/Evented dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dojo/_base/lang dojo/_base/html dojo/on dojo/_base/Color dojox/widget/ColorPicker".split(" "),function(k,e,p,q,n,l,h,f,d){return e([p,q,k],{baseClass:"jimu-color-picker",declaredClass:"jimu.dijit.ColorPicker",templateString:"\x3cdiv\x3e\x3c/div\x3e",_isTooltipDialogOpened:!1,color:null,showHex:!0,showHsv:!0,showRgb:!0,
ensureMode:!1,showLabel:!1,postMixInProperties:function(){this.nls=window.jimuNls.common},postCreate:function(){this.inherited(arguments);this.color?this.color instanceof f||(this.color=new f(this.color)):this.color=new f("#ccc");l.setStyle(this.domNode,"backgroundColor",this.color.toHex());this._createDialog(this.domNode)},destroy:function(){this.picker.destroy();this.inherited(arguments)},_handlerOk:function(c){c&&c.stopPropagation&&c.preventDefault&&(c.stopPropagation(),c.preventDefault());this.emit("ok",
this.color)},_handlerApply:function(c){c&&c.stopPropagation&&c.preventDefault&&(c.stopPropagation(),c.preventDefault());this.emit("apply",this.color)},_handlerCancel:function(c){c&&c.stopPropagation&&c.preventDefault&&(c.stopPropagation(),c.preventDefault());this.emit("cancel")},_createDialog:function(){var c=l.create("div",{"class":"dojox-color-picker-container"},this.domNode),a=new d({showHex:this.showHex,showRgb:this.showRgb,showHsv:this.showHsv,value:this.color.toHex(),onChange:n.hitch(this,function(a){a=
new f(a);this.setColor(a)})});a.placeAt(c);a.startup();c=l.create("div",{"class":"btns-container jimu-float-trailing"},c);if(!0===this.showOk){var b=l.create("div",{"class":"jimu-btn jimu-float-leading ok",title:this.nls.ok,innerHTML:this.nls.ok},c);this.own(h(b,"click",n.hitch(this,function(a){var b=this.picker.get("value");this.setColor(new f(b));this._handlerOk(a)})))}!0===this.showApply&&(b=l.create("div",{"class":"jimu-btn jimu-float-leading apply",title:this.nls.apply,innerHTML:this.nls.apply},
c),this.own(h(b,"click",n.hitch(this,function(a){var b=this.picker.get("value");this.setColor(new f(b));this._handlerApply(a)}))));c=l.create("div",{"class":"jimu-btn jimu-btn-vacation jimu-float-leading",title:this.nls.cancel,innerHTML:this.nls.cancel},c);this.own(h(c,"click",n.hitch(this,function(a){this._handlerCancel(a)})));this.picker=a},setColor:function(c){if(c instanceof f){var a=this.color,b="";a&&(b=a.toHex());a=c.toHex();this.color=c;b!==a&&this.picker.set("value",a)}},getColor:function(){return this.color},
onClose:function(){}})})},"jimu/dijit/ColorRecords":function(){define("dojo/Evented dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/_base/lang dojo/_base/html dojo/on dojo/query dojo/_base/Color dojo/cookie dojo/text!./templates/ColorRecords.html dijit/a11yclick".split(" "),function(k,e,p,q,n,l,h,f,d,c,a,b,g){return e([p,q,n,k],{templateString:b,baseClass:"jimu-color-records",declaredClass:"jimu.dijit.ColorRecords",uid:"",recordsLength:10,colorList:null,
postCreate:function(){this.inherited(arguments);this.colorList=[];this._createCoustomRecord();""===this.uid&&(this.uid="wab_colorRecords");this.refresh()},push:function(a){this.colorList.unshift(a);this.colorList.length>this.recordsLength&&this.colorList.pop();this._setColors()},selecteColor:function(a){a=new c(a);for(var b=null,e=d("td",this.domNode),f=0,g=e.length;f<g;f++)h.removeClass(e[f],"dijitPaletteCellSelected");f=0;for(g=e.length;f<g;f++)if(a.toString()===h.getAttr(e[f],"title")){b=e[f];
break}b&&(h.addClass(b,"dijitPaletteCellSelected"),this.onChoose(a))},refresh:function(){this._getCookie(this.uid);this._setColors()},_setColors:function(){for(var a=0;a<this.recordsLength;a++){var b=this["record"+a];if(b&&this.colorList[a]&&this.colorList[a].toString){var c=this.colorList[a].toString();h.setAttr(b,"title",c);b=this._findImg(b);h.setStyle(b,"background-color",c);h.setAttr(b,"alt",c);h.setAttr(b,"title",c)}}this._setCookie(this.uid)},_createCoustomRecord:function(){for(var a=0;a<this.recordsLength;a++){this["record"+
a]=h.create("td",{"class":"dijitPaletteCell",tabindex:a,title:"",role:"gridcell"},this.container);var b=h.create("span",{"class":"dijitInline dijitPaletteImg"},this["record"+a]);h.create("img",{"class":"dijitColorPaletteSwatch",src:require.toUrl("dojo/resources/blank.gif"),style:"background-color: #ffffff"},b)}this.own(f(this.gridNode,g,l.hitch(this,this.onRecordClick)))},onRecordClick:function(a){for(var b=a.target;"TD"!==b.tagName;){if(!b.parentNode||b===this.gridNode)return;b=b.parentNode}b=h.getAttr(b,
"title");b=(new c(b)).toString();this.onChoose(b);a.stopPropagation();a.preventDefault()},onChoose:function(a){this.emit("choose",a)},_findImg:function(a){var b=null;return a.nodeName&&"IMG"===a.nodeName.toUpperCase()?a:b=d(".dijitColorPaletteSwatch",a)[0]},_setCookie:function(b){for(var c=[],d=0,e=this.recordsLength;d<e;d++){var f=this.colorList[d];f&&f.toString&&(c[d]=f.toString())}this._cleanCookie(b);try{var g=JSON.stringify(c);a(b,g,{expires:1E3,path:"/"})}catch(w){console.error("ColorRecords: cookieList JSON.stringify error."+
w.stack)}},_getCookie:function(b){b=a(b);if("undefined"!==typeof b)try{var d=JSON.parse(b);if(d&&"undefined"!==typeof d.length){b=0;for(var e=this.recordsLength;b<e;b++){var f=d[b];f&&f.toString&&(this.colorList[b]=new c(f.toString()))}}}catch(v){console.error("ColorRecords: cookieList JSON.parse error."+v.stack)}},_cleanCookie:function(b){a(b,null,{expires:-1})}})})},"builder/plugins/theme-config/ThemeManager":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/Deferred ./Theme builder/serviceUtils".split(" "),
function(k,e,p,q,n,l){return k(null,{themes:void 0,constructor:function(){this.currentThemeName=null;this.themes=[]},loadThemes:function(){var h=new q;l.getAllThemes().then(p.hitch(this,function(f){f.success?(e.forEach(f.themes,function(d){this.themes.push(new n(d))},this),h.resolve(this.themes)):(console.error("Gets themes failed! The response of getThemes is 'unsuccess'!"),h.reject(this.themes))}),function(e){console.error("Gets themes failed!"+e);h.reject(this.themes)});return h},changeCurrentTheme:function(e){this.currentThemeName=
e},getCurrentTheme:function(){return this.getThemeByName(this.currentThemeName)},getThemeByName:function(e){for(var f=0;f<this.themes.length;f++)if(e===this.themes[f].getName())return this.themes[f]}})})},"builder/plugins/theme-config/Theme":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/_base/array dojo/Deferred dojo/promise/all dojo/request jimu/utils".split(" "),function(k,e,p,q,n,l,h,f){return k(null,{appConfig:void 0,currentStyleName:void 0,currentLayoutName:void 0,
_manifest:void 0,constructor:function(d){this._manifest=d;this.domNodes={}},clear:function(){var d;this.appConfig=null;for(d=0;d<this._manifest.layouts.length;d++)if("appLayout"===this._manifest.layouts[d].name){this._manifest.layouts[d].domNode&&p.destroy(this._manifest.layouts[d].domNode);this._manifest.layouts.splice(d,1);break}},loadLayouts:function(){var d=new n,c=[],a=q.filter(this._manifest.layouts,function(a){return"appLayout"!==a.name});q.forEach(a,function(a){c.push(h(this._manifest.url+
a.uri,{handleAs:"json"}))},this);l(c).then(e.hitch(this,function(b){var c;q.forEach(a,function(a,d){a.layoutConfig=b[d];"default"===a.name?c=a.layoutConfig:(d=a.layoutConfig.layoutDefinition,a.layoutConfig=f.mixinAppConfigPosition(c,a.layoutConfig),a.layoutConfig.layoutDefinition=d);a.layoutConfig.mobileLayout&&(a.layoutConfig.mobileLayout=f.mixinAppConfigPosition(a.layoutConfig,a.layoutConfig.mobileLayout),delete a.layoutConfig.mobileLayout.mobileLayout)},this);d.resolve()}),function(){d.reject()});
return d},_processLayoutConfig:function(d,c){return f.mixinAppConfigPosition(d,c)},setAppConfig:function(d){this.appConfig=d},getName:function(){return this._manifest.name},getVersion:function(){return this._manifest.version},getLabel:function(){return this._manifest.label},getIcon:function(){return this._manifest.icon},getLayouts:function(){return this._manifest.layouts},getStyles:function(){return this._manifest.styles},getUrl:function(){return this._manifest.url},getCurrentStyle:function(){return this.getStyleByName(this.currentStyleName)},
getCurrentLayout:function(){return this.getLayoutByName(this.currentLayoutName)},changeCurrentStyle:function(d){this.currentStyleName=d},changeCurrentLayout:function(d){this.currentLayoutName=d},addLayout:function(d,c,a,b){var e,f=this.getLayouts();for(e=0;e<f.length;e++)if(f[e].name===d)return null;d={description:"this is current app layout",name:d,label:b,layoutConfig:c,domClass:a};this._manifest.layouts.push(d);return d},getStyleByName:function(d){var c,a=null;for(c=0;c<this._manifest.styles.length;c++)if(this._manifest.styles[c].name===
d){a=this._manifest.styles[c];break}return a},getLayoutByName:function(d){var c,a=null;for(c=0;c<this._manifest.layouts.length;c++)if(this._manifest.layouts[c].name===d){a=this._manifest.layouts[c];break}return a},getLayoutByAppConfig:function(d){var c,a=null;for(c=0;c<this._manifest.layouts.length;c++)if(this.isAppUseLayout(d,this._manifest.layouts[c].layoutConfig)){a=this._manifest.layouts[c];break}return a},isAppUseLayout:function(d,c){d=e.clone(d);c=e.clone(c);d.map||(d.map={});c.map||(c.map=
d.map);d.map.position||(d.map.position={left:0,top:0});c.map.position||(c.map.position=d.map.position);if(!f.isEqual(d.layoutDefinition,c.layoutDefinition)||!f.isEqual(d.map.position,c.map.position))return!1;d.widgetOnScreen||(d.widgetOnScreen={});c.widgetOnScreen||(c.widgetOnScreen={});d.widgetOnScreen.widgets||(d.widgetOnScreen.widgets=[]);c.widgetOnScreen.widgets||(c.widgetOnScreen.widgets=[]);d.widgetOnScreen.groups||(d.widgetOnScreen.groups=[]);c.widgetOnScreen.groups||(c.widgetOnScreen.groups=
[]);var a,b;a=d.widgetOnScreen.widgets.length<c.widgetOnScreen.widgets.length?d.widgetOnScreen.widgets.length:c.widgetOnScreen.widgets.length;for(b=0;b<a;b++)if(d.widgetOnScreen.widgets[b].position||(d.widgetOnScreen.widgets[b].position={}),c.widgetOnScreen.widgets[b].position||(c.widgetOnScreen.widgets[b].position=d.widgetOnScreen.widgets[b].position),c.widgetOnScreen.widgets[b].position.relativeTo||(c.widgetOnScreen.widgets[b].position.relativeTo=d.widgetOnScreen.widgets[b].position.relativeTo),
!f.isEqual(d.widgetOnScreen.widgets[b].position,c.widgetOnScreen.widgets[b].position))return!1;a=d.widgetOnScreen.groups.length<c.widgetOnScreen.groups.length?d.widgetOnScreen.groups.length:c.widgetOnScreen.groups.length;for(b=0;b<a;b++)if(d.widgetOnScreen.groups[b].panel||(d.widgetOnScreen.groups[b].panel={}),c.widgetOnScreen.groups[b].panel||(c.widgetOnScreen.groups[b].panel=d.widgetOnScreen.groups[b].panel),d.widgetOnScreen.groups[b].panel.position||(d.widgetOnScreen.groups[b].panel.position={}),
c.widgetOnScreen.groups[b].panel.position||(c.widgetOnScreen.groups[b].panel.position=d.widgetOnScreen.groups[b].panel.position),c.widgetOnScreen.groups[b].panel.position.relativeTo||(c.widgetOnScreen.groups[b].panel.position.relativeTo=d.widgetOnScreen.groups[b].panel.position.relativeTo),!f.isEqual(d.widgetOnScreen.groups[b].panel.position,c.widgetOnScreen.groups[b].panel.position))return!1;return!0},getLayoutFromConfig:function(d){var c={};d=e.clone(d);d.widgetOnScreen&&(c.widgetOnScreen={},d.widgetOnScreen.widgets&&
(c.widgetOnScreen.widgets=[],q.forEach(d.widgetOnScreen.widgets,function(a,b){c.widgetOnScreen.widgets[b]={position:a.position?a.position:{left:0,top:0}}})),d.widgetOnScreen.groups&&(c.widgetOnScreen.groups=[],q.forEach(d.widgetOnScreen.groups,function(a,b){c.widgetOnScreen.groups[b]={position:a.position?a.position:{left:0,top:0}}})));d.map&&(c.map={position:d.map.position});return c}})})},"builder/plugins/widget-config/_build-generate_module":function(){define(["builder/plugins/widget-config/Plugin",
"dojo/text!builder/plugins/widget-config/Plugin.html","dojo/text!builder/plugins/widget-config/css/style.css","dojo/i18n!builder/plugins/widget-config/nls/strings"],function(){})},"builder/plugins/widget-config/Plugin":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/_base/array dojo/_base/fx dojo/topic dojo/on dijit/_WidgetBase ./WidgetsList ./MoveableNode ./WidgetSettingPage ./GroupSettingPage ./WidgetChoosePage jimu/utils jimu/PoolControllerMixin jimu/dijit/ViewStack jimu/dijit/Popup builder/BasePlugin esri/lang".split(" "),
function(k,e,p,q,n,l,h,f,d,c,a,b,g,u,m,r,t,v,y){return k([v],{baseClass:"plugin-widget-config app-widgets",postMixInProperties:function(){this.nls=e.mixin(this.nls,window.builderNls)},postCreate:function(){this.inherited(arguments);this.notRemoveableWidgetOnScreen=new d({name:"notRemoveableWidgetOnScreen",nls:this.nls,folderUrl:this.folderUrl},this.notRemoveableOnScreenWidgetsListNode);this.removeableWidgetOnScreen=new d({name:"removeableWidgetOnScreen",nls:this.nls,folderUrl:this.folderUrl},this.removeableOnScreenWidgetsListNode);
this.groupOnScreen=new d({name:"groupOnScreen",nls:this.nls,folderUrl:this.folderUrl},this.onScreenGroupsListNode);this.poolWidgets=new d({name:"poolWidgets",nls:this.nls,folderUrl:this.folderUrl},this.poolWidgetsListNode);this.viewStack=new r({viewType:"dom",views:[this.preloadWidgetsNode,this.poolWidgetsNode]});this.viewStack.placeAt(this.domNode);this.poolControllerClass=k([f,m]);this.own(l.subscribe("editWidget",e.hitch(this,this._onEditWidget)));this.own(l.subscribe("chooseWidget",e.hitch(this,
this._onChooseWidget)));this.own(l.subscribe("editGroup",e.hitch(this,this._onEditGroup)));this.own(l.subscribe("app/appConfigChanged",e.hitch(this,this._onAppConfigChanged)));this.own(l.subscribe("app/appConfigLoaded",e.hitch(this,this._onAppConfigChanged)));this.own(l.subscribe("widgetSettingPageOk",e.hitch(this,this._onWidgetSettingPageOk)));this.own(h(this.poolWidgets,"offpanel-group-error",e.hitch(this,this._onOffPanelGroupError)));this.own(h(this.groupOnScreen,"group-exceed-max-error",e.hitch(this,
this._onGroupExceedMaxError)));this.own(h(this.groupOnScreen,"groupOpened",e.hitch(this,this._onOnScreenGroupOpenClose)));this.own(h(this.groupOnScreen,"groupClosed",e.hitch(this,this._onOnScreenGroupOpenClose)));window.isRTL&&(p.removeClass(this.backArrowNode,"icon-arrow-back"),p.addClass(this.backArrowNode,"icon-arrow-forward"))},startup:function(){this.inherited(arguments);this.viewStack.startup();this.poolWidgets.opened=!1;this._init(this.appConfig)},destroy:function(){q.forEach(this.controllers,
function(a){a.destroy()});this.controllers=[];this.inherited(arguments)},onShown:function(){this._init(this.appConfig)},onHidden:function(){},_onAppConfigChanged:function(a){this._started?this.appConfig&&u.isEqual(this.appConfig.widgetOnScreen,a.widgetOnScreen)&&u.isEqual(this.appConfig.widgetPool,a.widgetPool)?this.appConfig=a:this._init(a):this.appConfig=a},_init:function(a){this.appConfig=a;this._createControllerWidgetNodes();this.poolWidgets.opened?0<this.controllers.length?q.some(this.controllers,
function(a){if(this.poolWidgets.controller.id===a.id)return this._initWidgetPool(a),!0},this)||this._initWidgetPool(this.controllers[0]):(this._initWidgetPool(null),this._onBackWidgetsClick()):this._initOnScreenWidget(a);this.widgetChoosePage&&this.widgetChoosePage.setAppConfig(a);this.widgetSettingPage&&this.widgetSettingPage.setAppConfig(a)},_onOffPanelGroupError:function(){p.setStyle(this.offPanelToGroupErrorNode,{display:"block",opacity:1});n.fadeOut({node:this.offPanelToGroupErrorNode,duration:5E3,
onEnd:e.hitch(this,function(){p.setStyle(this.offPanelToGroupErrorNode,{display:"none"})})}).play()},_onGroupExceedMaxError:function(a){a=y.substitute({maxCount:a.maxWidgets},this.nls.addWidgetExceedMax);this.groupExceedMaxErrorStringNode.innerText=a;p.setStyle(this.groupExceedMaxErrorNode,{display:"block",opacity:1});n.fadeOut({node:this.groupExceedMaxErrorNode,duration:5E3,onEnd:e.hitch(this,function(){p.setStyle(this.groupExceedMaxErrorNode,{display:"none"})})}).play()},_onOnScreenGroupOpenClose:function(){p.setStyle(this.onScreenGroupsListNode,
{height:this.groupOnScreen.getListHeight()+"px"})},_getNonControllerAndNotRemoveableOnScreenWidgets:function(a){var b=[];if(!a.widgetOnScreen)return[];q.forEach(a.widgetOnScreen.widgets,function(a){a.isController||!1!==a.inPanel||!0===a.closeable||b.push(a)},this);return b},_getNonControllerAndRemoveableOnScreenWidgets:function(a){var b=[];if(!a.widgetOnScreen)return[];q.forEach(a.widgetOnScreen.widgets,function(a){a.isController||(!1!==a.inPanel||!0!==a.closeable)&&!0!==a.inPanel&&a.uri||b.push(a)},
this);return b},_getOnScreenGroups:function(a){return a.widgetOnScreen&&a.widgetOnScreen.groups?a.widgetOnScreen.groups:[]},_createControllerWidgetNodes:function(){q.forEach(this.controllers,function(a){p.destroy(a.node);a.destroy()},this);this.controllers=[];q.forEach(this.appConfig.widgetOnScreen.widgets,function(a){a.isController&&this._createControllerWidgetNode(a)},this);this.controllerWidgetsHeight=118*this.controllers.length;p.setStyle(this.controllerWidgetsNode,{height:this.controllerWidgetsHeight+
"px"})},_createControllerWidgetNode:function(a){var b=p.create("div",{"class":"controller-widget"},this.controllerWidgetsNode),d={};window.isRTL?d.right="30px":d.left="30px";d=new c({type:"widget",w:74,h:118,setting:a,listName:"controllerWidgets",style:d,nls:this.nls});p.place(d.domNode,b);d.startup();d=p.create("div",{"class":"action-node"},b);p.create("div",{"class":"action-text jimu-float-leading jimu-leading-margin1",title:this.nls.setControlledWidgets,innerHTML:this.nls.setControlledWidgets},
d);window.isRTL?p.create("div",{"class":"action-arrow feature-action icon-arrow-left jimu-float-trailing jimu-trailing-margin2"},d):p.create("div",{"class":"action-arrow feature-action icon-arrow-right jimu-float-trailing jimu-trailing-margin2"},d);a=new this.poolControllerClass(a);a.appConfig=this.appConfig;a.node=b;this.controllers.push(a);this.own(h(d,"click",e.hitch(this,this._openWidgetPool,a)))},_openWidgetPool:function(a){!1!==a.visible&&(this.currentController=a,this.viewStack.switchView(this.poolWidgetsNode),
this.poolWidgets.opened=!0,this.removeableWidgetOnScreen.opened=!1,this.notRemoveableWidgetOnScreen.opened=!1,this.controllerLabelNode.innerHTML=u.stripHTML(a.label),this.poolWidgets._started||this.poolWidgets.startup(),this._initWidgetPool(a))},_initWidgetPool:function(a){this.poolWidgets.controller=a;this.poolWidgets.setAppConfig(this.appConfig);this.poolWidgets.setSettings(a?a.getAllConfigs():[])},_initOnScreenWidget:function(a){this.groupOnScreen._started||this.groupOnScreen.startup();this.groupOnScreen.setSettings(this._getOnScreenGroups(a));
this.groupOnScreen.setAppConfig(a);0<this.controllers.length&&0<this.groupOnScreen.settings.length&&(0<this.controllers.length||0<this.groupOnScreen.settings.length)?p.setStyle(this.onScreenGroupsHline,"display",""):p.setStyle(this.onScreenGroupsHline,"display","none");p.setStyle(this.onScreenGroupsListNode,{height:this.groupOnScreen.getListHeight()+"px"});this.notRemoveableWidgetOnScreen._started||this.notRemoveableWidgetOnScreen.startup();this.notRemoveableWidgetOnScreen.setAppConfig(a);this.notRemoveableWidgetOnScreen.setSettings(this._getNonControllerAndNotRemoveableOnScreenWidgets(a));
0<this.notRemoveableWidgetOnScreen.settings.length?p.setStyle(this.notRemoveableOnScreenWidgetsHline,"display",""):p.setStyle(this.notRemoveableOnScreenWidgetsHline,"display","none");p.setStyle(this.notRemoveableOnScreenWidgetsListNode,{height:this.notRemoveableWidgetOnScreen.getListHeight()+"px"});this.removeableWidgetOnScreen._started||this.removeableWidgetOnScreen.startup();this.removeableWidgetOnScreen.setAppConfig(a);this.removeableWidgetOnScreen.setSettings(this._getNonControllerAndRemoveableOnScreenWidgets(a));
0<this.removeableWidgetOnScreen.settings.length&&(0<this.controllers.length||0<this.notRemoveableWidgetOnScreen.settings.length)?p.setStyle(this.removeableOnScreenWidgetsHline,"display",""):p.setStyle(this.removeableOnScreenWidgetsHline,"display","none");p.setStyle(this.removeableOnScreenWidgetsListNode,{height:this.removeableWidgetOnScreen.getListHeight()+"px"})},_onBackWidgetsClick:function(){this._createControllerWidgetNodes();this.viewStack.switchView(this.preloadWidgetsNode);this.poolWidgets.opened=
!1;this.removeableWidgetOnScreen.opened=!0;this.notRemoveableWidgetOnScreen.opened=!0;this._initOnScreenWidget(this.appConfig)},_onEditWidget:function(b,c){this.widgetSettingPage=new a({appConfig:this.appConfig,nls:this.nls},this.widgetSettingPageNode);this.widgetSettingPage.setting=e.clone(b);this.widgetSettingPage.fromNode=c;b=new t({titleLabel:this.nls.configLabel+" "+b.label,content:this.widgetSettingPage,container:"main-page",buttons:[{label:this.nls.ok,onClick:e.hitch(this.widgetSettingPage,
this.widgetSettingPage.onOk)},{label:this.nls.cancel,classNames:["jimu-btn-vacation"],onClick:e.hitch(this.widgetSettingPage,this.widgetSettingPage.onCancel)}],onClose:e.hitch(this.widgetSettingPage,this.widgetSettingPage.onClose)});p.addClass(b.domNode,"widget-setting-popup");this.widgetSettingPage.startup()},_onChooseWidget:function(a,b){this.widgetChoosePage=new g({appConfig:this.appConfig,nls:this.nls,options:{includeOffPanel:"groupOnScreen"===b?!1:!0}},this.widgetChoosePageNode);this.widgetChoosePage.fromNode=
a;this.widgetChoosePage.fromList=b;new t({titleLabel:this.nls.chooseWidget,content:this.widgetChoosePage,container:"main-page",buttons:[{label:this.nls.ok,onClick:e.hitch(this.widgetChoosePage,this.widgetChoosePage.onOk)},{label:this.nls.cancel,classNames:["jimu-btn-vacation"]}]});this.widgetChoosePage.startup()},_onEditGroup:function(a,c){this.groupSettingPage=new b({setting:e.clone(c),nls:this.nls});new t({titleLabel:c.label,content:this.groupSettingPage,container:"main-page",buttons:[{label:this.nls.ok,
onClick:e.hitch(this.groupSettingPage,this.groupSettingPage.onOk)},{label:this.nls.cancel,classNames:["jimu-btn-vacation"]}]});this.groupSettingPage.startup()},_onWidgetSettingPageOk:function(a){a.isController&&l.publish("widgetChanged",a)},_getPopupSize:function(){var a=p.getContentBox("main-page"),b={};1024>=a.w?(b.width=a.w-20,b.height=a.h-20):(b.width=1024,b.height=768);return b}})})},"builder/plugins/widget-config/WidgetsList":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/_base/array dojo/topic dojo/aspect dojo/Evented dojo/query dojo/NodeList-dom dijit/_WidgetBase ./MoveableNode ./LinkList jimu/utils".split(" "),
function(k,e,p,q,n,l,h,f,d,c,a,b,g){function u(a){var b={};isFinite(a.l)&&(b.left=a.l+"px");isFinite(a.t)&&(b.top=a.t+"px");isFinite(a.w)&&(b.width=a.w+"px");isFinite(a.h)&&(b.height=a.h+"px");return b}var m,r=k([c],{box:null,marginBox:null,postCreate:function(){this.inherited(arguments);this.domNode=p.create("div",{"class":"node-margin"});this.type="addBtn"===this.node.type?"addMargin":"margin"}});return k([c,h],{postCreate:function(){this.nodeList=new b({name:this.name});this.own(n.subscribe("widgetChoosePageOk",
e.hitch(this,this._onWidgetChoosePageOk)));this.own(n.subscribe("widgetSettingPageOk",e.hitch(this,this._onWidgetSettingPageOk)))},startup:function(){this.inherited(arguments);this.settings&&this.initNodes()},setSettings:function(a){this.settings=e.clone(a);this.initNodes()},setAppConfig:function(a){this.appConfig=a},addWidget:function(a){a=this.createMoveableNode("widget",a);this.nodeList.insertNode(a);this.placeNodes()},createMoveableNode:function(b,c){var d=e.clone(this.box);d.h=Infinity;var f=
new a({type:b,w:74,h:118,setting:c,listName:this.name,parentBox:d,nls:this.nls,folderUrl:this.folderUrl,appConfig:this.appConfig});p.place(f.domNode,this.domNode);f.startup();this.bindMoveEvent(f);"group"===b&&(l.after(f,"openGroup",e.hitch(this,this.openGroup,f)),l.after(f,"closeGroup",e.hitch(this,this.closeGroup,f)));f.on("removeNode",e.hitch(this,function(){"poolWidgets"===this.name||"groupOnScreen"===this.name?(f.gnode?(this.nodeList.removeNode(f),this._reopenGroup()):this.nodeList.removeNode(f),
this.placeNodes(),"poolWidgets"===this.name?this.publishPoolChangeEvent():n.publish("groupChanged",f.gnode.setting)):(f.setting.uri="",f.setting.label=this.nls.defaultWidgetLabel,f.setting.name=void 0,f.setting.placeholderIndex="?",f.setting.config=void 0,this.label=this.nls.defaultWidgetLabel,g.widgetJson.removeManifestFromWidgetJson(f.setting),n.publish("widgetChanged",f.setting))}));f.on("clickOpenAtStart",e.hitch(this,function(){var a={id:f.setting.id,openAtStart:!f.setting.openAtStart};a.isOnScreen=
"poolWidgets"===this.name?!1:!0;n.publish("openAtStartChange",a)}));this.createMarginNode(f);return f},openGroup:function(a){var b,c,d,f,g,h,k;this.openedGNode&&this.openedGNode!==a&&this.openedGNode.closeGroup(this.openedGNode);b=a.setting.widgets;g=this.getNodePosition(this.nodeList.getNodeIndex(a)).r;h=this._groupCanAddMoreWidget(a)?Math.ceil((b.length+1)/m):Math.ceil(b.length/m);c=g*m+1;d=this.nodeList.getNodeByIndex(c);for(f=this.nodeList.getCount()+1;f<c;f++)k=this.createMoveableNode("empty"),
k.gnode=a,this.nodeList.insertNode(k,d);this.openedGNode=a;this.openedGNode.panelRow=g+1;this.createGroupPanel(g+1,h);b.forEach(e.hitch(this,function(b){b=this.createMoveableNode("widget",b);b.gnode=a;this.nodeList.insertNode(b,d)}));"groupOnScreen"===this.name?this._groupCanAddMoreWidget(a)?(f=this.createMoveableNode("addBtn"),f.gnode=a,this.nodeList.insertNode(f,d),b=m*h-b.length-1):b=m*h-b.length:b=m*h-b.length;for(f=0;f<b;f++)k=this.createMoveableNode("empty"),k.gnode=a,this.nodeList.insertNode(k,
d);this.placeNodes();this.emit("groupOpened")},_groupCanAddMoreWidget:function(a){return"undefined"===typeof a.setting.maxWidgets||a.setting.maxWidgets>a.setting.widgets.length},createGroupPanel:function(a,b){a={t:118*(a-1)-10,h:118*b+0*(b-1),w:89*m-15+20};window.isRTL?a.r=5:a.l=5;this.groupPanel=p.create("div",{"class":"widget-group-panel",style:u(a)},this.domNode);a=(this.openedGNode.pos.c-1)%m*89+37;window.isRTL&&(a=1===this.openedGNode.pos.c?89*m-37:(m-this.openedGNode.pos.c+1)%m*89-37);p.create("div",
{"class":"group-triangle",style:{left:a+"px"}},this.groupPanel);this.groupPanel.type="panel"},closeGroup:function(a){var b=[];a.setting.widgets=[];this.nodeList.visitNodes(e.hitch(this,function(c){c.gnode===a&&("empty"!==c.type&&"addBtn"!==c.type&&a.setting.widgets.push(c.setting),b.push(c))}));b.forEach(e.hitch(this,function(a){this.nodeList.removeNode(a)}));0===a.setting.widgets.length?"poolWidgets"===this.name&&this.nodeList.removeNode(a):a.updateSmallWidgets();this.placeNodes();p.destroy(this.groupPanel);
this.openedGNode=null;this.emit("groupClosed")},initNodes:function(){this.box=p.getContentBox(this.domNode);this.position=p.position(this.domNode,!0);m=Math.floor(this.box.w/89);this.destroyShadowNode();var a=this.settings;if("notRemoveableWidgetOnScreen"===this.name)a=a.sort(function(a,b){return a.label.localeCompare(b.label)});else if("removeableWidgetOnScreen"===this.name)var b=q.filter(a,function(a){return a.widgets}),b=b.sort(function(a,b){return a.label.localeCompare(b.label)}),c=q.filter(a,
function(a){return a.uri}),c=c.sort(function(a,b){return a.label.localeCompare(b.label)}),a=q.filter(a,function(a){return!a.widgets&&!a.uri}),a=a.sort(function(a,b){return a.placeholderIndex-b.placeholderIndex}),a=[].concat(b,c,a);else a=a.sort(function(a,b){return a.index-b.index});var d;this.openedGNode&&(d=this.openedGNode.label,this.closeGroup(this.openedGNode));this.nodeList.destroyAllNodes();"poolWidgets"===this.name&&(this.addBtn=this.createMoveableNode("addBtn"),this.nodeList.insertNode(this.addBtn));
a.forEach(e.hitch(this,function(a){(a=a.widgets?this.createMoveableNode("group",a):a.uri?this.createMoveableNode("widget",a):this.createMoveableNode("placeholder",a))&&this.nodeList.insertNode(a)}));"poolWidgets"===this.name&&this.nodeList.insertNode(this.createMoveableNode("empty"));this.placeNodes();d&&(b=this.nodeList.getNodeByLabel(d))&&(this.openGroup(b),b.status="open")},getListHeight:function(){var a=0;this.nodeList.visitNodes(function(b){a=Math.max(b.pos.r,a)});return 118*a},_removeActive:function(){f(".node-margin-active",
this.domNode).removeClass("node-margin-active");f(".empty-node-active",this.domNode).removeClass("empty-node-active");f(".node-active",this.domNode).removeClass("node-active")},bindMoveEvent:function(a){"addBtn"!==a.type&&a.dnd&&(l.after(a.dnd,"onMove",e.hitch(this,function(b,c,d){b=this.getMousePosition(d);this.mouseNode=this.getNodeByMousePosition(a,b);this._removeActive();this.mouseNode&&"margin"===this.mouseNode.type?p.addClass(this.mouseNode.domNode,"node-margin-active"):this.mouseNode&&"empty"===
this.mouseNode.type?p.addClass(this.mouseNode.domNode,"empty-node-active"):!this.mouseNode||"group"!==this.mouseNode.type&&"widget"!==this.mouseNode.type||p.addClass(this.mouseNode.domNode,"node-active")}),!0),l.after(a.dnd,"onMoveStart",e.hitch(this,function(){this.destroyShadowNode();this.createShadowNode(a);p.setStyle(a.boxNode,"cursor","move")}),!0),l.after(a.dnd,"onMoveStop",e.hitch(this,this._onMoveStop,a),!0))},_onMoveStop:function(a){var b=!1,c=[];p.setStyle(a.boxNode,"cursor","pointer");
this.mouseNode&&(a===this.mouseNode?console.log("move to the same node"):"margin"===this.mouseNode.type?(this.moveNodeToMargin(a,this.mouseNode),"groupOnScreen"===this.name&&c.push(a.gnode.setting),b=!0):"empty"===this.mouseNode.type?this.mouseNode.gnode&&"group"===a.type?console.log("not allow move group to opened group, revert"):(this.moveNodeToEmpty(a,this.mouseNode),"groupOnScreen"===this.name&&c.push(a.gnode.setting),b=!0):"group"===this.mouseNode.type?"group"===a.type?console.log("not allow move group to closed group, revert"):
"open"===this.mouseNode.status?console.log("please put widget into the opened group panel"):!1===a.setting.inPanel?this._showOffPanelToGroupError():a.gnode&&a.gnode===this.mouseNode?console.log("the moving widget is already in the group"):this.mouseNode.setting.maxWidgets&&this.mouseNode.setting.widgets&&this.mouseNode.setting.widgets.length+1>this.mouseNode.setting.maxWidgets?this._showGroupExceedMaxError(this.mouseNode.setting):(this.moveWidgetToGroup(a,this.mouseNode),"groupOnScreen"===this.name&&
(c.push(a.gnode.setting),c.push(this.mouseNode.setting)),b=!0):"widget"===this.mouseNode.type&&("group"===a.type?console.log("not allow move group to widget, revert"):!1===a.setting.inPanel||!1===this.mouseNode.setting.inPanel?this._showOffPanelToGroupError():a.gnode||this.mouseNode.gnode?console.log("can not nest group"):(this.moveWidgetToWidget(a,this.mouseNode),b=!0)),this._reopenGroup());this.destroyShadowNode();b&&("poolWidgets"===this.name?this.publishPoolChangeEvent():0<c.length&&this.publishOnScreenGroupsChangeEvent());
this.placeNodes()},_reopenGroup:function(){if(this.openedGNode){var a=this.openedGNode;this.closeGroup(a);this.nodeList.isExist(a)&&this.openGroup(a)}},getNodePosition:function(a){var b={},c;c=Math.ceil(a/m);a%=m;0===a&&(a=m);b.t=118*(c-1);var d=89*(a-1)+15;b.l=window.isRTL?this.box.w-d-74:d;b.w=74;b.h=118;b.r=c;b.c=a;return b},getMarginNodePosition:function(a){var b={};a=a.pos;b.l=window.isRTL?a.l+74+7.5:a.l-7.5-2.5;b.t=a.t;b.w=5;b.h=118;return b},createMarginNode:function(a){var b=new r({label:a.label,
node:a});p.place(b.domNode,this.domNode);return a.margin=b},getMousePosition:function(a){return{x:a.pageX-this.position.x,y:a.pageY-this.position.y}},moveNodeToMargin:function(a,b){b=this.getNodeByMarginNode(b);console.log("moveNodeToMargin");f(".node-margin-active",this.domNode).removeClass("node-margin-active");b.gnode&&!a.gnode?a.gnode=b.gnode:!b.gnode&&a.gnode&&(a.gnode=null);this.nodeList.moveNode(a,b)},moveNodeToEmpty:function(a,b){f(".empty-node-active",this.domNode).removeClass("empty-node-active");
b.gnode&&!a.gnode?a.gnode=b.gnode:!b.gnode&&a.gnode&&(a.gnode=null);this.nodeList.moveNode(a,b)},getNodeByMarginNode:function(a){var b;this.nodeList.visitNodes(function(c){c.margin===a&&(b=c)});return b},placeNodes:function(){var a,b;this.nodeList.visitNodes(e.hitch(this,function(c,d){a=this.getNodePosition(d);c.pos=a;p.setStyle(c.domNode,u(a));b=this.getMarginNodePosition(c);c.margin.pos=b;p.setStyle(c.margin.domNode,u(b))}));this.nodeList.printNodeList()},moveWidgetToGroup:function(a,b){a&&a.setting&&
delete a.setting.openAtStart;b.addWidget(a);this.nodeList.removeNode(a)},moveWidgetToWidget:function(a,b){var c;a&&a.setting&&delete a.setting.openAtStart;c=this.createMoveableNode("group",{label:this._getGroupLabel(),widgets:[a.setting,b.setting]});this.nodeList.insertNode(c,b);this.nodeList.removeNode(a);this.nodeList.removeNode(b)},createShadowNode:function(a){this.shadowNode=p.create("div",{"class":"node-shadow",style:u(p.getMarginBox(a.domNode))},this.domNode)},destroyShadowNode:function(){this.shadowNode&&
p.destroy(this.shadowNode)},getNodeByMousePosition:function(a,b){var c;this.nodeList.visitNodes(function(d){if("addBtn"!==d.type){if(b.x>d.pos.l+10&&b.x<d.pos.l+d.pos.w-10&&b.y>d.pos.t+10&&b.y<d.pos.t+d.pos.h-10&&d!==a)return c=d,!0;if(b.x>d.margin.pos.l&&b.x<d.margin.pos.l+d.margin.pos.w&&b.y>d.margin.pos.t&&b.y<d.margin.pos.t+d.margin.pos.h&&d.margin!==a)return c=d.margin,!0}});return c},_getGroupLabel:function(){var a=-1;this.appConfig.visitElement(e.hitch(this,function(b){if(b.widgets)if(b.label===
this.nls.newGroup)a=0;else if(b.label.startWith(this.nls.newGroup)){var c=b.label.lastIndexOf("_");-1<c&&(b=parseInt(b.label.substr(c+1,b.label.length),10),a=Math.max(a,b))}}));return-1===a?this.nls.newGroup:this.nls.newGroup+"_"+(a+1)},_showOffPanelToGroupError:function(){console.log("Off panel widget is not allowed in group.");this.emit("offpanel-group-error")},_showGroupExceedMaxError:function(a){this.emit("group-exceed-max-error",a)},_onWidgetChoosePageOk:function(a,b){if(b.listName===this.name)if(1===
a.length){var c;"addBtn"===b.type?c=a[0]:"group"===b.type?c=a[0]:(c=e.clone(b.setting),e.mixin(c,a[0]));n.publish("editWidget",c,b)}else"poolWidgets"===this.name?(q.forEach(a,function(a){this.addWidget(a)},this),this.publishPoolChangeEvent()):("addBtn"===b.type?c=e.clone(this.appConfig.getConfigElementById(b.gnode.setting.id)):"group"===b.type&&(c=e.clone(this.appConfig.getConfigElementById(b.setting.id))),c.widgets=c.widgets.concat(a),n.publish("groupChanged",c))},_onWidgetSettingPageOk:function(a,
b){if(b.listName===this.name)if(a.id)n.publish("widgetChanged",a);else if("poolWidgets"===this.name)this.addWidget(a),this.publishPoolChangeEvent();else{var c;"addBtn"===b.type?c=e.clone(this.appConfig.getConfigElementById(b.gnode.setting.id)):"group"===b.type&&(c=e.clone(this.appConfig.getConfigElementById(b.setting.id)));c.widgets.push(a);c.label||(c.label=this._getGroupLabel());n.publish("groupChanged",c)}},publishPoolChangeEvent:function(){var a=[],b=[];this.nodeList.visitNodes(function(c,d){"widget"!==
c.type||c.gnode?"group"===c.type&&(c.setting.index=d,a.push(c.setting)):(c.setting.index=d,b.push(c.setting))});n.publish("widgetPoolChanged",{widgets:b,groups:a,controllerId:this.controller.id})},publishOnScreenGroupsChangeEvent:function(){var a=[];this.nodeList.visitNodes(function(b){"group"===b.type&&a.push(b.setting)});n.publish("onScreenGroupsChanged",{groups:a})}})})},"builder/plugins/widget-config/MoveableNode":function(){define("dojo/_base/declare dojo/_base/html dojo/_base/lang dojo/_base/array dojo/on dojo/Evented dojo/aspect dojo/mouse dojo/touch dojo/topic dojo/query ./Mover dojo/dnd/move dijit/_WidgetBase jimu/dijit/Message jimu/utils dojo/NodeList-dom dojo/NodeList-manipulate".split(" "),
function(k,e,p,q,n,l,h,f,d,c,a,b,g,u,m,r){var t="click",v=f.enter,y=f.leave;"ontouchstart"in document&&(t=d.press,v=d.enter,y=d.leave);return k([u,l],{type:"",label:"",isMoving:!1,isMouseDown:!1,postCreate:function(){this.inherited(arguments);if("addBtn"===this.type)this.label="addBtn",this.createAddBtn();else if("empty"===this.type)this.label="empty",this.createEmptyNode();else if("widget"===this.type){if(this.createWidgetNode(),"poolWidgets"===this.listName||"groupOnScreen"===this.listName)this.dnd=
new g.boxConstrainedMoveable(this.domNode,{handle:this.boxNode,box:this.parentBox,within:!0,delay:5,mover:b}),this.bindMoveEvent()}else"placeholder"===this.type?this.createPlaceholderNode():(this.createGroupNode(),"poolWidgets"===this.listName&&(this.dnd=new g.boxConstrainedMoveable(this.domNode,{handle:this.boxNode,box:this.parentBox,within:!0,delay:5,mover:b}),this.bindMoveEvent()));e.addClass(this.domNode,"moveable");e.setStyle(this.domNode,{width:this.w+"px",height:this.h+"px"})},bindMoveEvent:function(){h.after(this.dnd,
"onMoveStart",p.hitch(this,function(){this.isMoving=!0}),!0);h.after(this.dnd,"onMoveStop",p.hitch(this,function(){this.isMoving=!1}),!0)},_createWidgetIconNode:function(){var a=r.processUrlInAppConfig(this.setting.icon);this.iconNode=e.create("img",{"class":"icon",src:a,style:{width:"32px",height:"32px",margin:(this.w-32)/2+"px"}},this.boxNode)},_createPlaceholderNode:function(){this.placeholderNode=e.create("div",{"class":"placeholder",style:{width:"32px",height:"32px",margin:(this.w-32)/2+"px"}},
this.boxNode);e.create("div",{"class":"placeholder-inner",innerHTML:this.setting.placeholderIndex,style:{width:"16px",height:"16px",lineHeight:"16px",borderRadius:"8px",margin:"7px"}},this.placeholderNode)},createWidgetNode:function(){e.addClass(this.domNode,"widget-node");e.setAttr(this.domNode,"data-widget-name",this.setting.name);this.boxNode=e.create("div",{"class":"box",style:{width:this.w+"px",height:this.w+"px"}},this.domNode);this._createWidgetIconNode();this.label=this.setting.label?this.setting.label:
this.nls.defaultWidgetLabel;this.name=this.setting.name?this.setting.name:this.nls.defaultWidgetLabel;this.labelNode=e.create("div",{"class":"label",innerHTML:r.stripHTML(this.label),title:this.label},this.domNode);!1===this.setting.visible&&e.addClass(this.domNode,"hide");this.setting.openAtStart&&(this.openAtStartNode=this._createOpenAtStartNode(),this.own(n(this.openAtStartNode,t,p.hitch(this,function(a){a.stopPropagation();this.emit("clickOpenAtStart")}))));this.own(n(this.boxNode,v,p.hitch(this,
function(){c.publish("actionTriggered",{elementId:this.setting.id,action:"highLight"});this.editNode=this._createEditNode();this.own(n(this.editNode,t,p.hitch(this,function(a){a.stopPropagation();c.publish("editWidget",this.setting,this)})));this.supportOpenAtStart()&&!this.setting.openAtStart&&(this.openAtStartNode=this._createOpenAtStartNode(),this.own(n(this.openAtStartNode,t,p.hitch(this,function(a){a.stopPropagation();this.emit("clickOpenAtStart")}))));!1===this.setting.inPanel&&this.setting.isOnScreen&&
"undefined"===typeof this.setting.closeable?(this.switchNode=this._createSwitchNode(),this.own(n(this.switchNode,t,p.hitch(this,function(a){a.stopPropagation();a=p.clone(this.setting);!1===a.visible?(a.visible=!0,e.removeClass(this.domNode,"hide")):(a.visible=!1,e.addClass(this.domNode,"hide"));c.publish("widgetChanged",a)})))):(this.dropNode=this._createDropNode(),this.own(n(this.dropNode,t,p.hitch(this,function(a){a.stopPropagation();var b;b=this._checkDataSource(this.setting.id)?new m({message:this.nls.dataSourceIsUsed,
buttons:[{label:this.nls.ok,onClick:p.hitch(this,function(){this.emit("removeNode");b.close()})},{label:this.nls.cancel}]}):new m({message:this.nls.dropWidgetMessage,buttons:[{label:this.nls.ok,onClick:p.hitch(this,function(){this.emit("removeNode");b.close()})},{label:this.nls.cancel}]})}))))})));this.own(n(this.boxNode,y,p.hitch(this,function(){c.publish("actionTriggered",{elementId:this.setting.id,action:"removeHighLight"});this.editNode&&e.destroy(this.editNode);this.openAtStartNode&&!this.setting.openAtStart&&
e.destroy(this.openAtStartNode);this.dropNode&&e.destroy(this.dropNode);this.switchNode&&e.destroy(this.switchNode)})))},createPlaceholderNode:function(){e.addClass(this.domNode,"widget-node");e.addClass(this.domNode,"placeholder");e.setAttr(this.domNode,"data-placeholder-index",this.setting.placeholderIndex);this.boxNode=e.create("div",{"class":"box",style:{width:this.w+"px",height:this.w+"px"}},this.domNode);this._createPlaceholderNode();this.label=this.setting.label?this.setting.label:this.nls.defaultWidgetLabel;
this.name=this.setting.name?this.setting.name:this.nls.defaultWidgetLabel;this.labelNode=e.create("div",{"class":"label",innerHTML:r.stripHTML(this.label),title:this.label},this.domNode);this.own(n(this.boxNode,v,p.hitch(this,function(){c.publish("actionTriggered",{elementId:this.setting.id,action:"highLight"})})));this.own(n(this.boxNode,y,p.hitch(this,function(){c.publish("actionTriggered",{elementId:this.setting.id,action:"removeHighLight"})})));this.own(n(this.domNode,t,p.hitch(this,function(){c.publish("chooseWidget",
this,this.listName)})))},createGroupNode:function(){"poolWidgets"===this.listName?this._createPoolGroupNode():this._createOnScreenGroupNode()},_createOnScreenGroupNode:function(){e.addClass(this.domNode,"group-node");this.boxNode=e.create("div",{"class":"box",style:{width:this.w+"px",height:this.w+"px"}},this.domNode);if(0===this.setting.widgets.length)e.addClass(this.domNode,"placeholder"),this._createPlaceholderNode(),this.name=this.label=this.nls.defaultWidgetLabel;else if(1===this.setting.widgets.length){var a=
r.processUrlInAppConfig(this.setting.widgets[0].icon);this.iconNode=e.create("img",{"class":"icon",src:a,style:{width:"32px",height:"32px",margin:(this.w-32)/2+"px"}},this.boxNode);a=this.setting.widgets[0];this.label=a.label;this.name=a.name}else this._createSmallWidgets(),this.label=this.setting.label?this.setting.label:"Group",this.name=this.setting.name?this.setting.name:"Group";this.labelNode=e.create("div",{"class":"label",innerHTML:r.stripHTML(this.label),title:this.label},this.domNode);this.own(n(this.boxNode,
v,p.hitch(this,function(){c.publish("actionTriggered",{elementId:this.setting.id,action:"highLight"});if(0!==this.setting.widgets.length){if("undefined"===typeof this.setting.maxWidgets||this.setting.widgets.length<this.setting.maxWidgets)this.addNode=this._createAddNode(),this.own(n(this.addNode,t,p.hitch(this,function(a){c.publish("chooseWidget",this,this.listName);a.stopPropagation()}))),this.own(n(this.addNode,"mousedown",function(a){a.stopPropagation()})),this.own(n(this.addNode,"mouseup",function(a){a.stopPropagation()}));
1===this.setting.widgets.length&&(this.editNode=this._createEditNode(),this.own(n(this.editNode,t,p.hitch(this,function(a){a.stopPropagation();c.publish("editWidget",this.setting.widgets[0],this)}))),this.dropNode=this._createDropNode(),this.own(n(this.dropNode,t,p.hitch(this,function(a){var b=new m({message:this.nls.dropWidgetMessage,buttons:[{label:this.nls.ok,onClick:p.hitch(this,function(){this.setting.widgets=[];c.publish("groupChanged",this.setting);b.close()})},{label:this.nls.cancel}]});a.stopPropagation()}))))}})));
this.own(n(this.boxNode,y,p.hitch(this,function(){c.publish("actionTriggered",{elementId:this.setting.id,action:"removeHighLight"});this.addNode&&e.destroy(this.addNode);this.editNode&&e.destroy(this.editNode);this.dropNode&&e.destroy(this.dropNode)})));this.own(n(this.boxNode,t,p.hitch(this,function(){if(0===this.setting.widgets.length)c.publish("chooseWidget",this,this.listName);else if(1!==this.setting.maxWidgets||1!==this.setting.widgets.length)"open"===this.status?this.closeGroup():this.openGroup()})))},
_createPoolGroupNode:function(){e.addClass(this.domNode,"group-node");this.boxNode=e.create("div",{"class":"box",style:{width:this.w+"px",height:this.w+"px"}},this.domNode);this.label=this.setting.label?this.setting.label:"Group";this.name=this.setting.name?this.setting.name:"Group";this.labelNode=e.create("div",{"class":"label",innerHTML:r.stripHTML(this.setting.label),title:this.setting.label},this.domNode);this._createSmallWidgets();this.setting.openAtStart&&(this.openAtStartNode=this._createOpenAtStartNode(),
this.own(n(this.openAtStartNode,t,p.hitch(this,function(a){a.stopPropagation();this.emit("clickOpenAtStart")}))));this.own(n(this.boxNode,v,p.hitch(this,function(){c.publish("actionTriggered",{elementId:this.setting.id,action:"highLight"});this.editNode=this._createEditNode();this.own(n(this.editNode,t,p.hitch(this,function(a){a.stopPropagation();c.publish("editGroup",this,this.setting)})));this.own(n(this.editNode,"mousedown",function(a){a.stopPropagation()}));this.own(n(this.editNode,"mouseup",
function(a){a.stopPropagation()}));this.supportOpenAtStart()&&!this.setting.openAtStart&&(this.openAtStartNode=this._createOpenAtStartNode(),this.own(n(this.openAtStartNode,t,p.hitch(this,function(a){a.stopPropagation();this.emit("clickOpenAtStart")}))));this.dropNode=this._createDropNode();this.own(n(this.dropNode,t,p.hitch(this,function(a){var b=new m({message:this.nls.dropGroupMessage,buttons:[{label:this.nls.ok,onClick:p.hitch(this,function(){this.emit("removeNode");b.close()})},{label:this.nls.cancel}]});
a.stopPropagation()})));this.own(n(this.dropNode,"mousedown",function(a){a.stopPropagation()}));this.own(n(this.dropNode,"mouseup",function(a){a.stopPropagation()}))})));this.own(n(this.boxNode,y,p.hitch(this,function(){c.publish("actionTriggered",{elementId:this.setting.id,action:"removeHighLight"});this.editNode&&e.destroy(this.editNode);this.openAtStartNode&&!this.setting.openAtStart&&e.destroy(this.openAtStartNode);this.dropNode&&e.destroy(this.dropNode)})));this.own(n(this.boxNode,t,p.hitch(this,
function(a){a.preventDefault();a.stopPropagation();"open"===this.status?this.closeGroup():this.openGroup()})))},closeGroup:function(){this.status="close"},openGroup:function(){this.status="open"},createAddBtn:function(){e.addClass(this.domNode,"add-widget-node");var a=e.create("div",{"class":"box",style:{width:this.w+"px",height:this.w+"px"},title:this.nls.addWidget},this.domNode);e.create("img",{src:this.folderUrl+"css/images/add_widget.png"},a);this.own(n(this.domNode,t,p.hitch(this,function(){c.publish("chooseWidget",
this,this.listName)})))},createEmptyNode:function(){e.addClass(this.domNode,"empty-node");e.create("div",{"class":"box",style:{width:this.w+"px",height:this.w+"px"}},this.domNode)},_createEditNode:function(){var a={bottom:"0",width:"20px",height:"20px"};a[window.isRTL?"left":"right"]="0";return e.create("div",{"class":"edit-btn",style:a,title:this.nls.configureWidget},this.boxNode)},supportOpenAtStart:function(){var a=this.setting;return"group"===this.type?"poolWidgets"===this.listName?!0:!1:!a.isController&&
!a.isThemeWidget&&a.visible&&(a.isOnScreen&&(a.closeable||a.inPanel&&!this.gnode)||!a.isOnScreen&&!this.gnode)},_createOpenAtStartNode:function(){var a={bottom:"4px",width:"12px",height:"12px"};a[window.isRTL?"right":"left"]="4px";return e.create("div",{"class":this.setting.openAtStart?"open-at-start-btn active":"open-at-start-btn deactive",style:a,title:this.setting.openAtStart?this.nls.activeOpenAtStart:this.nls.deactiveOpenAtStart},this.boxNode)},_createDropNode:function(){var a={top:"0",width:"20px",
height:"20px"};a[window.isRTL?"left":"right"]="0";return e.create("div",{"class":"drop-btn",style:a,title:this.nls.removeWidget},this.boxNode)},_createAddNode:function(){var a={top:"0",width:"20px",height:"20px"};a[window.isRTL?"right":"left"]="0";return e.create("div",{"class":"small-add-btn",style:a,title:this.nls.addWidget},this.boxNode)},_createSwitchNode:function(){var a=e.hasClass(this.domNode,"hide")?this.nls.showWidget:this.nls.hideWidget,b={top:"3px",width:"15px",height:"10px"};b[window.isRTL?
"left":"right"]="3px";return e.create("div",{"class":"switch-btn",style:b,title:a},this.boxNode)},_createSmallWidgets:function(){a(".small",this.boxNode).remove();var b=[],c=!1;4<this.setting.widgets.length?(b=this.setting.widgets.slice(0,3),c=!0):(b=this.setting.widgets,c=!1);b.forEach(p.hitch(this,function(a){this._createSmallWidget(a)}));c&&this._createSmallMore()},_createSmallWidget:function(a){var b;b=e.create("div",{"class":"small small-widget","data-wid":a.id,style:{width:"20px",height:"20px",
marginLeft:(this.w-40)/3+"px",marginTop:(this.w-40)/3+"px"}},this.boxNode);var c=a.icon;if(a.icon.startWith("widgets")||a.icon.startWith("configs")||a.icon.startWith("themes"))c=require(r.getRequireConfig()).toUrl(a.icon);e.create("img",{src:c,style:{width:"20px",height:"20px"}},b);return b},_createSmallMore:function(){var a;a=e.create("div",{"class":"small small-more",style:{width:"20px",height:"20px",marginLeft:(this.w-40)/3+"px",marginTop:(this.w-40)/3+"px"}},this.boxNode);e.create("img",{src:"builder/images/more_widget.png",
style:{width:"20px"}},a);return a},addWidget:function(a){"group"!==this.type?console.log("can not add widget to widget"):(this.setting.widgets.push(a.setting),this._createSmallWidgets())},updateSmallWidgets:function(){this._createSmallWidgets()},destroy:function(){this.margin&&this.margin.destroy();this.inherited(arguments)},_checkDataSource:function(a){return this.appConfig.dataSource?q.some(Object.keys(this.appConfig.dataSource.dataSources),function(b){if(b.startWith("widget~"+a+"~")){var c=!1;
this.appConfig.visitElement(function(d){if(d.id!==a&&d.config&&"object"===typeof d.config&&-1<JSON.stringify(d.config).indexOf(b))return c=!0});return c}},this):!1}})})},"builder/plugins/widget-config/Mover":function(){define("dojo/_base/array dojo/_base/declare dojo/_base/lang dojo/sniff dojo/_base/window dojo/dom dojo/dom-geometry dojo/dom-style dojo/Evented dojo/on dojo/touch dojo/dnd/common dojo/dnd/autoscroll".split(" "),function(k,e,p,q,n,l,h,f,d,c,a,b,g){q.add("ie11",function(){var a=-1,b=
"",c=null;"Microsoft Internet Explorer"===navigator.appName?(b=navigator.userAgent,c=/MSIE ([0-9]{1,}[.0-9]{0,})/,null!==c.exec(b)&&(a=parseFloat(RegExp.$1))):"Netscape"===navigator.appName&&(b=navigator.userAgent,c=/Trident\/.*rv:([0-9]{1,}[.0-9]{0,})/,null!==c.exec(b)&&(a=parseFloat(RegExp.$1)));return a});return e("dojo.dnd.Mover",[d],{constructor:function(b,d,e){function f(a){a.preventDefault();a.stopPropagation()}this.node=l.byId(b);this.marginBox={l:d.pageX,t:d.pageY};this.mouseButton=d.button;
d=this.host=e;b=b.ownerDocument;this.events=[c(b,a.move,p.hitch(this,"onFirstMove")),c(b,a.move,p.hitch(this,"onMouseMove")),c(b,a.release,p.hitch(this,"onMouseUp")),c(b,"dragstart",f),c(b.body,"selectstart",f)];g.autoScrollStart(b);if(d&&d.onMoveStart)d.onMoveStart(this)},onMouseMove:function(a){g.autoScroll(a);var b=this.marginBox;this.host.onMove(this,{l:b.l+a.pageX,t:b.t+a.pageY},a);a.preventDefault();a.stopPropagation()},onMouseUp:function(a){var b=q("webkit")&&q("mac")&&2===this.mouseButton,
c=(q("ie")||q("ie11"))&&-1===this.mouseButton;(b||c?0===a.button:this.mouseButton===a.button)&&this.destroy();a.preventDefault();a.stopPropagation()},onFirstMove:function(a){var b=this.node.style,c,d=this.host;switch(b.position){case "relative":case "absolute":c=Math.round(parseFloat(b.left))||0;b=Math.round(parseFloat(b.top))||0;break;default:b.position="absolute";b=h.getMarginBox(this.node);c=n.doc.body;var e=f.getComputedStyle(c),g=h.getMarginBox(c,e),e=h.getContentBox(c,e);c=b.l-(e.l-g.l);b=b.t-
(e.t-g.t)}this.marginBox.l=c-this.marginBox.l;this.marginBox.t=b-this.marginBox.t;if(d&&d.onFirstMove)d.onFirstMove(this,a);this.events.shift().remove()},destroy:function(){k.forEach(this.events,function(a){a.remove()});var a=this.host;if(a&&a.onMoveStop)a.onMoveStop(this);this.events=this.node=this.host=null}})})},"builder/plugins/widget-config/LinkList":function(){define(["dojo/_base/declare","dojo/_base/html","dojo/_base/array"],function(k){return k(null,{headNode:null,currentNode:null,constructor:function(e){this.name=
e.name},visitNodes:function(e){for(var k=this.headNode,q=1;k;)e(k,q),q++,k=k.next},destroyAllNodes:function(){for(var e=this.headNode,k;e;)k=e.next,e.destroy(),e=null,e=k;this.headNode=null},getCount:function(){var e=0;this.visitNodes(function(k,q){e=q});return e},isExist:function(e){var k=!1;this.visitNodes(function(p){p===e&&(k=!0)});return k},printNodeList:function(){this.visitNodes(function(e){})},getPreNode:function(e){var k;this.visitNodes(function(p){p.next===e&&(k=p)});return k},getNodeByIndex:function(e){var k;
this.visitNodes(function(p,n){n===e&&(k=p)});return k},getNodeByLabel:function(e){var k;this.visitNodes(function(p){p.label===e&&(k=p)});return k},getNodeIndex:function(e){var k;this.visitNodes(function(p,n){p===e&&(k=n)});return k},removeNode:function(e){var k;(k=this.getPreNode(e))?k.next=e.next:this.headNode=e.next;e.destroy()},removeNodeByIndex:function(e){this.removeNode(this.getNodeByIndex(e))},insertNode:function(e,k){var p;k="number"===typeof k?this.getNodeByIndex(k):k;(p=this.getPreNode(k))?
p.next=e:this.headNode=e;e.next=k},moveNode:function(e,k){var p=this.getPreNode(e),n=this.getPreNode(k);e!==k&&e!==n&&(p?p.next=e.next:this.headNode=e.next,e.next=k,n?n.next=e:this.headNode=e)}})})},"builder/plugins/widget-config/WidgetSettingPage":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/_base/array dojo/_base/config dojo/Deferred dojo/request dojo/topic dojo/aspect dojo/on dojo/mouse dojo/query dojo/string dojo/NodeList-dom dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./WidgetSettingPage.html ./WidgetDefaultSettingPage jimu/utils jimu/WidgetManager jimu/portalUrlUtils jimu/portalUtils jimu/dijit/ViewStack jimu/dijit/ImageChooser jimu/dijit/LoadingIndicator jimu/dijit/Message dijit/form/CheckBox esri/request".split(" "),
function(k,e,p,q,n,l,h,f,d,c,a,b,g,u,m,r,t,v,y,w,z,x,A,C,B,E,D,F,I){var M="en de es fr ja ru zh-cn zh-tw zh-hk ar it ko pl pt-br pt-pt ro".split(" "),L=[],J=null;return k([m,r,t],{templateString:v,startup:function(){this.inherited(arguments);this.own(h("builder/widgethelp.json",{handleAs:"json"}).then(function(a){J=a},function(a){console.error(a)}).always(e.hitch(this,function(){this.domNode&&(this.own(c(window,"resize",e.hitch(this,this.resize))),this.init())})))},init:function(){this.loading=new E;
p.addClass(this.loading.domNode,"load-widget-setting");this.loading.placeAt(this.widgetSettingNode);this.initCommonAttr();this.initWidgetAttr();this.resize()},resize:function(){var a=p.getContentBox(this.domNode);p.setStyle(this.widgetSettingNode,{height:a.h-90+"px"})},onCancel:function(){this.onClose();this.popup.close()},onOk:function(){var a=this._checkLabelExist();if(a)return new D({message:a}),!1;this.imageChooser.imageData&&(this.setting.icon=this.imageChooser.imageData);this.setting.label=
w.stripHTML(this.labelNode.get("value"));if(this.settingDijit){var b=this.settingDijit.getConfig(!0);if(!1===b)return!1;b&&"function"===typeof b.then?b.then(e.hitch(this,function(a){if(!1===a)return!1;var b=this.settingDijit.getDataSources();b&&"function"===typeof b.then?b.then(e.hitch(this,function(b){this.setting.config=a;this.setting.provideDataSources=b;this._closeSettingPopup()})):(this.setting.config=a,this.setting.provideDataSources=b,this._closeSettingPopup())})):(a=this.settingDijit.getDataSources())&&
"function"===typeof a.then?a.then(e.hitch(this,function(a){this.setting.config=b;this.setting.provideDataSources=a;this._closeSettingPopup()})):(this.setting.config=b,this.setting.provideDataSources=a,this._closeSettingPopup())}else this._closeSettingPopup()},_closeSettingPopup:function(){delete this.setting.isDefaultConfig;f.publish("widgetSettingPageOk",this.setting,this.fromNode);this.onClose();this.popup.close()},_checkLabelExist:function(){var a=0,b=this.labelNode.get("value");if(""===g.trim(b))return this.nls.labelRequired;
var c=w.getControllerWidgets(this.appConfig);this.appConfig.visitElement(e.hitch(this,function(d){this.setting.id!==d.id&&d.label===b&&(0<c.length?a++:d.isOnScreen&&a++)}));return 0<a?this.nls.labelExists:""},onClose:function(){this.settingViewStack?(this.settingDijitUI.destroy(),this.settingDijitJSON.destroy(),this.settingViewStack.destroy()):this.settingDijit&&this.settingDijit.destroy()},_getHelpLink:function(a,b){var c=new l,d=null;a=a.toLowerCase();b="html"===(b||"html").toLowerCase()?"widgets2d":
"widgets3d";if(window.isXT)h("/webappbuilder/help/exists",{handleAs:"json"}).then(e.hitch(this,function(f){f&&f.exists?h("/webappbuilder/help/cxhelp.js",{handleAs:"json"}).then(e.hitch(this,function(f){var g="#";d=e.getObject("dev."+b+"."+a,!1,J);f&&f.m&&d&&f.m[d]?g="/webappbuilder/help/"+f.m[d]:d&&(g="/webappbuilder/help/"+d);c.resolve(g)}),e.hitch(this,function(a){console.warn(a);c.resolve("#")})):c.resolve("#")}),function(a){console.error(a);c.resolve("#")});else{var f=x.getPortalUrlFromLocation();
if(-1<f.indexOf("arcgis.com")){var g="#",d=e.getObject("online."+b+"."+a,!1,J);"widgets3d"===b||n.locale.toLowerCase().startWith("en")||-1<L.indexOf(a)||-1===M.indexOf(n.locale.toLowerCase())?(d&&(g="http://"+(-1<f.indexOf("maps.arcgis.com")?"doc":"docdev")+".arcgis.com/en/web-appbuilder/create-apps/"+d),c.resolve(g)):(g={url:x.getPortalSelfInfoUrl(f),content:{f:"json",culture:n.locale},handleAs:"json",callbackParamName:"callback",preventCache:!0},I(g).then(e.hitch(this,function(a){var b="#";if(a&&
a.helpBase&&d)try{b=a.helpBase.split("/").slice(0,4).join("/")+"/web-appbuilder/create-apps/"+d}catch(ha){b="http://doc.arcgis.com/en/web-appbuilder/create-apps/"+d}c.resolve(b)}),e.hitch(this,function(a){console.warn(a);c.resolve("#")})))}else{var k=n.locale||"en",d=e.getObject("portal."+b+"."+a,!1,J);h(f+"portalhelp/en/website/help/cxhelp.js",{handleAs:"json"}).then(e.hitch(this,function(a){var b="#";a&&a.m&&d&&a.m[d]&&(b=f+"portalhelp/"+k+"/website/help/"+a.m[d]);c.resolve(b)}),e.hitch(this,function(a){console.warn(a);
c.resolve("#")}))}}return c},initCommonAttr:function(){var a=w.processUrlInAppConfig(this.setting.icon);p.setAttr(this.iconNode,"src",a);this.labelNode.set("value",this.setting.label);this._getHelpLink(this.setting.name,e.getObject("manifest.platform",!1,this.setting)).then(e.hitch(this,function(a){"#"!==a&&(p.setStyle(this.helpNode,"display","inline-block"),p.setAttr(this.helpNode,"href",a))}));this.imageChooser=new B({goldenWidth:24,goldenHeight:24,format:[B.GIF,B.JPEG,B.PNG],label:this.nls.changeIcon},
this.imageChooserPlaceholder);p.addClass(this.imageChooser.domNode,"jimu-float-leading");!1===this.setting.inPanel&&!0===this.setting.isOnScreen&&!0!==this.setting.closeable?(this.imageChooser.disableChooseImage(),p.setAttr(this.imageChooser.domNode,"title",this.nls.unableChangeIcon)):(this.imageChooser.enableChooseImage(),this.own(c(this.imageChooser,"imageChange",e.hitch(this,function(a){this.iconNode.src=a;this.setting.icon=a}))))},initWidgetAttr:function(){!1===this.setting.hasConfig?this.widgetSettingNode.innerHTML=
'\x3cdiv class\x3d"noconfig-info"\x3e'+this.nls.noConfig+"\x3c/div\x3e":z.getInstance().tryLoadWidgetConfig(this.setting).then(e.hitch(this,function(a){this.setting.hasSettingPage?z.getInstance().loadWidgetSettingPage(this.setting).then(e.hitch(this,function(a){this.widgetSettingNode?(this.settingDijit=a,p.place(this.settingDijit.domNode,this.widgetSettingNode),this.settingDijit.startup(),this.loading.destroy(),p.setAttr(this.widgetSettingNode,"data-widget-loaded","true")):a.destroy()})):this.widgetSettingNode&&
(this.settingDijit=new y({config:this.setting.config}),p.place(this.settingDijit.domNode,this.widgetSettingNode),this.settingDijit.startup(),this.loading.destroy())}))},setAppConfig:function(a){this.appConfig=a}})})},"builder/plugins/widget-config/WidgetDefaultSettingPage":function(){define("dojo/_base/declare dojo/_base/lang dojo/on dojo/keys dijit/_WidgetBase ./JSONEditor".split(" "),function(k,e,p,q,n,l){return k([n],{baseClass:"widget-default-setting",postCreate:function(){this.inherited(arguments);
this.jsonEditor=new l({json:this.config});this.jsonEditor.placeAt(this.domNode);this.own(p(this.domNode,"keydown",e.hitch(this,"_onEnterPress")))},_onEnterPress:function(e){(void 0!==e.keyCode?e.keyCode:e.which)===q.ENTER&&e.stopPropagation()},getDataSources:function(){return[]},setConfig:function(e){return this.jsonEditor.setJSON(e)},getConfig:function(){return this.jsonEditor.getJSON()}})})},"builder/plugins/widget-config/JSONEditor":function(){define(["dojo/_base/declare","dijit/_WidgetBase"],
function(k,e){return k([e],{baseClass:"json-editor",postCreate:function(){this.inherited(arguments);this.editor=ace.edit(this.domNode);this.editor.setTheme("ace/theme/textmate");this.editor.setHighlightActiveLine(!0);this.editor.setValue(JSON.stringify(this.json,null,2));this.editor.getSession().setMode("ace/mode/json")},setJSON:function(e){this.json=e;this.editor.setValue(JSON.stringify(this.json,null,2))},getJSON:function(){return JSON.parse(this.editor.getValue())}})})},"builder/plugins/widget-config/GroupSettingPage":function(){define("dojo/_base/declare dojo/dom-attr dojo/topic dijit/_WidgetBase dijit/_TemplatedMixin dojo/text!./GroupSettingPage.html".split(" "),
function(k,e,p,q,n,l){return k([q,n],{templateString:l,baseClass:"group-setting-page",startup:function(){this.labelNode.value=this.setting.label},onOk:function(){this.setting.label=e.get(this.labelNode,"value");p.publish("groupChanged",this.setting);this.popup.close()},onCancel:function(){}})})},"builder/plugins/widget-config/WidgetChoosePage":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/_base/array dojo/topic dojo/on dojo/Deferred dojo/promise/all dojo/query dojo/NodeList-dom dijit/_WidgetBase dijit/_TemplatedMixin dojo/text!./WidgetChoosePage.html jimu/dijit/Search jimu/WidgetManager jimu/dijit/LoadingShelter jimu/dijit/Message jimu/dijit/TabContainer3 jimu/utils jimu/portalUtils jimu/portalUrlUtils builder/serviceUtils esri/lang ./CustomWidgets".split(" "),
function(k,e,p,q,n,l,h,f,d,c,a,b,g,u,m,r,t,v,y,w,z,x,A,C){return k([a,b],{templateString:g,showCustomWidgets:!1,postMixInProperties:function(){this.widgetManager=m.getInstance()},startup:function(){this.inherited(arguments);this.showCustomWidgets||p.addClass(this.domNode,"hide-custom-widgets");this.tab=new v({tabs:[{title:this.nls.officialWidgets,content:this.officialSection},{title:this.nls.customWidgets,content:this.customSection}]});this.tab.placeAt(this.domNode);this.searchDijit1=new u({placeholder:this.nls.widgetSearchHint,
onSearch:e.hitch(this,this._onFilterDefaultWidget),searchWhenInput:!0},this.searchInputNode);this._getWidgets();this.own(l(window,"resize",e.hitch(this,this.resize)));setTimeout(e.hitch(this,function(){this.resize()}),100);this.loading=new r({hidden:!0});this.loading.placeAt(this.domNode);this.loading.startup();this.searchDijit1.inputSearch.focus();this.showCustomWidgets&&(this.searchDijit2=new u({placeholder:this.nls.widgetSearchHint,onChange:e.hitch(this,this._onFilterCustomWidget),onSearch:e.hitch(this,
this._onSearchCustomWidget),searchWhenInput:!1},this.customSearchInputNode),this.allCustomWidgets=new C({portalUrl:window.portalUrl,fromNode:this.fromNode,widgetDomNode:this.domNode}),this.allCustomWidgets.placeAt(this.customSection),this.filterCustomWidgets=new C({portalUrl:window.portalUrl,hidden:!0,fromNode:this.fromNode,widgetDomNode:this.domNode}),this.filterCustomWidgets.placeAt(this.customSection),this.own(l(this.tab,"tabChanged",e.hitch(this,function(a){a===this.nls.customWidgets?(this.searchDijit2.inputSearch.focus(),
this.allCustomWidgets.queried||(this.allCustomWidgets.queried=!0,this.allCustomWidgets.queryItems())):this.searchDijit1.inputSearch.focus()}))))},_onFilterCustomWidget:function(a){this.allCustomWidgets.show();this.filterCustomWidgets.hide();a?this.allCustomWidgets.filterLocally(function(b){return b.title&&0<=b.title.toUpperCase().indexOf(a.toUpperCase())}):this.allCustomWidgets.filterLocally(function(){return!0})},_onSearchCustomWidget:function(a){a?(this.allCustomWidgets.hide(),this.filterCustomWidgets.show(),
this.filterCustomWidgets.queryItems({q:'title:"'+a+'"'})):(this.allCustomWidgets.show(),this.filterCustomWidgets.hide())},_onFilterDefaultWidget:function(a){var b;b=""===a?this.allWidgets:q.filter(this.allWidgets,function(b){if(-1<b.label.toUpperCase().indexOf(a.toUpperCase()))return!0});this._createWidgetNodes(b)},resize:function(){var a=p.getContentBox(this.domNode).h,b=a-60;p.setStyle(this.searchSectionNode,{height:a+"px"});p.setStyle(this.widgetListNode,{height:b+"px"})},setAppConfig:function(a){this.appConfig=
a},_getWidgets:function(){var a={};this.appConfig.map["2D"]&&(a.support2D=!0);this.appConfig.map["3D"]&&(a.support3D=!0);this.appConfig.map["2D"]&&this.appConfig.map["3D"]&&(a.support2D=!0,a.support3D=!0);a.platform=window.stemappInfo.appType;this.options.includeOffPanel||(a["properties.inPanel"]=!0);x.searchWidgets(a).then(e.hitch(this,function(a){a.success?(this.allWidgets=this._filterSingletonWidgets(a.widgets),this._createWidgetNodes(this.allWidgets)):console.log(a.message)}))},_filterSingletonWidgets:function(a){return q.filter(a,
function(a){return!1===a.properties.supportMultiInstance&&this._checkWidgetIsInAppConfig(this.appConfig,a.name)?!1:!0},this)},_checkWidgetIsInAppConfig:function(a,b){var c=[];0===y.getControllerWidgets(a).length?a.visitElement(e.hitch(this,function(a){a.isOnScreen&&a.name===b&&c.push(a)})):c=a.getConfigElementsByName(b);return 0<c.length},_createWidgetNodes:function(a){p.empty(this.widgetListNode);q.forEach(a,function(a){this._createWidgetNode(a)},this)},_createWidgetNode:function(a){var b,c;b=p.create("div",
{"class":"widget-node","data-widget-name":a.name},this.widgetListNode);c=p.create("div",{"class":"box"},b);p.create("div",{"class":"box-selected"},b);p.create("img",{"class":"icon",src:a.icon},c);p.create("div",{"class":"label",innerHTML:y.stripHTML(a.label),title:a.label},b);b.setting={name:a.name,label:a.label,version:a.version,closeable:"removeableWidgetOnScreen"===this.fromList?!0:void 0};y.widgetJson.addManifest2WidgetJson(b.setting,a);b.setting.uri=a.amdFolder+"Widget";b.box=c;this.own(l(b,
"click",e.hitch(this,this._onWidgetClick,b)));return b},_onWidgetClick:function(a){0===this.tab.getSelectedIndex()?d(".custom-section .jimu-state-selected",this.domNode).removeClass("jimu-state-selected"):d(".official-section .jimu-state-selected",this.domNode).removeClass("jimu-state-selected");this._isMultipleSelection()?p.hasClass(a,"jimu-state-selected")?p.removeClass(a,"jimu-state-selected"):p.addClass(a,"jimu-state-selected"):(d(".jimu-state-selected",this.domNode).removeClass("jimu-state-selected"),
p.addClass(a,"jimu-state-selected"))},_isMultipleSelection:function(){var a=this.fromNode;return"addBtn"===a.type&&"poolWidgets"===this.fromList||"addBtn"===a.type&&"groupOnScreen"===this.fromList&&this._canAddMoreWidgetsInGroup(a.gnode)||"group"===a.type&&this._canAddMoreWidgetsInGroup(a)},_canAddMoreWidgetsInGroup:function(a){return a?"undefined"===typeof a.setting.maxWidgets||a.setting.maxWidgets>a.setting.widgets.length+1:!1},onOk:function(){(0===this.tab.getSelectedIndex()?this._getOfficialSelection():
this._getCustomSelection()).then(e.hitch(this,function(a){var b=[];"group"===this.fromNode.type&&"undefined"!==typeof this.fromNode.setting.maxWidgets&&this.fromNode.setting.widgets.length+a.length>this.fromNode.setting.maxWidgets?(new t({message:A.substitute({maxCount:this.fromNode.setting.maxWidgets},this.nls.addWidgetExceedMax)}),this.loading.hide()):(q.forEach(a,function(a){b.push(this._copyWidget(a))},this),f(b).then(e.hitch(this,function(b){var c;for(c=0;c<b.length;c++)if(!b[c].success){new t({message:b[c].message});
this.loading.hide();return}this.loading.hide();this.popup.domNode&&(n.publish("widgetChoosePageOk",a,this.fromNode),this.popup.close())})))}),function(a){new t({message:a.message});console.error(a.stack)})},_getOfficialSelection:function(){var a=new h,b=d(".jimu-state-selected",this.domNode);if(0===b.length)return new t({message:this.nls.emptyMessage}),a.reject({message:this.nls.emptyMessage}),a;this.loading.show();b=q.map(b,function(a){return e.clone(a.setting)});a.resolve(b);return a},_getCustomSelection:function(){var a=
[],a=this.allCustomWidgets.isVisible()?this.allCustomWidgets.getSelectedWidgetItems():this.filterCustomWidgets.getSelectedWidgetItems();return f(a.map(function(a){return x.getManifestFromItem(a).then(function(b){var c={name:b.name,label:a.title,version:b.version};y.widgetJson.addManifest2WidgetJson(c,b);c.uri=y.widgetJson.getUriFromItem(a);c.itemId=a.id;return c})}))},_copyWidget:function(a){var b=0,c,d=[],f=y.getControllerWidgets(this.appConfig);this.appConfig.visitElement(e.hitch(this,function(c){if(0!==
f.length||c.isOnScreen)c.name===a.name&&b++,d.push(c.label)}));a.icon=a.manifest.folderUrl+"images/icon.png?wab_dv\x3d"+window.deployVersion;if(0===b)a.label=a.label,c=x.copyWidgetToApp(window.appInfo.id,a);else if(0<b){c=new h;for(var g=a.label+"_"+(b+1);-1<d.indexOf(g);)b++,g=a.label+"_"+(b+1);a.label=g;c.resolve({success:!0})}return c}})})},"builder/plugins/widget-config/CustomWidgets":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./CustomWidgets.html dojo/Evented dojo/query dojo/_base/lang dojo/_base/array dojo/_base/html jimu/utils jimu/portalUtils jimu/portalUrlUtils jimu/dijit/LoadingIndicator".split(" "),
function(k,e,p,q,n,l,h,f,d,c,a,b,g){return k([e,p,q,l],{templateString:n,baseClass:"custom-widgets",query:null,nls:null,type:"AppBuilder Extension",portalUrl:null,hidden:!1,postMixInProperties:function(){this.nls=window.jimuNls.itemSelector},postCreate:function(){this.inherited(arguments);this.portalUrl=g.getStandardPortalUrl(this.portalUrl);this.portal=b.getPortal(this.portalUrl);this.baseQ='type:"'+this.type+'" AND typekeywords:"Widget,'+window.appInfo.appType+'"';"HTML"===window.appInfo.appType.toUpperCase()&&
(this.baseQ+=' -typekeywords:"HTML3D"');this.hidden&&this.hide()},filterLocally:function(a){h(".widget-node",this.domNode).forEach(f.hitch(this,function(b){a(b.item)?c.removeClass(b,"hidden"):c.addClass(b,"hidden")}))},queryItems:function(a){a=a||{};this.loading.show();this.clear();f.mixin(this.query,a);this.query.start=1;this.query.q=a.q?this.baseQ+" AND "+a.q:this.baseQ;return this.portal.queryItems(this.query).then(f.hitch(this,function(a){if(this.domNode)return this.domNode&&this.loading.hide(),
this.query.start=a.nextStart,this._createItemsNode(a)}),f.hitch(this,function(a){console.error(a);this.domNode&&this.loading.hide()}))},_createItemsNode:function(a){a=a.results;var b=this.type.toLowerCase();a=d.filter(a,f.hitch(this,function(a){return(a.type&&a.type.toLowerCase()||"")===b}));d.forEach(a,f.hitch(this,function(a){this._createItemNode(a)}));return a},_createItemNode:function(b){var d=c.toDom('\x3cdiv class\x3d"widget-node"\x3e\x3cdiv class\x3d"box"\x3e\x3cimg class\x3d"icon"\x3e\x3ca target\x3d"_blank" class\x3d"detail-icon"\x3e\x3c/a\x3e\x3c/div\x3e\x3cdiv class\x3d"box-selected"\x3e\x3c/div\x3e\x3cdiv class\x3d"label"\x3e\x3c/div\x3e\x3c/div\x3e');
d.item=b;h("img",d)[0].src=a.widgetJson.getFolderUrlFromItem(b)+"images/icon.png";var e=h(".label",d)[0];e.innerHTML=b.title||"";e.title=b.title||"";e=h(".detail-icon",d)[0];e.href=b.detailsPageUrl;e.title=this.nls.viewItemDetails||"View item details";c.place(d,this.list)},clear:function(){this.query={q:this.baseQ,sortField:"title",sortOrder:"asc",num:100,start:1};c.empty(this.list)},_onClick:function(b){b=b.target||b.srcElement;var d=null;if(d=c.hasClass(b,"widget-node")?b:a.getAncestorDom(b,function(a){return c.hasClass(a,
"widget-node")},this.list))h(".official-section .jimu-state-selected",this.widgetDomNode).removeClass("jimu-state-selected"),"addBtn"===this.fromNode.type?c.toggleClass(d,"jimu-state-selected"):(h(".jimu-state-selected",this.domNode).removeClass("jimu-state-selected"),c.addClass(d,"jimu-state-selected"))},_onScroll:function(){this._isScrollToBottom(this.domNode)},_isScrollToBottom:function(b){return a.isScrollToBottom(b)},getSelectedWidgetItems:function(){var a=h(".widget-node.jimu-state-selected",
this.domNode).filter(f.hitch(this,function(a){return!c.hasClass(a,"hidden")}));return d.map(a,f.hitch(this,function(a){return a.item}))},isVisible:function(){return!c.hasClass(this.domNode,"hidden")},show:function(){c.removeClass(this.domNode,"hidden")},hide:function(){c.addClass(this.domNode,"hidden")}})})},"jimu/PoolControllerMixin":function(){define(["dojo/_base/declare","dojo/_base/array","jimu/PanelManager"],function(k,e,p){return k(null,{constructor:function(){this.panelManager=p.getInstance()},
postCreate:function(){this.controlledWidgets||(this.controlledWidgets="all");this.controlledGroups||(this.controlledGroups="all")},getOpenedIds:function(){},setOpenedIds:function(e){},getConfigById:function(e){for(var k=this.getAllConfigs(),l=0;l<k.length;l++)if(k[l].id===e)return k[l]},getAllConfigs:function(){var k=[],k=k.concat(this.getWidgetConfigs(),this.getGroupConfigs()),k=e.filter(k,function(e){return e.visible});return k.sort(function(e,k){return e.index-k.index})},getAllConfigsIncludeInvisible:function(){var e=
[],e=e.concat(this.getWidgetConfigs(),this.getGroupConfigs());return e.sort(function(e,k){return e.index-k.index})},isControlled:function(k){return e.some(this.getAllConfigsIncludeInvisible(),function(e){return e.id===k})},widgetIsControlled:function(k){return e.some(this.getAllConfigsIncludeInvisible(),function(n){return n.id===k?!0:e.some(n.widgets,function(e){return e.id===k})})},getGroupConfigs:function(){var k=[];if(!this.appConfig.widgetPool)return k;this.appConfig.widgetPool.groups&&e.forEach(this.appConfig.widgetPool.groups,
function(e){this.controlledGroups&&(Array.isArray(this.controlledGroups)?-1<this.controlledGroups.indexOf(e.id)&&k.push(e):"all"===this.controlledGroups&&k.push(e))},this);return k},getWidgetConfigs:function(){var k=[];if(!this.appConfig.widgetPool)return k;this.appConfig.widgetPool.widgets&&e.forEach(this.appConfig.widgetPool.widgets,function(e){this.controlledWidgets&&(Array.isArray(this.controlledWidgets)?-1<this.controlledWidgets.indexOf(e.id)&&k.push(e):"all"===this.controlledWidgets&&k.push(e))},
this);return k}})})},"jimu/PanelManager":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/html dojo/_base/fx dojo/Deferred dojo/promise/all dojo/on dojo/topic dojo/when require ./utils ./WidgetManager".split(" "),function(k,e,p,q,n,l,h,f,d,c,a,b,g){var u,m=null;u=k(null,{constructor:function(){this.panels=[];this.widgetManager=g.getInstance();f(window,"resize",e.hitch(this,this.onWindowResize));this.activePanel=null;d.subscribe("/dnd/move/start",e.hitch(this,this._onMoveStart));
d.subscribe("widgetActived",e.hitch(this,this._onWidgetActived))},showPanel:function(a){var c=new l,d=this.getPanelById(a.id+"_panel");d?("closed"===d.state&&this.openPanel(d),c.resolve(d)):h({Panel:this._loadPanelClass(a.panel.uri),nls:this._loadThemeI18N(a.panel.uri)}).then(e.hitch(this,function(d){var g=a.id+"_panel",h=this.getPanelById(g),k={label:a.label,config:a,uri:a.panel.uri,position:a.panel.position,map:this.map,widgetManager:this.widgetManager,panelManager:this,id:g,gid:a.gid,nls:d.nls};
e.mixin(k,a.panel.options);try{h=new d.Panel(k),console.log("panel ["+g+"] created.")}catch(A){console.log("create panel error: "+A+", panelId: "+g);c.reject(A);return}h.setPosition(a.panel.position);b.setVerticalCenter(h.domNode);this.openPanel(h);f(h.domNode,"click",e.hitch(this,this._onPanelClick,h));c.resolve(h)}));return c},setMap:function(a){this.map=a;f(this.map,"resize",e.hitch(this,this.onMapResize))},closeOtherPanelsInTheSameGroup:function(a){if("string"===typeof a&&(a=this.getPanelById(a),
!a))return;for(var b=0;b<this.panels.length;b++)this.panels[b].gid===a.gid&&this.panels[b].id!==a.id&&this.closePanel(this.panels[b])},closeAllPanelsInGroup:function(a){for(var b=0;b<this.panels.length;b++)this.panels[b].gid===a&&this.closePanel(this.panels[b])},openPanel:function(a){var b=new l;if("string"===typeof a){if(a=this.getPanelById(a),!a)return b.reject(),b}else this.panels.some(function(b){return b.id===a.id})||this.panels.push(a);if(!a.started)try{a.started=!0,a.startup()}catch(v){console.error("fail to startup panel "+
a.id+". "+v.stack)}if("opened"===a.state)return this._activePanel(a),b.resolve(a),b;a.setState("opened");return this.playOpenPanelAnimation(a).then(e.hitch(this,function(){q.setStyle(a.domNode,"display","");a.onOpen();this._activePanel(a);return a}))},closePanel:function(a){var b=new l;return"string"===typeof a&&(a=this.getPanelById(a),!a)||"closed"===a.state?(b.resolve(),b):this.playClosePanelAnimation(a).then(e.hitch(this,function(){this.activePanel&&this.activePanel.id===a.id&&(this.activePanel.onDeActive(),
this.activePanel=null);a.setState("closed");a.onClose();a.domNode&&q.setStyle(a.domNode,"display","none")}))},minimizePanel:function(a){if("string"===typeof a&&(a=this.getPanelById(a),!a))return;"closed"===a.state&&this.openPanel(a);a.setWindowState("minimized");try{a.onMinimize()}catch(t){console.log(console.error("fail to minimize panel "+a.id+". "+t.stack))}},maximizePanel:function(a){if("string"===typeof a&&(a=this.getPanelById(a),!a))return;"closed"===a.state&&this.openPanel(a);a.setWindowState("maximized");
try{a.onMaximize()}catch(t){console.log(console.error("fail to maximize panel "+a.id+". "+t.stack))}},normalizePanel:function(a){if("string"===typeof a&&(a=this.getPanelById(a),!a))return;"closed"===a.state&&this.openPanel(a);a.setWindowState("normal");try{a.onNormalize()}catch(t){console.log(console.error("fail to noralize panel "+a.id+". "+t.stack))}},changeWindowStateTo:function(a,b){if("string"===typeof a&&(a=this.getPanelById(a),!a))return;"normal"===b?this.normalizePanel(a):"minimized"===b?
this.minimizePanel(a):"maximized"===b?this.maximizePanel(a):console.log("error state: "+b)},getPanelById:function(a){for(var b=0;b<this.panels.length;b++)if(this.panels[b].id===a)return this.panels[b]},onWindowResize:function(){for(var a=0;a<this.panels.length;a++)"closed"!==this.panels[a].state&&"map"!==this.panels[a].position.relativeTo&&this.panels[a].resize()},onMapResize:function(){for(var a=0;a<this.panels.length;a++)"closed"!==this.panels[a].state&&"map"===this.panels[a].position.relativeTo&&
this.panels[a].resize()},destroyPanel:function(a){if("string"===typeof a&&(a=this.getPanelById(a),!a))return;if(a.domNode){"closed"!==a.state&&this.closePanel(a);this._removePanel(a);try{a.destroy()}catch(t){console.log(console.error("fail to destroy panel "+a.id+". "+t.stack))}}},destroyAllPanels:function(){var a=p.map(this.panels,function(a){return a.id});p.forEach(a,function(a){this.destroyPanel(a)},this);this.panels=[]},playOpenPanelAnimation:function(a){if("string"===typeof a&&(a=this.getPanelById(a),
!a)||!a.openAnimation||0===a.animationDuration)return c();var b=new l;"string"===typeof a.openAnimation?"fadeIn"===a.openAnimation?(q.setStyle(a.domNode,{opacity:0,display:""}),n.fadeIn({node:a.domNode,duration:a.animationDuration,onEnd:function(){b.resolve()}}).play()):b.resolve():b.resolve();return b},playClosePanelAnimation:function(a){if("string"===typeof a&&(a=this.getPanelById(a),!a)||!a.closeAnimation||0===a.animationDuration)return c();var b=new l;"string"===typeof a.closeAnimation&&("fadeOut"===
a.closeAnimation?n.fadeOut({node:a.domNode,duration:a.animationDuration,onEnd:function(){b.resolve()}}).play():b.resolve());return b},getPositionOnMobile:function(a){if("string"===typeof a&&(a=this.getPanelById(a),!a))return{};var b=q.getMarginBox(window.jimuConfig.layoutId),c=b.h/2;a.titleHeight||(a.titleHeight=35);return"maximized"===a.windowState?{left:0,right:0,top:0,bottom:0,width:"auto",height:"auto",contentHeight:b.h-a.titleHeight,borderRadiusStyle:{borderTopLeftRadius:0,borderTopRightRadius:0,
borderBottomLeftRadius:0,borderBottomRightRadius:0}}:"minimized"===a.windowState?(c=0,this.panels.filter(function(b){return"minimized"===b.windowState&&"closed"!==b.state&&b.id!==a.id}).some(function(a){return 0===a._mobileBottom})&&(c=a.titleHeight),a._mobileBottom=c,b.h>b.w?{left:0,right:0,top:"auto",bottom:c,width:"auto",height:a.titleHeight,contentHeight:0,borderRadiusStyle:{borderTopLeftRadius:"4px",borderTopRightRadius:"4px",borderBottomLeftRadius:0,borderBottomRightRadius:0}}:{left:b.w-b.w/
2,right:0,top:"auto",bottom:c,width:b.w/2,height:a.titleHeight,contentHeight:b.h,borderRadiusStyle:window.isRTL?{borderTopLeftRadius:0,borderTopRightRadius:"4px",borderBottomLeftRadius:0,borderBottomRightRadius:"4px"}:{borderTopLeftRadius:"4px",borderTopRightRadius:0,borderBottomLeftRadius:"4px",borderBottomRightRadius:0}}):b.h>b.w?{left:0,right:0,top:c,bottom:0,width:"auto",height:"auto",contentHeight:b.h-c-a.titleHeight,borderRadiusStyle:{borderTopLeftRadius:"4px",borderTopRightRadius:"4px",borderBottomLeftRadius:0,
borderBottomRightRadius:0}}:{left:b.w-b.w/2,right:0,top:0,bottom:0,width:b.w/2,height:"auto",contentHeight:b.h-c-a.titleHeight,borderRadiusStyle:window.isRTL?{borderTopLeftRadius:0,borderTopRightRadius:"4px",borderBottomLeftRadius:0,borderBottomRightRadius:"4px"}:{borderTopLeftRadius:"4px",borderTopRightRadius:0,borderBottomLeftRadius:"4px",borderBottomRightRadius:0}}},_onPanelClick:function(a){this._activePanel(a)},activatePanel:function(a){"opened"===a.state&&this._activePanel(a)},_activePanel:function(a){if(this.activePanel){if(this.activePanel.id===
a.id){this.activePanel.moveTopOnActive&&q.setStyle(this.activePanel.domNode,"zIndex",101);return}"active"===this.activePanel.state&&(this.activePanel.setState("opened"),q.setStyle(this.activePanel.domNode,"zIndex","undefined"!==typeof this.activePanel.position.zIndex?this.activePanel.position.zIndex:"auto"),this.activePanel.onDeActive())}var b=this.widgetManager.activeWidget;b&&"active"===b.state&&b.getPanel()!==a&&(b.setState("opened"),!1===b.inPanel&&q.setStyle(b.domNode,"zIndex","undefined"!==
typeof b.position.zIndex?b.position.zIndex:"auto"),b.onDeActive(),this.widgetManager.activeWidget=null);this.activePanel=a;"active"!==this.activePanel.state&&(this.activePanel.setState("active"),this.activePanel.moveTopOnActive&&q.setStyle(this.activePanel.domNode,"zIndex",101),this.activePanel.onActive())},_removePanel:function(a){var b=this.panels.indexOf(a);-1<b&&this.panels.splice(b,1);this.activePanel&&this.activePanel.id===a.id&&(this.activePanel=null)},_onMoveStart:function(a){p.forEach(this.panels,
function(b){b.domNode===a.node&&this._activePanel(b)},this)},_onWidgetActived:function(a){this.activePanel&&"active"===this.activePanel.state&&a.getPanel()!==this.activePanel&&(this.activePanel.setState("opened"),q.setStyle(this.activePanel.domNode,"zIndex","undefined"!==typeof this.activePanel.position.zIndex?this.activePanel.position.zIndex:"auto"),this.activePanel.onDeActive(),this.activePanel=null)},_loadPanelClass:function(b){var c=new l;a([b],function(a){c.resolve(a)});return c},_loadThemeI18N:function(b){var c=
new l;b.startWith("themes")?(b=b.split("/"),a(["dojo/i18n!"+(b[0]+"/"+b[1]+"/nls/strings")],function(a){c.resolve(a)})):c.resolve({});return c}});u.getInstance=function(){null===m&&(m=new u,window._panelManager=m);return m};return u})},"url:esri/core/request/iframe.html":'\x3c!DOCTYPE html\x3e\r\n\x3chtml\x3e\r\n\x3chead\x3e\r\n  \x3cmeta http-equiv\x3d"Content-Security-Policy" content\x3d"default-src \'none\'; script-src * \'unsafe-inline\'"\x3e\r\n\r\n  \x3cscript\x3e\r\n    var dojoConfig \x3d {\r\n      async: true,\r\n      baseUrl: "../../../dojo/",\r\n      has: {\r\n        "csp-restrictions": true,\r\n        "dojo-preload-i18n-Api": false\r\n      }\r\n    };\r\n  \x3c/script\x3e\r\n  \x3c!--\r\n  This src is relative to this page and assumes dojo is a sibling to esri.\r\n  It is updated when this file is set as the iframe\'s `srcdoc` value.\r\n  --\x3e\r\n  \x3cscript src\x3d"../../../dojo/dojo.js"\x3e\x3c/script\x3e\r\n\r\n  \x3cscript\x3e\r\n    function windowMessageHandler(event) {\r\n      window.removeEventListener("message", windowMessageHandler);\r\n\r\n      var port \x3d event.ports[0];\r\n\r\n      require([\r\n        "dojo/request/script"\r\n      ], function(script) {\r\n        port.postMessage("ready");\r\n\r\n        port.addEventListener("message", function(event) {\r\n          var data \x3d event.data;\r\n          script.get(data.url, data.options)\r\n              .then(function(response) {\r\n                port.postMessage({\r\n                  id: data.id,\r\n                  response: response\r\n                });\r\n              })\r\n              .otherwise(function(error) {\r\n                port.postMessage({\r\n                  id: data.id,\r\n                  isError: true,\r\n                  message: error.message\r\n                });\r\n              });\r\n        });\r\n        port.start();\r\n      });\r\n    }\r\n\r\n    window.addEventListener("message", windowMessageHandler);\r\n  \x3c/script\x3e\r\n\x3c/head\x3e\r\n\x3cbody\x3e\r\n\x3c/body\x3e\r\n\x3c/html\x3e\r\n',
"url:dijit/templates/Dialog.html":'\x3cdiv class\x3d"dijitDialog" role\x3d"dialog" aria-labelledby\x3d"${id}_title"\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"titleBar" class\x3d"dijitDialogTitleBar"\x3e\r\n\t\t\x3cspan data-dojo-attach-point\x3d"titleNode" class\x3d"dijitDialogTitle" id\x3d"${id}_title"\r\n\t\t\t\trole\x3d"heading" level\x3d"1"\x3e\x3c/span\x3e\r\n\t\t\x3cspan data-dojo-attach-point\x3d"closeButtonNode" class\x3d"dijitDialogCloseIcon" data-dojo-attach-event\x3d"ondijitclick: onCancel" title\x3d"${buttonCancel}" role\x3d"button" tabindex\x3d"-1"\x3e\r\n\t\t\t\x3cspan data-dojo-attach-point\x3d"closeText" class\x3d"closeText" title\x3d"${buttonCancel}"\x3ex\x3c/span\x3e\r\n\t\t\x3c/span\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"containerNode" class\x3d"dijitDialogPaneContent"\x3e\x3c/div\x3e\r\n\t${!actionBarTemplate}\r\n\x3c/div\x3e\r\n\r\n',
"url:dijit/form/templates/Button.html":'\x3cspan class\x3d"dijit dijitReset dijitInline" role\x3d"presentation"\r\n\t\x3e\x3cspan class\x3d"dijitReset dijitInline dijitButtonNode"\r\n\t\tdata-dojo-attach-event\x3d"ondijitclick:__onClick" role\x3d"presentation"\r\n\t\t\x3e\x3cspan class\x3d"dijitReset dijitStretch dijitButtonContents"\r\n\t\t\tdata-dojo-attach-point\x3d"titleNode,focusNode"\r\n\t\t\trole\x3d"button" aria-labelledby\x3d"${id}_label"\r\n\t\t\t\x3e\x3cspan class\x3d"dijitReset dijitInline dijitIcon" data-dojo-attach-point\x3d"iconNode"\x3e\x3c/span\r\n\t\t\t\x3e\x3cspan class\x3d"dijitReset dijitToggleButtonIconChar"\x3e\x26#x25CF;\x3c/span\r\n\t\t\t\x3e\x3cspan class\x3d"dijitReset dijitInline dijitButtonText"\r\n\t\t\t\tid\x3d"${id}_label"\r\n\t\t\t\tdata-dojo-attach-point\x3d"containerNode"\r\n\t\t\t\x3e\x3c/span\r\n\t\t\x3e\x3c/span\r\n\t\x3e\x3c/span\r\n\t\x3e\x3cinput ${!nameAttrSetting} type\x3d"${type}" value\x3d"${value}" class\x3d"dijitOffScreen"\r\n\t\tdata-dojo-attach-event\x3d"onclick:_onClick"\r\n\t\ttabIndex\x3d"-1" aria-hidden\x3d"true" data-dojo-attach-point\x3d"valueNode"\r\n/\x3e\x3c/span\x3e\r\n',
"url:dijit/form/templates/TextBox.html":'\x3cdiv class\x3d"dijit dijitReset dijitInline dijitLeft" id\x3d"widget_${id}" role\x3d"presentation"\r\n\t\x3e\x3cdiv class\x3d"dijitReset dijitInputField dijitInputContainer"\r\n\t\t\x3e\x3cinput class\x3d"dijitReset dijitInputInner" data-dojo-attach-point\x3d\'textbox,focusNode\' autocomplete\x3d"off"\r\n\t\t\t${!nameAttrSetting} type\x3d\'${type}\'\r\n\t/\x3e\x3c/div\r\n\x3e\x3c/div\x3e\r\n',"url:dijit/templates/Tooltip.html":'\x3cdiv class\x3d"dijitTooltip dijitTooltipLeft" id\x3d"dojoTooltip" data-dojo-attach-event\x3d"mouseenter:onMouseEnter,mouseleave:onMouseLeave"\r\n\t\x3e\x3cdiv class\x3d"dijitTooltipConnector" data-dojo-attach-point\x3d"connectorNode"\x3e\x3c/div\r\n\t\x3e\x3cdiv class\x3d"dijitTooltipContainer dijitTooltipContents" data-dojo-attach-point\x3d"containerNode" role\x3d\'alert\'\x3e\x3c/div\r\n\x3e\x3c/div\x3e\r\n',
"url:dijit/form/templates/ValidationTextBox.html":'\x3cdiv class\x3d"dijit dijitReset dijitInline dijitLeft"\r\n\tid\x3d"widget_${id}" role\x3d"presentation"\r\n\t\x3e\x3cdiv class\x3d\'dijitReset dijitValidationContainer\'\r\n\t\t\x3e\x3cinput class\x3d"dijitReset dijitInputField dijitValidationIcon dijitValidationInner" value\x3d"\x26#935; " type\x3d"text" tabIndex\x3d"-1" readonly\x3d"readonly" role\x3d"presentation"\r\n\t/\x3e\x3c/div\r\n\t\x3e\x3cdiv class\x3d"dijitReset dijitInputField dijitInputContainer"\r\n\t\t\x3e\x3cinput class\x3d"dijitReset dijitInputInner" data-dojo-attach-point\x3d\'textbox,focusNode\' autocomplete\x3d"off"\r\n\t\t\t${!nameAttrSetting} type\x3d\'${type}\'\r\n\t/\x3e\x3c/div\r\n\x3e\x3c/div\x3e\r\n',
"url:builder/plugins/plugins.json":'{\n  "app-actions.launch-app": {\n    "name": "app-actions.launch-app",\n    "type": "plugin",\n    "version": "2.0.1",\n    "author": "Esri R\x26D Center Beijing",\n    "description": "",\n    "copyright": "",\n    "license": "",\n    "extensions": [\n      {\n        "point": "app-config.main-app-actions",\n        "description": "",\n        "parameters": {\n          "supportAppTypes": "all",\n          "index": 1\n        },\n        "pluginName": "app-actions.launch-app"\n      }\n    ],\n    "properties": {\n      "hasUIFile": false,\n      "hasClass": true,\n      "hasLocale": true,\n      "hasStyle": true\n    }\n  },\n  "app-actions.preview-app": {\n    "name": "app-actions.preview-app",\n    "type": "plugin",\n    "version": "2.0.1",\n    "author": "Esri R\x26D Center Beijing",\n    "description": "",\n    "copyright": "",\n    "license": "",\n    "extensions": [\n      {\n        "point": "app-config.main-app-actions",\n        "description": "",\n        "parameters": {\n          "supportAppTypes": "HTML",\n          "index": 2\n        },\n        "pluginName": "app-actions.preview-app"\n      }\n    ],\n    "properties": {\n      "hasClass": true,\n      "hasLocale": true,\n      "hasStyle": true,\n      "hasUIFile": true\n    }\n  },\n  "app-actions.save-app": {\n    "name": "app-actions.save-app",\n    "type": "plugin",\n    "version": "2.0.1",\n    "author": "Esri R\x26D Center Beijing",\n    "description": "",\n    "copyright": "",\n    "license": "",\n    "extensions": [\n      {\n        "point": "app-config.main-app-actions",\n        "description": "",\n        "parameters": {\n          "supportAppTypes": "all",\n          "index": 3\n        },\n        "pluginName": "app-actions.save-app"\n      },\n      {\n        "point": "app-config.popup-app-actions",\n        "description": "",\n        "parameters": {\n          "supportAppTypes": "all",\n          "onClickAction": "_onClick",\n          "index": 1\n        },\n        "pluginName": "app-actions.save-app"\n      }\n    ],\n    "properties": {\n      "hasClass": true,\n      "hasLocale": true,\n      "hasStyle": true,\n      "hasUIFile": true\n    }\n  },\n  "app-actions.to-template-config": {\n    "name": "app-actions.to-template-config",\n    "type": "plugin",\n    "version": "2.0.1",\n    "author": "Esri R\x26D Center Beijing",\n    "description": "",\n    "copyright": "",\n    "license": "",\n    "extensions": [\n      {\n        "point": "app-config.main-app-actions",\n        "description": "",\n        "parameters": {\n          "supportAppTypes": "all",\n          "index": 1\n        },\n        "pluginName": "app-actions.to-template-config"\n      }\n    ],\n    "properties": {\n      "hasUIFile": false,\n      "hasClass": true,\n      "hasLocale": true,\n      "hasStyle": true\n    }\n  },\n  "app-config": {\n    "name": "app-config",\n    "type": "plugin",\n    "version": "2.0.1",\n    "author": "Esri R\x26D Center Beijing",\n    "description": "the first plugin that builder loads.",\n    "copyright": "",\n    "license": "",\n    "extensionPoints": {\n      "config-template": {\n        "description": "Config template",\n        "parameters": {\n          "supportAppTypes": {\n            "type": "string",\n            "required": true,\n            "name": "supportAppTypes"\n          }\n        },\n        "id": "app-config.config-template",\n        "name": "config-template",\n        "extensions": [\n          {\n            "point": "app-config.config-template",\n            "description": "",\n            "parameters": {\n              "supportAppTypes": "all"\n            },\n            "pluginName": "app-config-templateconfig"\n          }\n        ]\n      },\n      "config-part": {\n        "description": "The config part",\n        "parameters": {\n          "supportAppTypes": {\n            "type": "string",\n            "required": true,\n            "name": "supportAppTypes"\n          }\n        },\n        "id": "app-config.config-part",\n        "name": "config-part",\n        "extensions": [\n          {\n            "point": "app-config.config-part",\n            "description": "",\n            "parameters": {\n              "supportAppTypes": "all"\n            },\n            "pluginName": "app-config-configpart"\n          }\n        ]\n      },\n      "morepreview-selction-part": {\n        "description": "The more preview selection part",\n        "parameters": {\n          "supportAppTypes": {\n            "type": "string",\n            "required": true,\n            "name": "supportAppTypes"\n          }\n        },\n        "id": "app-config.morepreview-selction-part",\n        "name": "morepreview-selction-part",\n        "extensions": [\n          {\n            "point": "app-config.morepreview-selction-part",\n            "description": "",\n            "parameters": {\n              "supportAppTypes": "all"\n            },\n            "pluginName": "app-config-morepreview-selectionpart"\n          }\n        ]\n      },\n      "template-config-part": {\n        "description": "The Template config part",\n        "parameters": {\n          "supportAppTypes": {\n            "type": "string",\n            "required": true,\n            "name": "supportAppTypes"\n          }\n        },\n        "id": "app-config.template-config-part",\n        "name": "template-config-part",\n        "extensions": [\n          {\n            "point": "app-config.template-config-part",\n            "description": "",\n            "parameters": {\n              "supportAppTypes": "all"\n            },\n            "pluginName": "app-config-template-configpart"\n          }\n        ]\n      },\n      "main-app-actions": {\n        "parameters": {\n          "supportAppTypes": {\n            "type": "string",\n            "required": true,\n            "name": "supportAppTypes"\n          },\n          "index": {\n            "type": "number",\n            "required": true,\n            "description": "1 based index.",\n            "name": "index"\n          }\n        },\n        "id": "app-config.main-app-actions",\n        "name": "main-app-actions",\n        "extensions": [\n          {\n            "point": "app-config.main-app-actions",\n            "description": "",\n            "parameters": {\n              "supportAppTypes": "all",\n              "index": 1\n            },\n            "pluginName": "app-actions.launch-app"\n          },\n          {\n            "point": "app-config.main-app-actions",\n            "description": "",\n            "parameters": {\n              "supportAppTypes": "HTML",\n              "index": 2\n            },\n            "pluginName": "app-actions.preview-app"\n          },\n          {\n            "point": "app-config.main-app-actions",\n            "description": "",\n            "parameters": {\n              "supportAppTypes": "all",\n              "index": 3\n            },\n            "pluginName": "app-actions.save-app"\n          },\n          {\n            "point": "app-config.main-app-actions",\n            "description": "",\n            "parameters": {\n              "supportAppTypes": "all",\n              "index": 1\n            },\n            "pluginName": "app-actions.to-template-config"\n          }\n        ]\n      },\n      "popup-app-actions": {\n        "parameters": {\n          "onClickAction": {\n            "type": "function",\n            "name": "onClickAction"\n          },\n          "supportAppTypes": {\n            "type": "string",\n            "required": true,\n            "name": "supportAppTypes"\n          },\n          "index": {\n            "type": "number",\n            "required": true,\n            "description": "1 based index.",\n            "name": "index"\n          }\n        },\n        "id": "app-config.popup-app-actions",\n        "name": "popup-app-actions",\n        "extensions": [\n          {\n            "point": "app-config.popup-app-actions",\n            "description": "",\n            "parameters": {\n              "supportAppTypes": "all",\n              "onClickAction": "_onClick",\n              "index": 1\n            },\n            "pluginName": "app-actions.save-app"\n          },\n          {\n            "point": "app-config.popup-app-actions",\n            "description": "",\n            "parameters": {\n              "supportAppTypes": "all",\n              "onClickAction": "onClick",\n              "index": 4\n            },\n            "pluginName": "popup-actions.configmode-switch"\n          },\n          {\n            "point": "app-config.popup-app-actions",\n            "description": "",\n            "parameters": {\n              "supportAppTypes": "all",\n              "onClickAction": "onClick",\n              "index": 3\n            },\n            "pluginName": "popup-actions.popup-agoltemplate"\n          },\n          {\n            "point": "app-config.popup-app-actions",\n            "description": "",\n            "parameters": {\n              "supportAppTypes": "all",\n              "onClickAction": "onClick",\n              "index": 2\n            },\n            "pluginName": "popup-actions.popup-saveas"\n          }\n        ]\n      }\n    },\n    "extensions": [\n      {\n        "point": "startup.app-config",\n        "description": "",\n        "parameters": {\n          "supportAppTypes": "all"\n        },\n        "pluginName": "app-config"\n      }\n    ],\n    "properties": {\n      "hasLocale": false,\n      "hasClass": true,\n      "hasStyle": true,\n      "hasUIFile": true\n    }\n  },\n  "app-config-configpart": {\n    "name": "app-config-configpart",\n    "type": "plugin",\n    "version": "2.0.1",\n    "author": "Esri R\x26D Center Beijing",\n    "description": "the config part of the config page.",\n    "copyright": "",\n    "license": "",\n    "extensionPoints": {\n      "config-sections": {\n        "description": "The config page for section of full config",\n        "parameters": {\n          "label": {\n            "type": "string",\n            "required": true,\n            "name": "label"\n          },\n          "icon": {\n            "type": "url",\n            "required": true,\n            "name": "icon"\n          },\n          "selectedIcon": {\n            "type": "url",\n            "required": true,\n            "name": "selectedIcon"\n          },\n          "supportAppTypes": {\n            "type": "string",\n            "required": true,\n            "name": "supportAppTypes"\n          },\n          "republishEvents": {\n            "type": "string",\n            "required": true,\n            "description": "The events that change app config. These events will be pushed to preview window",\n            "name": "republishEvents"\n          },\n          "index": {\n            "type": "number",\n            "required": true,\n            "description": "1 based index.",\n            "name": "index"\n          }\n        },\n        "id": "app-config-configpart.config-sections",\n        "name": "config-sections",\n        "extensions": [\n          {\n            "point": "app-config-configpart.config-sections",\n            "description": "",\n            "parameters": {\n              "supportAppTypes": "all",\n              "label": "${_paramLabel}",\n              "icon": "images/icon.svg",\n              "selectedIcon": "images/selected_icon.svg",\n              "republishEvents": "appAttributeChanged,loadingPageChanged,actionTriggered,appProxyForMapChanged,appProxyForUrlChanged",\n              "index": 4\n            },\n            "pluginName": "attribute-config"\n          },\n          {\n            "point": "app-config-configpart.config-sections",\n            "description": "",\n            "parameters": {\n              "supportAppTypes": "all",\n              "label": "${_paramLabel}",\n              "icon": "images/icon.svg",\n              "selectedIcon": "images/selected_icon.svg",\n              "republishEvents": "setAppConfig,mapChanged,mapOptionsChanged,sceneViewChanged,dataSourceChanged,mapRefreshIntervalChanged",\n              "index": 2\n            },\n            "pluginName": "map-config"\n          },\n          {\n            "point": "app-config-configpart.config-sections",\n            "description": "",\n            "parameters": {\n              "supportAppTypes": "all",\n              "label": "${_paramLabel}",\n              "icon": "images/icon.svg",\n              "selectedIcon": "images/selected_icon.svg",\n              "republishEvents": "themeChanged,styleChanged,layoutChanged,sharedThemeChanged,layoutDefinitionChanged",\n              "index": 1\n            },\n            "pluginName": "theme-config"\n          },\n          {\n            "point": "app-config-configpart.config-sections",\n            "description": "",\n            "parameters": {\n              "supportAppTypes": "all",\n              "label": "${_paramLabel}",\n              "icon": "images/icon.svg",\n              "selectedIcon": "images/selected_icon.svg",\n              "republishEvents": "widgetChanged,widgetPoolChanged,openAtStartChange,actionTriggered,groupChanged,onScreenGroupsChanged",\n              "index": 3\n            },\n            "pluginName": "widget-config"\n          }\n        ]\n      }\n    },\n    "extensions": [\n      {\n        "point": "app-config.config-part",\n        "description": "",\n        "parameters": {\n          "supportAppTypes": "all"\n        },\n        "pluginName": "app-config-configpart"\n      }\n    ],\n    "properties": {\n      "hasClass": true,\n      "hasLocale": true,\n      "hasStyle": true,\n      "hasUIFile": true\n    }\n  },\n  "app-config-morepreview-selectionpart": {\n    "name": "app-config-morepreview-selectionpart",\n    "type": "plugin",\n    "version": "2.0.1",\n    "author": "Esri R\x26D Center Beijing",\n    "description": "the config part of the config page.",\n    "copyright": "",\n    "license": "",\n    "extensionPoints": {},\n    "extensions": [\n      {\n        "point": "app-config.morepreview-selction-part",\n        "description": "",\n        "parameters": {\n          "supportAppTypes": "all"\n        },\n        "pluginName": "app-config-morepreview-selectionpart"\n      }\n    ],\n    "properties": {\n      "hasClass": true,\n      "hasLocale": true,\n      "hasStyle": true,\n      "hasUIFile": true\n    }\n  },\n  "app-config-template-configpart": {\n    "name": "app-config-template-configpart",\n    "type": "plugin",\n    "version": "2.0.1",\n    "author": "Esri R\x26D Center Beijing",\n    "description": "the template config part.",\n    "copyright": "",\n    "license": "",\n    "extensionPoints": {},\n    "extensions": [\n      {\n        "point": "app-config.template-config-part",\n        "description": "",\n        "parameters": {\n          "supportAppTypes": "all"\n        },\n        "pluginName": "app-config-template-configpart"\n      }\n    ],\n    "properties": {\n      "hasClass": true,\n      "hasLocale": true,\n      "hasStyle": true,\n      "hasUIFile": true\n    }\n  },\n  "app-config-templateconfig": {\n    "name": "app-config-templateconfig",\n    "type": "plugin",\n    "version": "2.0.1",\n    "author": "Esri R\x26D Center Beijing",\n    "description": "the first plugin that builder loads.",\n    "copyright": "",\n    "license": "",\n    "extensionPoints": {},\n    "extensions": [\n      {\n        "point": "app-config.config-template",\n        "description": "",\n        "parameters": {\n          "supportAppTypes": "all"\n        },\n        "pluginName": "app-config-templateconfig"\n      }\n    ],\n    "properties": {\n      "hasClass": true,\n      "hasLocale": true,\n      "hasStyle": true,\n      "hasUIFile": true\n    }\n  },\n  "app-list": {\n    "name": "app-list",\n    "type": "plugin",\n    "version": "2.0.1",\n    "author": "Esri R\x26D Center Beijing",\n    "description": "the first plugin that builder loads.",\n    "copyright": "",\n    "license": "",\n    "extensionPoints": {},\n    "extensions": [\n      {\n        "point": "startup.app-list",\n        "description": "",\n        "pluginName": "app-list"\n      }\n    ],\n    "properties": {\n      "hasClass": true,\n      "hasLocale": true,\n      "hasStyle": true,\n      "hasUIFile": true\n    }\n  },\n  "attribute-config": {\n    "name": "attribute-config",\n    "type": "plugin",\n    "version": "2.0.1",\n    "author": "Esri R\x26D Center Beijing",\n    "description": "",\n    "copyright": "",\n    "license": "",\n    "extensions": [\n      {\n        "point": "app-config-configpart.config-sections",\n        "description": "",\n        "parameters": {\n          "supportAppTypes": "all",\n          "label": "${_paramLabel}",\n          "icon": "images/icon.svg",\n          "selectedIcon": "images/selected_icon.svg",\n          "republishEvents": "appAttributeChanged,loadingPageChanged,actionTriggered,appProxyForMapChanged,appProxyForUrlChanged",\n          "index": 4\n        },\n        "pluginName": "attribute-config"\n      }\n    ],\n    "properties": {\n      "hasClass": true,\n      "hasLocale": true,\n      "hasStyle": true,\n      "hasUIFile": true\n    }\n  },\n  "creation-entry": {\n    "name": "creation-entry",\n    "type": "plugin",\n    "version": "2.0.1",\n    "author": "Esri R\x26D Center Beijing",\n    "description": "the first plugin that builder loads.",\n    "copyright": "",\n    "license": "",\n    "extensions": [\n      {\n        "point": "startup.creation-entry",\n        "description": "",\n        "pluginName": "creation-entry"\n      }\n    ],\n    "properties": {\n      "hasClass": true,\n      "hasLocale": true,\n      "hasStyle": true,\n      "hasUIFile": true\n    }\n  },\n  "header": {\n    "name": "header",\n    "type": "plugin",\n    "version": "2.0.1",\n    "author": "Esri R\x26D Center Beijing",\n    "description": "the first plugin that builder loads.",\n    "copyright": "",\n    "license": "",\n    "extensions": [\n      {\n        "point": "startup.header",\n        "description": "",\n        "pluginName": "header"\n      }\n    ],\n    "properties": {\n      "hasClass": true,\n      "hasLocale": true,\n      "hasStyle": true,\n      "hasUIFile": true\n    }\n  },\n  "map-config": {\n    "name": "map-config",\n    "type": "plugin",\n    "version": "2.0.1",\n    "author": "Esri R\x26D Center Beijing",\n    "description": "",\n    "copyright": "",\n    "license": "",\n    "extensions": [\n      {\n        "point": "app-config-configpart.config-sections",\n        "description": "",\n        "parameters": {\n          "supportAppTypes": "all",\n          "label": "${_paramLabel}",\n          "icon": "images/icon.svg",\n          "selectedIcon": "images/selected_icon.svg",\n          "republishEvents": "setAppConfig,mapChanged,mapOptionsChanged,sceneViewChanged,dataSourceChanged,mapRefreshIntervalChanged",\n          "index": 2\n        },\n        "pluginName": "map-config"\n      }\n    ],\n    "properties": {\n      "hasClass": true,\n      "hasLocale": true,\n      "hasStyle": true,\n      "hasUIFile": true\n    }\n  },\n  "popup-actions.configmode-switch": {\n    "name": "popup-actions.configmode-switch",\n    "type": "plugin",\n    "version": "2.0.1",\n    "author": "Esri R\x26D Center Beijing",\n    "description": "",\n    "copyright": "",\n    "license": "",\n    "extensions": [\n      {\n        "point": "app-config.popup-app-actions",\n        "description": "",\n        "parameters": {\n          "supportAppTypes": "all",\n          "onClickAction": "onClick",\n          "index": 4\n        },\n        "pluginName": "popup-actions.configmode-switch"\n      }\n    ],\n    "properties": {\n      "hasClass": true,\n      "hasLocale": true,\n      "hasStyle": false,\n      "hasUIFile": false\n    }\n  },\n  "popup-actions.popup-agoltemplate": {\n    "name": "popup-actions.popup-agoltemplate",\n    "type": "plugin",\n    "version": "2.0.1",\n    "author": "Esri R\x26D Center Beijing",\n    "description": "",\n    "copyright": "",\n    "license": "",\n    "extensions": [\n      {\n        "point": "app-config.popup-app-actions",\n        "description": "",\n        "parameters": {\n          "supportAppTypes": "all",\n          "onClickAction": "onClick",\n          "index": 3\n        },\n        "pluginName": "popup-actions.popup-agoltemplate"\n      }\n    ],\n    "properties": {\n      "hasClass": true,\n      "hasLocale": true,\n      "hasStyle": true,\n      "hasUIFile": false\n    }\n  },\n  "popup-actions.popup-saveas": {\n    "name": "popup-actions.popup-saveas",\n    "type": "plugin",\n    "version": "2.0.1",\n    "author": "Esri R\x26D Center Beijing",\n    "description": "",\n    "copyright": "",\n    "license": "",\n    "extensions": [\n      {\n        "point": "app-config.popup-app-actions",\n        "description": "",\n        "parameters": {\n          "supportAppTypes": "all",\n          "onClickAction": "onClick",\n          "index": 2\n        },\n        "pluginName": "popup-actions.popup-saveas"\n      }\n    ],\n    "properties": {\n      "hasClass": true,\n      "hasLocale": true,\n      "hasStyle": false,\n      "hasUIFile": false\n    }\n  },\n  "popup-actions.popup-share": {\n    "name": "popup-actions.popup-share",\n    "type": "plugin",\n    "version": "2.0.1",\n    "author": "Esri R\x26D Center Beijing",\n    "description": "",\n    "copyright": "",\n    "license": "",\n    "extensions": [\n      {\n        "point": "",\n        "description": "",\n        "parameters": {\n          "supportAppTypes": "all",\n          "onClickAction": "onClick",\n          "index": 1,\n          "republishEvents": "SharePluginOnClickEveryone"\n        },\n        "pluginName": "popup-actions.popup-share"\n      }\n    ],\n    "properties": {\n      "hasClass": true,\n      "hasLocale": false,\n      "hasStyle": false,\n      "hasUIFile": false\n    }\n  },\n  "startup": {\n    "name": "startup",\n    "type": "plugin",\n    "version": "2.0.1",\n    "author": "Esri R\x26D Center Beijing",\n    "description": "the first plugin that builder loads.",\n    "copyright": "",\n    "license": "",\n    "extensionPoints": {\n      "app-list": {\n        "description": "the app list page.",\n        "id": "startup.app-list",\n        "name": "app-list",\n        "extensions": [\n          {\n            "point": "startup.app-list",\n            "description": "",\n            "pluginName": "app-list"\n          }\n        ]\n      },\n      "header": {\n        "description": "the header.",\n        "id": "startup.header",\n        "name": "header",\n        "extensions": [\n          {\n            "point": "startup.header",\n            "description": "",\n            "pluginName": "header"\n          }\n        ]\n      },\n      "app-config": {\n        "description": "the app config page.",\n        "parameters": {\n          "supportAppTypes": {\n            "type": "string",\n            "required": true,\n            "name": "supportAppTypes"\n          }\n        },\n        "id": "startup.app-config",\n        "name": "app-config",\n        "extensions": [\n          {\n            "point": "startup.app-config",\n            "description": "",\n            "parameters": {\n              "supportAppTypes": "all"\n            },\n            "pluginName": "app-config"\n          }\n        ]\n      },\n      "creation-entry": {\n        "description": "The create new entry point.",\n        "id": "startup.creation-entry",\n        "name": "creation-entry",\n        "extensions": [\n          {\n            "point": "startup.creation-entry",\n            "description": "",\n            "pluginName": "creation-entry"\n          }\n        ]\n      },\n      "stemapps": {\n        "description": "the stemapp.",\n        "parameters": {\n          "appType": {\n            "type": "string",\n            "required": true,\n            "name": "appType"\n          },\n          "appPath": {\n            "type": "string",\n            "description": "By default, it\'s plugin\'s folder path",\n            "name": "appPath"\n          },\n          "appVersionManager": {\n            "type": "string",\n            "description": "path relative to app path. required if app config is old.",\n            "name": "appVersionManager"\n          },\n          "index": {\n            "type": "number",\n            "required": true,\n            "description": "1 based index.",\n            "name": "index"\n          }\n        },\n        "id": "startup.stemapps",\n        "name": "stemapps",\n        "extensions": [\n          {\n            "point": "startup.stemapps",\n            "description": "",\n            "parameters": {\n              "appType": "HTML",\n              "appPath": "../../../../stemapp/",\n              "appVersionManager": "jimu.js/shared/AppVersionManager.js",\n              "index": 1\n            },\n            "pluginName": "stemapps.web2d"\n          },\n          {\n            "point": "startup.stemapps",\n            "description": "",\n            "parameters": {\n              "appType": "HTML3D",\n              "appPath": "../../../../stemapp3d/",\n              "appVersionManager": "jimu.js/shared/AppVersionManager.js",\n              "index": 2\n            },\n            "pluginName": "stemapps.web3d"\n          }\n        ]\n      }\n    },\n    "extensions": [],\n    "properties": {\n      "hasLocale": false,\n      "hasClass": true,\n      "hasStyle": true,\n      "hasUIFile": true\n    }\n  },\n  "stemapps.web2d": {\n    "name": "stemapps.web2d",\n    "type": "plugin",\n    "version": "2.0.1",\n    "author": "Esri R\x26D Center Beijing",\n    "description": "",\n    "copyright": "",\n    "license": "",\n    "extensions": [\n      {\n        "point": "startup.stemapps",\n        "description": "",\n        "parameters": {\n          "appType": "HTML",\n          "appPath": "../../../../stemapp/",\n          "appVersionManager": "jimu.js/shared/AppVersionManager.js",\n          "index": 1\n        },\n        "pluginName": "stemapps.web2d"\n      }\n    ],\n    "properties": {\n      "hasClass": false,\n      "hasLocale": true,\n      "hasStyle": true,\n      "hasUIFile": true\n    }\n  },\n  "stemapps.web3d": {\n    "name": "stemapps.web3d",\n    "type": "plugin",\n    "version": "2.0.1",\n    "author": "Esri R\x26D Center Beijing",\n    "description": "",\n    "copyright": "",\n    "license": "",\n    "extensions": [\n      {\n        "point": "startup.stemapps",\n        "description": "",\n        "parameters": {\n          "appType": "HTML3D",\n          "appPath": "../../../../stemapp3d/",\n          "appVersionManager": "jimu.js/shared/AppVersionManager.js",\n          "index": 2\n        },\n        "pluginName": "stemapps.web3d"\n      }\n    ],\n    "properties": {\n      "hasClass": false,\n      "hasLocale": true,\n      "hasStyle": true,\n      "hasUIFile": true\n    }\n  },\n  "theme-config": {\n    "name": "theme-config",\n    "type": "plugin",\n    "version": "2.0.1",\n    "author": "Esri R\x26D Center Beijing",\n    "description": "",\n    "copyright": "",\n    "license": "",\n    "extensions": [\n      {\n        "point": "app-config-configpart.config-sections",\n        "description": "",\n        "parameters": {\n          "supportAppTypes": "all",\n          "label": "${_paramLabel}",\n          "icon": "images/icon.svg",\n          "selectedIcon": "images/selected_icon.svg",\n          "republishEvents": "themeChanged,styleChanged,layoutChanged,sharedThemeChanged,layoutDefinitionChanged",\n          "index": 1\n        },\n        "pluginName": "theme-config"\n      }\n    ],\n    "properties": {\n      "hasClass": true,\n      "hasLocale": true,\n      "hasStyle": true,\n      "hasUIFile": true\n    }\n  },\n  "widget-config": {\n    "name": "widget-config",\n    "type": "plugin",\n    "version": "2.0.1",\n    "author": "Esri R\x26D Center Beijing",\n    "description": "",\n    "copyright": "",\n    "license": "",\n    "extensions": [\n      {\n        "point": "app-config-configpart.config-sections",\n        "description": "",\n        "parameters": {\n          "supportAppTypes": "all",\n          "label": "${_paramLabel}",\n          "icon": "images/icon.svg",\n          "selectedIcon": "images/selected_icon.svg",\n          "republishEvents": "widgetChanged,widgetPoolChanged,openAtStartChange,actionTriggered,groupChanged,onScreenGroupsChanged",\n          "index": 3\n        },\n        "pluginName": "widget-config"\n      }\n    ],\n    "properties": {\n      "hasClass": true,\n      "hasLocale": true,\n      "hasStyle": true,\n      "hasUIFile": true\n    }\n  }\n}\n',
"url:builder/plugins/app-actions/launch-app/css/style.css":".plugin-app-actions-launch-app{margin-top:3px; height: 47px; line-height: 47px; background-color:#F3F3F3; text-align: center; cursor: default;}.plugin-app-actions-launch-app .footer-button{background-image: url(images/icon.svg); background-position:left center; background-repeat: no-repeat; white-space: nowrap; display: inline-block; padding-left:20px; height: 100%; max-width: 100%; text-overflow: ellipsis; overflow: hidden;}.jimu-rtl .plugin-app-actions-launch-app .footer-button{padding-right:20px; padding-left:0; background-position:right center; cursor: pointer;}.plugin-app-actions-launch-app a{color: inherit; display: block; text-decoration: none; height: 47px;}.plugin-app-actions-launch-app:hover .footer-button{color:#24B5CC; background-image: url(images/hover_icon.svg);}",
"url:builder/plugins/app-actions/preview-app/Plugin.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"footer-button  preview-button" data-dojo-attach-point\x3d"btnPreview" title\x3d${nls.previewMore}\x3e${nls.previewMore}\x3c/div\x3e\r\n  \x3cdiv class\x3d"footer-button  config-button" style\x3d"display:none" data-dojo-attach-point\x3d"btnConfig" title\x3d${nls.back2Configure}\x3e${nls.back2Configure}\x3c/div\x3e\r\n\x3c/div\x3e',"url:builder/plugins/app-actions/preview-app/css/style.css":".plugin-app-actions-preview-app{margin-top:3px; height: 47px; line-height: 47px; background-color:#F3F3F3; text-align: center; cursor: pointer;}.plugin-app-actions-preview-app .footer-button{background-position:left center; background-repeat: no-repeat; white-space: nowrap; display: inline-block; padding-left:20px; height: 100%; max-width: 100%; text-overflow: ellipsis; overflow: hidden;}.jimu-rtl .plugin-app-actions-preview-app .footer-button{padding-right:20px; padding-left:0; background-position:right center; cursor: pointer;}.plugin-app-actions-preview-app:hover .footer-button {color:#24B5CC;}.plugin-app-actions-preview-app .footer-button.preview-button{background-image: url(images/icon.svg);}.plugin-app-actions-preview-app:hover .footer-button.preview-button{background-image: url(images/hover_icon.svg);}.plugin-app-actions-preview-app .footer-button.config-button{background-image: url(images/configure01.svg);}.jimu-rtl .plugin-app-actions-preview-app .footer-button.config-button{background-image: url(images/configure03.svg);}.plugin-app-actions-preview-app:hover .footer-button.config-button{background-image: url(images/configure02.svg);}.jimu-rtl .plugin-app-actions-preview-app:hover .footer-button.config-button{background-image: url(images/configure04.svg);}",
"url:builder/plugins/app-actions/save-app/Plugin.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"footer-button" title\x3d${nls.label} data-dojo-attach-point\x3d"actionNode"\x3e${nls.label}\x3c/div\x3e\r\n\x3c/div\x3e',"url:builder/plugins/app-actions/save-app/css/style.css":".plugin-app-actions-save-app{margin-top:3px; height: 47px; line-height: 47px; background-color:#F3F3F3; text-align: center; cursor: default;}.plugin-app-actions-save-app .footer-button{background-image: url(images/icon.svg); background-position:left center; background-repeat: no-repeat; white-space: nowrap; display: inline-block; padding-left:20px; height: 100%; max-width: 100%; text-overflow: ellipsis; overflow: hidden;}.jimu-rtl .plugin-app-actions-save-app .footer-button{padding-right:20px; padding-left:0; background-position:right center; cursor: pointer;}.plugin-app-actions-save-app:hover .footer-button{color:#24B5CC; background-image: url(images/hover_icon.svg);}.plugin-app-actions-save-app .footer-button.save-enable{background-image:url(images/hover_icon.svg); background-repeat: no-repeat; color: #24B5CC;}.plugin-app-actions-save-app .footer-button.save-block{color: #d2dae2; background-image: url(images/block_icon.png);}",
"url:builder/plugins/app-actions/to-template-config/css/style.css":".plugin-app-actions-to-template-config{margin-top:3px; height: 47px; line-height: 47px; background-color:#F3F3F3; text-align: center; cursor: pointer;}.plugin-app-actions-to-template-config .footer-button{background-image: url(images/icon.png); background-position:left center; background-repeat: no-repeat; white-space: nowrap; display: inline-block; padding-left:20px; height: 100%; max-width: 100%; text-overflow: ellipsis; overflow: hidden;}.jimu-rtl .plugin-app-actions-to-template-config .footer-button{padding-right:20px; padding-left:0; background-position:right center; cursor: pointer;}.plugin-app-actions-to-template-config:hover .footer-button{color:#15a4fa; background-image: url(images/hover_icon.png);}",
"url:jimu/dijit/templates/LoadingShelter.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"loading-container"\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"loadingNode" class\x3d"jimu-loading"\x3e\x3c/div\x3e\r\n      \x3cp data-dojo-attach-point\x3d"textNode"\x3e\x3c/p\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',"url:jimu/dijit/templates/AGOLLoading.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"loading-container"\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"imgDiv" class\x3d"img-div"\x3e\r\n      \x3c/div\x3e\r\n      \x3cp data-dojo-attach-point\x3d"textNode"\x3e\x3c/p\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:builder/plugins/app-config/Plugin.html":'\x3cdiv \x3e\r\n  \x3cdiv class\x3d"at-view-stack" data-dojo-attach-point\x3d"atViewStackNode"\x3e\r\n    \x3cdiv class\x3d"config-app-pane" data-dojo-attach-point\x3d"configAppNode"\x3e\r\n      \x3cdiv class\x3d"left-pane" data-dojo-attach-point\x3d"leftPaneNode"\x3e\r\n        \x3cdiv class\x3d"opts-viewstack" data-dojo-attach-point\x3d"optsViewStackNode"\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"configOptsPaneNode"\x3e\r\n\r\n          \x3c/div\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"morePreviewOptsPaneNode"\x3e\r\n\r\n          \x3c/div\x3e\r\n\r\n          \x3cdiv data-dojo-attach-point\x3d"templateOptsPaneNode"\x3e\r\n\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"actions-pane" data-dojo-attach-point\x3d"actionsPaneNode"\x3e\r\n          \x3cdiv class\x3d"main-action-box" data-dojo-attach-point\x3d"mainActionBoxNode"\x3e\x3c/div\x3e\r\n          \x3cdiv class\x3d"footer-button-arrow jimu-float-leading" data-dojo-attach-point\x3d"btnArrow" data-dojo-attach-event\x3d"onclick: _onBtnArrowClick"\x3e\r\n            \x3cdiv class\x3d"foot-menu" data-dojo-attach-point\x3d"popupActionsMenu"\x3e\r\n            \x3c/div\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n\r\n      \x3cdiv class\x3d"right-preview-section" data-dojo-attach-point\x3d"rightPreviewSection"\x3e\r\n        \x3cdiv class\x3d"preview-config" data-dojo-attach-point\x3d"previewConfig"\x3e\r\n          \x3ciframe name\x3d"previewConfigFrame" data-dojo-attach-point\x3d"previewConfigFrameNode" style\x3d"border:none" allowfullscreen\x3d"true"\x3e\x3c/iframe\x3e\r\n        \x3c/div\x3e\r\n\r\n        \x3cdiv class\x3d"preview-more" data-dojo-attach-point\x3d"previewMore"\x3e\r\n          \x3cdiv class\x3d"preview-more-iframe-section" data-dojo-attach-point\x3d"previewMoreIframeSection"\x3e\r\n            \x3cdiv class\x3d"preview-more-iframe-container" data-dojo-attach-point\x3d"previewMoreContainer"\x3e\r\n              \x3ciframe name\x3d"previewMoreFrame" data-dojo-attach-point\x3d"previewMoreFrameNode" style\x3d"border-color:#cad1d9;" allowfullscreen\x3d"true"\x3e\x3c/iframe\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv class\x3d"description" data-dojo-attach-point\x3d"previewMoreDes"\x3e\x3c/div\x3e\r\n          \x3c/div\x3e\r\n          \x3cdiv class\x3d"screen-switch-section"\x3e\r\n            \x3cdiv class\x3d"portrait jimu-float-leading selected" data-dojo-attach-point\x3d"btnPortrait"\x3e\x3c/div\x3e\r\n            \x3cdiv class\x3d"landscape jimu-float-trailing" data-dojo-attach-point\x3d"btnLandscape"\x3e\x3c/div\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"config-template-pane" data-dojo-attach-point\x3d"configTemplateNode"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:builder/plugins/app-config/css/style.css":".plugin-config-app .at-view-stack{width: 100%; height: 100%; position: relative;}.plugin-config-app .at-view-stack \x3e .view{position: absolute; left: 0; top: 0;}.plugin-config-app .at-view-stack \x3e .view.config-app-pane{display: block !important; visibility: hidden;}.plugin-config-app .at-view-stack \x3e .view.config-template-pane{z-index: 2;}.plugin-config-app .left-pane{font-size: 20px; width: 400px; height: 100%; position: absolute; box-shadow: 0px 0px 8px rgba(0,0,0,0.4); z-index: 2;}.plugin-config-app .left-pane \x3e .jimu-loading-shelter{background-color: rgba(0, 0, 0, 0.5);}.plugin-config-app .left-pane .opts-viewstack{position: absolute; left: 0; right: 0; top: 0; bottom: 50px;}.plugin-config-app .right-preview-section{position: absolute; left: 400px; top: 0; right: 0; height: 100%;}.plugin-config-app .right-preview-section .preview-viewstack{width:100%; height:100%;}.plugin-config-app .preview-config,.plugin-config-app .preview-more{width:100%; height:100%;}.plugin-config-app .preview-config iframe{width: 100%; height: 100%;}.plugin-config-app .preview-more{position:relative; background-color:#f3f3f3; overflow:auto;}.plugin-config-app .preview-more .preview-more-iframe-section .preview-more-iframe-container{margin-left:auto; margin-right:auto; background:#eaecee; padding:20px; border:2px solid #666; -webkit-border-radius:15px; -moz-border-radius:15px; -o-border-radius:15px; -ms-border-radius:15px; border-radius:15px; -webkit-box-shadow:0 0 25px 0 rgba(0, 0, 0, 0.9); -moz-box-shadow:0 0 25px 0 rgba(0, 0, 0, 0.9); -o-box-shadow:0 0 25px 0 rgba(0, 0, 0, 0.9); -ms-box-shadow:0 0 25px 0 rgba(0, 0, 0, 0.9); box-shadow:0 0 25px 0 rgba(0, 0, 0, 0.9);}.plugin-config-app .preview-more .preview-more-iframe-section .preview-more-iframe-container iframe{width:100%; height:100%;}.plugin-config-app .preview-more .description{display:none; text-align:center; font-size:15px; margin-top:20px;}.plugin-config-app .preview-more .screen-switch-section{position:absolute; right:12px; top:12px; height:38px;}.jimu-rtl .plugin-config-app .preview-more .screen-switch-section{right: auto; left: 12px;}.plugin-config-app .preview-more .screen-switch-section div{width:38px; height:100%; background-repeat:no-repeat; background-position:center center; cursor:pointer; background-color:#FFFFFF;}.plugin-config-app .preview-more .screen-switch-section div.selected{background-color:#F7F8F8;}.plugin-config-app .preview-more .screen-switch-section .portrait{border-top-left-radius:3px; border-bottom-left-radius:3px; background-image:url(images/portrait.png);}.plugin-config-app .preview-more .screen-switch-section .landscape{border-top-right-radius:3px; border-bottom-right-radius:3px; background-image:url(images/landscape.png);}.plugin-config-app .preview-more .screen-switch-section .portrait.selected{background-image:url(images/portrait_selected.png);}.plugin-config-app .preview-more .screen-switch-section .landscape.selected{background-image:url(images/landscape_selected.png);}.jimu-rtl .plugin-config-app .right-preview-section{left: 0; right: 400px;}.plugin-config-app .actions-pane{width: 100%; position: absolute; left: 0; right: 0; bottom: 0; height: 52px; background-color:#F3F3F3; font-size:14px;}.plugin-config-app .actions-pane .footer-button-box{height: 47px; font-family: Avenir Medium;}.plugin-config-app .actions-pane .seprate{width:1px; height: 35px; background-image:url(images/seprate.png); background-position: 0 20px; background-repeat:no-repeat;}.plugin-config-app .actions-pane .footer-button-arrow{width: 39px; height: 100%; background-image: url(images/arrow.png); background-position: 17px 25px; background-repeat: no-repeat; position: absolute; left: 360px; cursor: pointer; z-index: 10;}.jimu-rtl .plugin-config-app .actions-pane .footer-button-arrow{right: 360px; left: auto;}.plugin-config-app .actions-pane .footer-button-arrow .foot-menu{display: none; position: absolute; right: 1px; box-shadow: 0 0 4px #646464;}.jimu-rtl .plugin-config-app .actions-pane .footer-button-arrow .foot-menu{left: 1px; right: auto;}.plugin-config-app .actions-pane .footer-button-arrow .foot-menu div{display: block; height: 30px; line-height: 30px; padding-left: 25px; padding-right: 25px; cursor: pointer; white-space: nowrap; font-size: 14px; background-color: #fafafc; text-decoration: none; color: #4d4d4d;}.plugin-config-app .actions-pane .footer-button-arrow .foot-menu div:hover{background-color: #edf2f5; color: #24B5CC;}.plugin-config-app .actions-pane .footer-button-arrow .foot-menu div.disable{color: #d2dae2;}",
"url:builder/plugins/app-config-configpart/TabContainer2.html":'\x3cdiv\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"controlNode"\x3e\r\n    \x3ctable class\x3d"control-table"\x3e\r\n      \x3ctbody\x3e\r\n        \x3ctr data-dojo-attach-point\x3d"tabTr"\x3e\r\n        \x3c/tr\x3e\r\n      \x3c/tbody\x3e\r\n    \x3c/table\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"jimu-viewstack2" data-dojo-attach-point\x3d"containerNode"\x3e\x3c/div\x3e\r\n\x3c/div\x3e',"url:builder/plugins/app-config-configpart/Plugin.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"config-section" data-dojo-attach-point\x3d"configSection"\x3e\r\n    \x3cdiv class\x3d"tabs" data-dojo-attach-point\x3d"tabsNode"\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:builder/plugins/app-config-configpart/css/style.css":'.plugin-appconfig-configpart{font-size: 20px; width: 400px; height: 100%; position: relative; box-shadow: 4px 0px 8px -4px rgba(0,0,0,0.4); z-index: 2;}.plugin-appconfig-configpart .config-section{width:100%; height:100%;}.jimu-tab2 .control-table{width: 100%; table-layout: fixed; background: #5E5E5E; border-collapse: collapse; font-size: 12px; text-align: center; color: #fff;}.jimu-tab2 .tab-item-div{position: relative; width: 100%; height: 80px; cursor: pointer; font-family: "Avenir Medium";}.jimu-tab2 .tab-item-div:hover{color: #fff; background-color: #444;}.jimu-tab2 .selected-tab-item-div{background-color: #24B5CC; background-size: 100% 100%; background-origin: content-box; background-repeat: no-repeat; font-family: "Avenir Medium"; color: #fff;}.jimu-tab2 .selected-tab-item-div:hover{background-color: #24B5CC;}.jimu-tab2 .tab-item-icon{display: inline-block; margin-left: auto; margin-right: auto; margin-top: 20px; margin-bottom: 6px; width: 24px; height: 24px; background-repeat: no-repeat; background-position: center center;}.jimu-tab2 .tab-item-title{width: 99%; margin: auto; white-space: pre-line; overflow: hidden; text-overflow: ellipsis; height: 16px;}.jimu-tab2 .jimu-viewstack2{background-color:#fff; position:absolute; left:0; right:0; top:80px; bottom:0; height:auto;}',
"url:builder/plugins/app-config-morepreview-selectionpart/Plugin.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"preview-section" data-dojo-attach-point\x3d"previewSection"\x3e\r\n    \x3cdiv class\x3d"preview-header"\x3e\r\n      \x3cdiv class\x3d"header-item size-section"\x3e\r\n        \x3ctable class\x3d"size-table"\x3e\r\n          \x3ccolgroup\x3e\r\n            \x3ccol width\x3d"25px"\x3e\x3c/col\x3e\r\n            \x3ccol width\x3d"auto"\x3e\x3c/col\x3e\r\n            \x3ccol width\x3d"10px"\x3e\x3c/col\x3e\r\n            \x3ccol width\x3d"86px"\x3e\x3c/col\x3e\r\n            \x3ccol width\x3d"20px"\x3e\x3c/col\x3e\r\n            \x3ccol width\x3d"auto"\x3e\x3c/col\x3e\r\n            \x3ccol width\x3d"10px"\x3e\x3c/col\x3e\r\n            \x3ccol width\x3d"86px"\x3e\x3c/col\x3e\r\n            \x3ccol width\x3d"25px"\x3e\x3c/col\x3e\r\n          \x3c/colgroup\x3e\r\n          \x3ctbody\x3e\r\n            \x3ctr\x3e\r\n              \x3ctd\x3e\x3c/td\x3e\r\n              \x3ctd\x3e\r\n                \x3cdiv class\x3d"width-tip jimu-ellipsis" title\x3d"${nls.width}"\x3e${nls.width}\x3c/div\x3e\r\n              \x3c/td\x3e\r\n              \x3ctd\x3e\x3c/td\x3e\r\n              \x3ctd\x3e\r\n                \x3cdiv class\x3d"pixel-div"\x3e\r\n                  \x3cinput class\x3d"jimu-float-leading" type\x3d"text" value\x3d"1024" data-dojo-attach-point\x3d"customWidth" /\x3e\r\n                  \x3cdiv class\x3d"jimu-float-leading pixel"\x3e Px \x3c/div\x3e\r\n                \x3c/div\x3e\r\n              \x3c/td\x3e\r\n              \x3ctd\x3e\x3c/td\x3e\r\n              \x3ctd\x3e\r\n                \x3cdiv class\x3d"height-tip jimu-ellipsis" title\x3d"${nls.height}"\x3e${nls.height}\x3c/div\x3e\r\n              \x3c/td\x3e\r\n              \x3ctd\x3e\x3c/td\x3e\r\n              \x3ctd\x3e\r\n                \x3cdiv class\x3d"pixel-div"\x3e\r\n                  \x3cinput class\x3d"jimu-float-leading" type\x3d"text" value\x3d"768"  data-dojo-attach-point\x3d"customHeight" /\x3e\r\n                  \x3cdiv class\x3d"jimu-float-leading pixel"\x3e Px \x3c/div\x3e\r\n                \x3c/div\x3e\r\n              \x3c/td\x3e\r\n              \x3ctd\x3e\x3c/td\x3e\r\n            \x3c/tr\x3e\r\n          \x3c/tbody\x3e\r\n        \x3c/table\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"preview-body"\x3e\r\n      \x3cdiv class\x3d"preview-items-section"\x3e\r\n        \x3ctable\x3e\r\n          \x3ctbody data-dojo-attach-point\x3d"previewTbody"\x3e\r\n          \x3c/tbody\x3e\r\n        \x3c/table\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"preview-qrcode-section" \x3e\r\n        \x3cdiv class\x3d"qrcode-image jimu-float-leading" data-dojo-attach-point\x3d"qrcodeImage"\x3e\x3c/div\x3e\r\n        \x3cdiv class\x3d"qrcode-description jimu-float-leading" data-dojo-attach-point\x3d"qrcodeDescription"\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:builder/plugins/app-config-morepreview-selectionpart/css/style.css":".left-pane .plugin-appconfig-morepreview-selectionpart .preview-section{position:relative; width:100%; height:100%;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .preview-header{position: relative; width: 100%; height: 52px; background-color: #24B5CC;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .preview-header .header-item{position:absolute; top: 0; margin: auto; bottom:0;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .preview-header .size-section{width:100%; height: 32px; color:#444444;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .size-table{width: 100%; table-layout: fixed; border-collapse: collapse;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .size-table td *{height: 32px; line-height: 32px; text-align: center; font-size: 14px; color: #fff;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .size-table .width-tip{width: 100%;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .size-table .pixel-div{width: 110px; overflow: hidden;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .size-table .pixel-div input{width: 54px; color: #444444; border-style: none;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .size-table .pixel-div .pixel{width: 32px; text-align: center; margin: 0; color: white; background-color: #d2dae2;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .preview-body{position:absolute; width:100%; top: 52px; bottom:0; background-color: white;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .preview-body .operation-tip{font-size:14px; margin-left:22px; margin-top:28px;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .preview-body .preview-items-section{position:absolute; left:0; right:0; top:0; bottom:120px; overflow-x:hidden; overflow-y:auto;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .preview-qrcode-section{position: absolute; left: 2px; right: 2px; bottom: 0; height: 116px; border-top: 1px solid; border-color: #e3ecf2;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .preview-qrcode-section .qrcode-image{margin: 20px;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .preview-qrcode-section .qrcode-description{width: 277px; height: 100%; padding-top: 25px; font-size: 14px;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .preview-body .preview-items-section{padding-top: 10px;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .preview-body .preview-items-section table{width:370px; table-layout:fixed; margin-left: auto; margin-right: auto;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .preview-body .preview-items-section td{vertical-align:top; padding-top: 10px;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .preview-body .preview-items-section td .preview-item{margin-left: auto; margin-right: auto; width:74px;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .preview-body .preview-items-section td .preview-item-bg{position:relative; width:100%; height:74px; cursor:pointer; border:1px solid #ccc;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .preview-body .preview-items-section td .preview-item-bg.selected{border:3px solid #24B5CC;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .preview-body .preview-items-section td .preview-item-thumbnail{position:absolute; left:0; top:0; width:100%; height:100%; background-repeat:no-repeat; background-position:center center;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .preview-body .preview-items-section td .preview-selected-icon{display:none; position:absolute; left:41px; top:42px; width:30px; height:26px; background-color:rgba(0, 0, 0, 0.4); background-repeat:no-repeat; background-position:center center; background-image:url(images/check.png); -webkit-border-radius:3px; -moz-border-radius:3px; -o-border-radius:3px; -ms-border-radius:3px; border-radius:3px;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .iPhoneX{background-image: url(images/preview/iPhoneX.png);}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .iPhone6{background-image: url(images/preview/iPhone6.png);}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .iPhone6-plus{background-image: url(images/preview/iPhone6_Plus.png);}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .iPhone5{background-image:url(images/preview/iPhone5.png);}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .iPhone4{background-image:url(images/preview/iPhone4.png);}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .iPad-Air{background-image: url(images/preview/iPad_Air.png);}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .iPad4{background-image: url(images/preview/iPad4.png);}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .new-iPad{background-image:url(images/preview/iPad3.png);}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .iPad-mini{background-image:url(images/preview/iPad-Mini.png);}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .Samsung-Galaxy-S4{background-image: url(images/preview/Samsung_Galaxy_S4.png);}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .Samsung-Note-3{background-image: url(images/preview/Samsung_Note_3.png);}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .Samsung-s8{background-image: url(images/preview/Samsung_s8.png);}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .Nexus-5{background-image: url(images/preview/Nexus_5.png);}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .Nexus-4{background-image: url(images/preview/Nexus_4.png);}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .Nexus-7{background-image: url(images/preview/Nexus_7.png);}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .htc-one{background-image: url(images/preview/HTC_One.png);}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .xiaomi-3{background-image: url(images/preview/Xiaomi_3.png);}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .LG-G2{background-image: url(images/preview/LG_G2.png);}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .google-pixel{background-image: url(images/preview/google_pixel.png);}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .google-pixel-xl{background-image: url(images/preview/google_pixel_XL.png);}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .preview-body .preview-items-section td .preview-item-bg.selected .preview-selected-icon{display:none; left:38px;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .preview-body .preview-items-section td .preview-item-title{display:inline-block; width:100%; text-align:center; color:#666; font-size:12px; margin-top:10px; line-height: 13px;}",
"url:dijit/form/templates/CheckBox.html":'\x3cdiv class\x3d"dijit dijitReset dijitInline" role\x3d"presentation"\r\n\t\x3e\x3cinput\r\n\t \t${!nameAttrSetting} type\x3d"${type}" role\x3d"${type}" aria-checked\x3d"false" ${checkedAttrSetting}\r\n\t\tclass\x3d"dijitReset dijitCheckBoxInput"\r\n\t\tdata-dojo-attach-point\x3d"focusNode"\r\n\t \tdata-dojo-attach-event\x3d"ondijitclick:_onClick"\r\n/\x3e\x3c/div\x3e\r\n',"url:dijit/templates/Menu.html":'\x3ctable class\x3d"dijit dijitMenu dijitMenuPassive dijitReset dijitMenuTable" role\x3d"menu" tabIndex\x3d"${tabIndex}"\r\n\t   cellspacing\x3d"0"\x3e\r\n\t\x3ctbody class\x3d"dijitReset" data-dojo-attach-point\x3d"containerNode"\x3e\x3c/tbody\x3e\r\n\x3c/table\x3e\r\n',
"url:dijit/templates/MenuItem.html":'\x3ctr class\x3d"dijitReset" data-dojo-attach-point\x3d"focusNode" role\x3d"menuitem" tabIndex\x3d"-1"\x3e\r\n\t\x3ctd class\x3d"dijitReset dijitMenuItemIconCell" role\x3d"presentation"\x3e\r\n\t\t\x3cspan role\x3d"presentation" class\x3d"dijitInline dijitIcon dijitMenuItemIcon" data-dojo-attach-point\x3d"iconNode"\x3e\x3c/span\x3e\r\n\t\x3c/td\x3e\r\n\t\x3ctd class\x3d"dijitReset dijitMenuItemLabel" colspan\x3d"2" data-dojo-attach-point\x3d"containerNode,textDirNode"\r\n\t\trole\x3d"presentation"\x3e\x3c/td\x3e\r\n\t\x3ctd class\x3d"dijitReset dijitMenuItemAccelKey" style\x3d"display: none" data-dojo-attach-point\x3d"accelKeyNode"\x3e\x3c/td\x3e\r\n\t\x3ctd class\x3d"dijitReset dijitMenuArrowCell" role\x3d"presentation"\x3e\r\n\t\t\x3cspan data-dojo-attach-point\x3d"arrowWrapper" style\x3d"visibility: hidden"\x3e\r\n\t\t\t\x3cspan class\x3d"dijitInline dijitIcon dijitMenuExpand"\x3e\x3c/span\x3e\r\n\t\t\t\x3cspan class\x3d"dijitMenuExpandA11y"\x3e+\x3c/span\x3e\r\n\t\t\x3c/span\x3e\r\n\t\x3c/td\x3e\r\n\x3c/tr\x3e\r\n',
"url:dijit/templates/MenuSeparator.html":'\x3ctr class\x3d"dijitMenuSeparator" role\x3d"separator"\x3e\r\n\t\x3ctd class\x3d"dijitMenuSeparatorIconCell"\x3e\r\n\t\t\x3cdiv class\x3d"dijitMenuSeparatorTop"\x3e\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d"dijitMenuSeparatorBottom"\x3e\x3c/div\x3e\r\n\t\x3c/td\x3e\r\n\t\x3ctd colspan\x3d"3" class\x3d"dijitMenuSeparatorLabelCell"\x3e\r\n\t\t\x3cdiv class\x3d"dijitMenuSeparatorTop dijitMenuSeparatorLabel"\x3e\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d"dijitMenuSeparatorBottom"\x3e\x3c/div\x3e\r\n\t\x3c/td\x3e\r\n\x3c/tr\x3e\r\n',
"url:dijit/form/templates/Select.html":'\x3ctable class\x3d"dijit dijitReset dijitInline dijitLeft"\r\n\tdata-dojo-attach-point\x3d"_buttonNode,tableNode,focusNode,_popupStateNode" cellspacing\x3d\'0\' cellpadding\x3d\'0\'\r\n\trole\x3d"listbox" aria-haspopup\x3d"true"\r\n\t\x3e\x3ctbody role\x3d"presentation"\x3e\x3ctr role\x3d"presentation"\r\n\t\t\x3e\x3ctd class\x3d"dijitReset dijitStretch dijitButtonContents" role\x3d"presentation"\r\n\t\t\t\x3e\x3cdiv class\x3d"dijitReset dijitInputField dijitButtonText"  data-dojo-attach-point\x3d"containerNode,textDirNode" role\x3d"presentation"\x3e\x3c/div\r\n\t\t\t\x3e\x3cdiv class\x3d"dijitReset dijitValidationContainer"\r\n\t\t\t\t\x3e\x3cinput class\x3d"dijitReset dijitInputField dijitValidationIcon dijitValidationInner" value\x3d"\x26#935; " type\x3d"text" tabIndex\x3d"-1" readonly\x3d"readonly" role\x3d"presentation"\r\n\t\t\t/\x3e\x3c/div\r\n\t\t\t\x3e\x3cinput type\x3d"hidden" ${!nameAttrSetting} data-dojo-attach-point\x3d"valueNode" value\x3d"${value}" aria-hidden\x3d"true"\r\n\t\t/\x3e\x3c/td\r\n\t\t\x3e\x3ctd class\x3d"dijitReset dijitRight dijitButtonNode dijitArrowButton dijitDownArrowButton dijitArrowButtonContainer"\r\n\t\t\tdata-dojo-attach-point\x3d"titleNode" role\x3d"presentation"\r\n\t\t\t\x3e\x3cinput class\x3d"dijitReset dijitInputField dijitArrowButtonInner" value\x3d"\x26#9660; " type\x3d"text" tabIndex\x3d"-1" readonly\x3d"readonly" role\x3d"presentation"\r\n\t\t\t\t${_buttonInputDisabled}\r\n\t\t/\x3e\x3c/td\r\n\t\x3e\x3c/tr\x3e\x3c/tbody\r\n\x3e\x3c/table\x3e\r\n',
"url:esri/dijit/ColorPicker/templates/ColorPicker.html":'\x3cdiv class\x3d"${css.container}"\x3e\r\n  \x3cdiv class\x3d"${css.header}" data-dojo-attach-point\x3d"dap_header"\x3e\r\n    \x3cspan class\x3d"${css.swatchPreview} ${css.container}"\x3e\r\n      \x3cspan class\x3d"${css.swatch} ${css.swatchTransparencyBackground}"\x3e\x3c/span\x3e\r\n      \x3cspan data-dojo-attach-point\x3d"dap_previewSwatch" class\x3d"${css.swatch}"\x3e\x3c/span\x3e\r\n    \x3c/span\x3e\r\n    \x3cspan aria-hidden\x3d"true" role\x3d"presentation" class\x3d"${css.collapseIcon} ${css.downArrowIcon}" \x3e\x3c/span\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"${css.colorControls}" data-dojo-attach-point\x3d"dap_colorControls"\x3e\r\n    \x3cdiv class\x3d"${css.middle}"\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"dap_paletteContainer" class\x3d"${css.palette} ${css.container}"\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"dap_primaryPalette" class\x3d"${css.palette}"\x3e\x3c/div\x3e\x3c!--\r\n      --\x3e\x3cdiv data-dojo-attach-point\x3d"dap_secondaryPalette" class\x3d"${css.palette}"\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"${css.paletteOptions}"\x3e\r\n        \x3cinput type\x3d"text" data-dojo-type\x3d"dijit/form/TextBox" data-dojo-attach-point\x3d"dap_hexInput" class\x3d"${css.hexInput}"/\x3e\r\n        \x3cinput class\x3d"${css.paletteToggle}" type\x3d"button" data-dojo-type\x3d"dijit/form/ToggleButton" data-dojo-attach-point\x3d"dap_paletteToggle" label\x3d"${labels.more}"/\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"${css.footer}" data-dojo-attach-point\x3d"dap_footer"\x3e\r\n      \x3cdiv class\x3d"${css.section} ${css.displayNone}" data-dojo-attach-point\x3d"dap_suggestedColorSection"\x3e\r\n        \x3cdiv class\x3d"${css.label}"\x3e${labels.suggested}\x3c/div\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"dap_suggestedColorPalette" class\x3d"${css.suggested} ${css.palette} ${css.swatchRow}"\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"${css.section}" data-dojo-attach-point\x3d"dap_recentColorSection"\x3e\r\n        \x3cdiv class\x3d"${css.label}"\x3e${labels.recent}\x3c/div\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"dap_recentColorPalette" class\x3d"${css.recent} ${css.palette} ${css.swatchRow}"\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"${css.section}" data-dojo-attach-point\x3d"dap_transparencySection"\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"dap_transparencyLabel" class\x3d"${css.label}"\x3e${labels.transparency}\x3c/div\x3e\r\n        \x3cdiv class\x3d"${css.transparencySlider}"\r\n             data-dojo-attach-point\x3d"dap_transparencySlider"\r\n             data-dojo-type\x3d"esri/dijit/HorizontalSlider"\r\n             data-dojo-props\x3d"minimum: 0, maximum: 1, discreteValues: 100, labels: ${_transparencyLabels}"\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:dijit/form/templates/HorizontalSlider.html":'\x3ctable class\x3d"dijit dijitReset dijitSlider dijitSliderH" cellspacing\x3d"0" cellpadding\x3d"0" border\x3d"0" rules\x3d"none" data-dojo-attach-event\x3d"onkeydown:_onKeyDown, onkeyup:_onKeyUp"\r\n\trole\x3d"presentation"\r\n\t\x3e\x3ctr class\x3d"dijitReset"\r\n\t\t\x3e\x3ctd class\x3d"dijitReset" colspan\x3d"2"\x3e\x3c/td\r\n\t\t\x3e\x3ctd data-dojo-attach-point\x3d"topDecoration" class\x3d"dijitReset dijitSliderDecoration dijitSliderDecorationT dijitSliderDecorationH"\x3e\x3c/td\r\n\t\t\x3e\x3ctd class\x3d"dijitReset" colspan\x3d"2"\x3e\x3c/td\r\n\t\x3e\x3c/tr\r\n\t\x3e\x3ctr class\x3d"dijitReset"\r\n\t\t\x3e\x3ctd class\x3d"dijitReset dijitSliderButtonContainer dijitSliderButtonContainerH"\r\n\t\t\t\x3e\x3cdiv class\x3d"dijitSliderDecrementIconH" style\x3d"display:none" data-dojo-attach-point\x3d"decrementButton"\x3e\x3cspan class\x3d"dijitSliderButtonInner"\x3e-\x3c/span\x3e\x3c/div\r\n\t\t\x3e\x3c/td\r\n\t\t\x3e\x3ctd class\x3d"dijitReset"\r\n\t\t\t\x3e\x3cdiv class\x3d"dijitSliderBar dijitSliderBumper dijitSliderBumperH dijitSliderLeftBumper" data-dojo-attach-event\x3d"press:_onClkDecBumper"\x3e\x3c/div\r\n\t\t\x3e\x3c/td\r\n\t\t\x3e\x3ctd class\x3d"dijitReset"\r\n\t\t\t\x3e\x3cinput data-dojo-attach-point\x3d"valueNode" type\x3d"hidden" ${!nameAttrSetting}\r\n\t\t\t/\x3e\x3cdiv class\x3d"dijitReset dijitSliderBarContainerH" role\x3d"presentation" data-dojo-attach-point\x3d"sliderBarContainer"\r\n\t\t\t\t\x3e\x3cdiv role\x3d"presentation" data-dojo-attach-point\x3d"progressBar" class\x3d"dijitSliderBar dijitSliderBarH dijitSliderProgressBar dijitSliderProgressBarH" data-dojo-attach-event\x3d"press:_onBarClick"\r\n\t\t\t\t\t\x3e\x3cdiv class\x3d"dijitSliderMoveable dijitSliderMoveableH"\r\n\t\t\t\t\t\t\x3e\x3cdiv data-dojo-attach-point\x3d"sliderHandle,focusNode" class\x3d"dijitSliderImageHandle dijitSliderImageHandleH" data-dojo-attach-event\x3d"press:_onHandleClick" role\x3d"slider"\x3e\x3c/div\r\n\t\t\t\t\t\x3e\x3c/div\r\n\t\t\t\t\x3e\x3c/div\r\n\t\t\t\t\x3e\x3cdiv role\x3d"presentation" data-dojo-attach-point\x3d"remainingBar" class\x3d"dijitSliderBar dijitSliderBarH dijitSliderRemainingBar dijitSliderRemainingBarH" data-dojo-attach-event\x3d"press:_onBarClick"\x3e\x3c/div\r\n\t\t\t\x3e\x3c/div\r\n\t\t\x3e\x3c/td\r\n\t\t\x3e\x3ctd class\x3d"dijitReset"\r\n\t\t\t\x3e\x3cdiv class\x3d"dijitSliderBar dijitSliderBumper dijitSliderBumperH dijitSliderRightBumper" data-dojo-attach-event\x3d"press:_onClkIncBumper"\x3e\x3c/div\r\n\t\t\x3e\x3c/td\r\n\t\t\x3e\x3ctd class\x3d"dijitReset dijitSliderButtonContainer dijitSliderButtonContainerH"\r\n\t\t\t\x3e\x3cdiv class\x3d"dijitSliderIncrementIconH" style\x3d"display:none" data-dojo-attach-point\x3d"incrementButton"\x3e\x3cspan class\x3d"dijitSliderButtonInner"\x3e+\x3c/span\x3e\x3c/div\r\n\t\t\x3e\x3c/td\r\n\t\x3e\x3c/tr\r\n\t\x3e\x3ctr class\x3d"dijitReset"\r\n\t\t\x3e\x3ctd class\x3d"dijitReset" colspan\x3d"2"\x3e\x3c/td\r\n\t\t\x3e\x3ctd data-dojo-attach-point\x3d"containerNode,bottomDecoration" class\x3d"dijitReset dijitSliderDecoration dijitSliderDecorationB dijitSliderDecorationH"\x3e\x3c/td\r\n\t\t\x3e\x3ctd class\x3d"dijitReset" colspan\x3d"2"\x3e\x3c/td\r\n\t\x3e\x3c/tr\r\n\x3e\x3c/table\x3e\r\n',
"url:dijit/form/templates/DropDownButton.html":'\x3cspan class\x3d"dijit dijitReset dijitInline"\r\n\t\x3e\x3cspan class\x3d\'dijitReset dijitInline dijitButtonNode\'\r\n\t\tdata-dojo-attach-event\x3d"ondijitclick:__onClick" data-dojo-attach-point\x3d"_buttonNode"\r\n\t\t\x3e\x3cspan class\x3d"dijitReset dijitStretch dijitButtonContents"\r\n\t\t\tdata-dojo-attach-point\x3d"focusNode,titleNode,_arrowWrapperNode,_popupStateNode"\r\n\t\t\trole\x3d"button" aria-haspopup\x3d"true" aria-labelledby\x3d"${id}_label"\r\n\t\t\t\x3e\x3cspan class\x3d"dijitReset dijitInline dijitIcon"\r\n\t\t\t\tdata-dojo-attach-point\x3d"iconNode"\r\n\t\t\t\x3e\x3c/span\r\n\t\t\t\x3e\x3cspan class\x3d"dijitReset dijitInline dijitButtonText"\r\n\t\t\t\tdata-dojo-attach-point\x3d"containerNode"\r\n\t\t\t\tid\x3d"${id}_label"\r\n\t\t\t\x3e\x3c/span\r\n\t\t\t\x3e\x3cspan class\x3d"dijitReset dijitInline dijitArrowButtonInner"\x3e\x3c/span\r\n\t\t\t\x3e\x3cspan class\x3d"dijitReset dijitInline dijitArrowButtonChar"\x3e\x26#9660;\x3c/span\r\n\t\t\x3e\x3c/span\r\n\t\x3e\x3c/span\r\n\t\x3e\x3cinput ${!nameAttrSetting} type\x3d"${type}" value\x3d"${value}" class\x3d"dijitOffScreen" tabIndex\x3d"-1"\r\n\t\tdata-dojo-attach-event\x3d"onclick:_onClick" data-dojo-attach-point\x3d"valueNode" aria-hidden\x3d"true"\r\n/\x3e\x3c/span\x3e\r\n',
"url:builder/plugins/app-config-template-configpart/Plugin.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"header-line"\x3e\x3c/div\x3e\r\n  \x3cdiv class\x3d"head-part"\x3e\r\n    \x3cdiv class\x3d"decorator"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"description data-dojo-attach-point\x3d"description"" \x3e\r\n      \x3cdiv class\x3d"description-text"\x3e${nls.description}\x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"config-part-box"\x3e\r\n    \x3cdiv class\x3d"config-part" data-dojo-attach-point\x3d"configPart"\x3e\r\n      \x3cdiv class\x3d"map-category"\x3e\r\n        \x3cdiv class\x3d"map-title" data-dojo-attach-point\x3d"mapTitle"\x3e${nls.map}\x3c/div\x3e\r\n        \x3cdiv class\x3d"select-part"\x3e\r\n          \x3cdiv class\x3d"jimu-btn select-map" data-dojo-attach-point\x3d"selectMapBtn" data-dojo-attach-event\x3d"click:_onSelectMapClick"\x3e${nls.changeWebMap}\x3c/div\x3e\r\n          \x3cdiv class\x3d"map-name" data-dojo-attach-point\x3d"mapName"\x3e\x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"control-part" data-dojo-attach-point\x3d"controlPart"\x3e\x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:builder/plugins/app-config-template-configpart/css/style.css":".plugin-appconfig-template-configpart {background-color: #ffffff; font-size: 12px; overflow-y: auto;}.plugin-appconfig-template-configpart .header-line {width: 100%; position: absolute; border-style: none none solid none; border-width: 1px; box-shadow: 0px 0px 6px rgba(0,0,0,0.4); border-color: rgba(0,0,0,0.0); display: none;}.plugin-appconfig-template-configpart .head-part {position: absolute; top: 0; height: 80px; background-color: #f3f3f3; width: 100%; z-index: 1;}.plugin-appconfig-template-configpart .head-part .decorator {height: 16px; background-color: #24B5CC;}.plugin-appconfig-template-configpart .head-part .description {height: 64px; padding-top: 10px; color: #666666; font-size: 14px; width: 90%; margin: 0 auto;}.plugin-appconfig-template-configpart .config-part-box {width: 100%; overflow: auto; height: 100%;}.plugin-appconfig-template-configpart .config-part {width: 90%; height: 100%; margin: 0 auto; padding-top: 80px;}.plugin-appconfig-template-configpart .config-part .map-category .map-title{border-bottom: 1px solid #eaeaea; margin: 12px 0 10px 0; font-weight: bold; font-size: 14px; color: #565656; padding-bottom: 0.3em;}.plugin-appconfig-template-configpart .config-part .map-category {overflow: hidden;}.plugin-appconfig-template-configpart .config-part .map-category .select-map{padding: 0 15px; font-size: 14px; line-height: 33px; text-align: center; color: #ffffff; float: left; max-width: 50%;}.plugin-appconfig-template-configpart .config-part .map-category .map-name{margin-top: 10px; color: #596679; font-size: 12px; max-width: 100%; white-space: nowrap; text-overflow: ellipsis; overflow: hidden; float: right; width: 50%;}",
"url:builder/dijit/template-config/templates/Template.html":'\x3cdiv\x3e\r\n\r\n    \x3cdiv class\x3d"content-part" data-dojo-attach-point\x3d"contentPart"\x3e\r\n      \x3cdiv class\x3d"tree-part jimu-float-leading" data-dojo-attach-point\x3d"treePart"\x3e\r\n        \x3cdiv class\x3d"left-part-title"\x3e${nls.appProperties}\x3c/div\x3e\r\n      \x3c/div\x3e\r\n\r\n      \x3cdiv class\x3d"right-part jimu-float-leading" data-dojo-attach-point\x3d"leftPart"\x3e\r\n        \x3cdiv class\x3d"right-part-content"\x3e\r\n          \x3cdiv class\x3d"right-part-head" \x3e\r\n            \x3cspan data-dojo-attach-point\x3d"rightPartHeadText"\x3e${nls.rightPartHead}\x3c/span\x3e\r\n            \x3cdiv class\x3d"review-json-div" data-dojo-attach-point\x3d"reviewJsonDiv" data-dojo-attach-event\x3d"onclick:_onReviewJsonDivClick" style\x3d"display:none"\x3e${nls.viewJsonCode}\x3c/div\x3e\r\n            \x3cdiv class\x3d"review-json-back-div" style\x3d"display: none" data-dojo-attach-point\x3d"reviewJsonBackDiv" data-dojo-attach-event\x3d"onclick:_onReviewJsonBackDivClick"\x3e${nls.viewJsonBack}\x3c/div\x3e\r\n          \x3c/div\x3e\r\n\r\n          \x3cdiv class\x3d"right-part-subhead"\x3e\r\n            ${nls.rightPartSubhead}\r\n          \x3c/div\x3e\r\n          \x3cdiv class\x3d"category-part" data-dojo-attach-point\x3d"categoryPart"\x3e\x3c/div\x3e\r\n          \x3cdiv class\x3d"show-json-div" data-dojo-attach-point\x3d"showJsonDiv"\x3e\r\n            \x3cdiv class\x3d"show-json-content-div" data-dojo-attach-point\x3d"showJsonContentDiv"\x3e\r\n            \x3c/div\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:builder/dijit/template-config/templates/Export.html":'\x3cdiv\x3e\r\n  \x3cp style\x3d"display:block;" class\x3d"message-div" data-dojo-attach-point\x3d"templateTitle"\x3e${nls.templateTitle}\x3c/p\x3e\r\n  \x3cp style\x3d"display:none;" class\x3d"message-div" data-dojo-attach-point\x3d"message1"\x3e\x3c/p\x3e\r\n  \x3cdiv style\x3d"display:none;" class\x3d"explain-div" data-dojo-attach-point\x3d"explain1"\x3e\x3c/div\x3e\r\n\r\n  \x3cdiv class\x3d"item-info-box" data-dojo-attach-point\x3d"itemInfoBox" \x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:builder/dijit/template-config/templates/ExportMessage.html":'\x3cdiv\x3e\r\n    \x3cdiv class\x3d"element resMessage" data-dojo-attach-point\x3d"resMessage"\x3e\x3c/div\x3e\r\n    \x3c!--div class\x3d"element" data-dojo-attach-point\x3d"message1"\x3e\x3c/div--\x3e\r\n    \x3cdiv class\x3d"element itemLink"\x3e\r\n      \x3cspan data-dojo-attach-point\x3d"word1" \x3e\x3c/span\x3e\r\n      \x3ca class\x3d"download-a" target\x3d"_blank" data-dojo-attach-point\x3d"itemLink"\x3e\x3c/a\x3e\r\n      \x3cspan data-dojo-attach-point\x3d"word2" \x3e\x3c/span\x3e\r\n    \x3c/div\x3e\r\n\x3c/div\x3e',
"url:builder/dijit/templates/ItemInfo.html":'\x3cdiv\x3e\r\n        \x3cdiv\x3e\r\n          \x3ctable style\x3d"width:100%" cellspacing\x3d"6"\x3e\r\n            \x3ctbody\x3e\r\n              \x3ctr\x3e\r\n                \x3ctd class\x3d"label-tr" width\x3d"10%"\x3e\r\n                  \x3clabel for\x3d"publish-webmap-name"\x3e\r\n                    ${nls.nameLabel}\r\n                  \x3c/label\x3e\r\n                \x3c/td\x3e\r\n                \x3ctd width\x3d"90%"\x3e\r\n                  \x3cdiv id\x3d"publish-webmap-name" data-dojo-type\x3d"dijit/form/TextBox" trim\x3d"true" data-dojo-attach-point\x3d"appName" maxlength\x3d"250" required\x3d"true" style\x3d"width:95%;padding:2px;"\x3e\r\n                  \x3c/div\x3e\r\n                \x3c/td\x3e\r\n              \x3c/tr\x3e\r\n\r\n              \x3ctr data-dojo-attach-point\x3d"tagsTr"\x3e\r\n                \x3ctd class\x3d"label-tr"\x3e\r\n                  \x3clabel for\x3d"publish-webmap-tags"\x3e\r\n                    ${nls.tagsLabel}\r\n                  \x3c/label\x3e\r\n                \x3c/td\x3e\r\n                \x3ctd\x3e\r\n                  \x3cdiv id\x3d"publish-webmap-tags" data-dojo-type\x3d"builder/dijit/Tags" data-dojo-attach-point\x3d"tags" style\x3d"width:95%;max-width:95%;"\x3e\x3c/div\x3e\r\n                \x3c/td\x3e\r\n              \x3c/tr\x3e\r\n\r\n              \x3ctr\x3e\r\n                \x3ctd class\x3d"label-tr" valign\x3d"top"\x3e\r\n                  \x3clabel for\x3d"publish-webmap-summary"\x3e\r\n                    ${nls.summaryLabel}\r\n                  \x3c/label\x3e\r\n                \x3c/td\x3e\r\n                \x3ctd\x3e\r\n                  \x3cdiv id\x3d"publish-webmap-summary" data-dojo-type\x3d"dijit/form/SimpleTextarea" rows\x3d\'5\' trim\x3d"true" maxlength\x3d"250" required\x3d"true" style\x3d"width:95%;max-width:95%;min-width:95%;height:200px;max-height:200px;min-height:200px;padding:2px;resize:none;"\x3e\x3c/div\x3e\r\n                \x3c/td\x3e\r\n              \x3c/tr\x3e\r\n\r\n              \x3ctr data-dojo-attach-point\x3d"thumbnailTr"\x3e\r\n                \x3ctd class\x3d"label-tr"\x3e\r\n                  \x3clabel for\x3d"publish-webmap-thumbnail"\x3e\r\n                    ${nls.thumbnailLabel}\r\n                  \x3c/label\x3e\r\n                \x3c/td\x3e\r\n                \x3ctd\x3e\r\n                  \x3cdiv class\x3d"image-chooser-base" id\x3d"publish-webmap-thumbnail" data-dojo-attach-point\x3d"imageChooserBase"\x3e\x3c/div\x3e\r\n                \x3c/td\x3e\r\n              \x3c/tr\x3e\r\n\r\n              \x3ctr data-dojo-attach-point\x3d"folderTr"\x3e\r\n                \x3ctd class\x3d"label-tr"\x3e\r\n                  \x3clabel for\x3d"publish-webmap-folder"\x3e\r\n                    ${nls.saveFolderLabel}\r\n                  \x3c/label\x3e\r\n                \x3c/td\x3e\r\n                \x3ctd\x3e\r\n                  \x3cdiv id\x3d"publish-webmap-folder" data-dojo-type\x3d"dijit/form/Select" style\x3d"width:96%;"\x3e\r\n                  \x3c/div\x3e\r\n                \x3c/td\x3e\r\n              \x3c/tr\x3e\r\n              \x3ctr data-dojo-attach-point\x3d"sharingTr"\x3e\r\n                \x3ctd\x3e\x26nbsp;\x3c/td\x3e\r\n                \x3ctd\x3e\r\n                  \x3cdiv id\x3d"publish-webmap-sharing" data-dojo-type\x3d"dijit/form/CheckBox" checked\x3e\x3c/div\x3e\r\n                  \x3clabel for\x3d"publish-webmap-sharing"\x3e${nls.shareSameLevel}\x3c/label\x3e\r\n                \x3c/td\x3e\r\n              \x3c/tr\x3e\r\n            \x3c/tbody\x3e\r\n          \x3c/table\x3e\r\n        \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:builder/dijit/templates/Tags.html":'\x3cdiv class\x3d"${baseClass}" style\x3d"outline:none;"\x3e\x3c/div\x3e\r\n',"url:jimu/dijit/templates/ImageChooser.html":'\x3cdiv class\x3d"jimu-image-chooser js-fileapi-wrapper"\x3e\r\n  \x3cdiv class\x3d"hint" data-dojo-attach-point\x3d"hintText"\x3e\r\n\t\t\x3cspan class\x3d"display-text" data-dojo-attach-point\x3d"displayText"\x3e\x3c/span\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"hint" data-dojo-attach-point\x3d"hintImage"\x3e\r\n\t\t\x3cimg class\x3d"display-image" data-dojo-attach-point\x3d"selfImg"\x3e\r\n  \x3c/div\x3e\r\n  \x3c!--\r\n  \x3cform data-dojo-attach-point\x3d"fileForm"\x3e\r\n    \x3clabel data-dojo-attach-point\x3d"mask"\x3e\x3c/label\x3e\r\n    \x3cinput type\x3d"file" data-dojo-attach-point\x3d"fileInput"\x3e\r\n  \x3c/form\x3e\r\n  \x3cimg class\x3d"tmp-image" style\x3d"display:none" data-dojo-attach-point\x3d"tmpImg"\x3e--\x3e\r\n\x3c/div\x3e',
"url:jimu/dijit/templates/_CropImage.html":'\x3cdiv class\x3d"jimu-crop-image"\x3e\r\n\t\x3cimg class\x3d"loading-image" data-dojo-attach-point\x3d"loadingImg" src\x3d""\x3e\r\n\r\n\t\x3cimg class\x3d"base-image hide-status" data-dojo-attach-point\x3d"baseImage" width\x3d"100%" height\x3d"100%" style\x3d"display:none;width:100%;height:100%"\x3e\r\n\x3c/div\x3e\r\n',"url:builder/plugins/app-config-templateconfig/Plugin.html":'\x3cdiv \x3e\r\n  \x3cdiv class\x3d"header-line"\x3e\x3c/div\x3e\r\n  \x3cdiv class\x3d"left-part jimu-float-leading"\x3e\r\n    \x3cdiv class\x3d"config-panel" data-dojo-attach-point\x3d"configPanel"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"action-panel"\x3e\r\n      \r\n      \x3cdiv class\x3d"to-app-btn jimu-float-leading" title\x3d"${nls.toConfigApp}" data-dojo-attach-event\x3d"onclick:_onToAppClick" \x3e${nls.toConfigApp}\x3c/div\x3e\r\n      \x3cdiv class\x3d"save-btn jimu-float-trailing" data-dojo-attach-point\x3d"savePluginNode"\x3e\x3c/div\x3e\r\n      \x3cdiv class\x3d"separate jimu-float-trailing"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e    \r\n  \x3c/div\x3e\r\n\r\n \x3cdiv class\x3d"preview-panel jimu-float-leading" \x3e\r\n    \x3cdiv class\x3d"preview-content" data-dojo-attach-point\x3d"previewPanel"\x3e\r\n    \x3c/div\x3e\r\n \x3c/div\x3e\r\n\r\n\x3c/div\x3e',
"url:builder/plugins/app-config-templateconfig/css/style.css":".plugin-config-template {background-color: #ffffff; position: relative;}.plugin-config-template .header-line{width: 100%; position: absolute; border-style: none none solid none; border-width: 1px; box-shadow: 0px 0px 6px rgba(0,0,0,0.4); border-color: rgba(0,0,0,0.0);}.plugin-config-template .left-part{width: 60%; height: 100%; position: relative; box-shadow: 0px 0px 8px rgba(0,0,0,0.4);}.plugin-config-template .config-panel{position: absolute; left: 0; right: 0; top: 0; bottom: 50px; box-shadow: 0px 0px 8px rgba(0,0,0,0.4); z-index: 2;}.plugin-config-template .action-panel{width: 100%; position: absolute; left: 0; right: 0; bottom: 0; height: 52px; background-color: #F3F3F3; font-size: 14px;}.plugin-config-template .action-panel .to-app-btn{background-image: url(../../../../stemapp/jimu.js/css/images/setting_disabled.png); height: 100%; line-height: 52px; padding-left: 50px; background-repeat: no-repeat; background-position: 25px center; cursor: pointer;}.jimu-rtl .plugin-config-template .action-panel .to-app-btn{padding-right: 50px; padding-left: auto; background-position: right 25px center;}.plugin-config-template .action-panel .to-app-btn:hover{background-image: url(../../../../stemapp/jimu.js/css/images/setting_hover.png); color: #15a4fa;}.plugin-config-template .action-panel .separate{border: 1px solid #a3a3a3; height: 20px; margin-top: 16px;}.plugin-config-template .action-panel .save-btn{margin-right: 40px; margin-left: 40px;}.plugin-config-template .preview-panel{width: 40%; height: 100%; overflow-y: auto; overflow-x: hidden; -ms-overflow-y: auto; -ms-overflow-x: hidden;}.plugin-config-template .preview-panel .preview-content{width: 80%; margin: 0 auto; min-width: 300px;}",
"url:builder/plugins/app-list/Plugin.html":'\x3cdiv\x3e\r\n  \x3c!--header\x3e\x3c--\x3e\r\n  \x3cdiv class\x3d"header" data-dojo-attach-point\x3d"header"\x3e\r\n    \x3cdiv class\x3d"navigator-box" data-dojo-attach-point\x3d"navigatorBox"\x3e\r\n      \x3c!--div class\x3d"switch-app" style\x3d"float: left; cursor: pointer; margin-right: 5px" data-dojo-attach-point\x3d"switchApps"  data-dojo-attach-event\x3d"onclick:_onSwitchToAppContent"\x3eapps\x3c/div\x3e\r\n      \x3cdiv class\x3d"switch-template" style\x3d"float: left; cursor: pointer;" data-dojo-attach-point\x3d"switchTemplates" data-dojo-attach-event\x3d"onclick:_onSwitchToTemplateContent"\x3etempaltes\x3c/div--\x3e    \r\n      \x3cdiv class\x3d"navigator" data-dojo-attach-point\x3d"navigator"\x3e\r\n        \x3cdiv class\x3d"filter-box jimu-float-leading" data-dojo-attach-point\x3d"filterBox"\x3e\r\n          \x3cdiv class\x3d"filter all selected jimu-float-leading" id\x3d"ALL" data-dojo-attach-point\x3d"filterAllBtn" data-dojo-attach-event\x3d"onclick:_filterAllBtnClick"\x3e${nls.all}\x3c/div\x3e\r\n          \x3cdiv class\x3d"filter 2d jimu-float-leading" id\x3d"HTML" data-dojo-attach-point\x3d"filter2dBtn" data-dojo-attach-event\x3d"onclick:_filter2dBtnClick"\x3e${nls.d2}\x3c/div\x3e\r\n          \x3cdiv class\x3d"filter 3d jimu-float-leading" id\x3d"HTML3D" data-dojo-attach-point\x3d"filter3dBtn" data-dojo-attach-event\x3d"onclick:_filter3dBtnClick"\x3e${nls.d3}\x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"search jimu-float-trailing" data-dojo-attach-point\x3d"search"\x3e\r\n          \x3cdiv class\x3d"search-box jimu-float-leading" data-dojo-type\x3d"dijit/form/TextBox" data-dojo-attach-point\x3d"searchBox" trim\x3d"true" maxlength\x3d"250" required\x3d"true" placeholder\x3d${nls.searchPlaceholder} data-dojo-attach-event\x3d"onKeyUp:_onSearchBoxChange"\x3e\x3c/div\x3e\r\n          \x3cdiv class\x3d"search-btn jimu-float-leading" data-dojo-attach-point\x3d"searchBtn"\x3e\x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"sort-box jimu-float-trailing" data-dojo-attach-point\x3d"sortBox"\x3e\r\n          \x3cdiv class\x3d"sort by-modified-time selected jimu-float-leading" id\x3d"lastUpdated" data-dojo-attach-point\x3d"sortByModifiedTimeBtn" data-dojo-attach-event\x3d"onclick:_sortByModifiedTimeBtnClick" title\x3d"${nls.sortByModifiedTime}"\x3e\x3c/div\x3e\r\n          \x3cdiv class\x3d"sort by-name jimu-float-leading" id\x3d"name" data-dojo-attach-point\x3d"sortByNameBtn"  data-dojo-attach-event\x3d"onclick:_sortByNameBtnClick" title\x3d"${nls.sortByName}"\x3e\x3c/div\x3e\r\n          \x3cdiv class\x3d"sort by-author jimu-float-leading" id\x3d"creator" data-dojo-attach-point\x3d"sortByAuthorBtn" data-dojo-attach-event\x3d"onclick:_sortByAuthorBtnClick" style\x3d"display: none" title\x3d"${nls.sortByAuthor}"\x3e\x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"content-box" id\x3d"content-box" data-dojo-attach-point\x3d"contentBox"\x3e\r\n    \x3c!--operation\x3e\x3c--\x3e\r\n    \x3cdiv class\x3d"operation-box" data-dojo-attach-point\x3d"operationBox"\x3e\r\n      \x3cdiv class\x3d"create jimu-float-leading" data-dojo-attach-point\x3d"createNewBtn" data-dojo-attach-event\x3d"onclick:_onCreateClick" title\x3d${nls.appCreate}\x3e${nls.appCreate}\x3c/div\x3e\r\n      \x3cdiv class\x3d"import jimu-float-leading" data-dojo-attach-point\x3d"importBtn"\x3e\x3c/div\x3e\r\n      \x3cdiv class\x3d"switch-app-page-box" data-dojo-attach-point\x3d"switchAppPapgeBox"\x3e \x3c/div\x3e\r\n    \x3c/div\x3e  \r\n    \x3c!--content\x3e\x3c--\x3e\r\n    \x3cdiv class\x3d"content app-content selected" id\x3d"app-content" data-dojo-attach-point\x3d"appContent"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"content tempalte-content" id\x3d"template-content" data-dojo-attach-point\x3d"templateContent"\x3e\x3c/div\x3e\r\n    \x3c!--footer\x3e\x3c--\x3e\r\n    \x3cdiv class\x3d"footer" data-dojo-attach-point\x3d"footer"\x3e\r\n      \x3cdiv class\x3d"footer-text"\x3e\r\n        \x3cspan class\x3d"jimu-float-leading"\x3e\u00a9 Copyright 2017 Environmental Systems Research Institute, Inc.\x3c/span\x3e\r\n        \x3cspan class\x3d"separator jimu-float-leading"\x3e|\x3c/span\x3e\r\n        \x3ca class\x3d"jimu-float-leading" target\x3d"_blank" href\x3d"//www.esri.com/legal/privacy"\x3ePrivacy\x3c/a\x3e\r\n        \x3cspan class\x3d"separator jimu-float-leading"\x3e|\x3c/span\x3e\r\n        \x3ca class\x3d"jimu-float-leading" target\x3d"_blank" href\x3d"//www.esri.com/legal/software-license"\x3eLegal\x3c/a\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3ciframe style\x3d"display:none" name\x3d"downloadTargetFrame"\x3e\x3c/iframe\x3e\r\n\x3c/div\x3e\r\n\r\n',
"url:builder/plugins/app-list/Import.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"actions jimu-float-trailing" data-dojo-attach-point\x3d"actionsNode"\x3e\r\n    \x3cspan class\x3d"actions-label jimu-ellipsis" title\x3d"${nls.actionsLabel}" data-dojo-attach-event\x3d"onclick:_onActionsLabelClick"\x3e${nls.actionsLabel}\x3c/span\x3e\r\n    \x3cdiv class\x3d"actions-menu" data-dojo-attach-point\x3d"actionsMenu"\x3e\r\n      \x3cdiv class\x3d"actions-menu-item item-import" data-dojo-attach-point\x3d"itemImportBtn" data-dojo-attach-event\x3d"onclick:_onMenuItemClick"\x3e\r\n        \x3cdiv class\x3d"import-button jimu-ellipsis" title\x3d"${nls.importAction}" data-dojo-attach-event\x3d"onclick:_onImportClick"\x3e${nls.importAction}\x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"actions-menu-item item-upload" data-dojo-attach-event\x3d"onclick:_onMenuItemClick"\x3e\r\n        \x3cdiv class\x3d"upload-button-div"\x3e\r\n          \x3cdiv class\x3d"upload-button jimu-ellipsis" title\x3d"${nls.uploadAction}"\x3e${nls.uploadAction}\x3c/div\x3e\r\n          \x3cform enctype\x3d"multipart/form-data" encoding\x3d"multipart/form-data" title\x3d"${nls.uploadAction}" method\x3d"post" action\x3d"/webappbuilder/rest/apps/upload" data-dojo-attach-point\x3d"uploadAppFileFormNode"\x3e\r\n            \x3cinput class\x3d"file-input" title\x3d"${nls.uploadAction}" name\x3d"app" type\x3d"file" data-dojo-attach-point\x3d"appFileInputNode" data-dojo-type\x3d"dojox/form/Uploader" data-dojo-attach-event\x3d"onChange:_onAppFileChange,onError:_onAppFileUploadError,onComplete:_onAppFileUploadComplete" accept\x3d".zip" style\x3d"width:100%;height:100%;"\x3e\r\n            \x3cinput name\x3d"creator" type\x3d"text" value\x3d"1234" style\x3d"display:none;" data-dojo-attach-point\x3d"appFileCreatorInputNode"\x3e\r\n            \x3cinput name\x3d"portalUrl" type\x3d"text" style\x3d"display:none" data-dojo-attach-point\x3d"appPortalUrlInputNode"\x3e\r\n            \x3cinput name\x3d"fromList" type\x3d"text" style\x3d"display:none" data-dojo-attach-point\x3d"fromListNode"\x3e\r\n          \x3c/form\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n\r\n',
"url:jimu/dijit/templates/ItemSelector.html":'\r\n\x3cdiv\x3e\r\n\t\x3cdiv class\x3d"setting-tab-container"\x3e\r\n\t\t\x3cdiv data-dojo-attach-point\x3d"tabNode"\x3e\x3c/div\x3e\r\n\r\n\t\t\x3cdiv class\x3d"tab-content mycontent-tab" data-dojo-attach-point\x3d"mycontentTabNode"\x3e\r\n\t\t\t\x3cdiv class\x3d"tab-content-main mycontent-tab-content-main"\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"mycontentSearch" data-dojo-type\x3d"jimu/dijit/Search" data-dojo-props\x3d\'searchWhenInput:false\' data-dojo-attach-event\x3d"onSearch:_onMyContentSearch" style\x3d"position:absolute;width:100%;top:0;"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"mycontentItemTable" data-dojo-type\x3d"jimu/dijit/_ItemTable" data-dojo-props\x3d\'types:${_itemTypes},typeKeywords:${_typeKeywords}\' style\x3d"top:50px;"\x3e\x3c/div\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\r\n\t\t\x3cdiv class\x3d"tab-content organization-tab" data-dojo-attach-point\x3d"organizationTabNode"\x3e\r\n\t\t\t\x3cdiv class\x3d"tab-content-main organization-tab-content-main"\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"organizationSearch" data-dojo-type\x3d"jimu/dijit/Search" data-dojo-props\x3d\'searchWhenInput:false\' data-dojo-attach-event\x3d"onSearch:_onOrganizationSearch" style\x3d"position:absolute;width:100%;top:0;"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"organizationItemTable" data-dojo-type\x3d"jimu/dijit/_ItemTable" data-dojo-props\x3d\'types:${_itemTypes},typeKeywords:${_typeKeywords}\' style\x3d"top:50px;"\x3e\x3c/div\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\r\n\t\t\x3cdiv class\x3d"tab-content group-tab" data-dojo-attach-point\x3d"groupTabNode"\x3e\r\n\t\t\t\x3cdiv class\x3d"tab-content-main group-tab-content-main"\x3e\r\n\t\t\t\t\x3cdiv class\x3d"groups-section" style\x3d"position:absolute;width:100%;top:50px;" data-dojo-attach-point\x3d"groupsSection"\x3e\r\n\t\t\t\t\t\x3cspan\x3e${nls.groups}:\x3c/span\x3e\r\n\t\t\t\t\t\x3cselect class\x3d"groups-select" data-dojo-attach-point\x3d"groupsSelect"\x3e\r\n\t\t\t\t\t\t\x3coption value\x3d"nodata"\x3e${nls.noneGroups}\x3c/option\x3e\r\n\t\t\t\t\t\x3c/select\x3e\r\n\t\t\t\t\x3c/div\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"groupSearch" data-dojo-type\x3d"jimu/dijit/Search" data-dojo-props\x3d\'searchWhenInput:false\' data-dojo-attach-event\x3d"onSearch:_onGroupSearch" style\x3d"position:absolute;width:100%;top:0;"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"groupItemTable" data-dojo-type\x3d"jimu/dijit/_ItemTable" data-dojo-props\x3d\'types:${_itemTypes},typeKeywords:${_typeKeywords}\' style\x3d"top:85px;"\x3e\x3c/div\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\r\n\t\t\x3cdiv class\x3d"tab-content public-tab" data-dojo-attach-point\x3d"publicTabNode"\x3e\r\n\t\t\t\x3cdiv class\x3d"tab-content-main public-tab-content-main"\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"publicSearch" data-dojo-type\x3d"jimu/dijit/Search" data-dojo-props\x3d\'searchWhenInput:false\' data-dojo-attach-event\x3d"onSearch:_onPublicSearch" style\x3d"position:absolute;width:100%;top:0;"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3cdiv class\x3d"public-search-radios"\x3e\r\n\t\t\t\t\t\x3cinput data-dojo-attach-point\x3d"portalPublicRaido" type\x3d"radio" name\x3d"publicSearchRadio" class\x3d"jimu-float-leading portal-public-radio jimu-radio-btn" /\x3e\r\n\t\t\t\t\t\x3clabel data-dojo-attach-point\x3d"portalPublicLabel" class\x3d"jimu-float-leading portal-public-label"\x3ePortal\x3c/label\x3e\r\n\t\t\t\t\t\x3cinput data-dojo-attach-point\x3d"onlinePublicRaido" type\x3d"radio" name\x3d"publicSearchRadio" class\x3d"jimu-float-leading online-public-radio jimu-radio-btn" /\x3e\r\n\t\t\t\t\t\x3clabel data-dojo-attach-point\x3d"onlinePublicLabel" class\x3d"jimu-float-leading online-public-label"\x3eArcGIS Online\x3c/label\x3e\r\n\t\t\t\t\x3c/div\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"publicItemSection" class\x3d"public-item-section"\x3e\r\n\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"publicPortalItemTable" data-dojo-type\x3d"jimu/dijit/_ItemTable" data-dojo-props\x3d\'types:${_itemTypes},typeKeywords:${_typeKeywords}\'\x3e\x3c/div\x3e\r\n\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"publicOnlineItemTable" data-dojo-type\x3d"jimu/dijit/_ItemTable" data-dojo-props\x3d\'types:${_itemTypes},typeKeywords:${_typeKeywords}\'\x3e\x3c/div\x3e\r\n\t\t\t\t\x3c/div\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv class\x3d"signin-section" data-dojo-attach-point\x3d"signinSection" style\x3d"display:none;"\x3e\r\n\t\t\x3cdiv class\x3d"signin-tip"\x3e${nls.signInTip}\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e',
"url:jimu/dijit/templates/TabContainer3.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"control-node" data-dojo-attach-point\x3d"controlNode"\x3e\r\n    \x3ctable data-dojo-attach-point\x3d"controlTable" class\x3d"control-table" cellpading\x3d"0"\x3e\r\n      \x3ctbody\x3e\r\n        \x3ctr data-dojo-attach-point\x3d"tabTr"\x3e\r\n        \x3c/tr\x3e\r\n      \x3c/tbody\x3e\r\n    \x3c/table\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"container-node" data-dojo-attach-point\x3d"containerNode"\x3e\x3c/div\x3e\r\n  \x3cdiv class\x3d"tab-shelter" data-dojo-attach-point\x3d"shelter"\x3e\x3c/div\x3e\r\n\x3c/div\x3e',
"url:jimu/dijit/templates/_ItemTable.html":'\x3cdiv\x3e\r\n\t\x3cdiv class\x3d"items-section all-items-section" data-dojo-attach-point\x3d"allItemsSection"\x3e\r\n\t\t\x3cdiv class\x3d"items-table-div" data-dojo-attach-point\x3d"allItemsTableDiv" data-dojo-attach-event\x3d"onscroll:_onAllItemsSectionScroll"\x3e\r\n\t\t\t\x3ctable class\x3d"items-table" cellpadding\x3d"10" data-dojo-attach-point\x3d"allItemsTable" data-dojo-attach-event\x3d"onclick:_onItemsTableClicked"\x3e\r\n\t\t\t\t\x3ctbody data-dojo-attach-point\x3d"allItemTbody"\x3e\x3c/tbody\x3e\r\n\t\t\t\x3c/table\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cdiv data-dojo-type\x3d"jimu/dijit/LoadingIndicator" data-dojo-attach-point\x3d"allItemsShelter" data-dojo-props\x3d\'hidden:true\'\x3e\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv class\x3d"items-section filtered-items-section" data-dojo-attach-point\x3d"filteredItemsSection"\x3e\r\n\t\t\x3cdiv class\x3d"items-table-div" data-dojo-attach-point\x3d"filteredItemsTableDiv" data-dojo-attach-event\x3d"onscroll:_onFilteredItemsSectionScroll"\x3e\r\n\t\t\t\x3ctable class\x3d"items-table" cellpadding\x3d"10" data-dojo-attach-point\x3d"filteredItemsTable" data-dojo-attach-event\x3d"onclick:_onItemsTableClicked"\x3e\r\n\t\t\t\t\x3ctbody data-dojo-attach-point\x3d"filteredItemsTbody"\x3e\x3c/tbody\x3e\r\n\t\t\t\x3c/table\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d"search-none-tip-section" data-dojo-attach-point\x3d"searchNoneTipSection" style\x3d"display:none;"\x3e\r\n\t\t\t\x3cspan class\x3d"search-none-icon jimu-icon jimu-icon-error"\x3e\x3c/span\x3e\r\n\t\t\t\x3cspan class\x3d"search-none-tip jimu-state-error-text"\x3e${nls.searchNone}\x3c/span\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cdiv data-dojo-type\x3d"jimu/dijit/LoadingIndicator" data-dojo-attach-point\x3d"filteredItemShelter" data-dojo-props\x3d\'hidden:true\'\x3e\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e',
"url:builder/dijit/templates/FullScreenPopup.html":'\x3cdiv data-dojo-attach-event\x3d"onclick:_onContainerClick"\x3e\r\n  \x3cdiv class\x3d"background" data-dojo-attach-point\x3d"background"\x3e\x3c/div\x3e\r\n  \x3cdiv class\x3d"main" data-dojo-attach-point\x3d"main"\x3e\r\n    \x3cdiv class\x3d"head" data-dojo-attach-point\x3d"head"\x3e\r\n      \x3cdiv class\x3d"head-underline"\x3e\r\n        \x3cspan class\x3d"title" data-dojo-attach-point\x3d"fullscreenPopupTitle"\x3e\x3c/span\x3e\r\n        \x3cdiv class\x3d"close" data-dojo-attach-point\x3d"fullscreenPopupClose"\r\n             data-dojo-attach-event\x3d"onclick:_onCloseClick"\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"content-scroller" data-dojo-attach-point\x3d"contentScroller"\x3e\r\n      \x3cdiv class\x3d"content" data-dojo-attach-point\x3d"fullscreenPopupContent"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"btnsContainer" data-dojo-attach-point\x3d"fullscreenPopupBtnsContainer"\x3e\r\n      \x3cdiv class\x3d"btns" data-dojo-attach-point\x3d"fullscreenPopupBtns"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:dojox/form/resources/Uploader.html":'\x3cspan class\x3d"dijit dijitReset dijitInline"\r\n\t\x3e\x3cspan class\x3d"dijitReset dijitInline dijitButtonNode"\r\n\t\tdata-dojo-attach-event\x3d"ondijitclick:_onClick"\r\n\t\t\x3e\x3cspan class\x3d"dijitReset dijitStretch dijitButtonContents"\r\n\t\t\tdata-dojo-attach-point\x3d"titleNode,focusNode"\r\n\t\t\trole\x3d"button" aria-labelledby\x3d"${id}_label"\r\n\t\t\t\x3e\x3cspan class\x3d"dijitReset dijitInline dijitIcon" data-dojo-attach-point\x3d"iconNode"\x3e\x3c/span\r\n\t\t\t\x3e\x3cspan class\x3d"dijitReset dijitToggleButtonIconChar"\x3e\x26#x25CF;\x3c/span\r\n\t\t\t\x3e\x3cspan class\x3d"dijitReset dijitInline dijitButtonText"\r\n\t\t\t\tid\x3d"${id}_label"\r\n\t\t\t\tdata-dojo-attach-point\x3d"containerNode"\r\n\t\t\t\x3e\x3c/span\r\n\t\t\x3e\x3c/span\r\n\t\x3e\x3c/span\r\n\t\x3e \r\n\t\x3cinput ${!nameAttrSetting} type\x3d"${type}" value\x3d"${value}" class\x3d"dijitOffScreen" tabIndex\x3d"-1" data-dojo-attach-point\x3d"valueNode" /\x3e\r\n\x3c/span\x3e\r\n',
"url:builder/plugins/app-list/AppCatalogPage.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"app-content" data-dojo-attach-point\x3d"appContent"\x3e\r\n    \x3cdiv class\x3d"list-section" id\x3d"list-section" data-dojo-attach-point\x3d"listSection"\x3e\r\n      \x3cdiv class\x3d"list-section-body-content" id\x3d"list-section-body-content" data-dojo-attach-point\x3d"listSectionBodyContent"\x3e\r\n        \x3ctable class\x3d"list-table" data-dojo-attach-point\x3d"listTable"\x3e\r\n          \x3ctbody data-dojo-attach-point\x3d"listTableBody"\x3e\x3c/tbody\x3e\r\n        \x3c/table\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3c!--iframe style\x3d"display:none" name\x3d"downloadTargetFrame"\x3e\x3c/iframe--\x3e\r\n\x3c/div\x3e\r\n',
"url:builder/plugins/app-list/AppOperMenu.html":'\x3cdiv data-dojo-attach-event\x3d"onclick:_onMenuClick"\x3e\r\n  \x3cdiv class\x3d"up-triangle" data-dojo-attach-point\x3d"upTriangle"\x3e\x3c/div\x3e\r\n  \x3cdiv class\x3d"down-triangle" data-dojo-attach-point\x3d"downTriangle"\x3e\x3c/div\x3e\r\n\r\n  \x3cdiv class\x3d"item item-createApp-from-template" data-dojo-attach-point\x3d"createAppFromTemplate" data-dojo-attach-event\x3d"onclick:_onCreateAppFromTempalteClick"\x3e${nls.createApp}\x3c/div\x3e\r\n  \x3cdiv class\x3d"item item-editAppInfo" data-dojo-attach-point\x3d"editAppInfo" data-dojo-attach-event\x3d"onclick:_onEditClick"\x3e${nls.editAppInfo}\x3c/div\x3e\r\n  \x3cdiv class\x3d"item item-download" data-dojo-attach-point\x3d"download" data-dojo-attach-event\x3d"onclick:_onDownloadClick"\x3e\r\n    \x3ca data-dojo-attach-point\x3d"downloadLinkNode" style\x3d"display:inline-block;width:100%;height:100%;" target\x3d"downloadTargetFrame"\x3e${nls.download}\x3c/a\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"item item-duplicate" data-dojo-attach-point\x3d"duplicate" data-dojo-attach-event\x3d"onclick:_onDuplicateClick"\x3e${nls.duplicate}\x3c/div\x3e\r\n  \x3cdiv class\x3d"item item-remove" style\x3d"border-bottom-left-radius:5px;border-bottom-right-radius:5px;" data-dojo-attach-point\x3d"remove" data-dojo-attach-event\x3d"onclick:_onRemoveClick"\x3e${nls.deleteMenu}\x3c/div\x3e\r\n  \x3c!--div class\x3d"item item-agol-template" style\x3d"border-bottom-left-radius:5px;border-bottom-right-radius:5px;" data-dojo-attach-point\x3d"agolTemplate" data-dojo-attach-event\x3d"onclick:_onAgolTemplateClick"\x3e${nls.agolTemp}\x3c/div\x3e \r\n  \x3cdiv class\x3d"item item-qrcode" style\x3d"" data-dojo-attach-point\x3d"qrcode" data-dojo-attach-event\x3d"onclick:_onQRCodeClick"\x3eqrcodeeeeeee-nonls\x3c/div--\x3e \r\n\x3c/div\x3e\r\n',
"url:builder/dijit/templates/EditItemInfo.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"image-chooser-container" data-dojo-attach-point\x3d"imageChooserContainer"\x3e\r\n    \x3cdiv class\x3d"chooser-border"\x3e\r\n      \x3cdiv class\x3d"image-chooser-masker" data-dojo-attach-point\x3d"imageChooserMasker"\x3e${nls.change}\x3c/div\x3e\r\n      \x3cdiv class\x3d"image-chooser-base" id\x3d"publish-webmap-thumbnail" data-dojo-attach-point\x3d"imageChooserBase"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"app-info-edit" data-dojo-attach-point\x3d"appInfoEdit"\x3e\r\n    \x3cdiv\x3e\r\n      \x3clabel for\x3d"publish-webmap-name"\x3e\r\n        ${nls.nameLabel}\r\n      \x3c/label\x3e\r\n      \x3cinput id\x3d"publish-webmap-name" data-dojo-type\x3d"dijit/form/TextBox" trim\x3d"true" data-dojo-attach-point\x3d"appName"\r\n             maxlength\x3d"250" required\x3d"true" placeHolder\x3d"${nls.nameLabelPlaceHolder}"\r\n             class\x3d"app-info-edit-name"\x3e\r\n      \x3c/input\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv\x3e\r\n      \x3clabel for\x3d"publish-webmap-summary"\x3e\r\n        ${nls.summaryLabel}\r\n      \x3c/label\x3e\r\n      \x3ctextarea id\x3d"publish-webmap-summary" data-dojo-type\x3d"dijit/form/SimpleTextarea" rows\x3d\'5\' trim\x3d"true"\r\n                maxlength\x3d"250" required\x3d"true" style\x3d"resize:none;" class\x3d"app-info-edit-summary"\r\n                data-dojo-attach-point\x3d"publishWebmapSummary"\x3e\x3c/textarea\x3e\r\n    \x3c/div\x3e\r\n    \x3c!--\r\n    \x3cdiv\x3e\r\n      \x3clabel for\x3d"publish-webmap-tags"\x3e\r\n        ${nls.tagsLabel}\r\n      \x3c/label\x3e\r\n      \x3cdiv id\x3d"publish-webmap-tags" data-dojo-type\x3d"builder/dijit/Tags" data-dojo-attach-point\x3d"tags"\r\n           style\x3d"width:95%;max-width:95%;"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e--\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:builder/plugins/app-list/CardPageWithBigThumbnail.html":'\x3cdiv\x3e\r\n\t\x3cdiv class\x3d"card-page-content" data-dojo-attach-point\x3d"cardPageContent"\x3e\x3c/div\x3e\r\n\x3c/div\x3e\r\n',"url:builder/plugins/app-list/CardPageWithSmallThumbnail.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"app-card-page-content" id\x3d"app-card-page-content" data-dojo-attach-point\x3d"appCardPageContent"\x3e\x3c/div\x3e\r\n\x3c/div\x3e\r\n\r\n',"url:builder/plugins/app-list/css/style.css":'.app-oper-menu {position: absolute; background-color:#354052; min-width:160px; max-width: 300px; border: 1px solid #dddddd; box-shadow: 0px 0px 6px #dddddd; z-index: 1; border-radius: 5px;}.app-oper-menu.white-style {background-color:#ffffff; box-shadow: 0 0 8px rgba(0, 0, 0, 0.2)}.app-oper-menu .item{width: 100%; height: 40px; min-height: 30px; padding-left: 20px; padding-right: 20px; border: 0px solid; color: #a0acbf; font-size: 14px; cursor: pointer; line-height: 40px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;}.app-oper-menu.white-style .item{color: #333333; border-bottom: 1px solid #e4e7e7;}.app-oper-menu .item:hover{background-color: #6f7e95; color: #ffffff;}.app-oper-menu.white-style .item:hover{background-color: #f8f9fb; color: #31aacd;}.jimu-rtl .app-oper-menu .item{padding-right: 20px; padding-left: 0px;}.app-oper-menu .item.border-top-radius{border-top-left-radius:5px; border-top-right-radius:5px;}.app-oper-menu .item.border-bottom-radius{border-bottom-left-radius:5px; border-bottom-right-radius:5px;}.app-oper-menu .item a{text-decoration: none; color: inherit;}.app-oper-menu .up-triangle{position: absolute; width: 18px; height: 11px; top: -11px; right: 20px; background: url("images/up_triangle.png");}.app-oper-menu.white-style .up-triangle{background: url("images/up_triangle_white.png"); background-repeat: no-repeat; background-position: center;}.jimu-rtl .app-oper-menu .up-triangle{left: 20px; right: auto;}.app-oper-menu .down-triangle{position: absolute; width: 18px; height: 11px; right: 20px; background: url("images/down_triangle.png"); display: none; background-repeat: no-repeat;}.app-oper-menu.white-style .down-triangle{background: url("images/down_triangle_white.png"); background-repeat: no-repeat; background-position: center;}.jimu-rtl .app-oper-menu .down-triangle{left: 20px; right: auto;}.import-app .actions{margin-right:2px; position: relative; display: inline-block; background-color: #ffffff; border-radius: 2px; border: 1px solid #31aacd; height: 40px;}.import-app .actions:hover{background-color: #f4f4f4;}.jimu-rtl .import-app .actions{margin-left:2px;}.import-app .actions-label{display: inline-block; width: 120px; margin: 0 15px; padding-right: 8px; background: url("images/v_blue.png") right no-repeat; color: #31aacd; line-height: 35px; font-size: 14px; font-weight: bold; text-align: center; cursor: pointer;}.jimu-rtl .import-app .actions-label{padding-left: 8px; padding-right: 0; background-position: left center;}.import-app .actions-menu {display: none; position: absolute; top: 41px; left: 0; z-index: 9999; background: #fff; box-shadow: 0 0 4px #646464; color: #333333; border: 1px solid #dddddd; box-shadow: 0px 0px 6px #dddddd; border-radius: 5px;}.jimu-rtl .import-app .actions-menu{left: auto; right: 0;}.import-app .actions-menu-item{position: relative; width: 250px; height: 30px; overflow: hidden; white-space: nowrap; padding: 0 25px; background-color: #ffffff; border-bottom: 1px solid #e4e7e7; border-radius: 5px; font-size: 14px;}.import-app .actions-menu-item .upload-button,.import-app .actions-menu-item .import-button {line-height: 30px; padding-left: 18px; background-repeat: no-repeat; background-position: left center;}.jimu-rtl .import-app .item-import .import-button,.jimu-rtl .import-app .item-upload .upload-button{padding-right: 18px; padding-left: 0; background-position: right center;}.import-app .item-import .import-button{background-image: url("images/clouda.png"); cursor: pointer;}.import-app .item-import:hover .import-button{background-image: url("images/cloudb.png");}.import-app .item-upload .upload-button{background-image: url("images/computera.png");}.import-app .item-upload:hover .upload-button{background-image: url("images/computerb.png");}.import-app .actions-menu-item:hover{background-color: #f8f9fb; color: #31aacd;}.import-app .upload-button-div form{position:absolute; top:0; bottom:0; width:100%; opacity:0; overflow: hidden; width: 200px; filter: Alpha(opacity\x3d0); -ms-filter: "Alpha(opacity\x3d0)";}.import-app .upload-button-div form span.dijitButtonNode{filter: Alpha(opacity\x3d0); -ms-filter: "Alpha(opacity\x3d0)";}.import-app .upload-button-div form span.dijitButton input{cursor: pointer; font-size: 20em\\9\\0 !important;}.jimu-rtl .import-app .upload-button-div form span.dijitButton input{left:-3px; right:auto !important;}.fullscreen-popup-container .content .control-node {line-height: 30px; height: 30px; width: 470px;}.fullscreen-popup-container .content .control-node .jimu-item-selector .jimu-tab3\x3e.container-node {top: 62px;}.fullscreen-popup-container .control-node .control-table {font-size: 14px; color: #999; line-height: 14px;}.fullscreen-popup-container .control-node .tab-item-td {width: 100px; padding: 0 10px; border: none;}.fullscreen-popup-container .control-node .tab-item-td:last-child {display: none;}.fullscreen-popup-container .jimu-item-selector .jimu-tab3\x3e.container-node{top:54px;}.fullscreen-popup-container .jimu-item-selector .jimu-tab3\x3e.container-node .jimu-item-table{top:40px; height: 100%;}.fullscreen-popup-container .control-node .jimu-state-active {color: #d84b28; border: none; border-bottom: 2px solid #d84b28;}.fullscreen-popup-container .container-node {min-height: 400px;}.fullscreen-popup-container .jimu-item-table .items-section {bottom:70px;}.fullscreen-popup-container .container-node .jimu-item-table .items-table-div {}.fullscreen-popup-container .container-node .tab-content .jimu-search {height: 40px; margin-top: 12px;}.fullscreen-popup-container .container-node .tab-content .jimu-search .jimu-icon-search {width: 16px; height: 16px; background: url("images/search.png") center no-repeat;}.fullscreen-popup-container .container-node .tab-content .jimu-search .jimu-icon-search:hover {background: url("images/search_selected.png") center no-repeat;}.fullscreen-popup-container .container-node .tab-content .public-item-section{top: 35px;}.fullscreen-popup-container .container-node .tab-content .jimu-item-table {margin-top: 20px;}.fullscreen-popup-container .container-node .tab-content .items-table .jimu-item-table .item-thumbnail {width: 180px; height: 120px;}.fullscreen-popup-container .container-node .tab-content .jimu-item-table .item-thumbnail:hover {border: 2px solid #0f95bc; border-radius: 0px;}.fullscreen-popup-container .container-node .tab-content .jimu-item-table .item-info{left: 180px;}.fullscreen-popup-container .container-node .tab-content .jimu-item-table .items-table td {padding-bottom: 20px;}.fullscreen-popup-container .container-node .jimu-item-table .item-thumbnail{border: 2px solid transparent;}.fullscreen-popup-container .container-node .jimu-item-table .items-table .item-border{left: 2px; top: 1px; width: 176px; height: 112px;}.jimu-rtl .fullscreen-popup-container .container-node .jimu-item-table .items-table .item-border{right: 2px; left: auto;}.fullscreen-popup-container .container-node .jimu-item-table .item-border {border: 2px solid #15a4fa;;}.fullscreen-popup-container .container-node .item-info{width:180px; height:100px; margin: 10px 30px 0 10px;}.fullscreen-popup-container .container-node .item-border {border: 3px solid #15a4fa; -webkit-border-radius: 0; -moz-border-radius: 0; -o-border-radius: 0; -ms-border-radius: 0; border-radius: 0;}.fullscreen-popup-container .container-node .item-info .item-name{font-size: 18px; font-family: "Avenir Medium"; color: #333; line-height: 18px;}.fullscreen-popup-container .container-node .item-info .item-type-owner,.fullscreen-popup-container .container-node .item-info .item-date {margin-top: 10px; font-size: 12px; color: #666; line-height: 18px; overflow:hidden;}.fullscreen-popup-container .container-node .item-info .item-date{margin-top: 8px;}.app-list-page{width: 100%; height: 100%; position: relative;}.app-list-page .separate-line {height: 47px; border-bottom: 1px solid #cfd7d7;}.app-list-page .switch-app-template {top: 16px; position: relative; max-width: 1180px; min-width: 1024px; margin: 0 auto; font-size: 16px; color: #a3a3a3; font-weight: bold;}.app-list-page .switch-app-template .switch-btn-box {position: relative; display: inline-block; margin-right: 1px;}.app-list-page .switch-app-template .switch-btn {margin-right: 8px; margin-left: 8px; cursor: pointer; min-width: 80px; text-align: center;}.app-list-page .switch-app-template .switch-btn-box:hover {color: #508dca;}.app-list-page .switch-app-template .switch-btn-box.selected {color: #508dca;}.app-list-page .switch-app-template .switch-btn-box .blue-block {position: absolute; width: 100%; height: 4px; bottom: -8px;}.app-list-page .switch-app-template .switch-btn-box:hover .blue-block{background-color: #508dca;}.app-list-page .switch-app-template .switch-btn-box.selected .blue-block{background-color: #508dca;}.app-list-page .app-content{position: relative; max-width: 1180px; min-width: 1024px; margin: 50px auto; height: 100%;}.app-list-page .head-section {display: inline-block; width: 100%; padding-bottom: 30px;}.app-list-page .head-section .textPart1{margin-top: 15px; color: #6f7a8b; font-size: 18px;}.app-list-page .head-section .textPart2{margin-top: 20px; margin-left: 3px; color: #002157; font-size: 14px;}.jimu-rtl .app-list-page .head-section .textPart2{margin-right: 3px;}.app-list-page .head-section .create-button-div{height: 50px; position: relative; left: -16px; display: inline-block; padding-top: 8px;}.jimu-rtl .app-list-page .head-section .create-button-div{right: -16px;}.app-list-page .head-section .create-button{width: 140px; height: 37px; background-color: #518dca; border: 1px solid #348599; color: #ffffff; font-size: 15px; font-weight: bold; border-radius: 4px; cursor: pointer; box-shadow: 0px 1px 2px #a0acbf;} .app-list-page .app-content .list-section{position: absolute; top: 78px; width: 100%;} .app-list-page .app-content .list-section-head {table-layout: fixed; border-spacing: 0px; background-color: #6f7e95; width: 100%; height: 49px; border-top-left-radius: 4px; border-top-right-radius: 4px; box-shadow: 1px 1px 2px #a0acbf;}.app-list-page .app-content .list-section .head-content {}.app-list-page .app-content .list-section .head-content .name{width: 270px; color: #ffffff; font-size: 14px; border: 0px solid; padding-left: 25px;}.jimu-rtl .app-list-page .app-content .list-section .head-content .name{padding-right: 25px;}.app-list-page .app-content .list-section .head-content .desc{width: 300px; color: #ffffff; font-size: 14px; border: 0px solid;}.app-list-page .app-content .list-section .head-content .time{color: #ffffff; font-size: 14px; border: 0px solid; width: 150px;}.app-list-page .app-content .list-section .head-content .modified{color: #ffffff; font-size: 14px; border: 0px solid; width: 100px; display: none;}.app-list-page .app-content .list-section .head-content .creator{color: #ffffff; font-size: 14px; border: 0px solid;} .app-list-page .app-content .list-section-body{position: absolute; top: 127px; bottom: 150px; width: 100%; overflow: hidden;}.app-list-page .app-content .list-section-body-content{max-height: 100%; border: 1px solid #a0acbf; box-shadow: 1px 1px 2px #a0acbf; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px;}.app-list-page .app-content .list-table{table-layout: fixed; border-spacing: 0px; width: 100%;}.app-list-page .app-content .list-table-item{height: 40px; background-color: #fafafa;}.app-list-page .app-content .list-table-item-add{}.app-list-page .app-content .list-table-item-mouseover{background-color: #e3ecf2;}.app-list-page .app-content .list-table-next-item-mouseover td{border-bottom: 2px solid #e3ecf2;}.app-list-page .app-content .list-table-item-dbclick{background-color: #fffce4;}.app-list-page .app-content .list-table-item .item-first-td{width: 4px; vertical-align: top;}.app-list-page .app-content .list-table-item .item-second-td{width: 16px; vertical-align: top;}.app-list-page .app-content .list-table-item .item-first-td-selected {background-color: #15a4fa;}.app-list-page .app-content .list-table-item .item-end-td{width: 4px;}.app-list-page .app-content .list-table-item .item-name-td{width: 250px; vertical-align: top; border-bottom: 2px solid #e3ecf2;}.app-list-page .app-content .list-table-item .item-name{overflow: hidden; color: #596679; font-size: 14px; border: 0px solid; width: 230px; max-height: 40px; min-height: 20px; margin-top: 10px; margin-bottom: 10px; line-height: 20px; white-space: normal; word-wrap: break-word; word-break: break-word;}.app-list-page .app-content .list-table-item .item-input-name{width: 230px; height: 30px; margin-left: 10px; margin-top: 5px; border: 1px solid #999999; background-color: #ffffff}.app-list-page .app-content .list-table-item .item-desc-td{width:300px; border-bottom: 2px solid #e3ecf2;}.app-list-page .app-content .list-table-item .item-desc{overflow: hidden; color: #596979; font-size: 14px; border: 0px solid; margin-right: 5px; width: 270px; max-height: 40px; min-height: 20px; margin-top: 10px; margin-bottom: 10px; line-height: 20px; white-space: normal; word-wrap: break-word; word-break: break-word;}.app-list-page .app-content .list-table-item .item-textarea-description{width: 285px; height: 82px; border: 1px solid #999999; resize: none; margin-top: 7px; margin-bottom: 7px;}.app-list-page .app-content .list-table-item .item-time-td{vertical-align: top; border-bottom: 2px solid #e3ecf2; width: 150px;}.app-list-page .app-content .list-table-item .item-time{color: #7989a0; font-size: 14px; border: 0px solid; cursor: default; padding-top: 10px; height: 40px;}.app-list-page .app-content .list-table-item .item-modified-td{vertical-align: top; border-bottom: 2px solid #e3ecf2; width: 100px; display: none;}.app-list-page .app-content .list-table-item .item-modified{color: #7989a0; font-size: 14px; border: 0px solid; cursor: default; padding-top: 10px;}.app-list-page .app-content .list-table-item .item-creator-td{vertical-align: top; border-bottom: 2px solid #e3ecf2; width: 83px;}.app-list-page .app-content .list-table-item .item-creator{color: #7989a0; font-size: 14px; border: 0px solid; cursor: default; padding-top: 10px;}.app-list-page .app-content .list-table-item .item-loading-td{width: 14px; max-width: 14px; border-bottom: 2px solid #e3ecf2;}.app-list-page .app-content .list-table-item .item-loading-td .loading-div{display: none; width: 14px;}.app-list-page .app-content .list-table-item .item-operations-td{vertical-align: top; border-bottom: 2px solid #e3ecf2;}.app-list-page .app-content .list-table-item .item-operations-div{border: 0px solid; width: 190px; margin: 0px 0px 0px auto; color: #A0acbf; font-size: 14px;}.jimu-rtl .app-list-page .app-content .list-table-item .item-operations-div{margin: 0px auto 0px 0px;}.app-list-page .app-content .list-table-item .item-edit{border: 0px solid; margin-right: 5px; cursor: pointer; height: 40px; width: 65px; background-image: url("images/edit_icon01.png"); background-repeat: no-repeat; background-position: center left; overflow: hidden;}.jimu-rtl .app-list-page .app-content .list-table-item .item-edit{margin-left: 5px; margin-right: auto; background-position: center right;}.app-list-page .app-content .list-table-item .item-edit:hover{background-image: url("images/edit_icon02.png"); color: #518dca !important;}.jimu-rtl .app-list-page .app-content .list-table-item .item-edit-image{}.app-list-page .app-content .list-table-item .item-edit-text{line-height: 40px; padding-left: 17px; width: 100%; overflow: hidden; white-space: nowrap; text-overflow: ellipsis;}.jimu-rtl .app-list-page .app-content .list-table-item .item-edit-text{padding-right: 17px; padding-left: 0;}.app-list-page .app-content .list-table-item .item-preview{border: 0px solid; margin-right: 0px; cursor: pointer; width: 80px; height: 40px; line-height: 40px; background-image: url("images/launch2.png"); background-repeat: no-repeat; background-position: center left; overflow: hidden;}.jimu-rtl .app-list-page .app-content .list-table-item .item-preview{margin-left: 0px; margin-right: auto; background-position: center right;}.app-list-page .app-content .list-table-item .item-preview:hover{background-image: url("images/launch3.png"); color: #518dca !important;}.app-list-page .app-content .list-table-item .item-preview a{text-decoration: none; color: inherit; display: inline-block; padding-left: 19px; white-space: nowrap; text-overflow: ellipsis; overflow: hidden; width: 100%;}.jimu-rtl .app-list-page .app-content .list-table-item .item-preview a{padding-right: 24px; padding-left: 0px;}.app-list-page .app-content .list-table-item .item-preview img{margin-top: 13px; margin-right: 5px;}.jimu-rtl .app-list-page .app-content .list-table-item .item-preview img{margin-left: 13px; margin-right: auto;}.app-list-page .app-content .list-table-item .item-more{height: 40px; width: 38px; text-align: center; cursor: pointer; background-image: url("images/moreaction_icon.png"); background-repeat: no-repeat; background-position: center center; overflow: hidden;}.app-list-page .app-content .list-table-item .item-more-selected{background-image: url("images/moreaction_icon1.png") !important;}.app-list-page .app-content .list-table-item .item-more:hover{background-image: url("images/moreaction_icon1.png");}.app-list-page .app-content .list-table-item .item-more-image{margin-top: 18px;}.app-list-page .app-menu {position: absolute; background-color:#354052; width:160px; border: 1px solid #dddddd; box-shadow: 0px 0px 6px #dddddd; z-index: 1; border-radius: 5px;}.app-list-page .app-menu .item{width: 100%; min-height: 30px; padding-left: 20px; border: 0px solid; color: #a0acbf; font-size: 14px; cursor: pointer; padding-top: 12px; padding-bottom: 12px;}.jimu-rtl .app-list-page .app-menu .item{padding-right: 20px; padding-left: 0px;}.app-list-page .app-menu .item.border-top-radius{border-top-left-radius:5px; border-top-right-radius:5px;}.app-list-page .app-menu .item.border-bottom-radius{border-bottom-left-radius:5px; border-bottom-right-radius:5px;}.app-list-page .app-menu .item a{text-decoration: none; color: inherit;}.app-list-page .app-menu .up-triangle{position: absolute; width: 18px; height: 11px; top: -10px; right: 20px; background: url("images/up_triangle.png");}.jimu-rtl .app-list-page .app-menu .up-triangle{left: 20px; right: auto;}.app-list-page .app-menu .down-triangle{position: absolute; width: 18px; height: 11px; right: 20px; background: url("images/down_triangle.png"); display: none; background-repeat: no-repeat;}.jimu-rtl .app-list-page .app-menu .down-triangle{left: 20px; right: auto;}.app-list-page .app-menu .item:hover{background-color: #6f7e95; color: #ffffff;}.edit-app-info-content {color: #4d4d4d; font-size: 14px; font-family: monospace;}.edit-app-info-content .app-thumbnail {width: 200px; height: 133px; margin-top:20px; margin-left: 30px; display: inline-block;}.edit-app-info-content .app-name {margin-left: 30px;}.edit-app-info-content .app-description {margin-left: 30px; margin-top: 20px;}.edit-app-info-content .dijitTextBox {}.edit-app-info-content .dijitTextBoxFocused {border-color: #406b9b !important; box-shadow: 0 0 0 #ffffff !important;}.edit-app-info-content .dijitTextBoxHover{background-color: #ffffff; background-image: none;}.edit-app-info-content .dijitInputField {line-height: 15px !important; padding: 0 0 0 !important;}.edit-app-info-content .dijitTextBox .dijitInputInner{height: 23px;}.edit-app-info-content .app-name .name-text-box{width: 95%; padding: 2px;}.edit-app-info-content .app-description .desc-text-area{width: 95%; max-width: 95%; min-width: 95%; height: 200px; max-height: 200px; min-height: 200px; padding: 2px; resize: none;}.dj_ie8 .app-list-page .app-content .list-section-head,.dj_ie8 .app-list-page .app-content .list-section-body-content{filter: progid:dXImageTransform.Microsoft.DropShadow(color\x3d#a0acbf,offX\x3d1,offY\x3d1,positives\x3dtrue); -ms-filter: "progid:dXImageTransform.Microsoft.DropShadow(color\x3d#a0acbf,offX\x3d1,offY\x3d1,positives\x3dtrue)";}.app-catalog-page {width: 100%; height: 100%; position: relative; overflow: hidden; background-color: #f8f9fb;}.app-catalog-page .app-content {position: relative; max-width: 1300px; min-width: 1024px; margin: 0 auto; height: 100%; min-height: 340px; padding-top: 20px; padding-left: 20px; padding-right: 20px;}.app-catalog-page .app-content .list-table {table-layout: fixed; border-spacing: 0; width: 100%;}.app-catalogs.list-table-item {}.item-td {}.app-catalog-page .app-catalogs .catalog {background-color: #fff; height: 120px; width: 100%; margin: 0 auto 10px; -moz-box-shadow: 0 0 12px rgba(0, 0, 0, .1); -webkit-box-shadow: 0 0 12px rgba(0, 0, 0, .1); box-shadow: 0 0 12px rgba(0, 0, 0, .1);}.app-catalog-page .app-catalogs .catalog .content-theme {height: 100%; width: 180px; position: relative;}.app-catalog-page .app-catalogs .catalog .content-theme .content-theme-color {width: 4px; position: absolute; left: 0; height: 100%;}.jimu-rtl .app-catalog-page .app-catalogs .catalog .content-theme .content-theme-color {right: 0;}.app-catalog-page .app-catalogs .catalog .content-theme .content-theme-icon {position: absolute; top: 0px; left: 0px; width: 100%; height: 120px; background-size: 100% 100%; background-repeat: no-repeat; background-position: center; cursor: pointer;}.app-catalog-page .app-catalogs .catalog .content-theme .content-theme-flagImg{position: absolute; width: 26px; height: 22px; bottom: 10px; left: 140px; background-position: center; background-repeat: repeat; display: block; z-index: 10;}.app-catalog-page .app-catalogs .catalog .content-theme .content-theme-flagImg-2D{background-image: url("images/flag_2d.png");}.app-catalog-page .app-catalogs .catalog .content-theme .content-theme-flagImg-3D{background-image: url("images/flag_3d.png");}.jimu-rtl .app-catalog-page .app-catalogs .catalog .content-theme .content-theme-icon {left: auto; right: 0px;} .app-catalog-page .app-catalogs .catalog .content-opers {height: 100%; width: 198px; position: relative;}.app-catalog-page .app-catalogs .catalog .content-opers:before {background-color: #e5e5e5; content: ""; position: absolute; top: 20px; width: 1px; height: 80px;}.app-catalog-page .app-catalogs .catalog .content-opers-btns {margin: 44px 0 44px 20px;}.jimu-rtl .app-catalog-page .app-catalogs .catalog .content-opers-btns {margin-left: 0; margin-right: 10px;}.app-catalog-page .app-catalogs .catalog .content-opers-btn {display: inline-block; position: relative; width: 32px; height: 32px; border: 2px solid #999; -moz-border-radius: 16px; -webkit-border-radius: 16px; border-radius: 16px; margin-right: 10px;}.app-catalog-page .app-catalogs .catalog .content-opers-btn:hover {cursor: pointer; border: 2px solid #333;}.app-catalog-page .app-catalogs .catalog .content-opers-btns-download {background: url("images/download.png") center no-repeat;}.app-catalog-page .app-catalogs .catalog .content-opers-btns-download:hover {background: url("images/download_hover.png") center no-repeat;}.app-catalog-page .app-catalogs .catalog .content-opers-btns-edit {background: url("images/edit.png") center no-repeat;}.app-catalog-page .app-catalogs .catalog .content-opers-btns-edit:hover {background: url("images/edit_hover.png") center no-repeat;}.app-catalog-page .app-catalogs .catalog .content-opers-btns-launch {background: url("images/view.png") center no-repeat;}.app-catalog-page .app-catalogs .catalog .content-opers-btns-launch:hover {background: url("images/view_hover.png") center no-repeat;}.app-catalog-page .app-catalogs .catalog .content-opers-btns-more {background: url("images/more.png") center no-repeat;}.app-catalog-page .app-catalogs .catalog .content-opers-btns-more:hover {background: url("images/more_hover.png") center no-repeat;}.app-catalog-page .app-catalogs .catalog .content-opers-btns-more.content-opers-btns-more-selected {border: 2px solid #0f95bc; background: url("images/more_selected.png") center no-repeat;}.app-catalog-page .app-catalogs .catalog .content {margin: 20px 20px 20px 30px;}.catalog-content {padding: 20px 20px 20px 200px;}.jimu-rtl .catalog-content {padding-right: 180px; padding-left: 20px;}.app-catalog-page .app-catalogs .catalog .catalog-content-head {}.app-catalog-page .app-catalogs .catalog .catalog-content-head .catalog-content-appname {left: 0px; font-family: "Avenir Medium"; font-size: 14px; color: #333; display: inline-block; max-width: 550px;}.jimu-rtl .app-catalog-page .app-catalogs .catalog .catalog-content-head .catalog-content-appname {padding-right: 20px;}.app-catalog-page .app-catalogs .catalog .catalog-content-head .catalog-content-appinfo {padding-right: 20px; font-size: 12px; display: inline-block;}.jimu-rtl .app-catalog-page .app-catalogs .catalog .catalog-content-head .catalog-content-appinfo {padding-right: 0; padding-left: 20px;}.app-catalog-page .app-catalogs .catalog .catalog-content-head .catalog-content-appinfo-time {font-family: "Avenir Light"; color: #999; padding-top: 1px;}.app-catalog-page .app-catalogs .catalog .catalog-content-head .catalog-content-appinfo-owner {font-family: "Avenir Light"; color: #999; position: relative; padding: 0 20px;}.app-catalog-page .app-catalogs .catalog .catalog-content-head .catalog-content-appinfo-owner:before {background-color: #e5e5e5; content: ""; position: absolute; top: 5px; left: 10px; width: 1px; height: 10px;}.jimu-rtl .app-catalog-page .app-catalogs .catalog .catalog-content-head .catalog-content-appinfo-owner:before {content: ""; left: 0; right: 10px;}.app-catalog-page .app-catalogs .catalog .catalog-content-head .catalog-content-appinfo-owner-tip {font-family: "Avenir Light"; color: #999; line-height: 18px; display: inline-block; vertical-align: top; padding-right: 6px;}.jimu-rtl .app-catalog-page .app-catalogs .catalog .catalog-content-head .catalog-content-appinfo-owner-tip {padding-left: 6px;}.app-catalog-page .app-catalogs .catalog .catalog-content-head .catalog-content-appinfo-owner-name{display: inline-block; max-width: 100px; padding-top: 1px; height: 18px; line-height: 18px;}.app-catalog-page .app-catalogs .catalog .catalog-content-head .catalog-content-appinfo-type {font-family: "Avenir Medium"; color: #31a6e0;}.app-catalog-page .app-catalogs .catalog .catalog-content-dis {padding: 10px 20px 0 0; font-family: "Avenir Light"; font-size: 14px; color: #333; word-wrap: break-word; word-break: break-all; overflow: hidden; height: 70px;}.app-catalog-page .app-catalogs .catalog .catalog-content-dis.place-holder-class {color: #cccccc;}.app-catalog-page .app-menu {position: absolute; background-color: #354052; width: 160px; border: 1px solid #dddddd; box-shadow: 0px 0px 6px #dddddd; z-index: 1; border-radius: 5px;}.app-catalog-page .app-menu .item {width: 100%; min-height: 30px; padding-left: 20px; border: 0px solid; color: #a0acbf; font-size: 14px; cursor: pointer; padding-top: 12px; padding-bottom: 12px;}.jimu-rtl .app-catalog-page .app-menu .item {padding-right: 20px; padding-left: 0px;}.app-catalog-page .app-menu .item.border-top-radius {border-top-left-radius: 5px; border-top-right-radius: 5px;}.app-catalog-page .app-menu .item.border-bottom-radius {border-bottom-left-radius: 5px; border-bottom-right-radius: 5px;}.app-catalog-page .app-menu .item a {text-decoration: none; color: inherit;}.app-catalog-page .app-menu .up-triangle {position: absolute; width: 18px; height: 11px; top: -10px; right: 20px; background: url("images/up_triangle.png");}.jimu-rtl .app-catalog-page .app-menu .up-triangle {left: 20px; right: auto;}.app-catalog-page .app-menu .down-triangle {position: absolute; width: 18px; height: 11px; right: 20px; background: url("images/down_triangle.png"); display: none; background-repeat: no-repeat;}.jimu-rtl .app-catalog-page .app-menu .down-triangle {left: 20px; right: auto;}.app-catalog-page .app-menu .item:hover {background-color: #6f7e95; color: #ffffff;}.app-card-page {position: relative; overflow: hidden;}.app-card-page .app-card-page-content {max-width: 1300px; min-width: 1024px; margin: 20px auto 0; overflow: hidden; padding-left: 20px; min-height: 340px;}.app-card-page .app-card-box {position: relative; width: 300px; height: 170px; margin-right: 20px; margin-bottom: 20px; background-color: #ffffff; box-shadow: 0 0 10px rgba(0, 0, 0, 0.1); border-bottom-left-radius: 4px; border-bottom-right-radius: 4px;}.app-card-page .app-card-box .card {height: 100%; width: 100%;}.app-card-page .app-card-box .app-info-card {}.app-card-page .app-card-box .app-info-card .app-style-part {width: 100%; height: 4px;}.app-card-page .app-card-box .app-info-card .app-title-part {position: relative; width: 100%; height: 125px;}.app-card-page .app-card-box .app-info-card .app-title-part .app-type-div {position: absolute; background-repeat: no-repeat; background-position: center; width: 30px; height: 20px; top: 5px; right: 5px;}.jimu-rtl .app-card-page .app-card-box .app-info-card .app-title-part .app-type-div {right: auto; left: 5px;}.app-card-page .app-card-box .app-info-card .app-title-part .app-type-2d {background-image: url("images/flag_2d.png");}.app-card-page .app-card-box .app-info-card .app-title-part .app-type-3d {background-image: url("images/flag_3d.png");}.app-card-page .app-card-box .app-info-card .app-title-part .app-title-table {width: 100%; height: 100%;}.app-card-page .app-card-box .app-info-card .app-title-part .app-icon-td {width: 110px; height: 100%;}.app-card-page .app-card-box .app-info-card .app-title-part .app-icon {width: 80px; height: 80px; border: 2px solid #e5e5e5; border-radius: 10px; display: block; background-repeat: no-repeat; background-position: center; margin-left: 20px; background-size: 100% 100%;}.app-card-page .app-card-box .app-info-card .app-title-part .app-icon.default-icon {background-size: 50px 50px;}.app-card-page .app-card-box .app-info-card .app-title-part .app-title-div {line-height: 20px; max-height: 38px; overflow: hidden; white-space: normal; word-wrap: break-word; word-break: break-word; padding-right: 10px; font-family: "Avenir Medium"; font-size: 16px; color: #333333; font-weight: bold;}.app-card-page .app-card-box .app-info-card .app-title-part .app-time-div {margin-top: 20px; color: #999999; font-size: 12px; line-height: 12px;}.app-card-page .app-card-box .app-des-card {position: absolute; width: 100%; height: 125px; top: 4px; left: 0; display: block; opacity: 0;}.app-card-page .app-card-box .app-des-card .app-des-part {width: 100%; height: 100%;}.app-card-page .app-card-box .app-des-card .app-des-part .app-name{width: 100%; height: 75px;}.app-card-page .app-card-box .app-des-card .app-des-part .app-name-div{max-height: 48px; line-height: 16px; overflow: hidden; white-space: normal; word-wrap: break-word; word-break: break-word; padding-left: 20px; padding-right: 20px; font-size: 14px; color: #333333; font-family: "Avenir Medium"; font-weight: bold;}.app-card-page .app-card-box .app-des-card .app-des-part .app-info-div{padding-left: 20px; padding-right: 20px; color: #999999; font-size: 12px; line-height: 13px; margin-top: 10px; overflow: hidden;}.app-card-page .app-card-box .app-des-card .app-des-part .app-des{width: 100%; height: 50px; overflow: hidden; line-height: 16px; font-size: 12px; color: #666666; white-space: normal; word-wrap: break-word; word-break: break-word; padding-left: 20px; padding-right: 20px;}.app-card-page .app-card-box .app-operation-part {position: relative; width: 280px; height: 41px; left: 10px; border-top: 1px solid #e5e5e5;}.jimu-rtl .app-card-page .app-card-box .app-operation-part {right: 10px; left: auto;}.app-card-page .app-card-box .app-operation {background-repeat: no-repeat; background-position: center; overflow: hidden; cursor: pointer;}.app-card-page .app-card-box .download-operation {height: 40px; width: 40px; background-image: url("images/download.png");}.app-card-page .app-card-box .download-operation:hover {background-image: url("images/download_hover.png");}.app-card-page .app-card-box .edit-operation {height: 40px; width: 40px; background-image: url("images/edit.png");}.app-card-page .app-card-box .edit-operation:hover {background-image: url("images/edit_hover.png");}.app-card-page .app-card-box .launch-operation {height: 40px; width: 40px; background-image: url("images/view.png");}.app-card-page .app-card-box .launch-operation:hover {background-image: url("images/view_hover.png");}.app-card-page .app-card-box .app-operation a{display: inline-block; width: 100%; height: 100%;}.app-card-page .app-card-box .more-operation {height: 40px; width: 40px; background-image: url("images/more.png");}.app-card-page .app-card-box .more-operation:hover {background-image: url("images/more_hover.png");}.app-card-page .app-card-box .more-operation.item-more-selected {background-image: url("images/more_selected.png");}.template-card-page {position: relative; overflow: hidden;}.template-card-page .template-card-page-content {max-width: 1300px; min-width: 1024px; margin: 20px auto 0; overflow: hidden; padding-left: 20px; min-height: 340px;}.template-card-page .template-card {position: relative; width: 300px; height: 320px; margin-right: 20px; margin-bottom: 20px; background-color: #ffffff; box-shadow: 0 0 10px rgba(0, 0, 0, 0.1); border-bottom-left-radius: 4px; border-bottom-right-radius: 4px;}.template-card-page .template-card .template-type-div {position: absolute; background-repeat: no-repeat; background-position: center; width: 30px; height: 20px; top: 5px; right: 5px;}.jimu-rtl .template-card-page .template-card .template-type-div {right: auto; left: 5px;}.template-card-page .template-card .template-type-2d {background-image: url("images/flag_2d.png");}.template-card-page .template-card .template-type-3d {background-image: url("images/flag_3d.png");}.template-card-page .template-card .thumbnail-part {width: 100%; height: 180px; background-repeat: no-repeat; background-position: center;}.template-card-page .template-card .appInfo-part {width: 100%; height: 99px;}.template-card-page .template-card .appInfo-part .template-name {width: 100%; height: 40px;}.template-card-page .template-card .appInfo-part .template-name-div {max-height: 40px; line-height: 20px; overflow: hidden; white-space: normal; word-wrap: break-word; word-break: break-word; padding-left: 20px; padding-right: 20px; font-size: 18px; color: #333333; font-family: "Avenir Medium"; font-weight: bold;}.template-card-page .template-card .appInfo-part .template-des-div {width: 100%; height: 57px; overflow: hidden; line-height: 18px; font-size: 14px; color: #666666; white-space: normal; word-wrap: break-word; word-break: break-word; padding-left: 20px; padding-right: 20px;}.template-card-page .template-card .template-operation-part {position: relative; position: relative; width: 280px; height: 41px; left: 10px; border-top: 1px solid #e5e5e5;}.jimu-rtl .template-card-page .template-card .template-operation-part {right: 10px; left: auto;}.template-card-page .template-card .template-operation {background-repeat: no-repeat; background-position: center; overflow: hidden; cursor: pointer;}.template-card-page .template-card .launch-operation {height: 40px; width: 40px; background-image: url("images/view.png");}.template-card-page .template-card .launch-operation:hover {background-image: url("images/view_hover.png");}.template-card-page .template-card .edit-operation {height: 40px; width: 40px; background-image: url("images/edit.png");}.template-card-page .template-card .edit-operation:hover {background-image: url("images/edit_hover.png");}.template-card-page .template-card .edit-operation.disable {display: none;}.template-card-page .template-card .template-operation a{display: inline-block; width: 100%; height: 100%;}.template-card-page .template-card .create-app-from-template-operation{height: 40px; width: 40px; background-image: url("images/add.png");}.template-card-page .template-card .create-app-from-template-operation:hover {background-image: url("images/add_hover.png");}.template-card-page .template-card .more-operation {height: 40px; width: 40px; background-image: url("images/more.png");}.template-card-page .template-card .more-operation:hover {background-image: url("images/more_hover.png");}.template-card-page .template-card .more-operation.item-more-selected{background-image: url("images/more_selected.png");}.template-card-page .template-card .more-operation.disable {display: none;}.card-page {position: relative; overflow: hidden;}.card-page .card-page-content {max-width: 1300px; min-width: 1024px; margin: 0px auto 0; padding-top: 20px; overflow: hidden; padding-left: 20px; min-height: 340px;}.card-page .item-card {position: relative; width: 300px; height: 350px; margin-right: 20px; margin-bottom: 20px; background-color: #ffffff; box-shadow: 0 0 10px rgba(0, 0, 0, 0.1); border-bottom-left-radius: 4px; border-bottom-right-radius: 4px;}.card-page .item-card .item-type-div {position: absolute; background-repeat: no-repeat; background-position: center; width: 30px; height: 22px; bottom: 10px; right: 5px;}.jimu-rtl .card-page .item-card .item-type-div {right: auto; left: 5px;}.card-page .item-card .item-type-2d {background-image: url("images/flag_2d.png");}.card-page .item-card .item-type-3d {background-image: url("images/flag_3d.png");}.card-page .item-card .thumbnail-part {position: relative; display: inline-block; width: 100%; height: 200px; background-repeat: no-repeat; background-position: center; background-size: 100% 100%;}.card-page .item-card .appInfo-part {width: 100%; height: 109px; overflow: hidden;}.card-page .item-card .appInfo-part .item-name {width: 100%; height: 60px;}.card-page .item-card .appInfo-part .item-name-div {max-height: 39px; line-height: 20px; overflow: hidden; white-space: normal; word-wrap: break-word; word-break: break-word; padding-left: 20px; padding-right: 20px; font-size: 14px; color: #333333; font-family: "Avenir Medium"; font-weight: bold; margin-top: 9px;}.card-page .item-card .appInfo-part .item-info-div {padding-left: 20px; padding-right: 20px; color: #999999; font-size: 12px; line-height: 13px; margin-top: 12px; margin-bottom: 9px; overflow: hidden;}.card-page .item-card .appInfo-part .item-des-div {width: 100%; overflow: hidden; line-height: 22px; font-size: 12px; color: #666666; white-space: normal; word-wrap: break-word; word-break: break-word; padding-left: 20px; padding-right: 20px;}.card-page .item-card .appInfo-part .item-des-div.place-holder-class {color: #cccccc;}.card-page .item-card .item-operation-part {position: relative; position: relative; width: 280px; height: 41px; left: 10px; border-top: 1px solid #e5e5e5;}.jimu-rtl .card-page .item-card .item-operation-part {right: 10px; left: auto;}.card-page .item-card .item-operation {background-repeat: no-repeat; background-position: center; overflow: hidden; cursor: pointer;}.card-page .item-card .launch-operation {height: 40px; width: 40px; background-image: url("images/view.png");}.card-page .item-card .launch-operation:hover {background-image: url("images/view_hover.png");}.card-page .item-card .download-operation {height: 40px; width: 40px; background-image: url("images/download.png");}.card-page .item-card .download-operation:hover {background-image: url("images/download_hover.png");}.card-page .item-card .edit-operation {height: 40px; width: 40px; background-image: url("images/edit.png");}.card-page .item-card .edit-operation:hover {background-image: url("images/edit_hover.png");}.card-page .item-card .edit-operation.disable {display: none;}.card-page .item-card .item-operation a{display: inline-block; width: 100%; height: 100%;}.card-page .item-card .create-app-from-item-operation{height: 40px; width: 40px; background-image: url("images/add.png");}.card-page .item-card .create-app-from-item-operation:hover {background-image: url("images/add_hover.png");}.card-page .item-card .more-operation {height: 40px; width: 40px; background-image: url("images/more.png");}.card-page .item-card .more-operation:hover {background-image: url("images/more_hover.png");}.card-page .item-card .more-operation.item-more-selected{background-image: url("images/more_selected.png");}.card-page .item-card .more-operation.disable {display: none;}.card-page-with-small-thumbnail {position: relative; overflow: hidden;}.card-page-with-small-thumbnail .app-card-page-content {max-width: 1300px; min-width: 1024px; margin: 0 auto 0; overflow: hidden; padding-left: 20px; padding-top: 20px; min-height: 340px;}.card-page-with-small-thumbnail .app-card-box {position: relative; width: 300px; height: 220px; margin-right: 20px; margin-bottom: 20px; background-color: #ffffff; box-shadow: 0 0 10px rgba(0, 0, 0, 0.1); border-bottom-left-radius: 4px; border-bottom-right-radius: 4px;}.card-page-with-small-thumbnail .app-card-box .card {height: 100%; width: 100%;}.card-page-with-small-thumbnail .app-card-box .app-info-card {}.card-page-with-small-thumbnail .app-card-box .app-info-card .app-title-part {position: relative; width: 100%; height: 120px;}.card-page-with-small-thumbnail .app-card-box .app-info-card .app-title-part .app-type-div {position: absolute; background-repeat: no-repeat; background-position: center; width: 30px; height: 20px; top: 5px; right: 5px;}.jimu-rtl .card-page-with-small-thumbnail .app-card-box .app-info-card .app-title-part .app-type-div {right: auto; left: 5px;}.card-page-with-small-thumbnail .app-card-box .app-info-card .app-title-part .app-type-2d {background-image: url("images/flag_2d.png");}.card-page-with-small-thumbnail .app-card-box .app-info-card .app-title-part .app-type-3d {background-image: url("images/flag_3d.png");}.card-page-with-small-thumbnail .app-card-box .app-info-card .app-title-part .app-title-table {width: 100%; height: 100%;}.card-page-with-small-thumbnail .app-card-box .app-info-card .app-title-part .app-thumbnail-td {width: 155px; height: 100%;}.card-page-with-small-thumbnail .app-card-box .app-info-card .app-title-part .app-thumbnail {width: 120px; height: 80px; border-radius: 4px; display: block; background-repeat: no-repeat; background-position: center; margin-left: 20px; background-size: 100% 100%;}.jimu-rtl .card-page-with-small-thumbnail .app-card-box .app-info-card .app-title-part .app-thumbnail {margin-left: auto; margin-right: 20px;}.card-page-with-small-thumbnail .app-card-box .app-info-card .app-title-part .app-title-td {display: inline-block;}.card-page-with-small-thumbnail .app-card-box .app-info-card .app-title-part .app-title-div {line-height: 16px; max-height: 32px; overflow: hidden; white-space: normal; word-wrap: break-word; word-break: break-word; padding-right: 10px; font-family: "Avenir Medium"; font-size: 14px; color: #333333; font-weight: bold; margin-top: 25px;}.card-page-with-small-thumbnail .app-card-box .app-info-card .app-title-part .app-time-div {color: #999999; font-size: 12px; line-height: 12px; margin-top: 14px; margin-bottom: 10px;}.card-page-with-small-thumbnail .app-card-box .app-info-card .app-title-part .app-creator-div {color: #999999; font-size: 12px; line-height: 12px;}.card-page-with-small-thumbnail .app-card-box .app-info-card .app-desc-box {position: relative; width: 100%; height: 59px;}.card-page-with-small-thumbnail .app-card-box .app-info-card .app-desc-part {width: 100%; height: 42px; overflow: hidden; line-height: 18px; font-size: 12px; color: #666666; white-space: normal; word-wrap: break-word; word-break: break-word; padding-left: 20px; padding-right: 20px; padding-top: 5px;}.card-page-with-small-thumbnail .app-card-box .app-info-card .app-desc-part.place-holder-class {color: #cccccc;}.jimu-rtl .card-page-with-small-thumbnail .app-card-box .app-info-card .app-desc-part {}.card-page-with-small-thumbnail .app-card-box .app-operation-part {position: relative; width: 280px; height: 41px; left: 10px; border-top: 1px solid #e5e5e5;}.jimu-rtl .card-page-with-small-thumbnail .app-card-box .app-operation-part {right: 10px; left: auto;}.card-page-with-small-thumbnail .app-card-box .app-operation {background-repeat: no-repeat; background-position: center; overflow: hidden; cursor: pointer;}.card-page-with-small-thumbnail .app-card-box .app-operation.disable {display: none;}.card-page-with-small-thumbnail .app-card-box .download-operation {height: 40px; width: 40px; background-image: url("images/download.png");}.card-page-with-small-thumbnail .app-card-box .download-operation:hover {background-image: url("images/download_hover.png");}.card-page-with-small-thumbnail .app-card-box .edit-operation {height: 40px; width: 40px; background-image: url("images/edit.png");}.card-page-with-small-thumbnail .app-card-box .edit-operation:hover {background-image: url("images/edit_hover.png");}.card-page-with-small-thumbnail .app-card-box .launch-operation {height: 40px; width: 40px; background-image: url("images/view.png");}.card-page-with-small-thumbnail .app-card-box .launch-operation:hover {background-image: url("images/view_hover.png");}.card-page-with-small-thumbnail .app-card-box .app-operation a{display: inline-block; width: 100%; height: 100%;}.card-page-with-small-thumbnail .app-card-box .create-app-from-item-operation{height: 40px; width: 40px; background-image: url("images/add.png");}.card-page-with-small-thumbnail .app-card-box .create-app-from-item-operation:hover {background-image: url("images/add_hover.png");}.card-page-with-small-thumbnail .app-card-box .more-operation {height: 40px; width: 40px; background-image: url("images/more.png");}.card-page-with-small-thumbnail .app-card-box .more-operation:hover {background-image: url("images/more_hover.png");}.card-page-with-small-thumbnail .app-card-box .more-operation.item-more-selected {background-image: url("images/more_selected.png");}body{background-color: white;}#main-view-stack{position: absolute; top: 40px; bottom: 0; left: 0; right: 0; height: auto; overflow: hidden; background-color: #E3ECF2;}.plugin-app-list {position: relative; background-color: #f8f9fb;}.plugin-app-list .header {width: 100%; background-color: #ffffff;}.plugin-app-list .header .navigator-box{width: 100%; height: 50px; border-bottom: 1px solid #e5e5e5;}.plugin-app-list .header .navigator{position: relative; min-width: 1024px; max-width: 1300px; padding-left: 20px; padding-right: 20px; height: 50px; margin: 0 auto;}.plugin-app-list .header .navigator .filter-box{}.plugin-app-list .header .navigator .filter{margin-right:10px; height: 50px; line-height: 50px; color: #999999; font-size: 14px; min-width: 40px; text-align: center;}.jimu-rtl .plugin-app-list .header .navigator .filter{margin-left: 10px; margin-right: auto;}.plugin-app-list .header .navigator .filter.selected{color: #d84b28; border-bottom: 2px solid #d84b28;}.plugin-app-list .header .navigator .filter:hover{color: #d84b28; cursor: pointer; border-bottom: 2px solid #d84b28;}.plugin-app-list .header .navigator .sort-box{padding-left: 20px; padding-right: 20px;}.plugin-app-list .header .navigator .sort {margin-right: 15px; height: 50px; width: 16px; background-repeat: no-repeat; background-position: center; cursor: pointer;}.plugin-app-list .header .navigator .sort-box .by-modified-time {background-image: url(images/most_recent.png);}.plugin-app-list .header .navigator .sort.by-modified-time.selected{background-image: url(images/most_recent_selected.png);}.plugin-app-list .header .navigator .sort.by-modified-time:hover{background-image: url(images/most_recent_hover.png);}.plugin-app-list .header .navigator .sort-box .by-name {background-image: url(images/by_name.png);}.plugin-app-list .header .navigator .sort.by-name.selected{background-image: url(images/by_name_selected.png);}.plugin-app-list .header .navigator .sort.by-name:hover{background-image: url(images/by_name_hover.png);}.plugin-app-list .header .navigator .sort-box .by-author {background-image: url(images/by_author.png);}.plugin-app-list .header .navigator .sort.by-author.selected{background-image: url(images/by_author_selected.png);}.plugin-app-list .header .navigator .sort.by-author:hover{background-image: url(images/by_author_hover.png);}.plugin-app-list .header .navigator .search{width: 300px; border: 1px solid #e5e5e5; border-radius: 15px; margin-top: 10px; padding-left: 5px;}.plugin-app-list .header .navigator .search .search-box{height: 30px; width: 250px; border: 0 solid; border-radius: 25px;}.plugin-app-list .header .navigator .search .search-box.dijitText{border-color: #ffffff !important; box-shadow: 0 0 0 #ffffff !important; background-image: none;}.plugin-app-list .header .navigator .search .search-box.dijitTextBoxFocused {border-color: #ffffff !important; box-shadow: 0 0 0 #ffffff !important; background-image: none;}.plugin-app-list .header .navigator .search .search-box.dijitTextBoxHover{background-color: #ffffff !important; border-color: #ffffff !important; background-image: none;}.plugin-app-list .header .navigator .search .search-box .dijitInputContainer {margin: 1px 5px;}.plugin-app-list .header .navigator .search .search-box .dijitInputInner{box-shadow: 0px 0px 0px #FFF !important;}.plugin-app-list .header .navigator .search .search-box .dijitPlaceHolder{font-style: normal;}.plugin-app-list .header .navigator .search .search-btn{width: 40px; height: 30px; background-image: url(images/search.png); background-repeat: no-repeat; background-position: center center;}.plugin-app-list .switch-app-page-box {position: absolute; right: 20px; bottom: 20px; z-index: 1;}.jimu-rtl .plugin-app-list .switch-app-page-box {left: 20px; right: auto;}.plugin-app-list .switch-app-page-box.hidden {display: none;}.plugin-app-list .switch-app-page-box .switch-app-page-btn {width: 21px; height: 21px; background-repeat: no-repeat; background-position: center center; cursor: pointer;}.plugin-app-list .switch-app-page-box .switch-app-page-btn.card-page {background-image: url(images/card.png);}.plugin-app-list .switch-app-page-box .switch-app-page-btn.card-page.selected {background-image: url(images/card_selected.png);}.plugin-app-list .switch-app-page-box .switch-app-page-btn.card-page:hover {background-image: url(images/card_hover.png);}.plugin-app-list .switch-app-page-box .switch-app-page-btn.catalog-page {background-image: url(images/catalog.png);}.plugin-app-list .switch-app-page-box .switch-app-page-btn.catalog-page.selected {background-image: url(images/catalog_selected.png);}.plugin-app-list .switch-app-page-box .switch-app-page-btn.catalog-page:hover {background-image: url(images/catalog_hover.png);}.plugin-app-list .switch-app-page-box .switch-app-page-btn.card-page2 {background-image: url(images/card.png);}.plugin-app-list .switch-app-page-box .switch-app-page-btn.card-page2.selected {background-image: url(images/card_selected.png);}.plugin-app-list .switch-app-page-box .switch-app-page-btn.card-page2:hover {background-image: url(images/card_hover.png);}.plugin-app-list .operation-box{position: relative; min-width: 1024px; max-width: 1300px; margin: 0 auto; height: 60px; padding-left: 20px; padding-right: 20px; padding-top: 20px;}.plugin-app-list .create{width: 150px; height: 40px; line-height: 40px; background-color: #31aacd; color: #ffffff; font-size: 14px; font-weight: bold; border-radius: 2px; cursor: pointer; text-align: center; margin-right: 20px;}.plugin-app-list .create:hover{background-color: #1b91b3;}.jimu-rtl .plugin-app-list .create{margin-left: 20px; margin-right: auto;}.plugin-app-list .content-box {position: absolute; left: 0; right: 0; top: 50px; bottom: 0; overflow: auto;}.plugin-app-list .content {display: none; min-height: 540px;}.plugin-app-list .content.selected{display: block;}.plugin-app-list .content .app-page-box {height: 100%; display: none;}.plugin-app-list .content .app-page-box.selected {display: block;}.plugin-app-list .footer {color: #999999; font-size: 12px; overflow: hidden; text-align: center;}.plugin-app-list .footer .footer-text {padding-left: 20px; padding-right: 20px; margin: 120px auto 30px; text-align: center; display: inline-block;}.plugin-app-list .footer .separator {margin-left: 5px; margin-right: 5px; font-weight: bold;}.plugin-app-list .footer a {text-decoration: none; color: #999999;}.plugin-app-list .empty-description-box {text-align: center; margin-top: 210px;}.plugin-app-list .empty-description-box.card-page{padding-right: 20px;}.plugin-app-list .empty-description {display: inline-block; text-align: left; color: #999999; font-size: 16px; font-family: "Avenir Medium"; line-height: 26px;}.plugin-app-list .empty-description span{color: #000000;}.fullscreen-popup-container .content .image-chooser-container{width: 150px; margin: 0 auto; padding: 30px 0; text-align: center; position: relative;}.fullscreen-popup-container .content .image-chooser-container.imageChooserTemplate{width: 300px;}.fullscreen-popup-container .content .image-chooser-container .image-chooser-masker{position: absolute; display: none; background-color: rgba(0,0,0,.8); text-align: center; font-size: 14px; color: #fff; z-index: 9999; cursor:pointer;}.fullscreen-popup-container .content .image-chooser-container.imageChooserApp .image-chooser-base{width: 150px; height: 150px; background-color: #31aacd; border-radius: 50%;}.fullscreen-popup-container .content .image-chooser-container.imageChooserApp .jimu-image-chooser{width: 80px; height: 80px; background-color: #f7fafa; border-radius: 10px; margin-top: 35px;}.fullscreen-popup-container .content .image-chooser-container .image-chooser-masker.imageChooserApp{width: 150px; height: 150px; border-radius: 50%; line-height: 150px;}.fullscreen-popup-container .content .image-chooser-container.imageChooserTemplate .image-chooser-base{width: 330px; height: 230px; border: 1px solid #ccc; border-radius: 4px; background-size: 100% 100%; padding: 10px; background-color: #fff;}.fullscreen-popup-container .content .image-chooser-container.imageChooserTemplate .jimu-image-chooser{width: 100%; height: 100%;}.fullscreen-popup-container .content .image-chooser-container .image-chooser-masker.imageChooserTemplate{width: 330px; height: 230px; line-height: 210px; border-radius: 5px;}.fullscreen-popup-container .content .app-info-edit label{display: block; font-size: 14px; color:#333;}.fullscreen-popup-container .content .app-info-edit .app-info-edit-name{height:40px; line-height: 40px; width: 100%; margin: 15px 0 30px 0;}.fullscreen-popup-container .content .app-info-edit .app-info-edit-summary{height:100px; width: 100%; margin: 15px 0 30px 0; padding: 5px 10px; font-size: 12px; font-family: "Avenir Light";}.jimu-popup.jimu-popup-in-home .jimu-btn{background-color: #31aacd;}.jimu-popup.jimu-popup-in-home .jimu-btn:hover{background-color: #1b91b3;}.jimu-popup.jimu-popup-in-home .jimu-btn.jimu-btn-vacation{background-color: #FFFFFF; border: 1px solid #31aacd; color: #31aacd;}.jimu-popup.jimu-popup-in-home .jimu-btn.jimu-btn-vacation:hover{background-color: #f4f4f4;}',
"url:builder/plugins/attribute-config/Plugin.html":'\x3cdiv class\x3d"attribute-config" \x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"attributeSection"\x3e\r\n    \x3cdiv class\x3d"section jimu-float-leading header-section" data-dojo-attach-point\x3d"headerSection"\x3e\r\n      \x3cdiv class\x3d"title"\x3e\r\n        \x3cspan\x3e${nls.headerTitle}\x3c/span\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"action-text"\x3e${nls.headerDesc}\x3c/div\x3e\r\n\r\n      \x3cdiv data-dojo-attach-point\x3d"logoNodeDiv"\x3e\x3c/div\x3e\r\n\r\n      \x3cdiv class\x3d"titles jimu-float-leading"\x3e\r\n        \x3cdiv style\x3d"background-color:#fafafc;" class\x3d"title" data-dojo-attach-point\x3d"titleNodeDiv"\x3e\r\n          \x3cinput placeholder\x3d"${nls.title}" data-dojo-attach-point\x3d"titleNode" maxLength\x3d"100" class\x3d"styled-text"\x3e\r\n          \x3cspan class\x3d"label-editor" title\x3d"${nls.formatStyle}" data-dojo-attach-event\x3d"click:onTitleEditorClick"\x3e\x3c/span\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv style\x3d"background-color:#fafafc;" class\x3d"subtitle" data-dojo-attach-point\x3d"subtitleNodeDiv"\x3e\r\n          \x3cinput  placeholder\x3d"${nls.subtitle}" data-dojo-attach-point\x3d"subtitleNode" maxLength\x3d"100"  class\x3d"styled-text"\x3e\r\n          \x3cspan class\x3d"label-editor"  title\x3d"${nls.formatStyle}" data-dojo-attach-event\x3d"click:onSubtitleEditorClick"\x3e\x3c/span\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv class\x3d"section jimu-float-leading links-section" data-dojo-attach-point\x3d"linksSection"\x3e\r\n      \x3cdiv class\x3d"title"\x3e\r\n        \x3cspan\x3e${nls.linksTitle}\x3c/span\x3e\r\n      \x3c/div\x3e\r\n      \x3c!--\r\n      \x3cdiv class\x3d"attribute-content"\x3e\r\n        \x3cdiv class\x3d"list-header"\x3e\r\n          \x3cspan class\x3d"header-button add" data-dojo-attach-event\x3d"onclick: onAddLinkClick"\x3e${nls.addLink}\x3c/span\x3e\r\n          \x3cspan class\x3d"header-button edit" data-dojo-attach-event\x3d"onclick: onEditLinkClick"\x3e${nls.editLabel}\x3c/span\x3e\r\n          \x3cspan class\x3d"header-button delete" data-dojo-attach-event\x3d"onclick: onDeleteLinkClick"\x3e${nls.deleteLabel}\x3c/span\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"links-list" data-dojo-attach-point\x3d"linksListNode"\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n      --\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv class\x3d"section jimu-float-leading appId-section" data-dojo-attach-point\x3d"appIdSection" style\x3d"display:none"\x3e\r\n      \x3cdiv class\x3d"title"\x3e\r\n        \x3cspan\x3e${nls.appIdTitle}\x3c/span\x3e\r\n      \x3c/div\x3e\r\n      \x3ca target\x3d"_blank" href\x3d"http://doc.arcgis.com/en/arcgis-online/share-maps/add-items.htm#ESRI_SECTION2_20AF85308FD548B5ADBAE28836F66D3F"\x3e${nls.appIdAbout}\x3c/a\x3e\r\n      \x3cdiv class\x3d"attribute-content"\x3e\r\n        \x3cinput type\x3d"text" placeholder\x3d"AppId" data-dojo-attach-point\x3d"appIdNode" /\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv class\x3d"section jimu-float-leading" data-dojo-attach-point\x3d"useProxySection" style\x3d"display:none"\x3e\r\n      \x3cdiv class\x3d"proxy-setting" data-dojo-attach-point\x3d"useProxySetting"\x3e\x3c/div\x3e\r\n      \x3cdiv class\x3d"proxy-section" data-dojo-attach-point\x3d"proxySection"\x3e\r\n        \x3clabel class\x3d"rules-label"\x3e${nls.proxyRulesLabel}\x3c/label\x3e\r\n        \x3cdiv class\x3d"attribute-content"\x3e\r\n          \x3cdiv class\x3d"list-header"\x3e\r\n            \x3cspan class\x3d"header-button add" data-dojo-attach-event\x3d"onclick: onAddProxyRuleClick"\x3e${nls.addProxyRule}\x3c/span\x3e\r\n            \x3cspan class\x3d"header-button edit" data-dojo-attach-event\x3d"onclick: onEditProxyRuleClick"\x3e${nls.editLabel}\x3c/span\x3e\r\n            \x3cspan class\x3d"header-button delete" data-dojo-attach-event\x3d"onclick: onDeleteProxyRuleClick"\x3e${nls.deleteLabel}\x3c/span\x3e\r\n          \x3c/div\x3e\r\n          \x3cdiv class\x3d"proxy-rule-header"\x3e\r\n            \x3cdiv class\x3d"prefix"\x3e${nls.prefixHeader}\x3c/div\x3e\r\n            \x3cdiv class\x3d"proxy-url"\x3e${nls.proxyUrlHeader}\x3c/div\x3e\r\n          \x3c/div\x3e\r\n          \x3cdiv class\x3d"proxy-rule-list" data-dojo-attach-point\x3d"proxyRulesListNode"\x3e\x3c/div\x3e\r\n        \x3c/div\x3e\r\n\r\n        \x3cdiv class\x3d"always-use-proxy" data-dojo-attach-point\x3d"alwaysUseProxy"\x3e\x3c/div\x3e\r\n        \x3cdiv class\x3d"attribute-content" data-dojo-attach-point\x3d"proxyUrlSection" \x3e\r\n          \x3cinput type\x3d"text" placeholder\x3d"${nls.proxyUrl}" data-dojo-attach-point\x3d"proxyUrlNode" /\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv class\x3d"section jimu-float-leading section-appstate"\r\n         data-dojo-attach-point\x3d"appStateController"\x3e\r\n      \x3cdiv class\x3d"title"\x3e\r\n        \x3cspan\x3e${nls.appState}\x3c/span\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"action-text"\x3e\r\n        \x3cdiv class\x3d"appstate-check" data-dojo-attach-point\x3d"appStateSetting"\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3c!-- Additional Data Sources --\x3e\r\n    \x3cdiv class\x3d"section jimu-float-leading datasources"\r\n        data-dojo-attach-event\x3d"click:_openDataSourcesPage" data-dojo-attach-point\x3d"dataSourceSection"\x3e\r\n        \x3cdiv class\x3d"title"\x3e\r\n          \x3cspan\x3e${nls.customDataSource}\x3c/span\x3e\r\n          \x3cdiv class\x3d"arrow-forward feature-action jimu-float-trailing icon-arrow-right"\x3e\x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"action-text"\x3e${nls.dataSourceIntroduce}\x3c/div\x3e\r\n      \x3c/div\x3e\r\n\r\n    \x3cdiv class\x3d"section jimu-float-leading controller-loading"\r\n         data-dojo-attach-point\x3d"loadingPageController"\x3e\r\n      \x3cdiv class\x3d"title"\x3e\r\n        \x3cspan\x3e${nls.loadingPageTitle}\x3c/span\x3e\r\n        \x3cdiv class\x3d"arrow-forward feature-action jimu-float-trailing"\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"action-text"\x3e${nls.setLoadingPage}\x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv class\x3d"section jimu-float-leading controller-appproxy"\r\n         data-dojo-attach-point\x3d"appProxyController"\x3e\r\n      \x3cdiv class\x3d"title"\x3e\r\n        \x3cspan\x3e${nls.appProxy}\x3c/span\x3e\r\n        \x3cdiv class\x3d"arrow-forward feature-action jimu-float-trailing"\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"action-text"\x3e${nls.configureAppProxy}\x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\r\n  \x3cdiv class\x3d"jimu-float-leading loadingpage-section"\r\n       data-dojo-attach-point\x3d"loadingPageSection" style\x3d"display:none"\x3e\r\n    \x3cdiv class\x3d"attribute-link"\x3e\r\n      \x3cdiv class\x3d"arrow-back feature-action jimu-float-leading" data-dojo-attach-point\x3d"backController"\x3e\x3c/div\x3e\r\n      \x3cspan\x3e${nls.loadingPageTitle}\x3c/span\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"config-part"\x3e\r\n      \x3cdiv\x3e\r\n        \x3cspan class\x3d"label"\x3e${nls.backgroudColor}\x3c/span\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"bgColorPicker"\r\n             data-dojo-type\x3d"jimu/dijit/ColorPicker" title\x3d"${nls.selectBackgoundColor}"\r\n             class\x3d"bgColor-control" class\x3d"jimu-float-trailing"\r\n             data-dojo-props\x3d"showLabel:true"\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"config-part"\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"bgCheckBoxDiv"\x3e\x3c/div\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"bgUploaderDiv" class\x3d"jimu-leading-margin2"\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"bgImageChooser"\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"config-part"\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"gifCheckBoxDiv"\x3e\x3c/div\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"gifModeSection" class\x3d"jimu-leading-margin2" style\x3d"margin-top:10px;"\x3e\r\n        \x3cinput class\x3d"jimu-radio-btn" name\x3d"gifMode" type\x3d"radio" data-dojo-attach-point\x3d"selectMode"\r\n            data-dojo-attach-event\x3d"onclick: _onSelectGifMode"/\x3e\r\n        \x3clabel\x3e${nls.selectPredefinedGif}\x3c/label\x3e\x3cbr/\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"predefinedGif" class\x3d"jimu-leading-margin2" style\x3d"display:none;"\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"gifSelect" style\x3d"margin-top:10px;"\r\n                  data-dojo-type\x3d"dijit/form/Select"\x3e\r\n            \x3cspan value\x3d"0"\x3e${nls.selectGif}\x3c/span\x3e\r\n            \x3cspan value\x3d"1"\x3e\r\n              \x3cdiv style\x3d"background:#3bb6d5;height:34px;"\x3e\r\n                \x3cimg width\x3d"58" height\x3d"29" style\x3d"margin-top:2px;" src\x3d"${folderUrl}images/loading1.gif"/\x3e\r\n              \x3c/div\x3e\r\n            \x3c/span\x3e\r\n            \x3cspan value\x3d"2"\x3e\r\n              \x3cdiv style\x3d"background:#3bb6d5;height:34px;"\x3e\r\n                \x3cimg width\x3d"58" height\x3d"10" style\x3d"margin-top:12px;" src\x3d"${folderUrl}images/loading2.gif"/\x3e\r\n              \x3c/div\x3e\r\n            \x3c/span\x3e\r\n            \x3cspan value\x3d"3"\x3e\r\n              \x3cdiv style\x3d"background:#3bb6d5;height:34px;"\x3e\r\n                \x3cimg width\x3d"32" height\x3d"32" src\x3d"${folderUrl}images/loading3.gif"/\x3e\r\n              \x3c/div\x3e\r\n            \x3c/span\x3e\r\n            \x3cspan value\x3d"4"\x3e\r\n              \x3cdiv style\x3d"background:#3bb6d5;height:34px;"\x3e\r\n                \x3cimg width\x3d"34" height\x3d"34" src\x3d"${folderUrl}images/loading4.gif"/\x3e\r\n              \x3c/div\x3e\r\n            \x3c/span\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cinput class\x3d"jimu-radio-btn" name\x3d"gifMode" type\x3d"radio" data-dojo-attach-point\x3d"uploadMode"\r\n            data-dojo-attach-event\x3d"onclick: _onUploadGifMode"\r\n            style\x3d"margin-top:10px;"/\x3e\r\n        \x3clabel\x3e${nls.uploadCustomGif}\x3c/label\x3e\x3cbr/\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"customGif" class\x3d"jimu-leading-margin2" style\x3d"display:none;"\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"gifImageChooser"\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\r\n  \x3cdiv class\x3d"jimu-float-leading appproxy-section"\r\n       data-dojo-attach-point\x3d"appProxySection" style\x3d"display:none"\x3e\r\n    \x3cdiv class\x3d"attribute-link"\x3e\r\n      \x3cdiv class\x3d"arrow-back feature-action jimu-float-leading" data-dojo-attach-point\x3d"backController2"\x3e\x3c/div\x3e\r\n      \x3cspan\x3e${nls.appProxy}\x3c/span\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"sub-section" data-dojo-attach-point\x3d"mapSection"\x3e\r\n      \x3cdiv class\x3d"title"\x3e${nls.mapLayers}\x3c/div\x3e\r\n      \x3cdiv class\x3d"note"\x3e${nls.mapLayersNote}\x3c/div\x3e\r\n      \x3cdiv class\x3d"content" data-dojo-attach-point\x3d"mapProxyContent"\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"sub-section double-margin" data-dojo-attach-point\x3d"urlSection"\x3e\r\n      \x3cdiv class\x3d"title"\x3e${nls.customUrls}\x3c/div\x3e\r\n      \x3cdiv class\x3d"note"\x3e${nls.customUrlsNote}\x3c/div\x3e\r\n      \x3cdiv class\x3d"add-url-btn" data-dojo-attach-point\x3d"linkEditorNode"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"sub-section double-margin"\x3e\r\n      \x3cdiv class\x3d"title"\x3e${nls.note}\x3c/div\x3e\r\n      \x3cdiv class\x3d"note-content"\x3e\r\n        ${nls.creditsNote}\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"loadingNode" class\x3d"loading"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n\r\n  \x3cdiv class\x3d"jimu-float-leading datasources-section" style\x3d"display:none"\x3e\r\n    \x3cdiv class\x3d"datasources-link"\x3e\r\n      \x3cdiv class\x3d"arrow-back feature-action jimu-float-leading icon-arrow-back" data-dojo-attach-point\x3d"backMapController"\r\n      data-dojo-attach-event\x3d"click:_closeDataSourcesPage"\x3e\x3c/div\x3e\r\n      \x3cspan\x3e${nls.customDataSource}\x3c/span\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"additionalDataSourcesDiv" style\x3d"width: 100%;height: 100%;overflow:hidden;"\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\r\n\x3c/div\x3e\r\n',
"url:builder/plugins/attribute-config/AttrbuteLogoChooser.html":'\x3cdiv class\x3d"jimu-float-leading jimu-trailing-margin1" data-dojo-attach-point\x3d"logoContainer"\r\n data-dojo-attach-event\x3d"onmouseenter:onMouseEnterHandler"\r\n data-dojo-attach-event\x3d"onmouseleave:onMouseLeaveHandler"\x3e\r\n  \x3cdiv data-dojo-type\x3d"jimu/dijit/ImageChooser" data-dojo-attach-point\x3d"imageChooser"\r\n  data-dojo-props\x3d"cropImage:false,showSelfImg:true,stretchImg:false,goldenWidth:30,goldenHeight:30,format:[\'image/gif\',\'image/png\',\'image/jpeg\']"\x3e\x3c/div\x3e\r\n  \x3cdiv class\x3d"add-logo" data-dojo-attach-point\x3d"addLogoNode"\x3e\r\n    \x3cdiv class\x3d"image"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n\r\n  \x3cdiv class\x3d"masker-node" data-dojo-attach-point\x3d"maskerNode"\x3e\x3c/div\x3e\r\n\r\n  \x3cdiv class\x3d"remove-logo" data-dojo-attach-point\x3d"removeLogoNode" data-dojo-attach-event\x3d"onclick:onRemoveLogoHandler"\x3e\x3c/div\x3e\r\n\x3c/div\x3e',
"url:dijit/templates/TooltipDialog.html":'\x3cdiv role\x3d"alertdialog" tabIndex\x3d"-1"\x3e\r\n\t\x3cdiv class\x3d"dijitTooltipContainer" role\x3d"presentation"\x3e\r\n\t\t\x3cdiv data-dojo-attach-point\x3d"contentsNode" class\x3d"dijitTooltipContents dijitTooltipFocusNode"\x3e\r\n\t\t\t\x3cdiv data-dojo-attach-point\x3d"containerNode"\x3e\x3c/div\x3e\r\n\t\t\t${!actionBarTemplate}\r\n\t\t\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv class\x3d"dijitTooltipConnector" role\x3d"presentation" data-dojo-attach-point\x3d"connectorNode"\x3e\x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:builder/dijit/templates/SharedThemeChooserPopup.html":'\x3cdiv class\x3d"shared-theme-chooser-popup"\x3e\r\n  \x3cdiv class\x3d"btns-container"\x3e\r\n    \x3cdiv class\x3d"btn-itmes" data-dojo-attach-point\x3d"sharedItem"\x3e\r\n      \x3cdiv class\x3d"btns jimu-float-leading" data-dojo-attach-point\x3d"shared"\x3e${nls.sharedTheme}\x3c/div\x3e\r\n      \x3cdiv class\x3d"jimu-float-trailing " data-dojo-attach-point\x3d"sharedCheck"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"btn-itmes" data-dojo-attach-point\x3d"customItem"\x3e\r\n      \x3cdiv class\x3d"btns jimu-float-leading" data-dojo-attach-point\x3d"custom"\x3e${nls.custom}\x3c/div\x3e\r\n      \x3cdiv class\x3d"jimu-float-trailing " data-dojo-attach-point\x3d"customCheck"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:builder/plugins/attribute-config/CustomLogoPage.html":'\x3cdiv class\x3d"container"\x3e\r\n  \x3cdiv class\x3d"preview-container jimu-float-leading"\x3e\r\n    \x3cimg data-dojo-attach-point\x3d"image" class\x3d"image-node"/\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"noImage" class\x3d"no-image"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"separator jimu-float-leading"\x3e\x3c/div\x3e\r\n  \x3cdiv class\x3d"setting-container jimu-float-leading"\x3e\r\n    \x3cdiv class\x3d"setting-item"\x3e\r\n      \x3cdiv class\x3d"label"\x3e${nls.image}\x3c/div\x3e\r\n      \x3cdiv class\x3d"choose-image-btn" data-dojo-attach-point\x3d"chooseImageBtn"\x3e${nls.upload}\x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"setting-item"\x3e\r\n      \x3cdiv class\x3d"label"\x3e${nls.link}\x3c/div\x3e\r\n      \x3cinput type\x3d"text" class\x3d"link-text" data-dojo-type\x3d"jimu/dijit/URLInput" data-dojo-props\x3d"required:false,rest:false"\r\n        placeHolder\x3d"" data-dojo-attach-point\x3d"linkText"/\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:builder/plugins/attribute-config/MapProxyItem.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"proxy-check" data-dojo-attach-point\x3d"useProxyCheckBox"\r\n      data-dojo-type\x3d"jimu/dijit/CheckBox"\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"layer-title" title\x3d"${title}"\x3e\r\n    \x3cdiv class\x3d"layer-name"\x3e${title}\x3c/div\x3e\r\n    \x3cdiv class\x3d"access-limit"\x3e\r\n        ${nls.requestLimit}: \x3cspan data-dojo-attach-point\x3d"requestLimitNode"\x3e\x3c/span\x3e\x26nbsp;\x26nbsp;\r\n        ${nls.interval}: \x3cspan data-dojo-attach-point\x3d"intervalNode"\x3e\x3c/span\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"consumeCreditsContent" title\x3d"${nls.consumeCredits}" class\x3d"credits"\x3e\x3c/div\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"settingBtn" class\x3d"setting" title\x3d"${nls.settings}"\x3e\x3c/div\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"loading" class\x3d"loading-content"\x3e\x3c/div\x3e\r\n\r\n  \x3cdiv class\x3d"setting-dialog hidden" data-dojo-attach-point\x3d"settingDialog" title\x3d""\x3e\r\n    \x3cdiv class\x3d"input-section"\x3e\r\n      \x3cdiv class\x3d"half"\x3e\r\n        \x3cdiv class\x3d"label"\x3e${nls.requestLimit}:\x3c/div\x3e\r\n        \x3cdiv\x3e\r\n          \x3cinput data-dojo-attach-point\x3d"limitSpinner"\r\n            data-dojo-type\x3d"dijit/form/NumberSpinner"\r\n            data-dojo-props\x3d"constraints:{min:0,places:0}"\r\n            value\x3d"0" class\x3d"limit-spinner"\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"half"\x3e\r\n        \x3cdiv class\x3d"label"\x3e${nls.interval}:\x3c/div\x3e\r\n        \x3cdiv class\x3d"input"\x3e\r\n          \x3cselect data-dojo-attach-point\x3d"intervalSelect" data-dojo-type\x3d"dijit/form/Select"\r\n            class\x3d"interval-select"\x3e\r\n            \x3coption value\x3d"0"\x3e${nls.none}\x3c/option\x3e\r\n            \x3coption value\x3d"1"\x3e${nls.second}\x3c/option\x3e\r\n            \x3coption value\x3d"60"\x3e${nls.minute}\x3c/option\x3e\r\n            \x3coption value\x3d"3600"\x3e${nls.hour}\x3c/option\x3e\r\n            \x3coption value\x3d"86400"\x3e${nls.day}\x3c/option\x3e\r\n          \x3c/select\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"button-section"\x3e\r\n      \x3cdiv class\x3d"jimu-btn jimu-btn-vacation jimu-popup-action-btn jimu-float-trailing"\r\n        data-dojo-attach-point\x3d"cancelBtn"\x3e\r\n        ${nls.cancel}\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"jimu-btn jimu-popup-action-btn jimu-float-trailing jimu-trailing-margin1"\r\n          data-dojo-attach-point\x3d"okBtn"\x3e\r\n        ${nls.ok}\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:dijit/form/templates/Spinner.html":'\x3cdiv class\x3d"dijit dijitReset dijitInline dijitLeft"\r\n\tid\x3d"widget_${id}" role\x3d"presentation"\r\n\t\x3e\x3cdiv class\x3d"dijitReset dijitButtonNode dijitSpinnerButtonContainer"\r\n\t\t\x3e\x3cinput class\x3d"dijitReset dijitInputField dijitSpinnerButtonInner" type\x3d"text" tabIndex\x3d"-1" readonly\x3d"readonly" role\x3d"presentation"\r\n\t\t/\x3e\x3cdiv class\x3d"dijitReset dijitLeft dijitButtonNode dijitArrowButton dijitUpArrowButton"\r\n\t\t\tdata-dojo-attach-point\x3d"upArrowNode"\r\n\t\t\t\x3e\x3cdiv class\x3d"dijitArrowButtonInner"\r\n\t\t\t\t\x3e\x3cinput class\x3d"dijitReset dijitInputField" value\x3d"\x26#9650; " type\x3d"text" tabIndex\x3d"-1" readonly\x3d"readonly" role\x3d"presentation"\r\n\t\t\t\t\t${_buttonInputDisabled}\r\n\t\t\t/\x3e\x3c/div\r\n\t\t\x3e\x3c/div\r\n\t\t\x3e\x3cdiv class\x3d"dijitReset dijitLeft dijitButtonNode dijitArrowButton dijitDownArrowButton"\r\n\t\t\tdata-dojo-attach-point\x3d"downArrowNode"\r\n\t\t\t\x3e\x3cdiv class\x3d"dijitArrowButtonInner"\r\n\t\t\t\t\x3e\x3cinput class\x3d"dijitReset dijitInputField" value\x3d"\x26#9660; " type\x3d"text" tabIndex\x3d"-1" readonly\x3d"readonly" role\x3d"presentation"\r\n\t\t\t\t\t${_buttonInputDisabled}\r\n\t\t\t/\x3e\x3c/div\r\n\t\t\x3e\x3c/div\r\n\t\x3e\x3c/div\r\n\t\x3e\x3cdiv class\x3d\'dijitReset dijitValidationContainer\'\r\n\t\t\x3e\x3cinput class\x3d"dijitReset dijitInputField dijitValidationIcon dijitValidationInner" value\x3d"\x26#935; " type\x3d"text" tabIndex\x3d"-1" readonly\x3d"readonly" role\x3d"presentation"\r\n\t/\x3e\x3c/div\r\n\t\x3e\x3cdiv class\x3d"dijitReset dijitInputField dijitInputContainer"\r\n\t\t\x3e\x3cinput class\x3d\'dijitReset dijitInputInner\' data-dojo-attach-point\x3d"textbox,focusNode" type\x3d"${type}" data-dojo-attach-event\x3d"onkeydown:_onKeyDown"\r\n\t\t\trole\x3d"spinbutton" autocomplete\x3d"off" ${!nameAttrSetting}\r\n\t/\x3e\x3c/div\r\n\x3e\x3c/div\x3e\r\n',
"url:builder/dijit/templates/LinkEditor.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"add-url-btn" data-dojo-attach-point\x3d"addLinkBtn"\x3e\r\n    \x3cdiv class\x3d"add-icon"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"text" data-dojo-attach-point\x3d"labelNode"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"link-list" data-dojo-attach-point\x3d"linkListNode"\x3e\x3c/div\x3e\r\n\x3c/div\x3e',"url:builder/dijit/templates/LinkItemEditor.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"mask"\x3e\x3c/div\x3e\r\n  \x3cdiv class\x3d"content" data-dojo-attach-point\x3d"contentNode"\x3e\r\n    \x3cdiv class\x3d"input-section"\x3e\r\n      \x3cdiv class\x3d"label"\x3e${nls.title}:\x3c/div\x3e\r\n      \x3cdiv class\x3d"input" data-dojo-attach-point\x3d"titleNode"\x3e\x3c/div\x3e\r\n      \x3cdiv class\x3d"label"\x3e${nls.url}:\x3c/div\x3e\r\n      \x3cdiv class\x3d"input" data-dojo-attach-point\x3d"urlNode"\x3e\x3c/div\x3e\r\n      \x3cdiv class\x3d"proxy-setting" data-dojo-attach-point\x3d"proxyNode"\x3e\r\n        \x3cdiv class\x3d"col-2"\x3e\r\n          \x3cdiv class\x3d"label"\x3e${nls.requestLimit}:\x3c/div\x3e\r\n          \x3cdiv class\x3d"input" data-dojo-attach-point\x3d"limitNode"\x3e\r\n            \x3cinput data-dojo-attach-point\x3d"limitSpinner"\r\n            data-dojo-type\x3d"dijit/form/NumberSpinner"\r\n            data-dojo-props\x3d"constraints:{min:0,places:0}"\r\n            value\x3d"0" class\x3d"limit-spinner"\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"col-2"\x3e\r\n          \x3cdiv class\x3d"label"\x3e${nls.interval}:\x3c/div\x3e\r\n          \x3cdiv class\x3d"input" data-dojo-attach-point\x3d"intervalNode"\x3e\r\n            \x3cselect data-dojo-attach-point\x3d"intervalSelect" data-dojo-type\x3d"dijit/form/Select"\r\n              class\x3d"interval-select"\x3e\r\n              \x3coption value\x3d"0"\x3e${nls.none}\x3c/option\x3e\r\n              \x3coption value\x3d"1"\x3e${nls.second}\x3c/option\x3e\r\n              \x3coption value\x3d"60"\x3e${nls.minute}\x3c/option\x3e\r\n              \x3coption value\x3d"3600"\x3e${nls.hour}\x3c/option\x3e\r\n              \x3coption value\x3d"86400"\x3e${nls.day}\x3c/option\x3e\r\n            \x3c/select\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"btn-section jimu-float-trailing"\x3e\r\n      \x3cdiv class\x3d"jimu-btn" data-dojo-attach-point\x3d"okBtn"\x3e${nls.ok}\x3c/div\x3e\r\n      \x3cdiv class\x3d"jimu-btn jimu-btn-vacation" data-dojo-attach-point\x3d"cancelBtn"\x3e${nls.cancel}\x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:builder/plugins/attribute-config/dataSource/AdditionalDataSources.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"ds-header"\x3e\r\n    \x3cspan class\x3d"ds-title ds-title-box textOverFlow" title\x3d"${nls.dataSource}"\x3e${nls.dataSource}\x3c/span\x3e\r\n    \x3cdiv class\x3d"dataSource-add-box dataSource-add margin-right-10" data-dojo-attach-point\x3d"addNewDs" data-dojo-attach-event\x3d"click:_onAddNewClick" title\x3d"${nls.addNew}"\x3e\r\n      \x3cdiv class\x3d"img_add"\x3e\x3c/div\x3e\r\n      \x3cdiv class\x3d"text_add textOverFlow" title\x3d"${nls.addNew}"\x3e${nls.addNew}\x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\r\n  \r\n\r\n  \x3cdiv data-dojo-attach-point\x3d"dsOptions" class\x3d"ds-suspension ds-options ds-options-lr jimu-float-trailing hide"\x3e\r\n    \x3cdiv nowrap class\x3d"option-item textOverFlow" data-dojo-attach-point\x3d"btnAddLayer" data-dojo-attach-event\x3d"click:_onAddNewLayerClick" title\x3d"${nls.layer}"\x3e${nls.layer}\x3c/div\x3e\r\n    \x3cdiv nowrap class\x3d"option-item textOverFlow" data-dojo-attach-point\x3d"btnAddStatistics" data-dojo-attach-event\x3d"click:_onAddNewStatisticsClick" title\x3d"${nls.statistics}"\x3e${nls.statistics}\x3c/div\x3e\r\n  \x3c/div\x3e\r\n\r\n  \x3cdiv data-dojo-attach-point\x3d\'tabelHeader\'\x3e\r\n    \x3cdiv class\x3d"table-header"\x3e\r\n      \x3cdiv class\x3d"textOverFlow" title\x3d"${nls.name}"\x3e${nls.name}\x3c/div\x3e\r\n      \x3cdiv class\x3d"textOverFlow" title\x3d"${nls.type}"\x3e${nls.type}\x3c/div\x3e\r\n      \x3cdiv\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"horizontial-line"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"no-data-source-tip no-data-source-tip-box" data-dojo-attach-point\x3d"noDataSourceTip"\x3e\x3c/div\x3e\r\n  \x3cdiv class\x3d"sourcesList" data-dojo-attach-point\x3d"sourcesList"\x3e\r\n  \x3c/div\x3e\r\n\r\n  \x3cdiv style\x3d"margin-top: 30px;" data-dojo-attach-point\x3d"refreshIntervalDiv"\x3e\r\n  \x3c/div\x3e\r\n  \r\n\x3c/div\x3e',
"url:jimu/dijit/templates/QueryableLayerSource.html":'\x3cdiv\x3e\r\n\t\x3ctable class\x3d"radio-table" cellpadding\x3d"0" cellspacing\x3d"0"\x3e\r\n\t\t\x3ctbody\x3e\r\n\t\t\t\x3ctr\x3e\r\n\t\t\t\t\x3ctd class\x3d"map-td" nowrap data-dojo-attach-point\x3d"mapTd"\x3e\r\n\t\t\t\t\t\x3clabel data-dojo-attach-point\x3d"mapLabel"\x3e${nls.selectFromMap}\x3c/label\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3ctd class\x3d"portal-td" nowrap data-dojo-attach-point\x3d"portalTd"\x3e\r\n\t\t\t\t\t\x3clabel data-dojo-attach-point\x3d"portalLabel"\x3e${nls.selectFromPortal}\x3c/label\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3ctd class\x3d"url-td" nowrap data-dojo-attach-point\x3d"urlTd"\x3e\r\n\t\t\t\t\t\x3clabel data-dojo-attach-point\x3d"urlLabel"\x3e${nls.addServiceUrl}\x3c/label\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\x3c/tr\x3e\r\n\t\t\x3c/tbody\x3e\r\n\t\x3c/table\x3e\r\n\t\x3cdiv class\x3d"source-content"\x3e\r\n\t\t\x3cdiv data-dojo-attach-point\x3d"operationTip" class\x3d"operation-tip"\x3e\x3c/div\x3e\r\n\t\t\x3cdiv data-dojo-attach-point\x3d"mapDijitContainer" class\x3d"dijit-container map-dijit-container" style\x3d"display:none;"\x3e\x3c/div\x3e\r\n\t\t\x3cdiv data-dojo-attach-point\x3d"portalDijitContainer" class\x3d"dijit-container portal-dijit-container" style\x3d"display:none;"\x3e\x3c/div\x3e\r\n\t\t\x3cdiv data-dojo-attach-point\x3d"urlDijitContainer" class\x3d"dijit-container url-dijit-container" style\x3d"display:none;"\x3e\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e',
"url:jimu/dijit/templates/_TreeNode.html":'\x3cdiv class\x3d"dijitTreeNode" role\x3d"presentation"\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"rowNode" class\x3d"dijitTreeRow" role\x3d"presentation"\x3e\r\n\t\t\x3cspan data-dojo-attach-point\x3d"expandoNode" class\x3d"dijitInline dijitTreeExpando" role\x3d"presentation"\x3e\x3c/span\x3e\r\n\t\t\x3cspan data-dojo-attach-point\x3d"expandoNodeText" class\x3d"dijitExpandoText" role\x3d"presentation"\x3e\x3c/span\x3e\r\n\t\t\x3cspan data-dojo-attach-point\x3d"contentNode" class\x3d"dijitTreeContent" role\x3d"presentation"\x3e\r\n\t\t\t\x3cspan role\x3d"presentation" class\x3d"dijitInline dijitIcon dijitTreeIcon" data-dojo-attach-point\x3d"iconNode"\x3e\x3c/span\x3e\r\n\t\t\t\x3cspan data-dojo-attach-point\x3d"labelNode,focusNode" class\x3d"dijitTreeLabel" role\x3d"treeitem" tabindex\x3d"-1" aria-selected\x3d"false"\x3e\x3c/span\x3e\r\n\t\t\x3c/span\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"containerNode" class\x3d"dijitTreeNodeContainer" role\x3d"presentation" style\x3d"display: none;"\x3e\x3c/div\x3e\r\n\x3c/div\x3e',
"url:dijit/templates/TreeNode.html":'\x3cdiv class\x3d"dijitTreeNode" role\x3d"presentation"\r\n\t\x3e\x3cdiv data-dojo-attach-point\x3d"rowNode" class\x3d"dijitTreeRow" role\x3d"presentation"\r\n\t\t\x3e\x3cspan data-dojo-attach-point\x3d"expandoNode" class\x3d"dijitInline dijitTreeExpando" role\x3d"presentation"\x3e\x3c/span\r\n\t\t\x3e\x3cspan data-dojo-attach-point\x3d"expandoNodeText" class\x3d"dijitExpandoText" role\x3d"presentation"\x3e\x3c/span\r\n\t\t\x3e\x3cspan data-dojo-attach-point\x3d"contentNode"\r\n\t\t\tclass\x3d"dijitTreeContent" role\x3d"presentation"\x3e\r\n\t\t\t\x3cspan role\x3d"presentation" class\x3d"dijitInline dijitIcon dijitTreeIcon" data-dojo-attach-point\x3d"iconNode"\x3e\x3c/span\r\n\t\t\t\x3e\x3cspan data-dojo-attach-point\x3d"labelNode,focusNode" class\x3d"dijitTreeLabel" role\x3d"treeitem"\r\n\t\t\t\t   tabindex\x3d"-1" aria-selected\x3d"false" id\x3d"${id}_label"\x3e\x3c/span\x3e\r\n\t\t\x3c/span\r\n\t\x3e\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"containerNode" class\x3d"dijitTreeNodeContainer" role\x3d"presentation"\r\n\t\t style\x3d"display: none;" aria-labelledby\x3d"${id}_label"\x3e\x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:dijit/templates/Tree.html":'\x3cdiv role\x3d"tree"\x3e\r\n\t\x3cdiv class\x3d"dijitInline dijitTreeIndent" style\x3d"position: absolute; top: -9999px" data-dojo-attach-point\x3d"indentDetector"\x3e\x3c/div\x3e\r\n\t\x3cdiv class\x3d"dijitTreeExpando dijitTreeExpandoLoading" data-dojo-attach-point\x3d"rootLoadingIndicator"\x3e\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"containerNode" class\x3d"dijitTreeContainer" role\x3d"presentation"\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e\r\n',"url:jimu/dijit/templates/QueryableServiceChooserFromPortal.html":'\x3cdiv\x3e\r\n\t\x3cdiv class\x3d"selector-container" data-dojo-attach-point\x3d"selectorContainer"\x3e\x3c/div\x3e\r\n\t\x3cdiv class\x3d"service-browser-container" data-dojo-attach-point\x3d"serviceBrowserContainer"\x3e\x3c/div\x3e\r\n\t\x3cdiv class\x3d"footer"\x3e\r\n\t\t\x3cdiv class\x3d"jimu-btn jimu-float-trailing cancel jimu-btn-vacation" data-dojo-attach-point\x3d"btnCancel" data-dojo-attach-event\x3d"onclick:_onBtnCancelClicked"\x3e${nls.cancel}\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d"jimu-btn jimu-float-trailing next jimu-state-disabled" data-dojo-attach-point\x3d"btnNext" data-dojo-attach-event\x3d"onclick:_onBtnNextClicked"\x3e${nls.next}\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d"jimu-btn jimu-float-trailing ok jimu-state-disabled" data-dojo-attach-point\x3d"btnOk" data-dojo-attach-event\x3d"onclick:_onBtnOkClicked"\x3e${nls.ok}\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d"jimu-btn jimu-float-trailing back" data-dojo-attach-point\x3d"btnBack" data-dojo-attach-event\x3d"onclick:_onBtnBackClicked"\x3e${nls.back}\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e',
"url:jimu/dijit/templates/_BasicServiceChooserContent.html":'\x3cdiv\x3e\r\n\t\x3cdiv class\x3d"content-section"\x3e\r\n\t\t\x3ctable class\x3d"layout"\x3e\r\n\t\t\t\x3ccolgroup\x3e\r\n\t\t\t\t\x3ccol width\x3d"80px" align\x3d"right"\x3e\x3c/col\x3e\r\n\t\t\t\t\x3ccol width\x3d"auto"\x3e\x3c/col\x3e\r\n\t\t\t\t\x3ccol width\x3d"170px"\x3e\x3c/col\x3e\r\n\t\t\t\x3c/colgroup\x3e\r\n\t\t\t\x3ctbody\x3e\r\n\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\x3ctd class\x3d"first-td"\x3e\r\n\t\t\t\t\t\t\x3cspan\x3eURL:\x3c/span\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"urlInput" data-dojo-type\x3d"jimu/dijit/URLInput" style\x3d"width:100%;"\x3e\x3c/div\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cdiv class\x3d"jimu-btn jimu-state-disabled validate-btn jimu-float-trailing" data-dojo-attach-point\x3d"btnValidate" data-dojo-attach-event\x3d"onclick:_onBtnValidateClick"\x3e${nls.validate}\x3c/div\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\x3ctr data-dojo-attach-point\x3d"exampleTr" class\x3d"example-tr"\x3e\r\n\t\t\t\t\t\x3ctd class\x3d"first-td" style\x3d"padding-top:5px;"\x3e\r\n\t\t\t\t\t\t\x3cspan\x3e${nls.example}:\x3c/span\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd data-dojo-attach-point\x3d"exampleTd" colspan\x3d"2" style\x3d"padding-top:5px;font-style:italic;color:#ccc;"\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\x3c/tbody\x3e\r\n\t\t\x3c/table\x3e\r\n\t\t\x3cdiv class\x3d"service-browser-container" data-dojo-attach-point\x3d"serviceBrowserContainer"\x3e\r\n\t\t\t\x3cdiv class\x3d"error-section" data-dojo-attach-point\x3d"errorSection"\x3e\r\n\t\t\t\t\x3cspan class\x3d"jimu-icon jimu-icon-error"\x3e\x3c/span\x3e\r\n\t\t\t\t\x3cspan class\x3d"error-message" data-dojo-attach-point\x3d"errorNode"\x3e\x3c/span\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv class\x3d"operations"\x3e\r\n\t\t\x3cdiv class\x3d"jimu-btn jimu-float-trailing cancel jimu-btn-vacation" data-dojo-attach-event\x3d"onclick:_onBtnCancelClick"\x3e${nls.cancel}\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d"jimu-btn jimu-float-trailing jimu-state-disabled ok" data-dojo-attach-point\x3d"btnOk" data-dojo-attach-event\x3d"onclick:_onBtnOkClick"\x3e${nls.ok}\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"loading" data-dojo-type\x3d"jimu/dijit/LoadingIndicator" data-dojo-props\x3d\'hidden:true\'\x3e\x3c/div\x3e\r\n\x3c/div\x3e',
"url:builder/plugins/attribute-config/dataSource/DataSourceConfig.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"data-source-label"\x3e${nls.dataSource}\x3c/div\x3e\r\n  \x3cdiv class\x3d"source ds-text-box marginTop5" data-dojo-attach-point\x3d"sourceUrl" data-dojo-type\x3d"dijit/form/ValidationTextBox" data-dojo-props\x3d\'required:true,trim:true,disabled:true\'\x3e\x3c/div\x3e\r\n\r\n\r\n\r\n  \x3cdiv class\x3d"marginTop20 data-source-label"\x3e${nls.name}\x3c/div\x3e\r\n  \x3cdiv class\x3d"marginTop5 ds-text-box" data-dojo-props\x3d\'required:true,trim:true\' data-dojo-type\x3d"dijit/form/ValidationTextBox" data-dojo-attach-point\x3d"sourceName"\x3e\x3c/div\x3e\r\n\r\n  \x3cdiv class\x3d"marginTop20 data-source-label"\x3e${nls.sourceFilterLabel}\x3c/div\x3e\r\n\r\n  \x3cdiv class\x3d"marginTop5 flex-ltr-start"\x3e\r\n    \x3cinput class\x3d"button" type\x3d"button" value\x3d${nls.set} data-dojo-attach-point\x3d"btnSet"/\x3e\r\n    \x3cinput class\x3d"button" type\x3d"button" value\x3d${nls.config} data-dojo-attach-point\x3d"btnConfig"/\x3e\r\n    \x3cinput class\x3d"button marginLeft15" type\x3d"button" value\x3d${nls.remove} data-dojo-attach-point\x3d"btnRemove"/\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"filterExpr" class\x3d"marginLeft10 filterExpr"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n\r\n  \x3cdiv style\x3d"display: none;" class\x3d"layerOptionDiv" data-dojo-attach-point\x3d"layerOnlyOption"\x3e\r\n\r\n    \x3cdiv class\x3d"marginTop20 data-source-label"\x3e${nls.sourceFieldsLabel}\x3c/div\x3e\r\n    \x3cinput class\x3d"button visible marginTop5" type\x3d"button" value\x3d${nls.set} data-dojo-attach-event\x3d"click:_onFeaturesFieldsClick"/\x3e\r\n\r\n    \x3cdiv class\x3d"hide fieldsOption fieldsOptionDiv fields-position-lr" data-dojo-attach-point\x3d"fieldsOptionDiv"\x3e\r\n      \x3cdiv class\x3d"left-arrow transform"\x3e\x3c/div\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"fieldsOption" class\x3d"suspension"\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n\r\n    \x3cdiv class\x3d"marginTop20 data-source-label"\x3e${nls.sourceRecordsLabel}\x3c/div\x3e\r\n    \x3cdiv style\x3d"margin-top: 12px;" class\x3d"flex-ltr-start"\x3e\r\n      \x3cdiv class\x3d"data-source-sub-label"\x3e${nls.number}\x3c/div\x3e\r\n      \x3cdiv class\x3d"data-source-sub-label"\x3e${nls.orbderBy}\x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv class\x3d"marginTop5 flex-ltr-start"\x3e\r\n\r\n      \x3cdiv class\x3d"resultRecordType"\x3e\r\n        \x3cselect  data-dojo-type\x3d"dijit/form/Select" data-dojo-attach-point\x3d"resultRecordType"\x3e\r\n          \x3coption value\x3d"serviceLimitation"\x3e${nls.serviceLimitation}\x3c/option\x3e\r\n          \x3coption value\x3d"all"\x3e${nls.all}\x3c/option\x3e\r\n          \x3coption value\x3d"custom"\x3e${nls.custom}\x3c/option\x3e\r\n        \x3c/select\x3e\r\n      \x3c/div\x3e\r\n\r\n      \x3cdiv class\x3d"marginLeft5 custom-number-div"\x3e\r\n          \x3cdiv class\x3d"hide" data-dojo-attach-point\x3d"customNumberDiv"\x3e\r\n          \x3cinput type\x3d"text" class\x3d"custom-number" data-dojo-type\x3d"dijit/form/NumberTextBox" data-dojo-props\x3d\'required:true,constraints:{min:1,places:0},value:1000\' data-dojo-attach-point\x3d"customNumber"\x3e\x3c/input\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n\r\n\r\n      \x3cdiv class\x3d"marginLeft20 orderByField"\x3e\r\n        \x3cselect data-dojo-type\x3d"dijit/form/Select" data-dojo-attach-point\x3d"orderFields"\x3e\x3c/select\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"marginLeft20 order"\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"ascBtn" class\x3d"order-btn selected textOverFlow" title\x3d"${nls.ASC}"\x3e${nls.ASC}\x3c/div\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"descBtn" style\x3d"margin-left: -1px;" class\x3d"order-btn textOverFlow" title\x3d"${nls.DESC}"\x3e${nls.DESC}\x3c/div\x3e\r\n      \x3c/div\x3e\r\n\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\r\n  \x3cdiv style\x3d"display: none;" class\x3d"statisticsOptionDiv" data-dojo-attach-point\x3d"statisticsOnlyOption"\x3e\r\n    \x3cdiv class\x3d"marginTop20 data-source-label"\x3e${nls.statistics}\x3c/div\x3e\r\n    \x3cdiv style\x3d"margin-top: 12px;" class\x3d"flex-ltr-start"\x3e\r\n      \x3cdiv class\x3d"data-source-sub-label"\x3e${nls.groupBy}\x3c/div\x3e\r\n      \x3cdiv class\x3d"data-source-sub-label"\x3e${nls.sourceFieldsLabel}\x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"marginTop5 flex-ltr-start"\x3e\r\n      \x3cdiv class\x3d"groupFields" \x3e\r\n        \x3cselect data-dojo-type\x3d"dijit/form/Select" data-dojo-attach-point\x3d"groupFields"\x3e\r\n          \x3coption value\x3d"-"\x3e-\x3c/option\x3e\r\n        \x3c/select\x3e\r\n      \x3c/div\x3e\r\n      \x3cinput class\x3d"marginLeft20 button visible" type\x3d"button" value\x3d${nls.set} data-dojo-attach-point\x3d"statisticsFields" data-dojo-attach-event\x3d"click:_onStatisticsFieldsClick"/\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\r\n  \x3cdiv class\x3d"hide statisticsFieldsOption fieldsOptionDiv statisrics-fields-position-lr" data-dojo-attach-point\x3d"statisticsFieldsOptionDiv"\x3e\r\n      \x3cdiv class\x3d"left-arrow transform"\x3e\x3c/div\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"statisticsFieldsOption" class\x3d"suspension"\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n  \x3cdiv class\x3d"data-source-label marginTop20"\x3e${nls.refreshInterval}\x3c/div\x3e\r\n  \x3cdiv class\x3d"refreshContent marginTop5"\x3e\r\n    \x3cdiv data-dojo-type\x3d"jimu/dijit/CheckBox" data-dojo-attach-point\x3d"isDynamic"\x3e\x3c/div\x3e\x3clabel class\x3d"margin-left-10 textOverFlow"\x3e${nls.refreshDataEvery}\x3c/label\x3e\r\n    \x3cinput type\x3d"text" class\x3d"timeDiv" data-dojo-type\x3d"dijit/form/NumberTextBox" data-dojo-props\x3d\'required:true,constraints:{min:0},value:0.5\' data-dojo-attach-point\x3d"refreshInterval"\x3e\x3c/input\x3e\r\n     \x3cspan\x3e${nls.refreshDataEvery_Minutes}\x3c/span\x3e\r\n  \x3c/div\x3e\r\n\r\n\t\x3cdiv class\x3d"footer"\x3e\r\n    \x3cdiv class\x3d"jimu-float-leading data-preview textOverFlow" title\x3d"${nls.preview}" data-dojo-attach-point\x3d"btnPreview" data-dojo-attach-event\x3d"click:_onPreviewClick"\x3e${nls.preview}\x3c/div\x3e\r\n    \x3cdiv class\x3d"jimu-btn jimu-float-trailing cancel" data-dojo-attach-point\x3d"btnCancel"\x3e${nls.cancel}\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"jimu-btn jimu-float-trailing ok jimu-trailing-margin1" data-dojo-attach-point\x3d"btnOk"\x3e${nls.ok}\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\r\n\x3cdiv data-dojo-attach-point\x3d"loading" data-dojo-type\x3d"jimu/dijit/LoadingIndicator" data-dojo-props\x3d"hidden:true"\x3e\x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:jimu/dijit/templates/Filter.html":'\x3cdiv\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"contentSection" class\x3d"content-section"\x3e\r\n\t\t\x3cdiv data-dojo-attach-point\x3d"desktopAddSection" class\x3d"desktop-add-section hidden"\x3e\r\n\t\t\t\x3cdiv data-dojo-attach-event\x3d"click:_onBtnAddExpClick" data-dojo-attach-point\x3d"btnAddExpDesktop"\r\n\t\t\t class\x3d"add-with-icon add-expression jimu-float-leading jimu-state-disabled"\x3e\r\n\t\t\t\t\x3cspan class\x3d"jimu-icon jimu-icon-add"\x3e\x3c/span\x3e\r\n\t\t\t\t\x3cspan class\x3d"add-label"\x3e${nls.addAnotherExpression}\x3c/span\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\t\x3cdiv data-dojo-attach-event\x3d"click:_onBtnAddSetClick" data-dojo-attach-point\x3d"btnAddSetDesktop"\r\n\t\t\t class\x3d"add-with-icon add-set jimu-float-leading jimu-state-disabled"\x3e\r\n\t\t\t\t\x3cspan class\x3d"jimu-icon jimu-icon-add"\x3e\x3c/span\x3e\r\n\t\t\t\t\x3cspan class\x3d"add-label"\x3e${nls.addSet}\x3c/span\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cdiv data-dojo-attach-point\x3d"matchMsg" class\x3d"match-msg"\x3e\r\n\t\t\t\x3cspan\x3e${nls.strMatchMsgPart1}\x3c/span\x3e\r\n\t\t\t\x3cselect data-dojo-attach-point\x3d"allAnySelect"\x3e\r\n\t\t\t\t\x3coption value\x3d"AND" selected\x3e${nls.all}\x3c/option\x3e\r\n\t\t\t\t\x3coption value\x3d"OR"\x3e${nls.any}\x3c/option\x3e\r\n\t\t\t\x3c/select\x3e\r\n\t\t\t\x3cspan\x3e${nls.strMatchMsgPart2}\x3c/span\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d"allExpsBox" data-dojo-attach-point\x3d"allExpsBox"\x3e\r\n\t\t\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"errorSection" class\x3d"hidden"\x3e\r\n\t\t\x3cspan class\x3d"jimu-icon jimu-icon-error"\x3e\x3c/span\x3e\r\n\t\t\x3cspan data-dojo-attach-point\x3d"errorTip" class\x3d"error-tip"\x3e\x3c/span\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"mobileAddSection" class\x3d"mobile-add-section hidden"\x3e\r\n\t\t\x3cdiv data-dojo-attach-event\x3d"click:_onBtnAddExpClick" title\x3d"${nls.addAnotherExpression}" class\x3d"jimu-btn jimu-btn-vacation jimu-float-leading jimu-state-disabled" data-dojo-attach-point\x3d"btnAddExpMobile"\x3e\r\n\t\t\t+ ${nls.addAnotherExpression}\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cdiv data-dojo-attach-event\x3d"click:_onBtnAddSetClick" title\x3d"${nls.addSet}" class\x3d"jimu-btn jimu-btn-vacation jimu-float-leading jimu-state-disabled" data-dojo-attach-point\x3d"btnAddSetMobile"\x3e\r\n\t\t\t+ ${nls.addSet}\r\n\t\t\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"noFilterTipSection" class\x3d"no-filter-tip hidden"\x3e\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"loading" data-dojo-type\x3d"jimu/dijit/LoadingIndicator" data-dojo-props\x3d"hidden:true"\x3e\x3c/div\x3e\r\n\x3c/div\x3e',
"url:jimu/dijit/_filter/DateValueSelector.html":'\x3cdiv\x3e\r\n\t\x3cinput data-dojo-type\x3d"dijit/form/DateTextBox" data-dojo-attach-point\x3d"dateTextBox" class\x3d"custom-date-text-box" data-dojo-attach-event\x3d"change:_onDateTextBoxChanged" data-dojo-props\x3d\'required:false,trim:true\' /\x3e\r\n\t\x3cselect data-dojo-type\x3d"dijit/form/Select" data-dojo-attach-point\x3d"dateTypeSelect" class\x3d"date-type-select restrict-select-width" data-dojo-attach-event\x3d"change:_onDateTypeSelectChanged"\x3e\r\n\t\x3c/select\x3e\r\n\x3c/div\x3e',
"url:dijit/templates/Calendar.html":'\x3cdiv class\x3d"dijitCalendarContainer dijitInline" role\x3d"presentation" aria-labelledby\x3d"${id}_mddb ${id}_year"\x3e\r\n\t\x3cdiv class\x3d"dijitReset dijitCalendarMonthContainer" role\x3d"presentation"\x3e\r\n\t\t\x3cdiv class\x3d\'dijitReset dijitCalendarArrow dijitCalendarDecrementArrow\' data-dojo-attach-point\x3d"decrementMonth"\x3e\r\n\t\t\t\x3cimg src\x3d"${_blankGif}" alt\x3d"" class\x3d"dijitCalendarIncrementControl dijitCalendarDecrease" role\x3d"presentation"/\x3e\r\n\t\t\t\x3cspan data-dojo-attach-point\x3d"decreaseArrowNode" class\x3d"dijitA11ySideArrow"\x3e-\x3c/span\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d\'dijitReset dijitCalendarArrow dijitCalendarIncrementArrow\' data-dojo-attach-point\x3d"incrementMonth"\x3e\r\n\t\t\t\x3cimg src\x3d"${_blankGif}" alt\x3d"" class\x3d"dijitCalendarIncrementControl dijitCalendarIncrease" role\x3d"presentation"/\x3e\r\n\t\t\t\x3cspan data-dojo-attach-point\x3d"increaseArrowNode" class\x3d"dijitA11ySideArrow"\x3e+\x3c/span\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cdiv data-dojo-attach-point\x3d"monthNode" class\x3d"dijitInline"\x3e\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\t\x3ctable cellspacing\x3d"0" cellpadding\x3d"0" role\x3d"grid" data-dojo-attach-point\x3d"gridNode"\x3e\r\n\t\t\x3cthead\x3e\r\n\t\t\t\x3ctr role\x3d"row"\x3e\r\n\t\t\t\t${!dayCellsHtml}\r\n\t\t\t\x3c/tr\x3e\r\n\t\t\x3c/thead\x3e\r\n\t\t\x3ctbody data-dojo-attach-point\x3d"dateRowsNode" data-dojo-attach-event\x3d"ondijitclick: _onDayClick" class\x3d"dijitReset dijitCalendarBodyContainer"\x3e\r\n\t\t\t\t${!dateRowsHtml}\r\n\t\t\x3c/tbody\x3e\r\n\t\x3c/table\x3e\r\n\t\x3cdiv class\x3d"dijitReset dijitCalendarYearContainer" role\x3d"presentation"\x3e\r\n\t\t\x3cdiv class\x3d"dijitCalendarYearLabel"\x3e\r\n\t\t\t\x3cspan data-dojo-attach-point\x3d"previousYearLabelNode" class\x3d"dijitInline dijitCalendarPreviousYear" role\x3d"button"\x3e\x3c/span\x3e\r\n\t\t\t\x3cspan data-dojo-attach-point\x3d"currentYearLabelNode" class\x3d"dijitInline dijitCalendarSelectedYear" role\x3d"button" id\x3d"${id}_year"\x3e\x3c/span\x3e\r\n\t\t\t\x3cspan data-dojo-attach-point\x3d"nextYearLabelNode" class\x3d"dijitInline dijitCalendarNextYear" role\x3d"button"\x3e\x3c/span\x3e\r\n\t\t\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:dijit/form/templates/DropDownBox.html":'\x3cdiv class\x3d"dijit dijitReset dijitInline dijitLeft"\r\n\tid\x3d"widget_${id}"\r\n\trole\x3d"combobox"\r\n\taria-haspopup\x3d"true"\r\n\tdata-dojo-attach-point\x3d"_popupStateNode"\r\n\t\x3e\x3cdiv class\x3d\'dijitReset dijitRight dijitButtonNode dijitArrowButton dijitDownArrowButton dijitArrowButtonContainer\'\r\n\t\tdata-dojo-attach-point\x3d"_buttonNode" role\x3d"presentation"\r\n\t\t\x3e\x3cinput class\x3d"dijitReset dijitInputField dijitArrowButtonInner" value\x3d"\x26#9660; " type\x3d"text" tabIndex\x3d"-1" readonly\x3d"readonly" role\x3d"button presentation" aria-hidden\x3d"true"\r\n\t\t\t${_buttonInputDisabled}\r\n\t/\x3e\x3c/div\r\n\t\x3e\x3cdiv class\x3d\'dijitReset dijitValidationContainer\'\r\n\t\t\x3e\x3cinput class\x3d"dijitReset dijitInputField dijitValidationIcon dijitValidationInner" value\x3d"\x26#935; " type\x3d"text" tabIndex\x3d"-1" readonly\x3d"readonly" role\x3d"presentation"\r\n\t/\x3e\x3c/div\r\n\t\x3e\x3cdiv class\x3d"dijitReset dijitInputField dijitInputContainer"\r\n\t\t\x3e\x3cinput class\x3d\'dijitReset dijitInputInner\' ${!nameAttrSetting} type\x3d"${type}" autocomplete\x3d"off"\r\n\t\t\tdata-dojo-attach-point\x3d"textbox,focusNode" role\x3d"textbox"\r\n\t/\x3e\x3c/div\r\n\x3e\x3c/div\x3e\r\n',
"url:jimu/dijit/_filter/TwoNumbersValueProvider.html":'\x3cdiv\x3e\r\n\t\x3ctable data-dojo-attach-point\x3d"numberRangeTable" style\x3d"width:100%;border-collapse:collapse;" cellpadding\x3d"0" cellspacing\x3d"0"\x3e\r\n\t\t\x3ctbody\x3e\r\n\t\t\t\x3ctr\x3e\r\n\t\t\t\t\x3ctd style\x3d"width:40%;"\x3e\r\n\t\t\t\t\t\x3cinput data-dojo-attach-point\x3d"_dijit1" data-dojo-type\x3d"dijit/form/NumberTextBox" data-dojo-attach-event\x3d"blur:_onRangeNumberBlur" data-dojo-props\x3d\'"required":false,intermediateChanges:true,constraints: {pattern: "#####0.##########"}\' style\x3d"width:100%;" /\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3ctd style\x3d"width:20%;text-align:center;"\x3e\r\n\t\t\t\t\t\x3cspan\x3e${nls.and}\x3c/span\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3ctd style\x3d"width:40%;"\x3e\r\n\t\t\t\t\t\x3cinput data-dojo-attach-point\x3d"_dijit2" data-dojo-type\x3d"dijit/form/NumberTextBox" data-dojo-attach-event\x3d"blur:_onRangeNumberBlur" data-dojo-props\x3d\'"required":false,intermediateChanges:true,constraints: {pattern: "#####0.##########"}\' style\x3d"width:100%;" /\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\x3c/tr\x3e\r\n\t\t\x3c/tbody\x3e\r\n\t\x3c/table\x3e\r\n\x3c/div\x3e',
"url:jimu/dijit/_filter/TwoDatesValueProvider.html":'\x3cdiv\x3e\r\n\t\x3ctable data-dojo-attach-point\x3d"dateRangeTable" style\x3d"width:100%;border-collapse:collapse;" cellpadding\x3d"0" cellspacing\x3d"0"\x3e\r\n\t\t\x3ctbody\x3e\r\n\t\t\t\x3ctr\x3e\r\n\t\t\t\t\x3ctd style\x3d"width:40%;"\x3e\r\n\t\t\t\t\t\x3cinput data-dojo-attach-point\x3d"_dijit1" data-dojo-type\x3d"jimu/dijit/_filter/DateValueSelector" data-dojo-attach-event\x3d"change:_onDateValueSelectorChanged" /\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3ctd style\x3d"width:20%;text-align:center;"\x3e\r\n\t\t\t\t\t\x3cspan\x3e${nls.and}\x3c/span\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\x3cinput data-dojo-attach-point\x3d"_dijit2" data-dojo-type\x3d"jimu/dijit/_filter/DateValueSelector" data-dojo-attach-event\x3d"change:_onDateValueSelectorChanged" /\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\x3c/tr\x3e\r\n\t\t\x3c/tbody\x3e\r\n\t\x3c/table\x3e\r\n\x3c/div\x3e',
"url:jimu/dijit/_filter/ListValueProvider.html":'\x3cdiv\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"valuesSelect" data-dojo-type\x3d"dijit/form/FilteringSelect" data-dojo-props\x3d\'searchAttr:"label",required:false,intermediateChanges:true\' style\x3d"width:100%;" data-dojo-attach-event\x3d"input:_onFilteringSelectInput"\x3e\x3c/div\x3e\r\n\x3c/div\x3e',"url:jimu/dijit/_filter/NumberListValueProvider.html":'\x3cdiv\x3e\r\n    \x3ctable data-dojo-attach-point\x3d"numberListTable" style\x3d"width:100%;border-collapse:collapse;"\r\n        cellpadding\x3d"0" cellspacing\x3d"0"\x3e\r\n        \x3ctbody\x3e\r\n            \x3ctr\x3e\r\n                \x3ctd style\x3d"width:50%;"\x3e\r\n                    \x3cinput data-dojo-attach-point\x3d"_dijit1" data-dojo-type\x3d"dijit/form/NumberTextBox"\r\n                        data-dojo-props\x3d\'"required":false,constraints:{min:0,pattern:"#####0.##########"}\'\r\n                        style\x3d"width:100%;" /\x3e\r\n                \x3c/td\x3e\r\n                \x3ctd\x3e\r\n                    \x3cselect data-dojo-attach-point\x3d"rangeSelect" data-dojo-type\x3d"dijit/form/Select"\r\n                        style\x3d"width:100%;" class\x3d"operator-select dijit-form-Select restrict-select-width"\x3e\r\n                        \x3coption value\x3d"none"\x3e${nls.none}\x3c/option\x3e\r\n                    \x3c/select\x3e\r\n                \x3c/td\x3e\r\n            \x3c/tr\x3e\r\n        \x3c/tbody\x3e\r\n    \x3c/table\x3e\r\n\x3c/div\x3e',
"url:jimu/dijit/_filter/DateIsInValueProvider.html":'\x3cdiv\x3e\r\n\t\x3cselect data-dojo-type\x3d"dijit/form/Select" data-dojo-attach-point\x3d"dateTypeSelect" class\x3d"date-type-select restrict-select-width" data-dojo-attach-event\x3d"change:_onDateTypeSelectChanged"\x3e\r\n\t\x3c/select\x3e\r\n\x3c/div\x3e',"url:jimu/dijit/templates/_SingleFilter.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"settings-container"\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"fieldsSelect" data-dojo-type\x3d"dijit/form/FilteringSelect" data-dojo-props\x3d\'searchAttr:"displayName",required:true,intermediateChanges:true\' class\x3d"fields-select dijit-form-FilteringSelect"\x3e\x3c/div\x3e\r\n    \x3cselect data-dojo-attach-point\x3d"operatorsSelect" data-dojo-type\x3d"dijit/form/Select" class\x3d"operator-select dijit-form-Select restrict-select-width"\x3e\r\n      \x3coption value\x3d"none"\x3e${nls.none}\x3c/option\x3e\r\n    \x3c/select\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"attributeValueContainer" class\x3d"attribute-value-container"\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"valueProviderContainer" class\x3d"value-provider-container"\x3e\x3c/div\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"valueTypeSetNode" title\x3d"${nls.setInputType}" class\x3d"value-type-set jimu-icon jimu-icon-setting" data-dojo-attach-event\x3d"click:_onValueTypeSetClick"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"jimu-icon jimu-icon-delete" data-dojo-attach-point\x3d"btnDelete" data-dojo-attach-event\x3d"click:_destroySelf"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n\r\n  \x3cdiv class\x3d"askvalues"\x3e\r\n    \x3cdiv data-dojo-type\x3d"jimu/dijit/CheckBox" data-dojo-attach-point\x3d"cbxAskValues" label\x3d"${nls.askForValues}" class\x3d"jimu-trailing-margin6"\x3e\x3c/div\x3e\r\n    \x3cdiv data-dojo-type\x3d"jimu/dijit/CheckBox" data-dojo-attach-point\x3d"cbxCaseSensitive" label\x3d"${nls.caseSensitive}" style\x3d"display:none;"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n\r\n  \x3cdiv data-dojo-attach-point\x3d"promptSection" class\x3d"prompt"\x3e\r\n    \x3ctable data-dojo-attach-point\x3d"promptTable" cellpadding\x3d"0" cellspacing\x3d"0" class\x3d"prompt-table" style\x3d"width:100%;"\x3e\r\n      \x3ctbody\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd class\x3d"first-td"\x3e\r\n            \x3cspan\x3e${nls.prompt}\x3c/span\x3e\r\n          \x3c/td\x3e\r\n          \x3ctd class\x3d"second-td"\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"promptTB" data-dojo-type\x3d"dijit/form/ValidationTextBox" data-dojo-props\x3d"required:true,trim:true" style\x3d"width:257px;" class\x3d"dijit-form-ValidationTextBox" \x3e\x3c/div\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd class\x3d"first-td"\x3e\r\n            \x3cspan\x3e${nls.hint}\x3c/span\x3e\r\n          \x3c/td\x3e\r\n          \x3ctd class\x3d"second-td"\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"hintTB" data-dojo-type\x3d"dijit/form/ValidationTextBox" data-dojo-props\x3d"trim:true" style\x3d"width:257px;" class\x3d"dijit-form-ValidationTextBox" \x3e\x3c/div\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr data-dojo-attach-point\x3d"cascadeTr" class\x3d"cascade-tr"\x3e\r\n          \x3ctd class\x3d"first-td"\x3e\r\n            \x3cdiv style\x3d"margin-bottom:5px;"\x3e${nls.listValues}:\x3c/div\x3e\r\n          \x3c/td\x3e\r\n          \x3ctd class\x3d"second-td"\x3e\r\n            \x3cselect data-dojo-type\x3d"dijit/form/Select" data-dojo-attach-point\x3d"cascadeSelect" class\x3d"cascade-select restrict-select-width" style\x3d"width:100%;"\x3e\r\n              \x3coption value\x3d"none"\x3e${nls.noneCascadeFilterTip}\x3c/option\x3e\r\n              \x3coption value\x3d"previous"\x3e${nls.previousCascadeFilterTip}\x3c/option\x3e\r\n              \x3coption value\x3d"all"\x3e${nls.allCascadeFilterTip}\x3c/option\x3e\r\n            \x3c/select\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n      \x3c/tbody\x3e\r\n    \x3c/table\x3e\r\n  \x3c/div\x3e\r\n\r\n  \x3cdiv class\x3d"value-type-popup" data-dojo-attach-point\x3d"valueTypePopupNode"\x3e\r\n    \x3cul\x3e\r\n      \x3cli data-type\x3d"value" data-dojo-attach-event\x3d"click:_onValueTypeClick"\x3e\x3cspan\x3e${nls.value}\x3c/span\x3e\x3cspan\x3e\x3c/span\x3e\x3c/li\x3e\r\n      \x3cli data-type\x3d"field" data-dojo-attach-event\x3d"click:_onValueTypeClick"\x3e\x3cspan\x3e${nls.field}\x3c/span\x3e\x3cspan\x3e\x3c/span\x3e\x3c/li\x3e\r\n      \x3cli data-type\x3d"unique" data-dojo-attach-event\x3d"click:_onValueTypeClick"\x3e\x3cspan\x3e${nls.unique}\x3c/span\x3e\x3cspan\x3e\x3c/span\x3e\x3c/li\x3e\r\n    \x3c/ul\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:jimu/dijit/templates/_FilterSet.html":'\x3cdiv\x3e\r\n\t\x3ctable class\x3d"header-table" cellspacing\x3d"0" cellpadding\x3d"0"\x3e\r\n\t\t\x3ctbody\x3e\r\n\t\t\t\x3ctr\x3e\r\n\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\x3cdiv\x3e\r\n\t\t\t\t\t\t\x3cspan\x3e${nls.strMatchMsgPart1}\x3c/span\x3e\r\n\t\t\t\t\t\t\x3cselect data-dojo-attach-point\x3d"allAnySelect"\x3e\r\n\t\t\t\t\t\t\t\x3coption value\x3d"AND" selected\x3e${nls.all}\x3c/option\x3e\r\n\t\t\t\t\t\t\t\x3coption value\x3d"OR"\x3e${nls.any}\x3c/option\x3e\r\n\t\t\t\t\t\t\x3c/select\x3e\r\n\t\t\t\t\t\t\x3cspan\x3e${nls.strMatchMsgPart2}\x3c/span\x3e\r\n\t\t\t\t\t\x3c/div\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3ctd style\x3d"width:15px;padding-right:10px;"\x3e\r\n\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"btnDelete" data-dojo-attach-event\x3d"onclick:_destroySelf"\r\n\t\t\t\t\t class\x3d"jimu-icon jimu-icon-delete"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3ctd style\x3d"width:15px;padding-right:14px;"\x3e\r\n\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"btnAdd" class\x3d"jimu-icon jimu-icon-add"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\x3c/tr\x3e\r\n\t\t\x3c/tbody\x3e\r\n\t\x3c/table\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"allExpsBox"\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e',
"url:builder/plugins/attribute-config/dataSource/DataFields.html":'\x3cdiv\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"fieldsContent" class\x3d"fields-content"\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv class\x3d"operation"\x3e\r\n\t\t\x3cdiv data-dojo-attach-point\x3d"btnUp" data-dojo-attach-event\x3d"onclick:_moveUp" class\x3d"jimu-icon jimu-icon-up" title\x3d"${nls.moveUp}"\x3e\x3c/div\x3e\r\n\t\t\x3cdiv data-dojo-attach-point\x3d"btnDown" data-dojo-attach-event\x3d"onclick:_moveDown" class\x3d"jimu-icon jimu-icon-down" title\x3d"${nls.moveDown}"\x3e\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e',
"url:builder/dijit/templates/RefreshInterval.html":'\x3cdiv class\x3d"map-option refresh-option"\x3e\r\n  \x3cdiv class\x3d"option-title"\x3e${nls.setRefreshInterval}\x3c/div\x3e\r\n  \x3cp class\x3d"option-statement" style\x3d"font-family:\'Avenir Light\';"\x3e${nls.refreshTip}\x3c/p\x3e\r\n  \x3cselect data-dojo-attach-point\x3d"refreshSelect" data-dojo-type\x3d"dijit/form/Select" class\x3d"refresh-select dijit-form-Select restrict-select-width" style\x3d"width:100%; box-sizing:border-box;"\x3e\r\n    \x3coption value\x3d"defaultRefresh"\x3e${defaultRefreshTip}\x3c/option\x3e\r\n    \x3coption value\x3d"singleRefresh"\x3e${singleRefreshTip}\x3c/option\x3e\r\n  \x3c/select\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"refreshIntervalInputs" class\x3d"refresh-interval-inputs hidden"\x3e\r\n    \x3cinput data-dojo-attach-point\x3d"refreshIntervalNTB" data-dojo-type\x3d"dijit/form/NumberTextBox" data-dojo-props\x3d\'required:true,constraints:{min:0,pattern:"#####0.##########"},value:0.5\' class\x3d"jimu-float-leading" style\x3d"width:55px;" /\x3e\r\n    \x3cdiv class\x3d"minutes-text jimu-float-leading"\x3e${nls.minutes}\x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:dojox/widget/ColorPicker/ColorPicker.html":'\x3ctable class\x3d"dojoxColorPicker" dojoAttachEvent\x3d"onkeypress: _handleKey" cellpadding\x3d"0" cellspacing\x3d"0" role\x3d"presentation"\x3e\r\n\t\x3ctr\x3e\r\n\t\t\x3ctd valign\x3d"top" class\x3d"dojoxColorPickerRightPad"\x3e\r\n\t\t\t\x3cdiv class\x3d"dojoxColorPickerBox"\x3e\r\n\t\t\t\t\x3c!-- Forcing ABS in style attr due to dojo DND issue with not picking it up form the class. --\x3e\r\n\t\t\t\t\x3cimg title\x3d"${saturationPickerTitle}" alt\x3d"${saturationPickerTitle}" class\x3d"dojoxColorPickerPoint" src\x3d"${_pickerPointer}" tabIndex\x3d"0" dojoAttachPoint\x3d"cursorNode" style\x3d"position: absolute; top: 0px; left: 0px;"\x3e\r\n\t\t\t\t\x3cimg role\x3d"presentation" alt\x3d"" dojoAttachPoint\x3d"colorUnderlay" dojoAttachEvent\x3d"onclick: _setPoint, onmousedown: _stopDrag" class\x3d"dojoxColorPickerUnderlay" src\x3d"${_underlay}" ondragstart\x3d"return false"\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\x3c/td\x3e\r\n\t\t\x3ctd valign\x3d"top" class\x3d"dojoxColorPickerRightPad"\x3e\r\n\t\t\t\x3cdiv class\x3d"dojoxHuePicker"\x3e\r\n\t\t\t\t\x3c!-- Forcing ABS in style attr due to dojo DND issue with not picking it up form the class. --\x3e\r\n\t\t\t\t\x3cimg dojoAttachPoint\x3d"hueCursorNode" tabIndex\x3d"0" class\x3d"dojoxHuePickerPoint" title\x3d"${huePickerTitle}" alt\x3d"${huePickerTitle}" src\x3d"${_huePickerPointer}" style\x3d"position: absolute; top: 0px; left: 0px;"\x3e\r\n\t\t\t\t\x3cdiv class\x3d"dojoxHuePickerUnderlay" dojoAttachPoint\x3d"hueNode"\x3e\r\n\t\t\t\t    \x3cimg role\x3d"presentation" alt\x3d"" dojoAttachEvent\x3d"onclick: _setHuePoint, onmousedown: _stopDrag" src\x3d"${_hueUnderlay}"\x3e\r\n\t\t\t\t\x3c/div\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\x3c/td\x3e\r\n\t\t\x3ctd valign\x3d"top"\x3e\r\n\t\t\t\x3ctable cellpadding\x3d"0" cellspacing\x3d"0" role\x3d"presentation"\x3e\r\n\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\x3ctd valign\x3d"top" class\x3d"dojoxColorPickerPreviewContainer"\x3e\r\n\t\t\t\t\t\t\x3ctable cellpadding\x3d"0" cellspacing\x3d"0" role\x3d"presentation"\x3e\r\n\t\t\t\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\t\t\t\x3ctd valign\x3d"top" class\x3d"dojoxColorPickerRightPad"\x3e\r\n\t\t\t\t\t\t\t\t\t\x3cdiv dojoAttachPoint\x3d"previewNode" class\x3d"dojoxColorPickerPreview"\x3e\x3c/div\x3e\r\n\t\t\t\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\t\t\t\x3ctd valign\x3d"top"\x3e\r\n\t\t\t\t\t\t\t\t\t\x3cdiv dojoAttachPoint\x3d"safePreviewNode" class\x3d"dojoxColorPickerWebSafePreview"\x3e\x3c/div\x3e\r\n\t\t\t\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\t\t\x3c/table\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\x3ctd valign\x3d"bottom"\x3e\r\n\t\t\t\t\t\t\x3ctable class\x3d"dojoxColorPickerOptional" cellpadding\x3d"0" cellspacing\x3d"0" role\x3d"presentation"\x3e\r\n\t\t\t\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\t\t\t\x3cdiv class\x3d"dijitInline dojoxColorPickerRgb" dojoAttachPoint\x3d"rgbNode"\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3ctable cellpadding\x3d"1" cellspacing\x3d"1" role\x3d"presentation"\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3ctr\x3e\x3ctd\x3e\x3clabel for\x3d"${_uId}_r"\x3e${redLabel}\x3c/label\x3e\x3c/td\x3e\x3ctd\x3e\x3cinput id\x3d"${_uId}_r" dojoAttachPoint\x3d"Rval" size\x3d"1" dojoAttachEvent\x3d"onchange: _colorInputChange"\x3e\x3c/td\x3e\x3c/tr\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3ctr\x3e\x3ctd\x3e\x3clabel for\x3d"${_uId}_g"\x3e${greenLabel}\x3c/label\x3e\x3c/td\x3e\x3ctd\x3e\x3cinput id\x3d"${_uId}_g" dojoAttachPoint\x3d"Gval" size\x3d"1" dojoAttachEvent\x3d"onchange: _colorInputChange"\x3e\x3c/td\x3e\x3c/tr\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3ctr\x3e\x3ctd\x3e\x3clabel for\x3d"${_uId}_b"\x3e${blueLabel}\x3c/label\x3e\x3c/td\x3e\x3ctd\x3e\x3cinput id\x3d"${_uId}_b" dojoAttachPoint\x3d"Bval" size\x3d"1" dojoAttachEvent\x3d"onchange: _colorInputChange"\x3e\x3c/td\x3e\x3c/tr\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3c/table\x3e\r\n\t\t\t\t\t\t\t\t\t\x3c/div\x3e\r\n\t\t\t\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\t\t\t\x3cdiv class\x3d"dijitInline dojoxColorPickerHsv" dojoAttachPoint\x3d"hsvNode"\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3ctable cellpadding\x3d"1" cellspacing\x3d"1" role\x3d"presentation"\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3ctr\x3e\x3ctd\x3e\x3clabel for\x3d"${_uId}_h"\x3e${hueLabel}\x3c/label\x3e\x3c/td\x3e\x3ctd\x3e\x3cinput id\x3d"${_uId}_h" dojoAttachPoint\x3d"Hval"size\x3d"1" dojoAttachEvent\x3d"onchange: _colorInputChange"\x3e ${degLabel}\x3c/td\x3e\x3c/tr\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3ctr\x3e\x3ctd\x3e\x3clabel for\x3d"${_uId}_s"\x3e${saturationLabel}\x3c/label\x3e\x3c/td\x3e\x3ctd\x3e\x3cinput id\x3d"${_uId}_s" dojoAttachPoint\x3d"Sval" size\x3d"1" dojoAttachEvent\x3d"onchange: _colorInputChange"\x3e ${percentSign}\x3c/td\x3e\x3c/tr\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3ctr\x3e\x3ctd\x3e\x3clabel for\x3d"${_uId}_v"\x3e${valueLabel}\x3c/label\x3e\x3c/td\x3e\x3ctd\x3e\x3cinput id\x3d"${_uId}_v" dojoAttachPoint\x3d"Vval" size\x3d"1" dojoAttachEvent\x3d"onchange: _colorInputChange"\x3e ${percentSign}\x3c/td\x3e\x3c/tr\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3c/table\x3e\r\n\t\t\t\t\t\t\t\t\t\x3c/div\x3e\r\n\t\t\t\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\t\t\t\x3ctd colspan\x3d"2"\x3e\r\n\t\t\t\t\t\t\t\t\t\x3cdiv class\x3d"dojoxColorPickerHex" dojoAttachPoint\x3d"hexNode" aria-live\x3d"polite"\x3e\t\r\n\t\t\t\t\t\t\t\t\t\t\x3clabel for\x3d"${_uId}_hex"\x3e\x26nbsp;${hexLabel}\x26nbsp;\x3c/label\x3e\x3cinput id\x3d"${_uId}_hex" dojoAttachPoint\x3d"hexCode, focusNode, valueNode" size\x3d"6" class\x3d"dojoxColorPickerHexCode" dojoAttachEvent\x3d"onchange: _colorInputChange"\x3e\r\n\t\t\t\t\t\t\t\t\t\x3c/div\x3e\r\n\t\t\t\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\t\t\x3c/table\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\x3c/table\x3e\r\n\t\t\x3c/td\x3e\r\n\t\x3c/tr\x3e\r\n\x3c/table\x3e\r\n\r\n',
"url:builder/plugins/attribute-config/css/style.css":'.attribute-config {overflow-x: hidden; overflow-y: auto; font-size: 14px;}.attribute-config .textOverFlow {white-space: nowrap; overflow: hidden; text-overflow: ellipsis;}.attribute-config .section {padding: 15px 30px;}.header-section input,.links-section input,.appId-section input,.proxy-section input {height: 30px; border: 1px solid #d2dae2; padding: 5px; margin: 0; font-size: 12px; color: #232323; width: 100%; background-color: #fafafc; font-family: "Avenir Light";}.header-section input:focus,.links-section input:focus,.appId-section input:focus,.proxy-section input:focus {border: 1px solid #15a4fa; background-color: white; color: black;}.attribute-config .header-section {border: 0 solid;}.attribute-config .header-section .header-title,.attribute-config .title {color: #596679; line-height: 1.0; display: inline-block; width: 100%;}.attribute-config .styled-text {padding-right: 30px;}.jimu-rtl .attribute-config .styled-text {padding-left: 20px; padding-right: 0;}.attribute-config .header-section .logo-container {position: relative; font-size: 10px; width: 82px; height: 82px; margin-top: 10px; cursor: pointer; background-color: #ececec;}.attribute-config .header-section .logo-container:hover {background-color: #dcdcdc;}.attribute-config .header-section .logo-container.logo {border: 1px solid #d2dae2;}.attribute-config .header-section .logo-container.no-logo {border: 1px dashed #d2dae2;}.attribute-config .header-section .logo-container .hide {display: none;}.attribute-config .header-section .logo-container .jimu-image-chooser {width: 100%;}.attribute-config .header-section .logo-container.no-logo .jimu-image-chooser {position: absolute !important; opacity: 0; -ms-filter: "Alpha(opacity\x3d0)"; filter: Alpha(opacity\x3d0);}.attribute-config .header-section .logo-container .jimu-image-chooser .hint .display-image {width: auto; height: auto; max-width: 80px; max-height: 80px; background-size: contain;}.attribute-config .header-section .logo-container .add-logo {text-align: center; margin-top: 31px; cursor: pointer;}.attribute-config .header-section .logo-container .add-logo .image {margin: auto; margin-top: 10px; background: url(images/add_header.png) no-repeat center; width: 20px; height: 20px;}.attribute-config .header-section .logo-container .add-logo .text {font-size: 12px; color: #aaaaaa; text-align: center;}.attribute-config .header-section .logo-container .masker-node {position: absolute; z-index: 200; height: 100%; width: 100%; top: 0;}.attribute-config .header-section .logo-container .remove-logo {display: none; position: absolute; width: 25px; height: 25px; right: 0; z-index: 9999; cursor: pointer; background-color: rgba(0, 0, 0, .4); background-repeat: no-repeat; background-position: center;}.attribute-config .header-section .logo-container .remove-logo {top: 0; background-image: url(images/remove_logo.png);}.attribute-config .header-section .logo-container.logo:hover .remove-logo {display: block;}.attribute-config .header-section .logo-container.logo .remove-logo:hover {background-color: rgba(0, 0, 0, .6);}.attribute-config-plugin-logo-options.remove-logo {width: 25px; height: 25px; border-radius: 4px; background-repeat: no-repeat; background-position: center; background-image: url(images/remove_logo.png); z-index: 10000000; cursor: pointer; -ms-filter: "Alpha(opacity\x3d40)"; filter: Alpha(opacity\x3d40); background-color: rgb(0, 0, 0);}.attribute-config-plugin-logo-options.remove-logo:hover {-ms-filter: "Alpha(opacity\x3d60)"; filter: Alpha(opacity\x3d60); background-color: rgb(0, 0, 0);}.attribute-config .header-section .titles {font-size: 10px; margin-top: 10px; width: calc(100% - 82px - 1em);}.attribute-config .header-section .titles input {height: 36px; background-color: white;}.attribute-config .header-section .titles .title {width: 100%; position: relative;}.attribute-config .header-section\x3e.title {width: 100%; height: 20px; position: relative;}.attribute-config .header-section .subtitle {width: 100%; height: 32px; margin-top: 10px; position: relative;}.attribute-config .header-section .label-editor {position: absolute; width: 12px; height: 12px; background: url("./images/A.png") no-repeat center; top: 12px; right: 10px; cursor: pointer; background-color: white;}.attribute-config .header-section .label-editor:hover {background: url("./images/A_hover.png") no-repeat center; background-color: #fafafc;}.jimu-rtl .attribute-config .header-section .label-editor {right: auto; left: 1px;}.format-font-style .dijitEditorIFrameContainer {position: absolute; top: 36px; left: 1px; right: 1px; bottom: 3px;}.format-font-style .dijitToolbar .dijitTextBox {width: 180px !important;}.el .format-font-style .dijitToolbar .dijitTextBox {width: 150px !important;}.pt-pt .format-font-style .dijitToolbar .dijitTextBox {width: 160px !important;}.it .format-font-style .dijitToolbar .dijitTextBox {width: 160px !important;}.format-font-style .dijitToolbar {font-size: 12px;}.appId-section .attribute-content {margin-top: 10px;}.appId-section a {color: #7EC6F8; float: right; cursor: pointer;}.proxy-section {display: none;}.attribute-config .sub-title {padding: 15px 0 10px 0;}.links-section .attribute-content {width: 340px; padding-top: 15px;}.links-section,.proxy-section {color: #a0acbf;}.attribute-config .attribute-content .links-list,.attribute-config .attribute-content .proxy-rule-list {padding-top: 10px;}.attribute-config .attribute-content .list-item.selected-item,.attribute-config .attribute-content .list-item:hover {background-color: #e3ecf2;}.attribute-config .attribute-content .list-item.selected-item .mask,.attribute-config .attribute-content .list-item:hover .mask {background-color: #e3ecf2;}.attribute-config .attribute-content .list-item {overflow: hidden; border-top-style: none; border: 1px solid #d2dae2; border-bottom-color: #eef2f5;}.attribute-config .attribute-content .list-item+.list-item {border-top-style: none;}.attribute-config .attribute-content .list-item:last-child {border-bottom-color: #dad2de;}.attribute-config .attribute-content .list-item:first-child {border-top-color: #dad2de;}.attribute-config .attribute-content .list-item .mask {width: 100%; height: 30px; color: #a0acbf; font-size: 12px; line-height: 30px; padding-left: 10px; border-width: 1px; background-color: #fafafc;}.attribute-config .attribute-content .list-item .mask:first-child {font-size: 14px;}.attribute-config .attribute-content .list-item .first,.attribute-config .attribute-content .list-item .second {height: 30px;}.proxy-rule-header {width: 100%; height: 30px; line-height: 30px; background-color: #518dca; color: white; margin: 10px 0 -10px;}.proxy-rule-header div {float: left; border-style: none; padding-left: 10px;}.attribute-content .list-item .first,.proxy-rule-header .prefix {width: 110px;}.proxy-rule-header .proxy-url {width: 228px;}.attribute-content .list-item .second {width: 228px; border-left: 1px solid #eef2f5;}.attribute-config .attribute-content .list-item .first input {border-right-style: none;}.attribute-config .attribute-content .list-header {}.attribute-config .list-header .header-button {display: inline-block; padding: 0 15px 0 19px; color: #a0acbf; cursor: default;}.attribute-config .list-header .header-button.add {color: #518dca; cursor: pointer; background: url(images/add_icon01.png) no-repeat left;}.attribute-config .list-header .header-button.add:hover {background: url(images/add_icon02.png) no-repeat left;}.attribute-config .list-header .header-button.edit {background: url(images/edit_icon01.png) no-repeat left;}.attribute-config .list-header .header-button.delete {background: url(images/delete_icon01.png) no-repeat left;}.attribute-config .list-header .highlight-button {color: #518dca; cursor: pointer;}.attribute-config .list-header .highlight-button.add {color: #518dca; background: url(images/add_icon02.png) no-repeat left;}.attribute-config .list-header .highlight-button.edit {background: url(images/edit_icon02.png) no-repeat left;}.attribute-config .list-header .highlight-button.delete {background: url(images/delete_icon02.png) no-repeat left;}.jimu-rtl .attribute-config .list-header .header-button,.jimu-rtl .attribute-config .list-header .highlight-button {background-position: right !important;}.attribute-config .section .always-use-proxy {color: #596679; cursor: pointer; display: inline-block; margin-top: 15px; margin-bottom: 6px;}.attribute-config .section .always-use-proxy .label {display: inline; float: none;}.proxy-section .rules-label {color: #596679; font-size: 12px; margin: 10px 0 12px 0; display: block; line-height: 12px;}.proxy-section .error-status {border: 1px solid #e84b4b; background-color: #fff;}.controller-loading,.controller-appproxy {cursor: pointer;}.controller-loading:hover,.datasources:hover,.controller-appproxy:hover {background: #F3F3F3;}.controller-loading .action-content {padding-top: 15px; height: 48px;}.section-appstate .action-content {padding-top: 15px;}.section-appstate .appstate-check .label {float: none !important; font-size: 12px !important; margin-left: 30px; color: #000;}.jimu-rtl .section-appstate .appstate-check .label {margin-right: 30px; margin-left: auto;}.loadingpage-section,.appproxy-section {margin-top: 25px; width: 100%; padding: 0 30px;}.appproxy-section .attribute-link,.loadingpage-section .attribute-link {text-align: center; font-family: "Avenir Medium"; font-size: 16px; color: #232323; height: 22px; width: 100%;}.loadingpage-section .config-part {margin-top: 10px; font-size: 14px; color: #7889a0; width: 300px;}.loadingpage-section .bgColor-control {height: 30px; width: 340px; margin-top: 10px; text-align: center; line-height: 30px; color: #000000;}.loadingpage-section .bgUploaderDiv {width: 300px; height: 30px;}.loadingpage-section .loading-image-chooser {width: auto; height: 30px; line-height: 30px; margin-top: 10px;}.loadingpage-section .jimu-btn {padding-top: 1px;}.loadingpage-section .config-part .label {font-family: "Avenir Medium"; font-size: 14px; color: #000000;}.loadingpage-section .config-part .jimu-checkbox .label {font-family: "Avenir Light"; font-size: 12px; color: #000000;}.loadingpage-section .config-part label {font-family: "Avenir Light"; font-size: 12px; color: #333333;}.loadingpage-section .config-part .value {font-size: 14px; color: #000000; margin-left: 15px;}.loadingpage-section .gif_select {width: 100px; height: 32px;}.section {width: 100%;}.section .title \x3e span {line-height: 20px; font-family: "Avenir Medium"; font-size: 14px; color: #232323}.section .action-text,.sub-section .note {margin-top: 5px; line-height: 16px; font-size: 12px; color: #999999;}.appproxy-section {width: 100%;}.appproxy-section .sub-section {margin-top: 20px; width: 100%;}.appproxy-section .sub-section.double-margin {margin-top: 40px;}.appproxy-section .sub-section .title {line-height: 20px; font-family: "Avenir Medium"; font-size: 14px; color: #232323;}.appproxy-section .sub-section .content {margin-top: 10px;}.appproxy-section .sub-section .row {height: 30px; margin-top: 13px; width: calc(100% - 25px);}.appproxy-section .sub-section .row \x3e .col:first-child {text-align: left;}.jimu-rtl .appproxy-section .sub-section .row \x3e .col:first-child {text-align: right;}.appproxy-section .sub-section .row \x3e .col:last-child {text-align: right;}.jimu-rtl .appproxy-section .sub-section .row \x3e .col:last-child {text-align: left;}.appproxy-section .sub-section .col {width: calc(30% - 8px); line-height: 16px; font-family: "Avenir-Book"; font-size: 12px; color: #232323; display: inline-block; text-align: center; text-overflow: ellipsis; overflow: hidden; white-space: nowrap;}.appproxy-section .sub-section .col-proxy {width: 25px;}.appproxy-section .sub-section .col .checkbox {float: right !important;}.jimu-rtl .appproxy-section .sub-section .col .checkbox {float: left !important;}.appproxy-section .sub-section .header {height: 36px; margin: 10px 0;}.appproxy-section .sub-section .header .row {height: 36px; margin: 0;}.appproxy-section .sub-section .header .row .col {color: #898989; height: 36px; line-height: 36px;}.appproxy-section .sub-section .sepeartor {width: 100%; height: 1px; background: #EFEFEF;}.appproxy-section .note-content {font-family: "Avenir Medium"; font-size: 12px; color: #232323;}.map-proxy-item {width: 100%; height: auto; border-top: 1px solid #EEE; border-bottom: 1px solid #EEE; position: relative; padding: 10px 0;}.map-proxy-item \x3e div {display: inline-block; vertical-align: top;}.map-proxy-item .proxy-check {width: 18px; height: 18px;}.map-proxy-item .layer-title {margin: 0 6px; width: calc(100% - 100px); font-size: 12px;}.map-proxy-item .layer-title .title {height: auto; font-size: 12px;}.map-proxy-item .layer-title .access-limit {color: #999;}.map-proxy-item .credits {background: url(images/PremiumContentUserCredit16.png) no-repeat center; height: 16px; width: 16px; margin: 0 5px;}.map-proxy-item .setting {background: url(images/settings_default.svg) no-repeat center; height: 16px; width: 16px; cursor: pointer; margin: 0 5px;}.map-proxy-item .setting.highight {background: url(images/settings_hover.svg) no-repeat center;}.map-proxy-item .setting:hover {background: url(images/settings_hover.svg) no-repeat center;}.map-proxy-item .setting-dialog {position: absolute; top: 40px; left: 0; width: 340px; height: 160px; background-color: #fff; z-index: 100; border: 1px solid #E0E0E0; box-shadow: 0 0 6px 0 rgba(0,0,0,0.20);}.map-proxy-item .setting-dialog.hidden {display: none;}.map-proxy-item .setting-dialog .input-section {margin: 30px 20px 0 20px;}.map-proxy-item .setting-dialog .input-section \x3e div {width: 49%; display: inline-block;}.map-proxy-item .setting-dialog .limit-spinner,.map-proxy-item .setting-dialog .interval-select {width: 100%;}.map-proxy-item .setting-dialog .button-section {margin: 20px;}.loading {background: transparent;}.attribute-config .datasources {margin-top: 15px; cursor: pointer;}.datasources-link,.datasources-section {text-align: center; font-family: "Avenir Medium"; font-size: 16px; color: #232323; height: 22px; width: 100%;}.datasources-section {margin-top: 25px; width: 100%; height: auto; padding: 0 30px;}.attribute-config .additional-data-sources {text-align: initial; height: 100%; width: 100%;}.additional-data-sources .margin-right-10 {margin-right: 10px;}.jimu-rtl .additional-data-sources .margin-right-10 {margin-left: 10px; margin-right: 0;}.additional-data-sources .no-data-source-tip {background-size: contain; background: center center no-repeat url(\'images/no-data-source-tip.svg\');}.additional-data-sources .no-data-source-tip-box {width: 100px; height: 97px; margin: 80px auto 0 auto;}.additional-data-sources .ds-header {display: flex; justify-content: space-between; align-items: center;}.additional-data-sources .ds-title-box {max-width: 200px; text-overflow: ellipsis; height: 19px; margin-top: 15px}.additional-data-sources .ds-title {font-family: "Avenir Medium"; font-size: 14px; color: #000000;}.additional-data-sources .dataSource-add-box {margin-top: 15px; display: flex; height: 26px; justify-content: space-around; align-items: center;}.additional-data-sources .dataSource-add {cursor: pointer;}.additional-data-sources .dataSource-add .img_add {width: 12px; height: 12px; padding: 0 10px; background: no-repeat center center url(./images/ds_add.svg);}.additional-data-sources .dataSource-add .img_add_hover {background: no-repeat center center url(./images/ds_add_hover.svg);}.additional-data-sources .dataSource-add .text_add {font-family: Avenir-Medium; font-size: 12px; color: #666666; letter-spacing: 0.33px; max-width: 200px; text-overflow: ellipsis;}.additional-data-sources .dataSource-add .text_add_hover {color: #0C839C;}.additional-data-sources .ds-suspension.ds-options.hide {display: none;}.additional-data-sources .ds-suspension {position: absolute; box-shadow: 0 0 8px 0 rgba(0, 0, 0, 0.30); height: 194px; width: 160px; background: #ffffff;}.additional-data-sources .ds-options-lr {right: 39px; left: inherit;}.jimu-rtl .additional-data-sources .ds-options-lr {left: 39px; right: inherit;}.additional-data-sources .ds-options {background: #FFFFFF; box-shadow: 0 2px 4px 0 rgba(0, 0, 0, 0.50); width: 143px; padding: 5px 2px; height: 84px; margin-top: 13px; display: flex; flex-direction: column; justify-content: center; align-items: center;}.additional-data-sources .ds-options .option-item {width: 143px; height: 32px; cursor: pointer; font-family: "Avenir Medium"; font-size: 14px; color: #000000; padding: 6px 23px;}.additional-data-sources .ds-options .option-item:hover {background-color: #DDDDDD;}.additional-data-sources .table-header {margin-top: 23px; display: flex; justify-content: space-between; align-items: center;}.additional-data-sources .table-header {padding-right: 7px;}.additional-data-sources .table-header div {font-size: 12px; color: #000; font-family: \'Avenir Medium\'; font-weight: bold;}.additional-data-sources .table-header div:first-child {width: 200px;}.additional-data-sources .table-header div:nth-child(2) {width: 51px;}.additional-data-sources .table-header div:nth-child(3) {width: 30px;}.attribute-config .additional-data-sources .horizontial-line {width: 340px; height: 1px; background: #D8D8D8; margin-top: 6px;}.additional-data-sources .sourcesList {max-height: 460px; overflow-x: hidden; overflow-y: auto; display: flex; flex-direction: column; justify-content: center; align-items: center; padding-right: 7px;}.additional-data-sources .sourcesList .source-tr {display: flex; justify-content: space-between; align-items: center; height: 34px; font-size: 12px; color: #000000; width: 100%; background-repeat: no-repeat;}.additional-data-sources .sourcesList .source-tr:hover {}.additional-data-sources .sourcesList .mid-line {width: 340px; height: 1px; background: #ccc;}.additional-data-sources .sourcesList .source-tr .source-tr-name {width: 200px; cursor: default;}.additional-data-sources .sourcesList .source-tr .source-tr-type {width: 51px;}.additional-data-sources .sourcesList .source-tr .source-tr-action {display: flex; justify-content: space-between; width: 30px; cursor: pointer;}.additional-data-sources .sourcesList .source-tr .source-tr-action .hidden {display: none;}.additional-data-sources .sourcesList .source-tr .source-tr-action div {width: 10px; height: 10px;}.additional-data-sources .sourcesList .edit {cursor: pointer; background-image: url(./images/ds_edit.svg); background-position: center;}.additional-data-sources .sourcesList .edit:hover {background-image: url(./images/ds_edit_hover.svg);}.additional-data-sources .sourcesList .delete {cursor: pointer; background-image: url(./images/ds_delete.svg); background-position: center;}.additional-data-sources .sourcesList .delete:hover {background-image: url(./images/ds_delete_hover.svg);}.additional-data-sources .dijitSelect {background-color: #ffffff;}.additional-data-sources .hidden {display: none;}.data-sources-config .marginTop5 {margin-top: 5px;}.data-sources-config .marginTop15 {margin-top: 15px;}.data-sources-config .marginTop20 {margin-top: 20px;}.data-sources-config .marginLeft5 {margin-left: 5px;}.jimu-rtl .data-sources-config .marginLeft5 {margin-right: 5px; margin-left: 0;}.data-sources-config .marginLeft10 {margin-left: 10px;}.jimu-rtl .data-sources-config .marginLeft10 {margin-right: 10px; margin-left: auto;}.data-sources-config .marginLeft15 {margin-left: 15px;}.jimu-rtl .data-sources-config .marginLeft15 {margin-right: 15px; margin-left: 0;}.data-sources-config .marginLeft20 {margin-left: 20px;}.jimu-rtl .data-sources-config .marginLeft20 {margin-right: 20px; margin-left: 0;}.data-sources-config .data-source-label {font-size: 14px; color: #353535; font-family: \'Avenir Medium\';}.data-sources-config .textOverFlow {white-space: nowrap; overflow: hidden; text-overflow: ellipsis;}.data-sources-config .data-source-sub-label {font-size: 12px; color: #353535; font-family: \'Avenir Medium\'; width: 270px;}.data-sources-config .ds-text-box {width: 750px; height: 30px;}.data-sources-config .flex-ltr-start {display: flex; justify-content: flex-start; align-items: center;}.data-sources-config .order {display: flex;}.data-sources-config .order .order-btn {width: 64px; height: 30px; font-size: 12px; border: 1px solid #D7D7D7; text-align: center; padding: 8px 0; cursor: pointer;}.data-sources-config .order .selected {background: #0C839C; border: none; color: white;}.data-sources-config .filterExpr {font-size: 12px; color: #999999; white-space: nowrap;}.data-sources-config .source {font-family: Avenir-Medium; font-size: 12px; color: #353535; cursor: default; overflow: hidden; white-space: nowrap; text-overflow: ellipsis;}.data-sources-config .radio {margin-top: 3px;}.data-sources-config .refreshContent label,.data-sources-config .refreshContent span {white-space: nowrap;}.data-sources-config .refreshContent {display: flex; justify-content: flex-start; align-items: center;}.data-sources-config .margin-left-10 {margin-left: 10px;}.jimu-rtl .data-sources-config .margin-left-10 {margin-right: 10px; margin-left: 0;}.data-sources-config .timeDiv {width: 70px; margin: auto 10px;}.data-sources-config .button {cursor: pointer; display: none; width: 75px; height: 30px; font-size: 12px; color: #353535; text-align: center; background: #FFFFFF; border: 1px solid #D7D7D7;}.data-sources-config .button:hover {background: #EFEFEF;}.data-sources-config .visible {display: block;}.data-sources-config .hide {display: none !important;}.data-sources-config .layerOptionDiv .resultRecordType .dijitSelect {width: 186px; background-color: white;}.data-sources-config .layerOptionDiv .resultRecordType .dijitSelect .dijitButtonText span {max-width: 138px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; font-size: 12px; color: #232323;}.data-sources-config .layerOptionDiv .orderByField .dijitSelect .dijitButtonText span {max-width: 193px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; font-size: 12px; color: #232323;}.data-sources-config .layerOptionDiv .groupFields .dijitSelect .dijitButtonText span {max-width: 200px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;}.data-sources-config .layerOptionDiv .orderByField .dijitSelect,.data-sources-config .statisticsOptionDiv .groupFields .dijitSelect {width: 250px; background-color: white;}.data-sources-config .layerOptionDiv .custom-number-div,.data-sources-config .layerOptionDiv .custom-number-div .custom-number {width: 60px; height: 30px;}.data-sources-config .inlineBlock {display: inline-block;}.data-sources-config .statisticsDiv .groupFields {display: inline-block; margin-left: 20px;}.data-sources-config .footer,.data-sources-filter .footer {position: absolute; width: 100%; left: 0; right: 0; bottom: 0; height: 36px;}.data-sources-config .footer .data-preview,.data-sources-filter .footer .data-preview {width: 115px; height: 30px; border: 1px solid #D7D7D7; cursor: pointer; font-size: 14px; color: #232323; text-align: center; padding: 5px 0;}.data-sources-filter .textOverFlow {white-space: nowrap; overflow: hidden; text-overflow: ellipsis;}.data-sources-filter .filterByExtent .jimu-checkbox .label {white-space: nowrap;}.data-sources-filter .footer .data-preview:hover,.data-sources-config .footer .data-preview:hover {background: #EFEFEF;}.data-sources-filter .footer .data-preview.sample-btn {width: 160px;}.data-sources-filter .filter-label {font-family: Avenir-Medium; font-size: 14px; color: #353535;}.data-sources-filter .filterDiv {width: 100%; height: calc(100% - 100px);}.data-sources-filter .margin-left-10 {margin-left: 10px;}.jimu-rtl .data-sources-filter .margin-left-10 {margin-right: 10px; margin-left: 0;}.data-sources-filter {overflow-x: hidden; overflow-y: auto; height: 365px;}.data-sources-filter .sourcesFilterDiv {width: 100%; overflow-y: auto;}.data-sources-config .left-arrow {width: 15px; height: 28px; z-index: 1; background-image: url(images/leftArrow.svg);}.jimu-rtl .data-sources-config .left-arrow.transform {-moz-transform: scaleX(-1); -webkit-transform: scaleX(-1); -o-transform: scaleX(-1); transform: scaleX(-1); filter: FlipH;}.data-sources-config .fieldsOptionDiv {display: flex; align-items: center; position: absolute; width: 175px;}.data-sources-config .suspension {height: 194px; background: #FFFFFF; overflow-x: hidden; box-shadow: 0px 0px 8px rgba(0, 0, 0, 0.30);}.jimu-rtl .data-sources-config .fieldsOption.fields-position-lr {right: 86px; left: inherit;}.data-sources-config .fieldsOption.fields-position-lr {left: 86px; right: inherit;}.data-sources-config .fieldsOption {z-index: 300; margin-top: -118px;}.jimu-rtl .data-sources-config .statisticsFieldsOption.statisrics-fields-position-lr {right: 355px; left: inherit;}.data-sources-config .statisticsFieldsOption.statisrics-fields-position-lr {left: 355px; right: inherit;}.data-sources-config .statisticsFieldsOption {z-index: 300; margin-top: -118px;}.jimu-widget-chart-setting-data-fields {width: 100%; margin: 13px 10px 13px 20px;}.jimu-widget-chart-setting-data-fields .fields-content {width: 100%;}.jimu-widget-chart-setting-data-fields .field-item {height: 20px; line-height: 20px; font-size: 12px; margin-top: 7px;}.jimu-rtl .jimu-widget-chart-setting-data-fields .field-item input {margin-left: 6px; margin-right: 0;}.jimu-widget-chart-setting-data-fields .field-item input {margin-right: 6px; position: relative; top: -4px;}.jimu-widget-chart-setting-data-fields .field-item span {width: 100px; display: inline-block; cursor: default;}.jimu-widget-chart-setting-data-fields .operation {display: none;}.custom-logo-page {font-family: Avenir-Book; font-size: 14px; color: #000000; margin-top: 10px;}.custom-logo-page .hide {display: none;}.custom-logo-page .preview-container {width: 130px; height: 130px; position: relative;}.custom-logo-page .preview-container .image-node,.custom-logo-page .preview-container .no-image {position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);}.custom-logo-page .preview-container .image-node {max-width: 50px; max-height: 50px; background-color: #ececec;}.custom-logo-page .preview-container .no-image {background-color: transition; white-space: nowrap;}.custom-logo-page .separator {height: 150px; width: 1px; background: #CCCCCC; margin: 0 35px; border-radius: 2px;}.custom-logo-page .setting-container .setting-item {margin: 10px;}.custom-logo-page .setting-container .setting-item .label {margin: 10px 0;}.custom-logo-page .setting-container .setting-item .link-text {width: 350px;}.custom-logo-page .setting-container .choose-image-btn {width: 100px; height: 30px; border: 1px solid #CCCCCC; text-align: center; line-height: 30px; cursor: pointer;}',
"url:builder/plugins/creation-entry/Plugin.html":"\x3cdiv\x3e\r\n\r\n\x3c/div\x3e\r\n","url:builder/plugins/creation-entry/SaveAsPage.html":'\x3cdiv\x3e\r\n  \x3cp style\x3d"display:none;" class\x3d"configureApp"\x3e${nls.savePublish}\x3c/p\x3e\r\n  \x3cp style\x3d"display:none;" class\x3d"appBuilder"\x3e${nls.appBuilderTitle}\x3c/p\x3e\r\n  \x3cp style\x3d"display:none;" class\x3d"appBuilder"\x3e${nls.appBuilderMsg}\x3c/p\x3e\r\n\r\n\r\n  \x3cdiv class\x3d"item-info-box" data-dojo-attach-point\x3d"itemInfoBox" \x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:builder/plugins/creation-entry/CreateNewAppPage.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"app-select-page" data-dojo-attach-point\x3d"appSelectPage"\x3e\r\n    \x3cdiv class\x3d"switch-btn-box-container"\x3e\r\n      \x3cdiv class\x3d"switch-btn-box"\x3e\r\n        \x3cdiv class\x3d"switch-btn all-app-btn selected" data-dojo-attach-point\x3d"allAppBtn"\r\n             data-dojo-attach-event\x3d"onclick:_onAllAppBtnClick"\x3e ${nls.all}\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"separate"\x3e\x3c/div\x3e\r\n        \x3cdiv class\x3d"switch-btn own-app-btn" data-dojo-attach-point\x3d"ownAppBtn"\r\n             data-dojo-attach-event\x3d"onclick:_onOwnAppBtnClick"\x3e ${nls.myTemplates}\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"app-content all-app-content" data-dojo-attach-point\x3d"allAppContent"\x3e\r\n      \x3cdiv class\x3d"app-line" data-dojo-attach-point\x3d"defaultApps"\x3e\x3c/div\x3e\r\n      \x3cdiv class\x3d"app-line" data-dojo-attach-point\x3d"othersApps"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"app-content own-app-content" data-dojo-attach-point\x3d"ownAppContent"\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"app-info-page" data-dojo-attach-point\x3d"appInfoPage"\x3e\r\n    \x3cdiv class\x3d"app-info-table" data-dojo-attach-point\x3d"appInfoTable"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:builder/plugins/creation-entry/css/style.css":".create-app-page {border: 0px solid; position: relative; margin: 0 auto;}.create-app-page .app-select-page {min-height: 200px;}.create-app-page .app-select-page .switch-btn-box-container {height: 50px; position: relative; margin-bottom: 10px; margin-left: 10px;}.create-app-page .app-select-page .switch-btn-box {position: absolute; left: 0; top: 20px; font-size: 14px; color: #999; font-weight: bold; line-height: 20px;}.jimu-rtl .create-app-page .app-select-page .switch-btn-box {right: 0; left: auto;}.jimu-rtl .create-app-page .app-select-page .switch-btn-box {margin-right: 8px; margin-left: auto;}.create-app-page .app-select-page .switch-btn-box .switch-btn {display: inline-block; cursor: pointer; font-size: 14px; text-align: center; min-width: 40px; border-bottom: 2px solid transparent;}.create-app-page .app-select-page .switch-btn-box .switch-btn:hover {color: #d84b28;}.create-app-page .app-select-page .switch-btn-box .switch-btn.selected {color: #d84b28; border-bottom: 2px solid #d84b28; min-width: 40px; text-align: center;}.create-app-page .app-select-page .switch-btn-box .separate {display: inline-block; width: 30px;}.create-app-page .app-info-page {width: 100%; border: 0px solid; top: 70px; margin: 0 auto;}.app-select-page .app-content {overflow: hidden;}.jimu-rtl .app-select-page .app-content {margin-right: 6px; margin-left: auto;}.app-select-page .all-app-content {overflow: auto; padding: 10px;}.app-select-page .own-app-content {overflow: auto; display: none; padding: 10px;}.app-select-page .app-content .app-line {float: left; width: 100%;}.jimu-rtl .app-select-page .app-content .app-line {float: right;}.app-select-page .app-content .app-node {border: 0px solid; text-align: center; position: relative; margin-right: 14px; cursor: pointer; max-width: 182px;}.app-select-page .app-content .app-node .flag-image {position: absolute; width: 26px; height: 22px; top: 86px; right: 10px; background-position: center; background-repeat: repeat; display: block;}.app-select-page .app-content .app-node .jimu-state-active .flag-image {}.app-select-page .app-content .app-node .flag-image-2D{background-image: url(images/flag_2d.png);}.app-select-page .app-content .app-node .flag-image-3D{background-image: url(images/flag_3d.png);}.app-select-page .app-content .app-node .app-image-border-div {position: relative; width: 180px; height: 120px; border: 2px solid transparent; border-radius: 4px; -webkit-box-shadow:0 0 10px rgba(0, 0, 0, .1); -moz-box-shadow:0 0 10px rgba(0, 0, 0, .1); box-shadow: 0 0 10px rgba(0, 0, 0, .1); background-color: #fff;}.app-select-page .app-content .app-node .app-image-div {width: 120px; height: 80px; background-repeat: no-repeat; background-color: #f2f2f2; background-position: center; margin: 0 auto; margin-top: 18px; background-size: 100% 100%;}.app-select-page .app-content .app-node .jimu-state-active .app-image-selected-container {width: 180px; height: 120px; background-color: rgba(255,255,255,0.6); position: absolute;}.app-select-page .app-content .app-node .jimu-state-active .app-image-selected-icon{position: absolute; width: 24px; height: 24px; top: 10px; right: 10px; background-position: center;}.app-select-page .app-content .app-node .app-name {color: #333; max-height: 50px; min-height: 20px; padding-top: 10px; padding-bottom: 10px; height: 40px; overflow: hidden; white-space: nowrap; text-overflow: ellipsis;}.app-select-page .app-content .app-node .jimu-state-active {border: 2px solid #31aacd; border-radius: 4px;}",
"url:builder/plugins/header/Plugin.html":'\x3cdiv class\x3d"top-nav clearfix"\x3e\r\n  \x3cdiv class\x3d"switch-section" data-dojo-attach-point\x3d"switchSection"\x3e\r\n    \x3cdiv class\x3d"switch-container"\x3e\r\n      \x3cdiv class\x3d"jimu-float-leading applist-switch apps selected" data-dojo-attach-point\x3d"appSwitch"\x3e${nls.apps}\x3c/div\x3e\r\n      \x3cdiv class\x3d"jimu-float-leading applist-switch templates" data-dojo-attach-point\x3d"templateSwitch"\x3e${nls.templates}\x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"dropdown left dropdown-home" data-dojo-attach-point\x3d"homeSection"\x3e\r\n    \x3ca class\x3d"dropdown-btn top-nav-title site_logo" data-dojo-attach-point\x3d"homeLabel"\x3e${nls.home}\x3c/a\x3e\r\n    \x3cdiv class\x3d"dropdown-menu" data-dojo-attach-point\x3d"homeMenu"\x3e\r\n      \x3ca class\x3d"dropdown-link" nowrap target\x3d"_self" href\x3d"#" data-dojo-attach-point\x3d"homeItem"\x3e${nls.home}\x3c/a\x3e\r\n      \x3ca class\x3d"dropdown-link" nowrap target\x3d"_self" href\x3d"#" data-dojo-attach-point\x3d"galleryItem"\x3e${nls.gallery}\x3c/a\x3e\r\n      \x3ca class\x3d"dropdown-link" nowrap target\x3d"_self" href\x3d"#" data-dojo-attach-point\x3d"mapItem"\x3e${nls.map}\x3c/a\x3e\r\n      \x3ca class\x3d"dropdown-link" nowrap target\x3d"_self" href\x3d"#" data-dojo-attach-point\x3d"sceneItem"\x3e${nls.scene}\x3c/a\x3e\r\n      \x3ca class\x3d"dropdown-link" nowrap target\x3d"_self" href\x3d"#" data-dojo-attach-point\x3d"groupsItem"\x3e${nls.groups}\x3c/a\x3e\r\n      \x3ca class\x3d"dropdown-link" nowrap target\x3d"_self" href\x3d"#" data-dojo-attach-point\x3d"contentItem"\x3e${nls.content}\x3c/a\x3e\r\n      \x3ca class\x3d"dropdown-link hidden" nowrap target\x3d"_self" href\x3d"#" data-dojo-attach-point\x3d"organizationItem"\x3e${nls.organization}\x3c/a\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3ca class\x3d"top-nav-link top-nav-logo left" data-dojo-attach-point\x3d"logoTitle"\x3e\r\n    Web AppBuilder for ArcGIS\r\n  \x3c/a\x3e\r\n\r\n  \x3ch1 class\x3d"avenir-light left text-ellipsis font-size-1 leader-1 app-name"\x3e\x3ca target\x3d"_blank" data-dojo-attach-point\x3d"appName"\x3e\x3c/a\x3e\x3c/h1\x3e\r\n\r\n  \x3cdiv class\x3d"dropdown right" data-dojo-attach-point\x3d"userSection" data-dojo-attach-event\x3d"onclick:_onUserSectionClicked"\x3e\r\n    \x3ca class\x3d"top-nav-link dropdown-btn top-nav-username text-ellipsis" data-dojo-attach-point\x3d"userInfoDom"\x3e\r\n      \x3cimg data-dojo-attach-point\x3d"userIcon" src\x3d"${folderUrl}/css/images/no-user-thumb.jpg" width\x3d"16" height\x3d"16"/\x3e\r\n      \x3cspan data-dojo-attach-point\x3d"userNameNode"\x3e\x3c/span\x3e\r\n    \x3c/a\x3e\r\n    \x3cdiv class\x3d"dropdown-menu dropdown-right text-ellipsis" data-dojo-attach-point\x3d"userMenu"\x3e\r\n      \x3ca class\x3d"dropdown-link" nowrap target\x3d"_self" data-dojo-attach-point\x3d"profileItem"\x3e\r\n        \x3cimg width\x3d"32" height\x3d"32" class\x3d"gutter-right-half gutter-left-0 content-box left" data-dojo-attach-point\x3d"profileImg" src\x3d"${folderUrl}/css/images/no-user-thumb.jpg" /\x3e\r\n        \x3cspan\x3e${nls.profile}\x3c/span\x3e\r\n        \x3cbr\x3e\r\n        \x3cspan data-dojo-attach-point\x3d"profileNameNode" class\x3d"profile-name"\x3e\x3c/span\x3e\r\n      \x3c/a\x3e\r\n      \x3ca target\x3d"_blank" data-dojo-attach-point\x3d"communityNode" class\x3d"hidden dropdown-link dropdown-link-external communityNode"\x3e\r\n        \x3cspan class\x3d"icon-ui-link-external dropdown-link-external-icon"\x3e\x3c/span\x3e ${nls.communityAndForums}\r\n      \x3c/a\x3e\r\n      \x3ca target\x3d"_blank" data-dojo-attach-point\x3d"myesriNode" class\x3d"hidden dropdown-link dropdown-link-external myesriNode"\x3e\r\n        \x3cspan class\x3d"icon-ui-link-external dropdown-link-external-icon"\x3e\x3c/span\x3e ${nls.myesri}\r\n      \x3c/a\x3e\r\n      \x3ca target\x3d"_blank" data-dojo-attach-point\x3d"trainingNode" class\x3d"hidden dropdown-link dropdown-link-external trainingNode"\x3e\r\n        \x3cspan class\x3d"icon-ui-link-external dropdown-link-external-icon"\x3e\x3c/span\x3e ${nls.training}\r\n      \x3c/a\x3e\r\n      \x3ca target\x3d"_blank" data-dojo-attach-point\x3d"switchAccountsNode" class\x3d"hidden dropdown-link"\x3e${nls.switchAccounts}\x3c/a\x3e\r\n      \x3ca target\x3d"_blank" data-dojo-attach-point\x3d"helpNode" class\x3d"dropdown-link"\x3e${nls.help}\x3c/a\x3e\r\n      \x3ca target\x3d"_blank" data-dojo-attach-point\x3d"adminHelpNode" class\x3d"hidden dropdown-link admin-guide"\x3e${nls.administratorGuide}\x3c/a\x3e\r\n      \x3ca class\x3d"sign-out dropdown-link" data-dojo-attach-point\x3d"signOutItem"\x3e${nls.signOut}\x3c/a\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:builder/plugins/header/css/style.css":'.plugin-header .switch-section{position: absolute; left: 0; right: 0; height: 100%; z-index: -1;}.plugin-header.app-opened .switch-section{display: none;}.plugin-header .switch-section .switch-container{min-width: 1024px; max-width: 1260px; height: 100%; margin-left: auto; margin-right: auto; overflow: hidden;}.plugin-header.width-less1816 .switch-section .switch-container{margin-left: 280px; margin-right: 0;}.jimu-rtl .plugin-header.width-less1816 .switch-section .switch-container{margin-right: 280px; margin-left: 0;}.plugin-header .switch-section .switch-container .applist-switch{height: 100%; line-height: 60px; cursor: pointer; color: #999999; font-size: 14px;}.plugin-header .switch-section .switch-container .applist-switch.selected{color: #31aacd;}.plugin-header .switch-section .switch-container .applist-switch.apps{margin-right: 40px;}.jimu-rtl .plugin-header .switch-section .switch-container .applist-switch.apps{margin-right: 0; margin-left: 40px;}.plugin-header.clearfix:after {content: \'\'; display: table; clear: both;}.plugin-header .left {float: left;}.plugin-header .right {float: right;}.plugin-header .avenir-light {letter-spacing: 0em; font-weight: 300; font-style: normal;}.plugin-header .avenir-light b, .plugin-header .avenir-light strong {font-weight: 500;}.plugin-header .avenir-regular,.plugin-header.top-nav,.plugin-header .top-nav-link,.plugin-header .dropdown-link {letter-spacing: 0em; font-weight: 400; font-style: normal;}.plugin-header .avenir-regular b,.plugin-header.top-nav b,.plugin-header .top-nav-link b,.plugin-header .avenir-regular strong,.plugin-header.top-nav strong,.plugin-header .top-nav-link strong {font-weight: 500;}.plugin-header .dropdown-btn:after {font-family: \'CalciteWebCoreIcons\'; padding-right: 0.5166666667em; speak: none; font-style: normal; font-weight: normal; font-variant: normal; text-transform: none; line-height: 1; -webkit-font-smoothing: antialiased; -moz-osx-font-smoothing: grayscale;}.plugin-header .dropdown-btn:after {padding-right: 0; padding-left: 0.5166666667em;}.plugin-header [class^\x3d"esri-icon-"]:before,.plugin-header [class*\x3d" esri-icon-"]:before,.plugin-header [class^\x3d"icon-ui-"]:before,.plugin-header [class*\x3d" icon-ui-"]:before {font-family: \'CalciteWebCoreIcons\'; padding-right: 0.5166666667em; speak: none; font-style: normal; font-weight: normal; font-variant: normal; text-transform: none; line-height: 1; -webkit-font-smoothing: antialiased; -moz-osx-font-smoothing: grayscale;}.plugin-header .esri-icon-link-external:before,.plugin-header .icon-ui-link-external:before {content: "\\e65c";}.plugin-header .esri-icon-down-arrow:before,.plugin-header .icon-ui-down-arrow:before,.plugin-header .dropdown-btn:after {content: "\\e608";}.plugin-header .esri-icon-user:before,.plugin-header .icon-ui-user:before {content: "\\e675";}.plugin-header .esri-icon-menu:before,.plugin-header .icon-ui-menu:before {content: "\\e663";}.plugin-header .top-nav-username {max-width: 175px; margin-bottom: -4px;}@media screen and (max-width: 1080px) {.plugin-header .top-nav-username {max-width: 130px;}}.plugin-header.top-nav {font-size: 17px; background-color: white;}.plugin-header.top-nav a {text-decoration: none;}.plugin-header.top-nav .dropdown-btn:after {top: 22px;}.plugin-header.top-nav {padding: 0 .5em; overflow: visible; z-index: 100;}.plugin-header .dropdown {position: relative; display: inline-block;}.plugin-header .dropdown.is-active .dropdown-menu {pointer-events: auto; display: block;}.plugin-header .dropdown-btn:after {font-family: \'CalciteWebCoreIcons\'; padding-right: 0.5166666667em; speak: none; font-style: normal; font-weight: normal; font-variant: normal; text-transform: none; -webkit-font-smoothing: antialiased; -moz-osx-font-smoothing: grayscale;}.plugin-header .dropdown-btn:after {padding-right: 0; padding-left: 0.5166666667em;}.plugin-header .dropdown-btn {padding-right: 2em; cursor: pointer; position: relative;}.jimu-rtl .plugin-header .dropdown-btn{padding-right: 0; padding-left: 2em;}.plugin-header .dropdown-btn:after {font-size: 0.8125em; line-height: 1.55em; position: absolute; right: .75em;}.jimu-rtl .plugin-header .dropdown-btn:after{right: auto; left: 0.75em;}.plugin-header .dropdown-menu {position: absolute; left: 0; right: auto; min-width: 200px; max-width: 300px; margin-top: -12px; top: 100%; -webkit-box-shadow: 0 0 16px 0 rgba(0, 0, 0, 0.05); -moz-box-shadow: 0 0 16px 0 rgba(0, 0, 0, 0.05); box-shadow: 0 0 16px 0 rgba(0, 0, 0, 0.05); z-index: 1000; pointer-events: none; display: none;}.jimu-rtl .plugin-header .dropdown-menu {left: auto; right: 0;}.plugin-header .dropdown-menu.dropdown-right {left: auto; right: 0;}.jimu-rtl .plugin-header .dropdown-menu.dropdown-right {left: 0; right: auto;}.plugin-header .dropdown-home .dropdown-btn {padding-top: 1em;}.plugin-header .side-nav, .plugin-header .dropdown-menu {-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; padding: 0; border: 1px solid #efefef; border-top: none; background-color: white;}.plugin-header .side-nav-title {margin: 0; padding: 0.5166666667em; font-size: 0.9375em; line-height: 1.55em; background-color: #f8f8f8; border-top: 1px solid #efefef;}.plugin-header .side-nav-link, .plugin-header .dropdown-link {position: relative; display: block; -webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; padding: 0.5166666667em 1.55em 0.5166666667em 0.5166666667em; font-size: 0.875em; line-height: 1.55em; color: #6e6e6e; background-color: white; border-top: 1px solid #efefef; -webkit-transition: all 150ms linear; transition: all 150ms linear; text-decoration: none; cursor: pointer;}.plugin-header .side-nav-link:after, .plugin-header .dropdown-link:after {content: "\\00BB"; opacity: 0; position: absolute; right: 0; top: .5em; padding: 0 0.3875em; -webkit-transition: all 150ms linear; transition: all 150ms linear;}.plugin-header .side-nav-link:hover, .plugin-header .dropdown-link:hover {text-decoration: none; color: #828282;}.plugin-header .side-nav-link:hover:after, .plugin-header .dropdown-link:hover:after {opacity: 1;}.plugin-header .side-nav-link.is-active, .plugin-header .is-active.dropdown-link {background-color: #d2e9f9; font-weight: inherit !important;}.plugin-header .dropdown-link {white-space: nowrap;}.plugin-header .dropdown-link-external {padding: 0.5166666667em 2em !important;}.plugin-header .dropdown-link-external-icon {position: absolute; left: .5em;}.plugin-header.top-nav {border-bottom: 1px solid #efefef;}.plugin-header.top-nav .esri-logo {margin-top: 1em;}.plugin-header.top-nav .sign-in {padding-top: 1.55em;}.plugin-header .top-nav-title {font-size: 1em; float: left; padding-top: 15px; padding-bottom: 15px; line-height: 1.5em; color: #4c4c4c;}.plugin-header .top-nav-title:hover {color: #3b8fc4; background: url(\'./images/top-nav-ie9.gif\') repeat-x bottom left transparent; text-decoration: none;}.plugin-header .top-nav-title.icon-ui-menu:before {vertical-align: -1px; padding-right: .5em;}.plugin-header .top-nav-list {padding: 0; float: left;}.plugin-header .top-nav-list .top-nav-link + .top-nav-link {margin-left: .75em;}.plugin-header .top-nav-link {font-size: 0.9375em; line-height: 1.55em; color: #4c4c4c; padding: 19px 0; line-height: 1.5em; display: inline-block;}.plugin-header .top-nav-link:hover, .plugin-header .top-nav-link:focus {color: #3b8fc4; background: url(\'./images/top-nav-ie9.gif\') repeat-x bottom left transparent; text-decoration: none;}.plugin-header .top-nav-link:hover a, .plugin-header .top-nav-link:focus a {color: #3b8fc4;}.plugin-header .top-nav-link:focus {outline: none;}.plugin-header .top-nav-link.is-active {background: url(\'./images/top-nav-ie9.gif\') repeat-x bottom left transparent;}.plugin-header .top-nav-link a {color: #4c4c4c;}.plugin-header .top-nav-link a:hover {text-decoration: none;}.plugin-header .top-nav-link.dropdown-btn {padding-right: 1em;}.plugin-header .top-nav-link.dropdown-btn:after {right: 0;}.plugin-header .user-nav-name {padding: 0.3875em;}.plugin-header .user-nav-image {width: 1.55em; height: 1.55em; margin-right: 0.3875em; vertical-align: -0.3875em;}.plugin-header .link-blue a, .plugin-header a.link-blue {color: #3b8fc4;}.plugin-header .link-blue a:hover, .plugin-header a.link-blue:hover {color: #196fa6;}.plugin-header .link-darkest-gray a,.plugin-header a.link-darkest-gray {color: #595959;}.plugin-header .link-darkest-gray a:hover, .plugin-header a.link-darkest-gray:hover {color: #4c4c4c;}.plugin-header .text-ellipsis {white-space: nowrap; overflow: hidden; text-overflow: ellipsis;}.plugin-header .font-size--3 {font-size: 0.8125em; line-height: 1.55em;}.plugin-header .font-size--2 {font-size: 0.875em; line-height: 1.55em;}.plugin-header .font-size--1 {font-size: 0.9375em; line-height: 1.55em;}.plugin-header .font-size-0 {font-size: 1em; line-height: 1.55em;}.plugin-header .font-size-1 {font-size: 1.1875em; line-height: 1.55em;}.plugin-header .font-size-2 {font-size: 1.25em;}.plugin-header .font-size-3 {font-size: 1.484375em; line-height: 2.325em;}.plugin-header .leader-half {margin-top: 11px;}.plugin-header .trailer-half {margin-bottom: 0.775em;}.plugin-header .padding-leader-half {padding-top: 0.775em;}.plugin-header .padding-trailer-half {padding-bottom: 0.775em;}.plugin-header .leader-0 {margin-top: 0em;}.plugin-header .trailer-0 {margin-bottom: 0em;}.plugin-header .padding-leader-0 {padding-top: 0em;}.plugin-header .padding-trailer-0 {padding-bottom: 0em;}.plugin-header .leader-1 {margin-top: 14px;}.plugin-header .padding-leader-1 {padding-top: 22px;}.plugin-header .gutter-left-half {padding-left: 0.5em;}.plugin-header .gutter-right-half {padding-right: 0.5em;}.plugin-header .gutter-left-0 {padding-left: 0em;}.plugin-header .gutter-right-0 {padding-right: 0em;}.plugin-header .gutter-left-1 {padding-left: 1em;}.plugin-header .gutter-right-1 {padding-right: 1em;}.plugin-header .gutter-right-2 {padding-right: 2em;}.jimu-rtl .plugin-header .gutter-left-half {padding-left: 0; padding-right: 0.5em;}.jimu-rtl .plugin-header .gutter-right-half {padding-right: 0; padding-left: 0.5em;}.jimu-rtl .plugin-header .gutter-left-0 {padding-left: 0; padding-right: 0;}.jimu-rtl .plugin-header .gutter-right-0 {padding-left: 0; padding-right: 0;}.jimu-rtl .plugin-header .gutter-left-1 {padding-left: 0; padding-right: 1em;}.jimu-rtl .plugin-header .gutter-right-1 {padding-right: 0; padding-left: 1em;}.jimu-rtl .plugin-header .gutter-right-2 {padding-right: 0; padding-left: 2em;}.jimu-rtl .plugin-header .left {float: right;}.jimu-rtl .plugin-header .right {float: left;}.jimu-rtl .plugin-header .top-nav-title {float: right;}.jimu-rtl .plugin-header .top-nav-link {float: right;}.jimu-rtl .plugin-header .top-nav-list {float: right;}.jimu-rtl .plugin-header .top-nav-link + .top-nav-link {margin-left: 0; margin-right: .75em;}.jimu-rtl .plugin-header .gutter-left-half {padding-right: 0.5em;}.jimu-rtl .plugin-header .gutter-right-half {padding-left: 0.5em;}.jimu-rtl .plugin-header .gutter-left-0 {padding-right: 0em;}.jimu-rtl .plugin-header .gutter-right-0 {padding-left: 0em;}.jimu-rtl .plugin-header .gutter-left-1 {padding-right: 1em;}.jimu-rtl .plugin-header .gutter-right-1 {padding-left: 1em; padding-right: 0.5em;}.jimu-rtl .plugin-header .gutter-right-2 {padding-left: 2em;}.jimu-rtl .plugin-header .top-nav-link.dropdown-btn:after {left: 0; right: auto; padding-right: 0.5166666667em; padding-left: 0;}.jimu-rtl .plugin-header .top-nav-link.dropdown-btn {padding-left: 1em; padding-right: 0;}.jimu-rtl .plugin-header .side-nav-link:after, .jimu-rtl .plugin-header .dropdown-link:after {left: 0; right: auto;}.jimu-rtl .plugin-header .side-nav-link, .jimu-rtl .plugin-header .dropdown-link {padding: 0.5166666667em 0.5166666667em 0.5166666667em 2.5em;}.jimu-rtl .plugin-header [class^\x3d"icon-ui-"]:before, .jimu-rtl .plugin-header [class*\x3d" icon-ui-"]:before {padding-right: 0; padding-left: 0.5166666667em;}.jimu-rtl .plugin-header .sub-nav-link, .jimu-rtl .plugin-header a.sub-nav-link {float: right;}.jimu-rtl .plugin-header .dropdown-link-external-icon {left: auto; right: .5em;}.plugin-header.top-nav .hidden {display: none;}.plugin-header .top-nav-logo {padding-left: 36px; padding-right: 15px; background: url(images/logo.png) no-repeat left center;}.plugin-header .top-nav-logo:hover {background: url(images/logo.png) no-repeat left center;}.plugin-header.xt.app-opened .top-nav-logo{cursor: pointer;}.jimu-rtl .plugin-header .top-nav-logo {padding-left: 15px; padding-right: 36px; background: url(images/logo.png) no-repeat right center;}.jimu-rtl .plugin-header .top-nav-logo {background: url(images/logo.png) no-repeat right center;}.plugin-header .content-box {box-sizing: content-box !important;}.plugin-header .app-name {max-width: 60%;}.plugin-header .app-name a{color: black;}.plugin-header .app-name a.highlight:hover{color: #3b8fc4;}@media screen and (max-width: 960px) {.plugin-header .app-name {max-width: 40%;}}@media screen and (max-width: 720px) {.plugin-header .app-name {max-width: 30%;}}.plugin-header .top-nav-logo{position: relative; top: 1px;}.plugin-header .top-nav-username{font-size: 14px;}.plugin-header .top-nav-username img{position: relative; top: 3px;}.plugin-header .top-nav-username span{position: relative;}.plugin-header.app-not-opened{background-color: #333333;}.plugin-header.app-not-opened .top-nav-link.top-nav-logo{color: #ffffff !important;}.plugin-header.app-not-opened .switch-section .switch-container .applist-switch{color: #999999;}.plugin-header.app-not-opened .switch-section .switch-container .applist-switch.selected{color: #ffffff;}.plugin-header.app-not-opened .top-nav-link.top-nav-username{color: #999999 !important;}',
"url:builder/plugins/map-config/Plugin.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"map-info-section"\x3e\r\n    \x3cdiv class\x3d"map-selected-meta-data"\x3e\r\n      \x3cdiv class\x3d"thumbnail-container" data-dojo-attach-point\x3d"thumbnailContainer" data-dojo-attach-event\x3d"click:showMapSelector" title\x3d"${nls.clickChooseWebMapOrWebScene}"\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"detail-info"\x3e\r\n        \x3cdiv style\x3d"overflow:hidden;"\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"webItemIcon" class\x3d"web-item-icon jimu-float-leading"\x3e\x3c/div\x3e\r\n          \x3cdiv class\x3d"owner-div jimu-float-leading" style\x3d"width:140px;"\x3e\r\n            \x3cspan class\x3d"item-type" data-dojo-attach-point\x3d"webItemType"\x3e\x3c/span\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"owner-link-div"\x3e\r\n          \x3cspan class\x3d"owner-tip"\x3e${nls.owner}\x3c/span\x3e\r\n          \x3ca class\x3d"owner-name" href\x3d"#" target\x3d"_blank" data-dojo-attach-point\x3d"ownerName"\x3e\x3c/a\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv style\x3d"margin-top:5px;color:#596679;"\x3e\r\n          \x3cspan\x3e${nls.lastModified}:\x3c/span\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"lastModified" class\x3d"last-modified"\x3e\x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"webmap-details-div"\x3e\r\n          \x3ca data-dojo-attach-point\x3d"webMapDetails" href\x3d"#" target\x3d"_blank" class\x3d"webmap-details" title\x3d"${nls.moreDetails}"\x3e${nls.moreDetails}...\x3c/a\x3e\r\n        \x3c/div\x3e\r\n\r\n        \x3cdiv class\x3d"map-chooser"\x3e\r\n          \x3cdiv nowrap class\x3d"choose-map-btn" data-dojo-attach-event\x3d"click:showMapSelector"\x3e\r\n            \x3cdiv class\x3d"label" data-dojo-attach-point\x3d"chooseMapButton" title\x3d"${nls.chooseWebMapOrWebScene}"\x3e${nls.chooseWebMapOrWebScene}\x3c/div\x3e\r\n            \x3cdiv class\x3d"options jimu-float-trailing" data-dojo-attach-point\x3d"mapOptions" data-dojo-attach-event\x3d"click:showMapOptions"\x3e\x3c/div\x3e\r\n          \x3c/div\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"webMapEditOptions" class\x3d"edit-options" style\x3d"display: none;"\x3e\r\n            \x3cdiv nowrap class\x3d"option-item" data-dojo-attach-point\x3d"btnEditWebMap" data-dojo-attach-event\x3d"click:editWebMap" title\x3d"${nls.editMap}"\x3e${nls.editMap}\x3c/div\x3e\r\n            \x3cdiv nowrap class\x3d"option-item" data-dojo-attach-point\x3d"btnCreateWebMap" data-dojo-attach-event\x3d"click:createWebMap" title\x3d"${nls.createMap}"\x3e${nls.createMap}\x3c/div\x3e\r\n          \x3c/div\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"webMapOptionsMask" class\x3d"overlay-mask" data-dojo-attach-event\x3d"click:hideMapOptions" style\x3d"display: none;"\x3e\x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"map-info-content"\x3e\r\n      \x3cdiv class\x3d"map-info-title option-title" data-dojo-attach-point\x3d"mapTitle"\x3e\x3c/div\x3e\r\n      \x3cp class\x3d"snippet" data-dojo-attach-point\x3d"snippet"\x3e\x3c/p\x3e\r\n      \x3cdiv class\x3d"map-options" data-dojo-attach-point\x3d"mapOptions2D"\x3e\r\n        \x3cdiv class\x3d"map-option extent-option"\x3e\r\n          \x3cdiv class\x3d"option-title"\x3e${nls.setInitialExtent}\x3c/div\x3e\r\n          \x3cp class\x3d"option-statement"\x3e${nls.statement}\x3c/p\x3e\r\n          \x3cspan class\x3d"jimu-btn init-ext-btn jimu-btn-vacation" data-dojo-attach-event\x3d"onclick:_useCurrentMapExtent"\x3e${nls.useCurrentExtent}\x3c/span\x3e\x3cbr\x3e\r\n          \x3cspan class\x3d"jimu-btn restore-ext-btn jimu-btn-vacation" data-dojo-attach-event\x3d"onclick:_useDefaultMapExtent"\x3e${nls.restoreInitialExtent}\x3c/span\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"map-option scale-option"\x3e\r\n          \x3cdiv class\x3d"option-title"\x3e${nls.scaleTitle}\x3c/div\x3e\r\n          \x3cp class\x3d"option-statement"\x3e${nls.scaleStatement}\x3c/p\x3e\r\n          \x3cspan class\x3d"jimu-btn scale-btn jimu-btn-vacation" data-dojo-attach-point\x3d"btnScale" data-dojo-attach-event\x3d"onclick:_onBtnScaleClicked"\x3e${nls.customize}...\x3c/span\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv data-dojo-type\x3d"builder/dijit/RefreshInterval" data-dojo-attach-point\x3d"refreshIntervalDijit"\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"map-options" data-dojo-attach-point\x3d"mapOptions3D"\x3e\r\n        \x3cdiv class\x3d"map-option extent-option"\x3e\r\n          \x3cdiv class\x3d"option-title"\x3e${nls.setInitialSceneState}\x3c/div\x3e\r\n          \x3cp class\x3d"option-statement"\x3e${nls.sceneStateTip}\x3c/p\x3e\r\n          \x3cspan class\x3d"jimu-btn init-ext-btn jimu-btn-vacation" title\x3d"${nls.useCurrentSceneState}" data-dojo-attach-event\x3d"onclick:_useCurrentViewpoint"\x3e${nls.useCurrentSceneState}\x3c/span\x3e\x3cbr\x3e\r\n          \x3cspan class\x3d"jimu-btn restore-ext-btn jimu-btn-vacation" title\x3d"${nls.useWebSceneDefaultState}" data-dojo-attach-event\x3d"onclick:_useDefaultViewpoint"\x3e${nls.useWebSceneDefaultState}\x3c/span\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:builder/plugins/map-config/MapSelector.html":'\x3cdiv style\x3d"position:relative;width:100%;height:100%;"\x3e\r\n\t\x3cdiv class\x3d"map-setting-tab-container" style\x3d"width:100%;height:100%;"\x3e\r\n\t\t\x3cdiv data-dojo-attach-point\x3d"tabNode"\x3e\x3c/div\x3e\r\n\r\n\t\t\x3cdiv class\x3d"tab-content mycontent-tab" data-dojo-attach-point\x3d"mycontentTabNode"\x3e\r\n\t\t\t\x3cdiv class\x3d"tab-content-main mycontent-tab-content-main"\x3e\r\n\t\t\t\t\x3cdiv class\x3d"search-section"\x3e\r\n\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"mycontentSearch" data-dojo-type\x3d"jimu/dijit/Search" data-dojo-props\x3d\'searchWhenInput:false\' data-dojo-attach-event\x3d"onSearch:_onMyContentSearch" class\x3d"jimu-float-leading"\x3e\x3c/div\x3e\r\n\t\t\t\t\t\x3cdiv class\x3d"refresh-icon jimu-float-trailing" data-dojo-attach-event\x3d"click:_onMyContentRefreshIconClicked"\x3e\x3c/div\x3e\r\n\t\t\t\t\t\x3cselect data-dojo-type\x3d"dijit/form/Select" data-dojo-attach-point\x3d"mycontentSelect" data-dojo-attach-event\x3d"change:_onMyContentSearch" class\x3d"jimu-float-trailing restrict-select-width"\x3e\r\n\t\t\t\t\t\t\x3coption value\x3d"modified" selected\x3d"true"\x3e${nls.mostRecent}\x3c/option\x3e\r\n\t\t\t\t\t\t\x3coption value\x3d"numviews"\x3e${nls.mostViewed}\x3c/option\x3e\r\n\t\t\t\t\t\t\x3coption value\x3d"avgrating"\x3e${nls.highestRated}\x3c/option\x3e\r\n\t\t\t\t\t\t\x3coption value\x3d"title"\x3e${nls.title}\x3c/option\x3e\r\n\t\t\t\t\t\t\x3coption value\x3d"owner"\x3e${nls.owner}\x3c/option\x3e\r\n\t\t\t\t\t\x3c/select\x3e\r\n\t\t\t\t\x3c/div\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"mycontentMapTable" data-dojo-type\x3d"builder/plugins/map-config/MapTable" data-dojo-props\x3d"type:\'${type}\'"  style\x3d"top:65px;"\x3e\x3c/div\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\r\n\t\t\x3cdiv class\x3d"tab-content organization-tab" data-dojo-attach-point\x3d"organizationTabNode"\x3e\r\n\t\t\t\x3cdiv class\x3d"tab-content-main organization-tab-content-main"\x3e\r\n\t\t\t\t\x3cdiv class\x3d"search-section"\x3e\r\n\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"organizationSearch" data-dojo-type\x3d"jimu/dijit/Search" data-dojo-props\x3d\'searchWhenInput:false\' data-dojo-attach-event\x3d"onSearch:_onOrganizationSearch" class\x3d"jimu-float-leading"\x3e\x3c/div\x3e\r\n\t\t\t\t\t\x3cdiv class\x3d"refresh-icon jimu-float-trailing" data-dojo-attach-event\x3d"click:_onOrgRefreshIconClicked"\x3e\x3c/div\x3e\r\n\t\t\t\t\t\x3cselect data-dojo-type\x3d"dijit/form/Select" data-dojo-attach-point\x3d"organizationSelect" data-dojo-attach-event\x3d"change:_onOrganizationSearch" class\x3d"jimu-float-trailing restrict-select-width"\x3e\r\n\t\t\t\t\t\t\x3coption value\x3d"modified" selected\x3d"true"\x3e${nls.mostRecent}\x3c/option\x3e\r\n\t\t\t\t\t\t\x3coption value\x3d"numviews"\x3e${nls.mostViewed}\x3c/option\x3e\r\n\t\t\t\t\t\t\x3coption value\x3d"avgrating"\x3e${nls.highestRated}\x3c/option\x3e\r\n\t\t\t\t\t\t\x3coption value\x3d"title"\x3e${nls.title}\x3c/option\x3e\r\n\t\t\t\t\t\t\x3coption value\x3d"owner"\x3e${nls.owner}\x3c/option\x3e\r\n\t\t\t\t\t\x3c/select\x3e\r\n\t\t\t\t\x3c/div\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"organizationMapTable" data-dojo-type\x3d"builder/plugins/map-config/MapTable" data-dojo-props\x3d"type:\'${type}\'" style\x3d"top:65px;"\x3e\x3c/div\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\r\n\t\t\x3cdiv class\x3d"tab-content group-tab" data-dojo-attach-point\x3d"groupTabNode"\x3e\r\n\t\t\t\x3cdiv class\x3d"tab-content-main group-tab-content-main"\x3e\r\n\t\t\t\t\x3cdiv class\x3d"groups-section" style\x3d"position:absolute;width:100%;top:70px;" data-dojo-attach-point\x3d"groupsSection"\x3e\r\n\t\t\t\t\t\x3cspan\x3e${nls.groups}:\x3c/span\x3e\r\n\t\t\t\t\t\x3cselect class\x3d"groups-select" data-dojo-attach-point\x3d"groupsSelect"\x3e\r\n\t\t\t\t\t\t\x3coption value\x3d"nodata"\x3e${nls.noneGroups}\x3c/option\x3e\r\n\t\t\t\t\t\x3c/select\x3e\r\n\t\t\t\t\x3c/div\x3e\r\n\t\t\t\t\x3cdiv class\x3d"search-section" data-dojo-attach-point\x3d"groupSearchSection"\x3e\r\n\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"groupSearch" data-dojo-type\x3d"jimu/dijit/Search" data-dojo-props\x3d\'searchWhenInput:false\' data-dojo-attach-event\x3d"onSearch:_onGroupSearch" class\x3d"jimu-float-leading"\x3e\x3c/div\x3e\r\n\t\t\t\t\t\x3cdiv class\x3d"refresh-icon jimu-float-trailing" data-dojo-attach-event\x3d"click:_onGroupRefreshIconClicked"\x3e\x3c/div\x3e\r\n\t\t\t\t\t\x3cselect data-dojo-type\x3d"dijit/form/Select" data-dojo-attach-point\x3d"groupSelect" data-dojo-attach-event\x3d"change:_onGroupSearch" class\x3d"jimu-float-trailing restrict-select-width"\x3e\r\n\t\t\t\t\t\t\x3coption value\x3d"modified" selected\x3d"true"\x3e${nls.mostRecent}\x3c/option\x3e\r\n\t\t\t\t\t\t\x3coption value\x3d"numviews"\x3e${nls.mostViewed}\x3c/option\x3e\r\n\t\t\t\t\t\t\x3coption value\x3d"avgrating"\x3e${nls.highestRated}\x3c/option\x3e\r\n\t\t\t\t\t\t\x3coption value\x3d"title"\x3e${nls.title}\x3c/option\x3e\r\n\t\t\t\t\t\t\x3coption value\x3d"owner"\x3e${nls.owner}\x3c/option\x3e\r\n\t\t\t\t\t\x3c/select\x3e\r\n\t\t\t\t\x3c/div\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"groupMapTable" data-dojo-type\x3d"builder/plugins/map-config/MapTable" data-dojo-props\x3d"type:\'${type}\'" style\x3d"top:113px;"\x3e\x3c/div\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\r\n\t\t\x3cdiv class\x3d"tab-content public-tab" data-dojo-attach-point\x3d"publicTabNode"\x3e\r\n\t\t\t\x3cdiv class\x3d"tab-content-main public-tab-content-main"\x3e\r\n\t\t\t\t\x3cdiv class\x3d"search-section"\x3e\r\n\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"publicSearch" data-dojo-type\x3d"jimu/dijit/Search" data-dojo-props\x3d\'searchWhenInput:false\' data-dojo-attach-event\x3d"onSearch:_onPublicSearch" class\x3d"jimu-float-leading"\x3e\x3c/div\x3e\r\n\t\t\t\t\t\x3cdiv class\x3d"refresh-icon jimu-float-trailing" data-dojo-attach-event\x3d"click:_onPublicRefreshIconClicked"\x3e\x3c/div\x3e\r\n\t\t\t\t\t\x3cselect data-dojo-type\x3d"dijit/form/Select" data-dojo-attach-point\x3d"publicSelect" data-dojo-attach-event\x3d"change:_onPublicSearch" class\x3d"jimu-float-trailing restrict-select-width"\x3e\r\n\t\t\t\t\t\t\x3coption value\x3d"modified"\x3e${nls.mostRecent}\x3c/option\x3e\r\n\t\t\t\t\t\t\x3coption value\x3d"numviews" selected\x3d"true"\x3e${nls.mostViewed}\x3c/option\x3e\r\n\t\t\t\t\t\t\x3coption value\x3d"avgrating"\x3e${nls.highestRated}\x3c/option\x3e\r\n\t\t\t\t\t\t\x3coption value\x3d"title"\x3e${nls.title}\x3c/option\x3e\r\n\t\t\t\t\t\t\x3coption value\x3d"owner"\x3e${nls.owner}\x3c/option\x3e\r\n\t\t\t\t\t\x3c/select\x3e\r\n\t\t\t\t\x3c/div\x3e\r\n\t\t\t\t\x3cdiv class\x3d"public-search-radios"\x3e\r\n\t\t\t\t\t\x3cinput data-dojo-attach-point\x3d"portalPublicRaido" type\x3d"radio" name\x3d"publicSearchRaido" class\x3d"jimu-float-leading portal-public-radio jimu-radio-btn" /\x3e\r\n\t\t\t\t\t\x3clabel  data-dojo-attach-point\x3d"portalNameLabel" class\x3d"jimu-float-leading portal-name"\x3ePortal\x3c/label\x3e\r\n\t\t\t\t\t\x3cinput data-dojo-attach-point\x3d"onlinePublicRaido" type\x3d"radio" name\x3d"publicSearchRaido" class\x3d"jimu-float-leading online-public-radio jimu-radio-btn" /\x3e\r\n\t\t\t\t\t\x3clabel data-dojo-attach-point\x3d"onlineNameLabel" class\x3d"jimu-float-leading online-name"\x3eArcGIS Online\x3c/label\x3e\r\n\t\t\t\t\x3c/div\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"publicMapSection" class\x3d"public-map-section"\x3e\r\n\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"publicPortalMapTable" data-dojo-type\x3d"builder/plugins/map-config/MapTable" data-dojo-props\x3d"type:\'${type}\'"\x3e\x3c/div\x3e\r\n\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"publicOnlineMapTable" data-dojo-type\x3d"builder/plugins/map-config/MapTable" data-dojo-props\x3d"type:\'${type}\'"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3c/div\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\r\n\t\x3c/div\x3e\r\n\t\x3cdiv class\x3d"signin-section hidden" data-dojo-attach-point\x3d"signinSection"\x3e\r\n\t\t\x3cdiv class\x3d"signin-tip"\x3e${nls.signInTip}\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e',
"url:builder/plugins/map-config/MapTable.html":'\x3cdiv\x3e\r\n\t\x3cdiv class\x3d"maps-section" data-dojo-attach-point\x3d"allMapsSection"\x3e\r\n\t\t\x3cdiv class\x3d"maps-table-div" data-dojo-attach-point\x3d"allMapsTableDiv"\x3e\r\n\t\t\t\x3ctable class\x3d"maps-table" cellpadding\x3d"10" data-dojo-attach-point\x3d"allMapsTable"\x3e\r\n\t\t\t\t\x3ctbody class\x3d"maps-tbody" data-dojo-attach-point\x3d"allMapsTbody"\x3e\x3c/tbody\x3e\r\n\t\t\t\x3c/table\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cdiv data-dojo-type\x3d"jimu/dijit/LoadingIndicator" data-dojo-attach-point\x3d"allMapsShelter" data-dojo-props\x3d\'hidden:true\'\x3e\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv class\x3d"maps-section hidden" data-dojo-attach-point\x3d"filteredMapsSection"\x3e\r\n\t\t\x3cdiv class\x3d"maps-table-div" data-dojo-attach-point\x3d"filteredMapsTableDiv"\x3e\r\n\t\t\t\x3ctable class\x3d"maps-table" cellpadding\x3d"10" data-dojo-attach-point\x3d"filteredMapsTable"\x3e\r\n\t\t\t\t\x3ctbody class\x3d"maps-tbody" data-dojo-attach-point\x3d"filteredMapsTbody"\x3e\x3c/tbody\x3e\r\n\t\t\t\x3c/table\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d"search-none-tip-section hidden" data-dojo-attach-point\x3d"searchNoneTipSection"\x3e\r\n\t\t\t\x3cspan class\x3d"search-none-icon jimu-icon jimu-icon-error"\x3e\x3c/span\x3e\r\n\t\t\t\x3cspan class\x3d"search-none-tip"\x3e${nls.searchNone}\x3c/span\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cdiv data-dojo-type\x3d"jimu/dijit/LoadingIndicator" data-dojo-attach-point\x3d"filteredMapsShelter" data-dojo-props\x3d\'hidden:true\'\x3e\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e',
"url:builder/plugins/map-config/CustomizeScale.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"scale-input-div" data-dojo-attach-point\x3d"scaleInputDiv"\x3e\r\n    \x3cdiv class\x3d"add-btn jimu-float-leading" data-dojo-attach-point\x3d"btnAdd" data-dojo-attach-event\x3d"onclick:_onBtnAddClicked"\x3e+\x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"operations-div"\x3e\r\n    \x3cdiv class\x3d"jimu-float-leading operation-btn delete-btn" data-dojo-attach-point\x3d"btnDelete" data-dojo-attach-event\x3d"onclick:_onBtnDeleteClicked"\x3e\r\n      \x3cspan class\x3d"jimu-float-leading icon"\x3e\x3c/span\x3e\r\n      \x3cspan class\x3d"jimu-float-leading label"\x3e${nls.deleteTip}\x3c/span\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"jimu-float-leading operation-btn reset-btn" data-dojo-attach-event\x3d"onclick:_onBtnResetClicked"\x3e\r\n      \x3cspan class\x3d"jimu-float-leading icon"\x3e\x3c/span\x3e\r\n      \x3cspan class\x3d"jimu-float-leading label"\x3e${nls.resetTip}\x3c/span\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"list" data-dojo-attach-point\x3d"listNode" data-dojo-attach-event\x3d"onclick:_onLodListClicked"\x3e\x3c/div\x3e\r\n\x3c/div\x3e',
"url:builder/plugins/map-config/css/style.css":".map-config{margin: 0; padding: 0; overflow-y: hidden;}.map-config .hidden{display: none;}.map-config .map-info-section{position:absolute; left: 20px; right: 20px; top: 20px; bottom: 0;}.map-config .big-img{position:relative; width:100%; height:240px; -webkit-border-radius:5px; -moz-border-radius:5px; -o-border-radius:5px; -ms-border-radius:5px; border-radius:5px; background:#e5e5e5;}.map-config .add-map-tip{margin-top:13px; padding-left:6px; padding-right:6px; color:#999999; font-size:12px;}.map-config .map-selected-meta-data{position: relative; width: 100%; height: 133px;}.map-config .thumbnail-container{position:absolute; left: 0; right: auto; top: 0; width:190px; height:133px; cursor: pointer;}.jimu-rtl .map-config .thumbnail-container{left: auto; right: 0;}.map-config .thumbnail-container .thumbnail{width: 100%; height: 100%; background-color:#e5e5e5; border:1px solid #d2dae2; background-repeat:no-repeat; background-position:center center; background-size:cover;}.map-config .thumbnail-container .thumbnail.default-webmap{background-image: url(images/WebMapThumbnail.png);}.map-config .thumbnail-container .thumbnail.default-webscene{background-image: url(images/WebSceneThumbnail.jpeg);}.map-config .detail-info{position: absolute; left: 200px; top: 0; right: 0; height: 100%; color: #333333; font-size: 12px;}.has-mozilla .map-config .detail-info{font-size: 12px;}.jimu-rtl .map-config .detail-info{left: 0; right: 200px;}.map-config .web-item-icon{display: inline-block; width: 16px; height: 16px; background-position: center center; background-repeat: no-repeat;}.map-config .web-item-icon.webmap{background-image: url(images/WebMapIcon.png);}.map-config .web-item-icon.webscene{background-image: url(images/WebSceneIcon.png);}.map-config .owner-div{padding-left: 5px; color: #596679;}.jimu-rtl .map-config .owner-div{padding-left: 0; padding-right: 5px;}.map-config .owner-link-div{white-space: nowrap; overflow: hidden; text-overflow: ellipsis; margin-top: 5px;}.map-config .owner-link-div .owner-name{color: #24B5CC; text-decoration: none;}.map-config .owner-link-div .owner-name:hover{text-decoration: underline;}.map-config .last-modified{white-space: nowrap; overflow: hidden; text-overflow: ellipsis;}.map-config .webmap-details-div{margin-top:5px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;}html.ar .map-config .webmap-details-div{margin-top: 0;}.map-config .webmap-details{text-decoration: none; color: #24B5CC;}.map-config .webmap-details:hover{text-decoration: underline;}.map-config .map-info-content{position: absolute; width: 100%; left: 0; right: 0; top: 143px; bottom: 0; overflow: auto;}.map-config .snippet{max-height:115px; overflow: hidden; text-overflow: ellipsis; margin-top: 10px; font-size:12px; color: #666;}.map-config .map-options{display: none;}.map-config .map-options.enabled{display: block;}.map-config .extent-option{margin-top: 33px;}.map-config .option-title{font-size: 14px; color: #000; font-family: 'Avenir Medium';}.map-config .option-statement{font-size: 12px; color: #999; margin-top: 9px;}.map-config .init-ext-btn{margin-top:10px;}.map-config .restore-ext-btn{margin-top:10px;}.map-config .scale-option{margin-top: 38px;}.map-config .scale-btn{margin-top: 10px;}.map-config .refresh-interval{margin-top: 38px; margin-bottom: 30px;}.map-config .map-chooser{position: absolute; left: 0; bottom: 0; width: 100%;}.map-config .overlay-mask{position: fixed; width: 100%; height: 100%; left: 0; top: 0; z-index: 119;}.map-config .edit-options{box-shadow: 0 0 16px rgba(160,160,160,0.4); background-color: white; z-index: 120; width: 160px; position: absolute; left: 0; top: 36px;}.jimu-rtl .map-config .edit-options{left: auto; right: 0;}.map-config .edit-options \x3e .option-item{width: 100%; height: 36px; cursor: pointer; line-height: 36px; font-size: 14px; white-space:nowrap; overflow:hidden; text-align: left; text-overflow: ellipsis; background-color: #24B5CC; color: #ffffff; border-top: 2px solid #ffffff; padding: 0 10px;}.jimu-rtl .map-config .edit-options \x3e .option-item{text-align: right;}.map-config .edit-options \x3e .option-item:hover{background-color: #0090A7;}.map-config .choose-map-btn{width: 160px; height: 36px; overflow:hidden; text-align: center; background-color: #24B5CC; cursor: pointer;}.map-config .choose-map-btn .label{display: inline-block; line-height: 36px; text-overflow: ellipsis; white-space:nowrap; font-size: 14px; color: #ffffff; max-width: 140px; padding: 0 5px; overflow: hidden;}.map-config .choose-map-btn .label:hover{background-color: #0090A7;}.map-config .choose-map-btn .options{display: inline-block; height: 36px; background: url('images/v-White.png') no-repeat center; width: 20px; border-left: 1px solid rgba(255, 255, 255, 0.3);}.map-config .choose-map-btn .options:hover{background-color: #0090A7;}.jimu-rtl .map-config .choose-map-btn .options{border-left: none; border-right: 1px solid rgba(255, 255, 255, 0.3);}.map-config .jimu-btn{padding: 0 15px; font-size: 14px; line-height: 34px; text-align: center; max-width: 100%;}.map-config .jimu-btn.jimu-btn-vacation:hover{background-color: #0090A7; color: white; border-color: #0090A7;}.map-config .jimu-btn.jimu-btn-vacation.jimu-state-disabled{background: #E0E0E0; color: #666;}.map-config .map-info-title{margin-top:10px;}.map-config .option-title.map-info-title{font-size: 12px;}.map-config .set-extent-tip{color:#999999; font-size:12px;}.map-config .description{position:absolute; top:420px; bottom:0; width:100%; overflow:auto; color:#999999; font-size:12px;}.map-table{position:absolute; width: 100%; top:0; bottom: 0; height: auto;}.map-table .maps-section{position: absolute; width: 100%; top: 0; bottom: 0;}.map-table .maps-table-div{width: 100%; height: 100%; overflow-x:hidden; overflow-y:auto;}.map-table .maps-table{width: 100%; table-layout: fixed; border-collapse: collapse;}.map-table .maps-table td{vertical-align:top;}.map-table .map-item-div{width:176px; padding:3px;}.map-table .map-item-div .map-item-bg{position:relative; width:100%; height:118px; text-align:center; color:#999999; font-size:13px;}.map-table .map-item-div .map-item-bg .map-item-thumbnail{position:absolute; left:0; top:0; width:100%; height:100%; background-repeat:no-repeat; background-position:center center; border:1px solid #d2dae2; background-size:cover;}.jimu-rtl .map-table .map-item-div .map-item-bg .map-item-thumbnail{left: auto; right: 0;}.map-table .map-item-div .map-item-bg.selected .map-item-thumbnail{border:3px solid #24B5CC; -webkit-box-sizing:content-box; -moz-box-sizing:content-box; -ms-box-sizing:content-box; -o-box-sizing:content-box; box-sizing:content-box;}.map-table .map-item-div .map-item-bg .map-item-detail-icon{display: none; position:absolute; right:7px; bottom:7px; width:15px; height:15px; background-color:rgba(0, 0, 0, 0.4); background-repeat:no-repeat; background-position:center center; background-image:url(images/info.png); -webkit-border-radius:3px; -moz-border-radius:3px; -o-border-radius:3px; -ms-border-radius:3px; border-radius:3px; cursor:pointer;}.jimu-rtl .map-table .map-item-div .map-item-bg .map-item-detail-icon{right: auto; left: 7px;}.map-table .map-item-div .map-item-bg:hover .map-item-detail-icon{display: block;}.map-table .map-item-div .map-item-title{display:inline-block; width:100%; max-height: 31px; text-align:center; color:#596679; font-size:13px; margin-top: 10px; overflow: hidden; word-wrap: break-word;}.map-table .search-none-tip-section .search-none-icon{margin-left:5px;}.jimu-rtl .map-table .search-none-tip-section .search-none-icon{margin-left: 0; margin-right: 5px;}.map-table .search-none-tip-section .search-none-tip{font-size:13px; color:#ff0000; margin-left:10px;}.jimu-rtl .map-table .search-none-tip-section .search-none-tip{margin-left: 0; margin-right: 10px;}.map-selector .hidden{display: none;}.map-selector .jimu-tab3{height: 100%;}.map-selector .jimu-tab3\x3e.container-node{position:absolute; width:100%; left:0; right:0; top:60px; bottom:0;}.map-selector .jimu-tab3 .tab-item-div{height: 48px; line-height: 48px;}.map-selector .tab-content{position: relative;}.map-selector .tab-content .tab-content-main{position: absolute; width: 100%; top:0; bottom:0;}.map-selector .search-section{position:absolute; width:100%; height:45px; top: 15px; font-size: 12px;}.map-selector .search-section .jimu-search{width: 81%;}.map-selector .search-section .dijitSelect{box-sizing: border-box;}.map-selector .refresh-icon{width: 16px; height: 16px; cursor: pointer; background: url(images/reset1.png) center center no-repeat; margin-top: 12px; margin-left: 7px;}.jimu-rtl .map-selector .refresh-icon{margin-left: auto; margin-right: 7px;}.map-selector .search-section .restrict-select-width{position: relative; width: 146px; top: 5px;}.map-selector .public-search-radios{position:absolute; width:100%; top:75px; height: 20px; line-height:1em; font-size: 14px;}.map-selector .public-search-radios \x3e *{vertical-align: middle; line-height: 18px;}.map-selector .public-search-radios span{display: inline-block;}.map-selector .public-search-radios .portal-public-radio{margin-right: 10px;}.jimu-rtl .map-selector .public-search-radios .portal-public-radio{margin-right: 0; margin-left: 10px;}.map-selector .public-search-radios .portal-name{margin-right: 28px;}.jimu-rtl .map-selector .public-search-radios .portal-name{margin-right: 0; margin-left: 28px;}.map-selector .public-search-radios .online-public-radio{margin-right: 10px;}.jimu-rtl .map-selector .public-search-radios .online-public-radio{margin-right: 0; margin-left: 10px;}.map-selector .public-map-section{position:absolute; width:100%; top:100px; bottom:0;}.map-selector .signin-section{position: absolute; top:75px; width:100%;}.map-selector .signin-section .signin-tip{width:100%; color:#d6d6d6; font-size:13px;}.map-selector .groups-section{font-size: 14px;}.map-selector .groups-section .groups-select{height: 30px; padding: 0 5px;}.mapconfig-customize-scale{width: 100%; height: 100%;}.mapconfig-customize-scale .scale-input-div{position:relative; height:30px;}.mapconfig-customize-scale .add-btn{width: 30px; height: 100%; line-height: 30px; color: #ffffff; font-size: 28px; text-align: center; vertical-align: center; cursor: default; background-color: #d2dae2;}.claro .mapconfig-customize-scale .scale-input-div .dijitNumberTextBox input.dijitInputInner{text-align: left;}.jimu-rtl .claro .mapconfig-customize-scale .scale-input-div .dijitNumberTextBox input.dijitInputInner{text-align: right;}.mapconfig-customize-scale .scale-input-div:hover .add-btn{background-color: #24B5CC;}.mapconfig-customize-scale .operations-div{height: 24px; margin-top: 13px; margin-bottom: 2px;}.mapconfig-customize-scale .operation-btn{display: inline-block; overflow: hidden; height: 24px; cursor: default; font-size: 13px;}.mapconfig-customize-scale .operation-btn .icon{width: 14px; height: 100%; background-repeat: no-repeat; background-position: center center;}.mapconfig-customize-scale .delete-btn{color: #a0acbf; cursor: default;}.mapconfig-customize-scale .delete-btn.enabled-operation{color: #518dca; cursor: pointer;}.mapconfig-customize-scale .delete-btn .icon{background-image: url(images/delete1.png);}.mapconfig-customize-scale .delete-btn.enabled-operation .icon{background-image: url(images/delete2.png);}.mapconfig-customize-scale .reset-btn .icon{background-image: url(images/reset2.png);}.mapconfig-customize-scale .reset-btn{margin-left: 15px; color: #24B5CC; cursor: pointer;}.jimu-rtl .mapconfig-customize-scale .reset-btn{margin-left: 0; margin-right: 15px;}.mapconfig-customize-scale .operation-btn .label{height: 100%; line-height: 24px; vertical-align: middle; margin-left: 7px;}.jimu-rtl .mapconfig-customize-scale .operation-btn .label{margin-left: 0; margin-right: 7px;}.mapconfig-customize-scale .list{width: 100%; height: 395px; border: 1px solid #dfe4ea; background-color: #fafafc; color: #7989a0; font-size: 14px; overflow: auto;}.mapconfig-customize-scale .list .lod-item{height: 30px; line-height: 30px; padding-left: 10px; cursor: default; border-bottom: 1px solid #f2f4f7;}.mapconfig-customize-scale .list .lod-item.selected{background-color: #e3ecf2; color: #596670;}.embed-mapviewer-content {width: 100%; height: 100%; position: relative;}.embed-mapviewer-content .load-container {float: left; position: absolute; overflow: hidden; bottom: 60px; right: 20px;}.embed-mapviewer-content .load-container .loader {font-size: 20px; width: 1.5em; height: 1.5em; border-radius: 50%; position: relative; text-indent: -9999em;}",
"url:builder/plugins/popup-actions/popup-agoltemplate/css/style.css":".plugin-app-actions-template-popup .template-popup-content {height: 100%;}.plugin-app-actions-template-popup .template-popup-content .config-part {width: 70%; height: 100%;}.plugin-app-actions-template-popup .template-popup-content .privew-part-box {height: 100%; width: 30%; padding: 10px 0 10px 0;}.plugin-app-actions-template-popup .template-popup-content .privew-part-inset-box {height: 100%; width: 100%; box-shadow: 0px 0px 8px rgba(0,0,0,0.4) inset; overflow-y: auto; overflow-x: hidden; -ms-overflow-y: auto; -ms-overflow-x: hidden;}.plugin-app-actions-template-popup .template-popup-content .privew-part {width: 90%; height: 100%; min-width: 275px; max-width: 500px; margin: 0 auto;}.plugin-app-actions-template-popup-for-xt .button-container {overflow: visible;}.plugin-app-actions-template-popup-for-xt .export-btn {position: relative; overflow: visible;}.plugin-app-actions-template-popup-for-xt .export-draw-box {position: absolute; height: 60px; background-color: #cccccc; top: -61px; left: 0; cursor: default; background: #fff; box-shadow: 0 0 4px #646464; color: #7989a0; text-align: left; max-width: 270px; overflow: hidden;}.jimu-rtl .plugin-app-actions-template-popup-for-xt .export-draw-box {right: 0; left: auto;}.plugin-app-actions-template-popup-for-xt .export-draw-box.export-draw-box-hiden{display: none;}.plugin-app-actions-template-popup-for-xt .export-draw-box .export-draw-box-btn{cursor: pointer; height: 30px; padding-left: 20px; padding-right: 20px;}.plugin-app-actions-template-popup-for-xt .export-draw-box .export-draw-box-btn:hover{background: #edf2f5; color: #15a4fa;}.plugin-app-actions-template-popup-for-xt .export-draw-box .export-draw-box-btn.export-draw-box-btn-disable{color: #d2dae2;}",
"url:jimu/dijit/templates/ShareOptions.html":'\x3cdiv class\x3d"shareOptions"\x3e\r\n  \x3cdiv class\x3d"shareOptionsWrapper"\x3e\r\n    \x3cdiv class\x3d"subTitle"\x3e${nls.shareMap}\x3c/div\x3e\r\n    \x3cdiv class\x3d"tips"\x3e${nls.shareMapTips}\x3c/div\x3e\r\n    \x3cdiv id\x3d"share-everyone-check_div" class\x3d"shareOptionItems" data-dojo-attach-point\x3d"share-everyone-check_div"\x3e\r\n      \x3cinput id\x3d"share-everyone-check" data-dojo-attach-point\x3d"shareEveryoneCheck" data-dojo-type\x3d"dijit/form/CheckBox" type\x3d"checkbox"/\x3e\r\n      \x3clabel id\x3d"share-everyone-check-label" for\x3d"share-everyone-check" class\x3d"labels"\x3e${nls.everyone}\x3c/label\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv id\x3d"share-account-check_div" class\x3d"shareOptionItems displaynone" data-dojo-attach-point\x3d"share-account-check_div"\x3e\r\n      \x3cinput id\x3d"share-account-check" data-dojo-attach-point\x3d"share-account-check" data-dojo-type\x3d"dijit/form/CheckBox" type\x3d"checkbox"/\x3e\r\n      \x3clabel id\x3d"share-account-check-label" for\x3d"share-account-check" class\x3d"labels"\x3e\x3c/label\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv id\x3d"share-groups-div" class\x3d"shareOptionItems displaynone" data-dojo-attach-point\x3d"share-groups-div"\x3e\r\n      \x3cinput id\x3d"share-groups-check" data-dojo-attach-point\x3d"shareGroupsCheck" data-dojo-type\x3d"dijit/form/CheckBox" type\x3d"checkbox"/\x3e\r\n      \x3clabel id\x3d"share-groups-check-label" for\x3d"share-groups-check" class\x3d"labels"\x3e${nls.theseGroups}\x3c/label\x3e\r\n      \x3cdiv class\x3d"share-groups-wrapper"\x3e\r\n        \x3cdiv data-dojo-type\x3d"dijit/layout/BorderContainer" gutters\x3d"false" design\x3d"headline" class\x3d"borderContainer"\x3e\r\n          \x3cdiv id\x3d"share-groups-list" class\x3d"share-groups-list" dojotype\x3d"dijit.layout.ContentPane" region\x3d"middle" splitter\x3d"false"\x3e\x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:jimu/dijit/templates/ShareLink.html":'\x3cdiv class\x3d"shareLink"\x3e\r\n  \x3cdiv class\x3d"shareLinkOptionsWrapper displaynone"\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"backBtn" class\x3d"backBtn"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"linkOptionsTitle"\x3e${nls.linkOptions}\x3c/div\x3e\r\n    \x3cdiv class\x3d"subTitle"\x3e${nls.linkOptionsUrlParameters}\x3c/div\x3e\r\n    \x3cform data-id\x3d"shareOptionsRadios" data-dojo-attach-point\x3d"shareOptionsRadios"\x3e\r\n      \x3cfieldset\x3e\r\n        \x3cdiv class\x3d"optionsRow"\x3e\r\n          \x3cinput data-dojo-attach-point\x3d"currentMapExtent" class\x3d"shareRadios jimu-float-leading jimu-radio-btn" type\x3d"radio" name\x3d"radios" data-id\x3d"currentMapExtent" data-dojo-type\x3d"dijit.form.RadioButton" data-dojo-props\x3d\'checked:true\' checked\x3e\r\n          \x3cdiv class\x3d"labels" data-forid\x3d"currentMapExtent"\x3e${nls.currentMapExtent}\x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"optionsRow" data-dojo-attach-point\x3d"chooseCenterWithLevelRow"\x3e\r\n          \x3cinput data-dojo-attach-point\x3d"chooseCenterWithLevel" class\x3d"shareRadios jimu-float-leading jimu-radio-btn" type\x3d"radio" name\x3d"radios" data-id\x3d"chooseCenterWithLevel" data-dojo-type\x3d"dijit.form.RadioButton"\x3e\r\n          \x3cdiv class\x3d"labels" data-forid\x3d"chooseCenterWithLevel"\x3e${nls.chooseCenterWithLevel}\x3c/div\x3e\r\n          \x3cdiv class\x3d"optionsMore chooseCenterWithLevel_optionsMore"\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"chooseCenterWithLevel_marker" class\x3d"markers"\x3e\x3c/div\x3e\r\n            \x3cselect data-dojo-attach-point\x3d"chooseCenterWithLevel_levels" class\x3d"shareSelects" style\x3d"display: none !important;" data-dojo-type\x3d"dijit/form/Select"\x3e\x3c/select\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"optionsRow"\x3e\r\n          \x3cinput data-dojo-attach-point\x3d"chooseCenterWithScale" class\x3d"shareRadios jimu-float-leading jimu-radio-btn" type\x3d"radio" name\x3d"radios" data-id\x3d"chooseCenterWithScale" data-dojo-type\x3d"dijit.form.RadioButton"\x3e\r\n          \x3cdiv class\x3d"labels"\x3e${nls.chooseCenterWithScale}\x3c/div\x3e\r\n          \x3cdiv class\x3d"optionsMore chooseCenterWithScale_optionsMore"\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"chooseCenterWithScale_marker" class\x3d"markers"\x3e\x3c/div\x3e\r\n            \x3cselect data-dojo-attach-point\x3d"chooseCenterWithScale_scales" class\x3d"shareSelects" style\x3d"display: none !important;" data-dojo-type\x3d"dijit/form/Select"\x3e\x3c/select\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n\r\n        \x3cdiv class\x3d"optionsRow" data-dojo-attach-point\x3d"findLocationRow"\x3e\r\n          \x3cinput data-dojo-attach-point\x3d"findLocation" class\x3d"shareRadios jimu-float-leading jimu-radio-btn" type\x3d"radio" name\x3d"radios" data-id\x3d"findLocation" data-dojo-type\x3d"dijit.form.RadioButton"\x3e\r\n          \x3cdiv class\x3d"labels"\x3e${nls.findLocation}\x3c/div\x3e\r\n          \x3cdiv class\x3d"optionsMore findLocation_optionsMore"\x3e\r\n            \x3cdiv class\x3d"moreOptions"\x3e\r\n              \x3cinput data-dojo-attach-point\x3d"findLocation_input" data-dojo-type\x3d"dijit.form.TextBox" placeholder\x3d"${nls.findLocation_inputPlaceholder}"\x3e\r\n            \x3c/div\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"optionsRow"\x3e\r\n          \x3cinput data-dojo-attach-point\x3d"queryFeature" class\x3d"shareRadios jimu-float-leading jimu-radio-btn" type\x3d"radio" name\x3d"radios" data-id\x3d"queryFeature" data-dojo-type\x3d"dijit.form.RadioButton"\x3e\r\n          \x3cdiv class\x3d"labels"\x3e${nls.queryFeature}\x3c/div\x3e\r\n          \x3cdiv class\x3d"optionsMore queryFeature_optionsMore"\x3e\r\n            \x3cdiv class\x3d"moreOptions"\x3e\r\n              \x3cdiv data-dojo-attach-point\x3d"queryFeature_layer" name\x3d"queryFeature_layer" class\x3d"queryFeature_layer"\x3e\x3c/div\x3e\r\n              \x3cselect data-dojo-attach-point\x3d"queryFeature_field" name\x3d"queryFeature_field" data-dojo-type\x3d"dijit/form/Select"\x3e\x3c/select\x3e\r\n              \x3cselect data-dojo-attach-point\x3d"queryFeature_value" name\x3d"queryFeature_value" data-dojo-type\x3d"dijit/form/Select"\x3e\x3c/select\x3e\r\n            \x3c/div\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"optionsRow"\x3e\r\n          \x3cinput data-dojo-attach-point\x3d"addMarker" class\x3d"shareRadios jimu-float-leading jimu-radio-btn" type\x3d"radio" name\x3d"radios" data-id\x3d"addMarker" data-dojo-type\x3d"dijit.form.RadioButton"\x3e\r\n          \x3cdiv class\x3d"labels"\x3e${nls.addMarker}\x3c/div\x3e\r\n          \x3cdiv class\x3d"optionsMore addMarker_optionsMore"\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"addMarker_marker" class\x3d"markers"\x3e\x3c/div\x3e\r\n            \x3cdiv class\x3d"moreOptions addMarker_moreOptions"\x3e\r\n              \x3cdiv class\x3d"moreOptionsRow"\x3e\r\n                \x3clabel\x3e${nls.WKID}\x3c/label\x3e\r\n                \x3cinput data-dojo-attach-point\x3d"addMarker_spatialReference" name\x3d"spatialReference" data-dojo-type\x3d"dijit.form.TextBox"\x3e\r\n              \x3c/div\x3e\r\n              \x3cdiv class\x3d"moreOptionsRow"\x3e\r\n                \x3clabel\x3e${nls.popupTitle}\x3c/label\x3e\r\n                \x3cinput data-dojo-attach-point\x3d"addMarker_title" data-dojo-type\x3d"dijit.form.TextBox" placeholder\x3d"${nls.addMarker_titlePlaceholder}"\x3e\r\n              \x3c/div\x3e\r\n              \x3cdiv class\x3d"moreOptionsRow"\x3e\r\n                \x3clabel\x3e${nls.symbol}\x3c/label\x3e\r\n                \x3cinput data-dojo-attach-point\x3d"addMarker_symbolURL" data-dojo-type\x3d"dijit.form.TextBox" placeholder\x3d"${nls.addMarker_symbolURL}"\x3e\r\n              \x3c/div\x3e\r\n              \x3cdiv class\x3d"moreOptionsRow"\x3e\r\n                \x3clabel\x3e${nls.label}\x3c/label\x3e\r\n                \x3cinput data-dojo-attach-point\x3d"addMarker_label" data-dojo-type\x3d"dijit.form.TextBox" placeholder\x3d"${nls.addMarker_label}"\x3e\r\n              \x3c/div\x3e\r\n              \x3cdiv class\x3d"moreOptionsRow displaynone"\x3e\r\n                \x3clabel\x3e${nls.zoomLevel}\x3c/label\x3e\r\n                \x3cdiv class\x3d"table-for-select"\x3e\r\n                  \x3cselect data-dojo-attach-point\x3d"addMarker_level" name\x3d"addMarker_level" data-dojo-type\x3d"dijit/form/Select"\x3e\x3c/select\x3e\r\n                \x3c/div\x3e\r\n              \x3c/div\x3e\r\n            \x3c/div\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/fieldset\x3e\r\n    \x3c/form\x3e\r\n\r\n    \x3cfieldset\x3e\r\n      \x3cdiv class\x3d"optionsRow shareClearFix"\x3e\r\n        \x3cinput data-id\x3d"share-options-overwirteMobileLayout" data-dojo-attach-point\x3d"overwirteMobileLayout" class\x3d"shareCheckBoxes jimu-float-leading" data-dojo-type\x3d"dijit.form.CheckBox" type\x3d"checkbox"\x3e\r\n        \x3cdiv class\x3d"labels"\x3e${nls.overwirteMobileLayout}\x3c/div\x3e\r\n        \x3cdiv class\x3d"optionsMore share-options-overwirteMobileLayout_optionsMore"\x3e\r\n          \x3cinput type\x3d"text" data-dojo-type\x3d"dijit/form/NumberTextBox" required\x3d"true"\r\n                 data-dojo-attach-point\x3d"mobileLayout" data-dojo-props\x3d\'style:{width:"100px"}, constraints:{min:300}\'/\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"optionsRow shareClearFix"\x3e\r\n        \x3cinput data-id\x3d"share-options-language" data-dojo-attach-point\x3d"setlanguage" class\x3d"shareCheckBoxes jimu-float-leading" data-dojo-type\x3d"dijit.form.CheckBox" type\x3d"checkbox"\x3e\r\n        \x3cdiv class\x3d"labels"\x3e${nls.language}\x3c/div\x3e\r\n        \x3cdiv class\x3d"optionsMore share-options-language_optionsMore"\x3e\r\n          \x3cselect data-dojo-attach-point\x3d"setlanguage_languages" class\x3d"shareSelects" style\x3d"display:inline-block;" data-dojo-type\x3d"dijit/form/Select"\x3e\x3c/select\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"optionsRow shareClearFix" style\x3d"display: none;"\x3e\r\n        \x3cinput data-id\x3d"share-options-auth" data-dojo-attach-point\x3d"auth" class\x3d"shareCheckBoxes jimu-float-leading" data-dojo-type\x3d"dijit.form.CheckBox" type\x3d"checkbox"\x3e\r\n        \x3cdiv class\x3d"labels"\x3e${nls.auth}\x3c/div\x3e\r\n        \x3cdiv  class\x3d"optionsMore share-options-auth_optionsMore"\x3e\r\n          \x3cinput data-dojo-attach-point\x3d"authtoken" data-dojo-type\x3d"dijit/form/ValidationTextBox" data-dojo-props\x3d\'required:true\'/\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"optionsRow shareClearFix"\x3e\r\n        \x3cdiv class\x3d"subTitle"\x3e${nls.linkPreview}\x3c/div\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"preview" class\x3d"preview inputsText" data-dojo-type\x3d"dijit/form/SimpleTextarea" data-dojo-props\x3d\'required:true,readOnly:true\'\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/fieldset\x3e\r\n  \x3c/div\x3e\r\n\r\n  \x3cdiv class\x3d"shareUrlsWrapper"\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"Text"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"linkShare" data-dojo-attach-point\x3d"LinkShareContainer"\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"LinkText" class\x3d"subTitle linkToApp"\x3e${nls.shareLinkText}\x3c/div\x3e\r\n      \x3cinput data-dojo-attach-point\x3d"_linkUrlTextBox" class\x3d"shareLinkUrl inputsText" data-dojo-type\x3d"dijit/form/TextBox" data-dojo-props\x3d\'required:true,readOnly:true\'/\x3e\r\n      \x3cdiv class\x3d"shareClearFix"\x3e\r\n        \x3cspan class\x3d"optionsText jimu-float-leading" data-dojo-attach-point\x3d"linkOptions"\x3e${nls.linkOptions}\x3c/span\x3e\r\n        \x3cdiv class\x3d"shareLinkIcons jimu-float-trailing" data-dojo-attach-point\x3d"socialNetworkLinks"\x3e\r\n          \x3cdiv class\x3d"socialNetworkIcons email" data-dojo-attach-event\x3d"click:_toEmail" data-dojo-attach-point\x3d"emailShare" title\x3d"${nls.shareEmail}"\x3e\x3c/div\x3e\r\n          \x3cdiv class\x3d"socialNetworkIcons facebook" data-dojo-attach-event\x3d"click:_toFacebook" data-dojo-attach-point\x3d"FacebookShare" title\x3d"${nls.shareFacebook}"\x3e\x3c/div\x3e\r\n          \x3cdiv class\x3d"socialNetworkIcons twitter" data-dojo-attach-event\x3d"click:_toTwitter" data-dojo-attach-point\x3d"TwitterShare" title\x3d"${nls.shareTwitter}"\x3e\x3c/div\x3e\r\n          \x3cdiv class\x3d"socialNetworkIcons googlePlus" data-dojo-attach-point\x3d"googlePlusShare" title\x3d"${nls.shareGooglePlus}"\x3e\x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"embedShare" data-dojo-attach-point\x3d"EmbedShareContainer"\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"embedText" class\x3d"subTitle"\x3e${nls.embed}\x3c/div\x3e\r\n      \x3cinput data-dojo-attach-point\x3d"_embedCodeTextArea" class\x3d"shareEmbedCode inputsText" data-dojo-type\x3d"dijit/form/SimpleTextarea" data-dojo-props\x3d\'required:true,readOnly:true\'/\x3e\r\n      \x3cdiv class\x3d"moreOptions" data-dojo-attach-event\x3d"click:_moreOptionsExpandCollapse"\x3e\r\n        \x3cdiv class\x3d"moreOptionsIcon" data-dojo-attach-point\x3d"MoreOptionsIcon"\x3e\x3c/div\x3e\r\n        \x3cdiv class\x3d"optionsText"\x3e${nls.more}\x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"MoreOptionsContainer" class\x3d"moreOptionsContainer inputsText displaynone"\x3e\r\n        \x3cdiv class\x3d"sizeSelect" data-dojo-attach-point\x3d"SizeSelect"\x3e\x3c/div\x3e\r\n        \x3cdiv class\x3d"customSize disable" data-dojo-attach-point\x3d"CustomSizeContainer"\x3e\r\n          \x3cdiv class\x3d"timesConnector"\x3eX\x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv class\x3d"shareTips" data-dojo-attach-point\x3d"shareTips"\x3e\r\n      \x3c!--\x3cdiv class\x3d"infoIcon"\x3e\x3c/div\x3e--\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"shareTipsText" class\x3d"shareTipsText"\x3e${nls.shareToWebTips}\x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:jimu/dijit/templates/LayerChooserFromMapWithDropbox.html":'\x3cdiv\x3e\r\n  \x3ctable data-dojo-attach-event\x3d"onclick: _onDropDownClick"\x3e\r\n    \x3ccolgroup\x3e\r\n      \x3ccol width\x3d"10px"\x3e\x3c/col\x3e\r\n      \x3ccol width\x3d"auto"\x3e\x3c/col\x3e\r\n      \x3ccol width\x3d"30px"\x3e\x3c/col\x3e\r\n    \x3c/colgroup\x3e\r\n    \x3ctbody\x3e\r\n      \x3ctr\x3e\r\n        \x3ctd\x3e\x3c/td\x3e\r\n        \x3ctd\x3e\r\n          \x3cdiv class\x3d"layer-name jimu-ellipsis" data-dojo-attach-point\x3d"layerNameNode"\x3e\x3c/div\x3e\r\n        \x3c/td\x3e\r\n        \x3ctd\x3e\r\n          \x3cdiv class\x3d"drop-select jimu-float-trailing" data-dojo-attach-point\x3d"dropArrowNode"\x3e\r\n            \x3cdiv class\x3d"jimu-icon jimu-icon-down-arrow-8"\x3e\x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3c/td\x3e\r\n      \x3c/tr\x3e\r\n    \x3c/tbody\x3e\r\n  \x3c/table\x3e\r\n\x3c/div\x3e\r\n',
"url:builder/plugins/startup/Plugin.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"header" data-dojo-attach-point\x3d"headerNode"\x3e\x3c/div\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"viewStackNode"\x3e\x3c/div\x3e\r\n\x3c/div\x3e\r\n',"url:builder/plugins/startup/css/style.css":".plugin-startup\x3e.jimu-viewstack{position: absolute; top: 61px; bottom: 0; left: 0; right: 0; height: auto; overflow: hidden; background-color: #f3f3f3;}.plugin-startup .image-404{position: absolute; top: 50%; margin-top: -80px; left: 50%; margin-left: -238px;}",
"url:builder/plugins/theme-config/Plugin.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"theme-list" data-dojo-attach-point\x3d"themeList"\x3e\r\n    \x3cdiv class\x3d"theme-title"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"separate-line"\x3e\x3c/div\x3e\r\n  \x3cdiv class\x3d"style-list" data-dojo-attach-point\x3d"styleList"\x3e\r\n    \x3c!--div class\x3d"style-text"\x3e${nls.styleTitle}\x3c/div--\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"layout-list" data-dojo-attach-point\x3d"layoutList"\x3e\x3c/div\x3e\r\n  \x3cdiv class\x3d"theme-loading-cover" style\x3d"display:none" data-dojo-attach-point\x3d"themeCoverNode"\x3e\x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:jimu/dijit/templates/ColorRecords.html":'\x3cdiv\x3e\r\n\t\x3cdiv class\x3d"dijitInline dijitColorPalette" role\x3d"grid"\x3e\r\n\t\t\x3ctable data-dojo-attach-point\x3d"paletteTableNode" class\x3d"dijitPaletteTable" cellspacing\x3d"0" cellpadding\x3d"0" role\x3d"presentation"\x3e\r\n\t\t\t\x3ctbody data-dojo-attach-point\x3d"gridNode"\x3e\r\n\t\t\t\t\x3ctr tabindex\x3d"0" role\x3d"row" data-dojo-attach-point\x3d"container"\x3e\r\n\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\x3c/tbody\x3e\r\n\t\t\x3c/table\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e',
"url:builder/plugins/theme-config/css/style.css":".plugin-theme-config{overflow: auto; position: relative;}.plugin-theme-config .section {}.plugin-theme-config .theme-section{}.plugin-theme-config .theme-list{overflow: auto; display: none; padding-left: 30px; padding-right: 14px; border: 0px solid;}.jimu-rtl .plugin-theme-config .theme-list{padding-left: 14px; padding-right: 30px;}.plugin-theme-config .theme-title{margin-top: 20px; margin-left: 18px; font-size: 14px; color: #015574;}.plugin-theme-config .theme-catalog{border: 0px solid; display: none; overflow: hidden;}.plugin-theme-config .catalog-theme-content-div{border: 0px solid; width: 33.333%; height: 118px; overflow: hidden;}.plugin-theme-config .catalog-theme-div{position: relative; width: 106px; height: 78px; cursor: pointer; border: 2px solid #ffffff;}.plugin-theme-config .catalog-theme-div:hover{border-color: #24B5CC;}.plugin-theme-config .catalog-theme-selected {border-color: #24B5CC;}.plugin-theme-config .catalog-theme-img-box-div{width: 102px; height: 74px; border: 1px solid #ddd;}.plugin-theme-config .catalog-theme-img-box-div:hover{border: 1px solid #ffffff;}.plugin-theme-config .catalog-theme-img-box-div.selected{border: 1px solid #ffffff;}.plugin-theme-config .catalog-theme-img-div{text-align: center; width: 84px; height: 56px; display: block; margin-top: 8px; margin-left: auto; margin-right: auto;}.plugin-theme-config .catalog-theme-img{text-align: center; width: 84px; height: 56px;}.plugin-theme-config .catalog-theme-name-div{border: 0px solid; width: 106px; overflow: hidden; text-align: center; padding-top: 5px; font-size: 12px; color: #333; cursor: default; text-overflow: ellipsis; line-height: 17px;}.plugin-theme-config .theme-cl-selected-div{position: absolute; left: 21px; top: 21px; width: 40px; height: 34px; border: 0px solid; text-align: center; display: none; background-color: rgba(0, 0, 0, 0.65);}.plugin-theme-config .theme-cl-selected-img{margin-top: 10px;}.plugin-theme-config .separate-line{margin-left: 10px; margin-right: 10px; border-top: 1px solid #ddd;}.plugin-theme-config .style-list{border: 0px solid; padding-right: 30px; padding-left: 30px;}.plugin-theme-config .style-section{border: 0px solid; overflow: auto;}.plugin-theme-config .style-text{margin-top: 20px; margin-bottom: 15px; font-size: 14px; font-family: \"Avenir Medium\"}.plugin-theme-config .style-color-content{}.plugin-theme-config .style-div{position: relative; width: 25%; height: 30px; margin-bottom: 12px; cursor: pointer; padding: 4px; background-clip: content-box; border: 2px solid rgba(0,0,0,0);}.plugin-theme-config .style-div:hover{border: 2px solid #24B5CC;}.plugin-theme-config .style-image{}.plugin-theme-config .style-selected{border: 2px solid #24B5CC;}.plugin-theme-config .style-selected-div{position: absolute; top: 0px; left: 0px; width: 100%; height: 100%; background-color: rgba(0, 0, 0, 0.65); text-align: center; display: none;}.plugin-theme-config .layout-list{border: 0px solid;}.plugin-theme-config .layout-section{border: 0px solid; overflow: hidden; margin-top: 28px; padding-left: 30px; position: relative;}.plugin-theme-config .layout-section .layout-action{position: absolute; top: 0; right: 30px; font-size: 12px; cursor: pointer; color: #666;}.plugin-theme-config .layout-section .layout-action span{display: inline-block; vertical-align: middle; margin-left: 8px;}.jimu-rtl .plugin-theme-config .layout-section .layout-action{left: 30px; right: auto;}.jimu-rtl .plugin-theme-config .layout-section .layout-action span{margin-left: auto; margin-right: 8px;}.plugin-theme-config .layout-section .layout-action:hover{color: #12A1B8;}.plugin-theme-config .layout-section .layout-action .modify-icon{font-family: 'feature actions';}.plugin-theme-config .layout-section .layout-action .modify-icon:before{content: '\\e90e';}.jimu-rtl .plugin-theme-config .layout-section{padding-right: 30px; padding-left: auto;}.plugin-theme-config .layout-text{margin-bottom: 16px; font-size: 14px; font-family: \"Avenir Medium\"}.plugin-theme-config .layout-out-div{position: relative; margin-bottom: 15px; width: 33%;}.plugin-theme-config .layout-box-div{width: 106px; height: 80px; border: 2px solid #ffffff;}.plugin-theme-config .layout-box-div:hover{border: 2px solid #24B5CC;}.plugin-theme-config .layout-box-selected{border: 2px solid #24B5CC;}.plugin-theme-config .layout-div{width: 102px; height: 76px; border: 1px solid #ddd; text-align: center; cursor: pointer;}.plugin-theme-config .layout-div:hover{border: 1px solid #ffffff;}.plugin-theme-config .layout-selected{border: 1px solid #ffffff;}.plugin-theme-config .layout-image{width: 80px; height: 54px; margin-top: 10px;}.plugin-theme-config .layout-selected-div{position: absolute; left: 28px; top: 24px; width: 40px; height: 34px; border: 0px solid; text-align: center; padding-top: 6px; display: none; background-color: rgba(0, 0, 0, 0.65);}.plugin-theme-config .layout-selected-img{}.plugin-theme-config .theme-loading-cover{position: absolute; z-index: 999; left: 0; right: 0; top: 0; bottom: 0; background-color: rgba(0, 0, 0, 0.3);}.plugin-theme-config .style-div .color-label{margin-top: -8px;}.plugin-theme-config .jimu-color-picker{border-radius: 0;}.plugin-theme-config .jimu-color-picker:not(.jimu-theme-color-chooser){width: 0; height: 0;}",
"url:builder/plugins/widget-config/WidgetSettingPage.html":'\x3cdiv class\x3d"widget-setting-page"\x3e\r\n  \x3cdiv class\x3d"section common-setting" data-dojo-attach-point\x3d"commonSettingNode"\x3e\r\n    \x3cdiv class\x3d"basic"\x3e\r\n      \x3cdiv class\x3d"icon jimu-float-leading"\x3e\r\n        \x3cimg class\x3d"real-icon"  data-dojo-attach-point\x3d"iconNode"\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"right jimu-float-trailing jimu-leading-margin1"\x3e\r\n        \x3cinput data-dojo-type\x3d"dijit/form/ValidationTextBox" data-dojo-attach-point\x3d"labelNode" placeholder\x3d"${nls.widgetLabel}" required\x3d"true" class\x3d"widget-setting-input"\x3e\r\n        \x3cdiv class\x3d"right-foot" data-dojo-attach-point\x3d"rightFooterNode"\x3e\r\n          \x3cdiv class\x3d"image-container"\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"imageChooserPlaceholder"\x3e\x3c/div\x3e\r\n            \x3c!-- \x3cspan nowrap class\x3d"change-icon" data-dojo-attach-point\x3d"changeNode"\x3e${nls.changeIcon}\x3c/span\x3e --\x3e\r\n            \x3ca class\x3d"help-link jimu-float-trailing" target\x3d"_blank" data-dojo-attach-point\x3d"helpNode"\x3e${nls.more}\x3c/a\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"layout"\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"section widget-setting" data-dojo-attach-point\x3d"widgetSettingNode"\x3e\x3c/div\x3e\r\n\x3c/div\x3e',
"url:builder/plugins/widget-config/GroupSettingPage.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"label-div"\x3e\r\n    \x3cspan\x3e${nls.label}\x3c/span\x3e\r\n    \x3cinput class\x3d"jimu-input" data-dojo-attach-point\x3d"labelNode"\x3e\x3c/input\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',"url:builder/plugins/widget-config/WidgetChoosePage.html":'\x3cdiv class\x3d"widget-choose-page"\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"officialSection" class\x3d"official-section"\x3e\r\n    \x3cdiv class\x3d"section search" data-dojo-attach-point\x3d"searchSectionNode"\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"searchInputNode"\x3e\x3c/div\x3e\r\n      \x3cdiv class\x3d"list widget-list" data-dojo-attach-point\x3d"widgetListNode"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"customSection" class\x3d"custom-section"\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"customSearchInputNode"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:builder/plugins/widget-config/CustomWidgets.html":'\x3cdiv data-dojo-attach-event\x3d"onscroll:_onScroll"\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"list" class\x3d"list widget-list" data-dojo-attach-event\x3d"onclick:_onClick"\x3e\x3c/div\x3e\r\n\t\x3cdiv data-dojo-type\x3d"jimu/dijit/LoadingIndicator" data-dojo-attach-point\x3d"loading" data-dojo-props\x3d\'hidden:true\'\x3e\x3c/div\x3e\r\n\x3c/div\x3e',"url:builder/plugins/widget-config/Plugin.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"preload-widgets-list" data-dojo-attach-point\x3d"preloadWidgetsNode"\x3e\r\n    \x3cdiv class\x3d"controller-widgets-list" data-dojo-attach-point\x3d"controllerWidgetsNode"\x3e\x3c/div\x3e\r\n\r\n    \x3chr  data-dojo-attach-point\x3d"onScreenGroupsHline"\x3e\r\n    \x3cdiv class\x3d"onscreen-groups-list-wrapper"\x3e\r\n      \x3cdiv class\x3d"onscreen-groups-list" data-dojo-attach-point\x3d"onScreenGroupsListNode"\x3e\x3c/div\x3e\r\n\r\n      \x3cdiv class\x3d"group-exceed-max-error jimu-state-error" data-dojo-attach-point\x3d"groupExceedMaxErrorNode"\x3e\r\n        \x3cspan class\x3d"jimu-icon jimu-icon-alert"\x3e\x3c/span\x3e\r\n        \x3cspan data-dojo-attach-point\x3d"groupExceedMaxErrorStringNode"\x3e\x3c/span\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3chr  data-dojo-attach-point\x3d"notRemoveableOnScreenWidgetsHline"\x3e\r\n    \x3cdiv class\x3d"not-removeable-onscreen-widgets-list" data-dojo-attach-point\x3d"notRemoveableOnScreenWidgetsListNode"\x3e\x3c/div\x3e\r\n\r\n    \x3chr  data-dojo-attach-point\x3d"removeableOnScreenWidgetsHline"\x3e\r\n    \x3cdiv class\x3d"removeable-onscreen-widgets-list" data-dojo-attach-point\x3d"removeableOnScreenWidgetsListNode"\x3e\x3c/div\x3e\r\n\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"pool-widgets-list" data-dojo-attach-point\x3d"poolWidgetsNode"\x3e\r\n    \x3cdiv class\x3d"widgets-link" data-dojo-attach-point\x3d"backWidgetsNode" data-dojo-attach-event\x3d"onclick: _onBackWidgetsClick"\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"backArrowNode" class\x3d"jimu-float-leading feature-action icon-arrow-back"\x3e\x3c/div\x3e\r\n      \x26nbsp;\r\n      ${nls.widgets}\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"widget-pool-title" data-dojo-attach-point\x3d"poolTitleNode"\x3e${nls.setControlledWidgetsBy}\x3cspan data-dojo-attach-point\x3d"controllerLabelNode"\x3e\x3c/span\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"widget-pool-list-wrapper"\x3e\x3cdiv class\x3d"widget-pool-list" data-dojo-attach-point\x3d"poolWidgetsListNode"\x3e\x3c/div\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"offpanel-group-error jimu-state-error" data-dojo-attach-point\x3d"offPanelToGroupErrorNode"\x3e\r\n      \x3cspan class\x3d"jimu-icon jimu-icon-alert"\x3e\x3c/span\x3e\r\n      \x3cspan\x3e${nls.offPanelToGroupError}\x3c/span\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:builder/plugins/widget-config/css/style.css":'.json-editor{width: 100%; height: 100%; position: relative;}.app-widgets{width: 100%; height: 100%;}.app-widgets\x3e.jimu-viewstack{width: 100%; height: 100%;}.app-widgets .preload-widgets-list, .app-widgets .pool-widgets-list{position: relative; width: 100%; height: 100%; padding: 10px 0px; -ms-overflow-x: hidden; -ms-overflow-y: auto; overflow-x: hidden; overflow-y: auto;}.app-widgets .preload-widgets-list hr{margin: 10px 15px -5px 15px; border: none; border-top: 1px solid #ddd;}.app-widgets .controller-widget{position: relative; height: 118px; padding-top: 20px;}.app-widgets .controller-widget:hover{background-color: #F3F3F3;}.app-widgets .controller-widget .action-node{position: absolute; left: 96px; top: 20px; height: 74px; right: 0; line-height: 74px; cursor: pointer; font-size: 14px;}.app-widgets .controller-widget .action-node .action-text{white-space: nowrap; text-overflow: ellipsis; overflow: hidden; width: 230px; font-family: "Avenir Medium"}.app-widgets .controller-widget .action-node .action-arrow{margin-top: 30px;}.app-widgets .not-removeable-onscreen-widgets-list,.app-widgets .removeable-onscreen-widgets-list,.app-widgets .onscreen-groups-list-wrapper{position: relative; left: 15px; right: 0; margin-top: 20px;}.app-widgets .widget-pool-list-wrapper{position: absolute; top: 95px; left: 15px; right: 0; bottom: 0; overflow-x: hidden; overflow-y: auto;}.app-widgets .widget-pool-list-wrapper .widget-pool-list{width: 100%; height: 100%;}.app-widgets .onscreen-groups-list-wrapper .onscreen-groups-list{width: 100%; height: 100%;}.app-widgets .jimu-state-error{position: absolute; z-index: 1; left: 0; top: 42px; height: 30px; line-height: 30px; width: 100%; padding: 0 10px; filter:alpha(opacity\x3d0); opacity: 0; display: none;}.app-widgets .group-exceed-max-error{z-index: 5; top: 0;}.app-widgets .widgets-link{font-size: 14px; margin-left: 30px; cursor: pointer; font-family: "Avenir Medium"; margin-top: 20px; color: #333;}.app-widgets .widgets-link:hover{color: black;}.app-widgets .widget-pool-title{margin-top: 15px; font-size: 12px; color: #999; margin-left: 30px;}.app-widgets .moveable{position: absolute; font-size: 12px; float: left; z-index: 3;}.app-widgets .moveable.dojoMoveItem{z-index: 4;}.app-widgets .moveable .box{position: relative; border: 1px solid #80C6D1; background-color: #80C6D1; width: 112px; height: 112px; overflow: hidden; cursor: pointer;}.app-widgets .preload-widgets-list .moveable.group-node .box{background-color: #80C6D1; border: 1px solid #80C6D1;}.app-widgets .preload-widgets-list .moveable.group-node .box:hover{}.app-widgets .preload-widgets-list .moveable.placeholder .box{background-color: #bbb; border: 1px solid #bbb;}.app-widgets .preload-widgets-list .moveable.placeholder .box:hover{background-color: #aaa;}.app-widgets .moveable.node-active .box{border: 3px solid #15a4fa;}.app-widgets .moveable .box.jimu-state-active{border: 2px solid red;}.app-widgets .moveable .label{text-align: center; width: 100%; height: 30px; margin-top: 6px; overflow: hidden; white-space: nowrap; text-overflow: ellipsis; color: #333;}.app-widgets .moveable .edit-btn{position: absolute; background-color: #000; background-color: rgba(0, 0, 0, 0.3); background-image: url(images/edit_widget.png); background-repeat: no-repeat; background-position: center;}.app-widgets .moveable .open-at-start-btn{position: absolute; border-radius: 6px; border: 2px solid white;}.app-widgets .moveable .open-at-start-btn.active{background-color: #336666; filter:alpha(opacity\x3d100); opacity: 1;}.app-widgets .moveable .open-at-start-btn.deactive{filter:alpha(opacity\x3d50); opacity: 0.5;}.app-widgets .moveable .drop-btn{position: absolute; background-color: #000; background-color: rgba(0, 0, 0, 0.3); background-image: url(images/delete_widget.png); background-repeat: no-repeat; background-position: center;}.app-widgets .moveable .switch-btn{position: absolute; border-radius: 2px; background: url(images/eye_open.png) no-repeat center center;}.app-widgets .moveable .small-add-btn{position: absolute; background-color: #000; background-color: rgba(0, 0, 0, 0.3); background-repeat: no-repeat; background-position: center; background-image: url(images/small_add.png);}.app-widgets .moveable.hide .switch-btn{background-image: url(images/eye_close.png);}.app-widgets .moveable.hide{opacity: 0.5;}.app-widgets .moveable .edit-btn:hover, .app-widgets .moveable .drop-btn:hover, .app-widgets .moveable .small-add-btn:hover{background-color: rgba(0, 0, 0, 0.6);}.app-widgets .moveable .open-at-start-btn:hover{filter:alpha(opacity\x3d100); opacity: 1;}.app-widgets .moveable .switch-btn:hover{background-image: url(images/eye_open_hover.png);}.app-widgets .moveable.hide .switch-btn:hover{background-image: url(images/eye_close_hover.png);}.app-widgets .moveable .switch-btn:hover{background-color: rgba(0, 0, 0, 0.6);}.app-widgets .node-shadow{position: absolute; border: 1px dashed;}.app-widgets .node-margin{position: absolute; z-index: 2;}.app-widgets .node-margin-active{background: red;}.app-widgets .add-widget-node{position: absolute; font-size: 12px; float: left;}.app-widgets .add-widget-node .box{background-color: #fafafc; border: 1px dashed #d2dae2; color: #596679;}.app-widgets .add-widget-node .box:hover{background-color: #eaeaea;}.app-widgets .add-widget-node img{width: 20px; height: 20px; display: block; margin: 27px;}.app-widgets .empty-node .box{opacity: 0; cursor: normal;}.app-widgets .empty-node-active .box{opacity: 0.4;}.app-widgets .widget-node .placeholder,.app-widgets .group-node .placeholder{overflow: hidden;}.app-widgets .widget-node .placeholder-inner,.app-widgets .group-node .placeholder-inner{text-align: center; color: white; font-size: 14px;}.app-widgets .group-node .placeholder-inner {border: 1px solid white; width: 32px !important; height: 32px !important; line-height: 32px !important; border-radius: 16px !important; margin: 0 !important;}.app-widgets .group-node .small{float: left;}.app-widgets .group-node .add-button{width: 20px; height: 20px; margin: auto; display: block; margin-top: 25px;}.app-widgets .widget-group-panel{position: absolute; background-color: #E3ECF2;}.app-widgets .group-triangle{position: absolute; width: 0px; height: 0px; top: -8px; border-left: 8px solid transparent; border-right: 8px solid transparent; border-bottom: 8px solid #E3ECF2;}.widget-setting-popup .content{overflow-y: hidden;}.widget-setting-page{width: 100%; height: 100%;}.widget-setting-page .common-setting{height: 74px; margin-bottom: 20px;}.widget-setting-page .common-setting .basic{overflow: hidden;}.widget-setting-page .common-setting .label input{width: 224px; height: 32px;}.widget-setting-page .opts-section{padding: 5px;}.widget-setting-page .common-setting .icon{background-color: #80C6D1; border: 1px solid #80C6D1; width: 74px; height: 74px; display: inline-block;}.widget-setting-page .common-setting .icon img{width: 40px; height: 40px; margin: 17px;}.widget-setting-page .common-setting .right{font-size: 10px; width: 875px; display: inline-block;}.widget-setting-page .common-setting .right .widget-setting-input{width: 100%; color: black; display: block; background-color: #fafafc;}.widget-setting-page .image-container{overflow:hidden; min-width: 100px; width: 100%; display: inline-block; position: relative; height: 30px; margin-top: 14px;}.widget-setting-page .image-container .help-link{color: #24B5CC; display:none;}.widget-setting-page .image-container .help-link:hover{color: #0090A7;}.widget-setting-page .jimu-image-chooser{height: 30px; padding: 0;}.widget-setting-page .common-setting .right .change-icon{white-space:nowrap; color: white; cursor: pointer; display: inline-block; background-color: #518dca; text-align: center; vertical-align: middle; height: 30px; line-height: 30px; padding-left: 6px; padding-right: 6px; box-shadow: 0 0 2px gray; position: relative;}.widget-setting-page .common-setting .right .disable-change-icon{background-color: #a0acbf; cursor: default;}.widget-setting-page .common-setting .right .more{float: right; color: #15a4fa; display: inline-block; margin-top: 20px;}.widget-setting-page .common-setting .right-foot{position: relative; font-size: 14px;}.widget-setting-page .common-setting .right .state{font-size: 14px; margin-top: 10px;}.widget-setting-page .widget-setting{overflow-x: hidden; overflow-y: auto; position: relative;}.widget-setting-page .widget-default-setting{width: 100%; height: 100%;}.widget-setting-page .opts-section{height: 50px;}.widget-setting-page .opts-section .jimu-btn{width: 182px; height: 40px; margin-left: 8px;}.widget-setting-page .noconfig-info{font-size: 16px; position: absolute; left: 50%; top: 50%; margin-left: -100px;}.widget-choose-page{width: 100%; height: 100%;}.widget-choose-page \x3e .jimu-tab3 \x3e .container-node{height: 635px; overflow: hidden;}.widget-choose-page .jimu-item-selector .setting-tab-container{height: 98%; margin-top: 2%;}.widget-choose-page .jimu-search{margin: 10px 0;}.widget-choose-page .jimu-search .jimu-input{font-size: 12px;}.widget-choose-page .widget-node{width: 78px; height: 118px; margin: 10px 8px 0 0px; float: left; font-size: 12px; cursor: pointer; position: relative;}.widget-choose-page .widget-node .box{position: relative; border: 1px solid #80C6D1; background-color: #80C6D1; width: 78px; height: 78px; overflow: hidden;}.widget-choose-page .widget-node .box-selected{position: absolute; width: 16px; height: 16px; left: 5px; top: 5px; display: none; background: url(images/checked.svg);}.widget-choose-page .widget-node.jimu-state-selected .box-selected{display: block;}.widget-choose-page .widget-node .icon{width: 32px; height: 32px; display: block; margin: auto; margin-top: 23px;}.widget-choose-page .widget-node .label{text-align: center; width: 100%; height: 30px; margin-top: 10px; overflow: hidden; white-space: nowrap; text-overflow: ellipsis;}.widget-choose-page .search{width: 100%; overflow-x: hidden; overflow-y: hidden;}.widget-choose-page .list{height: 100%; margin-right: -10px; padding-left: 1px; overflow-y: auto; width: 964px;}.widget-choose-page .opts-section{overflow: hidden; margin-top: 10px;}.widget-choose-page .opts-section .jimu-btn{width: 182px; height: 40px; margin-left: 8px;}.widget-choose-page .custom-section{position: relative;}.widget-choose-page .custom-widgets{display: block; position: absolute; width: 100%; left: 0; right: 0; top: 50px; bottom: 0;}.widget-choose-page .hidden{display: none;}.widget-choose-page .custom-widgets .detail-icon{display: none; position: absolute; right: 7px; bottom: 7px; width: 15px; height: 15px; background-color: rgba(0, 0, 0, 0.4); background-repeat: no-repeat; background-image: url(images/info.png); border-radius: 3px; cursor: pointer;}.jimu-rtl .widget-choose-page .custom-widgets .detail-icon{right: auto; left: 7px;}.widget-choose-page .custom-widgets .widget-node .box:hover .detail-icon{display: block;} .group-setting-page {margin: 20px 10px; font-size: 16px;}.group-setting-page .label-div input{margin-left: 10px; color: #000000;}.jimu-rtl .app-widgets .controller-widget .action-node{right: 96px; left: 0;}.jimu-rtl .widget-choose-page .widget-node{margin: 10px 0 0 8px; float: right;}.jimu-rtl .widget-choose-page .list{margin-right: 0; padding-left: 0; overflow-x: hidden;}.jimu-rtl .app-widgets .widgets-link{margin-left: auto; margin-right: 30px;}.jimu-rtl .app-widgets .widget-pool-title{margin-left: auto; margin-right: 30px;}.jimu-rtl .app-widgets .not-removeable-onscreen-widgets-list,.jimu-rtl .app-widgets .removeable-onscreen-widgets-list,.jimu-rtl .app-widgets .onscreen-groups-list-wrapper,.jimu-rtl .app-widgets .widget-pool-list-wrapper{right: 15px; left: 0;}.jimu-rtl .widget-choose-page .widget-node .box-selected{right: 5px; left: auto;}.dj_ie8 .app-widgets .empty-node .box {-ms-filter: "Alpha(opacity\x3d0)"; filter: Alpha(opacity\x3d0);}.dj_ie8 .app-widgets .moveable .edit-btn{-ms-filter: "Alpha(opacity\x3d30)"; filter: Alpha(opacity\x3d30);}.dj_ie8 .app-widgets .moveable .edit-btn:hover{-ms-filter: "Alpha(opacity\x3d60)"; filter: Alpha(opacity\x3d60);}.dj_ie8 .app-widgets .moveable.hide {-ms-filter: "Alpha(opacity\x3d50)"; filter: Alpha(opacity\x3d50);}.widget-choose-page.hide-custom-widgets .jimu-tab3{height: 100%;}.widget-choose-page.hide-custom-widgets .jimu-tab3 .control-node{display: none;}.widget-choose-page.hide-custom-widgets .jimu-tab3 .jimu-viewstack{height: 100%;}',
"*now":function(k){k(['dojo/i18n!*preload*builder/nls/main*["ar","bs","cs","da","de","en","el","es","et","fi","fr","he","hi","hr","id","it","ja","ko","lt","lv","nb","nl","pl","pt-br","pt-pt","ro","ru","sl","sr","sv","th","tr","zh-cn","vi","zh-hk","zh-tw","ROOT"]'])}}});
define("dojo/_base/config dojo/_base/html dojo/_base/lang dojo/_base/array dojo/promise/all dojo/Deferred dojo/cookie dojo/topic dojo/json dojo/request/script jimu/utils jimu/portalUrlUtils jimu/portalUtils jimu/dijit/Message jimu/DataSourceManager ./tokenUtils ./utils ./PluginManager require esri/request esri/IdentityManager dojo/text!./plugins/plugins.json dojo/i18n!./nls/builder".split(" "),function(k,e,p,q,n,l,h,f,d,c,a,b,g,u,m,r,t,v,y,w,z,x,A){function C(a){e.setStyle("pre-main-page","display",
"none");e.setStyle("main-page","display","block");window.portalUrl=a.portalUrl;r.setPortalUrl(window.portalUrl);var c=b.getSharingUrl(window.portalUrl);z.checkSignInStatus(c).then(function(){E(a)},function(){if(window.isXT)r.xtGetCredentialFromCookie(window.portalUrl)&&E(a);else{var c=b.getPortalSignInUrlFromLocation(),d=encodeURIComponent(window.location.href);window.location.href=c+"?returnUrl\x3d"+d}})}function B(a){e.create("div",{className:"app-error",innerHTML:a},document.body)}function E(c){var d=
"";!window.isXT&&window.queryObject&&(window.queryObject.id&&!/^(stemapp|stemapp3d)$/gi.test(window.queryObject.id)?d=window.queryObject.id:window.queryObject.appid&&(d=window.queryObject.appid));var f=I(),m=F(),q=M(d),u=function(){r.signOutAll();if(window.isXT)window.location.href=window.location.href;else{var a=b.getPortalSignInUrlFromLocation(),c=encodeURIComponent(window.location.href);window.location.href=a+"?returnUrl\x3d"+c}};n([f,m,q]).then(p.hitch(this,function(f){var m=f[1],q=f[2];f[0]&&
m?"string"===typeof q?(r.signOutAll(),B(q)):L(d).then(function(d){if(d){var f=g.getPortal(window.portalUrl);d=f.loadSelfInfo();var m=D(window.portalUrl),q;n([d,m]).then(function(a){q=a[0];window.portalSelf=q;window.isXT?a=t.checkProtocolAndUpdateSigninInfo(q,c):(a=new l,a.resolve({success:!0}));return a}).then(function(d){if(d.success){var g=q.user&&q.user.culture||q.culture||k.locale;g&&(g=g.toLowerCase());d=null;!window.queryObject.locale&&a.isLocaleChanged(k.locale,g)&&(h("wab_locale",g),d=window.location.href);
window.isXT&&/[\?|\&](action=)(.+)/gi.test(window.location.href)&&(d||(d=window.location.href),d=t.removeActionFromUrl(d));g="https:"===window.location.protocol;if(q.allSSL||g)window.portalUrl=c.portalUrl=b.setHttpsProtocol(c.portalUrl);f.portalUrl=window.portalUrl;var l=0===window.portalUrl.toLowerCase().indexOf("https:");!g&&l&&(d||(d=window.location.href),d=d.replace(/^http:/i,"https:"));d?window.location.href=d:(d=K.startup,d.options={signinInfo:c},v.getInstance(K).loadPlugin(d).then(p.hitch(this,
function(a){a.placeAt(e.byId("main-page"));a.startup()})))}else console.log("Update signin info error.")})}else B(window.jimuNls.noEditPrivileges),r.signOutAll()}):u()}),u)}function D(a){var c=b.getSharingUrl(a),d=new l;w({url:c,content:{f:"json"},handleAs:"json",callbackParamName:"callback",preventCache:!0}).then(p.hitch(this,function(c){window.portalVersion=c.currentVersion;b.isOnline(a)?window.isPortalSupport3D=!0:window.isPortalSupport3D=0<=g.comparePortalVersion(window.portalVersion,"3.7");d.resolve()}),
p.hitch(this,function(a){console.error(a);d.reject(a)}));return d}function F(){var a=new l,d=r.getPortalCredential(window.portalUrl);d&&d.token?(d=b.getPortalSelfInfoUrl(window.portalUrl)+"?f\x3djson\x26token\x3d"+d.token,d=b.setHttpsProtocol(d),c.get(d,{handleAs:"json",jsonp:"callback",timeout:6E4}).then(p.hitch(this,function(b){b&&!b.error?a.resolve(!0):a.resolve(!1)}),p.hitch(this,function(b){console.error(b);a.reject(b)}))):a.resolve(!1);return a}function I(){var a=new l;window.isXT?g.getPortal(window.portalUrl).getUser().then(function(b){if(b)if("1"===
b.level||1===b.level)var c=new u({message:window.builderNls.userLevelTip,buttons:[{label:window.jimuNls.common.ok,onClick:p.hitch(this,function(){a.resolve(!1);c.close()})}]});else a.resolve(!0);else a.resolve(!1)},function(b){a.reject(b)}):a.resolve(!0);return a}function M(a){var b=new l;window.isXT?b.resolve(!0):a?g.getPortal(window.portalUrl).getItemById(a).then(function(a){403===a.httpCode&&"GWM_0003"===a.messageCode?b.resolve(a.message):b.resolve(!0)},function(a){a&&403===a.httpCode&&"GWM_0003"===
a.messageCode?b.resolve(a.message):b.reject(a)}):b.resolve(!0);return b}function L(){var a=new l;if(window.isXT)a.resolve(!0);else return g.getPortal(window.portalUrl).getUser().then(function(a){return a?a.canCreateItem():!1});return a}function J(b,c){q.forEach(c,function(c){var d=K[c.pluginName],e;for(e in c.parameters)if(e===b.name){var f=c.parameters[e];a.url.isAbsolute(f)||(c.parameters[e]=d.folderUrl+f)}})}function P(b){var c=new l;if(!b.parameters||null===d.stringify(b.parameters).match(/\$\{(\w)+\}/g))return c.resolve(!0),
c;var e=K[b.pluginName];v.getInstance().loadPluginI18n(e).then(function(d){b.parameters=a.replacePlaceHolder(b.parameters,d);c.resolve(!0)});return c}var K=d.parse(x);window.builderNls=A;window.pluginsMeta=K;m.getInstance();"function"!==typeof h.getAll&&(h.getAll=function(a){var b=[];(a=h(a))&&b.push(a);return b});jimuConfig.layoutId=jimuConfig.mainPageId;f.subscribe("switchToMainPage",function(b){var c=t.removeActionFromUrl(window.location.href);a.changeLocation(c);C(b)});(function(){for(var a in K){var b=
K[a];b.amdFolder="builder/plugins/"+a.replace(/\./g,"/")+"/";b.folderUrl=y.toUrl(b.amdFolder);b.uri=b.amdFolder+"Plugin"}a=[];for(var c in K){var b=K[c],d;for(d in b.extensionPoints){var e=b.extensionPoints[d],f;for(f in e.parameters){var g=e.parameters[f];"url"===g.type&&J(g,e.extensions)}if(e.extensions)for(g=0;g<e.extensions.length;g++)a.push(P(e.extensions[g]))}}return n(a)})().then(function(){e.setStyle("main-loading","display","none");window.isXT?y(["./xtMain"]):f.publish("switchToMainPage",
{portalUrl:b.getPortalUrlFromLocation()})})});